nohup: 忽略输入
2024-04-28 15:38:07,901 [trainer.py] => config: ./exps/finetune_cifar_B50_Inc5.json
2024-04-28 15:38:07,902 [trainer.py] => prefix: reproduce
2024-04-28 15:38:07,902 [trainer.py] => dataset: cifar224
2024-04-28 15:38:07,902 [trainer.py] => memory_size: 0
2024-04-28 15:38:07,902 [trainer.py] => memory_per_class: 0
2024-04-28 15:38:07,902 [trainer.py] => fixed_memory: False
2024-04-28 15:38:07,902 [trainer.py] => shuffle: True
2024-04-28 15:38:07,902 [trainer.py] => init_cls: 50
2024-04-28 15:38:07,902 [trainer.py] => increment: 10
2024-04-28 15:38:07,902 [trainer.py] => model_name: finetune
2024-04-28 15:38:07,902 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-28 15:38:07,902 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-28 15:38:07,902 [trainer.py] => seed: 1993
2024-04-28 15:38:07,902 [trainer.py] => init_epoch: 20
2024-04-28 15:38:07,902 [trainer.py] => init_lr: 0.001
2024-04-28 15:38:07,902 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-28 15:38:07,902 [trainer.py] => init_lr_decay: 0.1
2024-04-28 15:38:07,902 [trainer.py] => init_weight_decay: 0.0005
2024-04-28 15:38:07,902 [trainer.py] => epochs: 20
2024-04-28 15:38:07,902 [trainer.py] => lrate: 0.001
2024-04-28 15:38:07,902 [trainer.py] => milestones: [40, 70]
2024-04-28 15:38:07,902 [trainer.py] => lrate_decay: 0.1
2024-04-28 15:38:07,902 [trainer.py] => batch_size: 48
2024-04-28 15:38:07,903 [trainer.py] => weight_decay: 0.0002
Files already downloaded and verified
Files already downloaded and verified
2024-04-28 15:38:09,762 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-28 15:38:11,787 [trainer.py] => All params: 85798656
2024-04-28 15:38:11,788 [trainer.py] => Trainable params: 85798656
2024-04-28 15:38:11,788 [finetune.py] => Learning on 0-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.716, Train_accy 31.01, Test_accy 88.72:   0%|          | 0/20 [02:55<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.716, Train_accy 31.01, Test_accy 88.72:   5%|▌         | 1/20 [02:55<55:27, 175.14s/it]Task 0, Epoch 2/20 => Loss 0.865, Train_accy 75.82:   5%|▌         | 1/20 [05:38<55:27, 175.14s/it]                 Task 0, Epoch 2/20 => Loss 0.865, Train_accy 75.82:  10%|█         | 2/20 [05:38<50:30, 168.35s/it]Task 0, Epoch 3/20 => Loss 0.720, Train_accy 79.80:  10%|█         | 2/20 [08:22<50:30, 168.35s/it]Task 0, Epoch 3/20 => Loss 0.720, Train_accy 79.80:  15%|█▌        | 3/20 [08:22<47:08, 166.35s/it]Task 0, Epoch 4/20 => Loss 0.653, Train_accy 81.55:  15%|█▌        | 3/20 [11:06<47:08, 166.35s/it]Task 0, Epoch 4/20 => Loss 0.653, Train_accy 81.55:  20%|██        | 4/20 [11:06<44:03, 165.23s/it]Task 0, Epoch 5/20 => Loss 0.587, Train_accy 83.35:  20%|██        | 4/20 [13:49<44:03, 165.23s/it]Task 0, Epoch 5/20 => Loss 0.587, Train_accy 83.35:  25%|██▌       | 5/20 [13:49<41:09, 164.64s/it]Task 0, Epoch 6/20 => Loss 0.547, Train_accy 84.24, Test_accy 92.92:  25%|██▌       | 5/20 [16:45<41:09, 164.64s/it]Task 0, Epoch 6/20 => Loss 0.547, Train_accy 84.24, Test_accy 92.92:  30%|███       | 6/20 [16:45<39:18, 168.47s/it]Task 0, Epoch 7/20 => Loss 0.509, Train_accy 85.36:  30%|███       | 6/20 [19:29<39:18, 168.47s/it]                 Task 0, Epoch 7/20 => Loss 0.509, Train_accy 85.36:  35%|███▌      | 7/20 [19:29<36:09, 166.91s/it]Task 0, Epoch 8/20 => Loss 0.502, Train_accy 85.94:  35%|███▌      | 7/20 [22:12<36:09, 166.91s/it]Task 0, Epoch 8/20 => Loss 0.502, Train_accy 85.94:  40%|████      | 8/20 [22:12<33:10, 165.84s/it]Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.48:  40%|████      | 8/20 [24:56<33:10, 165.84s/it]Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.48:  45%|████▌     | 9/20 [24:56<30:15, 165.01s/it]Task 0, Epoch 10/20 => Loss 0.458, Train_accy 87.03:  45%|████▌     | 9/20 [27:40<30:15, 165.01s/it]Task 0, Epoch 10/20 => Loss 0.458, Train_accy 87.03:  50%|█████     | 10/20 [27:40<27:26, 164.66s/it]Task 0, Epoch 11/20 => Loss 0.438, Train_accy 87.53, Test_accy 93.12:  50%|█████     | 10/20 [30:36<27:26, 164.66s/it]Task 0, Epoch 11/20 => Loss 0.438, Train_accy 87.53, Test_accy 93.12:  55%|█████▌    | 11/20 [30:36<25:15, 168.40s/it]Task 0, Epoch 12/20 => Loss 0.429, Train_accy 87.86:  55%|█████▌    | 11/20 [33:19<25:15, 168.40s/it]                 Task 0, Epoch 12/20 => Loss 0.429, Train_accy 87.86:  60%|██████    | 12/20 [33:19<22:13, 166.65s/it]Task 0, Epoch 13/20 => Loss 0.421, Train_accy 88.08:  60%|██████    | 12/20 [36:03<22:13, 166.65s/it]Task 0, Epoch 13/20 => Loss 0.421, Train_accy 88.08:  65%|██████▌   | 13/20 [36:03<19:19, 165.69s/it]Task 0, Epoch 14/20 => Loss 0.420, Train_accy 88.08:  65%|██████▌   | 13/20 [38:45<19:19, 165.69s/it]Task 0, Epoch 14/20 => Loss 0.420, Train_accy 88.08:  70%|███████   | 14/20 [38:45<16:28, 164.83s/it]Task 0, Epoch 15/20 => Loss 0.403, Train_accy 88.49:  70%|███████   | 14/20 [41:29<16:28, 164.83s/it]Task 0, Epoch 15/20 => Loss 0.403, Train_accy 88.49:  75%|███████▌  | 15/20 [41:29<13:42, 164.45s/it]Task 0, Epoch 16/20 => Loss 0.392, Train_accy 88.93, Test_accy 93.32:  75%|███████▌  | 15/20 [44:24<13:42, 164.45s/it]Task 0, Epoch 16/20 => Loss 0.392, Train_accy 88.93, Test_accy 93.32:  80%|████████  | 16/20 [44:24<11:10, 167.65s/it]Task 0, Epoch 17/20 => Loss 0.388, Train_accy 89.00:  80%|████████  | 16/20 [47:07<11:10, 167.65s/it]                 Task 0, Epoch 17/20 => Loss 0.388, Train_accy 89.00:  85%|████████▌ | 17/20 [47:07<08:18, 166.18s/it]Task 0, Epoch 18/20 => Loss 0.375, Train_accy 89.32:  85%|████████▌ | 17/20 [49:50<08:18, 166.18s/it]Task 0, Epoch 18/20 => Loss 0.375, Train_accy 89.32:  90%|█████████ | 18/20 [49:50<05:30, 165.27s/it]Task 0, Epoch 19/20 => Loss 0.379, Train_accy 89.14:  90%|█████████ | 18/20 [52:33<05:30, 165.27s/it]Task 0, Epoch 19/20 => Loss 0.379, Train_accy 89.14:  95%|█████████▌| 19/20 [52:33<02:44, 164.66s/it]Task 0, Epoch 20/20 => Loss 0.362, Train_accy 89.63:  95%|█████████▌| 19/20 [55:16<02:44, 164.66s/it]Task 0, Epoch 20/20 => Loss 0.362, Train_accy 89.63: 100%|██████████| 20/20 [55:16<00:00, 164.14s/it]Task 0, Epoch 20/20 => Loss 0.362, Train_accy 89.63: 100%|██████████| 20/20 [55:16<00:00, 165.83s/it]
2024-04-28 16:33:29,073 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.362, Train_accy 89.63
2024-04-28 16:33:41,692 [trainer.py] => No NME accuracy.
2024-04-28 16:33:41,693 [trainer.py] => CNN: {'total': 93.12, '00-49': 93.12, 'old': 0, 'new': 93.12}
2024-04-28 16:33:41,693 [trainer.py] => CNN top1 curve: [93.12]
2024-04-28 16:33:41,693 [trainer.py] => CNN top5 curve: [99.14]

Average Accuracy (CNN): 93.12
2024-04-28 16:33:41,693 [trainer.py] => Average Accuracy (CNN): 93.12 

2024-04-28 16:33:41,693 [trainer.py] => Train Time: 6633.7
2024-04-28 16:33:41,693 [trainer.py] => Test Time: 12.62 

2024-04-28 16:33:41,695 [trainer.py] => All params: 85837106
2024-04-28 16:33:41,696 [trainer.py] => Trainable params: 85837106
2024-04-28 16:33:41,699 [finetune.py] => Learning on 50-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.556, Train_accy 51.86, Test_accy 89.82:   0%|          | 0/20 [00:47<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.556, Train_accy 51.86, Test_accy 89.82:   5%|▌         | 1/20 [00:47<15:08, 47.81s/it]Task 1, Epoch 2/20 => Loss 0.243, Train_accy 72.00:   5%|▌         | 1/20 [01:20<15:08, 47.81s/it]                 Task 1, Epoch 2/20 => Loss 0.243, Train_accy 72.00:  10%|█         | 2/20 [01:20<11:41, 38.97s/it]Task 1, Epoch 3/20 => Loss 0.223, Train_accy 74.92:  10%|█         | 2/20 [01:53<11:41, 38.97s/it]Task 1, Epoch 3/20 => Loss 0.223, Train_accy 74.92:  15%|█▌        | 3/20 [01:53<10:14, 36.14s/it]Task 1, Epoch 4/20 => Loss 0.214, Train_accy 77.08:  15%|█▌        | 3/20 [02:26<10:14, 36.14s/it]Task 1, Epoch 4/20 => Loss 0.214, Train_accy 77.08:  20%|██        | 4/20 [02:26<09:17, 34.83s/it]Task 1, Epoch 5/20 => Loss 0.198, Train_accy 78.48:  20%|██        | 4/20 [02:58<09:17, 34.83s/it]Task 1, Epoch 5/20 => Loss 0.198, Train_accy 78.48:  25%|██▌       | 5/20 [02:58<08:31, 34.08s/it]Task 1, Epoch 6/20 => Loss 0.176, Train_accy 81.06, Test_accy 89.38:  25%|██▌       | 5/20 [03:46<08:31, 34.08s/it]Task 1, Epoch 6/20 => Loss 0.176, Train_accy 81.06, Test_accy 89.38:  30%|███       | 6/20 [03:46<09:02, 38.76s/it]Task 1, Epoch 7/20 => Loss 0.180, Train_accy 80.48:  30%|███       | 6/20 [04:19<09:02, 38.76s/it]                 Task 1, Epoch 7/20 => Loss 0.180, Train_accy 80.48:  35%|███▌      | 7/20 [04:19<07:57, 36.76s/it]Task 1, Epoch 8/20 => Loss 0.178, Train_accy 80.74:  35%|███▌      | 7/20 [04:52<07:57, 36.76s/it]Task 1, Epoch 8/20 => Loss 0.178, Train_accy 80.74:  40%|████      | 8/20 [04:52<07:06, 35.51s/it]Task 1, Epoch 9/20 => Loss 0.174, Train_accy 82.40:  40%|████      | 8/20 [05:24<07:06, 35.51s/it]Task 1, Epoch 9/20 => Loss 0.174, Train_accy 82.40:  45%|████▌     | 9/20 [05:24<06:20, 34.61s/it]Task 1, Epoch 10/20 => Loss 0.178, Train_accy 83.86:  45%|████▌     | 9/20 [05:57<06:20, 34.61s/it]Task 1, Epoch 10/20 => Loss 0.178, Train_accy 83.86:  50%|█████     | 10/20 [05:57<05:40, 34.02s/it]Task 1, Epoch 11/20 => Loss 0.159, Train_accy 84.66, Test_accy 90.15:  50%|█████     | 10/20 [06:45<05:40, 34.02s/it]Task 1, Epoch 11/20 => Loss 0.159, Train_accy 84.66, Test_accy 90.15:  55%|█████▌    | 11/20 [06:45<05:44, 38.24s/it]Task 1, Epoch 12/20 => Loss 0.157, Train_accy 85.16:  55%|█████▌    | 11/20 [07:18<05:44, 38.24s/it]                 Task 1, Epoch 12/20 => Loss 0.157, Train_accy 85.16:  60%|██████    | 12/20 [07:18<04:52, 36.57s/it]Task 1, Epoch 13/20 => Loss 0.155, Train_accy 84.54:  60%|██████    | 12/20 [07:50<04:52, 36.57s/it]Task 1, Epoch 13/20 => Loss 0.155, Train_accy 84.54:  65%|██████▌   | 13/20 [07:50<04:08, 35.43s/it]Task 1, Epoch 14/20 => Loss 0.136, Train_accy 84.46:  65%|██████▌   | 13/20 [08:23<04:08, 35.43s/it]Task 1, Epoch 14/20 => Loss 0.136, Train_accy 84.46:  70%|███████   | 14/20 [08:23<03:27, 34.62s/it]Task 1, Epoch 15/20 => Loss 0.137, Train_accy 84.62:  70%|███████   | 14/20 [08:56<03:27, 34.62s/it]Task 1, Epoch 15/20 => Loss 0.137, Train_accy 84.62:  75%|███████▌  | 15/20 [08:56<02:50, 34.05s/it]Task 1, Epoch 16/20 => Loss 0.155, Train_accy 84.22, Test_accy 89.00:  75%|███████▌  | 15/20 [09:44<02:50, 34.05s/it]Task 1, Epoch 16/20 => Loss 0.155, Train_accy 84.22, Test_accy 89.00:  80%|████████  | 16/20 [09:44<02:32, 38.15s/it]Task 1, Epoch 17/20 => Loss 0.136, Train_accy 85.94:  80%|████████  | 16/20 [10:16<02:32, 38.15s/it]                 Task 1, Epoch 17/20 => Loss 0.136, Train_accy 85.94:  85%|████████▌ | 17/20 [10:16<01:49, 36.50s/it]Task 1, Epoch 18/20 => Loss 0.147, Train_accy 84.98:  85%|████████▌ | 17/20 [10:49<01:49, 36.50s/it]Task 1, Epoch 18/20 => Loss 0.147, Train_accy 84.98:  90%|█████████ | 18/20 [10:49<01:10, 35.31s/it]Task 1, Epoch 19/20 => Loss 0.137, Train_accy 85.46:  90%|█████████ | 18/20 [11:21<01:10, 35.31s/it]Task 1, Epoch 19/20 => Loss 0.137, Train_accy 85.46:  95%|█████████▌| 19/20 [11:21<00:34, 34.50s/it]Task 1, Epoch 20/20 => Loss 0.141, Train_accy 85.14:  95%|█████████▌| 19/20 [11:54<00:34, 34.50s/it]Task 1, Epoch 20/20 => Loss 0.141, Train_accy 85.14: 100%|██████████| 20/20 [11:54<00:00, 33.96s/it]Task 1, Epoch 20/20 => Loss 0.141, Train_accy 85.14: 100%|██████████| 20/20 [11:54<00:00, 35.73s/it]
2024-04-28 16:45:36,348 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.141, Train_accy 85.14
2024-04-28 16:45:51,398 [trainer.py] => No NME accuracy.
2024-04-28 16:45:51,398 [trainer.py] => CNN: {'total': 88.8, '00-49': 88.48, '50-59': 90.4, 'old': 88.48, 'new': 90.4}
2024-04-28 16:45:51,398 [trainer.py] => CNN top1 curve: [93.12, 88.8]
2024-04-28 16:45:51,398 [trainer.py] => CNN top5 curve: [99.14, 98.58]

Average Accuracy (CNN): 90.96
2024-04-28 16:45:51,398 [trainer.py] => Average Accuracy (CNN): 90.96 

2024-04-28 16:45:51,399 [trainer.py] => Train Time: 7348.3099999999995
2024-04-28 16:45:51,399 [trainer.py] => Test Time: 27.67 

2024-04-28 16:45:51,400 [trainer.py] => All params: 85844796
2024-04-28 16:45:51,401 [trainer.py] => Trainable params: 85844796
2024-04-28 16:45:51,402 [finetune.py] => Learning on 60-70
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.464, Train_accy 52.92, Test_accy 86.44:   0%|          | 0/20 [00:50<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.464, Train_accy 52.92, Test_accy 86.44:   5%|▌         | 1/20 [00:50<15:54, 50.24s/it]Task 2, Epoch 2/20 => Loss 0.198, Train_accy 74.02:   5%|▌         | 1/20 [01:22<15:54, 50.24s/it]                 Task 2, Epoch 2/20 => Loss 0.198, Train_accy 74.02:  10%|█         | 2/20 [01:22<11:57, 39.85s/it]Task 2, Epoch 3/20 => Loss 0.170, Train_accy 77.32:  10%|█         | 2/20 [01:55<11:57, 39.85s/it]Task 2, Epoch 3/20 => Loss 0.170, Train_accy 77.32:  15%|█▌        | 3/20 [01:55<10:21, 36.55s/it]Task 2, Epoch 4/20 => Loss 0.156, Train_accy 78.78:  15%|█▌        | 3/20 [02:28<10:21, 36.55s/it]Task 2, Epoch 4/20 => Loss 0.156, Train_accy 78.78:  20%|██        | 4/20 [02:28<09:20, 35.04s/it]Task 2, Epoch 5/20 => Loss 0.157, Train_accy 80.84:  20%|██        | 4/20 [03:00<09:20, 35.04s/it]Task 2, Epoch 5/20 => Loss 0.157, Train_accy 80.84:  25%|██▌       | 5/20 [03:00<08:32, 34.18s/it]Task 2, Epoch 6/20 => Loss 0.145, Train_accy 82.54, Test_accy 86.36:  25%|██▌       | 5/20 [03:51<08:32, 34.18s/it]Task 2, Epoch 6/20 => Loss 0.145, Train_accy 82.54, Test_accy 86.36:  30%|███       | 6/20 [03:51<09:15, 39.65s/it]Task 2, Epoch 7/20 => Loss 0.143, Train_accy 83.60:  30%|███       | 6/20 [04:23<09:15, 39.65s/it]                 Task 2, Epoch 7/20 => Loss 0.143, Train_accy 83.60:  35%|███▌      | 7/20 [04:23<08:05, 37.38s/it]Task 2, Epoch 8/20 => Loss 0.128, Train_accy 84.38:  35%|███▌      | 7/20 [04:56<08:05, 37.38s/it]Task 2, Epoch 8/20 => Loss 0.128, Train_accy 84.38:  40%|████      | 8/20 [04:56<07:11, 35.93s/it]Task 2, Epoch 9/20 => Loss 0.147, Train_accy 85.38:  40%|████      | 8/20 [05:29<07:11, 35.93s/it]Task 2, Epoch 9/20 => Loss 0.147, Train_accy 85.38:  45%|████▌     | 9/20 [05:29<06:24, 34.94s/it]Task 2, Epoch 10/20 => Loss 0.127, Train_accy 86.20:  45%|████▌     | 9/20 [06:02<06:24, 34.94s/it]Task 2, Epoch 10/20 => Loss 0.127, Train_accy 86.20:  50%|█████     | 10/20 [06:02<05:42, 34.23s/it]Task 2, Epoch 11/20 => Loss 0.131, Train_accy 86.86, Test_accy 87.10:  50%|█████     | 10/20 [06:52<05:42, 34.23s/it]Task 2, Epoch 11/20 => Loss 0.131, Train_accy 86.86, Test_accy 87.10:  55%|█████▌    | 11/20 [06:52<05:52, 39.19s/it]Task 2, Epoch 12/20 => Loss 0.135, Train_accy 87.62:  55%|█████▌    | 11/20 [07:25<05:52, 39.19s/it]                 Task 2, Epoch 12/20 => Loss 0.135, Train_accy 87.62:  60%|██████    | 12/20 [07:25<04:57, 37.20s/it]Task 2, Epoch 13/20 => Loss 0.133, Train_accy 87.90:  60%|██████    | 12/20 [07:57<04:57, 37.20s/it]Task 2, Epoch 13/20 => Loss 0.133, Train_accy 87.90:  65%|██████▌   | 13/20 [07:57<04:10, 35.84s/it]Task 2, Epoch 14/20 => Loss 0.128, Train_accy 87.98:  65%|██████▌   | 13/20 [08:30<04:10, 35.84s/it]Task 2, Epoch 14/20 => Loss 0.128, Train_accy 87.98:  70%|███████   | 14/20 [08:30<03:29, 34.89s/it]Task 2, Epoch 15/20 => Loss 0.124, Train_accy 88.28:  70%|███████   | 14/20 [09:03<03:29, 34.89s/it]Task 2, Epoch 15/20 => Loss 0.124, Train_accy 88.28:  75%|███████▌  | 15/20 [09:03<02:51, 34.22s/it]Task 2, Epoch 16/20 => Loss 0.120, Train_accy 89.22, Test_accy 85.99:  75%|███████▌  | 15/20 [09:53<02:51, 34.22s/it]Task 2, Epoch 16/20 => Loss 0.120, Train_accy 89.22, Test_accy 85.99:  80%|████████  | 16/20 [09:53<02:36, 39.01s/it]Task 2, Epoch 17/20 => Loss 0.112, Train_accy 90.20:  80%|████████  | 16/20 [10:26<02:36, 39.01s/it]                 Task 2, Epoch 17/20 => Loss 0.112, Train_accy 90.20:  85%|████████▌ | 17/20 [10:26<01:51, 37.12s/it]Task 2, Epoch 18/20 => Loss 0.146, Train_accy 88.32:  85%|████████▌ | 17/20 [10:58<01:51, 37.12s/it]Task 2, Epoch 18/20 => Loss 0.146, Train_accy 88.32:  90%|█████████ | 18/20 [10:58<01:11, 35.76s/it]Task 2, Epoch 19/20 => Loss 0.125, Train_accy 89.42:  90%|█████████ | 18/20 [11:31<01:11, 35.76s/it]Task 2, Epoch 19/20 => Loss 0.125, Train_accy 89.42:  95%|█████████▌| 19/20 [11:31<00:34, 34.84s/it]Task 2, Epoch 20/20 => Loss 0.118, Train_accy 89.48:  95%|█████████▌| 19/20 [12:04<00:34, 34.84s/it]Task 2, Epoch 20/20 => Loss 0.118, Train_accy 89.48: 100%|██████████| 20/20 [12:04<00:00, 34.20s/it]Task 2, Epoch 20/20 => Loss 0.118, Train_accy 89.48: 100%|██████████| 20/20 [12:04<00:00, 36.20s/it]
2024-04-28 16:57:55,478 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.118, Train_accy 89.48
2024-04-28 16:58:13,043 [trainer.py] => No NME accuracy.
2024-04-28 16:58:13,043 [trainer.py] => CNN: {'total': 85.97, '00-49': 86.04, '50-59': 75.7, '60-69': 95.9, 'old': 84.32, 'new': 95.9}
2024-04-28 16:58:13,044 [trainer.py] => CNN top1 curve: [93.12, 88.8, 85.97]
2024-04-28 16:58:13,044 [trainer.py] => CNN top5 curve: [99.14, 98.58, 98.03]

Average Accuracy (CNN): 89.3
2024-04-28 16:58:13,044 [trainer.py] => Average Accuracy (CNN): 89.3 

2024-04-28 16:58:13,044 [trainer.py] => Train Time: 8072.339999999999
2024-04-28 16:58:13,044 [trainer.py] => Test Time: 45.230000000000004 

2024-04-28 16:58:13,045 [trainer.py] => All params: 85852486
2024-04-28 16:58:13,047 [trainer.py] => Trainable params: 85852486
2024-04-28 16:58:13,049 [finetune.py] => Learning on 70-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.539, Train_accy 48.68, Test_accy 79.22:   0%|          | 0/20 [00:52<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.539, Train_accy 48.68, Test_accy 79.22:   5%|▌         | 1/20 [00:52<16:44, 52.86s/it]Task 3, Epoch 2/20 => Loss 0.239, Train_accy 70.80:   5%|▌         | 1/20 [01:25<16:44, 52.86s/it]                 Task 3, Epoch 2/20 => Loss 0.239, Train_accy 70.80:  10%|█         | 2/20 [01:25<12:17, 41.00s/it]Task 3, Epoch 3/20 => Loss 0.205, Train_accy 75.92:  10%|█         | 2/20 [01:58<12:17, 41.00s/it]Task 3, Epoch 3/20 => Loss 0.205, Train_accy 75.92:  15%|█▌        | 3/20 [01:58<10:32, 37.22s/it]Task 3, Epoch 4/20 => Loss 0.179, Train_accy 78.40:  15%|█▌        | 3/20 [02:30<10:32, 37.22s/it]Task 3, Epoch 4/20 => Loss 0.179, Train_accy 78.40:  20%|██        | 4/20 [02:30<09:26, 35.44s/it]Task 3, Epoch 5/20 => Loss 0.175, Train_accy 79.68:  20%|██        | 4/20 [03:03<09:26, 35.44s/it]Task 3, Epoch 5/20 => Loss 0.175, Train_accy 79.68:  25%|██▌       | 5/20 [03:03<08:37, 34.47s/it]Task 3, Epoch 6/20 => Loss 0.168, Train_accy 81.50, Test_accy 79.55:  25%|██▌       | 5/20 [03:56<08:37, 34.47s/it]Task 3, Epoch 6/20 => Loss 0.168, Train_accy 81.50, Test_accy 79.55:  30%|███       | 6/20 [03:56<09:30, 40.72s/it]Task 3, Epoch 7/20 => Loss 0.176, Train_accy 81.70:  30%|███       | 6/20 [04:29<09:30, 40.72s/it]                 Task 3, Epoch 7/20 => Loss 0.176, Train_accy 81.70:  35%|███▌      | 7/20 [04:29<08:14, 38.07s/it]Task 3, Epoch 8/20 => Loss 0.167, Train_accy 82.68:  35%|███▌      | 7/20 [05:01<08:14, 38.07s/it]Task 3, Epoch 8/20 => Loss 0.167, Train_accy 82.68:  40%|████      | 8/20 [05:01<07:15, 36.32s/it]Task 3, Epoch 9/20 => Loss 0.170, Train_accy 82.98:  40%|████      | 8/20 [05:34<07:15, 36.32s/it]Task 3, Epoch 9/20 => Loss 0.170, Train_accy 82.98:  45%|████▌     | 9/20 [05:34<06:27, 35.19s/it]Task 3, Epoch 10/20 => Loss 0.145, Train_accy 82.98:  45%|████▌     | 9/20 [06:07<06:27, 35.19s/it]Task 3, Epoch 10/20 => Loss 0.145, Train_accy 82.98:  50%|█████     | 10/20 [06:07<05:44, 34.40s/it]Task 3, Epoch 11/20 => Loss 0.144, Train_accy 84.36, Test_accy 78.71:  50%|█████     | 10/20 [06:59<05:44, 34.40s/it]Task 3, Epoch 11/20 => Loss 0.144, Train_accy 84.36, Test_accy 78.71:  55%|█████▌    | 11/20 [06:59<06:00, 40.05s/it]Task 3, Epoch 12/20 => Loss 0.145, Train_accy 85.62:  55%|█████▌    | 11/20 [07:32<06:00, 40.05s/it]                 Task 3, Epoch 12/20 => Loss 0.145, Train_accy 85.62:  60%|██████    | 12/20 [07:32<05:02, 37.79s/it]Task 3, Epoch 13/20 => Loss 0.144, Train_accy 86.34:  60%|██████    | 12/20 [08:05<05:02, 37.79s/it]Task 3, Epoch 13/20 => Loss 0.144, Train_accy 86.34:  65%|██████▌   | 13/20 [08:05<04:13, 36.23s/it]Task 3, Epoch 14/20 => Loss 0.133, Train_accy 87.12:  65%|██████▌   | 13/20 [08:37<04:13, 36.23s/it]Task 3, Epoch 14/20 => Loss 0.133, Train_accy 87.12:  70%|███████   | 14/20 [08:37<03:30, 35.13s/it]Task 3, Epoch 15/20 => Loss 0.147, Train_accy 87.08:  70%|███████   | 14/20 [09:10<03:30, 35.13s/it]Task 3, Epoch 15/20 => Loss 0.147, Train_accy 87.08:  75%|███████▌  | 15/20 [09:10<02:51, 34.37s/it]Task 3, Epoch 16/20 => Loss 0.135, Train_accy 87.40, Test_accy 75.44:  75%|███████▌  | 15/20 [10:02<02:51, 34.37s/it]Task 3, Epoch 16/20 => Loss 0.135, Train_accy 87.40, Test_accy 75.44:  80%|████████  | 16/20 [10:02<02:39, 39.83s/it]Task 3, Epoch 17/20 => Loss 0.143, Train_accy 87.34:  80%|████████  | 16/20 [10:35<02:39, 39.83s/it]                 Task 3, Epoch 17/20 => Loss 0.143, Train_accy 87.34:  85%|████████▌ | 17/20 [10:35<01:52, 37.65s/it]Task 3, Epoch 18/20 => Loss 0.117, Train_accy 89.08:  85%|████████▌ | 17/20 [11:08<01:52, 37.65s/it]Task 3, Epoch 18/20 => Loss 0.117, Train_accy 89.08:  90%|█████████ | 18/20 [11:08<01:12, 36.14s/it]Task 3, Epoch 19/20 => Loss 0.143, Train_accy 86.90:  90%|█████████ | 18/20 [11:40<01:12, 36.14s/it]Task 3, Epoch 19/20 => Loss 0.143, Train_accy 86.90:  95%|█████████▌| 19/20 [11:40<00:35, 35.09s/it]Task 3, Epoch 20/20 => Loss 0.124, Train_accy 88.96:  95%|█████████▌| 19/20 [12:13<00:35, 35.09s/it]Task 3, Epoch 20/20 => Loss 0.124, Train_accy 88.96: 100%|██████████| 20/20 [12:13<00:00, 34.33s/it]Task 3, Epoch 20/20 => Loss 0.124, Train_accy 88.96: 100%|██████████| 20/20 [12:13<00:00, 36.67s/it]
2024-04-28 17:10:26,511 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.124, Train_accy 88.96
2024-04-28 17:10:46,587 [trainer.py] => No NME accuracy.
2024-04-28 17:10:46,587 [trainer.py] => CNN: {'total': 76.35, '00-49': 76.32, '50-59': 57.3, '60-69': 80.1, '70-79': 91.8, 'old': 74.14, 'new': 91.8}
2024-04-28 17:10:46,587 [trainer.py] => CNN top1 curve: [93.12, 88.8, 85.97, 76.35]
2024-04-28 17:10:46,587 [trainer.py] => CNN top5 curve: [99.14, 98.58, 98.03, 96.55]

Average Accuracy (CNN): 86.06
2024-04-28 17:10:46,588 [trainer.py] => Average Accuracy (CNN): 86.06 

2024-04-28 17:10:46,588 [trainer.py] => Train Time: 8805.71
2024-04-28 17:10:46,588 [trainer.py] => Test Time: 65.30000000000001 

2024-04-28 17:10:46,589 [trainer.py] => All params: 85860176
2024-04-28 17:10:46,590 [trainer.py] => Trainable params: 85860176
2024-04-28 17:10:46,592 [finetune.py] => Learning on 80-90
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.568, Train_accy 40.90, Test_accy 74.50:   0%|          | 0/20 [00:54<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.568, Train_accy 40.90, Test_accy 74.50:   5%|▌         | 1/20 [00:54<17:22, 54.86s/it]Task 4, Epoch 2/20 => Loss 0.230, Train_accy 64.32:   5%|▌         | 1/20 [01:27<17:22, 54.86s/it]                 Task 4, Epoch 2/20 => Loss 0.230, Train_accy 64.32:  10%|█         | 2/20 [01:27<12:32, 41.78s/it]Task 4, Epoch 3/20 => Loss 0.209, Train_accy 68.02:  10%|█         | 2/20 [02:00<12:32, 41.78s/it]Task 4, Epoch 3/20 => Loss 0.209, Train_accy 68.02:  15%|█▌        | 3/20 [02:00<10:38, 37.57s/it]Task 4, Epoch 4/20 => Loss 0.194, Train_accy 72.14:  15%|█▌        | 3/20 [02:32<10:38, 37.57s/it]Task 4, Epoch 4/20 => Loss 0.194, Train_accy 72.14:  20%|██        | 4/20 [02:32<09:29, 35.61s/it]Task 4, Epoch 5/20 => Loss 0.186, Train_accy 74.80:  20%|██        | 4/20 [03:05<09:29, 35.61s/it]Task 4, Epoch 5/20 => Loss 0.186, Train_accy 74.80:  25%|██▌       | 5/20 [03:05<08:37, 34.52s/it]Task 4, Epoch 6/20 => Loss 0.160, Train_accy 75.76, Test_accy 76.24:  25%|██▌       | 5/20 [04:00<08:37, 34.52s/it]Task 4, Epoch 6/20 => Loss 0.160, Train_accy 75.76, Test_accy 76.24:  30%|███       | 6/20 [04:00<09:39, 41.42s/it]Task 4, Epoch 7/20 => Loss 0.186, Train_accy 75.64:  30%|███       | 6/20 [04:32<09:39, 41.42s/it]                 Task 4, Epoch 7/20 => Loss 0.186, Train_accy 75.64:  35%|███▌      | 7/20 [04:32<08:21, 38.55s/it]Task 4, Epoch 8/20 => Loss 0.164, Train_accy 77.60:  35%|███▌      | 7/20 [05:05<08:21, 38.55s/it]Task 4, Epoch 8/20 => Loss 0.164, Train_accy 77.60:  40%|████      | 8/20 [05:05<07:19, 36.64s/it]Task 4, Epoch 9/20 => Loss 0.151, Train_accy 80.38:  40%|████      | 8/20 [05:37<07:19, 36.64s/it]Task 4, Epoch 9/20 => Loss 0.151, Train_accy 80.38:  45%|████▌     | 9/20 [05:37<06:29, 35.40s/it]Task 4, Epoch 10/20 => Loss 0.169, Train_accy 79.22:  45%|████▌     | 9/20 [06:10<06:29, 35.40s/it]Task 4, Epoch 10/20 => Loss 0.169, Train_accy 79.22:  50%|█████     | 10/20 [06:10<05:45, 34.54s/it]Task 4, Epoch 11/20 => Loss 0.157, Train_accy 80.00, Test_accy 76.59:  50%|█████     | 10/20 [07:05<05:45, 34.54s/it]Task 4, Epoch 11/20 => Loss 0.157, Train_accy 80.00, Test_accy 76.59:  55%|█████▌    | 11/20 [07:05<06:06, 40.75s/it]Task 4, Epoch 12/20 => Loss 0.140, Train_accy 84.24:  55%|█████▌    | 11/20 [07:37<06:06, 40.75s/it]                 Task 4, Epoch 12/20 => Loss 0.140, Train_accy 84.24:  60%|██████    | 12/20 [07:37<05:05, 38.25s/it]Task 4, Epoch 13/20 => Loss 0.146, Train_accy 82.98:  60%|██████    | 12/20 [08:10<05:05, 38.25s/it]Task 4, Epoch 13/20 => Loss 0.146, Train_accy 82.98:  65%|██████▌   | 13/20 [08:10<04:15, 36.53s/it]Task 4, Epoch 14/20 => Loss 0.128, Train_accy 85.20:  65%|██████▌   | 13/20 [08:43<04:15, 36.53s/it]Task 4, Epoch 14/20 => Loss 0.128, Train_accy 85.20:  70%|███████   | 14/20 [08:43<03:31, 35.33s/it]Task 4, Epoch 15/20 => Loss 0.150, Train_accy 84.20:  70%|███████   | 14/20 [09:15<03:31, 35.33s/it]Task 4, Epoch 15/20 => Loss 0.150, Train_accy 84.20:  75%|███████▌  | 15/20 [09:15<02:52, 34.50s/it]Task 4, Epoch 16/20 => Loss 0.132, Train_accy 86.62, Test_accy 76.02:  75%|███████▌  | 15/20 [10:10<02:52, 34.50s/it]Task 4, Epoch 16/20 => Loss 0.132, Train_accy 86.62, Test_accy 76.02:  80%|████████  | 16/20 [10:10<02:42, 40.64s/it]Task 4, Epoch 17/20 => Loss 0.141, Train_accy 87.30:  80%|████████  | 16/20 [10:43<02:42, 40.64s/it]                 Task 4, Epoch 17/20 => Loss 0.141, Train_accy 87.30:  85%|████████▌ | 17/20 [10:43<01:54, 38.20s/it]Task 4, Epoch 18/20 => Loss 0.135, Train_accy 86.50:  85%|████████▌ | 17/20 [11:15<01:54, 38.20s/it]Task 4, Epoch 18/20 => Loss 0.135, Train_accy 86.50:  90%|█████████ | 18/20 [11:15<01:13, 36.51s/it]Task 4, Epoch 19/20 => Loss 0.131, Train_accy 86.50:  90%|█████████ | 18/20 [11:48<01:13, 36.51s/it]Task 4, Epoch 19/20 => Loss 0.131, Train_accy 86.50:  95%|█████████▌| 19/20 [11:48<00:35, 35.32s/it]Task 4, Epoch 20/20 => Loss 0.143, Train_accy 87.26:  95%|█████████▌| 19/20 [12:20<00:35, 35.32s/it]Task 4, Epoch 20/20 => Loss 0.143, Train_accy 87.26: 100%|██████████| 20/20 [12:20<00:00, 34.49s/it]Task 4, Epoch 20/20 => Loss 0.143, Train_accy 87.26: 100%|██████████| 20/20 [12:20<00:00, 37.03s/it]
2024-04-28 17:23:07,315 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.143, Train_accy 87.26
2024-04-28 17:23:29,538 [trainer.py] => No NME accuracy.
2024-04-28 17:23:29,539 [trainer.py] => CNN: {'total': 75.41, '00-49': 74.72, '50-59': 60.2, '60-69': 75.4, '70-79': 78.6, '80-89': 90.9, 'old': 73.47, 'new': 90.9}
2024-04-28 17:23:29,539 [trainer.py] => CNN top1 curve: [93.12, 88.8, 85.97, 76.35, 75.41]
2024-04-28 17:23:29,539 [trainer.py] => CNN top5 curve: [99.14, 98.58, 98.03, 96.55, 96.11]

Average Accuracy (CNN): 83.93
2024-04-28 17:23:29,539 [trainer.py] => Average Accuracy (CNN): 83.93 

2024-04-28 17:23:29,539 [trainer.py] => Train Time: 9546.4
2024-04-28 17:23:29,539 [trainer.py] => Test Time: 87.52000000000001 

2024-04-28 17:23:29,541 [trainer.py] => All params: 85867866
2024-04-28 17:23:29,542 [trainer.py] => Trainable params: 85867866
2024-04-28 17:23:29,544 [finetune.py] => Learning on 90-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.547, Train_accy 42.54, Test_accy 75.93:   0%|          | 0/20 [00:57<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.547, Train_accy 42.54, Test_accy 75.93:   5%|▌         | 1/20 [00:57<18:04, 57.08s/it]Task 5, Epoch 2/20 => Loss 0.268, Train_accy 66.80:   5%|▌         | 1/20 [01:29<18:04, 57.08s/it]                 Task 5, Epoch 2/20 => Loss 0.268, Train_accy 66.80:  10%|█         | 2/20 [01:29<12:47, 42.64s/it]Task 5, Epoch 3/20 => Loss 0.248, Train_accy 72.68:  10%|█         | 2/20 [02:02<12:47, 42.64s/it]Task 5, Epoch 3/20 => Loss 0.248, Train_accy 72.68:  15%|█▌        | 3/20 [02:02<10:46, 38.02s/it]Task 5, Epoch 4/20 => Loss 0.196, Train_accy 78.68:  15%|█▌        | 3/20 [02:34<10:46, 38.02s/it]Task 5, Epoch 4/20 => Loss 0.196, Train_accy 78.68:  20%|██        | 4/20 [02:34<09:34, 35.88s/it]Task 5, Epoch 5/20 => Loss 0.191, Train_accy 79.84:  20%|██        | 4/20 [03:07<09:34, 35.88s/it]Task 5, Epoch 5/20 => Loss 0.191, Train_accy 79.84:  25%|██▌       | 5/20 [03:07<08:40, 34.68s/it]Task 5, Epoch 6/20 => Loss 0.204, Train_accy 80.16, Test_accy 76.39:  25%|██▌       | 5/20 [04:04<08:40, 34.68s/it]Task 5, Epoch 6/20 => Loss 0.204, Train_accy 80.16, Test_accy 76.39:  30%|███       | 6/20 [04:04<09:53, 42.39s/it]Task 5, Epoch 7/20 => Loss 0.179, Train_accy 83.42:  30%|███       | 6/20 [04:37<09:53, 42.39s/it]                 Task 5, Epoch 7/20 => Loss 0.179, Train_accy 83.42:  35%|███▌      | 7/20 [04:37<08:29, 39.18s/it]Task 5, Epoch 8/20 => Loss 0.169, Train_accy 84.82:  35%|███▌      | 7/20 [05:09<08:29, 39.18s/it]Task 5, Epoch 8/20 => Loss 0.169, Train_accy 84.82:  40%|████      | 8/20 [05:09<07:24, 37.08s/it]Task 5, Epoch 9/20 => Loss 0.160, Train_accy 86.58:  40%|████      | 8/20 [05:42<07:24, 37.08s/it]Task 5, Epoch 9/20 => Loss 0.160, Train_accy 86.58:  45%|████▌     | 9/20 [05:42<06:32, 35.66s/it]Task 5, Epoch 10/20 => Loss 0.162, Train_accy 85.90:  45%|████▌     | 9/20 [06:14<06:32, 35.66s/it]Task 5, Epoch 10/20 => Loss 0.162, Train_accy 85.90:  50%|█████     | 10/20 [06:14<05:47, 34.71s/it]Task 5, Epoch 11/20 => Loss 0.166, Train_accy 86.66, Test_accy 76.33:  50%|█████     | 10/20 [07:12<05:47, 34.71s/it]Task 5, Epoch 11/20 => Loss 0.166, Train_accy 86.66, Test_accy 76.33:  55%|█████▌    | 11/20 [07:12<06:15, 41.68s/it]Task 5, Epoch 12/20 => Loss 0.170, Train_accy 86.50:  55%|█████▌    | 11/20 [07:45<06:15, 41.68s/it]                 Task 5, Epoch 12/20 => Loss 0.170, Train_accy 86.50:  60%|██████    | 12/20 [07:45<05:11, 38.94s/it]Task 5, Epoch 13/20 => Loss 0.140, Train_accy 88.42:  60%|██████    | 12/20 [08:17<05:11, 38.94s/it]Task 5, Epoch 13/20 => Loss 0.140, Train_accy 88.42:  65%|██████▌   | 13/20 [08:17<04:19, 37.02s/it]Task 5, Epoch 14/20 => Loss 0.147, Train_accy 88.58:  65%|██████▌   | 13/20 [08:50<04:19, 37.02s/it]Task 5, Epoch 14/20 => Loss 0.147, Train_accy 88.58:  70%|███████   | 14/20 [08:50<03:34, 35.69s/it]Task 5, Epoch 15/20 => Loss 0.157, Train_accy 88.88:  70%|███████   | 14/20 [09:22<03:34, 35.69s/it]Task 5, Epoch 15/20 => Loss 0.157, Train_accy 88.88:  75%|███████▌  | 15/20 [09:22<02:53, 34.75s/it]Task 5, Epoch 16/20 => Loss 0.146, Train_accy 89.14, Test_accy 75.30:  75%|███████▌  | 15/20 [10:20<02:53, 34.75s/it]Task 5, Epoch 16/20 => Loss 0.146, Train_accy 89.14, Test_accy 75.30:  80%|████████  | 16/20 [10:20<02:46, 41.60s/it]Task 5, Epoch 17/20 => Loss 0.158, Train_accy 89.10:  80%|████████  | 16/20 [10:53<02:46, 41.60s/it]                 Task 5, Epoch 17/20 => Loss 0.158, Train_accy 89.10:  85%|████████▌ | 17/20 [10:53<01:56, 38.94s/it]Task 5, Epoch 18/20 => Loss 0.131, Train_accy 90.78:  85%|████████▌ | 17/20 [11:25<01:56, 38.94s/it]Task 5, Epoch 18/20 => Loss 0.131, Train_accy 90.78:  90%|█████████ | 18/20 [11:25<01:14, 37.07s/it]Task 5, Epoch 19/20 => Loss 0.142, Train_accy 89.96:  90%|█████████ | 18/20 [11:58<01:14, 37.07s/it]Task 5, Epoch 19/20 => Loss 0.142, Train_accy 89.96:  95%|█████████▌| 19/20 [11:58<00:35, 35.73s/it]Task 5, Epoch 20/20 => Loss 0.140, Train_accy 90.56:  95%|█████████▌| 19/20 [12:31<00:35, 35.73s/it]Task 5, Epoch 20/20 => Loss 0.140, Train_accy 90.56: 100%|██████████| 20/20 [12:31<00:00, 34.80s/it]Task 5, Epoch 20/20 => Loss 0.140, Train_accy 90.56: 100%|██████████| 20/20 [12:31<00:00, 37.55s/it]
2024-04-28 17:36:00,661 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.140, Train_accy 90.56
2024-04-28 17:36:25,606 [trainer.py] => No NME accuracy.
2024-04-28 17:36:25,606 [trainer.py] => CNN: {'total': 75.12, '00-49': 74.22, '50-59': 55.6, '60-69': 70.6, '70-79': 75.7, '80-89': 83.5, '90-99': 94.7, 'old': 72.94, 'new': 94.7}
2024-04-28 17:36:25,607 [trainer.py] => CNN top1 curve: [93.12, 88.8, 85.97, 76.35, 75.41, 75.12]
2024-04-28 17:36:25,607 [trainer.py] => CNN top5 curve: [99.14, 98.58, 98.03, 96.55, 96.11, 95.73]

Average Accuracy (CNN): 82.46
2024-04-28 17:36:25,607 [trainer.py] => Average Accuracy (CNN): 82.46 

2024-04-28 17:36:25,607 [trainer.py] => Train Time: 10297.48
2024-04-28 17:36:25,607 [trainer.py] => Test Time: 112.46000000000001 

Accuracy Matrix (CNN):
[[93.12 88.48 86.04 76.32 74.72 74.22]
 [ 0.   90.4  75.7  57.3  60.2  55.6 ]
 [ 0.    0.   95.9  80.1  75.4  70.6 ]
 [ 0.    0.    0.   91.8  78.6  75.7 ]
 [ 0.    0.    0.    0.   90.9  83.5 ]
 [ 0.    0.    0.    0.    0.   94.7 ]]
2024-04-28 17:36:25,609 [trainer.py] => Forgetting (CNN): 20.500000000000007
2024-04-28 17:36:28,243 [trainer.py] => config: ./exps/icarl_cifar_B50_Inc5.json
2024-04-28 17:36:28,243 [trainer.py] => prefix: reproduce
2024-04-28 17:36:28,243 [trainer.py] => dataset: cifar224
2024-04-28 17:36:28,243 [trainer.py] => memory_size: 2000
2024-04-28 17:36:28,243 [trainer.py] => memory_per_class: 20
2024-04-28 17:36:28,243 [trainer.py] => fixed_memory: True
2024-04-28 17:36:28,244 [trainer.py] => shuffle: True
2024-04-28 17:36:28,244 [trainer.py] => init_cls: 50
2024-04-28 17:36:28,244 [trainer.py] => increment: 10
2024-04-28 17:36:28,244 [trainer.py] => model_name: icarl
2024-04-28 17:36:28,244 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-28 17:36:28,244 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-28 17:36:28,244 [trainer.py] => seed: 1993
2024-04-28 17:36:28,244 [trainer.py] => init_epoch: 20
2024-04-28 17:36:28,244 [trainer.py] => init_lr: 0.001
2024-04-28 17:36:28,244 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-28 17:36:28,244 [trainer.py] => init_lr_decay: 0.1
2024-04-28 17:36:28,244 [trainer.py] => init_weight_decay: 0.0005
2024-04-28 17:36:28,244 [trainer.py] => epochs: 20
2024-04-28 17:36:28,244 [trainer.py] => lrate: 0.001
2024-04-28 17:36:28,244 [trainer.py] => milestones: [80, 120]
2024-04-28 17:36:28,244 [trainer.py] => lrate_decay: 0.1
2024-04-28 17:36:28,244 [trainer.py] => batch_size: 48
2024-04-28 17:36:28,244 [trainer.py] => weight_decay: 0.0002
2024-04-28 17:36:28,244 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-04-28 17:36:30,036 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-28 17:36:31,944 [trainer.py] => All params: 85798656
2024-04-28 17:36:31,945 [trainer.py] => Trainable params: 85798656
2024-04-28 17:36:31,945 [icarl.py] => Learning on 0-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.716, Train_accy 31.01, Test_accy 88.72:   0%|          | 0/20 [02:53<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.716, Train_accy 31.01, Test_accy 88.72:   5%|▌         | 1/20 [02:53<54:58, 173.59s/it]Task 0, Epoch 2/20 => Loss 0.865, Train_accy 75.82:   5%|▌         | 1/20 [05:35<54:58, 173.59s/it]                 Task 0, Epoch 2/20 => Loss 0.865, Train_accy 75.82:  10%|█         | 2/20 [05:35<50:03, 166.84s/it]Task 0, Epoch 3/20 => Loss 0.720, Train_accy 79.80:  10%|█         | 2/20 [08:17<50:03, 166.84s/it]Task 0, Epoch 3/20 => Loss 0.720, Train_accy 79.80:  15%|█▌        | 3/20 [08:17<46:35, 164.42s/it]Task 0, Epoch 4/20 => Loss 0.653, Train_accy 81.55:  15%|█▌        | 3/20 [10:58<46:35, 164.42s/it]Task 0, Epoch 4/20 => Loss 0.653, Train_accy 81.55:  20%|██        | 4/20 [10:58<43:33, 163.32s/it]Task 0, Epoch 5/20 => Loss 0.587, Train_accy 83.35:  20%|██        | 4/20 [13:40<43:33, 163.32s/it]Task 0, Epoch 5/20 => Loss 0.587, Train_accy 83.35:  25%|██▌       | 5/20 [13:40<40:42, 162.86s/it]Task 0, Epoch 6/20 => Loss 0.547, Train_accy 84.24, Test_accy 92.92:  25%|██▌       | 5/20 [16:35<40:42, 162.86s/it]Task 0, Epoch 6/20 => Loss 0.547, Train_accy 84.24, Test_accy 92.92:  30%|███       | 6/20 [16:35<38:54, 166.75s/it]Task 0, Epoch 7/20 => Loss 0.509, Train_accy 85.36:  30%|███       | 6/20 [19:16<38:54, 166.75s/it]                 Task 0, Epoch 7/20 => Loss 0.509, Train_accy 85.36:  35%|███▌      | 7/20 [19:16<35:46, 165.11s/it]Task 0, Epoch 8/20 => Loss 0.502, Train_accy 85.94:  35%|███▌      | 7/20 [21:58<35:46, 165.11s/it]Task 0, Epoch 8/20 => Loss 0.502, Train_accy 85.94:  40%|████      | 8/20 [21:58<32:48, 164.00s/it]Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.48:  40%|████      | 8/20 [24:40<32:48, 164.00s/it]Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.48:  45%|████▌     | 9/20 [24:40<29:57, 163.37s/it]Task 0, Epoch 10/20 => Loss 0.458, Train_accy 87.03:  45%|████▌     | 9/20 [27:23<29:57, 163.37s/it]Task 0, Epoch 10/20 => Loss 0.458, Train_accy 87.03:  50%|█████     | 10/20 [27:23<27:11, 163.11s/it]Task 0, Epoch 11/20 => Loss 0.438, Train_accy 87.53, Test_accy 93.12:  50%|█████     | 10/20 [30:16<27:11, 163.11s/it]Task 0, Epoch 11/20 => Loss 0.438, Train_accy 87.53, Test_accy 93.12:  55%|█████▌    | 11/20 [30:16<24:57, 166.41s/it]Task 0, Epoch 12/20 => Loss 0.429, Train_accy 87.86:  55%|█████▌    | 11/20 [32:58<24:57, 166.41s/it]                 Task 0, Epoch 12/20 => Loss 0.429, Train_accy 87.86:  60%|██████    | 12/20 [32:58<22:00, 165.01s/it]Task 0, Epoch 13/20 => Loss 0.421, Train_accy 88.08:  60%|██████    | 12/20 [35:40<22:00, 165.01s/it]Task 0, Epoch 13/20 => Loss 0.421, Train_accy 88.08:  65%|██████▌   | 13/20 [35:40<19:08, 164.12s/it]Task 0, Epoch 14/20 => Loss 0.420, Train_accy 88.08:  65%|██████▌   | 13/20 [38:22<19:08, 164.12s/it]Task 0, Epoch 14/20 => Loss 0.420, Train_accy 88.08:  70%|███████   | 14/20 [38:22<16:20, 163.40s/it]Task 0, Epoch 15/20 => Loss 0.403, Train_accy 88.49:  70%|███████   | 14/20 [41:04<16:20, 163.40s/it]Task 0, Epoch 15/20 => Loss 0.403, Train_accy 88.49:  75%|███████▌  | 15/20 [41:04<13:34, 162.92s/it]Task 0, Epoch 16/20 => Loss 0.392, Train_accy 88.93, Test_accy 93.32:  75%|███████▌  | 15/20 [43:59<13:34, 162.92s/it]Task 0, Epoch 16/20 => Loss 0.392, Train_accy 88.93, Test_accy 93.32:  80%|████████  | 16/20 [43:59<11:06, 166.54s/it]Task 0, Epoch 17/20 => Loss 0.388, Train_accy 89.00:  80%|████████  | 16/20 [46:44<11:06, 166.54s/it]                 Task 0, Epoch 17/20 => Loss 0.388, Train_accy 89.00:  85%|████████▌ | 17/20 [46:44<08:18, 166.00s/it]Task 0, Epoch 18/20 => Loss 0.375, Train_accy 89.32:  85%|████████▌ | 17/20 [49:28<08:18, 166.00s/it]Task 0, Epoch 18/20 => Loss 0.375, Train_accy 89.32:  90%|█████████ | 18/20 [49:28<05:30, 165.47s/it]Task 0, Epoch 19/20 => Loss 0.379, Train_accy 89.14:  90%|█████████ | 18/20 [52:10<05:30, 165.47s/it]Task 0, Epoch 19/20 => Loss 0.379, Train_accy 89.14:  95%|█████████▌| 19/20 [52:10<02:44, 164.56s/it]Task 0, Epoch 20/20 => Loss 0.362, Train_accy 89.63:  95%|█████████▌| 19/20 [54:53<02:44, 164.56s/it]Task 0, Epoch 20/20 => Loss 0.362, Train_accy 89.63: 100%|██████████| 20/20 [54:53<00:00, 163.88s/it]Task 0, Epoch 20/20 => Loss 0.362, Train_accy 89.63: 100%|██████████| 20/20 [54:53<00:00, 164.65s/it]
2024-04-28 18:31:25,521 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.362, Train_accy 89.63
2024-04-28 18:31:25,523 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-28 18:33:17,860 [icarl.py] => Exemplar size: 1000
2024-04-28 18:33:17,860 [trainer.py] => CNN: {'total': 93.12, '00-49': 93.12, 'old': 0, 'new': 93.12}
2024-04-28 18:33:17,860 [trainer.py] => NME: {'total': 93.38, '00-49': 93.38, 'old': 0, 'new': 93.38}
2024-04-28 18:33:17,860 [trainer.py] => CNN top1 curve: [93.12]
2024-04-28 18:33:17,860 [trainer.py] => CNN top5 curve: [99.14]
2024-04-28 18:33:17,860 [trainer.py] => NME top1 curve: [93.38]
2024-04-28 18:33:17,860 [trainer.py] => NME top5 curve: [99.3]

Average Accuracy (CNN): 93.12
Average Accuracy (NME): 93.38
2024-04-28 18:33:17,860 [trainer.py] => Average Accuracy (CNN): 93.12
2024-04-28 18:33:17,860 [trainer.py] => Average Accuracy (NME): 93.38
2024-04-28 18:33:17,860 [trainer.py] => Train Time: 0
2024-04-28 18:33:17,860 [trainer.py] => Test Time: 24.92 

2024-04-28 18:33:17,861 [trainer.py] => All params: 85837106
2024-04-28 18:33:17,861 [trainer.py] => Trainable params: 85837106
2024-04-28 18:33:17,862 [icarl.py] => Learning on 50-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.224, Train_accy 77.62, Test_accy 86.98:   0%|          | 0/20 [01:07<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.224, Train_accy 77.62, Test_accy 86.98:   5%|▌         | 1/20 [01:07<21:20, 67.38s/it]Task 1, Epoch 2/20 => Loss 2.558, Train_accy 88.90:   5%|▌         | 1/20 [02:00<21:20, 67.38s/it]                 Task 1, Epoch 2/20 => Loss 2.558, Train_accy 88.90:  10%|█         | 2/20 [02:00<17:37, 58.73s/it]Task 1, Epoch 3/20 => Loss 2.513, Train_accy 89.55:  10%|█         | 2/20 [02:52<17:37, 58.73s/it]Task 1, Epoch 3/20 => Loss 2.513, Train_accy 89.55:  15%|█▌        | 3/20 [02:52<15:50, 55.89s/it]Task 1, Epoch 4/20 => Loss 2.435, Train_accy 91.15:  15%|█▌        | 3/20 [03:45<15:50, 55.89s/it]Task 1, Epoch 4/20 => Loss 2.435, Train_accy 91.15:  20%|██        | 4/20 [03:45<14:33, 54.57s/it]Task 1, Epoch 5/20 => Loss 2.438, Train_accy 91.60:  20%|██        | 4/20 [04:37<14:33, 54.57s/it]Task 1, Epoch 5/20 => Loss 2.438, Train_accy 91.60:  25%|██▌       | 5/20 [04:37<13:27, 53.82s/it]Task 1, Epoch 6/20 => Loss 2.425, Train_accy 92.23, Test_accy 86.32:  25%|██▌       | 5/20 [05:45<13:27, 53.82s/it]Task 1, Epoch 6/20 => Loss 2.425, Train_accy 92.23, Test_accy 86.32:  30%|███       | 6/20 [05:45<13:39, 58.52s/it]Task 1, Epoch 7/20 => Loss 2.430, Train_accy 92.10:  30%|███       | 6/20 [06:37<13:39, 58.52s/it]                 Task 1, Epoch 7/20 => Loss 2.430, Train_accy 92.10:  35%|███▌      | 7/20 [06:37<12:15, 56.54s/it]Task 1, Epoch 8/20 => Loss 2.418, Train_accy 92.03:  35%|███▌      | 7/20 [07:30<12:15, 56.54s/it]Task 1, Epoch 8/20 => Loss 2.418, Train_accy 92.03:  40%|████      | 8/20 [07:30<11:03, 55.26s/it]Task 1, Epoch 9/20 => Loss 2.402, Train_accy 92.37:  40%|████      | 8/20 [08:22<11:03, 55.26s/it]Task 1, Epoch 9/20 => Loss 2.402, Train_accy 92.37:  45%|████▌     | 9/20 [08:22<09:58, 54.41s/it]Task 1, Epoch 10/20 => Loss 2.402, Train_accy 93.18:  45%|████▌     | 9/20 [09:15<09:58, 54.41s/it]Task 1, Epoch 10/20 => Loss 2.402, Train_accy 93.18:  50%|█████     | 10/20 [09:15<08:58, 53.85s/it]Task 1, Epoch 11/20 => Loss 2.390, Train_accy 93.12, Test_accy 88.10:  50%|█████     | 10/20 [10:22<08:58, 53.85s/it]Task 1, Epoch 11/20 => Loss 2.390, Train_accy 93.12, Test_accy 88.10:  55%|█████▌    | 11/20 [10:22<08:42, 58.02s/it]Task 1, Epoch 12/20 => Loss 2.365, Train_accy 93.50:  55%|█████▌    | 11/20 [11:15<08:42, 58.02s/it]                 Task 1, Epoch 12/20 => Loss 2.365, Train_accy 93.50:  60%|██████    | 12/20 [11:15<07:30, 56.32s/it]Task 1, Epoch 13/20 => Loss 2.380, Train_accy 93.00:  60%|██████    | 12/20 [12:07<07:30, 56.32s/it]Task 1, Epoch 13/20 => Loss 2.380, Train_accy 93.00:  65%|██████▌   | 13/20 [12:07<06:26, 55.15s/it]Task 1, Epoch 14/20 => Loss 2.385, Train_accy 93.33:  65%|██████▌   | 13/20 [13:00<06:26, 55.15s/it]Task 1, Epoch 14/20 => Loss 2.385, Train_accy 93.33:  70%|███████   | 14/20 [13:00<05:25, 54.33s/it]Task 1, Epoch 15/20 => Loss 2.377, Train_accy 93.45:  70%|███████   | 14/20 [13:52<05:25, 54.33s/it]Task 1, Epoch 15/20 => Loss 2.377, Train_accy 93.45:  75%|███████▌  | 15/20 [13:52<04:28, 53.76s/it]Task 1, Epoch 16/20 => Loss 2.348, Train_accy 93.82, Test_accy 86.38:  75%|███████▌  | 15/20 [14:59<04:28, 53.76s/it]Task 1, Epoch 16/20 => Loss 2.348, Train_accy 93.82, Test_accy 86.38:  80%|████████  | 16/20 [14:59<03:51, 57.82s/it]Task 1, Epoch 17/20 => Loss 2.383, Train_accy 93.60:  80%|████████  | 16/20 [15:52<03:51, 57.82s/it]                 Task 1, Epoch 17/20 => Loss 2.383, Train_accy 93.60:  85%|████████▌ | 17/20 [15:52<02:48, 56.20s/it]Task 1, Epoch 18/20 => Loss 2.351, Train_accy 93.83:  85%|████████▌ | 17/20 [16:44<02:48, 56.20s/it]Task 1, Epoch 18/20 => Loss 2.351, Train_accy 93.83:  90%|█████████ | 18/20 [16:44<01:50, 55.09s/it]Task 1, Epoch 19/20 => Loss 2.346, Train_accy 94.27:  90%|█████████ | 18/20 [17:37<01:50, 55.09s/it]Task 1, Epoch 19/20 => Loss 2.346, Train_accy 94.27:  95%|█████████▌| 19/20 [17:37<00:54, 54.30s/it]Task 1, Epoch 20/20 => Loss 2.348, Train_accy 94.25:  95%|█████████▌| 19/20 [18:29<00:54, 54.30s/it]Task 1, Epoch 20/20 => Loss 2.348, Train_accy 94.25: 100%|██████████| 20/20 [18:29<00:00, 53.76s/it]Task 1, Epoch 20/20 => Loss 2.348, Train_accy 94.25: 100%|██████████| 20/20 [18:29<00:00, 55.49s/it]
2024-04-28 18:51:47,668 [icarl.py] => Task 1, Epoch 20/20 => Loss 2.348, Train_accy 94.25
2024-04-28 18:51:47,670 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-28 18:52:46,523 [icarl.py] => Exemplar size: 1200
2024-04-28 18:52:46,523 [trainer.py] => CNN: {'total': 86.67, '00-49': 84.42, '50-59': 97.9, 'old': 84.42, 'new': 97.9}
2024-04-28 18:52:46,523 [trainer.py] => NME: {'total': 91.78, '00-49': 91.58, '50-59': 92.8, 'old': 91.58, 'new': 92.8}
2024-04-28 18:52:46,523 [trainer.py] => CNN top1 curve: [93.12, 86.67]
2024-04-28 18:52:46,523 [trainer.py] => CNN top5 curve: [99.14, 98.4]
2024-04-28 18:52:46,524 [trainer.py] => NME top1 curve: [93.38, 91.78]
2024-04-28 18:52:46,524 [trainer.py] => NME top5 curve: [99.3, 99.1]

Average Accuracy (CNN): 89.9
Average Accuracy (NME): 92.58
2024-04-28 18:52:46,524 [trainer.py] => Average Accuracy (CNN): 89.9
2024-04-28 18:52:46,524 [trainer.py] => Average Accuracy (NME): 92.58
2024-04-28 18:52:46,524 [trainer.py] => Train Time: 0
2024-04-28 18:52:46,524 [trainer.py] => Test Time: 54.85 

2024-04-28 18:52:46,524 [trainer.py] => All params: 85844796
2024-04-28 18:52:46,525 [trainer.py] => Trainable params: 85844796
2024-04-28 18:52:46,526 [icarl.py] => Learning on 60-70
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.045, Train_accy 79.47, Test_accy 82.73:   0%|          | 0/20 [01:11<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.045, Train_accy 79.47, Test_accy 82.73:   5%|▌         | 1/20 [01:11<22:40, 71.60s/it]Task 2, Epoch 2/20 => Loss 2.198, Train_accy 90.95:   5%|▌         | 1/20 [02:05<22:40, 71.60s/it]                 Task 2, Epoch 2/20 => Loss 2.198, Train_accy 90.95:  10%|█         | 2/20 [02:05<18:24, 61.36s/it]Task 2, Epoch 3/20 => Loss 2.161, Train_accy 91.89:  10%|█         | 2/20 [03:00<18:24, 61.36s/it]Task 2, Epoch 3/20 => Loss 2.161, Train_accy 91.89:  15%|█▌        | 3/20 [03:00<16:27, 58.11s/it]Task 2, Epoch 4/20 => Loss 2.113, Train_accy 92.82:  15%|█▌        | 3/20 [03:54<16:27, 58.11s/it]Task 2, Epoch 4/20 => Loss 2.113, Train_accy 92.82:  20%|██        | 4/20 [03:54<15:06, 56.64s/it]Task 2, Epoch 5/20 => Loss 2.120, Train_accy 92.85:  20%|██        | 4/20 [04:48<15:06, 56.64s/it]Task 2, Epoch 5/20 => Loss 2.120, Train_accy 92.85:  25%|██▌       | 5/20 [04:48<13:56, 55.78s/it]Task 2, Epoch 6/20 => Loss 2.087, Train_accy 93.16, Test_accy 84.50:  25%|██▌       | 5/20 [06:00<13:56, 55.78s/it]Task 2, Epoch 6/20 => Loss 2.087, Train_accy 93.16, Test_accy 84.50:  30%|███       | 6/20 [06:00<14:16, 61.19s/it]Task 2, Epoch 7/20 => Loss 2.095, Train_accy 93.79:  30%|███       | 6/20 [06:54<14:16, 61.19s/it]                 Task 2, Epoch 7/20 => Loss 2.095, Train_accy 93.79:  35%|███▌      | 7/20 [06:54<12:46, 58.93s/it]Task 2, Epoch 8/20 => Loss 2.095, Train_accy 93.97:  35%|███▌      | 7/20 [07:48<12:46, 58.93s/it]Task 2, Epoch 8/20 => Loss 2.095, Train_accy 93.97:  40%|████      | 8/20 [07:48<11:29, 57.44s/it]Task 2, Epoch 9/20 => Loss 2.043, Train_accy 94.63:  40%|████      | 8/20 [08:43<11:29, 57.44s/it]Task 2, Epoch 9/20 => Loss 2.043, Train_accy 94.63:  45%|████▌     | 9/20 [08:43<10:20, 56.44s/it]Task 2, Epoch 10/20 => Loss 2.068, Train_accy 94.39:  45%|████▌     | 9/20 [09:37<10:20, 56.44s/it]Task 2, Epoch 10/20 => Loss 2.068, Train_accy 94.39:  50%|█████     | 10/20 [09:37<09:17, 55.76s/it]Task 2, Epoch 11/20 => Loss 2.063, Train_accy 94.82, Test_accy 84.66:  50%|█████     | 10/20 [10:49<09:17, 55.76s/it]Task 2, Epoch 11/20 => Loss 2.063, Train_accy 94.82, Test_accy 84.66:  55%|█████▌    | 11/20 [10:49<09:06, 60.76s/it]Task 2, Epoch 12/20 => Loss 2.066, Train_accy 94.23:  55%|█████▌    | 11/20 [11:43<09:06, 60.76s/it]                 Task 2, Epoch 12/20 => Loss 2.066, Train_accy 94.23:  60%|██████    | 12/20 [11:43<07:50, 58.82s/it]Task 2, Epoch 13/20 => Loss 2.064, Train_accy 94.16:  60%|██████    | 12/20 [12:38<07:50, 58.82s/it]Task 2, Epoch 13/20 => Loss 2.064, Train_accy 94.16:  65%|██████▌   | 13/20 [12:38<06:41, 57.42s/it]Task 2, Epoch 14/20 => Loss 2.049, Train_accy 94.19:  65%|██████▌   | 13/20 [13:32<06:41, 57.42s/it]Task 2, Epoch 14/20 => Loss 2.049, Train_accy 94.19:  70%|███████   | 14/20 [13:32<05:38, 56.46s/it]Task 2, Epoch 15/20 => Loss 2.045, Train_accy 94.53:  70%|███████   | 14/20 [14:26<05:38, 56.46s/it]Task 2, Epoch 15/20 => Loss 2.045, Train_accy 94.53:  75%|███████▌  | 15/20 [14:26<04:38, 55.78s/it]Task 2, Epoch 16/20 => Loss 2.046, Train_accy 94.66, Test_accy 84.97:  75%|███████▌  | 15/20 [15:38<04:38, 55.78s/it]Task 2, Epoch 16/20 => Loss 2.046, Train_accy 94.66, Test_accy 84.97:  80%|████████  | 16/20 [15:38<04:02, 60.53s/it]Task 2, Epoch 17/20 => Loss 2.040, Train_accy 94.66:  80%|████████  | 16/20 [16:32<04:02, 60.53s/it]                 Task 2, Epoch 17/20 => Loss 2.040, Train_accy 94.66:  85%|████████▌ | 17/20 [16:32<02:55, 58.64s/it]Task 2, Epoch 18/20 => Loss 2.067, Train_accy 94.44:  85%|████████▌ | 17/20 [17:26<02:55, 58.64s/it]Task 2, Epoch 18/20 => Loss 2.067, Train_accy 94.44:  90%|█████████ | 18/20 [17:26<01:54, 57.40s/it]Task 2, Epoch 19/20 => Loss 2.021, Train_accy 95.02:  90%|█████████ | 18/20 [18:21<01:54, 57.40s/it]Task 2, Epoch 19/20 => Loss 2.021, Train_accy 95.02:  95%|█████████▌| 19/20 [18:21<00:56, 56.47s/it]Task 2, Epoch 20/20 => Loss 2.023, Train_accy 95.23:  95%|█████████▌| 19/20 [19:15<00:56, 56.47s/it]Task 2, Epoch 20/20 => Loss 2.023, Train_accy 95.23: 100%|██████████| 20/20 [19:15<00:00, 55.78s/it]Task 2, Epoch 20/20 => Loss 2.023, Train_accy 95.23: 100%|██████████| 20/20 [19:15<00:00, 57.77s/it]
2024-04-28 19:12:01,903 [icarl.py] => Task 2, Epoch 20/20 => Loss 2.023, Train_accy 95.23
2024-04-28 19:12:01,904 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-28 19:13:08,883 [icarl.py] => Exemplar size: 1400
2024-04-28 19:13:08,883 [trainer.py] => CNN: {'total': 83.77, '00-49': 81.34, '50-59': 81.9, '60-69': 97.8, 'old': 81.43, 'new': 97.8}
2024-04-28 19:13:08,883 [trainer.py] => NME: {'total': 90.47, '00-49': 90.42, '50-59': 87.0, '60-69': 94.2, 'old': 89.85, 'new': 94.2}
2024-04-28 19:13:08,883 [trainer.py] => CNN top1 curve: [93.12, 86.67, 83.77]
2024-04-28 19:13:08,883 [trainer.py] => CNN top5 curve: [99.14, 98.4, 97.19]
2024-04-28 19:13:08,883 [trainer.py] => NME top1 curve: [93.38, 91.78, 90.47]
2024-04-28 19:13:08,883 [trainer.py] => NME top5 curve: [99.3, 99.1, 98.9]

Average Accuracy (CNN): 87.85
Average Accuracy (NME): 91.88
2024-04-28 19:13:08,883 [trainer.py] => Average Accuracy (CNN): 87.85
2024-04-28 19:13:08,883 [trainer.py] => Average Accuracy (NME): 91.88
2024-04-28 19:13:08,884 [trainer.py] => Train Time: 0
2024-04-28 19:13:08,884 [trainer.py] => Test Time: 90.2 

2024-04-28 19:13:08,884 [trainer.py] => All params: 85852486
2024-04-28 19:13:08,884 [trainer.py] => Trainable params: 85852486
2024-04-28 19:13:08,886 [icarl.py] => Learning on 70-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.995, Train_accy 76.25, Test_accy 76.21:   0%|          | 0/20 [01:15<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.995, Train_accy 76.25, Test_accy 76.21:   5%|▌         | 1/20 [01:15<24:00, 75.82s/it]Task 3, Epoch 2/20 => Loss 2.146, Train_accy 87.81:   5%|▌         | 1/20 [02:11<24:00, 75.82s/it]                 Task 3, Epoch 2/20 => Loss 2.146, Train_accy 87.81:  10%|█         | 2/20 [02:11<19:15, 64.18s/it]Task 3, Epoch 3/20 => Loss 2.078, Train_accy 89.27:  10%|█         | 2/20 [03:08<19:15, 64.18s/it]Task 3, Epoch 3/20 => Loss 2.078, Train_accy 89.27:  15%|█▌        | 3/20 [03:08<17:08, 60.52s/it]Task 3, Epoch 4/20 => Loss 2.023, Train_accy 90.73:  15%|█▌        | 3/20 [04:04<17:08, 60.52s/it]Task 3, Epoch 4/20 => Loss 2.023, Train_accy 90.73:  20%|██        | 4/20 [04:04<15:41, 58.83s/it]Task 3, Epoch 5/20 => Loss 2.008, Train_accy 91.66:  20%|██        | 4/20 [05:00<15:41, 58.83s/it]Task 3, Epoch 5/20 => Loss 2.008, Train_accy 91.66:  25%|██▌       | 5/20 [05:00<14:29, 57.94s/it]Task 3, Epoch 6/20 => Loss 1.972, Train_accy 91.98, Test_accy 77.68:  25%|██▌       | 5/20 [06:16<14:29, 57.94s/it]Task 3, Epoch 6/20 => Loss 1.972, Train_accy 91.98, Test_accy 77.68:  30%|███       | 6/20 [06:16<14:58, 64.17s/it]Task 3, Epoch 7/20 => Loss 1.999, Train_accy 91.91:  30%|███       | 6/20 [07:13<14:58, 64.17s/it]                 Task 3, Epoch 7/20 => Loss 1.999, Train_accy 91.91:  35%|███▌      | 7/20 [07:13<13:20, 61.58s/it]Task 3, Epoch 8/20 => Loss 1.956, Train_accy 92.73:  35%|███▌      | 7/20 [08:09<13:20, 61.58s/it]Task 3, Epoch 8/20 => Loss 1.956, Train_accy 92.73:  40%|████      | 8/20 [08:09<11:58, 59.84s/it]Task 3, Epoch 9/20 => Loss 1.962, Train_accy 92.50:  40%|████      | 8/20 [09:05<11:58, 59.84s/it]Task 3, Epoch 9/20 => Loss 1.962, Train_accy 92.50:  45%|████▌     | 9/20 [09:05<10:45, 58.68s/it]Task 3, Epoch 10/20 => Loss 1.952, Train_accy 92.61:  45%|████▌     | 9/20 [10:01<10:45, 58.68s/it]Task 3, Epoch 10/20 => Loss 1.952, Train_accy 92.61:  50%|█████     | 10/20 [10:01<09:39, 57.93s/it]Task 3, Epoch 11/20 => Loss 1.913, Train_accy 93.31, Test_accy 77.92:  50%|█████     | 10/20 [11:17<09:39, 57.93s/it]Task 3, Epoch 11/20 => Loss 1.913, Train_accy 93.31, Test_accy 77.92:  55%|█████▌    | 11/20 [11:17<09:31, 63.50s/it]Task 3, Epoch 12/20 => Loss 1.919, Train_accy 93.55:  55%|█████▌    | 11/20 [12:13<09:31, 63.50s/it]                 Task 3, Epoch 12/20 => Loss 1.919, Train_accy 93.55:  60%|██████    | 12/20 [12:13<08:09, 61.24s/it]Task 3, Epoch 13/20 => Loss 1.896, Train_accy 93.78:  60%|██████    | 12/20 [13:09<08:09, 61.24s/it]Task 3, Epoch 13/20 => Loss 1.896, Train_accy 93.78:  65%|██████▌   | 13/20 [13:09<06:57, 59.69s/it]Task 3, Epoch 14/20 => Loss 1.940, Train_accy 93.39:  65%|██████▌   | 13/20 [14:06<06:57, 59.69s/it]Task 3, Epoch 14/20 => Loss 1.940, Train_accy 93.39:  70%|███████   | 14/20 [14:06<05:51, 58.66s/it]Task 3, Epoch 15/20 => Loss 1.952, Train_accy 93.09:  70%|███████   | 14/20 [15:02<05:51, 58.66s/it]Task 3, Epoch 15/20 => Loss 1.952, Train_accy 93.09:  75%|███████▌  | 15/20 [15:02<04:49, 57.90s/it]Task 3, Epoch 16/20 => Loss 1.881, Train_accy 94.30, Test_accy 78.95:  75%|███████▌  | 15/20 [16:18<04:49, 57.90s/it]Task 3, Epoch 16/20 => Loss 1.881, Train_accy 94.30, Test_accy 78.95:  80%|████████  | 16/20 [16:18<04:13, 63.32s/it]Task 3, Epoch 17/20 => Loss 1.940, Train_accy 93.77:  80%|████████  | 16/20 [17:14<04:13, 63.32s/it]                 Task 3, Epoch 17/20 => Loss 1.940, Train_accy 93.77:  85%|████████▌ | 17/20 [17:14<03:03, 61.13s/it]Task 3, Epoch 18/20 => Loss 1.874, Train_accy 94.69:  85%|████████▌ | 17/20 [18:10<03:03, 61.13s/it]Task 3, Epoch 18/20 => Loss 1.874, Train_accy 94.69:  90%|█████████ | 18/20 [18:10<01:59, 59.58s/it]Task 3, Epoch 19/20 => Loss 1.904, Train_accy 94.20:  90%|█████████ | 18/20 [19:06<01:59, 59.58s/it]Task 3, Epoch 19/20 => Loss 1.904, Train_accy 94.20:  95%|█████████▌| 19/20 [19:06<00:58, 58.51s/it]Task 3, Epoch 20/20 => Loss 1.886, Train_accy 94.53:  95%|█████████▌| 19/20 [20:02<00:58, 58.51s/it]Task 3, Epoch 20/20 => Loss 1.886, Train_accy 94.53: 100%|██████████| 20/20 [20:02<00:00, 57.76s/it]Task 3, Epoch 20/20 => Loss 1.886, Train_accy 94.53: 100%|██████████| 20/20 [20:02<00:00, 60.12s/it]
2024-04-28 19:33:11,275 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.886, Train_accy 94.53
2024-04-28 19:33:11,276 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-28 19:34:25,472 [icarl.py] => Exemplar size: 1600
2024-04-28 19:34:25,472 [trainer.py] => CNN: {'total': 78.2, '00-49': 75.68, '50-59': 64.4, '60-69': 86.6, '70-79': 96.2, 'old': 75.63, 'new': 96.2}
2024-04-28 19:34:25,472 [trainer.py] => NME: {'total': 87.14, '00-49': 87.82, '50-59': 78.3, '60-69': 88.3, '70-79': 91.4, 'old': 86.53, 'new': 91.4}
2024-04-28 19:34:25,472 [trainer.py] => CNN top1 curve: [93.12, 86.67, 83.77, 78.2]
2024-04-28 19:34:25,472 [trainer.py] => CNN top5 curve: [99.14, 98.4, 97.19, 95.61]
2024-04-28 19:34:25,472 [trainer.py] => NME top1 curve: [93.38, 91.78, 90.47, 87.14]
2024-04-28 19:34:25,472 [trainer.py] => NME top5 curve: [99.3, 99.1, 98.9, 98.65]

Average Accuracy (CNN): 85.44
Average Accuracy (NME): 90.69
2024-04-28 19:34:25,473 [trainer.py] => Average Accuracy (CNN): 85.44
2024-04-28 19:34:25,473 [trainer.py] => Average Accuracy (NME): 90.69
2024-04-28 19:34:25,473 [trainer.py] => Train Time: 0
2024-04-28 19:34:25,473 [trainer.py] => Test Time: 130.34 

2024-04-28 19:34:25,473 [trainer.py] => All params: 85860176
2024-04-28 19:34:25,474 [trainer.py] => Trainable params: 85860176
2024-04-28 19:34:25,475 [icarl.py] => Learning on 80-90
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.234, Train_accy 77.53, Test_accy 75.59:   0%|          | 0/20 [01:20<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.234, Train_accy 77.53, Test_accy 75.59:   5%|▌         | 1/20 [01:20<25:25, 80.27s/it]Task 4, Epoch 2/20 => Loss 2.420, Train_accy 88.41:   5%|▌         | 1/20 [02:18<25:25, 80.27s/it]                 Task 4, Epoch 2/20 => Loss 2.420, Train_accy 88.41:  10%|█         | 2/20 [02:18<20:07, 67.11s/it]Task 4, Epoch 3/20 => Loss 2.292, Train_accy 91.56:  10%|█         | 2/20 [03:16<20:07, 67.11s/it]Task 4, Epoch 3/20 => Loss 2.292, Train_accy 91.56:  15%|█▌        | 3/20 [03:16<17:50, 62.96s/it]Task 4, Epoch 4/20 => Loss 2.304, Train_accy 91.76:  15%|█▌        | 3/20 [04:14<17:50, 62.96s/it]Task 4, Epoch 4/20 => Loss 2.304, Train_accy 91.76:  20%|██        | 4/20 [04:14<16:14, 60.94s/it]Task 4, Epoch 5/20 => Loss 2.280, Train_accy 92.55:  20%|██        | 4/20 [05:11<16:14, 60.94s/it]Task 4, Epoch 5/20 => Loss 2.280, Train_accy 92.55:  25%|██▌       | 5/20 [05:11<14:57, 59.84s/it]Task 4, Epoch 6/20 => Loss 2.257, Train_accy 92.33, Test_accy 75.04:  25%|██▌       | 5/20 [06:32<14:57, 59.84s/it]Task 4, Epoch 6/20 => Loss 2.257, Train_accy 92.33, Test_accy 75.04:  30%|███       | 6/20 [06:32<15:34, 66.77s/it]Task 4, Epoch 7/20 => Loss 2.256, Train_accy 92.79:  30%|███       | 6/20 [07:30<15:34, 66.77s/it]                 Task 4, Epoch 7/20 => Loss 2.256, Train_accy 92.79:  35%|███▌      | 7/20 [07:30<13:50, 63.89s/it]Task 4, Epoch 8/20 => Loss 2.215, Train_accy 93.53:  35%|███▌      | 7/20 [08:28<13:50, 63.89s/it]Task 4, Epoch 8/20 => Loss 2.215, Train_accy 93.53:  40%|████      | 8/20 [08:28<12:24, 62.02s/it]Task 4, Epoch 9/20 => Loss 2.235, Train_accy 93.41:  40%|████      | 8/20 [09:25<12:24, 62.02s/it]Task 4, Epoch 9/20 => Loss 2.235, Train_accy 93.41:  45%|████▌     | 9/20 [09:25<11:07, 60.72s/it]Task 4, Epoch 10/20 => Loss 2.217, Train_accy 93.71:  45%|████▌     | 9/20 [10:23<11:07, 60.72s/it]Task 4, Epoch 10/20 => Loss 2.217, Train_accy 93.71:  50%|█████     | 10/20 [10:23<09:58, 59.84s/it]Task 4, Epoch 11/20 => Loss 2.215, Train_accy 93.59, Test_accy 74.59:  50%|█████     | 10/20 [11:44<09:58, 59.84s/it]Task 4, Epoch 11/20 => Loss 2.215, Train_accy 93.59, Test_accy 74.59:  55%|█████▌    | 11/20 [11:44<09:55, 66.14s/it]Task 4, Epoch 12/20 => Loss 2.219, Train_accy 93.44:  55%|█████▌    | 11/20 [12:42<09:55, 66.14s/it]                 Task 4, Epoch 12/20 => Loss 2.219, Train_accy 93.44:  60%|██████    | 12/20 [12:42<08:29, 63.71s/it]Task 4, Epoch 13/20 => Loss 2.229, Train_accy 93.89:  60%|██████    | 12/20 [13:40<08:29, 63.71s/it]Task 4, Epoch 13/20 => Loss 2.229, Train_accy 93.89:  65%|██████▌   | 13/20 [13:40<07:13, 61.95s/it]Task 4, Epoch 14/20 => Loss 2.185, Train_accy 94.53:  65%|██████▌   | 13/20 [14:38<07:13, 61.95s/it]Task 4, Epoch 14/20 => Loss 2.185, Train_accy 94.53:  70%|███████   | 14/20 [14:38<06:04, 60.74s/it]Task 4, Epoch 15/20 => Loss 2.219, Train_accy 93.91:  70%|███████   | 14/20 [15:36<06:04, 60.74s/it]Task 4, Epoch 15/20 => Loss 2.219, Train_accy 93.91:  75%|███████▌  | 15/20 [15:36<04:59, 59.92s/it]Task 4, Epoch 16/20 => Loss 2.200, Train_accy 94.23, Test_accy 74.91:  75%|███████▌  | 15/20 [16:56<04:59, 59.92s/it]Task 4, Epoch 16/20 => Loss 2.200, Train_accy 94.23, Test_accy 74.91:  80%|████████  | 16/20 [16:56<04:23, 65.99s/it]Task 4, Epoch 17/20 => Loss 2.202, Train_accy 94.23:  80%|████████  | 16/20 [17:54<04:23, 65.99s/it]                 Task 4, Epoch 17/20 => Loss 2.202, Train_accy 94.23:  85%|████████▌ | 17/20 [17:54<03:10, 63.52s/it]Task 4, Epoch 18/20 => Loss 2.202, Train_accy 94.27:  85%|████████▌ | 17/20 [18:51<03:10, 63.52s/it]Task 4, Epoch 18/20 => Loss 2.202, Train_accy 94.27:  90%|█████████ | 18/20 [18:51<02:03, 61.77s/it]Task 4, Epoch 19/20 => Loss 2.199, Train_accy 94.24:  90%|█████████ | 18/20 [19:49<02:03, 61.77s/it]Task 4, Epoch 19/20 => Loss 2.199, Train_accy 94.24:  95%|█████████▌| 19/20 [19:49<01:00, 60.54s/it]Task 4, Epoch 20/20 => Loss 2.197, Train_accy 94.67:  95%|█████████▌| 19/20 [20:47<01:00, 60.54s/it]Task 4, Epoch 20/20 => Loss 2.197, Train_accy 94.67: 100%|██████████| 20/20 [20:47<00:00, 59.69s/it]Task 4, Epoch 20/20 => Loss 2.197, Train_accy 94.67: 100%|██████████| 20/20 [20:47<00:00, 62.36s/it]
2024-04-28 19:55:12,762 [icarl.py] => Task 4, Epoch 20/20 => Loss 2.197, Train_accy 94.67
2024-04-28 19:55:12,763 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-28 19:56:33,086 [icarl.py] => Exemplar size: 1800
2024-04-28 19:56:33,087 [trainer.py] => CNN: {'total': 74.78, '00-49': 69.4, '50-59': 61.3, '60-69': 79.5, '70-79': 88.9, '80-89': 96.3, 'old': 72.09, 'new': 96.3}
2024-04-28 19:56:33,087 [trainer.py] => NME: {'total': 84.91, '00-49': 84.42, '50-59': 76.2, '60-69': 86.9, '70-79': 88.2, '80-89': 90.8, 'old': 84.18, 'new': 90.8}
2024-04-28 19:56:33,087 [trainer.py] => CNN top1 curve: [93.12, 86.67, 83.77, 78.2, 74.78]
2024-04-28 19:56:33,087 [trainer.py] => CNN top5 curve: [99.14, 98.4, 97.19, 95.61, 93.62]
2024-04-28 19:56:33,087 [trainer.py] => NME top1 curve: [93.38, 91.78, 90.47, 87.14, 84.91]
2024-04-28 19:56:33,087 [trainer.py] => NME top5 curve: [99.3, 99.1, 98.9, 98.65, 97.81]

Average Accuracy (CNN): 83.31
Average Accuracy (NME): 89.54
2024-04-28 19:56:33,087 [trainer.py] => Average Accuracy (CNN): 83.31
2024-04-28 19:56:33,087 [trainer.py] => Average Accuracy (NME): 89.54
2024-04-28 19:56:33,087 [trainer.py] => Train Time: 0
2024-04-28 19:56:33,087 [trainer.py] => Test Time: 174.95 

2024-04-28 19:56:33,088 [trainer.py] => All params: 85867866
2024-04-28 19:56:33,088 [trainer.py] => Trainable params: 85867866
2024-04-28 19:56:33,090 [icarl.py] => Learning on 90-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 3.242, Train_accy 78.76, Test_accy 72.53:   0%|          | 0/20 [01:24<?, ?it/s]Task 5, Epoch 1/20 => Loss 3.242, Train_accy 78.76, Test_accy 72.53:   5%|▌         | 1/20 [01:24<26:36, 84.03s/it]Task 5, Epoch 2/20 => Loss 2.493, Train_accy 88.88:   5%|▌         | 1/20 [02:23<26:36, 84.03s/it]                 Task 5, Epoch 2/20 => Loss 2.493, Train_accy 88.88:  10%|█         | 2/20 [02:23<20:52, 69.56s/it]Task 5, Epoch 3/20 => Loss 2.430, Train_accy 90.51:  10%|█         | 2/20 [03:22<20:52, 69.56s/it]Task 5, Epoch 3/20 => Loss 2.430, Train_accy 90.51:  15%|█▌        | 3/20 [03:22<18:23, 64.91s/it]Task 5, Epoch 4/20 => Loss 2.405, Train_accy 91.13:  15%|█▌        | 3/20 [04:22<18:23, 64.91s/it]Task 5, Epoch 4/20 => Loss 2.405, Train_accy 91.13:  20%|██        | 4/20 [04:22<16:44, 62.77s/it]Task 5, Epoch 5/20 => Loss 2.402, Train_accy 91.51:  20%|██        | 4/20 [05:21<16:44, 62.77s/it]Task 5, Epoch 5/20 => Loss 2.402, Train_accy 91.51:  25%|██▌       | 5/20 [05:21<15:23, 61.54s/it]Task 5, Epoch 6/20 => Loss 2.383, Train_accy 92.12, Test_accy 73.09:  25%|██▌       | 5/20 [06:45<15:23, 61.54s/it]Task 5, Epoch 6/20 => Loss 2.383, Train_accy 92.12, Test_accy 73.09:  30%|███       | 6/20 [06:45<16:09, 69.22s/it]Task 5, Epoch 7/20 => Loss 2.315, Train_accy 93.03:  30%|███       | 6/20 [07:45<16:09, 69.22s/it]                 Task 5, Epoch 7/20 => Loss 2.315, Train_accy 93.03:  35%|███▌      | 7/20 [07:45<14:18, 66.02s/it]Task 5, Epoch 8/20 => Loss 2.368, Train_accy 92.65:  35%|███▌      | 7/20 [08:44<14:18, 66.02s/it]Task 5, Epoch 8/20 => Loss 2.368, Train_accy 92.65:  40%|████      | 8/20 [08:44<12:47, 63.95s/it]Task 5, Epoch 9/20 => Loss 2.363, Train_accy 92.81:  40%|████      | 8/20 [09:44<12:47, 63.95s/it]Task 5, Epoch 9/20 => Loss 2.363, Train_accy 92.81:  45%|████▌     | 9/20 [09:44<11:28, 62.57s/it]Task 5, Epoch 10/20 => Loss 2.386, Train_accy 92.51:  45%|████▌     | 9/20 [10:43<11:28, 62.57s/it]Task 5, Epoch 10/20 => Loss 2.386, Train_accy 92.51:  50%|█████     | 10/20 [10:43<10:16, 61.63s/it]Task 5, Epoch 11/20 => Loss 2.335, Train_accy 93.21, Test_accy 73.72:  50%|█████     | 10/20 [12:08<10:16, 61.63s/it]Task 5, Epoch 11/20 => Loss 2.335, Train_accy 93.21, Test_accy 73.72:  55%|█████▌    | 11/20 [12:08<10:18, 68.68s/it]Task 5, Epoch 12/20 => Loss 2.305, Train_accy 93.78:  55%|█████▌    | 11/20 [13:08<10:18, 68.68s/it]                 Task 5, Epoch 12/20 => Loss 2.305, Train_accy 93.78:  60%|██████    | 12/20 [13:08<08:47, 65.92s/it]Task 5, Epoch 13/20 => Loss 2.354, Train_accy 93.10:  60%|██████    | 12/20 [14:07<08:47, 65.92s/it]Task 5, Epoch 13/20 => Loss 2.354, Train_accy 93.10:  65%|██████▌   | 13/20 [14:07<07:27, 63.98s/it]Task 5, Epoch 14/20 => Loss 2.290, Train_accy 93.66:  65%|██████▌   | 13/20 [15:07<07:27, 63.98s/it]Task 5, Epoch 14/20 => Loss 2.290, Train_accy 93.66:  70%|███████   | 14/20 [15:07<06:15, 62.66s/it]Task 5, Epoch 15/20 => Loss 2.309, Train_accy 93.63:  70%|███████   | 14/20 [16:06<06:15, 62.66s/it]Task 5, Epoch 15/20 => Loss 2.309, Train_accy 93.63:  75%|███████▌  | 15/20 [16:06<05:08, 61.75s/it]Task 5, Epoch 16/20 => Loss 2.307, Train_accy 93.81, Test_accy 71.38:  75%|███████▌  | 15/20 [17:31<05:08, 61.75s/it]Task 5, Epoch 16/20 => Loss 2.307, Train_accy 93.81, Test_accy 71.38:  80%|████████  | 16/20 [17:31<04:34, 68.53s/it]Task 5, Epoch 17/20 => Loss 2.304, Train_accy 94.16:  80%|████████  | 16/20 [18:30<04:34, 68.53s/it]                 Task 5, Epoch 17/20 => Loss 2.304, Train_accy 94.16:  85%|████████▌ | 17/20 [18:30<03:17, 65.80s/it]Task 5, Epoch 18/20 => Loss 2.309, Train_accy 93.87:  85%|████████▌ | 17/20 [19:30<03:17, 65.80s/it]Task 5, Epoch 18/20 => Loss 2.309, Train_accy 93.87:  90%|█████████ | 18/20 [19:30<02:07, 63.90s/it]Task 5, Epoch 19/20 => Loss 2.310, Train_accy 94.06:  90%|█████████ | 18/20 [20:29<02:07, 63.90s/it]Task 5, Epoch 19/20 => Loss 2.310, Train_accy 94.06:  95%|█████████▌| 19/20 [20:29<01:02, 62.55s/it]Task 5, Epoch 20/20 => Loss 2.289, Train_accy 94.47:  95%|█████████▌| 19/20 [21:28<01:02, 62.55s/it]Task 5, Epoch 20/20 => Loss 2.289, Train_accy 94.47: 100%|██████████| 20/20 [21:28<00:00, 61.61s/it]Task 5, Epoch 20/20 => Loss 2.289, Train_accy 94.47: 100%|██████████| 20/20 [21:28<00:00, 64.44s/it]
2024-04-28 20:18:02,036 [icarl.py] => Task 5, Epoch 20/20 => Loss 2.289, Train_accy 94.47
2024-04-28 20:18:02,037 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-28 20:19:29,453 [icarl.py] => Exemplar size: 2000
2024-04-28 20:19:29,453 [trainer.py] => CNN: {'total': 73.97, '00-49': 67.36, '50-59': 59.5, '60-69': 75.5, '70-79': 81.2, '80-89': 90.2, '90-99': 96.5, 'old': 71.47, 'new': 96.5}
2024-04-28 20:19:29,453 [trainer.py] => NME: {'total': 83.62, '00-49': 82.84, '50-59': 74.1, '60-69': 84.9, '70-79': 83.9, '80-89': 88.8, '90-99': 90.3, 'old': 82.88, 'new': 90.3}
2024-04-28 20:19:29,453 [trainer.py] => CNN top1 curve: [93.12, 86.67, 83.77, 78.2, 74.78, 73.97]
2024-04-28 20:19:29,453 [trainer.py] => CNN top5 curve: [99.14, 98.4, 97.19, 95.61, 93.62, 91.77]
2024-04-28 20:19:29,453 [trainer.py] => NME top1 curve: [93.38, 91.78, 90.47, 87.14, 84.91, 83.62]
2024-04-28 20:19:29,453 [trainer.py] => NME top5 curve: [99.3, 99.1, 98.9, 98.65, 97.81, 97.14]

Average Accuracy (CNN): 81.75
Average Accuracy (NME): 88.55
2024-04-28 20:19:29,453 [trainer.py] => Average Accuracy (CNN): 81.75
2024-04-28 20:19:29,453 [trainer.py] => Average Accuracy (NME): 88.55
2024-04-28 20:19:29,453 [trainer.py] => Train Time: 0
2024-04-28 20:19:29,453 [trainer.py] => Test Time: 224.27999999999997 

Accuracy Matrix (CNN):
[[93.12 84.42 81.34 75.68 69.4  67.36]
 [ 0.   97.9  81.9  64.4  61.3  59.5 ]
 [ 0.    0.   97.8  86.6  79.5  75.5 ]
 [ 0.    0.    0.   96.2  88.9  81.2 ]
 [ 0.    0.    0.    0.   96.3  90.2 ]
 [ 0.    0.    0.    0.    0.   96.5 ]]
2024-04-28 20:19:29,454 [trainer.py] => Forgetting (CNN): 21.512
Accuracy Matrix (NME):
[[93.38 91.58 90.42 87.82 84.42 82.84]
 [ 0.   92.8  87.   78.3  76.2  74.1 ]
 [ 0.    0.   94.2  88.3  86.9  84.9 ]
 [ 0.    0.    0.   91.4  88.2  83.9 ]
 [ 0.    0.    0.    0.   90.8  88.8 ]
 [ 0.    0.    0.    0.    0.   90.3 ]]
2024-04-28 20:19:29,454 [trainer.py] => Forgetting (NME): 9.607999999999999
2024-04-28 20:19:32,033 [trainer.py] => config: ./exps/der_cifar_B50_Inc5.json
2024-04-28 20:19:32,033 [trainer.py] => prefix: reproduce
2024-04-28 20:19:32,033 [trainer.py] => dataset: cifar224
2024-04-28 20:19:32,033 [trainer.py] => memory_size: 2000
2024-04-28 20:19:32,033 [trainer.py] => memory_per_class: 20
2024-04-28 20:19:32,033 [trainer.py] => fixed_memory: False
2024-04-28 20:19:32,033 [trainer.py] => shuffle: True
2024-04-28 20:19:32,033 [trainer.py] => init_cls: 50
2024-04-28 20:19:32,033 [trainer.py] => increment: 10
2024-04-28 20:19:32,033 [trainer.py] => model_name: der
2024-04-28 20:19:32,033 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-28 20:19:32,033 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-28 20:19:32,033 [trainer.py] => seed: 1993
2024-04-28 20:19:32,033 [trainer.py] => init_epoch: 20
2024-04-28 20:19:32,033 [trainer.py] => init_lr: 0.001
2024-04-28 20:19:32,033 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-28 20:19:32,033 [trainer.py] => init_lr_decay: 0.1
2024-04-28 20:19:32,033 [trainer.py] => init_weight_decay: 0.0005
2024-04-28 20:19:32,033 [trainer.py] => epochs: 20
2024-04-28 20:19:32,033 [trainer.py] => lrate: 0.001
2024-04-28 20:19:32,033 [trainer.py] => milestones: [80, 120, 150]
2024-04-28 20:19:32,033 [trainer.py] => lrate_decay: 0.1
2024-04-28 20:19:32,033 [trainer.py] => batch_size: 48
2024-04-28 20:19:32,033 [trainer.py] => weight_decay: 0.0002
2024-04-28 20:19:32,033 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-04-28 20:19:33,820 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-28 20:19:34,228 [trainer.py] => All params: 0
2024-04-28 20:19:34,228 [trainer.py] => Trainable params: 0
2024-04-28 20:19:35,779 [der.py] => Learning on 0-50
2024-04-28 20:19:35,779 [der.py] => All params: 85876325
2024-04-28 20:19:35,780 [der.py] => Trainable params: 85876325
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.686, Train_accy 31.39, Test_accy 89.34:   0%|          | 0/20 [02:53<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.686, Train_accy 31.39, Test_accy 89.34:   5%|▌         | 1/20 [02:53<55:03, 173.84s/it]Task 0, Epoch 2/20 => Loss 0.877, Train_accy 75.65:   5%|▌         | 1/20 [05:36<55:03, 173.84s/it]                 Task 0, Epoch 2/20 => Loss 0.877, Train_accy 75.65:  10%|█         | 2/20 [05:36<50:06, 167.03s/it]Task 0, Epoch 3/20 => Loss 0.715, Train_accy 79.86:  10%|█         | 2/20 [08:18<50:06, 167.03s/it]Task 0, Epoch 3/20 => Loss 0.715, Train_accy 79.86:  15%|█▌        | 3/20 [08:18<46:42, 164.88s/it]Task 0, Epoch 4/20 => Loss 0.639, Train_accy 81.65:  15%|█▌        | 3/20 [11:00<46:42, 164.88s/it]Task 0, Epoch 4/20 => Loss 0.639, Train_accy 81.65:  20%|██        | 4/20 [11:00<43:40, 163.76s/it]Task 0, Epoch 5/20 => Loss 0.585, Train_accy 83.38:  20%|██        | 4/20 [13:43<43:40, 163.76s/it]Task 0, Epoch 5/20 => Loss 0.585, Train_accy 83.38:  25%|██▌       | 5/20 [13:43<40:51, 163.41s/it]Task 0, Epoch 6/20 => Loss 0.546, Train_accy 84.55, Test_accy 93.40:  25%|██▌       | 5/20 [16:38<40:51, 163.41s/it]Task 0, Epoch 6/20 => Loss 0.546, Train_accy 84.55, Test_accy 93.40:  30%|███       | 6/20 [16:38<39:02, 167.34s/it]Task 0, Epoch 7/20 => Loss 0.520, Train_accy 85.21:  30%|███       | 6/20 [19:20<39:02, 167.34s/it]                 Task 0, Epoch 7/20 => Loss 0.520, Train_accy 85.21:  35%|███▌      | 7/20 [19:20<35:54, 165.73s/it]Task 0, Epoch 8/20 => Loss 0.497, Train_accy 86.15:  35%|███▌      | 7/20 [22:02<35:54, 165.73s/it]Task 0, Epoch 8/20 => Loss 0.497, Train_accy 86.15:  40%|████      | 8/20 [22:02<32:55, 164.64s/it]Task 0, Epoch 9/20 => Loss 0.486, Train_accy 86.12:  40%|████      | 8/20 [24:45<32:55, 164.64s/it]Task 0, Epoch 9/20 => Loss 0.486, Train_accy 86.12:  45%|████▌     | 9/20 [24:45<30:02, 163.86s/it]Task 0, Epoch 10/20 => Loss 0.458, Train_accy 86.98:  45%|████▌     | 9/20 [27:27<30:02, 163.86s/it]Task 0, Epoch 10/20 => Loss 0.458, Train_accy 86.98:  50%|█████     | 10/20 [27:27<27:15, 163.52s/it]Task 0, Epoch 11/20 => Loss 0.449, Train_accy 87.20, Test_accy 92.80:  50%|█████     | 10/20 [30:23<27:15, 163.52s/it]Task 0, Epoch 11/20 => Loss 0.449, Train_accy 87.20, Test_accy 92.80:  55%|█████▌    | 11/20 [30:23<25:04, 167.12s/it]Task 0, Epoch 12/20 => Loss 0.432, Train_accy 87.81:  55%|█████▌    | 11/20 [33:05<25:04, 167.12s/it]                 Task 0, Epoch 12/20 => Loss 0.432, Train_accy 87.81:  60%|██████    | 12/20 [33:05<22:04, 165.58s/it]Task 0, Epoch 13/20 => Loss 0.425, Train_accy 87.78:  60%|██████    | 12/20 [35:47<22:04, 165.58s/it]Task 0, Epoch 13/20 => Loss 0.425, Train_accy 87.78:  65%|██████▌   | 13/20 [35:47<19:11, 164.55s/it]Task 0, Epoch 14/20 => Loss 0.415, Train_accy 88.24:  65%|██████▌   | 13/20 [38:29<19:11, 164.55s/it]Task 0, Epoch 14/20 => Loss 0.415, Train_accy 88.24:  70%|███████   | 14/20 [38:29<16:22, 163.80s/it]Task 0, Epoch 15/20 => Loss 0.410, Train_accy 88.48:  70%|███████   | 14/20 [41:11<16:22, 163.80s/it]Task 0, Epoch 15/20 => Loss 0.410, Train_accy 88.48:  75%|███████▌  | 15/20 [41:11<13:35, 163.19s/it]Task 0, Epoch 16/20 => Loss 0.392, Train_accy 88.87, Test_accy 92.94:  75%|███████▌  | 15/20 [44:06<13:35, 163.19s/it]Task 0, Epoch 16/20 => Loss 0.392, Train_accy 88.87, Test_accy 92.94:  80%|████████  | 16/20 [44:06<11:07, 166.78s/it]Task 0, Epoch 17/20 => Loss 0.367, Train_accy 89.56:  80%|████████  | 16/20 [46:48<11:07, 166.78s/it]                 Task 0, Epoch 17/20 => Loss 0.367, Train_accy 89.56:  85%|████████▌ | 17/20 [46:48<08:16, 165.42s/it]Task 0, Epoch 18/20 => Loss 0.379, Train_accy 89.32:  85%|████████▌ | 17/20 [49:30<08:16, 165.42s/it]Task 0, Epoch 18/20 => Loss 0.379, Train_accy 89.32:  90%|█████████ | 18/20 [49:30<05:28, 164.48s/it]Task 0, Epoch 19/20 => Loss 0.369, Train_accy 89.41:  90%|█████████ | 18/20 [52:13<05:28, 164.48s/it]Task 0, Epoch 19/20 => Loss 0.369, Train_accy 89.41:  95%|█████████▌| 19/20 [52:13<02:43, 163.90s/it]Task 0, Epoch 20/20 => Loss 0.367, Train_accy 89.70:  95%|█████████▌| 19/20 [54:55<02:43, 163.90s/it]Task 0, Epoch 20/20 => Loss 0.367, Train_accy 89.70: 100%|██████████| 20/20 [54:55<00:00, 163.21s/it]Task 0, Epoch 20/20 => Loss 0.367, Train_accy 89.70: 100%|██████████| 20/20 [54:55<00:00, 164.75s/it]
2024-04-28 21:14:31,341 [der.py] => Task 0, Epoch 20/20 => Loss 0.367, Train_accy 89.70
2024-04-28 21:14:31,343 [base.py] => Reducing exemplars...(40 per classes)
2024-04-28 21:14:31,344 [base.py] => Constructing exemplars...(40 per classes)
2024-04-28 21:16:30,550 [der.py] => Exemplar size: 2000
2024-04-28 21:16:30,550 [trainer.py] => CNN: {'total': 92.86, '00-49': 92.86, 'old': 0, 'new': 92.86}
2024-04-28 21:16:30,550 [trainer.py] => NME: {'total': 93.08, '00-49': 93.08, 'old': 0, 'new': 93.08}
2024-04-28 21:16:30,550 [trainer.py] => CNN top1 curve: [92.86]
2024-04-28 21:16:30,550 [trainer.py] => CNN top5 curve: [99.26]
2024-04-28 21:16:30,550 [trainer.py] => NME top1 curve: [93.08]
2024-04-28 21:16:30,550 [trainer.py] => NME top5 curve: [99.46]

Average Accuracy (CNN): 92.86
Average Accuracy (NME): 93.08
2024-04-28 21:16:30,551 [trainer.py] => Average Accuracy (CNN): 92.86
2024-04-28 21:16:30,551 [trainer.py] => Average Accuracy (NME): 93.08
2024-04-28 21:16:30,551 [trainer.py] => Train Time: 3295.49
2024-04-28 21:16:30,551 [trainer.py] => Test Time: 25.45 

2024-04-28 21:16:30,551 [trainer.py] => All params: 85876325
2024-04-28 21:16:30,552 [trainer.py] => Trainable params: 85876325
2024-04-28 21:16:32,025 [der.py] => Learning on 50-60
2024-04-28 21:16:32,026 [der.py] => All params: 171697991
2024-04-28 21:16:32,027 [der.py] => Trainable params: 85899335
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.602, Loss_clf 0.950, Loss_aux 0.652, Train_accy 78.06, Test_accy 89.30:   0%|          | 0/20 [01:29<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.602, Loss_clf 0.950, Loss_aux 0.652, Train_accy 78.06, Test_accy 89.30:   5%|▌         | 1/20 [01:29<28:25, 89.75s/it]Task 1, Epoch 2/20 => Loss 0.797, Loss_clf 0.422, Loss_aux 0.375, Train_accy 87.67:   5%|▌         | 1/20 [02:31<28:25, 89.75s/it]                 Task 1, Epoch 2/20 => Loss 0.797, Loss_clf 0.422, Loss_aux 0.375, Train_accy 87.67:  10%|█         | 2/20 [02:31<21:54, 73.02s/it]Task 1, Epoch 3/20 => Loss 0.726, Loss_clf 0.394, Loss_aux 0.332, Train_accy 88.44:  10%|█         | 2/20 [03:32<21:54, 73.02s/it]Task 1, Epoch 3/20 => Loss 0.726, Loss_clf 0.394, Loss_aux 0.332, Train_accy 88.44:  15%|█▌        | 3/20 [03:32<19:10, 67.67s/it]Task 1, Epoch 4/20 => Loss 0.703, Loss_clf 0.385, Loss_aux 0.318, Train_accy 88.74:  15%|█▌        | 3/20 [04:33<19:10, 67.67s/it]Task 1, Epoch 4/20 => Loss 0.703, Loss_clf 0.385, Loss_aux 0.318, Train_accy 88.74:  20%|██        | 4/20 [04:33<17:21, 65.09s/it]Task 1, Epoch 5/20 => Loss 0.619, Loss_clf 0.334, Loss_aux 0.285, Train_accy 89.94:  20%|██        | 4/20 [05:34<17:21, 65.09s/it]Task 1, Epoch 5/20 => Loss 0.619, Loss_clf 0.334, Loss_aux 0.285, Train_accy 89.94:  25%|██▌       | 5/20 [05:34<15:55, 63.70s/it]Task 1, Epoch 6/20 => Loss 0.613, Loss_clf 0.335, Loss_aux 0.279, Train_accy 89.91, Test_accy 88.92:  25%|██▌       | 5/20 [07:04<15:55, 63.70s/it]Task 1, Epoch 6/20 => Loss 0.613, Loss_clf 0.335, Loss_aux 0.279, Train_accy 89.91, Test_accy 88.92:  30%|███       | 6/20 [07:04<16:55, 72.50s/it]Task 1, Epoch 7/20 => Loss 0.607, Loss_clf 0.332, Loss_aux 0.275, Train_accy 90.27:  30%|███       | 6/20 [08:05<16:55, 72.50s/it]                 Task 1, Epoch 7/20 => Loss 0.607, Loss_clf 0.332, Loss_aux 0.275, Train_accy 90.27:  35%|███▌      | 7/20 [08:05<14:53, 68.76s/it]Task 1, Epoch 8/20 => Loss 0.592, Loss_clf 0.326, Loss_aux 0.266, Train_accy 90.60:  35%|███▌      | 7/20 [09:06<14:53, 68.76s/it]Task 1, Epoch 8/20 => Loss 0.592, Loss_clf 0.326, Loss_aux 0.266, Train_accy 90.60:  40%|████      | 8/20 [09:06<13:16, 66.37s/it]Task 1, Epoch 9/20 => Loss 0.598, Loss_clf 0.332, Loss_aux 0.266, Train_accy 90.29:  40%|████      | 8/20 [10:07<13:16, 66.37s/it]Task 1, Epoch 9/20 => Loss 0.598, Loss_clf 0.332, Loss_aux 0.266, Train_accy 90.29:  45%|████▌     | 9/20 [10:07<11:51, 64.65s/it]Task 1, Epoch 10/20 => Loss 0.567, Loss_clf 0.317, Loss_aux 0.250, Train_accy 90.53:  45%|████▌     | 9/20 [11:08<11:51, 64.65s/it]Task 1, Epoch 10/20 => Loss 0.567, Loss_clf 0.317, Loss_aux 0.250, Train_accy 90.53:  50%|█████     | 10/20 [11:08<10:35, 63.55s/it]Task 1, Epoch 11/20 => Loss 0.537, Loss_clf 0.300, Loss_aux 0.237, Train_accy 91.13, Test_accy 88.93:  50%|█████     | 10/20 [12:38<10:35, 63.55s/it]Task 1, Epoch 11/20 => Loss 0.537, Loss_clf 0.300, Loss_aux 0.237, Train_accy 91.13, Test_accy 88.93:  55%|█████▌    | 11/20 [12:38<10:43, 71.54s/it]Task 1, Epoch 12/20 => Loss 0.524, Loss_clf 0.291, Loss_aux 0.234, Train_accy 91.71:  55%|█████▌    | 11/20 [13:39<10:43, 71.54s/it]                 Task 1, Epoch 12/20 => Loss 0.524, Loss_clf 0.291, Loss_aux 0.234, Train_accy 91.71:  60%|██████    | 12/20 [13:39<09:07, 68.48s/it]Task 1, Epoch 13/20 => Loss 0.491, Loss_clf 0.266, Loss_aux 0.225, Train_accy 92.24:  60%|██████    | 12/20 [14:40<09:07, 68.48s/it]Task 1, Epoch 13/20 => Loss 0.491, Loss_clf 0.266, Loss_aux 0.225, Train_accy 92.24:  65%|██████▌   | 13/20 [14:40<07:43, 66.24s/it]Task 1, Epoch 14/20 => Loss 0.512, Loss_clf 0.294, Loss_aux 0.218, Train_accy 91.54:  65%|██████▌   | 13/20 [15:41<07:43, 66.24s/it]Task 1, Epoch 14/20 => Loss 0.512, Loss_clf 0.294, Loss_aux 0.218, Train_accy 91.54:  70%|███████   | 14/20 [15:41<06:28, 64.69s/it]Task 1, Epoch 15/20 => Loss 0.487, Loss_clf 0.275, Loss_aux 0.212, Train_accy 92.01:  70%|███████   | 14/20 [16:43<06:28, 64.69s/it]Task 1, Epoch 15/20 => Loss 0.487, Loss_clf 0.275, Loss_aux 0.212, Train_accy 92.01:  75%|███████▌  | 15/20 [16:43<05:18, 63.61s/it]Task 1, Epoch 16/20 => Loss 0.489, Loss_clf 0.276, Loss_aux 0.213, Train_accy 92.01, Test_accy 89.48:  75%|███████▌  | 15/20 [18:12<05:18, 63.61s/it]Task 1, Epoch 16/20 => Loss 0.489, Loss_clf 0.276, Loss_aux 0.213, Train_accy 92.01, Test_accy 89.48:  80%|████████  | 16/20 [18:12<04:45, 71.46s/it]Task 1, Epoch 17/20 => Loss 0.486, Loss_clf 0.278, Loss_aux 0.207, Train_accy 92.14:  80%|████████  | 16/20 [19:13<04:45, 71.46s/it]                 Task 1, Epoch 17/20 => Loss 0.486, Loss_clf 0.278, Loss_aux 0.207, Train_accy 92.14:  85%|████████▌ | 17/20 [19:13<03:25, 68.37s/it]Task 1, Epoch 18/20 => Loss 0.465, Loss_clf 0.262, Loss_aux 0.203, Train_accy 92.19:  85%|████████▌ | 17/20 [20:15<03:25, 68.37s/it]Task 1, Epoch 18/20 => Loss 0.465, Loss_clf 0.262, Loss_aux 0.203, Train_accy 92.19:  90%|█████████ | 18/20 [20:15<02:12, 66.20s/it]Task 1, Epoch 19/20 => Loss 0.489, Loss_clf 0.277, Loss_aux 0.212, Train_accy 92.11:  90%|█████████ | 18/20 [21:16<02:12, 66.20s/it]Task 1, Epoch 19/20 => Loss 0.489, Loss_clf 0.277, Loss_aux 0.212, Train_accy 92.11:  95%|█████████▌| 19/20 [21:16<01:04, 64.75s/it]Task 1, Epoch 20/20 => Loss 0.484, Loss_clf 0.280, Loss_aux 0.204, Train_accy 92.13:  95%|█████████▌| 19/20 [22:17<01:04, 64.75s/it]Task 1, Epoch 20/20 => Loss 0.484, Loss_clf 0.280, Loss_aux 0.204, Train_accy 92.13: 100%|██████████| 20/20 [22:17<00:00, 63.78s/it]Task 1, Epoch 20/20 => Loss 0.484, Loss_clf 0.280, Loss_aux 0.204, Train_accy 92.13: 100%|██████████| 20/20 [22:17<00:00, 66.90s/it]
2024-04-28 21:38:50,086 [der.py] => Task 1, Epoch 20/20 => Loss 0.484, Loss_clf 0.280, Loss_aux 0.204, Train_accy 92.13
2024-04-28 21:38:50,088 [base.py] => Reducing exemplars...(33 per classes)
2024-04-28 21:39:09,562 [base.py] => Constructing exemplars...(33 per classes)
2024-04-28 21:40:38,187 [der.py] => Exemplar size: 1980
2024-04-28 21:40:38,187 [trainer.py] => CNN: {'total': 90.67, '00-49': 89.7, '50-59': 95.5, 'old': 89.7, 'new': 95.5}
2024-04-28 21:40:38,187 [trainer.py] => NME: {'total': 91.97, '00-49': 91.78, '50-59': 92.9, 'old': 91.78, 'new': 92.9}
2024-04-28 21:40:38,187 [trainer.py] => CNN top1 curve: [92.86, 90.67]
2024-04-28 21:40:38,187 [trainer.py] => CNN top5 curve: [99.26, 98.73]
2024-04-28 21:40:38,187 [trainer.py] => NME top1 curve: [93.08, 91.97]
2024-04-28 21:40:38,187 [trainer.py] => NME top5 curve: [99.46, 99.4]

Average Accuracy (CNN): 91.76
Average Accuracy (NME): 92.52
2024-04-28 21:40:38,187 [trainer.py] => Average Accuracy (CNN): 91.76
2024-04-28 21:40:38,187 [trainer.py] => Average Accuracy (NME): 92.52
2024-04-28 21:40:38,187 [trainer.py] => Train Time: 4633.48
2024-04-28 21:40:38,187 [trainer.py] => Test Time: 82.97 

2024-04-28 21:40:38,189 [trainer.py] => All params: 171697991
2024-04-28 21:40:38,190 [trainer.py] => Trainable params: 85899335
2024-04-28 21:40:39,730 [der.py] => Learning on 60-70
2024-04-28 21:40:39,733 [der.py] => All params: 257565777
2024-04-28 21:40:39,735 [der.py] => Trainable params: 85968465
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.475, Loss_clf 0.916, Loss_aux 0.558, Train_accy 81.17, Test_accy 88.11:   0%|          | 0/20 [02:06<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.475, Loss_clf 0.916, Loss_aux 0.558, Train_accy 81.17, Test_accy 88.11:   5%|▌         | 1/20 [02:06<39:54, 126.02s/it]Task 2, Epoch 2/20 => Loss 0.665, Loss_clf 0.369, Loss_aux 0.296, Train_accy 89.63:   5%|▌         | 1/20 [03:23<39:54, 126.02s/it]                 Task 2, Epoch 2/20 => Loss 0.665, Loss_clf 0.369, Loss_aux 0.296, Train_accy 89.63:  10%|█         | 2/20 [03:23<29:10, 97.26s/it] Task 2, Epoch 3/20 => Loss 0.603, Loss_clf 0.333, Loss_aux 0.270, Train_accy 90.26:  10%|█         | 2/20 [04:39<29:10, 97.26s/it]Task 2, Epoch 3/20 => Loss 0.603, Loss_clf 0.333, Loss_aux 0.270, Train_accy 90.26:  15%|█▌        | 3/20 [04:39<24:54, 87.91s/it]Task 2, Epoch 4/20 => Loss 0.517, Loss_clf 0.286, Loss_aux 0.231, Train_accy 91.56:  15%|█▌        | 3/20 [05:56<24:54, 87.91s/it]Task 2, Epoch 4/20 => Loss 0.517, Loss_clf 0.286, Loss_aux 0.231, Train_accy 91.56:  20%|██        | 4/20 [05:56<22:15, 83.49s/it]Task 2, Epoch 5/20 => Loss 0.547, Loss_clf 0.310, Loss_aux 0.237, Train_accy 91.29:  20%|██        | 4/20 [07:13<22:15, 83.49s/it]Task 2, Epoch 5/20 => Loss 0.547, Loss_clf 0.310, Loss_aux 0.237, Train_accy 91.29:  25%|██▌       | 5/20 [07:13<20:15, 81.04s/it]Task 2, Epoch 6/20 => Loss 0.497, Loss_clf 0.276, Loss_aux 0.221, Train_accy 92.03, Test_accy 88.93:  25%|██▌       | 5/20 [09:19<20:15, 81.04s/it]Task 2, Epoch 6/20 => Loss 0.497, Loss_clf 0.276, Loss_aux 0.221, Train_accy 92.03, Test_accy 88.93:  30%|███       | 6/20 [09:19<22:29, 96.39s/it]Task 2, Epoch 7/20 => Loss 0.488, Loss_clf 0.279, Loss_aux 0.209, Train_accy 92.25:  30%|███       | 6/20 [10:36<22:29, 96.39s/it]                 Task 2, Epoch 7/20 => Loss 0.488, Loss_clf 0.279, Loss_aux 0.209, Train_accy 92.25:  35%|███▌      | 7/20 [10:36<19:29, 89.94s/it]Task 2, Epoch 8/20 => Loss 0.463, Loss_clf 0.262, Loss_aux 0.202, Train_accy 92.55:  35%|███▌      | 7/20 [11:53<19:29, 89.94s/it]Task 2, Epoch 8/20 => Loss 0.463, Loss_clf 0.262, Loss_aux 0.202, Train_accy 92.55:  40%|████      | 8/20 [11:53<17:09, 85.77s/it]Task 2, Epoch 9/20 => Loss 0.483, Loss_clf 0.275, Loss_aux 0.208, Train_accy 92.25:  40%|████      | 8/20 [13:09<17:09, 85.77s/it]Task 2, Epoch 9/20 => Loss 0.483, Loss_clf 0.275, Loss_aux 0.208, Train_accy 92.25:  45%|████▌     | 9/20 [13:09<15:12, 82.99s/it]Task 2, Epoch 10/20 => Loss 0.498, Loss_clf 0.287, Loss_aux 0.212, Train_accy 91.86:  45%|████▌     | 9/20 [14:26<15:12, 82.99s/it]Task 2, Epoch 10/20 => Loss 0.498, Loss_clf 0.287, Loss_aux 0.212, Train_accy 91.86:  50%|█████     | 10/20 [14:26<13:30, 81.08s/it]Task 2, Epoch 11/20 => Loss 0.466, Loss_clf 0.261, Loss_aux 0.205, Train_accy 92.84, Test_accy 89.66:  50%|█████     | 10/20 [16:32<13:30, 81.08s/it]Task 2, Epoch 11/20 => Loss 0.466, Loss_clf 0.261, Loss_aux 0.205, Train_accy 92.84, Test_accy 89.66:  55%|█████▌    | 11/20 [16:32<14:12, 94.77s/it]Task 2, Epoch 12/20 => Loss 0.455, Loss_clf 0.262, Loss_aux 0.193, Train_accy 92.97:  55%|█████▌    | 11/20 [17:49<14:12, 94.77s/it]                 Task 2, Epoch 12/20 => Loss 0.455, Loss_clf 0.262, Loss_aux 0.193, Train_accy 92.97:  60%|██████    | 12/20 [17:49<11:54, 89.29s/it]Task 2, Epoch 13/20 => Loss 0.437, Loss_clf 0.256, Loss_aux 0.181, Train_accy 92.89:  60%|██████    | 12/20 [19:06<11:54, 89.29s/it]Task 2, Epoch 13/20 => Loss 0.437, Loss_clf 0.256, Loss_aux 0.181, Train_accy 92.89:  65%|██████▌   | 13/20 [19:06<09:58, 85.55s/it]Task 2, Epoch 14/20 => Loss 0.414, Loss_clf 0.239, Loss_aux 0.175, Train_accy 93.14:  65%|██████▌   | 13/20 [20:22<09:58, 85.55s/it]Task 2, Epoch 14/20 => Loss 0.414, Loss_clf 0.239, Loss_aux 0.175, Train_accy 93.14:  70%|███████   | 14/20 [20:22<08:17, 82.89s/it]Task 2, Epoch 15/20 => Loss 0.443, Loss_clf 0.261, Loss_aux 0.183, Train_accy 92.94:  70%|███████   | 14/20 [21:39<08:17, 82.89s/it]Task 2, Epoch 15/20 => Loss 0.443, Loss_clf 0.261, Loss_aux 0.183, Train_accy 92.94:  75%|███████▌  | 15/20 [21:39<06:45, 81.06s/it]Task 2, Epoch 16/20 => Loss 0.427, Loss_clf 0.244, Loss_aux 0.184, Train_accy 93.17, Test_accy 88.43:  75%|███████▌  | 15/20 [23:45<06:45, 81.06s/it]Task 2, Epoch 16/20 => Loss 0.427, Loss_clf 0.244, Loss_aux 0.184, Train_accy 93.17, Test_accy 88.43:  80%|████████  | 16/20 [23:45<06:18, 94.63s/it]Task 2, Epoch 17/20 => Loss 0.436, Loss_clf 0.255, Loss_aux 0.182, Train_accy 92.77:  80%|████████  | 16/20 [25:02<06:18, 94.63s/it]                 Task 2, Epoch 17/20 => Loss 0.436, Loss_clf 0.255, Loss_aux 0.182, Train_accy 92.77:  85%|████████▌ | 17/20 [25:02<04:27, 89.32s/it]Task 2, Epoch 18/20 => Loss 0.404, Loss_clf 0.230, Loss_aux 0.174, Train_accy 93.88:  85%|████████▌ | 17/20 [26:19<04:27, 89.32s/it]Task 2, Epoch 18/20 => Loss 0.404, Loss_clf 0.230, Loss_aux 0.174, Train_accy 93.88:  90%|█████████ | 18/20 [26:19<02:51, 85.63s/it]Task 2, Epoch 19/20 => Loss 0.385, Loss_clf 0.219, Loss_aux 0.166, Train_accy 94.03:  90%|█████████ | 18/20 [27:36<02:51, 85.63s/it]Task 2, Epoch 19/20 => Loss 0.385, Loss_clf 0.219, Loss_aux 0.166, Train_accy 94.03:  95%|█████████▌| 19/20 [27:36<01:23, 83.01s/it]Task 2, Epoch 20/20 => Loss 0.418, Loss_clf 0.237, Loss_aux 0.181, Train_accy 93.50:  95%|█████████▌| 19/20 [28:53<01:23, 83.01s/it]Task 2, Epoch 20/20 => Loss 0.418, Loss_clf 0.237, Loss_aux 0.181, Train_accy 93.50: 100%|██████████| 20/20 [28:53<00:00, 81.15s/it]Task 2, Epoch 20/20 => Loss 0.418, Loss_clf 0.237, Loss_aux 0.181, Train_accy 93.50: 100%|██████████| 20/20 [28:53<00:00, 86.68s/it]
2024-04-28 22:09:33,507 [der.py] => Task 2, Epoch 20/20 => Loss 0.418, Loss_clf 0.237, Loss_aux 0.181, Train_accy 93.50
2024-04-28 22:09:33,509 [base.py] => Reducing exemplars...(28 per classes)
2024-04-28 22:09:58,884 [base.py] => Constructing exemplars...(28 per classes)
2024-04-28 22:12:20,336 [der.py] => Exemplar size: 1960
2024-04-28 22:12:20,336 [trainer.py] => CNN: {'total': 89.81, '00-49': 88.98, '50-59': 86.3, '60-69': 97.5, 'old': 88.53, 'new': 97.5}
2024-04-28 22:12:20,336 [trainer.py] => NME: {'total': 91.23, '00-49': 91.0, '50-59': 90.3, '60-69': 93.3, 'old': 90.88, 'new': 93.3}
2024-04-28 22:12:20,336 [trainer.py] => CNN top1 curve: [92.86, 90.67, 89.81]
2024-04-28 22:12:20,336 [trainer.py] => CNN top5 curve: [99.26, 98.73, 98.6]
2024-04-28 22:12:20,336 [trainer.py] => NME top1 curve: [93.08, 91.97, 91.23]
2024-04-28 22:12:20,336 [trainer.py] => NME top5 curve: [99.46, 99.4, 99.19]

Average Accuracy (CNN): 91.11
Average Accuracy (NME): 92.09
2024-04-28 22:12:20,337 [trainer.py] => Average Accuracy (CNN): 91.11
2024-04-28 22:12:20,337 [trainer.py] => Average Accuracy (NME): 92.09
2024-04-28 22:12:20,337 [trainer.py] => Train Time: 6367.2
2024-04-28 22:12:20,337 [trainer.py] => Test Time: 181.53 

2024-04-28 22:12:20,338 [trainer.py] => All params: 257565777
2024-04-28 22:12:20,340 [trainer.py] => Trainable params: 85968465
2024-04-28 22:12:21,736 [der.py] => Learning on 70-80
2024-04-28 22:12:21,739 [der.py] => All params: 343448923
2024-04-28 22:12:21,741 [der.py] => Trainable params: 86052955
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.830, Loss_clf 1.144, Loss_aux 0.685, Train_accy 78.15, Test_accy 84.21:   0%|          | 0/20 [02:46<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.830, Loss_clf 1.144, Loss_aux 0.685, Train_accy 78.15, Test_accy 84.21:   5%|▌         | 1/20 [02:46<52:34, 166.02s/it]Task 3, Epoch 2/20 => Loss 0.798, Loss_clf 0.435, Loss_aux 0.363, Train_accy 87.36:   5%|▌         | 1/20 [04:18<52:34, 166.02s/it]                 Task 3, Epoch 2/20 => Loss 0.798, Loss_clf 0.435, Loss_aux 0.363, Train_accy 87.36:  10%|█         | 2/20 [04:18<36:45, 122.50s/it]Task 3, Epoch 3/20 => Loss 0.718, Loss_clf 0.395, Loss_aux 0.323, Train_accy 88.42:  10%|█         | 2/20 [05:50<36:45, 122.50s/it]Task 3, Epoch 3/20 => Loss 0.718, Loss_clf 0.395, Loss_aux 0.323, Train_accy 88.42:  15%|█▌        | 3/20 [05:50<30:46, 108.60s/it]Task 3, Epoch 4/20 => Loss 0.655, Loss_clf 0.358, Loss_aux 0.297, Train_accy 89.27:  15%|█▌        | 3/20 [07:22<30:46, 108.60s/it]Task 3, Epoch 4/20 => Loss 0.655, Loss_clf 0.358, Loss_aux 0.297, Train_accy 89.27:  20%|██        | 4/20 [07:22<27:13, 102.09s/it]Task 3, Epoch 5/20 => Loss 0.595, Loss_clf 0.328, Loss_aux 0.267, Train_accy 90.30:  20%|██        | 4/20 [08:54<27:13, 102.09s/it]Task 3, Epoch 5/20 => Loss 0.595, Loss_clf 0.328, Loss_aux 0.267, Train_accy 90.30:  25%|██▌       | 5/20 [08:54<24:37, 98.48s/it] Task 3, Epoch 6/20 => Loss 0.595, Loss_clf 0.323, Loss_aux 0.272, Train_accy 90.32, Test_accy 84.81:  25%|██▌       | 5/20 [11:40<24:37, 98.48s/it]Task 3, Epoch 6/20 => Loss 0.595, Loss_clf 0.323, Loss_aux 0.272, Train_accy 90.32, Test_accy 84.81:  30%|███       | 6/20 [11:40<28:21, 121.57s/it]Task 3, Epoch 7/20 => Loss 0.570, Loss_clf 0.312, Loss_aux 0.258, Train_accy 90.89:  30%|███       | 6/20 [13:13<28:21, 121.57s/it]                 Task 3, Epoch 7/20 => Loss 0.570, Loss_clf 0.312, Loss_aux 0.258, Train_accy 90.89:  35%|███▌      | 7/20 [13:13<24:17, 112.12s/it]Task 3, Epoch 8/20 => Loss 0.570, Loss_clf 0.311, Loss_aux 0.259, Train_accy 90.96:  35%|███▌      | 7/20 [14:46<24:17, 112.12s/it]Task 3, Epoch 8/20 => Loss 0.570, Loss_clf 0.311, Loss_aux 0.259, Train_accy 90.96:  40%|████      | 8/20 [14:46<21:11, 105.95s/it]Task 3, Epoch 9/20 => Loss 0.527, Loss_clf 0.286, Loss_aux 0.242, Train_accy 91.70:  40%|████      | 8/20 [16:18<21:11, 105.95s/it]Task 3, Epoch 9/20 => Loss 0.527, Loss_clf 0.286, Loss_aux 0.242, Train_accy 91.70:  45%|████▌     | 9/20 [16:18<18:39, 101.80s/it]Task 3, Epoch 10/20 => Loss 0.543, Loss_clf 0.298, Loss_aux 0.245, Train_accy 91.08:  45%|████▌     | 9/20 [17:51<18:39, 101.80s/it]Task 3, Epoch 10/20 => Loss 0.543, Loss_clf 0.298, Loss_aux 0.245, Train_accy 91.08:  50%|█████     | 10/20 [17:51<16:28, 98.89s/it]Task 3, Epoch 11/20 => Loss 0.544, Loss_clf 0.301, Loss_aux 0.243, Train_accy 91.22, Test_accy 84.64:  50%|█████     | 10/20 [20:37<16:28, 98.89s/it]Task 3, Epoch 11/20 => Loss 0.544, Loss_clf 0.301, Loss_aux 0.243, Train_accy 91.22, Test_accy 84.64:  55%|█████▌    | 11/20 [20:37<17:56, 119.62s/it]Task 3, Epoch 12/20 => Loss 0.506, Loss_clf 0.285, Loss_aux 0.221, Train_accy 91.98:  55%|█████▌    | 11/20 [22:10<17:56, 119.62s/it]                 Task 3, Epoch 12/20 => Loss 0.506, Loss_clf 0.285, Loss_aux 0.221, Train_accy 91.98:  60%|██████    | 12/20 [22:10<14:51, 111.41s/it]Task 3, Epoch 13/20 => Loss 0.459, Loss_clf 0.256, Loss_aux 0.204, Train_accy 92.72:  60%|██████    | 12/20 [23:42<14:51, 111.41s/it]Task 3, Epoch 13/20 => Loss 0.459, Loss_clf 0.256, Loss_aux 0.204, Train_accy 92.72:  65%|██████▌   | 13/20 [23:42<12:19, 105.59s/it]Task 3, Epoch 14/20 => Loss 0.478, Loss_clf 0.263, Loss_aux 0.216, Train_accy 92.51:  65%|██████▌   | 13/20 [25:14<12:19, 105.59s/it]Task 3, Epoch 14/20 => Loss 0.478, Loss_clf 0.263, Loss_aux 0.216, Train_accy 92.51:  70%|███████   | 14/20 [25:14<10:09, 101.52s/it]Task 3, Epoch 15/20 => Loss 0.481, Loss_clf 0.264, Loss_aux 0.217, Train_accy 92.72:  70%|███████   | 14/20 [26:46<10:09, 101.52s/it]Task 3, Epoch 15/20 => Loss 0.481, Loss_clf 0.264, Loss_aux 0.217, Train_accy 92.72:  75%|███████▌  | 15/20 [26:46<08:13, 98.72s/it] Task 3, Epoch 16/20 => Loss 0.478, Loss_clf 0.273, Loss_aux 0.205, Train_accy 91.94, Test_accy 84.48:  75%|███████▌  | 15/20 [29:33<08:13, 98.72s/it]Task 3, Epoch 16/20 => Loss 0.478, Loss_clf 0.273, Loss_aux 0.205, Train_accy 91.94, Test_accy 84.48:  80%|████████  | 16/20 [29:33<07:56, 119.11s/it]Task 3, Epoch 17/20 => Loss 0.456, Loss_clf 0.260, Loss_aux 0.197, Train_accy 92.70:  80%|████████  | 16/20 [31:05<07:56, 119.11s/it]                 Task 3, Epoch 17/20 => Loss 0.456, Loss_clf 0.260, Loss_aux 0.197, Train_accy 92.70:  85%|████████▌ | 17/20 [31:05<05:33, 111.06s/it]Task 3, Epoch 18/20 => Loss 0.468, Loss_clf 0.258, Loss_aux 0.210, Train_accy 92.61:  85%|████████▌ | 17/20 [32:37<05:33, 111.06s/it]Task 3, Epoch 18/20 => Loss 0.468, Loss_clf 0.258, Loss_aux 0.210, Train_accy 92.61:  90%|█████████ | 18/20 [32:37<03:30, 105.38s/it]Task 3, Epoch 19/20 => Loss 0.465, Loss_clf 0.260, Loss_aux 0.205, Train_accy 92.53:  90%|█████████ | 18/20 [34:10<03:30, 105.38s/it]Task 3, Epoch 19/20 => Loss 0.465, Loss_clf 0.260, Loss_aux 0.205, Train_accy 92.53:  95%|█████████▌| 19/20 [34:10<01:41, 101.41s/it]Task 3, Epoch 20/20 => Loss 0.447, Loss_clf 0.252, Loss_aux 0.195, Train_accy 92.97:  95%|█████████▌| 19/20 [35:42<01:41, 101.41s/it]Task 3, Epoch 20/20 => Loss 0.447, Loss_clf 0.252, Loss_aux 0.195, Train_accy 92.97: 100%|██████████| 20/20 [35:42<00:00, 98.70s/it] Task 3, Epoch 20/20 => Loss 0.447, Loss_clf 0.252, Loss_aux 0.195, Train_accy 92.97: 100%|██████████| 20/20 [35:42<00:00, 107.12s/it]
2024-04-28 22:48:04,307 [der.py] => Task 3, Epoch 20/20 => Loss 0.447, Loss_clf 0.252, Loss_aux 0.195, Train_accy 92.97
2024-04-28 22:48:04,309 [base.py] => Reducing exemplars...(25 per classes)
2024-04-28 22:48:39,028 [base.py] => Constructing exemplars...(25 per classes)
2024-04-28 22:52:03,587 [der.py] => Exemplar size: 2000
2024-04-28 22:52:03,587 [trainer.py] => CNN: {'total': 84.95, '00-49': 85.82, '50-59': 70.0, '60-69': 85.0, '70-79': 95.5, 'old': 83.44, 'new': 95.5}
2024-04-28 22:52:03,587 [trainer.py] => NME: {'total': 88.62, '00-49': 89.24, '50-59': 84.2, '60-69': 89.3, '70-79': 89.3, 'old': 88.53, 'new': 89.3}
2024-04-28 22:52:03,587 [trainer.py] => CNN top1 curve: [92.86, 90.67, 89.81, 84.95]
2024-04-28 22:52:03,587 [trainer.py] => CNN top5 curve: [99.26, 98.73, 98.6, 97.91]
2024-04-28 22:52:03,587 [trainer.py] => NME top1 curve: [93.08, 91.97, 91.23, 88.62]
2024-04-28 22:52:03,587 [trainer.py] => NME top5 curve: [99.46, 99.4, 99.19, 99.08]

Average Accuracy (CNN): 89.57
Average Accuracy (NME): 91.22
2024-04-28 22:52:03,587 [trainer.py] => Average Accuracy (CNN): 89.57
2024-04-28 22:52:03,587 [trainer.py] => Average Accuracy (NME): 91.22
2024-04-28 22:52:03,587 [trainer.py] => Train Time: 8509.71
2024-04-28 22:52:03,587 [trainer.py] => Test Time: 330.84000000000003 

2024-04-28 22:52:03,590 [trainer.py] => All params: 343448923
2024-04-28 22:52:03,591 [trainer.py] => Trainable params: 86052955
2024-04-28 22:52:06,069 [der.py] => Learning on 80-90
2024-04-28 22:52:06,075 [der.py] => All params: 429347429
2024-04-28 22:52:06,078 [der.py] => Trainable params: 86152805
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.683, Loss_clf 1.044, Loss_aux 0.639, Train_accy 79.93, Test_accy 81.73:   0%|          | 0/20 [03:31<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.683, Loss_clf 1.044, Loss_aux 0.639, Train_accy 79.93, Test_accy 81.73:   5%|▌         | 1/20 [03:31<1:07:05, 211.88s/it]Task 4, Epoch 2/20 => Loss 0.763, Loss_clf 0.412, Loss_aux 0.352, Train_accy 88.00:   5%|▌         | 1/20 [05:20<1:07:05, 211.88s/it]                 Task 4, Epoch 2/20 => Loss 0.763, Loss_clf 0.412, Loss_aux 0.352, Train_accy 88.00:  10%|█         | 2/20 [05:20<45:16, 150.89s/it]  Task 4, Epoch 3/20 => Loss 0.711, Loss_clf 0.387, Loss_aux 0.324, Train_accy 88.87:  10%|█         | 2/20 [07:08<45:16, 150.89s/it]Task 4, Epoch 3/20 => Loss 0.711, Loss_clf 0.387, Loss_aux 0.324, Train_accy 88.87:  15%|█▌        | 3/20 [07:08<37:16, 131.58s/it]Task 4, Epoch 4/20 => Loss 0.619, Loss_clf 0.338, Loss_aux 0.280, Train_accy 90.10:  15%|█▌        | 3/20 [08:57<37:16, 131.58s/it]Task 4, Epoch 4/20 => Loss 0.619, Loss_clf 0.338, Loss_aux 0.280, Train_accy 90.10:  20%|██        | 4/20 [08:57<32:39, 122.46s/it]Task 4, Epoch 5/20 => Loss 0.582, Loss_clf 0.319, Loss_aux 0.263, Train_accy 90.81:  20%|██        | 4/20 [10:45<32:39, 122.46s/it]Task 4, Epoch 5/20 => Loss 0.582, Loss_clf 0.319, Loss_aux 0.263, Train_accy 90.81:  25%|██▌       | 5/20 [10:45<29:20, 117.35s/it]Task 4, Epoch 6/20 => Loss 0.582, Loss_clf 0.311, Loss_aux 0.272, Train_accy 91.40, Test_accy 83.61:  25%|██▌       | 5/20 [14:17<29:20, 117.35s/it]Task 4, Epoch 6/20 => Loss 0.582, Loss_clf 0.311, Loss_aux 0.272, Train_accy 91.40, Test_accy 83.61:  30%|███       | 6/20 [14:17<34:55, 149.66s/it]Task 4, Epoch 7/20 => Loss 0.567, Loss_clf 0.318, Loss_aux 0.249, Train_accy 90.91:  30%|███       | 6/20 [16:06<34:55, 149.66s/it]                 Task 4, Epoch 7/20 => Loss 0.567, Loss_clf 0.318, Loss_aux 0.249, Train_accy 90.91:  35%|███▌      | 7/20 [16:06<29:31, 136.29s/it]Task 4, Epoch 8/20 => Loss 0.575, Loss_clf 0.322, Loss_aux 0.252, Train_accy 91.33:  35%|███▌      | 7/20 [17:55<29:31, 136.29s/it]Task 4, Epoch 8/20 => Loss 0.575, Loss_clf 0.322, Loss_aux 0.252, Train_accy 91.33:  40%|████      | 8/20 [17:55<25:29, 127.49s/it]Task 4, Epoch 9/20 => Loss 0.527, Loss_clf 0.295, Loss_aux 0.232, Train_accy 91.74:  40%|████      | 8/20 [19:44<25:29, 127.49s/it]Task 4, Epoch 9/20 => Loss 0.527, Loss_clf 0.295, Loss_aux 0.232, Train_accy 91.74:  45%|████▌     | 9/20 [19:44<22:19, 121.80s/it]Task 4, Epoch 10/20 => Loss 0.499, Loss_clf 0.273, Loss_aux 0.226, Train_accy 92.01:  45%|████▌     | 9/20 [21:35<22:19, 121.80s/it]Task 4, Epoch 10/20 => Loss 0.499, Loss_clf 0.273, Loss_aux 0.226, Train_accy 92.01:  50%|█████     | 10/20 [21:35<19:43, 118.33s/it]Task 4, Epoch 11/20 => Loss 0.493, Loss_clf 0.272, Loss_aux 0.220, Train_accy 92.40, Test_accy 83.18:  50%|█████     | 10/20 [25:10<19:43, 118.33s/it]Task 4, Epoch 11/20 => Loss 0.493, Loss_clf 0.272, Loss_aux 0.220, Train_accy 92.40, Test_accy 83.18:  55%|█████▌    | 11/20 [25:10<22:13, 148.15s/it]Task 4, Epoch 12/20 => Loss 0.497, Loss_clf 0.278, Loss_aux 0.219, Train_accy 92.46:  55%|█████▌    | 11/20 [27:00<22:13, 148.15s/it]                 Task 4, Epoch 12/20 => Loss 0.497, Loss_clf 0.278, Loss_aux 0.219, Train_accy 92.46:  60%|██████    | 12/20 [27:00<18:12, 136.56s/it]Task 4, Epoch 13/20 => Loss 0.494, Loss_clf 0.280, Loss_aux 0.215, Train_accy 92.19:  60%|██████    | 12/20 [28:50<18:12, 136.56s/it]Task 4, Epoch 13/20 => Loss 0.494, Loss_clf 0.280, Loss_aux 0.215, Train_accy 92.19:  65%|██████▌   | 13/20 [28:50<14:58, 128.39s/it]Task 4, Epoch 14/20 => Loss 0.478, Loss_clf 0.266, Loss_aux 0.212, Train_accy 92.80:  65%|██████▌   | 13/20 [30:40<14:58, 128.39s/it]Task 4, Epoch 14/20 => Loss 0.478, Loss_clf 0.266, Loss_aux 0.212, Train_accy 92.80:  70%|███████   | 14/20 [30:40<12:16, 122.78s/it]Task 4, Epoch 15/20 => Loss 0.489, Loss_clf 0.278, Loss_aux 0.211, Train_accy 92.40:  70%|███████   | 14/20 [32:30<12:16, 122.78s/it]Task 4, Epoch 15/20 => Loss 0.489, Loss_clf 0.278, Loss_aux 0.211, Train_accy 92.40:  75%|███████▌  | 15/20 [32:30<09:54, 118.99s/it]Task 4, Epoch 16/20 => Loss 0.455, Loss_clf 0.259, Loss_aux 0.196, Train_accy 92.96, Test_accy 83.42:  75%|███████▌  | 15/20 [36:05<09:54, 118.99s/it]Task 4, Epoch 16/20 => Loss 0.455, Loss_clf 0.259, Loss_aux 0.196, Train_accy 92.96, Test_accy 83.42:  80%|████████  | 16/20 [36:05<09:51, 147.82s/it]Task 4, Epoch 17/20 => Loss 0.464, Loss_clf 0.258, Loss_aux 0.206, Train_accy 92.69:  80%|████████  | 16/20 [37:55<09:51, 147.82s/it]                 Task 4, Epoch 17/20 => Loss 0.464, Loss_clf 0.258, Loss_aux 0.206, Train_accy 92.69:  85%|████████▌ | 17/20 [37:55<06:49, 136.39s/it]Task 4, Epoch 18/20 => Loss 0.446, Loss_clf 0.248, Loss_aux 0.198, Train_accy 92.99:  85%|████████▌ | 17/20 [39:44<06:49, 136.39s/it]Task 4, Epoch 18/20 => Loss 0.446, Loss_clf 0.248, Loss_aux 0.198, Train_accy 92.99:  90%|█████████ | 18/20 [39:44<04:16, 128.38s/it]Task 4, Epoch 19/20 => Loss 0.416, Loss_clf 0.236, Loss_aux 0.180, Train_accy 93.73:  90%|█████████ | 18/20 [41:34<04:16, 128.38s/it]Task 4, Epoch 19/20 => Loss 0.416, Loss_clf 0.236, Loss_aux 0.180, Train_accy 93.73:  95%|█████████▌| 19/20 [41:34<02:02, 122.79s/it]Task 4, Epoch 20/20 => Loss 0.447, Loss_clf 0.257, Loss_aux 0.190, Train_accy 93.03:  95%|█████████▌| 19/20 [43:24<02:02, 122.79s/it]Task 4, Epoch 20/20 => Loss 0.447, Loss_clf 0.257, Loss_aux 0.190, Train_accy 93.03: 100%|██████████| 20/20 [43:24<00:00, 118.91s/it]Task 4, Epoch 20/20 => Loss 0.447, Loss_clf 0.257, Loss_aux 0.190, Train_accy 93.03: 100%|██████████| 20/20 [43:24<00:00, 130.22s/it]
2024-04-28 23:35:30,664 [der.py] => Task 4, Epoch 20/20 => Loss 0.447, Loss_clf 0.257, Loss_aux 0.190, Train_accy 93.03
2024-04-28 23:35:30,665 [base.py] => Reducing exemplars...(22 per classes)
2024-04-28 23:36:14,166 [base.py] => Constructing exemplars...(22 per classes)
2024-04-28 23:40:55,006 [der.py] => Exemplar size: 1980
2024-04-28 23:40:55,006 [trainer.py] => CNN: {'total': 82.84, '00-49': 80.88, '50-59': 74.0, '60-69': 84.2, '70-79': 85.6, '80-89': 97.4, 'old': 81.03, 'new': 97.4}
2024-04-28 23:40:55,006 [trainer.py] => NME: {'total': 86.4, '00-49': 85.8, '50-59': 81.2, '60-69': 87.9, '70-79': 88.2, '80-89': 91.3, 'old': 85.79, 'new': 91.3}
2024-04-28 23:40:55,006 [trainer.py] => CNN top1 curve: [92.86, 90.67, 89.81, 84.95, 82.84]
2024-04-28 23:40:55,006 [trainer.py] => CNN top5 curve: [99.26, 98.73, 98.6, 97.91, 97.09]
2024-04-28 23:40:55,006 [trainer.py] => NME top1 curve: [93.08, 91.97, 91.23, 88.62, 86.4]
2024-04-28 23:40:55,006 [trainer.py] => NME top5 curve: [99.46, 99.4, 99.19, 99.08, 98.62]

Average Accuracy (CNN): 88.23
Average Accuracy (NME): 90.26
2024-04-28 23:40:55,006 [trainer.py] => Average Accuracy (CNN): 88.23
2024-04-28 23:40:55,006 [trainer.py] => Average Accuracy (NME): 90.26
2024-04-28 23:40:55,006 [trainer.py] => Train Time: 11114.24
2024-04-28 23:40:55,006 [trainer.py] => Test Time: 544.03 

2024-04-28 23:40:55,010 [trainer.py] => All params: 429347429
2024-04-28 23:40:55,014 [trainer.py] => Trainable params: 86152805
2024-04-28 23:40:58,532 [der.py] => Learning on 90-100
2024-04-28 23:40:58,540 [der.py] => All params: 515261295
2024-04-28 23:40:58,545 [der.py] => Trainable params: 86268015
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.799, Loss_clf 1.126, Loss_aux 0.672, Train_accy 79.05, Test_accy 81.07:   0%|          | 0/20 [04:24<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.799, Loss_clf 1.126, Loss_aux 0.672, Train_accy 79.05, Test_accy 81.07:   5%|▌         | 1/20 [04:24<1:23:47, 264.61s/it]Task 5, Epoch 2/20 => Loss 0.788, Loss_clf 0.436, Loss_aux 0.352, Train_accy 87.34:   5%|▌         | 1/20 [06:30<1:23:47, 264.61s/it]                 Task 5, Epoch 2/20 => Loss 0.788, Loss_clf 0.436, Loss_aux 0.352, Train_accy 87.34:  10%|█         | 2/20 [06:30<54:52, 182.90s/it]  Task 5, Epoch 3/20 => Loss 0.674, Loss_clf 0.364, Loss_aux 0.310, Train_accy 89.80:  10%|█         | 2/20 [08:35<54:52, 182.90s/it]Task 5, Epoch 3/20 => Loss 0.674, Loss_clf 0.364, Loss_aux 0.310, Train_accy 89.80:  15%|█▌        | 3/20 [08:35<44:23, 156.69s/it]Task 5, Epoch 4/20 => Loss 0.625, Loss_clf 0.338, Loss_aux 0.287, Train_accy 90.24:  15%|█▌        | 3/20 [10:41<44:23, 156.69s/it]Task 5, Epoch 4/20 => Loss 0.625, Loss_clf 0.338, Loss_aux 0.287, Train_accy 90.24:  20%|██        | 4/20 [10:41<38:30, 144.44s/it]Task 5, Epoch 5/20 => Loss 0.616, Loss_clf 0.342, Loss_aux 0.274, Train_accy 89.71:  20%|██        | 4/20 [12:46<38:30, 144.44s/it]Task 5, Epoch 5/20 => Loss 0.616, Loss_clf 0.342, Loss_aux 0.274, Train_accy 89.71:  25%|██▌       | 5/20 [12:46<34:23, 137.58s/it]Task 5, Epoch 6/20 => Loss 0.549, Loss_clf 0.297, Loss_aux 0.252, Train_accy 91.68, Test_accy 81.12:  25%|██▌       | 5/20 [17:11<34:23, 137.58s/it]Task 5, Epoch 6/20 => Loss 0.549, Loss_clf 0.297, Loss_aux 0.252, Train_accy 91.68, Test_accy 81.12:  30%|███       | 6/20 [17:11<42:10, 180.73s/it]Task 5, Epoch 7/20 => Loss 0.575, Loss_clf 0.321, Loss_aux 0.254, Train_accy 90.60:  30%|███       | 6/20 [19:16<42:10, 180.73s/it]                 Task 5, Epoch 7/20 => Loss 0.575, Loss_clf 0.321, Loss_aux 0.254, Train_accy 90.60:  35%|███▌      | 7/20 [19:16<35:14, 162.69s/it]Task 5, Epoch 8/20 => Loss 0.552, Loss_clf 0.305, Loss_aux 0.247, Train_accy 91.20:  35%|███▌      | 7/20 [21:22<35:14, 162.69s/it]Task 5, Epoch 8/20 => Loss 0.552, Loss_clf 0.305, Loss_aux 0.247, Train_accy 91.20:  40%|████      | 8/20 [21:22<30:10, 150.84s/it]Task 5, Epoch 9/20 => Loss 0.523, Loss_clf 0.291, Loss_aux 0.232, Train_accy 92.15:  40%|████      | 8/20 [23:27<30:10, 150.84s/it]Task 5, Epoch 9/20 => Loss 0.523, Loss_clf 0.291, Loss_aux 0.232, Train_accy 92.15:  45%|████▌     | 9/20 [23:27<26:11, 142.86s/it]Task 5, Epoch 10/20 => Loss 0.492, Loss_clf 0.272, Loss_aux 0.219, Train_accy 92.03:  45%|████▌     | 9/20 [25:33<26:11, 142.86s/it]Task 5, Epoch 10/20 => Loss 0.492, Loss_clf 0.272, Loss_aux 0.219, Train_accy 92.03:  50%|█████     | 10/20 [25:33<22:55, 137.55s/it]Task 5, Epoch 11/20 => Loss 0.491, Loss_clf 0.272, Loss_aux 0.219, Train_accy 92.51, Test_accy 81.62:  50%|█████     | 10/20 [29:57<22:55, 137.55s/it]Task 5, Epoch 11/20 => Loss 0.491, Loss_clf 0.272, Loss_aux 0.219, Train_accy 92.51, Test_accy 81.62:  55%|█████▌    | 11/20 [29:57<26:27, 176.40s/it]Task 5, Epoch 12/20 => Loss 0.500, Loss_clf 0.284, Loss_aux 0.216, Train_accy 91.78:  55%|█████▌    | 11/20 [32:03<26:27, 176.40s/it]                 Task 5, Epoch 12/20 => Loss 0.500, Loss_clf 0.284, Loss_aux 0.216, Train_accy 91.78:  60%|██████    | 12/20 [32:03<21:27, 160.89s/it]Task 5, Epoch 13/20 => Loss 0.484, Loss_clf 0.270, Loss_aux 0.214, Train_accy 92.54:  60%|██████    | 12/20 [34:08<21:27, 160.89s/it]Task 5, Epoch 13/20 => Loss 0.484, Loss_clf 0.270, Loss_aux 0.214, Train_accy 92.54:  65%|██████▌   | 13/20 [34:08<17:31, 150.17s/it]Task 5, Epoch 14/20 => Loss 0.495, Loss_clf 0.273, Loss_aux 0.222, Train_accy 92.06:  65%|██████▌   | 13/20 [36:14<17:31, 150.17s/it]Task 5, Epoch 14/20 => Loss 0.495, Loss_clf 0.273, Loss_aux 0.222, Train_accy 92.06:  70%|███████   | 14/20 [36:14<14:16, 142.70s/it]Task 5, Epoch 15/20 => Loss 0.453, Loss_clf 0.252, Loss_aux 0.202, Train_accy 92.98:  70%|███████   | 14/20 [38:19<14:16, 142.70s/it]Task 5, Epoch 15/20 => Loss 0.453, Loss_clf 0.252, Loss_aux 0.202, Train_accy 92.98:  75%|███████▌  | 15/20 [38:19<11:27, 137.49s/it]Task 5, Epoch 16/20 => Loss 0.510, Loss_clf 0.294, Loss_aux 0.216, Train_accy 92.01, Test_accy 81.25:  75%|███████▌  | 15/20 [42:44<11:27, 137.49s/it]Task 5, Epoch 16/20 => Loss 0.510, Loss_clf 0.294, Loss_aux 0.216, Train_accy 92.01, Test_accy 81.25:  80%|████████  | 16/20 [42:44<11:43, 175.82s/it]Task 5, Epoch 17/20 => Loss 0.430, Loss_clf 0.246, Loss_aux 0.184, Train_accy 93.05:  80%|████████  | 16/20 [44:50<11:43, 175.82s/it]                 Task 5, Epoch 17/20 => Loss 0.430, Loss_clf 0.246, Loss_aux 0.184, Train_accy 93.05:  85%|████████▌ | 17/20 [44:50<08:02, 160.72s/it]Task 5, Epoch 18/20 => Loss 0.445, Loss_clf 0.253, Loss_aux 0.192, Train_accy 92.64:  85%|████████▌ | 17/20 [46:55<08:02, 160.72s/it]Task 5, Epoch 18/20 => Loss 0.445, Loss_clf 0.253, Loss_aux 0.192, Train_accy 92.64:  90%|█████████ | 18/20 [46:55<05:00, 150.13s/it]Task 5, Epoch 19/20 => Loss 0.435, Loss_clf 0.248, Loss_aux 0.187, Train_accy 93.24:  90%|█████████ | 18/20 [49:00<05:00, 150.13s/it]Task 5, Epoch 19/20 => Loss 0.435, Loss_clf 0.248, Loss_aux 0.187, Train_accy 93.24:  95%|█████████▌| 19/20 [49:00<02:22, 142.68s/it]Task 5, Epoch 20/20 => Loss 0.445, Loss_clf 0.247, Loss_aux 0.198, Train_accy 92.81:  95%|█████████▌| 19/20 [51:06<02:22, 142.68s/it]Task 5, Epoch 20/20 => Loss 0.445, Loss_clf 0.247, Loss_aux 0.198, Train_accy 92.81: 100%|██████████| 20/20 [51:06<00:00, 137.48s/it]Task 5, Epoch 20/20 => Loss 0.445, Loss_clf 0.247, Loss_aux 0.198, Train_accy 92.81: 100%|██████████| 20/20 [51:06<00:00, 153.31s/it]
2024-04-29 00:32:05,115 [der.py] => Task 5, Epoch 20/20 => Loss 0.445, Loss_clf 0.247, Loss_aux 0.198, Train_accy 92.81
2024-04-29 00:32:05,117 [base.py] => Reducing exemplars...(20 per classes)
2024-04-29 00:32:56,306 [base.py] => Constructing exemplars...(20 per classes)
2024-04-29 00:38:57,028 [der.py] => Exemplar size: 2000
2024-04-29 00:38:57,028 [trainer.py] => CNN: {'total': 81.5, '00-49': 79.0, '50-59': 68.2, '60-69': 82.7, '70-79': 83.1, '80-89': 89.5, '90-99': 96.5, 'old': 79.83, 'new': 96.5}
2024-04-29 00:38:57,028 [trainer.py] => NME: {'total': 85.53, '00-49': 84.6, '50-59': 78.1, '60-69': 87.1, '70-79': 87.6, '80-89': 91.9, '90-99': 87.6, 'old': 85.3, 'new': 87.6}
2024-04-29 00:38:57,028 [trainer.py] => CNN top1 curve: [92.86, 90.67, 89.81, 84.95, 82.84, 81.5]
2024-04-29 00:38:57,029 [trainer.py] => CNN top5 curve: [99.26, 98.73, 98.6, 97.91, 97.09, 95.97]
2024-04-29 00:38:57,029 [trainer.py] => NME top1 curve: [93.08, 91.97, 91.23, 88.62, 86.4, 85.53]
2024-04-29 00:38:57,029 [trainer.py] => NME top5 curve: [99.46, 99.4, 99.19, 99.08, 98.62, 98.15]

Average Accuracy (CNN): 87.1
Average Accuracy (NME): 89.47
2024-04-29 00:38:57,029 [trainer.py] => Average Accuracy (CNN): 87.1
2024-04-29 00:38:57,029 [trainer.py] => Average Accuracy (NME): 89.47
2024-04-29 00:38:57,029 [trainer.py] => Train Time: 14180.55
2024-04-29 00:38:57,029 [trainer.py] => Test Time: 825.46 

Accuracy Matrix (CNN):
[[92.86 89.7  88.98 85.82 80.88 79.  ]
 [ 0.   95.5  86.3  70.   74.   68.2 ]
 [ 0.    0.   97.5  85.   84.2  82.7 ]
 [ 0.    0.    0.   95.5  85.6  83.1 ]
 [ 0.    0.    0.    0.   97.4  89.5 ]
 [ 0.    0.    0.    0.    0.   96.5 ]]
2024-04-29 00:38:57,030 [trainer.py] => Forgetting (CNN): 15.252
Accuracy Matrix (NME):
[[93.08 91.78 91.   89.24 85.8  84.6 ]
 [ 0.   92.9  90.3  84.2  81.2  78.1 ]
 [ 0.    0.   93.3  89.3  87.9  87.1 ]
 [ 0.    0.    0.   89.3  88.2  87.6 ]
 [ 0.    0.    0.    0.   91.3  91.9 ]
 [ 0.    0.    0.    0.    0.   87.6 ]]
2024-04-29 00:38:57,030 [trainer.py] => Forgetting (NME): 6.236000000000004
2024-04-29 00:39:00,877 [trainer.py] => config: ./exps/foster_cifar_B50_Inc5.json
2024-04-29 00:39:00,877 [trainer.py] => prefix: cil
2024-04-29 00:39:00,877 [trainer.py] => dataset: cifar224
2024-04-29 00:39:00,877 [trainer.py] => memory_size: 2000
2024-04-29 00:39:00,877 [trainer.py] => memory_per_class: 20
2024-04-29 00:39:00,877 [trainer.py] => fixed_memory: True
2024-04-29 00:39:00,877 [trainer.py] => shuffle: True
2024-04-29 00:39:00,877 [trainer.py] => init_cls: 50
2024-04-29 00:39:00,877 [trainer.py] => increment: 10
2024-04-29 00:39:00,877 [trainer.py] => model_name: foster
2024-04-29 00:39:00,878 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-29 00:39:00,878 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-29 00:39:00,878 [trainer.py] => seed: 1993
2024-04-29 00:39:00,878 [trainer.py] => beta1: 0.96
2024-04-29 00:39:00,878 [trainer.py] => beta2: 0.97
2024-04-29 00:39:00,878 [trainer.py] => oofc: ft
2024-04-29 00:39:00,878 [trainer.py] => is_teacher_wa: False
2024-04-29 00:39:00,878 [trainer.py] => is_student_wa: False
2024-04-29 00:39:00,878 [trainer.py] => lambda_okd: 1
2024-04-29 00:39:00,878 [trainer.py] => wa_value: 1
2024-04-29 00:39:00,878 [trainer.py] => init_epochs: 1
2024-04-29 00:39:00,878 [trainer.py] => init_lr: 0.001
2024-04-29 00:39:00,878 [trainer.py] => init_weight_decay: 0.0005
2024-04-29 00:39:00,878 [trainer.py] => boosting_epochs: 1
2024-04-29 00:39:00,878 [trainer.py] => compression_epochs: 1
2024-04-29 00:39:00,878 [trainer.py] => lr: 0.001
2024-04-29 00:39:00,878 [trainer.py] => batch_size: 48
2024-04-29 00:39:00,878 [trainer.py] => weight_decay: 0.0005
2024-04-29 00:39:00,878 [trainer.py] => num_workers: 8
2024-04-29 00:39:00,878 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-04-29 00:39:03,118 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-29 00:39:03,866 [trainer.py] => All params: 0
2024-04-29 00:39:03,866 [trainer.py] => Trainable params: 0
2024-04-29 00:39:08,777 [foster.py] => Learning on 0-50
2024-04-29 00:39:08,779 [foster.py] => All params: 85875556
2024-04-29 00:39:08,779 [foster.py] => Trainable params: 85875556
  0%|          | 0/1 [00:00<?, ?it/s]Task 0, Epoch 1/1 => Loss 2.535, Train_accy 35.39, Test_accy 89.10:   0%|          | 0/1 [02:51<?, ?it/s]Task 0, Epoch 1/1 => Loss 2.535, Train_accy 35.39, Test_accy 89.10: 100%|██████████| 1/1 [02:51<00:00, 171.50s/it]Task 0, Epoch 1/1 => Loss 2.535, Train_accy 35.39, Test_accy 89.10: 100%|██████████| 1/1 [02:51<00:00, 171.50s/it]
2024-04-29 00:42:01,040 [foster.py] => Task 0, Epoch 1/1 => Loss 2.535, Train_accy 35.39, Test_accy 89.10
2024-04-29 00:42:01,042 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 00:43:55,556 [foster.py] => Exemplar size: 1000
2024-04-29 00:43:55,556 [trainer.py] => CNN: {'total': 89.1, '00-49': 89.1, 'old': 0, 'new': 89.1}
2024-04-29 00:43:55,556 [trainer.py] => NME: {'total': 90.38, '00-49': 90.38, 'old': 0, 'new': 90.38}
2024-04-29 00:43:55,556 [trainer.py] => CNN top1 curve: [89.1]
2024-04-29 00:43:55,556 [trainer.py] => CNN top5 curve: [98.9]
2024-04-29 00:43:55,556 [trainer.py] => NME top1 curve: [90.38]
2024-04-29 00:43:55,556 [trainer.py] => NME top5 curve: [98.76]

Average Accuracy (CNN): 89.1
Average Accuracy (NME): 90.38
2024-04-29 00:43:55,557 [trainer.py] => Average Accuracy (CNN): 89.1
2024-04-29 00:43:55,557 [trainer.py] => Average Accuracy (NME): 90.38
2024-04-29 00:43:55,557 [trainer.py] => Train Time: 172.14
2024-04-29 00:43:55,557 [trainer.py] => Test Time: 25.65 

2024-04-29 00:43:55,558 [trainer.py] => All params: 85875556
2024-04-29 00:43:55,558 [trainer.py] => Trainable params: 85875556
2024-04-29 00:43:59,217 [foster.py] => Learning on 50-60
2024-04-29 00:43:59,218 [foster.py] => All params: 171774122
2024-04-29 00:43:59,219 [foster.py] => Trainable params: 85937016
2024-04-29 00:43:59,319 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]
  0%|          | 0/1 [00:00<?, ?it/s]Task 1, Epoch 1/1 => Loss 5.560, Loss_clf 0.967, Loss_fe 1.462, Loss_kd 2.609, Train_accy 63.15, Test_accy 86.92:   0%|          | 0/1 [01:20<?, ?it/s]Task 1, Epoch 1/1 => Loss 5.560, Loss_clf 0.967, Loss_fe 1.462, Loss_kd 2.609, Train_accy 63.15, Test_accy 86.92: 100%|██████████| 1/1 [01:20<00:00, 80.32s/it]Task 1, Epoch 1/1 => Loss 5.560, Loss_clf 0.967, Loss_fe 1.462, Loss_kd 2.609, Train_accy 63.15, Test_accy 86.92: 100%|██████████| 1/1 [01:20<00:00, 80.32s/it]
2024-04-29 00:45:19,639 [foster.py] => Task 1, Epoch 1/1 => Loss 5.560, Loss_clf 0.967, Loss_fe 1.462, Loss_kd 2.609, Train_accy 63.15, Test_accy 86.92
2024-04-29 00:45:19,640 [foster.py] => do not weight align teacher!
2024-04-29 00:45:19,642 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]
  0%|          | 0/1 [00:00<?, ?it/s]SNet: Task 1, Epoch 1/1 => Loss 3.193,  Train_accy 34.62, Test_accy 83.82:   0%|          | 0/1 [01:20<?, ?it/s]SNet: Task 1, Epoch 1/1 => Loss 3.193,  Train_accy 34.62, Test_accy 83.82: 100%|██████████| 1/1 [01:20<00:00, 80.69s/it]SNet: Task 1, Epoch 1/1 => Loss 3.193,  Train_accy 34.62, Test_accy 83.82: 100%|██████████| 1/1 [01:20<00:00, 80.69s/it]
2024-04-29 00:46:44,237 [foster.py] => SNet: Task 1, Epoch 1/1 => Loss 3.193,  Train_accy 34.62, Test_accy 83.82
2024-04-29 00:46:44,238 [foster.py] => do not weight align student!
2024-04-29 00:46:59,555 [foster.py] => darknet eval: 
2024-04-29 00:46:59,555 [foster.py] => CNN top1 curve: 83.82
2024-04-29 00:46:59,555 [foster.py] => CNN top5 curve: 97.82
2024-04-29 00:46:59,556 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 00:48:43,774 [foster.py] => Exemplar size: 1200
2024-04-29 00:48:43,775 [trainer.py] => CNN: {'total': 86.92, '00-49': 88.9, '50-59': 77.0, 'old': 88.9, 'new': 77.0}
2024-04-29 00:48:43,775 [trainer.py] => NME: {'total': 89.17, '00-49': 89.86, '50-59': 85.7, 'old': 89.86, 'new': 85.7}
2024-04-29 00:48:43,775 [trainer.py] => CNN top1 curve: [89.1, 86.92]
2024-04-29 00:48:43,775 [trainer.py] => CNN top5 curve: [98.9, 98.47]
2024-04-29 00:48:43,775 [trainer.py] => NME top1 curve: [90.38, 89.17]
2024-04-29 00:48:43,775 [trainer.py] => NME top5 curve: [98.76, 98.67]

Average Accuracy (CNN): 88.01
Average Accuracy (NME): 89.78
2024-04-29 00:48:43,775 [trainer.py] => Average Accuracy (CNN): 88.01
2024-04-29 00:48:43,775 [trainer.py] => Average Accuracy (NME): 89.78
2024-04-29 00:48:43,775 [trainer.py] => Train Time: 352.41999999999996
2024-04-29 00:48:43,775 [trainer.py] => Test Time: 83.53999999999999 

2024-04-29 00:48:43,776 [trainer.py] => All params: 171774122
2024-04-29 00:48:43,777 [trainer.py] => Trainable params: 85937016
2024-04-29 00:48:47,896 [foster.py] => Learning on 60-70
2024-04-29 00:48:47,899 [foster.py] => All params: 171804872
2024-04-29 00:48:47,900 [foster.py] => Trainable params: 85960076
2024-04-29 00:48:48,071 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604]
  0%|          | 0/1 [00:00<?, ?it/s]Task 2, Epoch 1/1 => Loss 5.553, Loss_clf 0.878, Loss_fe 1.504, Loss_kd 2.718, Train_accy 64.35, Test_accy 84.81:   0%|          | 0/1 [01:27<?, ?it/s]Task 2, Epoch 1/1 => Loss 5.553, Loss_clf 0.878, Loss_fe 1.504, Loss_kd 2.718, Train_accy 64.35, Test_accy 84.81: 100%|██████████| 1/1 [01:27<00:00, 87.23s/it]Task 2, Epoch 1/1 => Loss 5.553, Loss_clf 0.878, Loss_fe 1.504, Loss_kd 2.718, Train_accy 64.35, Test_accy 84.81: 100%|██████████| 1/1 [01:27<00:00, 87.23s/it]
2024-04-29 00:50:15,302 [foster.py] => Task 2, Epoch 1/1 => Loss 5.553, Loss_clf 0.878, Loss_fe 1.504, Loss_kd 2.718, Train_accy 64.35, Test_accy 84.81
2024-04-29 00:50:15,303 [foster.py] => do not weight align teacher!
2024-04-29 00:50:15,304 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102]
  0%|          | 0/1 [00:00<?, ?it/s]SNet: Task 2, Epoch 1/1 => Loss 3.145,  Train_accy 40.60, Test_accy 81.71:   0%|          | 0/1 [01:25<?, ?it/s]SNet: Task 2, Epoch 1/1 => Loss 3.145,  Train_accy 40.60, Test_accy 81.71: 100%|██████████| 1/1 [01:25<00:00, 85.33s/it]SNet: Task 2, Epoch 1/1 => Loss 3.145,  Train_accy 40.60, Test_accy 81.71: 100%|██████████| 1/1 [01:25<00:00, 85.33s/it]
2024-04-29 00:51:44,018 [foster.py] => SNet: Task 2, Epoch 1/1 => Loss 3.145,  Train_accy 40.60, Test_accy 81.71
2024-04-29 00:51:44,018 [foster.py] => do not weight align student!
2024-04-29 00:52:01,999 [foster.py] => darknet eval: 
2024-04-29 00:52:02,000 [foster.py] => CNN top1 curve: 81.71
2024-04-29 00:52:02,000 [foster.py] => CNN top5 curve: 97.77
2024-04-29 00:52:02,003 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 00:54:02,757 [foster.py] => Exemplar size: 1400
2024-04-29 00:54:02,758 [trainer.py] => CNN: {'total': 84.81, '00-49': 88.8, '50-59': 68.7, '60-69': 81.0, 'old': 85.45, 'new': 81.0}
2024-04-29 00:54:02,758 [trainer.py] => NME: {'total': 87.93, '00-49': 89.24, '50-59': 79.7, '60-69': 89.6, 'old': 87.65, 'new': 89.6}
2024-04-29 00:54:02,758 [trainer.py] => CNN top1 curve: [89.1, 86.92, 84.81]
2024-04-29 00:54:02,758 [trainer.py] => CNN top5 curve: [98.9, 98.47, 97.87]
2024-04-29 00:54:02,758 [trainer.py] => NME top1 curve: [90.38, 89.17, 87.93]
2024-04-29 00:54:02,758 [trainer.py] => NME top5 curve: [98.76, 98.67, 98.56]

Average Accuracy (CNN): 86.94
Average Accuracy (NME): 89.16
2024-04-29 00:54:02,758 [trainer.py] => Average Accuracy (CNN): 86.94
2024-04-29 00:54:02,758 [trainer.py] => Average Accuracy (NME): 89.16
2024-04-29 00:54:02,758 [trainer.py] => Train Time: 546.41
2024-04-29 00:54:02,758 [trainer.py] => Test Time: 152.64999999999998 

2024-04-29 00:54:02,759 [trainer.py] => All params: 171804872
2024-04-29 00:54:02,760 [trainer.py] => Trainable params: 85960076
2024-04-29 00:54:09,461 [foster.py] => Learning on 70-80
2024-04-29 00:54:09,464 [foster.py] => All params: 171835622
2024-04-29 00:54:09,465 [foster.py] => Trainable params: 85983136
2024-04-29 00:54:09,626 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006]
  0%|          | 0/1 [00:00<?, ?it/s]Task 3, Epoch 1/1 => Loss 6.169, Loss_clf 1.074, Loss_fe 1.791, Loss_kd 2.891, Train_accy 54.20, Test_accy 80.19:   0%|          | 0/1 [01:33<?, ?it/s]Task 3, Epoch 1/1 => Loss 6.169, Loss_clf 1.074, Loss_fe 1.791, Loss_kd 2.891, Train_accy 54.20, Test_accy 80.19: 100%|██████████| 1/1 [01:33<00:00, 93.69s/it]Task 3, Epoch 1/1 => Loss 6.169, Loss_clf 1.074, Loss_fe 1.791, Loss_kd 2.891, Train_accy 54.20, Test_accy 80.19: 100%|██████████| 1/1 [01:33<00:00, 93.69s/it]
2024-04-29 00:55:43,316 [foster.py] => Task 3, Epoch 1/1 => Loss 6.169, Loss_clf 1.074, Loss_fe 1.791, Loss_kd 2.891, Train_accy 54.20, Test_accy 80.19
2024-04-29 00:55:43,317 [foster.py] => do not weight align teacher!
2024-04-29 00:55:43,318 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755]
  0%|          | 0/1 [00:00<?, ?it/s]SNet: Task 3, Epoch 1/1 => Loss 3.385,  Train_accy 27.52, Test_accy 77.84:   0%|          | 0/1 [01:29<?, ?it/s]SNet: Task 3, Epoch 1/1 => Loss 3.385,  Train_accy 27.52, Test_accy 77.84: 100%|██████████| 1/1 [01:29<00:00, 89.86s/it]SNet: Task 3, Epoch 1/1 => Loss 3.385,  Train_accy 27.52, Test_accy 77.84: 100%|██████████| 1/1 [01:29<00:00, 89.86s/it]
2024-04-29 00:57:16,203 [foster.py] => SNet: Task 3, Epoch 1/1 => Loss 3.385,  Train_accy 27.52, Test_accy 77.84
2024-04-29 00:57:16,203 [foster.py] => do not weight align student!
2024-04-29 00:57:36,402 [foster.py] => darknet eval: 
2024-04-29 00:57:36,403 [foster.py] => CNN top1 curve: 77.84
2024-04-29 00:57:36,403 [foster.py] => CNN top5 curve: 96.99
2024-04-29 00:57:36,405 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 00:59:50,403 [foster.py] => Exemplar size: 1600
2024-04-29 00:59:50,403 [trainer.py] => CNN: {'total': 80.19, '00-49': 87.58, '50-59': 68.5, '60-69': 69.9, '70-79': 65.2, 'old': 82.33, 'new': 65.2}
2024-04-29 00:59:50,403 [trainer.py] => NME: {'total': 85.12, '00-49': 88.42, '50-59': 75.7, '60-69': 85.7, '70-79': 77.5, 'old': 86.21, 'new': 77.5}
2024-04-29 00:59:50,403 [trainer.py] => CNN top1 curve: [89.1, 86.92, 84.81, 80.19]
2024-04-29 00:59:50,403 [trainer.py] => CNN top5 curve: [98.9, 98.47, 97.87, 97.48]
2024-04-29 00:59:50,403 [trainer.py] => NME top1 curve: [90.38, 89.17, 87.93, 85.12]
2024-04-29 00:59:50,403 [trainer.py] => NME top5 curve: [98.76, 98.67, 98.56, 98.02]

Average Accuracy (CNN): 85.26
Average Accuracy (NME): 88.15
2024-04-29 00:59:50,403 [trainer.py] => Average Accuracy (CNN): 85.26
2024-04-29 00:59:50,403 [trainer.py] => Average Accuracy (NME): 88.15
2024-04-29 00:59:50,403 [trainer.py] => Train Time: 753.25
2024-04-29 00:59:50,403 [trainer.py] => Test Time: 230.99999999999997 

2024-04-29 00:59:50,405 [trainer.py] => All params: 171835622
2024-04-29 00:59:50,406 [trainer.py] => Trainable params: 85983136
2024-04-29 00:59:53,773 [foster.py] => Learning on 80-90
2024-04-29 00:59:53,775 [foster.py] => All params: 171866372
2024-04-29 00:59:53,776 [foster.py] => Trainable params: 86006196
2024-04-29 00:59:53,891 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]
  0%|          | 0/1 [00:00<?, ?it/s]Task 4, Epoch 1/1 => Loss 6.342, Loss_clf 1.114, Loss_fe 1.904, Loss_kd 2.955, Train_accy 53.36, Test_accy 78.11:   0%|          | 0/1 [01:40<?, ?it/s]Task 4, Epoch 1/1 => Loss 6.342, Loss_clf 1.114, Loss_fe 1.904, Loss_kd 2.955, Train_accy 53.36, Test_accy 78.11: 100%|██████████| 1/1 [01:40<00:00, 100.28s/it]Task 4, Epoch 1/1 => Loss 6.342, Loss_clf 1.114, Loss_fe 1.904, Loss_kd 2.955, Train_accy 53.36, Test_accy 78.11: 100%|██████████| 1/1 [01:40<00:00, 100.28s/it]
2024-04-29 01:01:34,174 [foster.py] => Task 4, Epoch 1/1 => Loss 6.342, Loss_clf 1.114, Loss_fe 1.904, Loss_kd 2.955, Train_accy 53.36, Test_accy 78.11
2024-04-29 01:01:34,175 [foster.py] => do not weight align teacher!
2024-04-29 01:01:34,178 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]
  0%|          | 0/1 [00:00<?, ?it/s]SNet: Task 4, Epoch 1/1 => Loss 3.341,  Train_accy 31.59, Test_accy 75.22:   0%|          | 0/1 [01:34<?, ?it/s]SNet: Task 4, Epoch 1/1 => Loss 3.341,  Train_accy 31.59, Test_accy 75.22: 100%|██████████| 1/1 [01:34<00:00, 94.64s/it]SNet: Task 4, Epoch 1/1 => Loss 3.341,  Train_accy 31.59, Test_accy 75.22: 100%|██████████| 1/1 [01:34<00:00, 94.64s/it]
2024-04-29 01:03:15,616 [foster.py] => SNet: Task 4, Epoch 1/1 => Loss 3.341,  Train_accy 31.59, Test_accy 75.22
2024-04-29 01:03:15,617 [foster.py] => do not weight align student!
2024-04-29 01:03:38,585 [foster.py] => darknet eval: 
2024-04-29 01:03:38,586 [foster.py] => CNN top1 curve: 75.22
2024-04-29 01:03:38,586 [foster.py] => CNN top5 curve: 96.34
2024-04-29 01:03:38,587 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 01:06:07,778 [foster.py] => Exemplar size: 1800
2024-04-29 01:06:07,778 [trainer.py] => CNN: {'total': 78.11, '00-49': 87.6, '50-59': 66.6, '60-69': 79.5, '70-79': 57.8, '80-89': 61.1, 'old': 80.24, 'new': 61.1}
2024-04-29 01:06:07,779 [trainer.py] => NME: {'total': 83.6, '00-49': 87.4, '50-59': 75.7, '60-69': 85.0, '70-79': 72.9, '80-89': 81.8, 'old': 83.82, 'new': 81.8}
2024-04-29 01:06:07,779 [trainer.py] => CNN top1 curve: [89.1, 86.92, 84.81, 80.19, 78.11]
2024-04-29 01:06:07,779 [trainer.py] => CNN top5 curve: [98.9, 98.47, 97.87, 97.48, 97.27]
2024-04-29 01:06:07,779 [trainer.py] => NME top1 curve: [90.38, 89.17, 87.93, 85.12, 83.6]
2024-04-29 01:06:07,779 [trainer.py] => NME top5 curve: [98.76, 98.67, 98.56, 98.02, 97.48]

Average Accuracy (CNN): 83.83
Average Accuracy (NME): 87.24
2024-04-29 01:06:07,779 [trainer.py] => Average Accuracy (CNN): 83.83
2024-04-29 01:06:07,779 [trainer.py] => Average Accuracy (NME): 87.24
2024-04-29 01:06:07,779 [trainer.py] => Train Time: 977.99
2024-04-29 01:06:07,779 [trainer.py] => Test Time: 318.96 

2024-04-29 01:06:07,781 [trainer.py] => All params: 171866372
2024-04-29 01:06:07,782 [trainer.py] => Trainable params: 86006196
2024-04-29 01:06:12,493 [foster.py] => Learning on 90-100
2024-04-29 01:06:12,496 [foster.py] => All params: 171897122
2024-04-29 01:06:12,496 [foster.py] => Trainable params: 86029256
2024-04-29 01:06:12,643 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175]
  0%|          | 0/1 [00:00<?, ?it/s]Task 5, Epoch 1/1 => Loss 6.875, Loss_clf 1.220, Loss_fe 2.111, Loss_kd 3.189, Train_accy 57.50, Test_accy 77.97:   0%|          | 0/1 [01:46<?, ?it/s]Task 5, Epoch 1/1 => Loss 6.875, Loss_clf 1.220, Loss_fe 2.111, Loss_kd 3.189, Train_accy 57.50, Test_accy 77.97: 100%|██████████| 1/1 [01:46<00:00, 106.67s/it]Task 5, Epoch 1/1 => Loss 6.875, Loss_clf 1.220, Loss_fe 2.111, Loss_kd 3.189, Train_accy 57.50, Test_accy 77.97: 100%|██████████| 1/1 [01:46<00:00, 106.67s/it]
2024-04-29 01:07:59,315 [foster.py] => Task 5, Epoch 1/1 => Loss 6.875, Loss_clf 1.220, Loss_fe 2.111, Loss_kd 3.189, Train_accy 57.50, Test_accy 77.97
2024-04-29 01:07:59,317 [foster.py] => do not weight align teacher!
2024-04-29 01:07:59,321 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405 ]
  0%|          | 0/1 [00:00<?, ?it/s]SNet: Task 5, Epoch 1/1 => Loss 3.475,  Train_accy 38.13, Test_accy 75.34:   0%|          | 0/1 [01:39<?, ?it/s]SNet: Task 5, Epoch 1/1 => Loss 3.475,  Train_accy 38.13, Test_accy 75.34: 100%|██████████| 1/1 [01:39<00:00, 99.49s/it]SNet: Task 5, Epoch 1/1 => Loss 3.475,  Train_accy 38.13, Test_accy 75.34: 100%|██████████| 1/1 [01:39<00:00, 99.49s/it]
2024-04-29 01:09:42,526 [foster.py] => SNet: Task 5, Epoch 1/1 => Loss 3.475,  Train_accy 38.13, Test_accy 75.34
2024-04-29 01:09:42,526 [foster.py] => do not weight align student!
2024-04-29 01:10:07,769 [foster.py] => darknet eval: 
2024-04-29 01:10:07,769 [foster.py] => CNN top1 curve: 75.34
2024-04-29 01:10:07,769 [foster.py] => CNN top5 curve: 95.85
2024-04-29 01:10:07,772 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 01:12:51,625 [foster.py] => Exemplar size: 2000
2024-04-29 01:12:51,625 [trainer.py] => CNN: {'total': 77.97, '00-49': 86.66, '50-59': 72.9, '60-69': 77.4, '70-79': 61.5, '80-89': 62.8, '90-99': 71.8, 'old': 78.66, 'new': 71.8}
2024-04-29 01:12:51,625 [trainer.py] => NME: {'total': 82.95, '00-49': 86.94, '50-59': 75.4, '60-69': 85.4, '70-79': 73.4, '80-89': 78.1, '90-99': 82.5, 'old': 83.0, 'new': 82.5}
2024-04-29 01:12:51,625 [trainer.py] => CNN top1 curve: [89.1, 86.92, 84.81, 80.19, 78.11, 77.97]
2024-04-29 01:12:51,625 [trainer.py] => CNN top5 curve: [98.9, 98.47, 97.87, 97.48, 97.27, 96.71]
2024-04-29 01:12:51,625 [trainer.py] => NME top1 curve: [90.38, 89.17, 87.93, 85.12, 83.6, 82.95]
2024-04-29 01:12:51,625 [trainer.py] => NME top5 curve: [98.76, 98.67, 98.56, 98.02, 97.48, 96.95]

Average Accuracy (CNN): 82.85
Average Accuracy (NME): 86.53
2024-04-29 01:12:51,625 [trainer.py] => Average Accuracy (CNN): 82.85
2024-04-29 01:12:51,625 [trainer.py] => Average Accuracy (NME): 86.53
2024-04-29 01:12:51,625 [trainer.py] => Train Time: 1213.17
2024-04-29 01:12:51,625 [trainer.py] => Test Time: 417.80999999999995 

Accuracy Matrix (CNN):
[[89.1  88.9  88.8  87.58 87.6  86.66]
 [ 0.   77.   68.7  68.5  66.6  72.9 ]
 [ 0.    0.   81.   69.9  79.5  77.4 ]
 [ 0.    0.    0.   65.2  57.8  61.5 ]
 [ 0.    0.    0.    0.   61.1  62.8 ]
 [ 0.    0.    0.    0.    0.   71.8 ]]
2024-04-29 01:12:51,626 [trainer.py] => Forgetting (CNN): 2.767999999999998
Accuracy Matrix (NME):
[[90.38 89.86 89.24 88.42 87.4  86.94]
 [ 0.   85.7  79.7  75.7  75.7  75.4 ]
 [ 0.    0.   89.6  85.7  85.   85.4 ]
 [ 0.    0.    0.   77.5  72.9  73.4 ]
 [ 0.    0.    0.    0.   81.8  78.1 ]
 [ 0.    0.    0.    0.    0.   82.5 ]]
2024-04-29 01:12:51,626 [trainer.py] => Forgetting (NME): 5.147999999999996
2024-04-29 01:12:55,058 [trainer.py] => config: ./exps/l2p_cifar_B50_Inc5.json
2024-04-29 01:12:55,059 [trainer.py] => prefix:  
2024-04-29 01:12:55,059 [trainer.py] => dataset: cifar224
2024-04-29 01:12:55,059 [trainer.py] => memory_size: 0
2024-04-29 01:12:55,059 [trainer.py] => memory_per_class: 0
2024-04-29 01:12:55,059 [trainer.py] => fixed_memory: False
2024-04-29 01:12:55,059 [trainer.py] => shuffle: True
2024-04-29 01:12:55,059 [trainer.py] => init_cls: 50
2024-04-29 01:12:55,059 [trainer.py] => increment: 10
2024-04-29 01:12:55,059 [trainer.py] => model_name: l2p
2024-04-29 01:12:55,059 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-04-29 01:12:55,059 [trainer.py] => get_original_backbone: True
2024-04-29 01:12:55,059 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-29 01:12:55,059 [trainer.py] => seed: 1993
2024-04-29 01:12:55,059 [trainer.py] => tuned_epoch: 20
2024-04-29 01:12:55,059 [trainer.py] => init_lr: 0.001875
2024-04-29 01:12:55,059 [trainer.py] => batch_size: 48
2024-04-29 01:12:55,059 [trainer.py] => weight_decay: 0
2024-04-29 01:12:55,059 [trainer.py] => min_lr: 1e-05
2024-04-29 01:12:55,059 [trainer.py] => optimizer: adam
2024-04-29 01:12:55,059 [trainer.py] => scheduler: constant
2024-04-29 01:12:55,059 [trainer.py] => reinit_optimizer: True
2024-04-29 01:12:55,059 [trainer.py] => global_pool: token
2024-04-29 01:12:55,059 [trainer.py] => head_type: prompt
2024-04-29 01:12:55,059 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-29 01:12:55,059 [trainer.py] => pretrained: True
2024-04-29 01:12:55,059 [trainer.py] => drop: 0.0
2024-04-29 01:12:55,059 [trainer.py] => drop_path: 0.0
2024-04-29 01:12:55,059 [trainer.py] => prompt_pool: True
2024-04-29 01:12:55,059 [trainer.py] => size: 10
2024-04-29 01:12:55,059 [trainer.py] => length: 5
2024-04-29 01:12:55,060 [trainer.py] => top_k: 5
2024-04-29 01:12:55,060 [trainer.py] => initializer: uniform
2024-04-29 01:12:55,060 [trainer.py] => prompt_key: True
2024-04-29 01:12:55,060 [trainer.py] => prompt_key_init: uniform
2024-04-29 01:12:55,060 [trainer.py] => use_prompt_mask: False
2024-04-29 01:12:55,060 [trainer.py] => shared_prompt_pool: False
2024-04-29 01:12:55,060 [trainer.py] => shared_prompt_key: False
2024-04-29 01:12:55,060 [trainer.py] => batchwise_prompt: True
2024-04-29 01:12:55,060 [trainer.py] => embedding_key: cls
2024-04-29 01:12:55,060 [trainer.py] => predefined_key: 
2024-04-29 01:12:55,060 [trainer.py] => pull_constraint: True
2024-04-29 01:12:55,060 [trainer.py] => pull_constraint_coeff: 0.1
Files already downloaded and verified
Files already downloaded and verified
2024-04-29 01:12:56,918 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-29 01:12:59,678 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-04-29 01:12:59,679 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-04-29 01:13:10,694 [l2p.py] => 85,940,836 model total parameters.
2024-04-29 01:13:10,694 [l2p.py] => 122,980 model training parameters.
2024-04-29 01:13:10,695 [l2p.py] => prompt.prompt: 38400
2024-04-29 01:13:10,695 [l2p.py] => prompt.prompt_key: 7680
2024-04-29 01:13:10,695 [l2p.py] => head.weight: 76800
2024-04-29 01:13:10,695 [l2p.py] => head.bias: 100
2024-04-29 01:13:10,697 [trainer.py] => All params: 171816392
2024-04-29 01:13:10,698 [trainer.py] => Trainable params: 122980
2024-04-29 01:13:10,698 [l2p.py] => Learning on 0-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.204, Train_accy 64.40:   0%|          | 0/20 [03:18<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.204, Train_accy 64.40:   5%|▌         | 1/20 [03:18<1:02:52, 198.53s/it]Task 0, Epoch 2/20 => Loss 0.614, Train_accy 76.08:   5%|▌         | 1/20 [06:37<1:02:52, 198.53s/it]Task 0, Epoch 2/20 => Loss 0.614, Train_accy 76.08:  10%|█         | 2/20 [06:37<59:35, 198.64s/it]  Task 0, Epoch 3/20 => Loss 0.499, Train_accy 78.95:  10%|█         | 2/20 [09:54<59:35, 198.64s/it]Task 0, Epoch 3/20 => Loss 0.499, Train_accy 78.95:  15%|█▌        | 3/20 [09:54<56:08, 198.15s/it]Task 0, Epoch 4/20 => Loss 0.445, Train_accy 80.04:  15%|█▌        | 3/20 [13:13<56:08, 198.15s/it]Task 0, Epoch 4/20 => Loss 0.445, Train_accy 80.04:  20%|██        | 4/20 [13:13<52:53, 198.34s/it]Task 0, Epoch 5/20 => Loss 0.402, Train_accy 81.23, Test_accy 93.50:  20%|██        | 4/20 [16:57<52:53, 198.34s/it]Task 0, Epoch 5/20 => Loss 0.402, Train_accy 81.23, Test_accy 93.50:  25%|██▌       | 5/20 [16:57<51:55, 207.73s/it]Task 0, Epoch 6/20 => Loss 0.384, Train_accy 81.57:  25%|██▌       | 5/20 [20:16<51:55, 207.73s/it]                 Task 0, Epoch 6/20 => Loss 0.384, Train_accy 81.57:  30%|███       | 6/20 [20:16<47:44, 204.63s/it]Task 0, Epoch 7/20 => Loss 0.358, Train_accy 82.12:  30%|███       | 6/20 [23:34<47:44, 204.63s/it]Task 0, Epoch 7/20 => Loss 0.358, Train_accy 82.12:  35%|███▌      | 7/20 [23:34<43:51, 202.44s/it]Task 0, Epoch 8/20 => Loss 0.354, Train_accy 82.47:  35%|███▌      | 7/20 [26:52<43:51, 202.44s/it]Task 0, Epoch 8/20 => Loss 0.354, Train_accy 82.47:  40%|████      | 8/20 [26:52<40:14, 201.22s/it]Task 0, Epoch 9/20 => Loss 0.336, Train_accy 83.00:  40%|████      | 8/20 [30:11<40:14, 201.22s/it]Task 0, Epoch 9/20 => Loss 0.336, Train_accy 83.00:  45%|████▌     | 9/20 [30:11<36:43, 200.33s/it]Task 0, Epoch 10/20 => Loss 0.336, Train_accy 82.84, Test_accy 94.16:  45%|████▌     | 9/20 [33:55<36:43, 200.33s/it]Task 0, Epoch 10/20 => Loss 0.336, Train_accy 82.84, Test_accy 94.16:  50%|█████     | 10/20 [33:55<34:37, 207.74s/it]Task 0, Epoch 11/20 => Loss 0.321, Train_accy 83.22:  50%|█████     | 10/20 [37:14<34:37, 207.74s/it]                 Task 0, Epoch 11/20 => Loss 0.321, Train_accy 83.22:  55%|█████▌    | 11/20 [37:14<30:43, 204.86s/it]Task 0, Epoch 12/20 => Loss 0.312, Train_accy 83.44:  55%|█████▌    | 11/20 [40:32<30:43, 204.86s/it]Task 0, Epoch 12/20 => Loss 0.312, Train_accy 83.44:  60%|██████    | 12/20 [40:32<27:02, 202.86s/it]Task 0, Epoch 13/20 => Loss 0.292, Train_accy 83.95:  60%|██████    | 12/20 [43:50<27:02, 202.86s/it]Task 0, Epoch 13/20 => Loss 0.292, Train_accy 83.95:  65%|██████▌   | 13/20 [43:50<23:30, 201.44s/it]Task 0, Epoch 14/20 => Loss 0.275, Train_accy 84.35:  65%|██████▌   | 13/20 [47:08<23:30, 201.44s/it]Task 0, Epoch 14/20 => Loss 0.275, Train_accy 84.35:  70%|███████   | 14/20 [47:08<20:03, 200.53s/it]Task 0, Epoch 15/20 => Loss 0.279, Train_accy 84.25, Test_accy 93.84:  70%|███████   | 14/20 [50:53<20:03, 200.53s/it]Task 0, Epoch 15/20 => Loss 0.279, Train_accy 84.25, Test_accy 93.84:  75%|███████▌  | 15/20 [50:53<17:18, 207.66s/it]Task 0, Epoch 16/20 => Loss 0.279, Train_accy 84.31:  75%|███████▌  | 15/20 [54:11<17:18, 207.66s/it]                 Task 0, Epoch 16/20 => Loss 0.279, Train_accy 84.31:  80%|████████  | 16/20 [54:11<13:39, 204.87s/it]Task 0, Epoch 17/20 => Loss 0.268, Train_accy 84.64:  80%|████████  | 16/20 [57:30<13:39, 204.87s/it]Task 0, Epoch 17/20 => Loss 0.268, Train_accy 84.64:  85%|████████▌ | 17/20 [57:30<10:08, 202.98s/it]Task 0, Epoch 18/20 => Loss 0.259, Train_accy 84.89:  85%|████████▌ | 17/20 [1:00:48<10:08, 202.98s/it]Task 0, Epoch 18/20 => Loss 0.259, Train_accy 84.89:  90%|█████████ | 18/20 [1:00:48<06:43, 201.73s/it]Task 0, Epoch 19/20 => Loss 0.263, Train_accy 84.54:  90%|█████████ | 18/20 [1:04:07<06:43, 201.73s/it]Task 0, Epoch 19/20 => Loss 0.263, Train_accy 84.54:  95%|█████████▌| 19/20 [1:04:07<03:20, 200.70s/it]Task 0, Epoch 20/20 => Loss 0.253, Train_accy 84.89, Test_accy 94.36:  95%|█████████▌| 19/20 [1:07:51<03:20, 200.70s/it]Task 0, Epoch 20/20 => Loss 0.253, Train_accy 84.89, Test_accy 94.36: 100%|██████████| 20/20 [1:07:51<00:00, 207.73s/it]Task 0, Epoch 20/20 => Loss 0.253, Train_accy 84.89, Test_accy 94.36: 100%|██████████| 20/20 [1:07:51<00:00, 203.56s/it]
2024-04-29 02:21:03,227 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.253, Train_accy 84.89, Test_accy 94.36
2024-04-29 02:21:29,173 [trainer.py] => No NME accuracy.
2024-04-29 02:21:29,173 [trainer.py] => CNN: {'total': 94.36, '00-49': 94.36, 'old': 0, 'new': 94.36}
2024-04-29 02:21:29,173 [trainer.py] => CNN top1 curve: [94.36]
2024-04-29 02:21:29,173 [trainer.py] => CNN top5 curve: [99.3]

Average Accuracy (CNN): 94.36
2024-04-29 02:21:29,173 [trainer.py] => Average Accuracy (CNN): 94.36 

2024-04-29 02:21:29,173 [trainer.py] => Train Time: 8143.63
2024-04-29 02:21:29,174 [trainer.py] => Test Time: 25.94 

2024-04-29 02:21:29,175 [trainer.py] => All params: 171816392
2024-04-29 02:21:29,176 [trainer.py] => Trainable params: 122980
2024-04-29 02:21:29,176 [l2p.py] => Learning on 50-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.158, Train_accy 86.82:   0%|          | 0/20 [00:40<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.158, Train_accy 86.82:   5%|▌         | 1/20 [00:40<12:41, 40.10s/it]Task 1, Epoch 2/20 => Loss -0.052, Train_accy 92.36:   5%|▌         | 1/20 [01:20<12:41, 40.10s/it]Task 1, Epoch 2/20 => Loss -0.052, Train_accy 92.36:  10%|█         | 2/20 [01:20<12:02, 40.13s/it]Task 1, Epoch 3/20 => Loss -0.062, Train_accy 92.48:  10%|█         | 2/20 [02:00<12:02, 40.13s/it]Task 1, Epoch 3/20 => Loss -0.062, Train_accy 92.48:  15%|█▌        | 3/20 [02:00<11:21, 40.07s/it]Task 1, Epoch 4/20 => Loss -0.069, Train_accy 92.44:  15%|█▌        | 3/20 [02:40<11:21, 40.07s/it]Task 1, Epoch 4/20 => Loss -0.069, Train_accy 92.44:  20%|██        | 4/20 [02:40<10:39, 39.99s/it]Task 1, Epoch 5/20 => Loss -0.075, Train_accy 92.70, Test_accy 88.92:  20%|██        | 4/20 [03:51<10:39, 39.99s/it]Task 1, Epoch 5/20 => Loss -0.075, Train_accy 92.70, Test_accy 88.92:  25%|██▌       | 5/20 [03:51<12:48, 51.23s/it]Task 1, Epoch 6/20 => Loss -0.083, Train_accy 92.88:  25%|██▌       | 5/20 [04:31<12:48, 51.23s/it]                 Task 1, Epoch 6/20 => Loss -0.083, Train_accy 92.88:  30%|███       | 6/20 [04:31<11:04, 47.47s/it]Task 1, Epoch 7/20 => Loss -0.087, Train_accy 92.94:  30%|███       | 6/20 [05:11<11:04, 47.47s/it]Task 1, Epoch 7/20 => Loss -0.087, Train_accy 92.94:  35%|███▌      | 7/20 [05:11<09:45, 45.05s/it]Task 1, Epoch 8/20 => Loss -0.086, Train_accy 93.14:  35%|███▌      | 7/20 [05:51<09:45, 45.05s/it]Task 1, Epoch 8/20 => Loss -0.086, Train_accy 93.14:  40%|████      | 8/20 [05:51<08:41, 43.43s/it]Task 1, Epoch 9/20 => Loss -0.096, Train_accy 93.50:  40%|████      | 8/20 [06:31<08:41, 43.43s/it]Task 1, Epoch 9/20 => Loss -0.096, Train_accy 93.50:  45%|████▌     | 9/20 [06:31<07:46, 42.41s/it]Task 1, Epoch 10/20 => Loss -0.070, Train_accy 92.32, Test_accy 90.30:  45%|████▌     | 9/20 [07:42<07:46, 42.41s/it]Task 1, Epoch 10/20 => Loss -0.070, Train_accy 92.32, Test_accy 90.30:  50%|█████     | 10/20 [07:42<08:32, 51.23s/it]Task 1, Epoch 11/20 => Loss -0.100, Train_accy 93.68:  50%|█████     | 10/20 [08:22<08:32, 51.23s/it]                 Task 1, Epoch 11/20 => Loss -0.100, Train_accy 93.68:  55%|█████▌    | 11/20 [08:22<07:10, 47.85s/it]Task 1, Epoch 12/20 => Loss -0.078, Train_accy 92.98:  55%|█████▌    | 11/20 [09:02<07:10, 47.85s/it]Task 1, Epoch 12/20 => Loss -0.078, Train_accy 92.98:  60%|██████    | 12/20 [09:02<06:04, 45.51s/it]Task 1, Epoch 13/20 => Loss -0.091, Train_accy 93.54:  60%|██████    | 12/20 [09:43<06:04, 45.51s/it]Task 1, Epoch 13/20 => Loss -0.091, Train_accy 93.54:  65%|██████▌   | 13/20 [09:43<05:06, 43.85s/it]Task 1, Epoch 14/20 => Loss -0.085, Train_accy 93.50:  65%|██████▌   | 13/20 [10:23<05:06, 43.85s/it]Task 1, Epoch 14/20 => Loss -0.085, Train_accy 93.50:  70%|███████   | 14/20 [10:23<04:16, 42.70s/it]Task 1, Epoch 15/20 => Loss -0.079, Train_accy 92.96, Test_accy 91.12:  70%|███████   | 14/20 [11:34<04:16, 42.70s/it]Task 1, Epoch 15/20 => Loss -0.079, Train_accy 92.96, Test_accy 91.12:  75%|███████▌  | 15/20 [11:34<04:16, 51.23s/it]Task 1, Epoch 16/20 => Loss -0.114, Train_accy 94.00:  75%|███████▌  | 15/20 [12:14<04:16, 51.23s/it]                 Task 1, Epoch 16/20 => Loss -0.114, Train_accy 94.00:  80%|████████  | 16/20 [12:14<03:11, 47.95s/it]Task 1, Epoch 17/20 => Loss -0.106, Train_accy 93.86:  80%|████████  | 16/20 [12:54<03:11, 47.95s/it]Task 1, Epoch 17/20 => Loss -0.106, Train_accy 93.86:  85%|████████▌ | 17/20 [12:54<02:16, 45.62s/it]Task 1, Epoch 18/20 => Loss -0.090, Train_accy 93.80:  85%|████████▌ | 17/20 [13:34<02:16, 45.62s/it]Task 1, Epoch 18/20 => Loss -0.090, Train_accy 93.80:  90%|█████████ | 18/20 [13:34<01:27, 43.97s/it]Task 1, Epoch 19/20 => Loss -0.095, Train_accy 93.32:  90%|█████████ | 18/20 [14:14<01:27, 43.97s/it]Task 1, Epoch 19/20 => Loss -0.095, Train_accy 93.32:  95%|█████████▌| 19/20 [14:14<00:42, 42.74s/it]Task 1, Epoch 20/20 => Loss -0.105, Train_accy 93.64, Test_accy 91.62:  95%|█████████▌| 19/20 [15:25<00:42, 42.74s/it]Task 1, Epoch 20/20 => Loss -0.105, Train_accy 93.64, Test_accy 91.62: 100%|██████████| 20/20 [15:25<00:00, 51.25s/it]Task 1, Epoch 20/20 => Loss -0.105, Train_accy 93.64, Test_accy 91.62: 100%|██████████| 20/20 [15:25<00:00, 46.28s/it]
2024-04-29 02:36:54,992 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.105, Train_accy 93.64, Test_accy 91.62
2024-04-29 02:37:25,969 [trainer.py] => No NME accuracy.
2024-04-29 02:37:25,970 [trainer.py] => CNN: {'total': 91.62, '00-49': 93.78, '50-59': 80.8, 'old': 93.78, 'new': 80.8}
2024-04-29 02:37:25,970 [trainer.py] => CNN top1 curve: [94.36, 91.62]
2024-04-29 02:37:25,970 [trainer.py] => CNN top5 curve: [99.3, 99.15]

Average Accuracy (CNN): 92.99
2024-04-29 02:37:25,970 [trainer.py] => Average Accuracy (CNN): 92.99 

2024-04-29 02:37:25,970 [trainer.py] => Train Time: 9995.0
2024-04-29 02:37:25,970 [trainer.py] => Test Time: 56.92 

2024-04-29 02:37:25,971 [trainer.py] => All params: 171816392
2024-04-29 02:37:25,973 [trainer.py] => Trainable params: 122980
2024-04-29 02:37:25,973 [l2p.py] => Learning on 60-70
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.040, Train_accy 90.86:   0%|          | 0/20 [00:40<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.040, Train_accy 90.86:   5%|▌         | 1/20 [00:40<12:41, 40.08s/it]Task 2, Epoch 2/20 => Loss -0.085, Train_accy 94.04:   5%|▌         | 1/20 [01:20<12:41, 40.08s/it]Task 2, Epoch 2/20 => Loss -0.085, Train_accy 94.04:  10%|█         | 2/20 [01:20<12:02, 40.13s/it]Task 2, Epoch 3/20 => Loss -0.097, Train_accy 94.22:  10%|█         | 2/20 [02:00<12:02, 40.13s/it]Task 2, Epoch 3/20 => Loss -0.097, Train_accy 94.22:  15%|█▌        | 3/20 [02:00<11:21, 40.08s/it]Task 2, Epoch 4/20 => Loss -0.093, Train_accy 94.20:  15%|█▌        | 3/20 [02:40<11:21, 40.08s/it]Task 2, Epoch 4/20 => Loss -0.093, Train_accy 94.20:  20%|██        | 4/20 [02:40<10:41, 40.09s/it]Task 2, Epoch 5/20 => Loss -0.119, Train_accy 94.84, Test_accy 86.01:  20%|██        | 4/20 [03:56<10:41, 40.09s/it]Task 2, Epoch 5/20 => Loss -0.119, Train_accy 94.84, Test_accy 86.01:  25%|██▌       | 5/20 [03:56<13:15, 53.06s/it]Task 2, Epoch 6/20 => Loss -0.119, Train_accy 94.98:  25%|██▌       | 5/20 [04:36<13:15, 53.06s/it]                 Task 2, Epoch 6/20 => Loss -0.119, Train_accy 94.98:  30%|███       | 6/20 [04:36<11:20, 48.64s/it]Task 2, Epoch 7/20 => Loss -0.116, Train_accy 94.80:  30%|███       | 6/20 [05:16<11:20, 48.64s/it]Task 2, Epoch 7/20 => Loss -0.116, Train_accy 94.80:  35%|███▌      | 7/20 [05:16<09:55, 45.84s/it]Task 2, Epoch 8/20 => Loss -0.120, Train_accy 94.80:  35%|███▌      | 7/20 [05:56<09:55, 45.84s/it]Task 2, Epoch 8/20 => Loss -0.120, Train_accy 94.80:  40%|████      | 8/20 [05:56<08:47, 43.93s/it]Task 2, Epoch 9/20 => Loss -0.115, Train_accy 94.58:  40%|████      | 8/20 [06:36<08:47, 43.93s/it]Task 2, Epoch 9/20 => Loss -0.115, Train_accy 94.58:  45%|████▌     | 9/20 [06:36<07:49, 42.72s/it]Task 2, Epoch 10/20 => Loss -0.123, Train_accy 94.94, Test_accy 88.33:  45%|████▌     | 9/20 [07:52<07:49, 42.72s/it]Task 2, Epoch 10/20 => Loss -0.123, Train_accy 94.94, Test_accy 88.33:  50%|█████     | 10/20 [07:52<08:48, 52.88s/it]Task 2, Epoch 11/20 => Loss -0.123, Train_accy 94.98:  50%|█████     | 10/20 [08:32<08:48, 52.88s/it]                 Task 2, Epoch 11/20 => Loss -0.123, Train_accy 94.98:  55%|█████▌    | 11/20 [08:32<07:20, 48.95s/it]Task 2, Epoch 12/20 => Loss -0.119, Train_accy 95.10:  55%|█████▌    | 11/20 [09:12<07:20, 48.95s/it]Task 2, Epoch 12/20 => Loss -0.119, Train_accy 95.10:  60%|██████    | 12/20 [09:12<06:10, 46.28s/it]Task 2, Epoch 13/20 => Loss -0.115, Train_accy 94.78:  60%|██████    | 12/20 [09:52<06:10, 46.28s/it]Task 2, Epoch 13/20 => Loss -0.115, Train_accy 94.78:  65%|██████▌   | 13/20 [09:52<05:11, 44.43s/it]Task 2, Epoch 14/20 => Loss -0.116, Train_accy 94.68:  65%|██████▌   | 13/20 [10:32<05:11, 44.43s/it]Task 2, Epoch 14/20 => Loss -0.116, Train_accy 94.68:  70%|███████   | 14/20 [10:32<04:18, 43.13s/it]Task 2, Epoch 15/20 => Loss -0.120, Train_accy 95.22, Test_accy 89.23:  70%|███████   | 14/20 [11:48<04:18, 43.13s/it]Task 2, Epoch 15/20 => Loss -0.120, Train_accy 95.22, Test_accy 89.23:  75%|███████▌  | 15/20 [11:48<04:25, 53.07s/it]Task 2, Epoch 16/20 => Loss -0.132, Train_accy 95.22:  75%|███████▌  | 15/20 [12:28<04:25, 53.07s/it]                 Task 2, Epoch 16/20 => Loss -0.132, Train_accy 95.22:  80%|████████  | 16/20 [12:28<03:16, 49.17s/it]Task 2, Epoch 17/20 => Loss -0.131, Train_accy 95.42:  80%|████████  | 16/20 [13:08<03:16, 49.17s/it]Task 2, Epoch 17/20 => Loss -0.131, Train_accy 95.42:  85%|████████▌ | 17/20 [13:08<02:19, 46.46s/it]Task 2, Epoch 18/20 => Loss -0.137, Train_accy 95.60:  85%|████████▌ | 17/20 [13:49<02:19, 46.46s/it]Task 2, Epoch 18/20 => Loss -0.137, Train_accy 95.60:  90%|█████████ | 18/20 [13:49<01:29, 44.55s/it]Task 2, Epoch 19/20 => Loss -0.122, Train_accy 94.64:  90%|█████████ | 18/20 [14:28<01:29, 44.55s/it]Task 2, Epoch 19/20 => Loss -0.122, Train_accy 94.64:  95%|█████████▌| 19/20 [14:28<00:43, 43.15s/it]Task 2, Epoch 20/20 => Loss -0.107, Train_accy 94.84, Test_accy 89.96:  95%|█████████▌| 19/20 [15:45<00:43, 43.15s/it]Task 2, Epoch 20/20 => Loss -0.107, Train_accy 94.84, Test_accy 89.96: 100%|██████████| 20/20 [15:45<00:00, 53.14s/it]Task 2, Epoch 20/20 => Loss -0.107, Train_accy 94.84, Test_accy 89.96: 100%|██████████| 20/20 [15:45<00:00, 47.27s/it]
2024-04-29 02:53:11,428 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.107, Train_accy 94.84, Test_accy 89.96
2024-04-29 02:53:47,476 [trainer.py] => No NME accuracy.
2024-04-29 02:53:47,476 [trainer.py] => CNN: {'total': 89.96, '00-49': 93.88, '50-59': 78.3, '60-69': 82.0, 'old': 91.28, 'new': 82.0}
2024-04-29 02:53:47,476 [trainer.py] => CNN top1 curve: [94.36, 91.62, 89.96]
2024-04-29 02:53:47,476 [trainer.py] => CNN top5 curve: [99.3, 99.15, 99.0]

Average Accuracy (CNN): 91.98
2024-04-29 02:53:47,477 [trainer.py] => Average Accuracy (CNN): 91.98 

2024-04-29 02:53:47,477 [trainer.py] => Train Time: 11885.779999999999
2024-04-29 02:53:47,477 [trainer.py] => Test Time: 92.97 

2024-04-29 02:53:47,478 [trainer.py] => All params: 171816392
2024-04-29 02:53:47,479 [trainer.py] => Trainable params: 122980
2024-04-29 02:53:47,479 [l2p.py] => Learning on 70-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.125, Train_accy 87.52:   0%|          | 0/20 [00:39<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.125, Train_accy 87.52:   5%|▌         | 1/20 [00:39<12:38, 39.91s/it]Task 3, Epoch 2/20 => Loss -0.049, Train_accy 92.18:   5%|▌         | 1/20 [01:20<12:38, 39.91s/it]Task 3, Epoch 2/20 => Loss -0.049, Train_accy 92.18:  10%|█         | 2/20 [01:20<12:00, 40.03s/it]Task 3, Epoch 3/20 => Loss -0.068, Train_accy 92.58:  10%|█         | 2/20 [01:59<12:00, 40.03s/it]Task 3, Epoch 3/20 => Loss -0.068, Train_accy 92.58:  15%|█▌        | 3/20 [01:59<11:19, 40.00s/it]Task 3, Epoch 4/20 => Loss -0.080, Train_accy 93.00:  15%|█▌        | 3/20 [02:39<11:19, 40.00s/it]Task 3, Epoch 4/20 => Loss -0.080, Train_accy 93.00:  20%|██        | 4/20 [02:39<10:39, 39.99s/it]Task 3, Epoch 5/20 => Loss -0.065, Train_accy 92.52, Test_accy 82.89:  20%|██        | 4/20 [04:00<10:39, 39.99s/it]Task 3, Epoch 5/20 => Loss -0.065, Train_accy 92.52, Test_accy 82.89:  25%|██▌       | 5/20 [04:00<13:41, 54.77s/it]Task 3, Epoch 6/20 => Loss -0.089, Train_accy 93.42:  25%|██▌       | 5/20 [04:41<13:41, 54.77s/it]                 Task 3, Epoch 6/20 => Loss -0.089, Train_accy 93.42:  30%|███       | 6/20 [04:41<11:36, 49.78s/it]Task 3, Epoch 7/20 => Loss -0.076, Train_accy 92.86:  30%|███       | 6/20 [05:21<11:36, 49.78s/it]Task 3, Epoch 7/20 => Loss -0.076, Train_accy 92.86:  35%|███▌      | 7/20 [05:21<10:05, 46.59s/it]Task 3, Epoch 8/20 => Loss -0.105, Train_accy 93.98:  35%|███▌      | 7/20 [06:01<10:05, 46.59s/it]Task 3, Epoch 8/20 => Loss -0.105, Train_accy 93.98:  40%|████      | 8/20 [06:01<08:54, 44.52s/it]Task 3, Epoch 9/20 => Loss -0.089, Train_accy 93.36:  40%|████      | 8/20 [06:41<08:54, 44.52s/it]Task 3, Epoch 9/20 => Loss -0.089, Train_accy 93.36:  45%|████▌     | 9/20 [06:41<07:54, 43.12s/it]Task 3, Epoch 10/20 => Loss -0.089, Train_accy 93.72, Test_accy 85.20:  45%|████▌     | 9/20 [08:02<07:54, 43.12s/it]Task 3, Epoch 10/20 => Loss -0.089, Train_accy 93.72, Test_accy 85.20:  50%|█████     | 10/20 [08:02<09:08, 54.85s/it]Task 3, Epoch 11/20 => Loss -0.088, Train_accy 93.34:  50%|█████     | 10/20 [08:42<09:08, 54.85s/it]                 Task 3, Epoch 11/20 => Loss -0.088, Train_accy 93.34:  55%|█████▌    | 11/20 [08:42<07:33, 50.36s/it]Task 3, Epoch 12/20 => Loss -0.100, Train_accy 93.90:  55%|█████▌    | 11/20 [09:22<07:33, 50.36s/it]Task 3, Epoch 12/20 => Loss -0.100, Train_accy 93.90:  60%|██████    | 12/20 [09:22<06:17, 47.20s/it]Task 3, Epoch 13/20 => Loss -0.106, Train_accy 93.76:  60%|██████    | 12/20 [10:02<06:17, 47.20s/it]Task 3, Epoch 13/20 => Loss -0.106, Train_accy 93.76:  65%|██████▌   | 13/20 [10:02<05:15, 45.09s/it]Task 3, Epoch 14/20 => Loss -0.109, Train_accy 94.06:  65%|██████▌   | 13/20 [10:42<05:15, 45.09s/it]Task 3, Epoch 14/20 => Loss -0.109, Train_accy 94.06:  70%|███████   | 14/20 [10:42<04:21, 43.57s/it]Task 3, Epoch 15/20 => Loss -0.105, Train_accy 93.84, Test_accy 85.65:  70%|███████   | 14/20 [12:03<04:21, 43.57s/it]Task 3, Epoch 15/20 => Loss -0.105, Train_accy 93.84, Test_accy 85.65:  75%|███████▌  | 15/20 [12:03<04:34, 54.92s/it]Task 3, Epoch 16/20 => Loss -0.084, Train_accy 93.50:  75%|███████▌  | 15/20 [12:44<04:34, 54.92s/it]                 Task 3, Epoch 16/20 => Loss -0.084, Train_accy 93.50:  80%|████████  | 16/20 [12:44<03:21, 50.45s/it]Task 3, Epoch 17/20 => Loss -0.102, Train_accy 94.00:  80%|████████  | 16/20 [13:24<03:21, 50.45s/it]Task 3, Epoch 17/20 => Loss -0.102, Train_accy 94.00:  85%|████████▌ | 17/20 [13:24<02:21, 47.32s/it]Task 3, Epoch 18/20 => Loss -0.102, Train_accy 93.94:  85%|████████▌ | 17/20 [14:04<02:21, 47.32s/it]Task 3, Epoch 18/20 => Loss -0.102, Train_accy 93.94:  90%|█████████ | 18/20 [14:04<01:30, 45.17s/it]Task 3, Epoch 19/20 => Loss -0.102, Train_accy 93.78:  90%|█████████ | 18/20 [14:44<01:30, 45.17s/it]Task 3, Epoch 19/20 => Loss -0.102, Train_accy 93.78:  95%|█████████▌| 19/20 [14:44<00:43, 43.67s/it]Task 3, Epoch 20/20 => Loss -0.095, Train_accy 93.82, Test_accy 86.15:  95%|█████████▌| 19/20 [16:05<00:43, 43.67s/it]Task 3, Epoch 20/20 => Loss -0.095, Train_accy 93.82, Test_accy 86.15: 100%|██████████| 20/20 [16:05<00:00, 54.88s/it]Task 3, Epoch 20/20 => Loss -0.095, Train_accy 93.82, Test_accy 86.15: 100%|██████████| 20/20 [16:05<00:00, 48.27s/it]
2024-04-29 03:09:52,970 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.095, Train_accy 93.82, Test_accy 86.15
2024-04-29 03:10:34,003 [trainer.py] => No NME accuracy.
2024-04-29 03:10:34,003 [trainer.py] => CNN: {'total': 86.15, '00-49': 93.8, '50-59': 79.2, '60-69': 77.8, '70-79': 63.2, 'old': 89.43, 'new': 63.2}
2024-04-29 03:10:34,003 [trainer.py] => CNN top1 curve: [94.36, 91.62, 89.96, 86.15]
2024-04-29 03:10:34,003 [trainer.py] => CNN top5 curve: [99.3, 99.15, 99.0, 98.88]

Average Accuracy (CNN): 90.52
2024-04-29 03:10:34,003 [trainer.py] => Average Accuracy (CNN): 90.52 

2024-04-29 03:10:34,003 [trainer.py] => Train Time: 13816.63
2024-04-29 03:10:34,003 [trainer.py] => Test Time: 134.0 

2024-04-29 03:10:34,004 [trainer.py] => All params: 171816392
2024-04-29 03:10:34,005 [trainer.py] => Trainable params: 122980
2024-04-29 03:10:34,005 [l2p.py] => Learning on 80-90
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.093, Train_accy 88.58:   0%|          | 0/20 [00:40<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.093, Train_accy 88.58:   5%|▌         | 1/20 [00:40<12:41, 40.07s/it]Task 4, Epoch 2/20 => Loss -0.064, Train_accy 92.90:   5%|▌         | 1/20 [01:20<12:41, 40.07s/it]Task 4, Epoch 2/20 => Loss -0.064, Train_accy 92.90:  10%|█         | 2/20 [01:20<12:02, 40.16s/it]Task 4, Epoch 3/20 => Loss -0.080, Train_accy 93.40:  10%|█         | 2/20 [02:00<12:02, 40.16s/it]Task 4, Epoch 3/20 => Loss -0.080, Train_accy 93.40:  15%|█▌        | 3/20 [02:00<11:22, 40.16s/it]Task 4, Epoch 4/20 => Loss -0.079, Train_accy 93.18:  15%|█▌        | 3/20 [02:40<11:22, 40.16s/it]Task 4, Epoch 4/20 => Loss -0.079, Train_accy 93.18:  20%|██        | 4/20 [02:40<10:42, 40.15s/it]Task 4, Epoch 5/20 => Loss -0.079, Train_accy 93.50, Test_accy 79.43:  20%|██        | 4/20 [04:06<10:42, 40.15s/it]Task 4, Epoch 5/20 => Loss -0.079, Train_accy 93.50, Test_accy 79.43:  25%|██▌       | 5/20 [04:06<14:12, 56.80s/it]Task 4, Epoch 6/20 => Loss -0.075, Train_accy 93.06:  25%|██▌       | 5/20 [04:46<14:12, 56.80s/it]                 Task 4, Epoch 6/20 => Loss -0.075, Train_accy 93.06:  30%|███       | 6/20 [04:46<11:55, 51.10s/it]Task 4, Epoch 7/20 => Loss -0.112, Train_accy 94.54:  30%|███       | 6/20 [05:27<11:55, 51.10s/it]Task 4, Epoch 7/20 => Loss -0.112, Train_accy 94.54:  35%|███▌      | 7/20 [05:27<10:17, 47.52s/it]Task 4, Epoch 8/20 => Loss -0.090, Train_accy 93.92:  35%|███▌      | 7/20 [06:07<10:17, 47.52s/it]Task 4, Epoch 8/20 => Loss -0.090, Train_accy 93.92:  40%|████      | 8/20 [06:07<09:01, 45.11s/it]Task 4, Epoch 9/20 => Loss -0.104, Train_accy 94.22:  40%|████      | 8/20 [06:46<09:01, 45.11s/it]Task 4, Epoch 9/20 => Loss -0.104, Train_accy 94.22:  45%|████▌     | 9/20 [06:46<07:58, 43.49s/it]Task 4, Epoch 10/20 => Loss -0.103, Train_accy 94.00, Test_accy 80.76:  45%|████▌     | 9/20 [08:12<07:58, 43.49s/it]Task 4, Epoch 10/20 => Loss -0.103, Train_accy 94.00, Test_accy 80.76:  50%|█████     | 10/20 [08:12<09:23, 56.38s/it]Task 4, Epoch 11/20 => Loss -0.105, Train_accy 94.36:  50%|█████     | 10/20 [08:51<09:23, 56.38s/it]                 Task 4, Epoch 11/20 => Loss -0.105, Train_accy 94.36:  55%|█████▌    | 11/20 [08:51<07:41, 51.26s/it]Task 4, Epoch 12/20 => Loss -0.097, Train_accy 94.06:  55%|█████▌    | 11/20 [09:31<07:41, 51.26s/it]Task 4, Epoch 12/20 => Loss -0.097, Train_accy 94.06:  60%|██████    | 12/20 [09:31<06:22, 47.75s/it]Task 4, Epoch 13/20 => Loss -0.082, Train_accy 93.48:  60%|██████    | 12/20 [10:11<06:22, 47.75s/it]Task 4, Epoch 13/20 => Loss -0.082, Train_accy 93.48:  65%|██████▌   | 13/20 [10:11<05:17, 45.32s/it]Task 4, Epoch 14/20 => Loss -0.085, Train_accy 93.68:  65%|██████▌   | 13/20 [10:51<05:17, 45.32s/it]Task 4, Epoch 14/20 => Loss -0.085, Train_accy 93.68:  70%|███████   | 14/20 [10:51<04:21, 43.63s/it]Task 4, Epoch 15/20 => Loss -0.098, Train_accy 94.30, Test_accy 81.94:  70%|███████   | 14/20 [12:16<04:21, 43.63s/it]Task 4, Epoch 15/20 => Loss -0.098, Train_accy 94.30, Test_accy 81.94:  75%|███████▌  | 15/20 [12:16<04:41, 56.24s/it]Task 4, Epoch 16/20 => Loss -0.093, Train_accy 93.66:  75%|███████▌  | 15/20 [12:56<04:41, 56.24s/it]                 Task 4, Epoch 16/20 => Loss -0.093, Train_accy 93.66:  80%|████████  | 16/20 [12:56<03:24, 51.25s/it]Task 4, Epoch 17/20 => Loss -0.081, Train_accy 93.50:  80%|████████  | 16/20 [13:35<03:24, 51.25s/it]Task 4, Epoch 17/20 => Loss -0.081, Train_accy 93.50:  85%|████████▌ | 17/20 [13:35<02:23, 47.79s/it]Task 4, Epoch 18/20 => Loss -0.115, Train_accy 94.54:  85%|████████▌ | 17/20 [14:15<02:23, 47.79s/it]Task 4, Epoch 18/20 => Loss -0.115, Train_accy 94.54:  90%|█████████ | 18/20 [14:15<01:30, 45.36s/it]Task 4, Epoch 19/20 => Loss -0.113, Train_accy 94.32:  90%|█████████ | 18/20 [14:55<01:30, 45.36s/it]Task 4, Epoch 19/20 => Loss -0.113, Train_accy 94.32:  95%|█████████▌| 19/20 [14:55<00:43, 43.67s/it]Task 4, Epoch 20/20 => Loss -0.118, Train_accy 94.52, Test_accy 82.31:  95%|█████████▌| 19/20 [16:20<00:43, 43.67s/it]Task 4, Epoch 20/20 => Loss -0.118, Train_accy 94.52, Test_accy 82.31: 100%|██████████| 20/20 [16:20<00:00, 56.20s/it]Task 4, Epoch 20/20 => Loss -0.118, Train_accy 94.52, Test_accy 82.31: 100%|██████████| 20/20 [16:20<00:00, 49.04s/it]
2024-04-29 03:26:54,789 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.118, Train_accy 94.52, Test_accy 82.31
2024-04-29 03:27:40,367 [trainer.py] => No NME accuracy.
2024-04-29 03:27:40,368 [trainer.py] => CNN: {'total': 82.31, '00-49': 93.58, '50-59': 77.6, '60-69': 76.3, '70-79': 60.7, '80-89': 58.3, 'old': 85.31, 'new': 58.3}
2024-04-29 03:27:40,368 [trainer.py] => CNN top1 curve: [94.36, 91.62, 89.96, 86.15, 82.31]
2024-04-29 03:27:40,368 [trainer.py] => CNN top5 curve: [99.3, 99.15, 99.0, 98.88, 98.37]

Average Accuracy (CNN): 88.88
2024-04-29 03:27:40,368 [trainer.py] => Average Accuracy (CNN): 88.88 

2024-04-29 03:27:40,368 [trainer.py] => Train Time: 15778.119999999999
2024-04-29 03:27:40,368 [trainer.py] => Test Time: 179.57999999999998 

2024-04-29 03:27:40,370 [trainer.py] => All params: 171816392
2024-04-29 03:27:40,372 [trainer.py] => Trainable params: 122980
2024-04-29 03:27:40,373 [l2p.py] => Learning on 90-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.134, Train_accy 87.40:   0%|          | 0/20 [00:39<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.134, Train_accy 87.40:   5%|▌         | 1/20 [00:39<12:36, 39.81s/it]Task 5, Epoch 2/20 => Loss -0.015, Train_accy 91.10:   5%|▌         | 1/20 [01:19<12:36, 39.81s/it]Task 5, Epoch 2/20 => Loss -0.015, Train_accy 91.10:  10%|█         | 2/20 [01:19<11:56, 39.82s/it]Task 5, Epoch 3/20 => Loss -0.044, Train_accy 92.22:  10%|█         | 2/20 [01:59<11:56, 39.82s/it]Task 5, Epoch 3/20 => Loss -0.044, Train_accy 92.22:  15%|█▌        | 3/20 [01:59<11:16, 39.82s/it]Task 5, Epoch 4/20 => Loss -0.044, Train_accy 92.28:  15%|█▌        | 3/20 [02:39<11:16, 39.82s/it]Task 5, Epoch 4/20 => Loss -0.044, Train_accy 92.28:  20%|██        | 4/20 [02:39<10:36, 39.78s/it]Task 5, Epoch 5/20 => Loss -0.076, Train_accy 93.56, Test_accy 79.12:  20%|██        | 4/20 [04:09<10:36, 39.78s/it]Task 5, Epoch 5/20 => Loss -0.076, Train_accy 93.56, Test_accy 79.12:  25%|██▌       | 5/20 [04:09<14:31, 58.07s/it]Task 5, Epoch 6/20 => Loss -0.056, Train_accy 92.50:  25%|██▌       | 5/20 [04:49<14:31, 58.07s/it]                 Task 5, Epoch 6/20 => Loss -0.056, Train_accy 92.50:  30%|███       | 6/20 [04:49<12:07, 51.93s/it]Task 5, Epoch 7/20 => Loss -0.061, Train_accy 92.66:  30%|███       | 6/20 [05:29<12:07, 51.93s/it]Task 5, Epoch 7/20 => Loss -0.061, Train_accy 92.66:  35%|███▌      | 7/20 [05:29<10:23, 47.97s/it]Task 5, Epoch 8/20 => Loss -0.084, Train_accy 93.42:  35%|███▌      | 7/20 [06:09<10:23, 47.97s/it]Task 5, Epoch 8/20 => Loss -0.084, Train_accy 93.42:  40%|████      | 8/20 [06:09<09:04, 45.35s/it]Task 5, Epoch 9/20 => Loss -0.071, Train_accy 92.92:  40%|████      | 8/20 [06:48<09:04, 45.35s/it]Task 5, Epoch 9/20 => Loss -0.071, Train_accy 92.92:  45%|████▌     | 9/20 [06:48<07:59, 43.59s/it]Task 5, Epoch 10/20 => Loss -0.075, Train_accy 93.04, Test_accy 80.49:  45%|████▌     | 9/20 [08:19<07:59, 43.59s/it]Task 5, Epoch 10/20 => Loss -0.075, Train_accy 93.04, Test_accy 80.49:  50%|█████     | 10/20 [08:19<09:40, 58.04s/it]Task 5, Epoch 11/20 => Loss -0.079, Train_accy 93.26:  50%|█████     | 10/20 [08:59<09:40, 58.04s/it]                 Task 5, Epoch 11/20 => Loss -0.079, Train_accy 93.26:  55%|█████▌    | 11/20 [08:59<07:52, 52.45s/it]Task 5, Epoch 12/20 => Loss -0.072, Train_accy 93.22:  55%|█████▌    | 11/20 [09:38<07:52, 52.45s/it]Task 5, Epoch 12/20 => Loss -0.072, Train_accy 93.22:  60%|██████    | 12/20 [09:38<06:28, 48.59s/it]Task 5, Epoch 13/20 => Loss -0.083, Train_accy 93.22:  60%|██████    | 12/20 [10:18<06:28, 48.59s/it]Task 5, Epoch 13/20 => Loss -0.083, Train_accy 93.22:  65%|██████▌   | 13/20 [10:18<05:21, 45.91s/it]Task 5, Epoch 14/20 => Loss -0.082, Train_accy 93.56:  65%|██████▌   | 13/20 [10:58<05:21, 45.91s/it]Task 5, Epoch 14/20 => Loss -0.082, Train_accy 93.56:  70%|███████   | 14/20 [10:58<04:24, 44.06s/it]Task 5, Epoch 15/20 => Loss -0.093, Train_accy 93.78, Test_accy 80.57:  70%|███████   | 14/20 [12:28<04:24, 44.06s/it]Task 5, Epoch 15/20 => Loss -0.093, Train_accy 93.78, Test_accy 80.57:  75%|███████▌  | 15/20 [12:28<04:49, 57.98s/it]Task 5, Epoch 16/20 => Loss -0.086, Train_accy 93.62:  75%|███████▌  | 15/20 [13:08<04:49, 57.98s/it]                 Task 5, Epoch 16/20 => Loss -0.086, Train_accy 93.62:  80%|████████  | 16/20 [13:08<03:30, 52.56s/it]Task 5, Epoch 17/20 => Loss -0.090, Train_accy 93.42:  80%|████████  | 16/20 [13:48<03:30, 52.56s/it]Task 5, Epoch 17/20 => Loss -0.090, Train_accy 93.42:  85%|████████▌ | 17/20 [13:48<02:26, 48.69s/it]Task 5, Epoch 18/20 => Loss -0.095, Train_accy 93.82:  85%|████████▌ | 17/20 [14:28<02:26, 48.69s/it]Task 5, Epoch 18/20 => Loss -0.095, Train_accy 93.82:  90%|█████████ | 18/20 [14:28<01:31, 45.98s/it]Task 5, Epoch 19/20 => Loss -0.098, Train_accy 93.68:  90%|█████████ | 18/20 [15:07<01:31, 45.98s/it]Task 5, Epoch 19/20 => Loss -0.098, Train_accy 93.68:  95%|█████████▌| 19/20 [15:07<00:44, 44.08s/it]Task 5, Epoch 20/20 => Loss -0.085, Train_accy 93.28, Test_accy 81.01:  95%|█████████▌| 19/20 [16:37<00:44, 44.08s/it]Task 5, Epoch 20/20 => Loss -0.085, Train_accy 93.28, Test_accy 81.01: 100%|██████████| 20/20 [16:37<00:00, 57.94s/it]Task 5, Epoch 20/20 => Loss -0.085, Train_accy 93.28, Test_accy 81.01: 100%|██████████| 20/20 [16:37<00:00, 49.90s/it]
2024-04-29 03:44:18,323 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.085, Train_accy 93.28, Test_accy 81.01
2024-04-29 03:45:08,901 [trainer.py] => No NME accuracy.
2024-04-29 03:45:08,901 [trainer.py] => CNN: {'total': 81.01, '00-49': 93.6, '50-59': 76.7, '60-69': 74.6, '70-79': 61.3, '80-89': 58.4, '90-99': 71.1, 'old': 82.11, 'new': 71.1}
2024-04-29 03:45:08,901 [trainer.py] => CNN top1 curve: [94.36, 91.62, 89.96, 86.15, 82.31, 81.01]
2024-04-29 03:45:08,901 [trainer.py] => CNN top5 curve: [99.3, 99.15, 99.0, 98.88, 98.37, 97.97]

Average Accuracy (CNN): 87.57
2024-04-29 03:45:08,901 [trainer.py] => Average Accuracy (CNN): 87.57 

2024-04-29 03:45:08,901 [trainer.py] => Train Time: 17773.93
2024-04-29 03:45:08,901 [trainer.py] => Test Time: 230.15999999999997 

Accuracy Matrix (CNN):
[[94.36 93.78 93.88 93.8  93.58 93.6 ]
 [ 0.   80.8  78.3  79.2  77.6  76.7 ]
 [ 0.    0.   82.   77.8  76.3  74.6 ]
 [ 0.    0.    0.   63.2  60.7  61.3 ]
 [ 0.    0.    0.    0.   58.3  58.4 ]
 [ 0.    0.    0.    0.    0.   71.1 ]]
2024-04-29 03:45:08,902 [trainer.py] => Forgetting (CNN): 2.832000000000002
2024-04-29 03:45:12,845 [trainer.py] => config: ./exps/dualprompt_cifar_B50_Inc5.json
2024-04-29 03:45:12,845 [trainer.py] => prefix:  
2024-04-29 03:45:12,845 [trainer.py] => dataset: cifar224
2024-04-29 03:45:12,845 [trainer.py] => memory_size: 0
2024-04-29 03:45:12,845 [trainer.py] => memory_per_class: 0
2024-04-29 03:45:12,845 [trainer.py] => fixed_memory: False
2024-04-29 03:45:12,845 [trainer.py] => shuffle: True
2024-04-29 03:45:12,845 [trainer.py] => init_cls: 50
2024-04-29 03:45:12,845 [trainer.py] => increment: 10
2024-04-29 03:45:12,845 [trainer.py] => model_name: dualprompt
2024-04-29 03:45:12,845 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-04-29 03:45:12,846 [trainer.py] => get_original_backbone: True
2024-04-29 03:45:12,846 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-29 03:45:12,846 [trainer.py] => seed: 1993
2024-04-29 03:45:12,846 [trainer.py] => tuned_epoch: 20
2024-04-29 03:45:12,846 [trainer.py] => init_lr: 0.001
2024-04-29 03:45:12,846 [trainer.py] => batch_size: 48
2024-04-29 03:45:12,846 [trainer.py] => weight_decay: 0
2024-04-29 03:45:12,846 [trainer.py] => min_lr: 1e-05
2024-04-29 03:45:12,846 [trainer.py] => optimizer: adam
2024-04-29 03:45:12,846 [trainer.py] => scheduler: constant
2024-04-29 03:45:12,846 [trainer.py] => reinit_optimizer: True
2024-04-29 03:45:12,846 [trainer.py] => global_pool: token
2024-04-29 03:45:12,846 [trainer.py] => head_type: token
2024-04-29 03:45:12,846 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-29 03:45:12,846 [trainer.py] => pretrained: True
2024-04-29 03:45:12,846 [trainer.py] => drop: 0.0
2024-04-29 03:45:12,846 [trainer.py] => drop_path: 0.0
2024-04-29 03:45:12,846 [trainer.py] => use_g_prompt: True
2024-04-29 03:45:12,846 [trainer.py] => g_prompt_length: 5
2024-04-29 03:45:12,846 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-04-29 03:45:12,846 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-04-29 03:45:12,846 [trainer.py] => use_e_prompt: True
2024-04-29 03:45:12,846 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-04-29 03:45:12,847 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-04-29 03:45:12,847 [trainer.py] => prompt_pool: True
2024-04-29 03:45:12,847 [trainer.py] => size: 10
2024-04-29 03:45:12,847 [trainer.py] => length: 5
2024-04-29 03:45:12,847 [trainer.py] => top_k: 1
2024-04-29 03:45:12,847 [trainer.py] => initializer: uniform
2024-04-29 03:45:12,847 [trainer.py] => prompt_key: True
2024-04-29 03:45:12,847 [trainer.py] => prompt_key_init: uniform
2024-04-29 03:45:12,847 [trainer.py] => use_prompt_mask: True
2024-04-29 03:45:12,847 [trainer.py] => shared_prompt_pool: True
2024-04-29 03:45:12,847 [trainer.py] => shared_prompt_key: False
2024-04-29 03:45:12,847 [trainer.py] => batchwise_prompt: True
2024-04-29 03:45:12,847 [trainer.py] => embedding_key: cls
2024-04-29 03:45:12,847 [trainer.py] => predefined_key: 
2024-04-29 03:45:12,847 [trainer.py] => pull_constraint: True
2024-04-29 03:45:12,847 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-29 03:45:12,847 [trainer.py] => same_key_value: False
Files already downloaded and verified
Files already downloaded and verified
2024-04-29 03:45:14,728 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-29 03:45:19,509 [dualprompt.py] => 86,128,996 model total parameters.
2024-04-29 03:45:19,509 [dualprompt.py] => 330,340 model training parameters.
2024-04-29 03:45:19,509 [dualprompt.py] => g_prompt: 15360
2024-04-29 03:45:19,510 [dualprompt.py] => e_prompt.prompt: 230400
2024-04-29 03:45:19,510 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-04-29 03:45:19,510 [dualprompt.py] => head.weight: 76800
2024-04-29 03:45:19,510 [dualprompt.py] => head.bias: 100
2024-04-29 03:45:19,511 [trainer.py] => All params: 172004552
2024-04-29 03:45:19,512 [trainer.py] => Trainable params: 330340
2024-04-29 03:45:19,512 [dualprompt.py] => Learning on 0-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.075, Train_accy 70.82:   0%|          | 0/20 [02:59<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.075, Train_accy 70.82:   5%|▌         | 1/20 [02:59<56:51, 179.56s/it]Task 0, Epoch 2/20 => Loss 0.716, Train_accy 78.97:   5%|▌         | 1/20 [05:58<56:51, 179.56s/it]Task 0, Epoch 2/20 => Loss 0.716, Train_accy 78.97:  10%|█         | 2/20 [05:58<53:46, 179.25s/it]Task 0, Epoch 3/20 => Loss 0.645, Train_accy 80.59:  10%|█         | 2/20 [08:57<53:46, 179.25s/it]Task 0, Epoch 3/20 => Loss 0.645, Train_accy 80.59:  15%|█▌        | 3/20 [08:57<50:44, 179.10s/it]Task 0, Epoch 4/20 => Loss 0.581, Train_accy 81.89:  15%|█▌        | 3/20 [11:56<50:44, 179.10s/it]Task 0, Epoch 4/20 => Loss 0.581, Train_accy 81.89:  20%|██        | 4/20 [11:56<47:44, 179.05s/it]Task 0, Epoch 5/20 => Loss 0.587, Train_accy 82.12, Test_accy 92.92:  20%|██        | 4/20 [15:19<47:44, 179.05s/it]Task 0, Epoch 5/20 => Loss 0.587, Train_accy 82.12, Test_accy 92.92:  25%|██▌       | 5/20 [15:19<46:56, 187.77s/it]Task 0, Epoch 6/20 => Loss 0.548, Train_accy 82.99:  25%|██▌       | 5/20 [18:18<46:56, 187.77s/it]                 Task 0, Epoch 6/20 => Loss 0.548, Train_accy 82.99:  30%|███       | 6/20 [18:18<43:07, 184.85s/it]Task 0, Epoch 7/20 => Loss 0.534, Train_accy 83.48:  30%|███       | 6/20 [21:17<43:07, 184.85s/it]Task 0, Epoch 7/20 => Loss 0.534, Train_accy 83.48:  35%|███▌      | 7/20 [21:17<39:37, 182.89s/it]Task 0, Epoch 8/20 => Loss 0.543, Train_accy 83.19:  35%|███▌      | 7/20 [24:16<39:37, 182.89s/it]Task 0, Epoch 8/20 => Loss 0.543, Train_accy 83.19:  40%|████      | 8/20 [24:16<36:19, 181.59s/it]Task 0, Epoch 9/20 => Loss 0.525, Train_accy 83.72:  40%|████      | 8/20 [27:15<36:19, 181.59s/it]Task 0, Epoch 9/20 => Loss 0.525, Train_accy 83.72:  45%|████▌     | 9/20 [27:15<33:08, 180.75s/it]Task 0, Epoch 10/20 => Loss 0.526, Train_accy 83.71, Test_accy 94.24:  45%|████▌     | 9/20 [30:38<33:08, 180.75s/it]Task 0, Epoch 10/20 => Loss 0.526, Train_accy 83.71, Test_accy 94.24:  50%|█████     | 10/20 [30:38<31:16, 187.65s/it]Task 0, Epoch 11/20 => Loss 0.505, Train_accy 84.42:  50%|█████     | 10/20 [33:37<31:16, 187.65s/it]                 Task 0, Epoch 11/20 => Loss 0.505, Train_accy 84.42:  55%|█████▌    | 11/20 [33:37<27:44, 184.99s/it]Task 0, Epoch 12/20 => Loss 0.490, Train_accy 84.76:  55%|█████▌    | 11/20 [36:36<27:44, 184.99s/it]Task 0, Epoch 12/20 => Loss 0.490, Train_accy 84.76:  60%|██████    | 12/20 [36:36<24:25, 183.15s/it]Task 0, Epoch 13/20 => Loss 0.493, Train_accy 84.63:  60%|██████    | 12/20 [39:35<24:25, 183.15s/it]Task 0, Epoch 13/20 => Loss 0.493, Train_accy 84.63:  65%|██████▌   | 13/20 [39:35<21:14, 182.02s/it]Task 0, Epoch 14/20 => Loss 0.486, Train_accy 84.74:  65%|██████▌   | 13/20 [42:34<21:14, 182.02s/it]Task 0, Epoch 14/20 => Loss 0.486, Train_accy 84.74:  70%|███████   | 14/20 [42:34<18:06, 181.14s/it]Task 0, Epoch 15/20 => Loss 0.476, Train_accy 85.07, Test_accy 93.54:  70%|███████   | 14/20 [45:58<18:06, 181.14s/it]Task 0, Epoch 15/20 => Loss 0.476, Train_accy 85.07, Test_accy 93.54:  75%|███████▌  | 15/20 [45:58<15:38, 187.77s/it]Task 0, Epoch 16/20 => Loss 0.464, Train_accy 85.22:  75%|███████▌  | 15/20 [48:56<15:38, 187.77s/it]                 Task 0, Epoch 16/20 => Loss 0.464, Train_accy 85.22:  80%|████████  | 16/20 [48:56<12:20, 185.05s/it]Task 0, Epoch 17/20 => Loss 0.461, Train_accy 85.58:  80%|████████  | 16/20 [51:55<12:20, 185.05s/it]Task 0, Epoch 17/20 => Loss 0.461, Train_accy 85.58:  85%|████████▌ | 17/20 [51:55<09:09, 183.24s/it]Task 0, Epoch 18/20 => Loss 0.477, Train_accy 85.02:  85%|████████▌ | 17/20 [54:54<09:09, 183.24s/it]Task 0, Epoch 18/20 => Loss 0.477, Train_accy 85.02:  90%|█████████ | 18/20 [54:54<06:03, 181.98s/it]Task 0, Epoch 19/20 => Loss 0.467, Train_accy 85.29:  90%|█████████ | 18/20 [57:53<06:03, 181.98s/it]Task 0, Epoch 19/20 => Loss 0.467, Train_accy 85.29:  95%|█████████▌| 19/20 [57:53<03:01, 181.01s/it]Task 0, Epoch 20/20 => Loss 0.459, Train_accy 85.54, Test_accy 93.92:  95%|█████████▌| 19/20 [1:01:16<03:01, 181.01s/it]Task 0, Epoch 20/20 => Loss 0.459, Train_accy 85.54, Test_accy 93.92: 100%|██████████| 20/20 [1:01:16<00:00, 187.60s/it]Task 0, Epoch 20/20 => Loss 0.459, Train_accy 85.54, Test_accy 93.92: 100%|██████████| 20/20 [1:01:16<00:00, 183.83s/it]
2024-04-29 04:46:37,635 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.459, Train_accy 85.54, Test_accy 93.92
2024-04-29 04:47:01,725 [trainer.py] => No NME accuracy.
2024-04-29 04:47:01,725 [trainer.py] => CNN: {'total': 93.92, '00-49': 93.92, 'old': 0, 'new': 93.92}
2024-04-29 04:47:01,726 [trainer.py] => CNN top1 curve: [93.92]
2024-04-29 04:47:01,726 [trainer.py] => CNN top5 curve: [99.16]

Average Accuracy (CNN): 93.92
2024-04-29 04:47:01,726 [trainer.py] => Average Accuracy (CNN): 93.92 

2024-04-29 04:47:01,726 [trainer.py] => Train Time: 7354.049999999999
2024-04-29 04:47:01,726 [trainer.py] => Test Time: 24.09 

2024-04-29 04:47:01,729 [trainer.py] => All params: 172004552
2024-04-29 04:47:01,731 [trainer.py] => Trainable params: 330340
2024-04-29 04:47:01,732 [dualprompt.py] => Learning on 50-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.519, Train_accy 84.36:   0%|          | 0/20 [00:36<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.519, Train_accy 84.36:   5%|▌         | 1/20 [00:36<11:26, 36.15s/it]Task 1, Epoch 2/20 => Loss 0.238, Train_accy 91.94:   5%|▌         | 1/20 [01:12<11:26, 36.15s/it]Task 1, Epoch 2/20 => Loss 0.238, Train_accy 91.94:  10%|█         | 2/20 [01:12<10:50, 36.12s/it]Task 1, Epoch 3/20 => Loss 0.205, Train_accy 92.34:  10%|█         | 2/20 [01:48<10:50, 36.12s/it]Task 1, Epoch 3/20 => Loss 0.205, Train_accy 92.34:  15%|█▌        | 3/20 [01:48<10:13, 36.11s/it]Task 1, Epoch 4/20 => Loss 0.196, Train_accy 92.42:  15%|█▌        | 3/20 [02:24<10:13, 36.11s/it]Task 1, Epoch 4/20 => Loss 0.196, Train_accy 92.42:  20%|██        | 4/20 [02:24<09:37, 36.11s/it]Task 1, Epoch 5/20 => Loss 0.184, Train_accy 92.86, Test_accy 90.07:  20%|██        | 4/20 [03:29<09:37, 36.11s/it]Task 1, Epoch 5/20 => Loss 0.184, Train_accy 92.86, Test_accy 90.07:  25%|██▌       | 5/20 [03:29<11:37, 46.52s/it]Task 1, Epoch 6/20 => Loss 0.148, Train_accy 94.30:  25%|██▌       | 5/20 [04:05<11:37, 46.52s/it]                 Task 1, Epoch 6/20 => Loss 0.148, Train_accy 94.30:  30%|███       | 6/20 [04:05<10:01, 42.98s/it]Task 1, Epoch 7/20 => Loss 0.154, Train_accy 93.70:  30%|███       | 6/20 [04:41<10:01, 42.98s/it]Task 1, Epoch 7/20 => Loss 0.154, Train_accy 93.70:  35%|███▌      | 7/20 [04:41<08:49, 40.75s/it]Task 1, Epoch 8/20 => Loss 0.157, Train_accy 93.32:  35%|███▌      | 7/20 [05:17<08:49, 40.75s/it]Task 1, Epoch 8/20 => Loss 0.157, Train_accy 93.32:  40%|████      | 8/20 [05:17<07:51, 39.28s/it]Task 1, Epoch 9/20 => Loss 0.155, Train_accy 93.58:  40%|████      | 8/20 [05:54<07:51, 39.28s/it]Task 1, Epoch 9/20 => Loss 0.155, Train_accy 93.58:  45%|████▌     | 9/20 [05:54<07:01, 38.35s/it]Task 1, Epoch 10/20 => Loss 0.155, Train_accy 93.68, Test_accy 90.75:  45%|████▌     | 9/20 [06:59<07:01, 38.35s/it]Task 1, Epoch 10/20 => Loss 0.155, Train_accy 93.68, Test_accy 90.75:  50%|█████     | 10/20 [06:59<07:46, 46.66s/it]Task 1, Epoch 11/20 => Loss 0.134, Train_accy 93.72:  50%|█████     | 10/20 [07:35<07:46, 46.66s/it]                 Task 1, Epoch 11/20 => Loss 0.134, Train_accy 93.72:  55%|█████▌    | 11/20 [07:35<06:31, 43.45s/it]Task 1, Epoch 12/20 => Loss 0.117, Train_accy 94.32:  55%|█████▌    | 11/20 [08:11<06:31, 43.45s/it]Task 1, Epoch 12/20 => Loss 0.117, Train_accy 94.32:  60%|██████    | 12/20 [08:11<05:29, 41.23s/it]Task 1, Epoch 13/20 => Loss 0.137, Train_accy 93.62:  60%|██████    | 12/20 [08:47<05:29, 41.23s/it]Task 1, Epoch 13/20 => Loss 0.137, Train_accy 93.62:  65%|██████▌   | 13/20 [08:47<04:37, 39.68s/it]Task 1, Epoch 14/20 => Loss 0.135, Train_accy 93.52:  65%|██████▌   | 13/20 [09:24<04:37, 39.68s/it]Task 1, Epoch 14/20 => Loss 0.135, Train_accy 93.52:  70%|███████   | 14/20 [09:24<03:51, 38.63s/it]Task 1, Epoch 15/20 => Loss 0.138, Train_accy 93.84, Test_accy 90.72:  70%|███████   | 14/20 [10:29<03:51, 38.63s/it]Task 1, Epoch 15/20 => Loss 0.138, Train_accy 93.84, Test_accy 90.72:  75%|███████▌  | 15/20 [10:29<03:52, 46.57s/it]Task 1, Epoch 16/20 => Loss 0.129, Train_accy 93.80:  75%|███████▌  | 15/20 [11:05<03:52, 46.57s/it]                 Task 1, Epoch 16/20 => Loss 0.129, Train_accy 93.80:  80%|████████  | 16/20 [11:05<02:53, 43.45s/it]Task 1, Epoch 17/20 => Loss 0.127, Train_accy 93.78:  80%|████████  | 16/20 [11:41<02:53, 43.45s/it]Task 1, Epoch 17/20 => Loss 0.127, Train_accy 93.78:  85%|████████▌ | 17/20 [11:41<02:03, 41.26s/it]Task 1, Epoch 18/20 => Loss 0.135, Train_accy 93.76:  85%|████████▌ | 17/20 [12:17<02:03, 41.26s/it]Task 1, Epoch 18/20 => Loss 0.135, Train_accy 93.76:  90%|█████████ | 18/20 [12:17<01:19, 39.75s/it]Task 1, Epoch 19/20 => Loss 0.147, Train_accy 93.42:  90%|█████████ | 18/20 [12:53<01:19, 39.75s/it]Task 1, Epoch 19/20 => Loss 0.147, Train_accy 93.42:  95%|█████████▌| 19/20 [12:53<00:38, 38.65s/it]Task 1, Epoch 20/20 => Loss 0.139, Train_accy 93.44, Test_accy 91.42:  95%|█████████▌| 19/20 [13:58<00:38, 38.65s/it]Task 1, Epoch 20/20 => Loss 0.139, Train_accy 93.44, Test_accy 91.42: 100%|██████████| 20/20 [13:58<00:00, 46.58s/it]Task 1, Epoch 20/20 => Loss 0.139, Train_accy 93.44, Test_accy 91.42: 100%|██████████| 20/20 [13:58<00:00, 41.94s/it]
2024-04-29 05:01:00,555 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.139, Train_accy 93.44, Test_accy 91.42
2024-04-29 05:01:29,451 [trainer.py] => No NME accuracy.
2024-04-29 05:01:29,452 [trainer.py] => CNN: {'total': 91.42, '00-49': 93.48, '50-59': 81.1, 'old': 93.48, 'new': 81.1}
2024-04-29 05:01:29,452 [trainer.py] => CNN top1 curve: [93.92, 91.42]
2024-04-29 05:01:29,452 [trainer.py] => CNN top5 curve: [99.16, 98.87]

Average Accuracy (CNN): 92.67
2024-04-29 05:01:29,452 [trainer.py] => Average Accuracy (CNN): 92.67 

2024-04-29 05:01:29,453 [trainer.py] => Train Time: 9031.58
2024-04-29 05:01:29,453 [trainer.py] => Test Time: 52.989999999999995 

2024-04-29 05:01:29,455 [trainer.py] => All params: 172004552
2024-04-29 05:01:29,457 [trainer.py] => Trainable params: 330340
2024-04-29 05:01:29,457 [dualprompt.py] => Learning on 60-70
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.397, Train_accy 88.20:   0%|          | 0/20 [00:36<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.397, Train_accy 88.20:   5%|▌         | 1/20 [00:36<11:30, 36.37s/it]Task 2, Epoch 2/20 => Loss 0.172, Train_accy 94.26:   5%|▌         | 1/20 [01:12<11:30, 36.37s/it]Task 2, Epoch 2/20 => Loss 0.172, Train_accy 94.26:  10%|█         | 2/20 [01:12<10:52, 36.27s/it]Task 2, Epoch 3/20 => Loss 0.156, Train_accy 94.44:  10%|█         | 2/20 [01:48<10:52, 36.27s/it]Task 2, Epoch 3/20 => Loss 0.156, Train_accy 94.44:  15%|█▌        | 3/20 [01:48<10:15, 36.23s/it]Task 2, Epoch 4/20 => Loss 0.143, Train_accy 94.60:  15%|█▌        | 3/20 [02:24<10:15, 36.23s/it]Task 2, Epoch 4/20 => Loss 0.143, Train_accy 94.60:  20%|██        | 4/20 [02:24<09:38, 36.18s/it]Task 2, Epoch 5/20 => Loss 0.120, Train_accy 95.22, Test_accy 88.31:  20%|██        | 4/20 [03:34<09:38, 36.18s/it]Task 2, Epoch 5/20 => Loss 0.120, Train_accy 95.22, Test_accy 88.31:  25%|██▌       | 5/20 [03:34<12:04, 48.30s/it]Task 2, Epoch 6/20 => Loss 0.122, Train_accy 95.10:  25%|██▌       | 5/20 [04:10<12:04, 48.30s/it]                 Task 2, Epoch 6/20 => Loss 0.122, Train_accy 95.10:  30%|███       | 6/20 [04:10<10:19, 44.23s/it]Task 2, Epoch 7/20 => Loss 0.125, Train_accy 94.48:  30%|███       | 6/20 [04:47<10:19, 44.23s/it]Task 2, Epoch 7/20 => Loss 0.125, Train_accy 94.48:  35%|███▌      | 7/20 [04:47<09:01, 41.64s/it]Task 2, Epoch 8/20 => Loss 0.105, Train_accy 95.44:  35%|███▌      | 7/20 [05:23<09:01, 41.64s/it]Task 2, Epoch 8/20 => Loss 0.105, Train_accy 95.44:  40%|████      | 8/20 [05:23<07:59, 39.93s/it]Task 2, Epoch 9/20 => Loss 0.117, Train_accy 94.88:  40%|████      | 8/20 [05:59<07:59, 39.93s/it]Task 2, Epoch 9/20 => Loss 0.117, Train_accy 94.88:  45%|████▌     | 9/20 [05:59<07:06, 38.74s/it]Task 2, Epoch 10/20 => Loss 0.079, Train_accy 95.84, Test_accy 89.06:  45%|████▌     | 9/20 [07:09<07:06, 38.74s/it]Task 2, Epoch 10/20 => Loss 0.079, Train_accy 95.84, Test_accy 89.06:  50%|█████     | 10/20 [07:09<08:03, 48.31s/it]Task 2, Epoch 11/20 => Loss 0.090, Train_accy 95.56:  50%|█████     | 10/20 [07:45<08:03, 48.31s/it]                 Task 2, Epoch 11/20 => Loss 0.090, Train_accy 95.56:  55%|█████▌    | 11/20 [07:45<06:41, 44.62s/it]Task 2, Epoch 12/20 => Loss 0.097, Train_accy 95.00:  55%|█████▌    | 11/20 [08:21<06:41, 44.62s/it]Task 2, Epoch 12/20 => Loss 0.097, Train_accy 95.00:  60%|██████    | 12/20 [08:21<05:36, 42.04s/it]Task 2, Epoch 13/20 => Loss 0.076, Train_accy 95.92:  60%|██████    | 12/20 [08:58<05:36, 42.04s/it]Task 2, Epoch 13/20 => Loss 0.076, Train_accy 95.92:  65%|██████▌   | 13/20 [08:58<04:42, 40.29s/it]Task 2, Epoch 14/20 => Loss 0.103, Train_accy 94.72:  65%|██████▌   | 13/20 [09:34<04:42, 40.29s/it]Task 2, Epoch 14/20 => Loss 0.103, Train_accy 94.72:  70%|███████   | 14/20 [09:34<03:54, 39.04s/it]Task 2, Epoch 15/20 => Loss 0.095, Train_accy 95.16, Test_accy 89.57:  70%|███████   | 14/20 [10:43<03:54, 39.04s/it]Task 2, Epoch 15/20 => Loss 0.095, Train_accy 95.16, Test_accy 89.57:  75%|███████▌  | 15/20 [10:43<04:01, 48.29s/it]Task 2, Epoch 16/20 => Loss 0.086, Train_accy 95.14:  75%|███████▌  | 15/20 [11:20<04:01, 48.29s/it]                 Task 2, Epoch 16/20 => Loss 0.086, Train_accy 95.14:  80%|████████  | 16/20 [11:20<02:58, 44.63s/it]Task 2, Epoch 17/20 => Loss 0.079, Train_accy 95.42:  80%|████████  | 16/20 [11:56<02:58, 44.63s/it]Task 2, Epoch 17/20 => Loss 0.079, Train_accy 95.42:  85%|████████▌ | 17/20 [11:56<02:06, 42.08s/it]Task 2, Epoch 18/20 => Loss 0.083, Train_accy 95.68:  85%|████████▌ | 17/20 [12:32<02:06, 42.08s/it]Task 2, Epoch 18/20 => Loss 0.083, Train_accy 95.68:  90%|█████████ | 18/20 [12:32<01:20, 40.30s/it]Task 2, Epoch 19/20 => Loss 0.088, Train_accy 95.60:  90%|█████████ | 18/20 [13:08<01:20, 40.30s/it]Task 2, Epoch 19/20 => Loss 0.088, Train_accy 95.60:  95%|█████████▌| 19/20 [13:08<00:39, 39.04s/it]Task 2, Epoch 20/20 => Loss 0.087, Train_accy 95.02, Test_accy 89.84:  95%|█████████▌| 19/20 [14:18<00:39, 39.04s/it]Task 2, Epoch 20/20 => Loss 0.087, Train_accy 95.02, Test_accy 89.84: 100%|██████████| 20/20 [14:18<00:00, 48.25s/it]Task 2, Epoch 20/20 => Loss 0.087, Train_accy 95.02, Test_accy 89.84: 100%|██████████| 20/20 [14:18<00:00, 42.91s/it]
2024-04-29 05:15:47,685 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.087, Train_accy 95.02, Test_accy 89.84
2024-04-29 05:16:21,486 [trainer.py] => No NME accuracy.
2024-04-29 05:16:21,487 [trainer.py] => CNN: {'total': 89.84, '00-49': 93.42, '50-59': 77.9, '60-69': 83.9, 'old': 90.83, 'new': 83.9}
2024-04-29 05:16:21,487 [trainer.py] => CNN top1 curve: [93.92, 91.42, 89.84]
2024-04-29 05:16:21,487 [trainer.py] => CNN top5 curve: [99.16, 98.87, 98.71]

Average Accuracy (CNN): 91.73
2024-04-29 05:16:21,487 [trainer.py] => Average Accuracy (CNN): 91.73 

2024-04-29 05:16:21,488 [trainer.py] => Train Time: 10747.970000000001
2024-04-29 05:16:21,488 [trainer.py] => Test Time: 86.78999999999999 

2024-04-29 05:16:21,490 [trainer.py] => All params: 172004552
2024-04-29 05:16:21,491 [trainer.py] => Trainable params: 330340
2024-04-29 05:16:21,492 [dualprompt.py] => Learning on 70-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.456, Train_accy 86.08:   0%|          | 0/20 [00:36<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.456, Train_accy 86.08:   5%|▌         | 1/20 [00:36<11:27, 36.20s/it]Task 3, Epoch 2/20 => Loss 0.220, Train_accy 92.26:   5%|▌         | 1/20 [01:12<11:27, 36.20s/it]Task 3, Epoch 2/20 => Loss 0.220, Train_accy 92.26:  10%|█         | 2/20 [01:12<10:50, 36.16s/it]Task 3, Epoch 3/20 => Loss 0.219, Train_accy 92.26:  10%|█         | 2/20 [01:48<10:50, 36.16s/it]Task 3, Epoch 3/20 => Loss 0.219, Train_accy 92.26:  15%|█▌        | 3/20 [01:48<10:15, 36.18s/it]Task 3, Epoch 4/20 => Loss 0.180, Train_accy 93.26:  15%|█▌        | 3/20 [02:24<10:15, 36.18s/it]Task 3, Epoch 4/20 => Loss 0.180, Train_accy 93.26:  20%|██        | 4/20 [02:24<09:39, 36.19s/it]Task 3, Epoch 5/20 => Loss 0.162, Train_accy 93.34, Test_accy 83.61:  20%|██        | 4/20 [03:39<09:39, 36.19s/it]Task 3, Epoch 5/20 => Loss 0.162, Train_accy 93.34, Test_accy 83.61:  25%|██▌       | 5/20 [03:39<12:29, 49.94s/it]Task 3, Epoch 6/20 => Loss 0.168, Train_accy 93.24:  25%|██▌       | 5/20 [04:15<12:29, 49.94s/it]                 Task 3, Epoch 6/20 => Loss 0.168, Train_accy 93.24:  30%|███       | 6/20 [04:15<10:33, 45.25s/it]Task 3, Epoch 7/20 => Loss 0.151, Train_accy 93.22:  30%|███       | 6/20 [04:51<10:33, 45.25s/it]Task 3, Epoch 7/20 => Loss 0.151, Train_accy 93.22:  35%|███▌      | 7/20 [04:51<09:09, 42.29s/it]Task 3, Epoch 8/20 => Loss 0.130, Train_accy 94.26:  35%|███▌      | 7/20 [05:27<09:09, 42.29s/it]Task 3, Epoch 8/20 => Loss 0.130, Train_accy 94.26:  40%|████      | 8/20 [05:27<08:04, 40.34s/it]Task 3, Epoch 9/20 => Loss 0.138, Train_accy 93.92:  40%|████      | 8/20 [06:03<08:04, 40.34s/it]Task 3, Epoch 9/20 => Loss 0.138, Train_accy 93.92:  45%|████▌     | 9/20 [06:03<07:09, 39.03s/it]Task 3, Epoch 10/20 => Loss 0.129, Train_accy 93.98, Test_accy 84.98:  45%|████▌     | 9/20 [07:18<07:09, 39.03s/it]Task 3, Epoch 10/20 => Loss 0.129, Train_accy 93.98, Test_accy 84.98:  50%|█████     | 10/20 [07:18<08:19, 49.96s/it]Task 3, Epoch 11/20 => Loss 0.129, Train_accy 94.24:  50%|█████     | 10/20 [07:54<08:19, 49.96s/it]                 Task 3, Epoch 11/20 => Loss 0.129, Train_accy 94.24:  55%|█████▌    | 11/20 [07:54<06:51, 45.74s/it]Task 3, Epoch 12/20 => Loss 0.124, Train_accy 94.06:  55%|█████▌    | 11/20 [08:30<06:51, 45.74s/it]Task 3, Epoch 12/20 => Loss 0.124, Train_accy 94.06:  60%|██████    | 12/20 [08:30<05:42, 42.79s/it]Task 3, Epoch 13/20 => Loss 0.122, Train_accy 94.34:  60%|██████    | 12/20 [09:06<05:42, 42.79s/it]Task 3, Epoch 13/20 => Loss 0.122, Train_accy 94.34:  65%|██████▌   | 13/20 [09:06<04:45, 40.77s/it]Task 3, Epoch 14/20 => Loss 0.127, Train_accy 94.26:  65%|██████▌   | 13/20 [09:42<04:45, 40.77s/it]Task 3, Epoch 14/20 => Loss 0.127, Train_accy 94.26:  70%|███████   | 14/20 [09:42<03:56, 39.40s/it]Task 3, Epoch 15/20 => Loss 0.120, Train_accy 94.16, Test_accy 85.66:  70%|███████   | 14/20 [10:57<03:56, 39.40s/it]Task 3, Epoch 15/20 => Loss 0.120, Train_accy 94.16, Test_accy 85.66:  75%|███████▌  | 15/20 [10:57<04:09, 50.00s/it]Task 3, Epoch 16/20 => Loss 0.120, Train_accy 94.00:  75%|███████▌  | 15/20 [11:33<04:09, 50.00s/it]                 Task 3, Epoch 16/20 => Loss 0.120, Train_accy 94.00:  80%|████████  | 16/20 [11:33<03:03, 45.83s/it]Task 3, Epoch 17/20 => Loss 0.123, Train_accy 94.04:  80%|████████  | 16/20 [12:09<03:03, 45.83s/it]Task 3, Epoch 17/20 => Loss 0.123, Train_accy 94.04:  85%|████████▌ | 17/20 [12:09<02:08, 42.92s/it]Task 3, Epoch 18/20 => Loss 0.109, Train_accy 94.52:  85%|████████▌ | 17/20 [12:45<02:08, 42.92s/it]Task 3, Epoch 18/20 => Loss 0.109, Train_accy 94.52:  90%|█████████ | 18/20 [12:45<01:21, 40.88s/it]Task 3, Epoch 19/20 => Loss 0.117, Train_accy 94.24:  90%|█████████ | 18/20 [13:21<01:21, 40.88s/it]Task 3, Epoch 19/20 => Loss 0.117, Train_accy 94.24:  95%|█████████▌| 19/20 [13:21<00:39, 39.48s/it]Task 3, Epoch 20/20 => Loss 0.114, Train_accy 94.40, Test_accy 86.01:  95%|█████████▌| 19/20 [14:36<00:39, 39.48s/it]Task 3, Epoch 20/20 => Loss 0.114, Train_accy 94.40, Test_accy 86.01: 100%|██████████| 20/20 [14:36<00:00, 50.04s/it]Task 3, Epoch 20/20 => Loss 0.114, Train_accy 94.40, Test_accy 86.01: 100%|██████████| 20/20 [14:36<00:00, 43.83s/it]
2024-04-29 05:30:58,115 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.114, Train_accy 94.40, Test_accy 86.01
2024-04-29 05:31:36,350 [trainer.py] => No NME accuracy.
2024-04-29 05:31:36,350 [trainer.py] => CNN: {'total': 86.01, '00-49': 93.26, '50-59': 76.6, '60-69': 82.7, '70-79': 62.5, 'old': 89.37, 'new': 62.5}
2024-04-29 05:31:36,350 [trainer.py] => CNN top1 curve: [93.92, 91.42, 89.84, 86.01]
2024-04-29 05:31:36,351 [trainer.py] => CNN top5 curve: [99.16, 98.87, 98.71, 98.38]

Average Accuracy (CNN): 90.3
2024-04-29 05:31:36,351 [trainer.py] => Average Accuracy (CNN): 90.3 

2024-04-29 05:31:36,351 [trainer.py] => Train Time: 12501.12
2024-04-29 05:31:36,351 [trainer.py] => Test Time: 125.01999999999998 

2024-04-29 05:31:36,354 [trainer.py] => All params: 172004552
2024-04-29 05:31:36,355 [trainer.py] => Trainable params: 330340
2024-04-29 05:31:36,355 [dualprompt.py] => Learning on 80-90
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.436, Train_accy 86.64:   0%|          | 0/20 [00:36<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.436, Train_accy 86.64:   5%|▌         | 1/20 [00:36<11:26, 36.14s/it]Task 4, Epoch 2/20 => Loss 0.224, Train_accy 92.28:   5%|▌         | 1/20 [01:12<11:26, 36.14s/it]Task 4, Epoch 2/20 => Loss 0.224, Train_accy 92.28:  10%|█         | 2/20 [01:12<10:50, 36.14s/it]Task 4, Epoch 3/20 => Loss 0.178, Train_accy 93.58:  10%|█         | 2/20 [01:48<10:50, 36.14s/it]Task 4, Epoch 3/20 => Loss 0.178, Train_accy 93.58:  15%|█▌        | 3/20 [01:48<10:14, 36.12s/it]Task 4, Epoch 4/20 => Loss 0.168, Train_accy 93.72:  15%|█▌        | 3/20 [02:24<10:14, 36.12s/it]Task 4, Epoch 4/20 => Loss 0.168, Train_accy 93.72:  20%|██        | 4/20 [02:24<09:37, 36.12s/it]Task 4, Epoch 5/20 => Loss 0.142, Train_accy 94.16, Test_accy 80.27:  20%|██        | 4/20 [03:43<09:37, 36.12s/it]Task 4, Epoch 5/20 => Loss 0.142, Train_accy 94.16, Test_accy 80.27:  25%|██▌       | 5/20 [03:43<12:54, 51.63s/it]Task 4, Epoch 6/20 => Loss 0.165, Train_accy 93.42:  25%|██▌       | 5/20 [04:19<12:54, 51.63s/it]                 Task 4, Epoch 6/20 => Loss 0.165, Train_accy 93.42:  30%|███       | 6/20 [04:19<10:48, 46.35s/it]Task 4, Epoch 7/20 => Loss 0.151, Train_accy 93.82:  30%|███       | 6/20 [04:55<10:48, 46.35s/it]Task 4, Epoch 7/20 => Loss 0.151, Train_accy 93.82:  35%|███▌      | 7/20 [04:55<09:19, 43.01s/it]Task 4, Epoch 8/20 => Loss 0.129, Train_accy 94.18:  35%|███▌      | 7/20 [05:32<09:19, 43.01s/it]Task 4, Epoch 8/20 => Loss 0.129, Train_accy 94.18:  40%|████      | 8/20 [05:32<08:10, 40.84s/it]Task 4, Epoch 9/20 => Loss 0.128, Train_accy 94.38:  40%|████      | 8/20 [06:08<08:10, 40.84s/it]Task 4, Epoch 9/20 => Loss 0.128, Train_accy 94.38:  45%|████▌     | 9/20 [06:08<07:13, 39.40s/it]Task 4, Epoch 10/20 => Loss 0.129, Train_accy 93.84, Test_accy 81.61:  45%|████▌     | 9/20 [07:27<07:13, 39.40s/it]Task 4, Epoch 10/20 => Loss 0.129, Train_accy 93.84, Test_accy 81.61:  50%|█████     | 10/20 [07:27<08:36, 51.66s/it]Task 4, Epoch 11/20 => Loss 0.128, Train_accy 94.10:  50%|█████     | 10/20 [08:03<08:36, 51.66s/it]                 Task 4, Epoch 11/20 => Loss 0.128, Train_accy 94.10:  55%|█████▌    | 11/20 [08:03<07:02, 46.90s/it]Task 4, Epoch 12/20 => Loss 0.114, Train_accy 94.18:  55%|█████▌    | 11/20 [08:39<07:02, 46.90s/it]Task 4, Epoch 12/20 => Loss 0.114, Train_accy 94.18:  60%|██████    | 12/20 [08:39<05:49, 43.63s/it]Task 4, Epoch 13/20 => Loss 0.116, Train_accy 94.68:  60%|██████    | 12/20 [09:15<05:49, 43.63s/it]Task 4, Epoch 13/20 => Loss 0.116, Train_accy 94.68:  65%|██████▌   | 13/20 [09:15<04:49, 41.39s/it]Task 4, Epoch 14/20 => Loss 0.118, Train_accy 94.48:  65%|██████▌   | 13/20 [09:52<04:49, 41.39s/it]Task 4, Epoch 14/20 => Loss 0.118, Train_accy 94.48:  70%|███████   | 14/20 [09:52<03:58, 39.82s/it]Task 4, Epoch 15/20 => Loss 0.120, Train_accy 94.46, Test_accy 82.01:  70%|███████   | 14/20 [11:11<03:58, 39.82s/it]Task 4, Epoch 15/20 => Loss 0.120, Train_accy 94.46, Test_accy 82.01:  75%|███████▌  | 15/20 [11:11<04:18, 51.65s/it]Task 4, Epoch 16/20 => Loss 0.116, Train_accy 94.58:  75%|███████▌  | 15/20 [11:47<04:18, 51.65s/it]                 Task 4, Epoch 16/20 => Loss 0.116, Train_accy 94.58:  80%|████████  | 16/20 [11:47<03:07, 46.98s/it]Task 4, Epoch 17/20 => Loss 0.108, Train_accy 94.70:  80%|████████  | 16/20 [12:23<03:07, 46.98s/it]Task 4, Epoch 17/20 => Loss 0.108, Train_accy 94.70:  85%|████████▌ | 17/20 [12:23<02:11, 43.73s/it]Task 4, Epoch 18/20 => Loss 0.098, Train_accy 95.34:  85%|████████▌ | 17/20 [12:59<02:11, 43.73s/it]Task 4, Epoch 18/20 => Loss 0.098, Train_accy 95.34:  90%|█████████ | 18/20 [12:59<01:22, 41.46s/it]Task 4, Epoch 19/20 => Loss 0.121, Train_accy 94.32:  90%|█████████ | 18/20 [13:35<01:22, 41.46s/it]Task 4, Epoch 19/20 => Loss 0.121, Train_accy 94.32:  95%|█████████▌| 19/20 [13:35<00:39, 39.84s/it]Task 4, Epoch 20/20 => Loss 0.128, Train_accy 93.86, Test_accy 82.63:  95%|█████████▌| 19/20 [14:54<00:39, 39.84s/it]Task 4, Epoch 20/20 => Loss 0.128, Train_accy 93.86, Test_accy 82.63: 100%|██████████| 20/20 [14:54<00:00, 51.66s/it]Task 4, Epoch 20/20 => Loss 0.128, Train_accy 93.86, Test_accy 82.63: 100%|██████████| 20/20 [14:54<00:00, 44.75s/it]
2024-04-29 05:46:31,305 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.128, Train_accy 93.86, Test_accy 82.63
2024-04-29 05:47:14,371 [trainer.py] => No NME accuracy.
2024-04-29 05:47:14,371 [trainer.py] => CNN: {'total': 82.63, '00-49': 93.44, '50-59': 75.4, '60-69': 82.4, '70-79': 60.8, '80-89': 57.9, 'old': 85.72, 'new': 57.9}
2024-04-29 05:47:14,372 [trainer.py] => CNN top1 curve: [93.92, 91.42, 89.84, 86.01, 82.63]
2024-04-29 05:47:14,372 [trainer.py] => CNN top5 curve: [99.16, 98.87, 98.71, 98.38, 97.91]

Average Accuracy (CNN): 88.76
2024-04-29 05:47:14,372 [trainer.py] => Average Accuracy (CNN): 88.76 

2024-04-29 05:47:14,372 [trainer.py] => Train Time: 14290.93
2024-04-29 05:47:14,372 [trainer.py] => Test Time: 168.07999999999998 

2024-04-29 05:47:14,375 [trainer.py] => All params: 172004552
2024-04-29 05:47:14,377 [trainer.py] => Trainable params: 330340
2024-04-29 05:47:14,377 [dualprompt.py] => Learning on 90-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.475, Train_accy 85.14:   0%|          | 0/20 [00:36<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.475, Train_accy 85.14:   5%|▌         | 1/20 [00:36<11:26, 36.13s/it]Task 5, Epoch 2/20 => Loss 0.236, Train_accy 91.58:   5%|▌         | 1/20 [01:12<11:26, 36.13s/it]Task 5, Epoch 2/20 => Loss 0.236, Train_accy 91.58:  10%|█         | 2/20 [01:12<10:49, 36.09s/it]Task 5, Epoch 3/20 => Loss 0.212, Train_accy 92.36:  10%|█         | 2/20 [01:48<10:49, 36.09s/it]Task 5, Epoch 3/20 => Loss 0.212, Train_accy 92.36:  15%|█▌        | 3/20 [01:48<10:14, 36.14s/it]Task 5, Epoch 4/20 => Loss 0.207, Train_accy 92.40:  15%|█▌        | 3/20 [02:24<10:14, 36.14s/it]Task 5, Epoch 4/20 => Loss 0.207, Train_accy 92.40:  20%|██        | 4/20 [02:24<09:38, 36.14s/it]Task 5, Epoch 5/20 => Loss 0.185, Train_accy 92.88, Test_accy 78.47:  20%|██        | 4/20 [03:48<09:38, 36.14s/it]Task 5, Epoch 5/20 => Loss 0.185, Train_accy 92.88, Test_accy 78.47:  25%|██▌       | 5/20 [03:48<13:20, 53.34s/it]Task 5, Epoch 6/20 => Loss 0.171, Train_accy 93.14:  25%|██▌       | 5/20 [04:24<13:20, 53.34s/it]                 Task 5, Epoch 6/20 => Loss 0.171, Train_accy 93.14:  30%|███       | 6/20 [04:24<11:04, 47.49s/it]Task 5, Epoch 7/20 => Loss 0.166, Train_accy 93.48:  30%|███       | 6/20 [05:00<11:04, 47.49s/it]Task 5, Epoch 7/20 => Loss 0.166, Train_accy 93.48:  35%|███▌      | 7/20 [05:00<09:29, 43.79s/it]Task 5, Epoch 8/20 => Loss 0.159, Train_accy 93.52:  35%|███▌      | 7/20 [05:36<09:29, 43.79s/it]Task 5, Epoch 8/20 => Loss 0.159, Train_accy 93.52:  40%|████      | 8/20 [05:36<08:16, 41.36s/it]Task 5, Epoch 9/20 => Loss 0.166, Train_accy 92.60:  40%|████      | 8/20 [06:12<08:16, 41.36s/it]Task 5, Epoch 9/20 => Loss 0.166, Train_accy 92.60:  45%|████▌     | 9/20 [06:12<07:16, 39.71s/it]Task 5, Epoch 10/20 => Loss 0.145, Train_accy 93.46, Test_accy 79.66:  45%|████▌     | 9/20 [07:37<07:16, 39.71s/it]Task 5, Epoch 10/20 => Loss 0.145, Train_accy 93.46, Test_accy 79.66:  50%|█████     | 10/20 [07:37<08:54, 53.41s/it]Task 5, Epoch 11/20 => Loss 0.140, Train_accy 93.90:  50%|█████     | 10/20 [08:13<08:54, 53.41s/it]                 Task 5, Epoch 11/20 => Loss 0.140, Train_accy 93.90:  55%|█████▌    | 11/20 [08:13<07:13, 48.11s/it]Task 5, Epoch 12/20 => Loss 0.133, Train_accy 94.02:  55%|█████▌    | 11/20 [08:49<07:13, 48.11s/it]Task 5, Epoch 12/20 => Loss 0.133, Train_accy 94.02:  60%|██████    | 12/20 [08:49<05:56, 44.51s/it]Task 5, Epoch 13/20 => Loss 0.135, Train_accy 93.64:  60%|██████    | 12/20 [09:25<05:56, 44.51s/it]Task 5, Epoch 13/20 => Loss 0.135, Train_accy 93.64:  65%|██████▌   | 13/20 [09:25<04:53, 41.95s/it]Task 5, Epoch 14/20 => Loss 0.128, Train_accy 94.00:  65%|██████▌   | 13/20 [10:01<04:53, 41.95s/it]Task 5, Epoch 14/20 => Loss 0.128, Train_accy 94.00:  70%|███████   | 14/20 [10:01<04:01, 40.20s/it]Task 5, Epoch 15/20 => Loss 0.152, Train_accy 93.34, Test_accy 80.25:  70%|███████   | 14/20 [11:25<04:01, 40.20s/it]Task 5, Epoch 15/20 => Loss 0.152, Train_accy 93.34, Test_accy 80.25:  75%|███████▌  | 15/20 [11:25<04:27, 53.40s/it]Task 5, Epoch 16/20 => Loss 0.125, Train_accy 94.32:  75%|███████▌  | 15/20 [12:01<04:27, 53.40s/it]                 Task 5, Epoch 16/20 => Loss 0.125, Train_accy 94.32:  80%|████████  | 16/20 [12:01<03:13, 48.26s/it]Task 5, Epoch 17/20 => Loss 0.111, Train_accy 94.40:  80%|████████  | 16/20 [12:38<03:13, 48.26s/it]Task 5, Epoch 17/20 => Loss 0.111, Train_accy 94.40:  85%|████████▌ | 17/20 [12:38<02:13, 44.64s/it]Task 5, Epoch 18/20 => Loss 0.134, Train_accy 93.90:  85%|████████▌ | 17/20 [13:14<02:13, 44.64s/it]Task 5, Epoch 18/20 => Loss 0.134, Train_accy 93.90:  90%|█████████ | 18/20 [13:14<01:24, 42.12s/it]Task 5, Epoch 19/20 => Loss 0.112, Train_accy 94.38:  90%|█████████ | 18/20 [13:50<01:24, 42.12s/it]Task 5, Epoch 19/20 => Loss 0.112, Train_accy 94.38:  95%|█████████▌| 19/20 [13:50<00:40, 40.32s/it]Task 5, Epoch 20/20 => Loss 0.122, Train_accy 94.00, Test_accy 80.49:  95%|█████████▌| 19/20 [15:14<00:40, 40.32s/it]Task 5, Epoch 20/20 => Loss 0.122, Train_accy 94.00, Test_accy 80.49: 100%|██████████| 20/20 [15:14<00:00, 53.42s/it]Task 5, Epoch 20/20 => Loss 0.122, Train_accy 94.00, Test_accy 80.49: 100%|██████████| 20/20 [15:14<00:00, 45.72s/it]
2024-04-29 06:02:28,895 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.122, Train_accy 94.00, Test_accy 80.49
2024-04-29 06:03:16,726 [trainer.py] => No NME accuracy.
2024-04-29 06:03:16,727 [trainer.py] => CNN: {'total': 80.49, '00-49': 93.32, '50-59': 75.2, '60-69': 81.9, '70-79': 61.3, '80-89': 57.4, '90-99': 62.5, 'old': 82.49, 'new': 62.5}
2024-04-29 06:03:16,727 [trainer.py] => CNN top1 curve: [93.92, 91.42, 89.84, 86.01, 82.63, 80.49]
2024-04-29 06:03:16,727 [trainer.py] => CNN top5 curve: [99.16, 98.87, 98.71, 98.38, 97.91, 97.33]

Average Accuracy (CNN): 87.38
2024-04-29 06:03:16,727 [trainer.py] => Average Accuracy (CNN): 87.38 

2024-04-29 06:03:16,727 [trainer.py] => Train Time: 16119.88
2024-04-29 06:03:16,727 [trainer.py] => Test Time: 215.90999999999997 

Accuracy Matrix (CNN):
[[93.92 93.48 93.42 93.26 93.44 93.32]
 [ 0.   81.1  77.9  76.6  75.4  75.2 ]
 [ 0.    0.   83.9  82.7  82.4  81.9 ]
 [ 0.    0.    0.   62.5  60.8  61.3 ]
 [ 0.    0.    0.    0.   57.9  57.4 ]
 [ 0.    0.    0.    0.    0.   62.5 ]]
2024-04-29 06:03:16,729 [trainer.py] => Forgetting (CNN): 2.0400000000000005
2024-04-29 06:03:19,371 [trainer.py] => config: ./exps/coda_prompt_cifar_B50_Inc5.json
2024-04-29 06:03:19,371 [trainer.py] => prefix:  
2024-04-29 06:03:19,371 [trainer.py] => dataset: cifar224
2024-04-29 06:03:19,371 [trainer.py] => memory_size: 0
2024-04-29 06:03:19,371 [trainer.py] => memory_per_class: 0
2024-04-29 06:03:19,371 [trainer.py] => fixed_memory: False
2024-04-29 06:03:19,371 [trainer.py] => shuffle: False
2024-04-29 06:03:19,371 [trainer.py] => init_cls: 50
2024-04-29 06:03:19,371 [trainer.py] => increment: 10
2024-04-29 06:03:19,371 [trainer.py] => model_name: coda_prompt
2024-04-29 06:03:19,372 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-04-29 06:03:19,372 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-29 06:03:19,372 [trainer.py] => seed: 1993
2024-04-29 06:03:19,372 [trainer.py] => tuned_epoch: 20
2024-04-29 06:03:19,372 [trainer.py] => init_lr: 0.001
2024-04-29 06:03:19,372 [trainer.py] => batch_size: 48
2024-04-29 06:03:19,372 [trainer.py] => weight_decay: 0
2024-04-29 06:03:19,372 [trainer.py] => min_lr: 1e-05
2024-04-29 06:03:19,372 [trainer.py] => optimizer: adam
2024-04-29 06:03:19,372 [trainer.py] => scheduler: cosine
2024-04-29 06:03:19,372 [trainer.py] => reinit_optimizer: True
2024-04-29 06:03:19,372 [trainer.py] => pretrained: True
2024-04-29 06:03:19,372 [trainer.py] => drop: 0.0
2024-04-29 06:03:19,372 [trainer.py] => drop_path: 0.0
2024-04-29 06:03:19,372 [trainer.py] => prompt_param: [100, 8.0, 0.0]
Files already downloaded and verified
Files already downloaded and verified
2024-04-29 06:03:21,150 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-04-29 06:03:23,172 [coda_prompt.py] => 89,715,556 total parameters.
2024-04-29 06:03:23,172 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-04-29 06:03:23,173 [trainer.py] => All params: 89715556
2024-04-29 06:03:23,173 [trainer.py] => Trainable params: 89715556
2024-04-29 06:03:23,173 [coda_prompt.py] => Learning on 0-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.855, Train_accy 77.18:   0%|          | 0/20 [03:50<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.855, Train_accy 77.18:   5%|▌         | 1/20 [03:50<1:13:01, 230.61s/it]Task 0, Epoch 2/20 => Loss 0.552, Train_accy 84.29:   5%|▌         | 1/20 [07:41<1:13:01, 230.61s/it]Task 0, Epoch 2/20 => Loss 0.552, Train_accy 84.29:  10%|█         | 2/20 [07:41<1:09:08, 230.48s/it]Task 0, Epoch 3/20 => Loss 0.507, Train_accy 85.59:  10%|█         | 2/20 [11:31<1:09:08, 230.48s/it]Task 0, Epoch 3/20 => Loss 0.507, Train_accy 85.59:  15%|█▌        | 3/20 [11:31<1:05:17, 230.43s/it]Task 0, Epoch 4/20 => Loss 0.474, Train_accy 86.25:  15%|█▌        | 3/20 [15:19<1:05:17, 230.43s/it]Task 0, Epoch 4/20 => Loss 0.474, Train_accy 86.25:  20%|██        | 4/20 [15:19<1:01:11, 229.44s/it]Task 0, Epoch 5/20 => Loss 0.468, Train_accy 86.70, Test_accy 93.94:  20%|██        | 4/20 [19:34<1:01:11, 229.44s/it]Task 0, Epoch 5/20 => Loss 0.468, Train_accy 86.70, Test_accy 93.94:  25%|██▌       | 5/20 [19:34<59:42, 238.84s/it]  Task 0, Epoch 6/20 => Loss 0.450, Train_accy 87.06:  25%|██▌       | 5/20 [23:26<59:42, 238.84s/it]                 Task 0, Epoch 6/20 => Loss 0.450, Train_accy 87.06:  30%|███       | 6/20 [23:26<55:08, 236.29s/it]Task 0, Epoch 7/20 => Loss 0.439, Train_accy 87.45:  30%|███       | 6/20 [27:17<55:08, 236.29s/it]Task 0, Epoch 7/20 => Loss 0.439, Train_accy 87.45:  35%|███▌      | 7/20 [27:17<50:51, 234.76s/it]Task 0, Epoch 8/20 => Loss 0.432, Train_accy 87.60:  35%|███▌      | 7/20 [31:09<50:51, 234.76s/it]Task 0, Epoch 8/20 => Loss 0.432, Train_accy 87.60:  40%|████      | 8/20 [31:09<46:44, 233.74s/it]Task 0, Epoch 9/20 => Loss 0.408, Train_accy 88.46:  40%|████      | 8/20 [35:00<46:44, 233.74s/it]Task 0, Epoch 9/20 => Loss 0.408, Train_accy 88.46:  45%|████▌     | 9/20 [35:00<42:42, 232.94s/it]Task 0, Epoch 10/20 => Loss 0.402, Train_accy 88.52, Test_accy 94.04:  45%|████▌     | 9/20 [39:15<42:42, 232.94s/it]Task 0, Epoch 10/20 => Loss 0.402, Train_accy 88.52, Test_accy 94.04:  50%|█████     | 10/20 [39:15<39:56, 239.69s/it]Task 0, Epoch 11/20 => Loss 0.394, Train_accy 88.90:  50%|█████     | 10/20 [43:06<39:56, 239.69s/it]                 Task 0, Epoch 11/20 => Loss 0.394, Train_accy 88.90:  55%|█████▌    | 11/20 [43:06<35:34, 237.11s/it]Task 0, Epoch 12/20 => Loss 0.393, Train_accy 88.50:  55%|█████▌    | 11/20 [46:57<35:34, 237.11s/it]Task 0, Epoch 12/20 => Loss 0.393, Train_accy 88.50:  60%|██████    | 12/20 [46:57<31:22, 235.31s/it]Task 0, Epoch 13/20 => Loss 0.377, Train_accy 89.21:  60%|██████    | 12/20 [50:48<31:22, 235.31s/it]Task 0, Epoch 13/20 => Loss 0.377, Train_accy 89.21:  65%|██████▌   | 13/20 [50:48<27:18, 234.07s/it]Task 0, Epoch 14/20 => Loss 0.367, Train_accy 89.38:  65%|██████▌   | 13/20 [54:40<27:18, 234.07s/it]Task 0, Epoch 14/20 => Loss 0.367, Train_accy 89.38:  70%|███████   | 14/20 [54:40<23:19, 233.23s/it]Task 0, Epoch 15/20 => Loss 0.359, Train_accy 89.56, Test_accy 94.42:  70%|███████   | 14/20 [58:56<23:19, 233.23s/it]Task 0, Epoch 15/20 => Loss 0.359, Train_accy 89.56, Test_accy 94.42:  75%|███████▌  | 15/20 [58:56<20:00, 240.17s/it]Task 0, Epoch 16/20 => Loss 0.354, Train_accy 89.60:  75%|███████▌  | 15/20 [1:02:48<20:00, 240.17s/it]               Task 0, Epoch 16/20 => Loss 0.354, Train_accy 89.60:  80%|████████  | 16/20 [1:02:48<15:50, 237.69s/it]Task 0, Epoch 17/20 => Loss 0.356, Train_accy 89.65:  80%|████████  | 16/20 [1:06:40<15:50, 237.69s/it]Task 0, Epoch 17/20 => Loss 0.356, Train_accy 89.65:  85%|████████▌ | 17/20 [1:06:40<11:47, 235.99s/it]Task 0, Epoch 18/20 => Loss 0.342, Train_accy 90.15:  85%|████████▌ | 17/20 [1:10:32<11:47, 235.99s/it]Task 0, Epoch 18/20 => Loss 0.342, Train_accy 90.15:  90%|█████████ | 18/20 [1:10:32<07:49, 234.80s/it]Task 0, Epoch 19/20 => Loss 0.324, Train_accy 90.58:  90%|█████████ | 18/20 [1:14:24<07:49, 234.80s/it]Task 0, Epoch 19/20 => Loss 0.324, Train_accy 90.58:  95%|█████████▌| 19/20 [1:14:24<03:54, 234.01s/it]Task 0, Epoch 20/20 => Loss 0.330, Train_accy 90.61, Test_accy 94.34:  95%|█████████▌| 19/20 [1:18:41<03:54, 234.01s/it]Task 0, Epoch 20/20 => Loss 0.330, Train_accy 90.61, Test_accy 94.34: 100%|██████████| 20/20 [1:18:41<00:00, 240.75s/it]Task 0, Epoch 20/20 => Loss 0.330, Train_accy 90.61, Test_accy 94.34: 100%|██████████| 20/20 [1:18:41<00:00, 236.06s/it]
2024-04-29 07:22:04,851 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.330, Train_accy 90.61, Test_accy 94.34
2024-04-29 07:22:29,187 [trainer.py] => No NME accuracy.
2024-04-29 07:22:29,188 [trainer.py] => CNN: {'total': 94.34, '00-49': 94.34, 'old': 0, 'new': 94.34}
2024-04-29 07:22:29,188 [trainer.py] => CNN top1 curve: [94.34]
2024-04-29 07:22:29,188 [trainer.py] => CNN top5 curve: [99.66]

Average Accuracy (CNN): 94.34
2024-04-29 07:22:29,188 [trainer.py] => Average Accuracy (CNN): 94.34 

2024-04-29 07:22:29,189 [trainer.py] => Train Time: 9442.73
2024-04-29 07:22:29,189 [trainer.py] => Test Time: 24.33 

2024-04-29 07:22:29,190 [trainer.py] => All params: 89715556
2024-04-29 07:22:29,192 [trainer.py] => Trainable params: 89715556
2024-04-29 07:22:29,984 [coda_prompt.py] => Learning on 50-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.388, Train_accy 87.62:   0%|          | 0/20 [00:46<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.388, Train_accy 87.62:   5%|▌         | 1/20 [00:46<14:46, 46.64s/it]Task 1, Epoch 2/20 => Loss 0.202, Train_accy 92.93:   5%|▌         | 1/20 [01:33<14:46, 46.64s/it]Task 1, Epoch 2/20 => Loss 0.202, Train_accy 92.93:  10%|█         | 2/20 [01:33<13:58, 46.60s/it]Task 1, Epoch 3/20 => Loss 0.173, Train_accy 93.75:  10%|█         | 2/20 [02:19<13:58, 46.60s/it]Task 1, Epoch 3/20 => Loss 0.173, Train_accy 93.75:  15%|█▌        | 3/20 [02:19<13:09, 46.47s/it]Task 1, Epoch 4/20 => Loss 0.161, Train_accy 93.91:  15%|█▌        | 3/20 [03:06<13:09, 46.47s/it]Task 1, Epoch 4/20 => Loss 0.161, Train_accy 93.91:  20%|██        | 4/20 [03:06<12:23, 46.48s/it]Task 1, Epoch 5/20 => Loss 0.139, Train_accy 94.95, Test_accy 86.12:  20%|██        | 4/20 [04:21<12:23, 46.48s/it]Task 1, Epoch 5/20 => Loss 0.139, Train_accy 94.95, Test_accy 86.12:  25%|██▌       | 5/20 [04:21<14:14, 56.94s/it]Task 1, Epoch 6/20 => Loss 0.155, Train_accy 94.45:  25%|██▌       | 5/20 [05:08<14:14, 56.94s/it]                 Task 1, Epoch 6/20 => Loss 0.155, Train_accy 94.45:  30%|███       | 6/20 [05:08<12:27, 53.41s/it]Task 1, Epoch 7/20 => Loss 0.153, Train_accy 94.57:  30%|███       | 6/20 [05:54<12:27, 53.41s/it]Task 1, Epoch 7/20 => Loss 0.153, Train_accy 94.57:  35%|███▌      | 7/20 [05:54<11:05, 51.19s/it]Task 1, Epoch 8/20 => Loss 0.142, Train_accy 94.93:  35%|███▌      | 7/20 [06:41<11:05, 51.19s/it]Task 1, Epoch 8/20 => Loss 0.142, Train_accy 94.93:  40%|████      | 8/20 [06:41<09:57, 49.77s/it]Task 1, Epoch 9/20 => Loss 0.137, Train_accy 95.25:  40%|████      | 8/20 [07:27<09:57, 49.77s/it]Task 1, Epoch 9/20 => Loss 0.137, Train_accy 95.25:  45%|████▌     | 9/20 [07:27<08:55, 48.73s/it]Task 1, Epoch 10/20 => Loss 0.141, Train_accy 94.81, Test_accy 87.92:  45%|████▌     | 9/20 [08:43<08:55, 48.73s/it]Task 1, Epoch 10/20 => Loss 0.141, Train_accy 94.81, Test_accy 87.92:  50%|█████     | 10/20 [08:43<09:31, 57.10s/it]Task 1, Epoch 11/20 => Loss 0.140, Train_accy 95.25:  50%|█████     | 10/20 [09:30<09:31, 57.10s/it]                 Task 1, Epoch 11/20 => Loss 0.140, Train_accy 95.25:  55%|█████▌    | 11/20 [09:30<08:05, 53.94s/it]Task 1, Epoch 12/20 => Loss 0.142, Train_accy 94.91:  55%|█████▌    | 11/20 [10:17<08:05, 53.94s/it]Task 1, Epoch 12/20 => Loss 0.142, Train_accy 94.91:  60%|██████    | 12/20 [10:17<06:53, 51.72s/it]Task 1, Epoch 13/20 => Loss 0.143, Train_accy 94.99:  60%|██████    | 12/20 [11:03<06:53, 51.72s/it]Task 1, Epoch 13/20 => Loss 0.143, Train_accy 94.99:  65%|██████▌   | 13/20 [11:03<05:51, 50.19s/it]Task 1, Epoch 14/20 => Loss 0.126, Train_accy 95.61:  65%|██████▌   | 13/20 [11:50<05:51, 50.19s/it]Task 1, Epoch 14/20 => Loss 0.126, Train_accy 95.61:  70%|███████   | 14/20 [11:50<04:54, 49.13s/it]Task 1, Epoch 15/20 => Loss 0.127, Train_accy 95.19, Test_accy 88.13:  70%|███████   | 14/20 [13:06<04:54, 49.13s/it]Task 1, Epoch 15/20 => Loss 0.127, Train_accy 95.19, Test_accy 88.13:  75%|███████▌  | 15/20 [13:06<04:45, 57.14s/it]Task 1, Epoch 16/20 => Loss 0.122, Train_accy 95.77:  75%|███████▌  | 15/20 [13:52<04:45, 57.14s/it]                 Task 1, Epoch 16/20 => Loss 0.122, Train_accy 95.77:  80%|████████  | 16/20 [13:52<03:35, 54.00s/it]Task 1, Epoch 17/20 => Loss 0.135, Train_accy 95.25:  80%|████████  | 16/20 [14:39<03:35, 54.00s/it]Task 1, Epoch 17/20 => Loss 0.135, Train_accy 95.25:  85%|████████▌ | 17/20 [14:39<02:35, 51.79s/it]Task 1, Epoch 18/20 => Loss 0.119, Train_accy 95.71:  85%|████████▌ | 17/20 [15:26<02:35, 51.79s/it]Task 1, Epoch 18/20 => Loss 0.119, Train_accy 95.71:  90%|█████████ | 18/20 [15:26<01:40, 50.25s/it]Task 1, Epoch 19/20 => Loss 0.117, Train_accy 95.59:  90%|█████████ | 18/20 [16:12<01:40, 50.25s/it]Task 1, Epoch 19/20 => Loss 0.117, Train_accy 95.59:  95%|█████████▌| 19/20 [16:12<00:49, 49.18s/it]Task 1, Epoch 20/20 => Loss 0.098, Train_accy 96.19, Test_accy 88.08:  95%|█████████▌| 19/20 [17:28<00:49, 49.18s/it]Task 1, Epoch 20/20 => Loss 0.098, Train_accy 96.19, Test_accy 88.08: 100%|██████████| 20/20 [17:28<00:00, 57.20s/it]Task 1, Epoch 20/20 => Loss 0.098, Train_accy 96.19, Test_accy 88.08: 100%|██████████| 20/20 [17:28<00:00, 52.44s/it]
2024-04-29 07:39:58,820 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.098, Train_accy 96.19, Test_accy 88.08
2024-04-29 07:40:27,880 [trainer.py] => No NME accuracy.
2024-04-29 07:40:27,880 [trainer.py] => CNN: {'total': 88.08, '00-49': 93.78, '50-59': 59.6, 'old': 93.78, 'new': 59.6}
2024-04-29 07:40:27,881 [trainer.py] => CNN top1 curve: [94.34, 88.08]
2024-04-29 07:40:27,881 [trainer.py] => CNN top5 curve: [99.66, 99.18]

Average Accuracy (CNN): 91.21
2024-04-29 07:40:27,881 [trainer.py] => Average Accuracy (CNN): 91.21 

2024-04-29 07:40:27,881 [trainer.py] => Train Time: 11540.25
2024-04-29 07:40:27,881 [trainer.py] => Test Time: 53.39 

2024-04-29 07:40:27,882 [trainer.py] => All params: 89715556
2024-04-29 07:40:27,883 [trainer.py] => Trainable params: 89715556
2024-04-29 07:40:29,166 [coda_prompt.py] => Learning on 60-70
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.421, Train_accy 86.44:   0%|          | 0/20 [00:46<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.421, Train_accy 86.44:   5%|▌         | 1/20 [00:46<14:49, 46.79s/it]Task 2, Epoch 2/20 => Loss 0.183, Train_accy 93.57:   5%|▌         | 1/20 [01:33<14:49, 46.79s/it]Task 2, Epoch 2/20 => Loss 0.183, Train_accy 93.57:  10%|█         | 2/20 [01:33<14:02, 46.81s/it]Task 2, Epoch 3/20 => Loss 0.183, Train_accy 93.85:  10%|█         | 2/20 [02:20<14:02, 46.81s/it]Task 2, Epoch 3/20 => Loss 0.183, Train_accy 93.85:  15%|█▌        | 3/20 [02:20<13:15, 46.79s/it]Task 2, Epoch 4/20 => Loss 0.172, Train_accy 93.93:  15%|█▌        | 3/20 [03:07<13:15, 46.79s/it]Task 2, Epoch 4/20 => Loss 0.172, Train_accy 93.93:  20%|██        | 4/20 [03:07<12:28, 46.80s/it]Task 2, Epoch 5/20 => Loss 0.168, Train_accy 94.05, Test_accy 81.91:  20%|██        | 4/20 [04:27<12:28, 46.80s/it]Task 2, Epoch 5/20 => Loss 0.168, Train_accy 94.05, Test_accy 81.91:  25%|██▌       | 5/20 [04:27<14:45, 59.01s/it]Task 2, Epoch 6/20 => Loss 0.148, Train_accy 94.63:  25%|██▌       | 5/20 [05:14<14:45, 59.01s/it]                 Task 2, Epoch 6/20 => Loss 0.148, Train_accy 94.63:  30%|███       | 6/20 [05:14<12:48, 54.87s/it]Task 2, Epoch 7/20 => Loss 0.165, Train_accy 94.35:  30%|███       | 6/20 [06:01<12:48, 54.87s/it]Task 2, Epoch 7/20 => Loss 0.165, Train_accy 94.35:  35%|███▌      | 7/20 [06:01<11:18, 52.20s/it]Task 2, Epoch 8/20 => Loss 0.146, Train_accy 94.81:  35%|███▌      | 7/20 [06:48<11:18, 52.20s/it]Task 2, Epoch 8/20 => Loss 0.146, Train_accy 94.81:  40%|████      | 8/20 [06:48<10:05, 50.48s/it]Task 2, Epoch 9/20 => Loss 0.147, Train_accy 94.91:  40%|████      | 8/20 [07:34<10:05, 50.48s/it]Task 2, Epoch 9/20 => Loss 0.147, Train_accy 94.91:  45%|████▌     | 9/20 [07:34<09:02, 49.32s/it]Task 2, Epoch 10/20 => Loss 0.140, Train_accy 95.41, Test_accy 83.23:  45%|████▌     | 9/20 [08:55<09:02, 49.32s/it]Task 2, Epoch 10/20 => Loss 0.140, Train_accy 95.41, Test_accy 83.23:  50%|█████     | 10/20 [08:55<09:49, 58.99s/it]Task 2, Epoch 11/20 => Loss 0.152, Train_accy 94.65:  50%|█████     | 10/20 [09:42<09:49, 58.99s/it]                 Task 2, Epoch 11/20 => Loss 0.152, Train_accy 94.65:  55%|█████▌    | 11/20 [09:42<08:17, 55.25s/it]Task 2, Epoch 12/20 => Loss 0.127, Train_accy 95.71:  55%|█████▌    | 11/20 [10:29<08:17, 55.25s/it]Task 2, Epoch 12/20 => Loss 0.127, Train_accy 95.71:  60%|██████    | 12/20 [10:29<07:01, 52.67s/it]Task 2, Epoch 13/20 => Loss 0.127, Train_accy 95.89:  60%|██████    | 12/20 [11:15<07:01, 52.67s/it]Task 2, Epoch 13/20 => Loss 0.127, Train_accy 95.89:  65%|██████▌   | 13/20 [11:15<05:55, 50.85s/it]Task 2, Epoch 14/20 => Loss 0.123, Train_accy 95.79:  65%|██████▌   | 13/20 [12:02<05:55, 50.85s/it]Task 2, Epoch 14/20 => Loss 0.123, Train_accy 95.79:  70%|███████   | 14/20 [12:02<04:57, 49.61s/it]Task 2, Epoch 15/20 => Loss 0.127, Train_accy 95.49, Test_accy 83.74:  70%|███████   | 14/20 [13:23<04:57, 49.61s/it]Task 2, Epoch 15/20 => Loss 0.127, Train_accy 95.49, Test_accy 83.74:  75%|███████▌  | 15/20 [13:23<04:54, 58.93s/it]Task 2, Epoch 16/20 => Loss 0.114, Train_accy 96.11:  75%|███████▌  | 15/20 [14:09<04:54, 58.93s/it]                 Task 2, Epoch 16/20 => Loss 0.114, Train_accy 96.11:  80%|████████  | 16/20 [14:09<03:41, 55.26s/it]Task 2, Epoch 17/20 => Loss 0.128, Train_accy 95.63:  80%|████████  | 16/20 [14:56<03:41, 55.26s/it]Task 2, Epoch 17/20 => Loss 0.128, Train_accy 95.63:  85%|████████▌ | 17/20 [14:56<02:38, 52.69s/it]Task 2, Epoch 18/20 => Loss 0.126, Train_accy 95.85:  85%|████████▌ | 17/20 [15:43<02:38, 52.69s/it]Task 2, Epoch 18/20 => Loss 0.126, Train_accy 95.85:  90%|█████████ | 18/20 [15:43<01:41, 50.88s/it]Task 2, Epoch 19/20 => Loss 0.129, Train_accy 95.69:  90%|█████████ | 18/20 [16:29<01:41, 50.88s/it]Task 2, Epoch 19/20 => Loss 0.129, Train_accy 95.69:  95%|█████████▌| 19/20 [16:29<00:49, 49.63s/it]Task 2, Epoch 20/20 => Loss 0.120, Train_accy 95.95, Test_accy 84.06:  95%|█████████▌| 19/20 [17:50<00:49, 49.63s/it]Task 2, Epoch 20/20 => Loss 0.120, Train_accy 95.95, Test_accy 84.06: 100%|██████████| 20/20 [17:50<00:00, 58.90s/it]Task 2, Epoch 20/20 => Loss 0.120, Train_accy 95.95, Test_accy 84.06: 100%|██████████| 20/20 [17:50<00:00, 53.52s/it]
2024-04-29 07:58:19,663 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.120, Train_accy 95.95, Test_accy 84.06
2024-04-29 07:58:53,489 [trainer.py] => No NME accuracy.
2024-04-29 07:58:53,489 [trainer.py] => CNN: {'total': 84.06, '00-49': 93.54, '50-59': 59.4, '60-69': 61.3, 'old': 87.85, 'new': 61.3}
2024-04-29 07:58:53,489 [trainer.py] => CNN top1 curve: [94.34, 88.08, 84.06]
2024-04-29 07:58:53,490 [trainer.py] => CNN top5 curve: [99.66, 99.18, 98.67]

Average Accuracy (CNN): 88.83
2024-04-29 07:58:53,490 [trainer.py] => Average Accuracy (CNN): 88.83 

2024-04-29 07:58:53,490 [trainer.py] => Train Time: 13681.12
2024-04-29 07:58:53,490 [trainer.py] => Test Time: 87.21000000000001 

2024-04-29 07:58:53,491 [trainer.py] => All params: 89715556
2024-04-29 07:58:53,492 [trainer.py] => Trainable params: 89715556
2024-04-29 07:58:55,272 [coda_prompt.py] => Learning on 70-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.437, Train_accy 86.66:   0%|          | 0/20 [00:46<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.437, Train_accy 86.66:   5%|▌         | 1/20 [00:46<14:48, 46.78s/it]Task 3, Epoch 2/20 => Loss 0.216, Train_accy 93.41:   5%|▌         | 1/20 [01:33<14:48, 46.78s/it]Task 3, Epoch 2/20 => Loss 0.216, Train_accy 93.41:  10%|█         | 2/20 [01:33<14:01, 46.77s/it]Task 3, Epoch 3/20 => Loss 0.169, Train_accy 94.49:  10%|█         | 2/20 [02:20<14:01, 46.77s/it]Task 3, Epoch 3/20 => Loss 0.169, Train_accy 94.49:  15%|█▌        | 3/20 [02:20<13:15, 46.79s/it]Task 3, Epoch 4/20 => Loss 0.160, Train_accy 94.69:  15%|█▌        | 3/20 [03:07<13:15, 46.79s/it]Task 3, Epoch 4/20 => Loss 0.160, Train_accy 94.69:  20%|██        | 4/20 [03:07<12:28, 46.77s/it]Task 3, Epoch 5/20 => Loss 0.160, Train_accy 94.65, Test_accy 78.96:  20%|██        | 4/20 [04:32<12:28, 46.77s/it]Task 3, Epoch 5/20 => Loss 0.160, Train_accy 94.65, Test_accy 78.96:  25%|██▌       | 5/20 [04:32<15:09, 60.64s/it]Task 3, Epoch 6/20 => Loss 0.157, Train_accy 94.69:  25%|██▌       | 5/20 [05:19<15:09, 60.64s/it]                 Task 3, Epoch 6/20 => Loss 0.157, Train_accy 94.69:  30%|███       | 6/20 [05:19<13:02, 55.92s/it]Task 3, Epoch 7/20 => Loss 0.142, Train_accy 95.21:  30%|███       | 6/20 [06:05<13:02, 55.92s/it]Task 3, Epoch 7/20 => Loss 0.142, Train_accy 95.21:  35%|███▌      | 7/20 [06:05<11:28, 52.93s/it]Task 3, Epoch 8/20 => Loss 0.136, Train_accy 95.23:  35%|███▌      | 7/20 [06:52<11:28, 52.93s/it]Task 3, Epoch 8/20 => Loss 0.136, Train_accy 95.23:  40%|████      | 8/20 [06:52<10:11, 50.97s/it]Task 3, Epoch 9/20 => Loss 0.137, Train_accy 95.27:  40%|████      | 8/20 [07:39<10:11, 50.97s/it]Task 3, Epoch 9/20 => Loss 0.137, Train_accy 95.27:  45%|████▌     | 9/20 [07:39<09:06, 49.66s/it]Task 3, Epoch 10/20 => Loss 0.130, Train_accy 95.65, Test_accy 80.60:  45%|████▌     | 9/20 [09:04<09:06, 49.66s/it]Task 3, Epoch 10/20 => Loss 0.130, Train_accy 95.65, Test_accy 80.60:  50%|█████     | 10/20 [09:04<10:06, 60.67s/it]Task 3, Epoch 11/20 => Loss 0.148, Train_accy 95.47:  50%|█████     | 10/20 [09:51<10:06, 60.67s/it]                 Task 3, Epoch 11/20 => Loss 0.148, Train_accy 95.47:  55%|█████▌    | 11/20 [09:51<08:27, 56.41s/it]Task 3, Epoch 12/20 => Loss 0.129, Train_accy 95.57:  55%|█████▌    | 11/20 [10:38<08:27, 56.41s/it]Task 3, Epoch 12/20 => Loss 0.129, Train_accy 95.57:  60%|██████    | 12/20 [10:38<07:07, 53.50s/it]Task 3, Epoch 13/20 => Loss 0.127, Train_accy 95.67:  60%|██████    | 12/20 [11:25<07:07, 53.50s/it]Task 3, Epoch 13/20 => Loss 0.127, Train_accy 95.67:  65%|██████▌   | 13/20 [11:25<06:00, 51.46s/it]Task 3, Epoch 14/20 => Loss 0.111, Train_accy 96.15:  65%|██████▌   | 13/20 [12:11<06:00, 51.46s/it]Task 3, Epoch 14/20 => Loss 0.111, Train_accy 96.15:  70%|███████   | 14/20 [12:11<05:00, 50.05s/it]Task 3, Epoch 15/20 => Loss 0.121, Train_accy 96.07, Test_accy 80.82:  70%|███████   | 14/20 [13:37<05:00, 50.05s/it]Task 3, Epoch 15/20 => Loss 0.121, Train_accy 96.07, Test_accy 80.82:  75%|███████▌  | 15/20 [13:37<05:03, 60.64s/it]Task 3, Epoch 16/20 => Loss 0.110, Train_accy 96.31:  75%|███████▌  | 15/20 [14:23<05:03, 60.64s/it]                 Task 3, Epoch 16/20 => Loss 0.110, Train_accy 96.31:  80%|████████  | 16/20 [14:23<03:45, 56.44s/it]Task 3, Epoch 17/20 => Loss 0.108, Train_accy 96.21:  80%|████████  | 16/20 [15:10<03:45, 56.44s/it]Task 3, Epoch 17/20 => Loss 0.108, Train_accy 96.21:  85%|████████▌ | 17/20 [15:10<02:40, 53.54s/it]Task 3, Epoch 18/20 => Loss 0.108, Train_accy 96.25:  85%|████████▌ | 17/20 [15:57<02:40, 53.54s/it]Task 3, Epoch 18/20 => Loss 0.108, Train_accy 96.25:  90%|█████████ | 18/20 [15:57<01:43, 51.54s/it]Task 3, Epoch 19/20 => Loss 0.105, Train_accy 96.23:  90%|█████████ | 18/20 [16:44<01:43, 51.54s/it]Task 3, Epoch 19/20 => Loss 0.105, Train_accy 96.23:  95%|█████████▌| 19/20 [16:44<00:50, 50.15s/it]Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.35, Test_accy 80.50:  95%|█████████▌| 19/20 [18:09<00:50, 50.15s/it]Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.35, Test_accy 80.50: 100%|██████████| 20/20 [18:09<00:00, 60.72s/it]Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.35, Test_accy 80.50: 100%|██████████| 20/20 [18:09<00:00, 54.49s/it]
2024-04-29 08:17:05,047 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.35, Test_accy 80.50
2024-04-29 08:17:43,659 [trainer.py] => No NME accuracy.
2024-04-29 08:17:43,660 [trainer.py] => CNN: {'total': 80.5, '00-49': 93.28, '50-59': 56.4, '60-69': 60.0, '70-79': 61.2, 'old': 83.26, 'new': 61.2}
2024-04-29 08:17:43,660 [trainer.py] => CNN top1 curve: [94.34, 88.08, 84.06, 80.5]
2024-04-29 08:17:43,660 [trainer.py] => CNN top5 curve: [99.66, 99.18, 98.67, 98.24]

Average Accuracy (CNN): 86.74
2024-04-29 08:17:43,660 [trainer.py] => Average Accuracy (CNN): 86.74 

2024-04-29 08:17:43,660 [trainer.py] => Train Time: 15860.58
2024-04-29 08:17:43,661 [trainer.py] => Test Time: 125.82000000000001 

2024-04-29 08:17:43,662 [trainer.py] => All params: 89715556
2024-04-29 08:17:43,663 [trainer.py] => Trainable params: 89715556
2024-04-29 08:17:45,965 [coda_prompt.py] => Learning on 80-90
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.381, Train_accy 88.32:   0%|          | 0/20 [00:46<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.381, Train_accy 88.32:   5%|▌         | 1/20 [00:46<14:48, 46.77s/it]Task 4, Epoch 2/20 => Loss 0.155, Train_accy 94.81:   5%|▌         | 1/20 [01:33<14:48, 46.77s/it]Task 4, Epoch 2/20 => Loss 0.155, Train_accy 94.81:  10%|█         | 2/20 [01:33<14:03, 46.86s/it]Task 4, Epoch 3/20 => Loss 0.144, Train_accy 95.39:  10%|█         | 2/20 [02:20<14:03, 46.86s/it]Task 4, Epoch 3/20 => Loss 0.144, Train_accy 95.39:  15%|█▌        | 3/20 [02:20<13:16, 46.85s/it]Task 4, Epoch 4/20 => Loss 0.124, Train_accy 96.03:  15%|█▌        | 3/20 [03:07<13:16, 46.85s/it]Task 4, Epoch 4/20 => Loss 0.124, Train_accy 96.03:  20%|██        | 4/20 [03:07<12:29, 46.85s/it]Task 4, Epoch 5/20 => Loss 0.128, Train_accy 95.61, Test_accy 76.87:  20%|██        | 4/20 [04:37<12:29, 46.85s/it]Task 4, Epoch 5/20 => Loss 0.128, Train_accy 95.61, Test_accy 76.87:  25%|██▌       | 5/20 [04:37<15:36, 62.42s/it]Task 4, Epoch 6/20 => Loss 0.132, Train_accy 95.49:  25%|██▌       | 5/20 [05:24<15:36, 62.42s/it]                 Task 4, Epoch 6/20 => Loss 0.132, Train_accy 95.49:  30%|███       | 6/20 [05:24<13:19, 57.08s/it]Task 4, Epoch 7/20 => Loss 0.133, Train_accy 95.67:  30%|███       | 6/20 [06:10<13:19, 57.08s/it]Task 4, Epoch 7/20 => Loss 0.133, Train_accy 95.67:  35%|███▌      | 7/20 [06:10<11:38, 53.70s/it]Task 4, Epoch 8/20 => Loss 0.133, Train_accy 95.53:  35%|███▌      | 7/20 [06:57<11:38, 53.70s/it]Task 4, Epoch 8/20 => Loss 0.133, Train_accy 95.53:  40%|████      | 8/20 [06:57<10:17, 51.50s/it]Task 4, Epoch 9/20 => Loss 0.118, Train_accy 96.07:  40%|████      | 8/20 [07:44<10:17, 51.50s/it]Task 4, Epoch 9/20 => Loss 0.118, Train_accy 96.07:  45%|████▌     | 9/20 [07:44<09:10, 50.04s/it]Task 4, Epoch 10/20 => Loss 0.119, Train_accy 96.07, Test_accy 77.84:  45%|████▌     | 9/20 [09:14<09:10, 50.04s/it]Task 4, Epoch 10/20 => Loss 0.119, Train_accy 96.07, Test_accy 77.84:  50%|█████     | 10/20 [09:14<10:24, 62.42s/it]Task 4, Epoch 11/20 => Loss 0.122, Train_accy 95.81:  50%|█████     | 10/20 [10:01<10:24, 62.42s/it]                 Task 4, Epoch 11/20 => Loss 0.122, Train_accy 95.81:  55%|█████▌    | 11/20 [10:01<08:38, 57.64s/it]Task 4, Epoch 12/20 => Loss 0.110, Train_accy 96.25:  55%|█████▌    | 11/20 [10:48<08:38, 57.64s/it]Task 4, Epoch 12/20 => Loss 0.110, Train_accy 96.25:  60%|██████    | 12/20 [10:48<07:14, 54.30s/it]Task 4, Epoch 13/20 => Loss 0.115, Train_accy 96.03:  60%|██████    | 12/20 [11:34<07:14, 54.30s/it]Task 4, Epoch 13/20 => Loss 0.115, Train_accy 96.03:  65%|██████▌   | 13/20 [11:34<06:04, 52.04s/it]Task 4, Epoch 14/20 => Loss 0.106, Train_accy 96.25:  65%|██████▌   | 13/20 [12:21<06:04, 52.04s/it]Task 4, Epoch 14/20 => Loss 0.106, Train_accy 96.25:  70%|███████   | 14/20 [12:21<05:02, 50.47s/it]Task 4, Epoch 15/20 => Loss 0.102, Train_accy 96.47, Test_accy 78.02:  70%|███████   | 14/20 [13:51<05:02, 50.47s/it]Task 4, Epoch 15/20 => Loss 0.102, Train_accy 96.47, Test_accy 78.02:  75%|███████▌  | 15/20 [13:51<05:12, 62.44s/it]Task 4, Epoch 16/20 => Loss 0.109, Train_accy 96.37:  75%|███████▌  | 15/20 [14:38<05:12, 62.44s/it]                 Task 4, Epoch 16/20 => Loss 0.109, Train_accy 96.37:  80%|████████  | 16/20 [14:38<03:50, 57.72s/it]Task 4, Epoch 17/20 => Loss 0.092, Train_accy 97.02:  80%|████████  | 16/20 [15:25<03:50, 57.72s/it]Task 4, Epoch 17/20 => Loss 0.092, Train_accy 97.02:  85%|████████▌ | 17/20 [15:25<02:43, 54.41s/it]Task 4, Epoch 18/20 => Loss 0.104, Train_accy 96.31:  85%|████████▌ | 17/20 [16:12<02:43, 54.41s/it]Task 4, Epoch 18/20 => Loss 0.104, Train_accy 96.31:  90%|█████████ | 18/20 [16:12<01:44, 52.11s/it]Task 4, Epoch 19/20 => Loss 0.089, Train_accy 97.00:  90%|█████████ | 18/20 [16:58<01:44, 52.11s/it]Task 4, Epoch 19/20 => Loss 0.089, Train_accy 97.00:  95%|█████████▌| 19/20 [16:58<00:50, 50.50s/it]Task 4, Epoch 20/20 => Loss 0.106, Train_accy 96.63, Test_accy 78.02:  95%|█████████▌| 19/20 [18:29<00:50, 50.50s/it]Task 4, Epoch 20/20 => Loss 0.106, Train_accy 96.63, Test_accy 78.02: 100%|██████████| 20/20 [18:29<00:00, 62.39s/it]Task 4, Epoch 20/20 => Loss 0.106, Train_accy 96.63, Test_accy 78.02: 100%|██████████| 20/20 [18:29<00:00, 55.45s/it]
2024-04-29 08:36:15,053 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.106, Train_accy 96.63, Test_accy 78.02
2024-04-29 08:36:58,514 [trainer.py] => No NME accuracy.
2024-04-29 08:36:58,515 [trainer.py] => CNN: {'total': 78.02, '00-49': 93.44, '50-59': 56.8, '60-69': 57.4, '70-79': 61.7, '80-89': 59.1, 'old': 80.39, 'new': 59.1}
2024-04-29 08:36:58,515 [trainer.py] => CNN top1 curve: [94.34, 88.08, 84.06, 80.5, 78.02]
2024-04-29 08:36:58,515 [trainer.py] => CNN top5 curve: [99.66, 99.18, 98.67, 98.24, 98.06]

Average Accuracy (CNN): 85.0
2024-04-29 08:36:58,515 [trainer.py] => Average Accuracy (CNN): 85.0 

2024-04-29 08:36:58,516 [trainer.py] => Train Time: 18078.67
2024-04-29 08:36:58,516 [trainer.py] => Test Time: 169.28 

2024-04-29 08:36:58,517 [trainer.py] => All params: 89715556
2024-04-29 08:36:58,518 [trainer.py] => Trainable params: 89715556
2024-04-29 08:37:01,398 [coda_prompt.py] => Learning on 90-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.307, Train_accy 90.89:   0%|          | 0/20 [00:46<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.307, Train_accy 90.89:   5%|▌         | 1/20 [00:46<14:51, 46.91s/it]Task 5, Epoch 2/20 => Loss 0.112, Train_accy 96.27:   5%|▌         | 1/20 [01:33<14:51, 46.91s/it]Task 5, Epoch 2/20 => Loss 0.112, Train_accy 96.27:  10%|█         | 2/20 [01:33<14:03, 46.88s/it]Task 5, Epoch 3/20 => Loss 0.113, Train_accy 96.47:  10%|█         | 2/20 [02:20<14:03, 46.88s/it]Task 5, Epoch 3/20 => Loss 0.113, Train_accy 96.47:  15%|█▌        | 3/20 [02:20<13:16, 46.86s/it]Task 5, Epoch 4/20 => Loss 0.113, Train_accy 96.25:  15%|█▌        | 3/20 [03:07<13:16, 46.86s/it]Task 5, Epoch 4/20 => Loss 0.113, Train_accy 96.25:  20%|██        | 4/20 [03:07<12:29, 46.86s/it]Task 5, Epoch 5/20 => Loss 0.104, Train_accy 96.88, Test_accy 72.52:  20%|██        | 4/20 [04:42<12:29, 46.86s/it]Task 5, Epoch 5/20 => Loss 0.104, Train_accy 96.88, Test_accy 72.52:  25%|██▌       | 5/20 [04:42<16:03, 64.22s/it]Task 5, Epoch 6/20 => Loss 0.095, Train_accy 97.02:  25%|██▌       | 5/20 [05:29<16:03, 64.22s/it]                 Task 5, Epoch 6/20 => Loss 0.095, Train_accy 97.02:  30%|███       | 6/20 [05:29<13:36, 58.30s/it]Task 5, Epoch 7/20 => Loss 0.092, Train_accy 96.81:  30%|███       | 6/20 [06:15<13:36, 58.30s/it]Task 5, Epoch 7/20 => Loss 0.092, Train_accy 96.81:  35%|███▌      | 7/20 [06:15<11:48, 54.50s/it]Task 5, Epoch 8/20 => Loss 0.095, Train_accy 97.18:  35%|███▌      | 7/20 [07:02<11:48, 54.50s/it]Task 5, Epoch 8/20 => Loss 0.095, Train_accy 97.18:  40%|████      | 8/20 [07:02<10:22, 51.89s/it]Task 5, Epoch 9/20 => Loss 0.088, Train_accy 97.24:  40%|████      | 8/20 [07:48<10:22, 51.89s/it]Task 5, Epoch 9/20 => Loss 0.088, Train_accy 97.24:  45%|████▌     | 9/20 [07:48<09:12, 50.20s/it]Task 5, Epoch 10/20 => Loss 0.088, Train_accy 97.22, Test_accy 74.14:  45%|████▌     | 9/20 [09:22<09:12, 50.20s/it]Task 5, Epoch 10/20 => Loss 0.088, Train_accy 97.22, Test_accy 74.14:  50%|█████     | 10/20 [09:22<10:37, 63.73s/it]Task 5, Epoch 11/20 => Loss 0.088, Train_accy 97.02:  50%|█████     | 10/20 [10:09<10:37, 63.73s/it]                 Task 5, Epoch 11/20 => Loss 0.088, Train_accy 97.02:  55%|█████▌    | 11/20 [10:09<08:46, 58.45s/it]Task 5, Epoch 12/20 => Loss 0.084, Train_accy 97.44:  55%|█████▌    | 11/20 [10:55<08:46, 58.45s/it]Task 5, Epoch 12/20 => Loss 0.084, Train_accy 97.44:  60%|██████    | 12/20 [10:55<07:17, 54.75s/it]Task 5, Epoch 13/20 => Loss 0.087, Train_accy 97.38:  60%|██████    | 12/20 [11:41<07:17, 54.75s/it]Task 5, Epoch 13/20 => Loss 0.087, Train_accy 97.38:  65%|██████▌   | 13/20 [11:41<06:05, 52.23s/it]Task 5, Epoch 14/20 => Loss 0.091, Train_accy 97.16:  65%|██████▌   | 13/20 [12:28<06:05, 52.23s/it]Task 5, Epoch 14/20 => Loss 0.091, Train_accy 97.16:  70%|███████   | 14/20 [12:28<05:02, 50.47s/it]Task 5, Epoch 15/20 => Loss 0.084, Train_accy 97.34, Test_accy 74.35:  70%|███████   | 14/20 [14:02<05:02, 50.47s/it]Task 5, Epoch 15/20 => Loss 0.084, Train_accy 97.34, Test_accy 74.35:  75%|███████▌  | 15/20 [14:02<05:17, 63.54s/it]Task 5, Epoch 16/20 => Loss 0.084, Train_accy 97.42:  75%|███████▌  | 15/20 [14:48<05:17, 63.54s/it]                 Task 5, Epoch 16/20 => Loss 0.084, Train_accy 97.42:  80%|████████  | 16/20 [14:48<03:53, 58.42s/it]Task 5, Epoch 17/20 => Loss 0.078, Train_accy 97.50:  80%|████████  | 16/20 [15:35<03:53, 58.42s/it]Task 5, Epoch 17/20 => Loss 0.078, Train_accy 97.50:  85%|████████▌ | 17/20 [15:35<02:44, 54.78s/it]Task 5, Epoch 18/20 => Loss 0.084, Train_accy 97.34:  85%|████████▌ | 17/20 [16:21<02:44, 54.78s/it]Task 5, Epoch 18/20 => Loss 0.084, Train_accy 97.34:  90%|█████████ | 18/20 [16:21<01:44, 52.26s/it]Task 5, Epoch 19/20 => Loss 0.075, Train_accy 97.66:  90%|█████████ | 18/20 [17:07<01:44, 52.26s/it]Task 5, Epoch 19/20 => Loss 0.075, Train_accy 97.66:  95%|█████████▌| 19/20 [17:07<00:50, 50.50s/it]Task 5, Epoch 20/20 => Loss 0.078, Train_accy 97.60, Test_accy 74.15:  95%|█████████▌| 19/20 [18:42<00:50, 50.50s/it]Task 5, Epoch 20/20 => Loss 0.078, Train_accy 97.60, Test_accy 74.15: 100%|██████████| 20/20 [18:42<00:00, 63.69s/it]Task 5, Epoch 20/20 => Loss 0.078, Train_accy 97.60, Test_accy 74.15: 100%|██████████| 20/20 [18:42<00:00, 56.11s/it]
2024-04-29 08:55:43,683 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.078, Train_accy 97.60, Test_accy 74.15
2024-04-29 08:56:31,262 [trainer.py] => No NME accuracy.
2024-04-29 08:56:31,262 [trainer.py] => CNN: {'total': 74.15, '00-49': 93.34, '50-59': 55.5, '60-69': 56.4, '70-79': 59.3, '80-89': 55.9, '90-99': 47.7, 'old': 77.09, 'new': 47.7}
2024-04-29 08:56:31,262 [trainer.py] => CNN top1 curve: [94.34, 88.08, 84.06, 80.5, 78.02, 74.15]
2024-04-29 08:56:31,262 [trainer.py] => CNN top5 curve: [99.66, 99.18, 98.67, 98.24, 98.06, 97.63]

Average Accuracy (CNN): 83.19
2024-04-29 08:56:31,262 [trainer.py] => Average Accuracy (CNN): 83.19 

2024-04-29 08:56:31,262 [trainer.py] => Train Time: 20323.15
2024-04-29 08:56:31,263 [trainer.py] => Test Time: 216.86 

Accuracy Matrix (CNN):
[[94.34 93.78 93.54 93.28 93.44 93.34]
 [ 0.   59.6  59.4  56.4  56.8  55.5 ]
 [ 0.    0.   61.3  60.   57.4  56.4 ]
 [ 0.    0.    0.   61.2  61.7  59.3 ]
 [ 0.    0.    0.    0.   59.1  55.9 ]
 [ 0.    0.    0.    0.    0.   47.7 ]]
2024-04-29 08:56:31,264 [trainer.py] => Forgetting (CNN): 3.120000000000002
2024-04-29 08:56:34,062 [trainer.py] => config: ./exps/simplecil_cifar_B50_Inc5.json
2024-04-29 08:56:34,091 [trainer.py] => prefix:  
2024-04-29 08:56:34,091 [trainer.py] => dataset: cifar224
2024-04-29 08:56:34,091 [trainer.py] => memory_size: 0
2024-04-29 08:56:34,091 [trainer.py] => memory_per_class: 0
2024-04-29 08:56:34,091 [trainer.py] => fixed_memory: False
2024-04-29 08:56:34,091 [trainer.py] => shuffle: True
2024-04-29 08:56:34,091 [trainer.py] => init_cls: 50
2024-04-29 08:56:34,091 [trainer.py] => increment: 10
2024-04-29 08:56:34,092 [trainer.py] => model_name: simplecil
2024-04-29 08:56:34,092 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-04-29 08:56:34,092 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-29 08:56:34,092 [trainer.py] => seed: 1993
2024-04-29 08:56:34,092 [trainer.py] => tuned_epoch: 0
2024-04-29 08:56:34,092 [trainer.py] => init_lr: 0.01
2024-04-29 08:56:34,092 [trainer.py] => batch_size: 48
2024-04-29 08:56:34,092 [trainer.py] => weight_decay: 0.05
2024-04-29 08:56:34,092 [trainer.py] => min_lr: 1e-08
2024-04-29 08:56:34,093 [trainer.py] => optimizer: sgd
2024-04-29 08:56:34,093 [trainer.py] => vpt_type: shallow
2024-04-29 08:56:34,093 [trainer.py] => prompt_token_num: 3
Files already downloaded and verified
Files already downloaded and verified
2024-04-29 08:56:35,892 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-29 08:56:39,826 [trainer.py] => All params: 85798656
2024-04-29 08:56:39,827 [trainer.py] => Trainable params: 85798656
2024-04-29 08:56:40,240 [simplecil.py] => Learning on 0-50
2024-04-29 08:57:52,314 [trainer.py] => No NME accuracy.
2024-04-29 08:57:52,315 [trainer.py] => CNN: {'total': 81.82, '00-49': 81.82, 'old': 0, 'new': 81.82}
2024-04-29 08:57:52,315 [trainer.py] => CNN top1 curve: [81.82]
2024-04-29 08:57:52,315 [trainer.py] => CNN top5 curve: [95.52]

Average Accuracy (CNN): 81.82
2024-04-29 08:57:52,315 [trainer.py] => Average Accuracy (CNN): 81.82 

2024-04-29 08:57:52,316 [trainer.py] => Train Time: 59.62
2024-04-29 08:57:52,316 [trainer.py] => Test Time: 12.33 

2024-04-29 08:57:52,317 [trainer.py] => All params: 85837057
2024-04-29 08:57:52,319 [trainer.py] => Trainable params: 85837057
2024-04-29 08:57:52,322 [simplecil.py] => Learning on 50-60
2024-04-29 08:58:19,171 [trainer.py] => No NME accuracy.
2024-04-29 08:58:19,171 [trainer.py] => CNN: {'total': 80.07, '00-49': 80.22, '50-59': 79.3, 'old': 80.22, 'new': 79.3}
2024-04-29 08:58:19,171 [trainer.py] => CNN top1 curve: [81.82, 80.07]
2024-04-29 08:58:19,171 [trainer.py] => CNN top5 curve: [95.52, 94.47]

Average Accuracy (CNN): 80.94
2024-04-29 08:58:19,172 [trainer.py] => Average Accuracy (CNN): 80.94 

2024-04-29 08:58:19,172 [trainer.py] => Train Time: 71.86
2024-04-29 08:58:19,172 [trainer.py] => Test Time: 26.9 

2024-04-29 08:58:19,173 [trainer.py] => All params: 85844737
2024-04-29 08:58:19,173 [trainer.py] => Trainable params: 85844737
2024-04-29 08:58:19,175 [simplecil.py] => Learning on 60-70
2024-04-29 08:58:48,806 [trainer.py] => No NME accuracy.
2024-04-29 08:58:48,806 [trainer.py] => CNN: {'total': 79.99, '00-49': 79.58, '50-59': 76.3, '60-69': 85.7, 'old': 79.03, 'new': 85.7}
2024-04-29 08:58:48,806 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99]
2024-04-29 08:58:48,807 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36]

Average Accuracy (CNN): 80.63
2024-04-29 08:58:48,807 [trainer.py] => Average Accuracy (CNN): 80.63 

2024-04-29 08:58:48,807 [trainer.py] => Train Time: 84.28
2024-04-29 08:58:48,807 [trainer.py] => Test Time: 44.07 

2024-04-29 08:58:48,808 [trainer.py] => All params: 85852417
2024-04-29 08:58:48,809 [trainer.py] => Trainable params: 85852417
2024-04-29 08:58:48,810 [simplecil.py] => Learning on 70-80
2024-04-29 08:59:20,971 [trainer.py] => No NME accuracy.
2024-04-29 08:59:20,971 [trainer.py] => CNN: {'total': 77.31, '00-49': 78.28, '50-59': 72.7, '60-69': 83.7, '70-79': 70.7, 'old': 78.26, 'new': 70.7}
2024-04-29 08:59:20,971 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99, 77.31]
2024-04-29 08:59:20,971 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36, 93.54]

Average Accuracy (CNN): 79.8
2024-04-29 08:59:20,972 [trainer.py] => Average Accuracy (CNN): 79.8 

2024-04-29 08:59:20,972 [trainer.py] => Train Time: 96.75
2024-04-29 08:59:20,972 [trainer.py] => Test Time: 63.72 

2024-04-29 08:59:20,973 [trainer.py] => All params: 85860097
2024-04-29 08:59:20,974 [trainer.py] => Trainable params: 85860097
2024-04-29 08:59:20,976 [simplecil.py] => Learning on 80-90
2024-04-29 08:59:55,551 [trainer.py] => No NME accuracy.
2024-04-29 08:59:55,552 [trainer.py] => CNN: {'total': 76.59, '00-49': 77.1, '50-59': 72.2, '60-69': 83.4, '70-79': 70.1, '80-89': 78.1, 'old': 76.4, 'new': 78.1}
2024-04-29 08:59:55,552 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99, 77.31, 76.59]
2024-04-29 08:59:55,552 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36, 93.54, 92.92]

Average Accuracy (CNN): 79.16
2024-04-29 08:59:55,552 [trainer.py] => Average Accuracy (CNN): 79.16 

2024-04-29 08:59:55,552 [trainer.py] => Train Time: 109.41
2024-04-29 08:59:55,552 [trainer.py] => Test Time: 85.59 

2024-04-29 08:59:55,553 [trainer.py] => All params: 85867777
2024-04-29 08:59:55,555 [trainer.py] => Trainable params: 85867777
2024-04-29 08:59:55,557 [simplecil.py] => Learning on 90-100
2024-04-29 09:00:32,742 [trainer.py] => No NME accuracy.
2024-04-29 09:00:32,743 [trainer.py] => CNN: {'total': 76.21, '00-49': 76.4, '50-59': 70.3, '60-69': 83.3, '70-79': 69.1, '80-89': 77.2, '90-99': 80.2, 'old': 75.77, 'new': 80.2}
2024-04-29 09:00:32,743 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99, 77.31, 76.59, 76.21]
2024-04-29 09:00:32,743 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36, 93.54, 92.92, 92.54]

Average Accuracy (CNN): 78.66
2024-04-29 09:00:32,743 [trainer.py] => Average Accuracy (CNN): 78.66 

2024-04-29 09:00:32,743 [trainer.py] => Train Time: 121.89999999999999
2024-04-29 09:00:32,743 [trainer.py] => Test Time: 110.23 

Accuracy Matrix (CNN):
[[81.82 80.22 79.58 78.28 77.1  76.4 ]
 [ 0.   79.3  76.3  72.7  72.2  70.3 ]
 [ 0.    0.   85.7  83.7  83.4  83.3 ]
 [ 0.    0.    0.   70.7  70.1  69.1 ]
 [ 0.    0.    0.    0.   78.1  77.2 ]
 [ 0.    0.    0.    0.    0.   80.2 ]]
2024-04-29 09:00:32,744 [trainer.py] => Forgetting (CNN): 3.8639999999999985
2024-04-29 09:00:35,374 [trainer.py] => config: ./exps/ease_cifar_B50_Inc5.json
2024-04-29 09:00:35,374 [trainer.py] => prefix:  
2024-04-29 09:00:35,374 [trainer.py] => dataset: cifar224
2024-04-29 09:00:35,374 [trainer.py] => memory_size: 0
2024-04-29 09:00:35,374 [trainer.py] => memory_per_class: 0
2024-04-29 09:00:35,374 [trainer.py] => fixed_memory: False
2024-04-29 09:00:35,374 [trainer.py] => shuffle: True
2024-04-29 09:00:35,374 [trainer.py] => init_cls: 50
2024-04-29 09:00:35,374 [trainer.py] => increment: 10
2024-04-29 09:00:35,374 [trainer.py] => model_name: ease
2024-04-29 09:00:35,374 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-04-29 09:00:35,374 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-29 09:00:35,374 [trainer.py] => seed: 1993
2024-04-29 09:00:35,375 [trainer.py] => init_epochs: 20
2024-04-29 09:00:35,375 [trainer.py] => init_lr: 0.025
2024-04-29 09:00:35,375 [trainer.py] => later_epochs: 20
2024-04-29 09:00:35,375 [trainer.py] => later_lr: 0.025
2024-04-29 09:00:35,375 [trainer.py] => batch_size: 48
2024-04-29 09:00:35,375 [trainer.py] => weight_decay: 0.0005
2024-04-29 09:00:35,375 [trainer.py] => min_lr: 0
2024-04-29 09:00:35,375 [trainer.py] => optimizer: sgd
2024-04-29 09:00:35,375 [trainer.py] => scheduler: cosine
2024-04-29 09:00:35,375 [trainer.py] => pretrained: True
2024-04-29 09:00:35,375 [trainer.py] => vpt_type: Deep
2024-04-29 09:00:35,375 [trainer.py] => prompt_token_num: 5
2024-04-29 09:00:35,375 [trainer.py] => ffn_num: 64
2024-04-29 09:00:35,375 [trainer.py] => use_diagonal: False
2024-04-29 09:00:35,375 [trainer.py] => recalc_sim: True
2024-04-29 09:00:35,375 [trainer.py] => alpha: 0.1
2024-04-29 09:00:35,375 [trainer.py] => use_init_ptm: False
2024-04-29 09:00:35,375 [trainer.py] => beta: 0
2024-04-29 09:00:35,375 [trainer.py] => use_old_data: False
2024-04-29 09:00:35,375 [trainer.py] => use_reweight: True
2024-04-29 09:00:35,375 [trainer.py] => moni_adam: False
2024-04-29 09:00:35,375 [trainer.py] => adapter_num: -1
Files already downloaded and verified
Files already downloaded and verified
2024-04-29 09:00:37,152 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
_IncompatibleKeys(missing_keys=['cur_adapter.0.down_proj.weight', 'cur_adapter.0.down_proj.bias', 'cur_adapter.0.up_proj.weight', 'cur_adapter.0.up_proj.bias', 'cur_adapter.1.down_proj.weight', 'cur_adapter.1.down_proj.bias', 'cur_adapter.1.up_proj.weight', 'cur_adapter.1.up_proj.bias', 'cur_adapter.2.down_proj.weight', 'cur_adapter.2.down_proj.bias', 'cur_adapter.2.up_proj.weight', 'cur_adapter.2.up_proj.bias', 'cur_adapter.3.down_proj.weight', 'cur_adapter.3.down_proj.bias', 'cur_adapter.3.up_proj.weight', 'cur_adapter.3.up_proj.bias', 'cur_adapter.4.down_proj.weight', 'cur_adapter.4.down_proj.bias', 'cur_adapter.4.up_proj.weight', 'cur_adapter.4.up_proj.bias', 'cur_adapter.5.down_proj.weight', 'cur_adapter.5.down_proj.bias', 'cur_adapter.5.up_proj.weight', 'cur_adapter.5.up_proj.bias', 'cur_adapter.6.down_proj.weight', 'cur_adapter.6.down_proj.bias', 'cur_adapter.6.up_proj.weight', 'cur_adapter.6.up_proj.bias', 'cur_adapter.7.down_proj.weight', 'cur_adapter.7.down_proj.bias', 'cur_adapter.7.up_proj.weight', 'cur_adapter.7.up_proj.bias', 'cur_adapter.8.down_proj.weight', 'cur_adapter.8.down_proj.bias', 'cur_adapter.8.up_proj.weight', 'cur_adapter.8.up_proj.bias', 'cur_adapter.9.down_proj.weight', 'cur_adapter.9.down_proj.bias', 'cur_adapter.9.up_proj.weight', 'cur_adapter.9.up_proj.bias', 'cur_adapter.10.down_proj.weight', 'cur_adapter.10.down_proj.bias', 'cur_adapter.10.up_proj.weight', 'cur_adapter.10.up_proj.bias', 'cur_adapter.11.down_proj.weight', 'cur_adapter.11.down_proj.bias', 'cur_adapter.11.up_proj.weight', 'cur_adapter.11.up_proj.bias'], unexpected_keys=[])
After BaseNet initialization.
2024-04-29 09:00:40,166 [trainer.py] => All params: 86988288
2024-04-29 09:00:40,167 [trainer.py] => Trainable params: 1189632
2024-04-29 09:00:40,174 [ease.py] => Learning on 0-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.569, Train_accy 69.08:   0%|          | 0/20 [02:03<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.569, Train_accy 69.08:   5%|▌         | 1/20 [02:03<39:10, 123.69s/it]Task 0, Epoch 2/20 => Loss 0.630, Train_accy 82.81:   5%|▌         | 1/20 [04:08<39:10, 123.69s/it]Task 0, Epoch 2/20 => Loss 0.630, Train_accy 82.81:  10%|█         | 2/20 [04:08<37:23, 124.63s/it]Task 0, Epoch 3/20 => Loss 0.587, Train_accy 83.82:  10%|█         | 2/20 [06:13<37:23, 124.63s/it]Task 0, Epoch 3/20 => Loss 0.587, Train_accy 83.82:  15%|█▌        | 3/20 [06:13<35:16, 124.51s/it]Task 0, Epoch 4/20 => Loss 0.560, Train_accy 84.50:  15%|█▌        | 3/20 [08:17<35:16, 124.51s/it]Task 0, Epoch 4/20 => Loss 0.560, Train_accy 84.50:  20%|██        | 4/20 [08:17<33:11, 124.49s/it]Task 0, Epoch 5/20 => Loss 0.557, Train_accy 84.50:  20%|██        | 4/20 [10:22<33:11, 124.49s/it]Task 0, Epoch 5/20 => Loss 0.557, Train_accy 84.50:  25%|██▌       | 5/20 [10:22<31:10, 124.68s/it]Task 0, Epoch 6/20 => Loss 0.549, Train_accy 84.70:  25%|██▌       | 5/20 [12:27<31:10, 124.68s/it]Task 0, Epoch 6/20 => Loss 0.549, Train_accy 84.70:  30%|███       | 6/20 [12:27<29:05, 124.65s/it]Task 0, Epoch 7/20 => Loss 0.540, Train_accy 84.82:  30%|███       | 6/20 [14:30<29:05, 124.65s/it]Task 0, Epoch 7/20 => Loss 0.540, Train_accy 84.82:  35%|███▌      | 7/20 [14:30<26:54, 124.22s/it]Task 0, Epoch 8/20 => Loss 0.514, Train_accy 85.52:  35%|███▌      | 7/20 [16:33<26:54, 124.22s/it]Task 0, Epoch 8/20 => Loss 0.514, Train_accy 85.52:  40%|████      | 8/20 [16:33<24:46, 123.90s/it]Task 0, Epoch 9/20 => Loss 0.507, Train_accy 85.64:  40%|████      | 8/20 [18:37<24:46, 123.90s/it]Task 0, Epoch 9/20 => Loss 0.507, Train_accy 85.64:  45%|████▌     | 9/20 [18:37<22:40, 123.71s/it]Task 0, Epoch 10/20 => Loss 0.509, Train_accy 85.71:  45%|████▌     | 9/20 [20:40<22:40, 123.71s/it]Task 0, Epoch 10/20 => Loss 0.509, Train_accy 85.71:  50%|█████     | 10/20 [20:40<20:35, 123.59s/it]Task 0, Epoch 11/20 => Loss 0.498, Train_accy 86.17:  50%|█████     | 10/20 [22:43<20:35, 123.59s/it]Task 0, Epoch 11/20 => Loss 0.498, Train_accy 86.17:  55%|█████▌    | 11/20 [22:43<18:31, 123.47s/it]Task 0, Epoch 12/20 => Loss 0.498, Train_accy 86.12:  55%|█████▌    | 11/20 [24:46<18:31, 123.47s/it]Task 0, Epoch 12/20 => Loss 0.498, Train_accy 86.12:  60%|██████    | 12/20 [24:46<16:27, 123.39s/it]Task 0, Epoch 13/20 => Loss 0.492, Train_accy 86.20:  60%|██████    | 12/20 [26:50<16:27, 123.39s/it]Task 0, Epoch 13/20 => Loss 0.492, Train_accy 86.20:  65%|██████▌   | 13/20 [26:50<14:23, 123.40s/it]Task 0, Epoch 14/20 => Loss 0.484, Train_accy 86.34:  65%|██████▌   | 13/20 [28:53<14:23, 123.40s/it]Task 0, Epoch 14/20 => Loss 0.484, Train_accy 86.34:  70%|███████   | 14/20 [28:53<12:20, 123.38s/it]Task 0, Epoch 15/20 => Loss 0.470, Train_accy 86.66:  70%|███████   | 14/20 [30:57<12:20, 123.38s/it]Task 0, Epoch 15/20 => Loss 0.470, Train_accy 86.66:  75%|███████▌  | 15/20 [30:57<10:16, 123.38s/it]Task 0, Epoch 16/20 => Loss 0.463, Train_accy 86.80:  75%|███████▌  | 15/20 [33:00<10:16, 123.38s/it]Task 0, Epoch 16/20 => Loss 0.463, Train_accy 86.80:  80%|████████  | 16/20 [33:00<08:13, 123.48s/it]Task 0, Epoch 17/20 => Loss 0.466, Train_accy 86.78:  80%|████████  | 16/20 [35:04<08:13, 123.48s/it]Task 0, Epoch 17/20 => Loss 0.466, Train_accy 86.78:  85%|████████▌ | 17/20 [35:04<06:10, 123.46s/it]Task 0, Epoch 18/20 => Loss 0.467, Train_accy 86.62:  85%|████████▌ | 17/20 [37:07<06:10, 123.46s/it]Task 0, Epoch 18/20 => Loss 0.467, Train_accy 86.62:  90%|█████████ | 18/20 [37:07<04:06, 123.48s/it]Task 0, Epoch 19/20 => Loss 0.473, Train_accy 86.54:  90%|█████████ | 18/20 [39:11<04:06, 123.48s/it]Task 0, Epoch 19/20 => Loss 0.473, Train_accy 86.54:  95%|█████████▌| 19/20 [39:11<02:03, 123.46s/it]Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.02:  95%|█████████▌| 19/20 [41:14<02:03, 123.46s/it]Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.02: 100%|██████████| 20/20 [41:14<00:00, 123.49s/it]Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.02: 100%|██████████| 20/20 [41:14<00:00, 123.74s/it]
2024-04-29 09:41:55,015 [ease.py] => Task 0, Epoch 20/20 => Loss 0.460, Train_accy 87.02
2024-04-29 09:43:12,720 [ease.py] => Task correct: 95.48
2024-04-29 09:43:12,720 [ease.py] => Task acc: 97.94
2024-04-29 09:43:12,766 [trainer.py] => No NME accuracy.
2024-04-29 09:43:12,766 [trainer.py] => CNN: {'total': 94.8, '00-49': 94.8, 'old': 0, 'new': 94.8}
2024-04-29 09:43:12,767 [trainer.py] => CNN top1 curve: [94.8]
2024-04-29 09:43:12,767 [trainer.py] => CNN top5 curve: [99.62]

Average Accuracy (CNN): 94.8
2024-04-29 09:43:12,767 [trainer.py] => Average Accuracy (CNN): 94.8 

2024-04-29 09:43:12,767 [trainer.py] => Train Time: 4949.51
2024-04-29 09:43:12,767 [trainer.py] => Test Time: 13.41 

2024-04-29 09:43:12,768 [trainer.py] => All params: 87065090
2024-04-29 09:43:12,768 [trainer.py] => Trainable params: 1189632
2024-04-29 09:43:12,770 [ease.py] => Learning on 50-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.602, Train_accy 74.50:   0%|          | 0/20 [00:25<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.602, Train_accy 74.50:   5%|▌         | 1/20 [00:25<07:57, 25.12s/it]Task 1, Epoch 2/20 => Loss 0.470, Train_accy 89.06:   5%|▌         | 1/20 [00:50<07:57, 25.12s/it]Task 1, Epoch 2/20 => Loss 0.470, Train_accy 89.06:  10%|█         | 2/20 [00:50<07:31, 25.09s/it]Task 1, Epoch 3/20 => Loss 0.316, Train_accy 91.10:  10%|█         | 2/20 [01:15<07:31, 25.09s/it]Task 1, Epoch 3/20 => Loss 0.316, Train_accy 91.10:  15%|█▌        | 3/20 [01:15<07:05, 25.04s/it]Task 1, Epoch 4/20 => Loss 0.273, Train_accy 91.94:  15%|█▌        | 3/20 [01:40<07:05, 25.04s/it]Task 1, Epoch 4/20 => Loss 0.273, Train_accy 91.94:  20%|██        | 4/20 [01:40<06:40, 25.05s/it]Task 1, Epoch 5/20 => Loss 0.240, Train_accy 92.52:  20%|██        | 4/20 [02:05<06:40, 25.05s/it]Task 1, Epoch 5/20 => Loss 0.240, Train_accy 92.52:  25%|██▌       | 5/20 [02:05<06:15, 25.02s/it]Task 1, Epoch 6/20 => Loss 0.233, Train_accy 93.02:  25%|██▌       | 5/20 [02:30<06:15, 25.02s/it]Task 1, Epoch 6/20 => Loss 0.233, Train_accy 93.02:  30%|███       | 6/20 [02:30<05:49, 24.99s/it]Task 1, Epoch 7/20 => Loss 0.248, Train_accy 91.70:  30%|███       | 6/20 [02:55<05:49, 24.99s/it]Task 1, Epoch 7/20 => Loss 0.248, Train_accy 91.70:  35%|███▌      | 7/20 [02:55<05:24, 24.98s/it]Task 1, Epoch 8/20 => Loss 0.232, Train_accy 92.42:  35%|███▌      | 7/20 [03:20<05:24, 24.98s/it]Task 1, Epoch 8/20 => Loss 0.232, Train_accy 92.42:  40%|████      | 8/20 [03:20<05:00, 25.00s/it]Task 1, Epoch 9/20 => Loss 0.224, Train_accy 92.76:  40%|████      | 8/20 [03:45<05:00, 25.00s/it]Task 1, Epoch 9/20 => Loss 0.224, Train_accy 92.76:  45%|████▌     | 9/20 [03:45<04:35, 25.04s/it]Task 1, Epoch 10/20 => Loss 0.221, Train_accy 93.26:  45%|████▌     | 9/20 [04:10<04:35, 25.04s/it]Task 1, Epoch 10/20 => Loss 0.221, Train_accy 93.26:  50%|█████     | 10/20 [04:10<04:10, 25.06s/it]Task 1, Epoch 11/20 => Loss 0.221, Train_accy 92.88:  50%|█████     | 10/20 [04:35<04:10, 25.06s/it]Task 1, Epoch 11/20 => Loss 0.221, Train_accy 92.88:  55%|█████▌    | 11/20 [04:35<03:45, 25.05s/it]Task 1, Epoch 12/20 => Loss 0.218, Train_accy 93.10:  55%|█████▌    | 11/20 [05:00<03:45, 25.05s/it]Task 1, Epoch 12/20 => Loss 0.218, Train_accy 93.10:  60%|██████    | 12/20 [05:00<03:20, 25.04s/it]Task 1, Epoch 13/20 => Loss 0.218, Train_accy 93.32:  60%|██████    | 12/20 [05:25<03:20, 25.04s/it]Task 1, Epoch 13/20 => Loss 0.218, Train_accy 93.32:  65%|██████▌   | 13/20 [05:25<02:55, 25.03s/it]Task 1, Epoch 14/20 => Loss 0.203, Train_accy 93.68:  65%|██████▌   | 13/20 [05:50<02:55, 25.03s/it]Task 1, Epoch 14/20 => Loss 0.203, Train_accy 93.68:  70%|███████   | 14/20 [05:50<02:30, 25.04s/it]Task 1, Epoch 15/20 => Loss 0.203, Train_accy 93.60:  70%|███████   | 14/20 [06:15<02:30, 25.04s/it]Task 1, Epoch 15/20 => Loss 0.203, Train_accy 93.60:  75%|███████▌  | 15/20 [06:15<02:05, 25.04s/it]Task 1, Epoch 16/20 => Loss 0.196, Train_accy 93.80:  75%|███████▌  | 15/20 [06:40<02:05, 25.04s/it]Task 1, Epoch 16/20 => Loss 0.196, Train_accy 93.80:  80%|████████  | 16/20 [06:40<01:40, 25.05s/it]Task 1, Epoch 17/20 => Loss 0.203, Train_accy 93.52:  80%|████████  | 16/20 [07:05<01:40, 25.05s/it]Task 1, Epoch 17/20 => Loss 0.203, Train_accy 93.52:  85%|████████▌ | 17/20 [07:05<01:15, 25.05s/it]Task 1, Epoch 18/20 => Loss 0.186, Train_accy 93.90:  85%|████████▌ | 17/20 [07:30<01:15, 25.05s/it]Task 1, Epoch 18/20 => Loss 0.186, Train_accy 93.90:  90%|█████████ | 18/20 [07:30<00:50, 25.05s/it]Task 1, Epoch 19/20 => Loss 0.196, Train_accy 93.96:  90%|█████████ | 18/20 [07:55<00:50, 25.05s/it]Task 1, Epoch 19/20 => Loss 0.196, Train_accy 93.96:  95%|█████████▌| 19/20 [07:55<00:25, 25.03s/it]Task 1, Epoch 20/20 => Loss 0.186, Train_accy 93.96:  95%|█████████▌| 19/20 [08:20<00:25, 25.03s/it]Task 1, Epoch 20/20 => Loss 0.186, Train_accy 93.96: 100%|██████████| 20/20 [08:20<00:00, 25.05s/it]Task 1, Epoch 20/20 => Loss 0.186, Train_accy 93.96: 100%|██████████| 20/20 [08:20<00:00, 25.04s/it]
2024-04-29 09:51:33,627 [ease.py] => Task 1, Epoch 20/20 => Loss 0.186, Train_accy 93.96
2024-04-29 09:52:30,482 [ease.py] => Task correct: 92.83333333333333
2024-04-29 09:52:30,483 [ease.py] => Task acc: 98.1
2024-04-29 09:52:30,653 [trainer.py] => No NME accuracy.
2024-04-29 09:52:30,653 [trainer.py] => CNN: {'total': 92.28, '00-49': 91.26, '50-59': 97.4, 'old': 91.26, 'new': 97.4}
2024-04-29 09:52:30,653 [trainer.py] => CNN top1 curve: [94.8, 92.28]
2024-04-29 09:52:30,653 [trainer.py] => CNN top5 curve: [99.62, 99.52]

Average Accuracy (CNN): 93.54
2024-04-29 09:52:30,653 [trainer.py] => Average Accuracy (CNN): 93.54 

2024-04-29 09:52:30,653 [trainer.py] => Train Time: 5951.050000000001
2024-04-29 09:52:30,653 [trainer.py] => Test Time: 43.55 

2024-04-29 09:52:30,654 [trainer.py] => All params: 87088130
2024-04-29 09:52:30,656 [trainer.py] => Trainable params: 1189632
2024-04-29 09:52:30,659 [ease.py] => Learning on 60-70
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.509, Train_accy 77.40:   0%|          | 0/20 [00:24<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.509, Train_accy 77.40:   5%|▌         | 1/20 [00:24<07:54, 24.96s/it]Task 2, Epoch 2/20 => Loss 0.372, Train_accy 91.92:   5%|▌         | 1/20 [00:50<07:54, 24.96s/it]Task 2, Epoch 2/20 => Loss 0.372, Train_accy 91.92:  10%|█         | 2/20 [00:50<07:30, 25.02s/it]Task 2, Epoch 3/20 => Loss 0.246, Train_accy 93.78:  10%|█         | 2/20 [01:15<07:30, 25.02s/it]Task 2, Epoch 3/20 => Loss 0.246, Train_accy 93.78:  15%|█▌        | 3/20 [01:15<07:05, 25.00s/it]Task 2, Epoch 4/20 => Loss 0.225, Train_accy 93.38:  15%|█▌        | 3/20 [01:39<07:05, 25.00s/it]Task 2, Epoch 4/20 => Loss 0.225, Train_accy 93.38:  20%|██        | 4/20 [01:39<06:39, 24.99s/it]Task 2, Epoch 5/20 => Loss 0.213, Train_accy 93.82:  20%|██        | 4/20 [02:04<06:39, 24.99s/it]Task 2, Epoch 5/20 => Loss 0.213, Train_accy 93.82:  25%|██▌       | 5/20 [02:04<06:14, 24.98s/it]Task 2, Epoch 6/20 => Loss 0.188, Train_accy 94.58:  25%|██▌       | 5/20 [02:29<06:14, 24.98s/it]Task 2, Epoch 6/20 => Loss 0.188, Train_accy 94.58:  30%|███       | 6/20 [02:29<05:49, 24.97s/it]Task 2, Epoch 7/20 => Loss 0.183, Train_accy 94.48:  30%|███       | 6/20 [02:54<05:49, 24.97s/it]Task 2, Epoch 7/20 => Loss 0.183, Train_accy 94.48:  35%|███▌      | 7/20 [02:54<05:24, 24.97s/it]Task 2, Epoch 8/20 => Loss 0.207, Train_accy 93.96:  35%|███▌      | 7/20 [03:20<05:24, 24.97s/it]Task 2, Epoch 8/20 => Loss 0.207, Train_accy 93.96:  40%|████      | 8/20 [03:20<05:00, 25.03s/it]Task 2, Epoch 9/20 => Loss 0.171, Train_accy 94.84:  40%|████      | 8/20 [03:45<05:00, 25.03s/it]Task 2, Epoch 9/20 => Loss 0.171, Train_accy 94.84:  45%|████▌     | 9/20 [03:45<04:35, 25.04s/it]Task 2, Epoch 10/20 => Loss 0.160, Train_accy 95.22:  45%|████▌     | 9/20 [04:10<04:35, 25.04s/it]Task 2, Epoch 10/20 => Loss 0.160, Train_accy 95.22:  50%|█████     | 10/20 [04:10<04:10, 25.09s/it]Task 2, Epoch 11/20 => Loss 0.151, Train_accy 95.24:  50%|█████     | 10/20 [04:35<04:10, 25.09s/it]Task 2, Epoch 11/20 => Loss 0.151, Train_accy 95.24:  55%|█████▌    | 11/20 [04:35<03:45, 25.06s/it]Task 2, Epoch 12/20 => Loss 0.168, Train_accy 95.02:  55%|█████▌    | 11/20 [05:00<03:45, 25.06s/it]Task 2, Epoch 12/20 => Loss 0.168, Train_accy 95.02:  60%|██████    | 12/20 [05:00<03:20, 25.06s/it]Task 2, Epoch 13/20 => Loss 0.160, Train_accy 95.42:  60%|██████    | 12/20 [05:25<03:20, 25.06s/it]Task 2, Epoch 13/20 => Loss 0.160, Train_accy 95.42:  65%|██████▌   | 13/20 [05:25<02:55, 25.02s/it]Task 2, Epoch 14/20 => Loss 0.159, Train_accy 94.68:  65%|██████▌   | 13/20 [05:50<02:55, 25.02s/it]Task 2, Epoch 14/20 => Loss 0.159, Train_accy 94.68:  70%|███████   | 14/20 [05:50<02:29, 24.99s/it]Task 2, Epoch 15/20 => Loss 0.164, Train_accy 95.22:  70%|███████   | 14/20 [06:15<02:29, 24.99s/it]Task 2, Epoch 15/20 => Loss 0.164, Train_accy 95.22:  75%|███████▌  | 15/20 [06:15<02:04, 24.97s/it]Task 2, Epoch 16/20 => Loss 0.160, Train_accy 95.30:  75%|███████▌  | 15/20 [06:40<02:04, 24.97s/it]Task 2, Epoch 16/20 => Loss 0.160, Train_accy 95.30:  80%|████████  | 16/20 [06:40<01:39, 24.98s/it]Task 2, Epoch 17/20 => Loss 0.154, Train_accy 95.54:  80%|████████  | 16/20 [07:05<01:39, 24.98s/it]Task 2, Epoch 17/20 => Loss 0.154, Train_accy 95.54:  85%|████████▌ | 17/20 [07:05<01:14, 24.97s/it]Task 2, Epoch 18/20 => Loss 0.148, Train_accy 95.68:  85%|████████▌ | 17/20 [07:30<01:14, 24.97s/it]Task 2, Epoch 18/20 => Loss 0.148, Train_accy 95.68:  90%|█████████ | 18/20 [07:30<00:49, 24.99s/it]Task 2, Epoch 19/20 => Loss 0.161, Train_accy 95.14:  90%|█████████ | 18/20 [07:55<00:49, 24.99s/it]Task 2, Epoch 19/20 => Loss 0.161, Train_accy 95.14:  95%|█████████▌| 19/20 [07:55<00:24, 24.97s/it]Task 2, Epoch 20/20 => Loss 0.147, Train_accy 95.72:  95%|█████████▌| 19/20 [08:20<00:24, 24.97s/it]Task 2, Epoch 20/20 => Loss 0.147, Train_accy 95.72: 100%|██████████| 20/20 [08:20<00:00, 25.00s/it]Task 2, Epoch 20/20 => Loss 0.147, Train_accy 95.72: 100%|██████████| 20/20 [08:20<00:00, 25.01s/it]
2024-04-29 10:00:50,819 [ease.py] => Task 2, Epoch 20/20 => Loss 0.147, Train_accy 95.72
2024-04-29 10:02:21,970 [ease.py] => Task correct: 91.91428571428571
2024-04-29 10:02:21,971 [ease.py] => Task acc: 98.24285714285715
2024-04-29 10:02:22,012 [trainer.py] => No NME accuracy.
2024-04-29 10:02:22,012 [trainer.py] => CNN: {'total': 91.43, '00-49': 89.76, '50-59': 95.8, '60-69': 95.4, 'old': 90.77, 'new': 95.4}
2024-04-29 10:02:22,012 [trainer.py] => CNN top1 curve: [94.8, 92.28, 91.43]
2024-04-29 10:02:22,012 [trainer.py] => CNN top5 curve: [99.62, 99.52, 99.46]

Average Accuracy (CNN): 92.84
2024-04-29 10:02:22,012 [trainer.py] => Average Accuracy (CNN): 92.84 

2024-04-29 10:02:22,012 [trainer.py] => Train Time: 6951.260000000001
2024-04-29 10:02:22,013 [trainer.py] => Test Time: 95.09 

2024-04-29 10:02:22,013 [trainer.py] => All params: 87157250
2024-04-29 10:02:22,014 [trainer.py] => Trainable params: 1189632
2024-04-29 10:02:22,017 [ease.py] => Learning on 70-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.613, Train_accy 71.64:   0%|          | 0/20 [00:25<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.613, Train_accy 71.64:   5%|▌         | 1/20 [00:25<07:55, 25.05s/it]Task 3, Epoch 2/20 => Loss 0.496, Train_accy 87.46:   5%|▌         | 1/20 [00:50<07:55, 25.05s/it]Task 3, Epoch 2/20 => Loss 0.496, Train_accy 87.46:  10%|█         | 2/20 [00:50<07:29, 25.00s/it]Task 3, Epoch 3/20 => Loss 0.331, Train_accy 90.82:  10%|█         | 2/20 [01:15<07:29, 25.00s/it]Task 3, Epoch 3/20 => Loss 0.331, Train_accy 90.82:  15%|█▌        | 3/20 [01:15<07:05, 25.02s/it]Task 3, Epoch 4/20 => Loss 0.278, Train_accy 91.54:  15%|█▌        | 3/20 [01:40<07:05, 25.02s/it]Task 3, Epoch 4/20 => Loss 0.278, Train_accy 91.54:  20%|██        | 4/20 [01:40<06:40, 25.05s/it]Task 3, Epoch 5/20 => Loss 0.268, Train_accy 91.72:  20%|██        | 4/20 [02:05<06:40, 25.05s/it]Task 3, Epoch 5/20 => Loss 0.268, Train_accy 91.72:  25%|██▌       | 5/20 [02:05<06:15, 25.05s/it]Task 3, Epoch 6/20 => Loss 0.233, Train_accy 92.60:  25%|██▌       | 5/20 [02:30<06:15, 25.05s/it]Task 3, Epoch 6/20 => Loss 0.233, Train_accy 92.60:  30%|███       | 6/20 [02:30<05:50, 25.03s/it]Task 3, Epoch 7/20 => Loss 0.242, Train_accy 92.42:  30%|███       | 6/20 [02:55<05:50, 25.03s/it]Task 3, Epoch 7/20 => Loss 0.242, Train_accy 92.42:  35%|███▌      | 7/20 [02:55<05:25, 25.01s/it]Task 3, Epoch 8/20 => Loss 0.213, Train_accy 93.24:  35%|███▌      | 7/20 [03:20<05:25, 25.01s/it]Task 3, Epoch 8/20 => Loss 0.213, Train_accy 93.24:  40%|████      | 8/20 [03:20<04:59, 24.99s/it]Task 3, Epoch 9/20 => Loss 0.219, Train_accy 93.02:  40%|████      | 8/20 [03:45<04:59, 24.99s/it]Task 3, Epoch 9/20 => Loss 0.219, Train_accy 93.02:  45%|████▌     | 9/20 [03:45<04:34, 24.98s/it]Task 3, Epoch 10/20 => Loss 0.219, Train_accy 92.98:  45%|████▌     | 9/20 [04:10<04:34, 24.98s/it]Task 3, Epoch 10/20 => Loss 0.219, Train_accy 92.98:  50%|█████     | 10/20 [04:10<04:09, 24.98s/it]Task 3, Epoch 11/20 => Loss 0.207, Train_accy 93.44:  50%|█████     | 10/20 [04:35<04:09, 24.98s/it]Task 3, Epoch 11/20 => Loss 0.207, Train_accy 93.44:  55%|█████▌    | 11/20 [04:35<03:44, 24.99s/it]Task 3, Epoch 12/20 => Loss 0.213, Train_accy 93.56:  55%|█████▌    | 11/20 [05:00<03:44, 24.99s/it]Task 3, Epoch 12/20 => Loss 0.213, Train_accy 93.56:  60%|██████    | 12/20 [05:00<03:19, 25.00s/it]Task 3, Epoch 13/20 => Loss 0.203, Train_accy 93.64:  60%|██████    | 12/20 [05:25<03:19, 25.00s/it]Task 3, Epoch 13/20 => Loss 0.203, Train_accy 93.64:  65%|██████▌   | 13/20 [05:25<02:55, 25.03s/it]Task 3, Epoch 14/20 => Loss 0.196, Train_accy 93.70:  65%|██████▌   | 13/20 [05:50<02:55, 25.03s/it]Task 3, Epoch 14/20 => Loss 0.196, Train_accy 93.70:  70%|███████   | 14/20 [05:50<02:30, 25.01s/it]Task 3, Epoch 15/20 => Loss 0.194, Train_accy 93.72:  70%|███████   | 14/20 [06:15<02:30, 25.01s/it]Task 3, Epoch 15/20 => Loss 0.194, Train_accy 93.72:  75%|███████▌  | 15/20 [06:15<02:05, 25.01s/it]Task 3, Epoch 16/20 => Loss 0.213, Train_accy 93.26:  75%|███████▌  | 15/20 [06:40<02:05, 25.01s/it]Task 3, Epoch 16/20 => Loss 0.213, Train_accy 93.26:  80%|████████  | 16/20 [06:40<01:40, 25.00s/it]Task 3, Epoch 17/20 => Loss 0.191, Train_accy 93.86:  80%|████████  | 16/20 [07:05<01:40, 25.00s/it]Task 3, Epoch 17/20 => Loss 0.191, Train_accy 93.86:  85%|████████▌ | 17/20 [07:05<01:15, 25.00s/it]Task 3, Epoch 18/20 => Loss 0.190, Train_accy 94.26:  85%|████████▌ | 17/20 [07:30<01:15, 25.00s/it]Task 3, Epoch 18/20 => Loss 0.190, Train_accy 94.26:  90%|█████████ | 18/20 [07:30<00:50, 25.03s/it]Task 3, Epoch 19/20 => Loss 0.207, Train_accy 93.44:  90%|█████████ | 18/20 [07:55<00:50, 25.03s/it]Task 3, Epoch 19/20 => Loss 0.207, Train_accy 93.44:  95%|█████████▌| 19/20 [07:55<00:25, 25.04s/it]Task 3, Epoch 20/20 => Loss 0.197, Train_accy 93.90:  95%|█████████▌| 19/20 [08:20<00:25, 25.04s/it]Task 3, Epoch 20/20 => Loss 0.197, Train_accy 93.90: 100%|██████████| 20/20 [08:20<00:00, 25.07s/it]Task 3, Epoch 20/20 => Loss 0.197, Train_accy 93.90: 100%|██████████| 20/20 [08:20<00:00, 25.02s/it]
2024-04-29 10:10:42,501 [ease.py] => Task 3, Epoch 20/20 => Loss 0.197, Train_accy 93.90
2024-04-29 10:12:52,926 [ease.py] => Task correct: 89.4
2024-04-29 10:12:52,926 [ease.py] => Task acc: 98.1875
2024-04-29 10:12:52,964 [trainer.py] => No NME accuracy.
2024-04-29 10:12:52,964 [trainer.py] => CNN: {'total': 88.82, '00-49': 87.46, '50-59': 88.8, '60-69': 90.3, '70-79': 94.2, 'old': 88.06, 'new': 94.2}
2024-04-29 10:12:52,964 [trainer.py] => CNN top1 curve: [94.8, 92.28, 91.43, 88.82]
2024-04-29 10:12:52,965 [trainer.py] => CNN top5 curve: [99.62, 99.52, 99.46, 99.25]

Average Accuracy (CNN): 91.83
2024-04-29 10:12:52,965 [trainer.py] => Average Accuracy (CNN): 91.83 

2024-04-29 10:12:52,965 [trainer.py] => Train Time: 7952.120000000002
2024-04-29 10:12:52,965 [trainer.py] => Test Time: 172.62 

2024-04-29 10:12:52,966 [trainer.py] => All params: 87241730
2024-04-29 10:12:52,967 [trainer.py] => Trainable params: 1189632
2024-04-29 10:12:52,971 [ease.py] => Learning on 80-90
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.638, Train_accy 73.46:   0%|          | 0/20 [00:24<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.638, Train_accy 73.46:   5%|▌         | 1/20 [00:24<07:54, 24.98s/it]Task 4, Epoch 2/20 => Loss 0.464, Train_accy 90.38:   5%|▌         | 1/20 [00:49<07:54, 24.98s/it]Task 4, Epoch 2/20 => Loss 0.464, Train_accy 90.38:  10%|█         | 2/20 [00:49<07:29, 25.00s/it]Task 4, Epoch 3/20 => Loss 0.301, Train_accy 92.00:  10%|█         | 2/20 [01:15<07:29, 25.00s/it]Task 4, Epoch 3/20 => Loss 0.301, Train_accy 92.00:  15%|█▌        | 3/20 [01:15<07:05, 25.02s/it]Task 4, Epoch 4/20 => Loss 0.260, Train_accy 92.28:  15%|█▌        | 3/20 [01:39<07:05, 25.02s/it]Task 4, Epoch 4/20 => Loss 0.260, Train_accy 92.28:  20%|██        | 4/20 [01:39<06:39, 24.98s/it]Task 4, Epoch 5/20 => Loss 0.240, Train_accy 92.76:  20%|██        | 4/20 [02:04<06:39, 24.98s/it]Task 4, Epoch 5/20 => Loss 0.240, Train_accy 92.76:  25%|██▌       | 5/20 [02:04<06:14, 24.96s/it]Task 4, Epoch 6/20 => Loss 0.237, Train_accy 92.74:  25%|██▌       | 5/20 [02:29<06:14, 24.96s/it]Task 4, Epoch 6/20 => Loss 0.237, Train_accy 92.74:  30%|███       | 6/20 [02:29<05:49, 24.98s/it]Task 4, Epoch 7/20 => Loss 0.229, Train_accy 92.82:  30%|███       | 6/20 [02:54<05:49, 24.98s/it]Task 4, Epoch 7/20 => Loss 0.229, Train_accy 92.82:  35%|███▌      | 7/20 [02:54<05:24, 24.98s/it]Task 4, Epoch 8/20 => Loss 0.206, Train_accy 93.64:  35%|███▌      | 7/20 [03:19<05:24, 24.98s/it]Task 4, Epoch 8/20 => Loss 0.206, Train_accy 93.64:  40%|████      | 8/20 [03:19<04:59, 24.99s/it]Task 4, Epoch 9/20 => Loss 0.207, Train_accy 93.62:  40%|████      | 8/20 [03:44<04:59, 24.99s/it]Task 4, Epoch 9/20 => Loss 0.207, Train_accy 93.62:  45%|████▌     | 9/20 [03:44<04:34, 24.98s/it]Task 4, Epoch 10/20 => Loss 0.194, Train_accy 93.92:  45%|████▌     | 9/20 [04:09<04:34, 24.98s/it]Task 4, Epoch 10/20 => Loss 0.194, Train_accy 93.92:  50%|█████     | 10/20 [04:09<04:09, 24.99s/it]Task 4, Epoch 11/20 => Loss 0.196, Train_accy 93.50:  50%|█████     | 10/20 [04:35<04:09, 24.99s/it]Task 4, Epoch 11/20 => Loss 0.196, Train_accy 93.50:  55%|█████▌    | 11/20 [04:35<03:45, 25.04s/it]Task 4, Epoch 12/20 => Loss 0.199, Train_accy 93.34:  55%|█████▌    | 11/20 [05:00<03:45, 25.04s/it]Task 4, Epoch 12/20 => Loss 0.199, Train_accy 93.34:  60%|██████    | 12/20 [05:00<03:20, 25.06s/it]Task 4, Epoch 13/20 => Loss 0.193, Train_accy 94.18:  60%|██████    | 12/20 [05:25<03:20, 25.06s/it]Task 4, Epoch 13/20 => Loss 0.193, Train_accy 94.18:  65%|██████▌   | 13/20 [05:25<02:55, 25.06s/it]Task 4, Epoch 14/20 => Loss 0.180, Train_accy 94.60:  65%|██████▌   | 13/20 [05:50<02:55, 25.06s/it]Task 4, Epoch 14/20 => Loss 0.180, Train_accy 94.60:  70%|███████   | 14/20 [05:50<02:30, 25.09s/it]Task 4, Epoch 15/20 => Loss 0.184, Train_accy 94.46:  70%|███████   | 14/20 [06:15<02:30, 25.09s/it]Task 4, Epoch 15/20 => Loss 0.184, Train_accy 94.46:  75%|███████▌  | 15/20 [06:15<02:05, 25.08s/it]Task 4, Epoch 16/20 => Loss 0.178, Train_accy 94.54:  75%|███████▌  | 15/20 [06:40<02:05, 25.08s/it]Task 4, Epoch 16/20 => Loss 0.178, Train_accy 94.54:  80%|████████  | 16/20 [06:40<01:40, 25.06s/it]Task 4, Epoch 17/20 => Loss 0.181, Train_accy 94.24:  80%|████████  | 16/20 [07:05<01:40, 25.06s/it]Task 4, Epoch 17/20 => Loss 0.181, Train_accy 94.24:  85%|████████▌ | 17/20 [07:05<01:15, 25.06s/it]Task 4, Epoch 18/20 => Loss 0.180, Train_accy 94.28:  85%|████████▌ | 17/20 [07:30<01:15, 25.06s/it]Task 4, Epoch 18/20 => Loss 0.180, Train_accy 94.28:  90%|█████████ | 18/20 [07:30<00:50, 25.10s/it]Task 4, Epoch 19/20 => Loss 0.190, Train_accy 93.98:  90%|█████████ | 18/20 [07:55<00:50, 25.10s/it]Task 4, Epoch 19/20 => Loss 0.190, Train_accy 93.98:  95%|█████████▌| 19/20 [07:55<00:25, 25.11s/it]Task 4, Epoch 20/20 => Loss 0.187, Train_accy 94.20:  95%|█████████▌| 19/20 [08:20<00:25, 25.11s/it]Task 4, Epoch 20/20 => Loss 0.187, Train_accy 94.20: 100%|██████████| 20/20 [08:20<00:00, 25.12s/it]Task 4, Epoch 20/20 => Loss 0.187, Train_accy 94.20: 100%|██████████| 20/20 [08:20<00:00, 25.05s/it]
2024-04-29 10:21:13,953 [ease.py] => Task 4, Epoch 20/20 => Loss 0.187, Train_accy 94.20
2024-04-29 10:24:09,264 [ease.py] => Task correct: 88.35555555555555
2024-04-29 10:24:09,265 [ease.py] => Task acc: 98.24444444444444
2024-04-29 10:24:09,301 [trainer.py] => No NME accuracy.
2024-04-29 10:24:09,301 [trainer.py] => CNN: {'total': 87.83, '00-49': 85.4, '50-59': 87.6, '60-69': 88.8, '70-79': 92.7, '80-89': 94.4, 'old': 87.01, 'new': 94.4}
2024-04-29 10:24:09,301 [trainer.py] => CNN top1 curve: [94.8, 92.28, 91.43, 88.82, 87.83]
2024-04-29 10:24:09,301 [trainer.py] => CNN top5 curve: [99.62, 99.52, 99.46, 99.25, 99.14]

Average Accuracy (CNN): 91.03
2024-04-29 10:24:09,301 [trainer.py] => Average Accuracy (CNN): 91.03 

2024-04-29 10:24:09,301 [trainer.py] => Train Time: 8953.970000000001
2024-04-29 10:24:09,301 [trainer.py] => Test Time: 281.49 

2024-04-29 10:24:09,302 [trainer.py] => All params: 87341570
2024-04-29 10:24:09,303 [trainer.py] => Trainable params: 1189632
2024-04-29 10:24:09,307 [ease.py] => Learning on 90-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.610, Train_accy 71.64:   0%|          | 0/20 [00:25<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.610, Train_accy 71.64:   5%|▌         | 1/20 [00:25<07:55, 25.03s/it]Task 5, Epoch 2/20 => Loss 0.495, Train_accy 87.52:   5%|▌         | 1/20 [00:50<07:55, 25.03s/it]Task 5, Epoch 2/20 => Loss 0.495, Train_accy 87.52:  10%|█         | 2/20 [00:50<07:30, 25.04s/it]Task 5, Epoch 3/20 => Loss 0.347, Train_accy 90.16:  10%|█         | 2/20 [01:15<07:30, 25.04s/it]Task 5, Epoch 3/20 => Loss 0.347, Train_accy 90.16:  15%|█▌        | 3/20 [01:15<07:05, 25.04s/it]Task 5, Epoch 4/20 => Loss 0.283, Train_accy 91.40:  15%|█▌        | 3/20 [01:40<07:05, 25.04s/it]Task 5, Epoch 4/20 => Loss 0.283, Train_accy 91.40:  20%|██        | 4/20 [01:40<06:40, 25.03s/it]Task 5, Epoch 5/20 => Loss 0.279, Train_accy 91.38:  20%|██        | 4/20 [02:05<06:40, 25.03s/it]Task 5, Epoch 5/20 => Loss 0.279, Train_accy 91.38:  25%|██▌       | 5/20 [02:05<06:15, 25.04s/it]Task 5, Epoch 6/20 => Loss 0.257, Train_accy 91.68:  25%|██▌       | 5/20 [02:30<06:15, 25.04s/it]Task 5, Epoch 6/20 => Loss 0.257, Train_accy 91.68:  30%|███       | 6/20 [02:30<05:50, 25.07s/it]Task 5, Epoch 7/20 => Loss 0.245, Train_accy 92.00:  30%|███       | 6/20 [02:55<05:50, 25.07s/it]Task 5, Epoch 7/20 => Loss 0.245, Train_accy 92.00:  35%|███▌      | 7/20 [02:55<05:25, 25.06s/it]Task 5, Epoch 8/20 => Loss 0.255, Train_accy 92.18:  35%|███▌      | 7/20 [03:20<05:25, 25.06s/it]Task 5, Epoch 8/20 => Loss 0.255, Train_accy 92.18:  40%|████      | 8/20 [03:20<05:00, 25.05s/it]Task 5, Epoch 9/20 => Loss 0.236, Train_accy 92.48:  40%|████      | 8/20 [03:45<05:00, 25.05s/it]Task 5, Epoch 9/20 => Loss 0.236, Train_accy 92.48:  45%|████▌     | 9/20 [03:45<04:35, 25.04s/it]Task 5, Epoch 10/20 => Loss 0.224, Train_accy 92.78:  45%|████▌     | 9/20 [04:10<04:35, 25.04s/it]Task 5, Epoch 10/20 => Loss 0.224, Train_accy 92.78:  50%|█████     | 10/20 [04:10<04:10, 25.03s/it]Task 5, Epoch 11/20 => Loss 0.236, Train_accy 92.52:  50%|█████     | 10/20 [04:35<04:10, 25.03s/it]Task 5, Epoch 11/20 => Loss 0.236, Train_accy 92.52:  55%|█████▌    | 11/20 [04:35<03:45, 25.02s/it]Task 5, Epoch 12/20 => Loss 0.224, Train_accy 92.96:  55%|█████▌    | 11/20 [05:00<03:45, 25.02s/it]Task 5, Epoch 12/20 => Loss 0.224, Train_accy 92.96:  60%|██████    | 12/20 [05:00<03:20, 25.02s/it]Task 5, Epoch 13/20 => Loss 0.211, Train_accy 93.48:  60%|██████    | 12/20 [05:25<03:20, 25.02s/it]Task 5, Epoch 13/20 => Loss 0.211, Train_accy 93.48:  65%|██████▌   | 13/20 [05:25<02:55, 25.03s/it]Task 5, Epoch 14/20 => Loss 0.208, Train_accy 93.16:  65%|██████▌   | 13/20 [05:50<02:55, 25.03s/it]Task 5, Epoch 14/20 => Loss 0.208, Train_accy 93.16:  70%|███████   | 14/20 [05:50<02:30, 25.03s/it]Task 5, Epoch 15/20 => Loss 0.213, Train_accy 93.20:  70%|███████   | 14/20 [06:15<02:30, 25.03s/it]Task 5, Epoch 15/20 => Loss 0.213, Train_accy 93.20:  75%|███████▌  | 15/20 [06:15<02:05, 25.02s/it]Task 5, Epoch 16/20 => Loss 0.212, Train_accy 93.06:  75%|███████▌  | 15/20 [06:40<02:05, 25.02s/it]Task 5, Epoch 16/20 => Loss 0.212, Train_accy 93.06:  80%|████████  | 16/20 [06:40<01:40, 25.07s/it]Task 5, Epoch 17/20 => Loss 0.211, Train_accy 93.32:  80%|████████  | 16/20 [07:05<01:40, 25.07s/it]Task 5, Epoch 17/20 => Loss 0.211, Train_accy 93.32:  85%|████████▌ | 17/20 [07:05<01:15, 25.08s/it]Task 5, Epoch 18/20 => Loss 0.196, Train_accy 94.08:  85%|████████▌ | 17/20 [07:30<01:15, 25.08s/it]Task 5, Epoch 18/20 => Loss 0.196, Train_accy 94.08:  90%|█████████ | 18/20 [07:30<00:50, 25.07s/it]Task 5, Epoch 19/20 => Loss 0.182, Train_accy 94.02:  90%|█████████ | 18/20 [07:55<00:50, 25.07s/it]Task 5, Epoch 19/20 => Loss 0.182, Train_accy 94.02:  95%|█████████▌| 19/20 [07:55<00:25, 25.06s/it]Task 5, Epoch 20/20 => Loss 0.209, Train_accy 93.12:  95%|█████████▌| 19/20 [08:20<00:25, 25.06s/it]Task 5, Epoch 20/20 => Loss 0.209, Train_accy 93.12: 100%|██████████| 20/20 [08:20<00:00, 25.07s/it]Task 5, Epoch 20/20 => Loss 0.209, Train_accy 93.12: 100%|██████████| 20/20 [08:20<00:00, 25.05s/it]
2024-04-29 10:32:30,332 [ease.py] => Task 5, Epoch 20/20 => Loss 0.209, Train_accy 93.12
2024-04-29 10:36:14,210 [ease.py] => Task correct: 88.0
2024-04-29 10:36:14,210 [ease.py] => Task acc: 98.22
2024-04-29 10:36:14,254 [trainer.py] => No NME accuracy.
2024-04-29 10:36:14,254 [trainer.py] => CNN: {'total': 87.46, '00-49': 84.32, '50-59': 86.7, '60-69': 88.6, '70-79': 91.5, '80-89': 93.8, '90-99': 92.4, 'old': 86.91, 'new': 92.4}
2024-04-29 10:36:14,254 [trainer.py] => CNN top1 curve: [94.8, 92.28, 91.43, 88.82, 87.83, 87.46]
2024-04-29 10:36:14,254 [trainer.py] => CNN top5 curve: [99.62, 99.52, 99.46, 99.25, 99.14, 98.94]

Average Accuracy (CNN): 90.44
2024-04-29 10:36:14,254 [trainer.py] => Average Accuracy (CNN): 90.44 

2024-04-29 10:36:14,255 [trainer.py] => Train Time: 9955.91
2024-04-29 10:36:14,255 [trainer.py] => Test Time: 425.57000000000005 

Accuracy Matrix (CNN):
[[94.8  91.26 89.76 87.46 85.4  84.32]
 [ 0.   97.4  95.8  88.8  87.6  86.7 ]
 [ 0.    0.   95.4  90.3  88.8  88.6 ]
 [ 0.    0.    0.   94.2  92.7  91.5 ]
 [ 0.    0.    0.    0.   94.4  93.8 ]
 [ 0.    0.    0.    0.    0.   92.4 ]]
2024-04-29 10:36:14,256 [trainer.py] => Forgetting (CNN): 6.256000000000006

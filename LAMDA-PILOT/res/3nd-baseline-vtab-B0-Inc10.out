nohup: 忽略输入
2024-05-09 22:11:37,060 [trainer.py] => config: ./exps/finetune_vtab_B0_Inc10.json
2024-05-09 22:11:37,060 [trainer.py] => prefix: reproduce
2024-05-09 22:11:37,060 [trainer.py] => dataset: vtab
2024-05-09 22:11:37,060 [trainer.py] => memory_size: 0
2024-05-09 22:11:37,060 [trainer.py] => memory_per_class: 0
2024-05-09 22:11:37,061 [trainer.py] => fixed_memory: False
2024-05-09 22:11:37,061 [trainer.py] => shuffle: True
2024-05-09 22:11:37,061 [trainer.py] => init_cls: 5
2024-05-09 22:11:37,061 [trainer.py] => increment: 5
2024-05-09 22:11:37,061 [trainer.py] => model_name: finetune
2024-05-09 22:11:37,061 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-05-09 22:11:37,061 [trainer.py] => device: [device(type='cuda', index=4)]
2024-05-09 22:11:37,061 [trainer.py] => seed: 1993
2024-05-09 22:11:37,061 [trainer.py] => init_epoch: 20
2024-05-09 22:11:37,061 [trainer.py] => init_lr: 0.001
2024-05-09 22:11:37,061 [trainer.py] => init_milestones: [60, 120, 170]
2024-05-09 22:11:37,061 [trainer.py] => init_lr_decay: 0.1
2024-05-09 22:11:37,061 [trainer.py] => init_weight_decay: 0.0005
2024-05-09 22:11:37,061 [trainer.py] => epochs: 20
2024-05-09 22:11:37,061 [trainer.py] => lrate: 0.001
2024-05-09 22:11:37,061 [trainer.py] => milestones: [40, 70]
2024-05-09 22:11:37,061 [trainer.py] => lrate_decay: 0.1
2024-05-09 22:11:37,061 [trainer.py] => batch_size: 48
2024-05-09 22:11:37,061 [trainer.py] => weight_decay: 0.0002
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-05-09 22:11:37,089 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-05-09 22:11:39,966 [trainer.py] => All params: 85798656
2024-05-09 22:11:39,967 [trainer.py] => Trainable params: 85798656
2024-05-09 22:11:39,967 [finetune.py] => Learning on 0-5
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.571, Train_accy 26.37, Test_accy 50.35:   0%|          | 0/20 [00:02<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.571, Train_accy 26.37, Test_accy 50.35:   5%|▌         | 1/20 [00:02<00:50,  2.64s/it]Task 0, Epoch 2/20 => Loss 1.124, Train_accy 50.55:   5%|▌         | 1/20 [00:03<00:50,  2.64s/it]                 Task 0, Epoch 2/20 => Loss 1.124, Train_accy 50.55:  10%|█         | 2/20 [00:03<00:29,  1.67s/it]Task 0, Epoch 3/20 => Loss 0.451, Train_accy 91.21:  10%|█         | 2/20 [00:04<00:29,  1.67s/it]Task 0, Epoch 3/20 => Loss 0.451, Train_accy 91.21:  15%|█▌        | 3/20 [00:04<00:23,  1.36s/it]Task 0, Epoch 4/20 => Loss 0.133, Train_accy 94.51:  15%|█▌        | 3/20 [00:05<00:23,  1.36s/it]Task 0, Epoch 4/20 => Loss 0.133, Train_accy 94.51:  20%|██        | 4/20 [00:05<00:18,  1.18s/it]Task 0, Epoch 5/20 => Loss 0.071, Train_accy 98.90:  20%|██        | 4/20 [00:06<00:18,  1.18s/it]Task 0, Epoch 5/20 => Loss 0.071, Train_accy 98.90:  25%|██▌       | 5/20 [00:06<00:16,  1.09s/it]Task 0, Epoch 6/20 => Loss 0.057, Train_accy 97.80, Test_accy 96.85:  25%|██▌       | 5/20 [00:08<00:16,  1.09s/it]Task 0, Epoch 6/20 => Loss 0.057, Train_accy 97.80, Test_accy 96.85:  30%|███       | 6/20 [00:08<00:20,  1.44s/it]Task 0, Epoch 7/20 => Loss 0.121, Train_accy 96.70:  30%|███       | 6/20 [00:09<00:20,  1.44s/it]                 Task 0, Epoch 7/20 => Loss 0.121, Train_accy 96.70:  35%|███▌      | 7/20 [00:09<00:16,  1.30s/it]Task 0, Epoch 8/20 => Loss 0.125, Train_accy 97.80:  35%|███▌      | 7/20 [00:10<00:16,  1.30s/it]Task 0, Epoch 8/20 => Loss 0.125, Train_accy 97.80:  40%|████      | 8/20 [00:10<00:14,  1.20s/it]Task 0, Epoch 9/20 => Loss 0.056, Train_accy 98.90:  40%|████      | 8/20 [00:11<00:14,  1.20s/it]Task 0, Epoch 9/20 => Loss 0.056, Train_accy 98.90:  45%|████▌     | 9/20 [00:11<00:12,  1.11s/it]Task 0, Epoch 10/20 => Loss 0.116, Train_accy 95.60:  45%|████▌     | 9/20 [00:12<00:12,  1.11s/it]Task 0, Epoch 10/20 => Loss 0.116, Train_accy 95.60:  50%|█████     | 10/20 [00:12<00:10,  1.04s/it]Task 0, Epoch 11/20 => Loss 0.054, Train_accy 97.80, Test_accy 96.15:  50%|█████     | 10/20 [00:14<00:10,  1.04s/it]Task 0, Epoch 11/20 => Loss 0.054, Train_accy 97.80, Test_accy 96.15:  55%|█████▌    | 11/20 [00:14<00:12,  1.41s/it]Task 0, Epoch 12/20 => Loss 0.009, Train_accy 100.00:  55%|█████▌    | 11/20 [00:15<00:12,  1.41s/it]                Task 0, Epoch 12/20 => Loss 0.009, Train_accy 100.00:  60%|██████    | 12/20 [00:15<00:10,  1.26s/it]Task 0, Epoch 13/20 => Loss 0.010, Train_accy 100.00:  60%|██████    | 12/20 [00:16<00:10,  1.26s/it]Task 0, Epoch 13/20 => Loss 0.010, Train_accy 100.00:  65%|██████▌   | 13/20 [00:16<00:08,  1.18s/it]Task 0, Epoch 14/20 => Loss 0.107, Train_accy 97.80:  65%|██████▌   | 13/20 [00:17<00:08,  1.18s/it] Task 0, Epoch 14/20 => Loss 0.107, Train_accy 97.80:  70%|███████   | 14/20 [00:17<00:06,  1.09s/it]Task 0, Epoch 15/20 => Loss 0.031, Train_accy 98.90:  70%|███████   | 14/20 [00:18<00:06,  1.09s/it]Task 0, Epoch 15/20 => Loss 0.031, Train_accy 98.90:  75%|███████▌  | 15/20 [00:18<00:05,  1.06s/it]Task 0, Epoch 16/20 => Loss 0.067, Train_accy 97.80, Test_accy 95.45:  75%|███████▌  | 15/20 [00:20<00:05,  1.06s/it]Task 0, Epoch 16/20 => Loss 0.067, Train_accy 97.80, Test_accy 95.45:  80%|████████  | 16/20 [00:20<00:05,  1.40s/it]Task 0, Epoch 17/20 => Loss 0.004, Train_accy 100.00:  80%|████████  | 16/20 [00:21<00:05,  1.40s/it]                Task 0, Epoch 17/20 => Loss 0.004, Train_accy 100.00:  85%|████████▌ | 17/20 [00:21<00:03,  1.26s/it]Task 0, Epoch 18/20 => Loss 0.015, Train_accy 100.00:  85%|████████▌ | 17/20 [00:22<00:03,  1.26s/it]Task 0, Epoch 18/20 => Loss 0.015, Train_accy 100.00:  90%|█████████ | 18/20 [00:22<00:02,  1.15s/it]Task 0, Epoch 19/20 => Loss 0.028, Train_accy 97.80:  90%|█████████ | 18/20 [00:23<00:02,  1.15s/it] Task 0, Epoch 19/20 => Loss 0.028, Train_accy 97.80:  95%|█████████▌| 19/20 [00:23<00:01,  1.09s/it]Task 0, Epoch 20/20 => Loss 0.080, Train_accy 96.70:  95%|█████████▌| 19/20 [00:24<00:01,  1.09s/it]Task 0, Epoch 20/20 => Loss 0.080, Train_accy 96.70: 100%|██████████| 20/20 [00:24<00:00,  1.06s/it]Task 0, Epoch 20/20 => Loss 0.080, Train_accy 96.70: 100%|██████████| 20/20 [00:24<00:00,  1.22s/it]
2024-05-09 22:12:04,847 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.080, Train_accy 96.70
2024-05-09 22:12:06,024 [trainer.py] => No NME accuracy.
2024-05-09 22:12:06,024 [trainer.py] => CNN: {'total': 96.5, '00-04': 96.5, 'old': 0, 'new': 96.5}
2024-05-09 22:12:06,024 [trainer.py] => CNN top1 curve: [96.5]
2024-05-09 22:12:06,024 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 96.5
2024-05-09 22:12:06,024 [trainer.py] => Average Accuracy (CNN): 96.5 

2024-05-09 22:12:06,024 [trainer.py] => Train Time: 49.269999999999996
2024-05-09 22:12:06,024 [trainer.py] => Test Time: 1.18 

2024-05-09 22:12:06,025 [trainer.py] => All params: 85802501
2024-05-09 22:12:06,026 [trainer.py] => Trainable params: 85802501
2024-05-09 22:12:06,027 [finetune.py] => Learning on 5-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.762, Train_accy 2.86, Test_accy 43.83:   0%|          | 0/20 [00:03<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.762, Train_accy 2.86, Test_accy 43.83:   5%|▌         | 1/20 [00:03<01:02,  3.28s/it]Task 1, Epoch 2/20 => Loss 0.527, Train_accy 28.57:   5%|▌         | 1/20 [00:04<01:02,  3.28s/it]                Task 1, Epoch 2/20 => Loss 0.527, Train_accy 28.57:  10%|█         | 2/20 [00:04<00:33,  1.87s/it]Task 1, Epoch 3/20 => Loss 0.139, Train_accy 51.43:  10%|█         | 2/20 [00:04<00:33,  1.87s/it]Task 1, Epoch 3/20 => Loss 0.139, Train_accy 51.43:  15%|█▌        | 3/20 [00:04<00:23,  1.39s/it]Task 1, Epoch 4/20 => Loss 0.036, Train_accy 62.86:  15%|█▌        | 3/20 [00:05<00:23,  1.39s/it]Task 1, Epoch 4/20 => Loss 0.036, Train_accy 62.86:  20%|██        | 4/20 [00:05<00:18,  1.15s/it]Task 1, Epoch 5/20 => Loss 0.094, Train_accy 58.57:  20%|██        | 4/20 [00:06<00:18,  1.15s/it]Task 1, Epoch 5/20 => Loss 0.094, Train_accy 58.57:  25%|██▌       | 5/20 [00:06<00:15,  1.02s/it]Task 1, Epoch 6/20 => Loss 0.045, Train_accy 68.57, Test_accy 82.45:  25%|██▌       | 5/20 [00:09<00:15,  1.02s/it]Task 1, Epoch 6/20 => Loss 0.045, Train_accy 68.57, Test_accy 82.45:  30%|███       | 6/20 [00:09<00:25,  1.85s/it]Task 1, Epoch 7/20 => Loss 0.012, Train_accy 71.43:  30%|███       | 6/20 [00:10<00:25,  1.85s/it]                 Task 1, Epoch 7/20 => Loss 0.012, Train_accy 71.43:  35%|███▌      | 7/20 [00:10<00:19,  1.51s/it]Task 1, Epoch 8/20 => Loss 0.024, Train_accy 78.57:  35%|███▌      | 7/20 [00:11<00:19,  1.51s/it]Task 1, Epoch 8/20 => Loss 0.024, Train_accy 78.57:  40%|████      | 8/20 [00:11<00:15,  1.28s/it]Task 1, Epoch 9/20 => Loss 0.074, Train_accy 92.86:  40%|████      | 8/20 [00:12<00:15,  1.28s/it]Task 1, Epoch 9/20 => Loss 0.074, Train_accy 92.86:  45%|████▌     | 9/20 [00:12<00:12,  1.12s/it]Task 1, Epoch 10/20 => Loss 0.002, Train_accy 97.14:  45%|████▌     | 9/20 [00:13<00:12,  1.12s/it]Task 1, Epoch 10/20 => Loss 0.002, Train_accy 97.14:  50%|█████     | 10/20 [00:13<00:10,  1.02s/it]Task 1, Epoch 11/20 => Loss 0.146, Train_accy 95.71, Test_accy 88.74:  50%|█████     | 10/20 [00:16<00:10,  1.02s/it]Task 1, Epoch 11/20 => Loss 0.146, Train_accy 95.71, Test_accy 88.74:  55%|█████▌    | 11/20 [00:16<00:15,  1.75s/it]Task 1, Epoch 12/20 => Loss 0.101, Train_accy 92.86:  55%|█████▌    | 11/20 [00:17<00:15,  1.75s/it]                 Task 1, Epoch 12/20 => Loss 0.101, Train_accy 92.86:  60%|██████    | 12/20 [00:17<00:11,  1.46s/it]Task 1, Epoch 13/20 => Loss 0.025, Train_accy 98.57:  60%|██████    | 12/20 [00:18<00:11,  1.46s/it]Task 1, Epoch 13/20 => Loss 0.025, Train_accy 98.57:  65%|██████▌   | 13/20 [00:18<00:08,  1.27s/it]Task 1, Epoch 14/20 => Loss 0.012, Train_accy 94.29:  65%|██████▌   | 13/20 [00:19<00:08,  1.27s/it]Task 1, Epoch 14/20 => Loss 0.012, Train_accy 94.29:  70%|███████   | 14/20 [00:19<00:06,  1.15s/it]Task 1, Epoch 15/20 => Loss 0.001, Train_accy 97.14:  70%|███████   | 14/20 [00:19<00:06,  1.15s/it]Task 1, Epoch 15/20 => Loss 0.001, Train_accy 97.14:  75%|███████▌  | 15/20 [00:19<00:05,  1.05s/it]Task 1, Epoch 16/20 => Loss 0.112, Train_accy 91.43, Test_accy 90.68:  75%|███████▌  | 15/20 [00:23<00:05,  1.05s/it]Task 1, Epoch 16/20 => Loss 0.112, Train_accy 91.43, Test_accy 90.68:  80%|████████  | 16/20 [00:23<00:07,  1.76s/it]Task 1, Epoch 17/20 => Loss 0.019, Train_accy 97.14:  80%|████████  | 16/20 [00:24<00:07,  1.76s/it]                 Task 1, Epoch 17/20 => Loss 0.019, Train_accy 97.14:  85%|████████▌ | 17/20 [00:24<00:04,  1.47s/it]Task 1, Epoch 18/20 => Loss 0.002, Train_accy 90.00:  85%|████████▌ | 17/20 [00:24<00:04,  1.47s/it]Task 1, Epoch 18/20 => Loss 0.002, Train_accy 90.00:  90%|█████████ | 18/20 [00:24<00:02,  1.27s/it]Task 1, Epoch 19/20 => Loss 0.110, Train_accy 88.57:  90%|█████████ | 18/20 [00:25<00:02,  1.27s/it]Task 1, Epoch 19/20 => Loss 0.110, Train_accy 88.57:  95%|█████████▌| 19/20 [00:25<00:01,  1.14s/it]Task 1, Epoch 20/20 => Loss 0.085, Train_accy 85.71:  95%|█████████▌| 19/20 [00:26<00:01,  1.14s/it]Task 1, Epoch 20/20 => Loss 0.085, Train_accy 85.71: 100%|██████████| 20/20 [00:26<00:00,  1.05s/it]Task 1, Epoch 20/20 => Loss 0.085, Train_accy 85.71: 100%|██████████| 20/20 [00:26<00:00,  1.33s/it]
2024-05-09 22:12:32,624 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.085, Train_accy 85.71
2024-05-09 22:12:35,480 [trainer.py] => No NME accuracy.
2024-05-09 22:12:35,480 [trainer.py] => CNN: {'total': 92.13, '00-04': 91.96, '05-09': 92.22, 'old': 91.96, 'new': 92.22}
2024-05-09 22:12:35,481 [trainer.py] => CNN top1 curve: [96.5, 92.13]
2024-05-09 22:12:35,481 [trainer.py] => CNN top5 curve: [100.0, 99.15]

Average Accuracy (CNN): 94.32
2024-05-09 22:12:35,481 [trainer.py] => Average Accuracy (CNN): 94.32 

2024-05-09 22:12:35,481 [trainer.py] => Train Time: 75.87
2024-05-09 22:12:35,481 [trainer.py] => Test Time: 4.04 

2024-05-09 22:12:35,482 [trainer.py] => All params: 85806346
2024-05-09 22:12:35,482 [trainer.py] => Trainable params: 85806346
2024-05-09 22:12:35,484 [finetune.py] => Learning on 10-15
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.391, Train_accy 14.49, Test_accy 64.67:   0%|          | 0/20 [00:05<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.391, Train_accy 14.49, Test_accy 64.67:   5%|▌         | 1/20 [00:05<01:38,  5.19s/it]Task 2, Epoch 2/20 => Loss 0.603, Train_accy 34.06:   5%|▌         | 1/20 [00:06<01:38,  5.19s/it]                 Task 2, Epoch 2/20 => Loss 0.603, Train_accy 34.06:  10%|█         | 2/20 [00:06<00:51,  2.86s/it]Task 2, Epoch 3/20 => Loss 0.097, Train_accy 60.14:  10%|█         | 2/20 [00:07<00:51,  2.86s/it]Task 2, Epoch 3/20 => Loss 0.097, Train_accy 60.14:  15%|█▌        | 3/20 [00:07<00:35,  2.10s/it]Task 2, Epoch 4/20 => Loss 0.176, Train_accy 56.52:  15%|█▌        | 3/20 [00:08<00:35,  2.10s/it]Task 2, Epoch 4/20 => Loss 0.176, Train_accy 56.52:  20%|██        | 4/20 [00:08<00:27,  1.74s/it]Task 2, Epoch 5/20 => Loss 0.435, Train_accy 59.42:  20%|██        | 4/20 [00:10<00:27,  1.74s/it]Task 2, Epoch 5/20 => Loss 0.435, Train_accy 59.42:  25%|██▌       | 5/20 [00:10<00:23,  1.57s/it]Task 2, Epoch 6/20 => Loss 0.302, Train_accy 82.61, Test_accy 90.33:  25%|██▌       | 5/20 [00:15<00:23,  1.57s/it]Task 2, Epoch 6/20 => Loss 0.302, Train_accy 82.61, Test_accy 90.33:  30%|███       | 6/20 [00:15<00:39,  2.83s/it]Task 2, Epoch 7/20 => Loss 0.013, Train_accy 94.93:  30%|███       | 6/20 [00:16<00:39,  2.83s/it]                 Task 2, Epoch 7/20 => Loss 0.013, Train_accy 94.93:  35%|███▌      | 7/20 [00:16<00:29,  2.30s/it]Task 2, Epoch 8/20 => Loss 0.022, Train_accy 98.55:  35%|███▌      | 7/20 [00:17<00:29,  2.30s/it]Task 2, Epoch 8/20 => Loss 0.022, Train_accy 98.55:  40%|████      | 8/20 [00:17<00:23,  1.99s/it]Task 2, Epoch 9/20 => Loss 0.102, Train_accy 96.38:  40%|████      | 8/20 [00:19<00:23,  1.99s/it]Task 2, Epoch 9/20 => Loss 0.102, Train_accy 96.38:  45%|████▌     | 9/20 [00:19<00:19,  1.74s/it]Task 2, Epoch 10/20 => Loss 0.177, Train_accy 97.83:  45%|████▌     | 9/20 [00:20<00:19,  1.74s/it]Task 2, Epoch 10/20 => Loss 0.177, Train_accy 97.83:  50%|█████     | 10/20 [00:20<00:16,  1.61s/it]Task 2, Epoch 11/20 => Loss 0.041, Train_accy 97.83, Test_accy 88.46:  50%|█████     | 10/20 [00:25<00:16,  1.61s/it]Task 2, Epoch 11/20 => Loss 0.041, Train_accy 97.83, Test_accy 88.46:  55%|█████▌    | 11/20 [00:25<00:24,  2.77s/it]Task 2, Epoch 12/20 => Loss 0.001, Train_accy 98.55:  55%|█████▌    | 11/20 [00:27<00:24,  2.77s/it]                 Task 2, Epoch 12/20 => Loss 0.001, Train_accy 98.55:  60%|██████    | 12/20 [00:27<00:18,  2.33s/it]Task 2, Epoch 13/20 => Loss 0.002, Train_accy 97.83:  60%|██████    | 12/20 [00:28<00:18,  2.33s/it]Task 2, Epoch 13/20 => Loss 0.002, Train_accy 97.83:  65%|██████▌   | 13/20 [00:28<00:13,  2.00s/it]Task 2, Epoch 14/20 => Loss 0.004, Train_accy 97.10:  65%|██████▌   | 13/20 [00:29<00:13,  2.00s/it]Task 2, Epoch 14/20 => Loss 0.004, Train_accy 97.10:  70%|███████   | 14/20 [00:29<00:10,  1.77s/it]Task 2, Epoch 15/20 => Loss 0.001, Train_accy 96.38:  70%|███████   | 14/20 [00:30<00:10,  1.77s/it]Task 2, Epoch 15/20 => Loss 0.001, Train_accy 96.38:  75%|███████▌  | 15/20 [00:30<00:07,  1.60s/it]Task 2, Epoch 16/20 => Loss 0.015, Train_accy 96.38, Test_accy 77.47:  75%|███████▌  | 15/20 [00:36<00:07,  1.60s/it]Task 2, Epoch 16/20 => Loss 0.015, Train_accy 96.38, Test_accy 77.47:  80%|████████  | 16/20 [00:36<00:10,  2.74s/it]Task 2, Epoch 17/20 => Loss 0.090, Train_accy 97.10:  80%|████████  | 16/20 [00:37<00:10,  2.74s/it]                 Task 2, Epoch 17/20 => Loss 0.090, Train_accy 97.10:  85%|████████▌ | 17/20 [00:37<00:06,  2.28s/it]Task 2, Epoch 18/20 => Loss 0.001, Train_accy 96.38:  85%|████████▌ | 17/20 [00:38<00:06,  2.28s/it]Task 2, Epoch 18/20 => Loss 0.001, Train_accy 96.38:  90%|█████████ | 18/20 [00:38<00:03,  1.95s/it]Task 2, Epoch 19/20 => Loss 0.011, Train_accy 97.83:  90%|█████████ | 18/20 [00:39<00:03,  1.95s/it]Task 2, Epoch 19/20 => Loss 0.011, Train_accy 97.83:  95%|█████████▌| 19/20 [00:39<00:01,  1.78s/it]Task 2, Epoch 20/20 => Loss 0.005, Train_accy 98.55:  95%|█████████▌| 19/20 [00:41<00:01,  1.78s/it]Task 2, Epoch 20/20 => Loss 0.005, Train_accy 98.55: 100%|██████████| 20/20 [00:41<00:00,  1.63s/it]Task 2, Epoch 20/20 => Loss 0.005, Train_accy 98.55: 100%|██████████| 20/20 [00:41<00:00,  2.06s/it]
2024-05-09 22:13:16,739 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.005, Train_accy 98.55
2024-05-09 22:13:20,899 [trainer.py] => No NME accuracy.
2024-05-09 22:13:20,900 [trainer.py] => CNN: {'total': 76.56, '00-04': 69.58, '05-09': 55.93, '10-14': 98.04, 'old': 60.65, 'new': 98.04}
2024-05-09 22:13:20,900 [trainer.py] => CNN top1 curve: [96.5, 92.13, 76.56]
2024-05-09 22:13:20,900 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.03]

Average Accuracy (CNN): 88.4
2024-05-09 22:13:20,900 [trainer.py] => Average Accuracy (CNN): 88.4 

2024-05-09 22:13:20,900 [trainer.py] => Train Time: 117.12
2024-05-09 22:13:20,900 [trainer.py] => Test Time: 8.2 

2024-05-09 22:13:20,902 [trainer.py] => All params: 85810191
2024-05-09 22:13:20,903 [trainer.py] => Trainable params: 85810191
2024-05-09 22:13:20,904 [finetune.py] => Learning on 15-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.353, Train_accy 4.35, Test_accy 45.14:   0%|          | 0/20 [00:09<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.353, Train_accy 4.35, Test_accy 45.14:   5%|▌         | 1/20 [00:09<03:07,  9.87s/it]Task 3, Epoch 2/20 => Loss 0.654, Train_accy 38.77:   5%|▌         | 1/20 [00:11<03:07,  9.87s/it]                Task 3, Epoch 2/20 => Loss 0.654, Train_accy 38.77:  10%|█         | 2/20 [00:11<01:35,  5.30s/it]Task 3, Epoch 3/20 => Loss 0.576, Train_accy 64.49:  10%|█         | 2/20 [00:14<01:35,  5.30s/it]Task 3, Epoch 3/20 => Loss 0.576, Train_accy 64.49:  15%|█▌        | 3/20 [00:14<01:05,  3.86s/it]Task 3, Epoch 4/20 => Loss 0.325, Train_accy 80.43:  15%|█▌        | 3/20 [00:16<01:05,  3.86s/it]Task 3, Epoch 4/20 => Loss 0.325, Train_accy 80.43:  20%|██        | 4/20 [00:16<00:50,  3.18s/it]Task 3, Epoch 5/20 => Loss 0.177, Train_accy 85.51:  20%|██        | 4/20 [00:18<00:50,  3.18s/it]Task 3, Epoch 5/20 => Loss 0.177, Train_accy 85.51:  25%|██▌       | 5/20 [00:18<00:42,  2.80s/it]Task 3, Epoch 6/20 => Loss 0.192, Train_accy 90.58, Test_accy 87.00:  25%|██▌       | 5/20 [00:28<00:42,  2.80s/it]Task 3, Epoch 6/20 => Loss 0.192, Train_accy 90.58, Test_accy 87.00:  30%|███       | 6/20 [00:28<01:13,  5.22s/it]Task 3, Epoch 7/20 => Loss 0.144, Train_accy 91.30:  30%|███       | 6/20 [00:30<01:13,  5.22s/it]                 Task 3, Epoch 7/20 => Loss 0.144, Train_accy 91.30:  35%|███▌      | 7/20 [00:30<00:54,  4.21s/it]Task 3, Epoch 8/20 => Loss 0.212, Train_accy 88.77:  35%|███▌      | 7/20 [00:32<00:54,  4.21s/it]Task 3, Epoch 8/20 => Loss 0.212, Train_accy 88.77:  40%|████      | 8/20 [00:32<00:42,  3.55s/it]Task 3, Epoch 9/20 => Loss 0.117, Train_accy 96.01:  40%|████      | 8/20 [00:34<00:42,  3.55s/it]Task 3, Epoch 9/20 => Loss 0.117, Train_accy 96.01:  45%|████▌     | 9/20 [00:34<00:34,  3.10s/it]Task 3, Epoch 10/20 => Loss 0.122, Train_accy 91.67:  45%|████▌     | 9/20 [00:36<00:34,  3.10s/it]Task 3, Epoch 10/20 => Loss 0.122, Train_accy 91.67:  50%|█████     | 10/20 [00:36<00:28,  2.82s/it]Task 3, Epoch 11/20 => Loss 0.102, Train_accy 94.20, Test_accy 84.12:  50%|█████     | 10/20 [00:46<00:28,  2.82s/it]Task 3, Epoch 11/20 => Loss 0.102, Train_accy 94.20, Test_accy 84.12:  55%|█████▌    | 11/20 [00:46<00:45,  5.04s/it]Task 3, Epoch 12/20 => Loss 0.108, Train_accy 93.12:  55%|█████▌    | 11/20 [00:49<00:45,  5.04s/it]                 Task 3, Epoch 12/20 => Loss 0.108, Train_accy 93.12:  60%|██████    | 12/20 [00:49<00:33,  4.17s/it]Task 3, Epoch 13/20 => Loss 0.064, Train_accy 94.93:  60%|██████    | 12/20 [00:51<00:33,  4.17s/it]Task 3, Epoch 13/20 => Loss 0.064, Train_accy 94.93:  65%|██████▌   | 13/20 [00:51<00:24,  3.55s/it]Task 3, Epoch 14/20 => Loss 0.094, Train_accy 95.65:  65%|██████▌   | 13/20 [00:53<00:24,  3.55s/it]Task 3, Epoch 14/20 => Loss 0.094, Train_accy 95.65:  70%|███████   | 14/20 [00:53<00:18,  3.12s/it]Task 3, Epoch 15/20 => Loss 0.119, Train_accy 91.67:  70%|███████   | 14/20 [00:55<00:18,  3.12s/it]Task 3, Epoch 15/20 => Loss 0.119, Train_accy 91.67:  75%|███████▌  | 15/20 [00:55<00:14,  2.82s/it]Task 3, Epoch 16/20 => Loss 0.085, Train_accy 94.20, Test_accy 81.98:  75%|███████▌  | 15/20 [01:05<00:14,  2.82s/it]Task 3, Epoch 16/20 => Loss 0.085, Train_accy 94.20, Test_accy 81.98:  80%|████████  | 16/20 [01:05<00:19,  4.99s/it]Task 3, Epoch 17/20 => Loss 0.066, Train_accy 93.48:  80%|████████  | 16/20 [01:07<00:19,  4.99s/it]                 Task 3, Epoch 17/20 => Loss 0.066, Train_accy 93.48:  85%|████████▌ | 17/20 [01:07<00:12,  4.14s/it]Task 3, Epoch 18/20 => Loss 0.100, Train_accy 94.57:  85%|████████▌ | 17/20 [01:09<00:12,  4.14s/it]Task 3, Epoch 18/20 => Loss 0.100, Train_accy 94.57:  90%|█████████ | 18/20 [01:09<00:07,  3.54s/it]Task 3, Epoch 19/20 => Loss 0.090, Train_accy 95.65:  90%|█████████ | 18/20 [01:12<00:07,  3.54s/it]Task 3, Epoch 19/20 => Loss 0.090, Train_accy 95.65:  95%|█████████▌| 19/20 [01:12<00:03,  3.13s/it]Task 3, Epoch 20/20 => Loss 0.031, Train_accy 98.19:  95%|█████████▌| 19/20 [01:14<00:03,  3.13s/it]Task 3, Epoch 20/20 => Loss 0.031, Train_accy 98.19: 100%|██████████| 20/20 [01:14<00:00,  2.84s/it]Task 3, Epoch 20/20 => Loss 0.031, Train_accy 98.19: 100%|██████████| 20/20 [01:14<00:00,  3.71s/it]
2024-05-09 22:14:35,087 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.031, Train_accy 98.19
2024-05-09 22:14:42,789 [trainer.py] => No NME accuracy.
2024-05-09 22:14:42,789 [trainer.py] => CNN: {'total': 84.3, '00-04': 86.01, '05-09': 75.37, '10-14': 71.9, '15-19': 92.76, 'old': 76.01, 'new': 92.76}
2024-05-09 22:14:42,789 [trainer.py] => CNN top1 curve: [96.5, 92.13, 76.56, 84.3]
2024-05-09 22:14:42,789 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.03, 98.67]

Average Accuracy (CNN): 87.37
2024-05-09 22:14:42,789 [trainer.py] => Average Accuracy (CNN): 87.37 

2024-05-09 22:14:42,789 [trainer.py] => Train Time: 191.3
2024-05-09 22:14:42,789 [trainer.py] => Test Time: 15.899999999999999 

2024-05-09 22:14:42,790 [trainer.py] => All params: 85814036
2024-05-09 22:14:42,791 [trainer.py] => Trainable params: 85814036
2024-05-09 22:14:42,791 [finetune.py] => Learning on 20-25
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.045, Train_accy 6.80, Test_accy 53.27:   0%|          | 0/20 [00:12<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.045, Train_accy 6.80, Test_accy 53.27:   5%|▌         | 1/20 [00:12<04:05, 12.92s/it]Task 4, Epoch 2/20 => Loss 0.293, Train_accy 24.40:   5%|▌         | 1/20 [00:14<04:05, 12.92s/it]                Task 4, Epoch 2/20 => Loss 0.293, Train_accy 24.40:  10%|█         | 2/20 [00:14<01:57,  6.50s/it]Task 4, Epoch 3/20 => Loss 0.214, Train_accy 52.00:  10%|█         | 2/20 [00:16<01:57,  6.50s/it]Task 4, Epoch 3/20 => Loss 0.214, Train_accy 52.00:  15%|█▌        | 3/20 [00:16<01:15,  4.45s/it]Task 4, Epoch 4/20 => Loss 0.179, Train_accy 58.00:  15%|█▌        | 3/20 [00:18<01:15,  4.45s/it]Task 4, Epoch 4/20 => Loss 0.179, Train_accy 58.00:  20%|██        | 4/20 [00:18<00:55,  3.50s/it]Task 4, Epoch 5/20 => Loss 0.125, Train_accy 69.60:  20%|██        | 4/20 [00:20<00:55,  3.50s/it]Task 4, Epoch 5/20 => Loss 0.125, Train_accy 69.60:  25%|██▌       | 5/20 [00:20<00:44,  2.96s/it]Task 4, Epoch 6/20 => Loss 0.078, Train_accy 86.80, Test_accy 67.89:  25%|██▌       | 5/20 [00:33<00:44,  2.96s/it]Task 4, Epoch 6/20 => Loss 0.078, Train_accy 86.80, Test_accy 67.89:  30%|███       | 6/20 [00:33<01:28,  6.34s/it]Task 4, Epoch 7/20 => Loss 0.246, Train_accy 85.20:  30%|███       | 6/20 [00:35<01:28,  6.34s/it]                 Task 4, Epoch 7/20 => Loss 0.246, Train_accy 85.20:  35%|███▌      | 7/20 [00:35<01:03,  4.90s/it]Task 4, Epoch 8/20 => Loss 0.092, Train_accy 90.00:  35%|███▌      | 7/20 [00:37<01:03,  4.90s/it]Task 4, Epoch 8/20 => Loss 0.092, Train_accy 90.00:  40%|████      | 8/20 [00:37<00:47,  3.97s/it]Task 4, Epoch 9/20 => Loss 0.099, Train_accy 91.20:  40%|████      | 8/20 [00:39<00:47,  3.97s/it]Task 4, Epoch 9/20 => Loss 0.099, Train_accy 91.20:  45%|████▌     | 9/20 [00:39<00:36,  3.35s/it]Task 4, Epoch 10/20 => Loss 0.092, Train_accy 92.40:  45%|████▌     | 9/20 [00:41<00:36,  3.35s/it]Task 4, Epoch 10/20 => Loss 0.092, Train_accy 92.40:  50%|█████     | 10/20 [00:41<00:29,  2.91s/it]Task 4, Epoch 11/20 => Loss 0.080, Train_accy 88.40, Test_accy 74.57:  50%|█████     | 10/20 [00:54<00:29,  2.91s/it]Task 4, Epoch 11/20 => Loss 0.080, Train_accy 88.40, Test_accy 74.57:  55%|█████▌    | 11/20 [00:54<00:53,  5.94s/it]Task 4, Epoch 12/20 => Loss 0.055, Train_accy 88.80:  55%|█████▌    | 11/20 [00:56<00:53,  5.94s/it]                 Task 4, Epoch 12/20 => Loss 0.055, Train_accy 88.80:  60%|██████    | 12/20 [00:56<00:37,  4.75s/it]Task 4, Epoch 13/20 => Loss 0.036, Train_accy 93.60:  60%|██████    | 12/20 [00:58<00:37,  4.75s/it]Task 4, Epoch 13/20 => Loss 0.036, Train_accy 93.60:  65%|██████▌   | 13/20 [00:58<00:27,  3.90s/it]Task 4, Epoch 14/20 => Loss 0.251, Train_accy 89.20:  65%|██████▌   | 13/20 [01:00<00:27,  3.90s/it]Task 4, Epoch 14/20 => Loss 0.251, Train_accy 89.20:  70%|███████   | 14/20 [01:00<00:19,  3.32s/it]Task 4, Epoch 15/20 => Loss 0.240, Train_accy 85.20:  70%|███████   | 14/20 [01:02<00:19,  3.32s/it]Task 4, Epoch 15/20 => Loss 0.240, Train_accy 85.20:  75%|███████▌  | 15/20 [01:02<00:14,  2.91s/it]Task 4, Epoch 16/20 => Loss 0.237, Train_accy 79.60, Test_accy 71.01:  75%|███████▌  | 15/20 [01:15<00:14,  2.91s/it]Task 4, Epoch 16/20 => Loss 0.237, Train_accy 79.60, Test_accy 71.01:  80%|████████  | 16/20 [01:15<00:23,  5.96s/it]Task 4, Epoch 17/20 => Loss 0.175, Train_accy 85.20:  80%|████████  | 16/20 [01:17<00:23,  5.96s/it]                 Task 4, Epoch 17/20 => Loss 0.175, Train_accy 85.20:  85%|████████▌ | 17/20 [01:17<00:14,  4.76s/it]Task 4, Epoch 18/20 => Loss 0.166, Train_accy 88.80:  85%|████████▌ | 17/20 [01:19<00:14,  4.76s/it]Task 4, Epoch 18/20 => Loss 0.166, Train_accy 88.80:  90%|█████████ | 18/20 [01:19<00:07,  3.92s/it]Task 4, Epoch 19/20 => Loss 0.113, Train_accy 93.20:  90%|█████████ | 18/20 [01:21<00:07,  3.92s/it]Task 4, Epoch 19/20 => Loss 0.113, Train_accy 93.20:  95%|█████████▌| 19/20 [01:21<00:03,  3.32s/it]Task 4, Epoch 20/20 => Loss 0.068, Train_accy 94.00:  95%|█████████▌| 19/20 [01:23<00:03,  3.32s/it]Task 4, Epoch 20/20 => Loss 0.068, Train_accy 94.00: 100%|██████████| 20/20 [01:23<00:00,  2.93s/it]Task 4, Epoch 20/20 => Loss 0.068, Train_accy 94.00: 100%|██████████| 20/20 [01:23<00:00,  4.17s/it]
2024-05-09 22:16:06,118 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.068, Train_accy 94.00
2024-05-09 22:16:16,901 [trainer.py] => No NME accuracy.
2024-05-09 22:16:16,902 [trainer.py] => CNN: {'total': 69.09, '00-04': 41.61, '05-09': 40.0, '10-14': 54.41, '15-19': 70.83, '20-24': 93.07, 'old': 58.52, 'new': 93.07}
2024-05-09 22:16:16,902 [trainer.py] => CNN top1 curve: [96.5, 92.13, 76.56, 84.3, 69.09]
2024-05-09 22:16:16,902 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.03, 98.67, 98.49]

Average Accuracy (CNN): 83.72
2024-05-09 22:16:16,902 [trainer.py] => Average Accuracy (CNN): 83.72 

2024-05-09 22:16:16,902 [trainer.py] => Train Time: 274.63
2024-05-09 22:16:16,902 [trainer.py] => Test Time: 26.68 

2024-05-09 22:16:16,903 [trainer.py] => All params: 85817881
2024-05-09 22:16:16,903 [trainer.py] => Trainable params: 85817881
2024-05-09 22:16:16,904 [finetune.py] => Learning on 25-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.853, Train_accy 0.87, Test_accy 63.10:   0%|          | 0/20 [00:12<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.853, Train_accy 0.87, Test_accy 63.10:   5%|▌         | 1/20 [00:12<04:05, 12.95s/it]Task 5, Epoch 2/20 => Loss 0.983, Train_accy 12.17:   5%|▌         | 1/20 [00:14<04:05, 12.95s/it]                Task 5, Epoch 2/20 => Loss 0.983, Train_accy 12.17:  10%|█         | 2/20 [00:14<01:48,  6.03s/it]Task 5, Epoch 3/20 => Loss 0.220, Train_accy 21.74:  10%|█         | 2/20 [00:15<01:48,  6.03s/it]Task 5, Epoch 3/20 => Loss 0.220, Train_accy 21.74:  15%|█▌        | 3/20 [00:15<01:04,  3.80s/it]Task 5, Epoch 4/20 => Loss 0.256, Train_accy 33.91:  15%|█▌        | 3/20 [00:16<01:04,  3.80s/it]Task 5, Epoch 4/20 => Loss 0.256, Train_accy 33.91:  20%|██        | 4/20 [00:16<00:43,  2.74s/it]Task 5, Epoch 5/20 => Loss 0.036, Train_accy 45.22:  20%|██        | 4/20 [00:17<00:43,  2.74s/it]Task 5, Epoch 5/20 => Loss 0.036, Train_accy 45.22:  25%|██▌       | 5/20 [00:17<00:32,  2.16s/it]Task 5, Epoch 6/20 => Loss 0.121, Train_accy 68.70, Test_accy 61.92:  25%|██▌       | 5/20 [00:30<00:32,  2.16s/it]Task 5, Epoch 6/20 => Loss 0.121, Train_accy 68.70, Test_accy 61.92:  30%|███       | 6/20 [00:30<01:21,  5.79s/it]Task 5, Epoch 7/20 => Loss 0.024, Train_accy 73.91:  30%|███       | 6/20 [00:31<01:21,  5.79s/it]                 Task 5, Epoch 7/20 => Loss 0.024, Train_accy 73.91:  35%|███▌      | 7/20 [00:31<00:55,  4.29s/it]Task 5, Epoch 8/20 => Loss 0.137, Train_accy 73.91:  35%|███▌      | 7/20 [00:32<00:55,  4.29s/it]Task 5, Epoch 8/20 => Loss 0.137, Train_accy 73.91:  40%|████      | 8/20 [00:32<00:39,  3.26s/it]Task 5, Epoch 9/20 => Loss 0.074, Train_accy 82.61:  40%|████      | 8/20 [00:33<00:39,  3.26s/it]Task 5, Epoch 9/20 => Loss 0.074, Train_accy 82.61:  45%|████▌     | 9/20 [00:33<00:28,  2.59s/it]Task 5, Epoch 10/20 => Loss 0.108, Train_accy 79.13:  45%|████▌     | 9/20 [00:35<00:28,  2.59s/it]Task 5, Epoch 10/20 => Loss 0.108, Train_accy 79.13:  50%|█████     | 10/20 [00:35<00:21,  2.18s/it]Task 5, Epoch 11/20 => Loss 0.034, Train_accy 82.61, Test_accy 69.60:  50%|█████     | 10/20 [00:47<00:21,  2.18s/it]Task 5, Epoch 11/20 => Loss 0.034, Train_accy 82.61, Test_accy 69.60:  55%|█████▌    | 11/20 [00:47<00:48,  5.42s/it]Task 5, Epoch 12/20 => Loss 0.030, Train_accy 86.09:  55%|█████▌    | 11/20 [00:48<00:48,  5.42s/it]                 Task 5, Epoch 12/20 => Loss 0.030, Train_accy 86.09:  60%|██████    | 12/20 [00:48<00:32,  4.12s/it]Task 5, Epoch 13/20 => Loss 0.035, Train_accy 90.43:  60%|██████    | 12/20 [00:50<00:32,  4.12s/it]Task 5, Epoch 13/20 => Loss 0.035, Train_accy 90.43:  65%|██████▌   | 13/20 [00:50<00:22,  3.25s/it]Task 5, Epoch 14/20 => Loss 0.020, Train_accy 91.30:  65%|██████▌   | 13/20 [00:51<00:22,  3.25s/it]Task 5, Epoch 14/20 => Loss 0.020, Train_accy 91.30:  70%|███████   | 14/20 [00:51<00:15,  2.64s/it]Task 5, Epoch 15/20 => Loss 0.118, Train_accy 90.43:  70%|███████   | 14/20 [00:52<00:15,  2.64s/it]Task 5, Epoch 15/20 => Loss 0.118, Train_accy 90.43:  75%|███████▌  | 15/20 [00:52<00:10,  2.16s/it]Task 5, Epoch 16/20 => Loss 0.002, Train_accy 96.52, Test_accy 72.75:  75%|███████▌  | 15/20 [01:05<00:10,  2.16s/it]Task 5, Epoch 16/20 => Loss 0.002, Train_accy 96.52, Test_accy 72.75:  80%|████████  | 16/20 [01:05<00:21,  5.41s/it]Task 5, Epoch 17/20 => Loss 0.015, Train_accy 93.91:  80%|████████  | 16/20 [01:06<00:21,  5.41s/it]                 Task 5, Epoch 17/20 => Loss 0.015, Train_accy 93.91:  85%|████████▌ | 17/20 [01:06<00:12,  4.13s/it]Task 5, Epoch 18/20 => Loss 0.022, Train_accy 94.78:  85%|████████▌ | 17/20 [01:07<00:12,  4.13s/it]Task 5, Epoch 18/20 => Loss 0.022, Train_accy 94.78:  90%|█████████ | 18/20 [01:07<00:06,  3.22s/it]Task 5, Epoch 19/20 => Loss 0.019, Train_accy 94.78:  90%|█████████ | 18/20 [01:08<00:06,  3.22s/it]Task 5, Epoch 19/20 => Loss 0.019, Train_accy 94.78:  95%|█████████▌| 19/20 [01:08<00:02,  2.61s/it]Task 5, Epoch 20/20 => Loss 0.024, Train_accy 93.04:  95%|█████████▌| 19/20 [01:10<00:02,  2.61s/it]Task 5, Epoch 20/20 => Loss 0.024, Train_accy 93.04: 100%|██████████| 20/20 [01:10<00:00,  2.18s/it]Task 5, Epoch 20/20 => Loss 0.024, Train_accy 93.04: 100%|██████████| 20/20 [01:10<00:00,  3.50s/it]
2024-05-09 22:17:26,934 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.024, Train_accy 93.04
2024-05-09 22:17:38,790 [trainer.py] => No NME accuracy.
2024-05-09 22:17:38,791 [trainer.py] => CNN: {'total': 71.74, '00-04': 51.75, '05-09': 59.63, '10-14': 75.65, '15-19': 65.37, '20-24': 81.59, '25-29': 88.89, 'old': 70.16, 'new': 88.89}
2024-05-09 22:17:38,791 [trainer.py] => CNN top1 curve: [96.5, 92.13, 76.56, 84.3, 69.09, 71.74]
2024-05-09 22:17:38,791 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.03, 98.67, 98.49, 97.59]

Average Accuracy (CNN): 81.72
2024-05-09 22:17:38,792 [trainer.py] => Average Accuracy (CNN): 81.72 

2024-05-09 22:17:38,792 [trainer.py] => Train Time: 344.65999999999997
2024-05-09 22:17:38,792 [trainer.py] => Test Time: 38.53 

2024-05-09 22:17:38,793 [trainer.py] => All params: 85821726
2024-05-09 22:17:38,794 [trainer.py] => Trainable params: 85821726
2024-05-09 22:17:38,796 [finetune.py] => Learning on 30-35
  0%|          | 0/20 [00:00<?, ?it/s]Task 6, Epoch 1/20 => Loss 1.126, Train_accy 13.22, Test_accy 52.79:   0%|          | 0/20 [00:15<?, ?it/s]Task 6, Epoch 1/20 => Loss 1.126, Train_accy 13.22, Test_accy 52.79:   5%|▌         | 1/20 [00:15<04:52, 15.37s/it]Task 6, Epoch 2/20 => Loss 0.289, Train_accy 64.37:   5%|▌         | 1/20 [00:16<04:52, 15.37s/it]                 Task 6, Epoch 2/20 => Loss 0.289, Train_accy 64.37:  10%|█         | 2/20 [00:16<02:09,  7.20s/it]Task 6, Epoch 3/20 => Loss 0.089, Train_accy 64.94:  10%|█         | 2/20 [00:18<02:09,  7.20s/it]Task 6, Epoch 3/20 => Loss 0.089, Train_accy 64.94:  15%|█▌        | 3/20 [00:18<01:17,  4.59s/it]Task 6, Epoch 4/20 => Loss 0.054, Train_accy 86.21:  15%|█▌        | 3/20 [00:19<01:17,  4.59s/it]Task 6, Epoch 4/20 => Loss 0.054, Train_accy 86.21:  20%|██        | 4/20 [00:19<00:54,  3.38s/it]Task 6, Epoch 5/20 => Loss 0.013, Train_accy 91.38:  20%|██        | 4/20 [00:21<00:54,  3.38s/it]Task 6, Epoch 5/20 => Loss 0.013, Train_accy 91.38:  25%|██▌       | 5/20 [00:21<00:40,  2.69s/it]Task 6, Epoch 6/20 => Loss 0.009, Train_accy 94.25, Test_accy 39.52:  25%|██▌       | 5/20 [00:36<00:40,  2.69s/it]Task 6, Epoch 6/20 => Loss 0.009, Train_accy 94.25, Test_accy 39.52:  30%|███       | 6/20 [00:36<01:37,  6.96s/it]Task 6, Epoch 7/20 => Loss 0.010, Train_accy 97.13:  30%|███       | 6/20 [00:38<01:37,  6.96s/it]                 Task 6, Epoch 7/20 => Loss 0.010, Train_accy 97.13:  35%|███▌      | 7/20 [00:38<01:07,  5.18s/it]Task 6, Epoch 8/20 => Loss 0.007, Train_accy 96.55:  35%|███▌      | 7/20 [00:39<01:07,  5.18s/it]Task 6, Epoch 8/20 => Loss 0.007, Train_accy 96.55:  40%|████      | 8/20 [00:39<00:48,  4.00s/it]Task 6, Epoch 9/20 => Loss 0.011, Train_accy 97.70:  40%|████      | 8/20 [00:41<00:48,  4.00s/it]Task 6, Epoch 9/20 => Loss 0.011, Train_accy 97.70:  45%|████▌     | 9/20 [00:41<00:35,  3.23s/it]Task 6, Epoch 10/20 => Loss 0.000, Train_accy 97.70:  45%|████▌     | 9/20 [00:42<00:35,  3.23s/it]Task 6, Epoch 10/20 => Loss 0.000, Train_accy 97.70:  50%|█████     | 10/20 [00:42<00:27,  2.71s/it]Task 6, Epoch 11/20 => Loss 0.029, Train_accy 96.55, Test_accy 38.61:  50%|█████     | 10/20 [00:57<00:27,  2.71s/it]Task 6, Epoch 11/20 => Loss 0.029, Train_accy 96.55, Test_accy 38.61:  55%|█████▌    | 11/20 [00:57<00:58,  6.50s/it]Task 6, Epoch 12/20 => Loss 0.005, Train_accy 97.70:  55%|█████▌    | 11/20 [00:59<00:58,  6.50s/it]                 Task 6, Epoch 12/20 => Loss 0.005, Train_accy 97.70:  60%|██████    | 12/20 [00:59<00:39,  4.96s/it]Task 6, Epoch 13/20 => Loss 0.035, Train_accy 98.85:  60%|██████    | 12/20 [01:00<00:39,  4.96s/it]Task 6, Epoch 13/20 => Loss 0.035, Train_accy 98.85:  65%|██████▌   | 13/20 [01:00<00:27,  3.91s/it]Task 6, Epoch 14/20 => Loss 0.003, Train_accy 97.70:  65%|██████▌   | 13/20 [01:02<00:27,  3.91s/it]Task 6, Epoch 14/20 => Loss 0.003, Train_accy 97.70:  70%|███████   | 14/20 [01:02<00:19,  3.23s/it]Task 6, Epoch 15/20 => Loss 0.015, Train_accy 98.85:  70%|███████   | 14/20 [01:03<00:19,  3.23s/it]Task 6, Epoch 15/20 => Loss 0.015, Train_accy 98.85:  75%|███████▌  | 15/20 [01:03<00:13,  2.68s/it]Task 6, Epoch 16/20 => Loss 0.061, Train_accy 96.55, Test_accy 37.04:  75%|███████▌  | 15/20 [01:19<00:13,  2.68s/it]Task 6, Epoch 16/20 => Loss 0.061, Train_accy 96.55, Test_accy 37.04:  80%|████████  | 16/20 [01:19<00:26,  6.57s/it]Task 6, Epoch 17/20 => Loss 0.002, Train_accy 97.70:  80%|████████  | 16/20 [01:20<00:26,  6.57s/it]                 Task 6, Epoch 17/20 => Loss 0.002, Train_accy 97.70:  85%|████████▌ | 17/20 [01:20<00:15,  5.04s/it]Task 6, Epoch 18/20 => Loss 0.009, Train_accy 97.70:  85%|████████▌ | 17/20 [01:22<00:15,  5.04s/it]Task 6, Epoch 18/20 => Loss 0.009, Train_accy 97.70:  90%|█████████ | 18/20 [01:22<00:07,  3.96s/it]Task 6, Epoch 19/20 => Loss 0.049, Train_accy 95.98:  90%|█████████ | 18/20 [01:23<00:07,  3.96s/it]Task 6, Epoch 19/20 => Loss 0.049, Train_accy 95.98:  95%|█████████▌| 19/20 [01:23<00:03,  3.20s/it]Task 6, Epoch 20/20 => Loss 0.067, Train_accy 97.13:  95%|█████████▌| 19/20 [01:25<00:03,  3.20s/it]Task 6, Epoch 20/20 => Loss 0.067, Train_accy 97.13: 100%|██████████| 20/20 [01:25<00:00,  2.70s/it]Task 6, Epoch 20/20 => Loss 0.067, Train_accy 97.13: 100%|██████████| 20/20 [01:25<00:00,  4.26s/it]
2024-05-09 22:19:04,062 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.067, Train_accy 97.13
2024-05-09 22:19:18,035 [trainer.py] => No NME accuracy.
2024-05-09 22:19:18,035 [trainer.py] => CNN: {'total': 34.93, '00-04': 30.07, '05-09': 21.67, '10-14': 15.69, '15-19': 6.53, '20-24': 41.67, '25-29': 52.12, '30-34': 90.88, 'old': 24.8, 'new': 90.88}
2024-05-09 22:19:18,036 [trainer.py] => CNN top1 curve: [96.5, 92.13, 76.56, 84.3, 69.09, 71.74, 34.93]
2024-05-09 22:19:18,036 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.03, 98.67, 98.49, 97.59, 69.23]

Average Accuracy (CNN): 75.04
2024-05-09 22:19:18,036 [trainer.py] => Average Accuracy (CNN): 75.04 

2024-05-09 22:19:18,036 [trainer.py] => Train Time: 429.91999999999996
2024-05-09 22:19:18,036 [trainer.py] => Test Time: 52.5 

2024-05-09 22:19:18,038 [trainer.py] => All params: 85825571
2024-05-09 22:19:18,039 [trainer.py] => Trainable params: 85825571
2024-05-09 22:19:18,040 [finetune.py] => Learning on 35-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.863, Train_accy 0.00, Test_accy 28.97:   0%|          | 0/20 [00:16<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.863, Train_accy 0.00, Test_accy 28.97:   5%|▌         | 1/20 [00:16<05:09, 16.30s/it]Task 7, Epoch 2/20 => Loss 0.687, Train_accy 0.78:   5%|▌         | 1/20 [00:17<05:09, 16.30s/it]                 Task 7, Epoch 2/20 => Loss 0.687, Train_accy 0.78:  10%|█         | 2/20 [00:17<02:15,  7.53s/it]Task 7, Epoch 3/20 => Loss 0.194, Train_accy 2.33:  10%|█         | 2/20 [00:18<02:15,  7.53s/it]Task 7, Epoch 3/20 => Loss 0.194, Train_accy 2.33:  15%|█▌        | 3/20 [00:18<01:19,  4.69s/it]Task 7, Epoch 4/20 => Loss 0.149, Train_accy 14.73:  15%|█▌        | 3/20 [00:20<01:19,  4.69s/it]Task 7, Epoch 4/20 => Loss 0.149, Train_accy 14.73:  20%|██        | 4/20 [00:20<00:52,  3.29s/it]Task 7, Epoch 5/20 => Loss 0.087, Train_accy 25.58:  20%|██        | 4/20 [00:21<00:52,  3.29s/it]Task 7, Epoch 5/20 => Loss 0.087, Train_accy 25.58:  25%|██▌       | 5/20 [00:21<00:38,  2.56s/it]Task 7, Epoch 6/20 => Loss 0.167, Train_accy 44.19, Test_accy 27.14:  25%|██▌       | 5/20 [00:37<00:38,  2.56s/it]Task 7, Epoch 6/20 => Loss 0.167, Train_accy 44.19, Test_accy 27.14:  30%|███       | 6/20 [00:37<01:40,  7.15s/it]Task 7, Epoch 7/20 => Loss 0.053, Train_accy 52.71:  30%|███       | 6/20 [00:38<01:40,  7.15s/it]                 Task 7, Epoch 7/20 => Loss 0.053, Train_accy 52.71:  35%|███▌      | 7/20 [00:38<01:07,  5.21s/it]Task 7, Epoch 8/20 => Loss 0.124, Train_accy 67.44:  35%|███▌      | 7/20 [00:39<01:07,  5.21s/it]Task 7, Epoch 8/20 => Loss 0.124, Train_accy 67.44:  40%|████      | 8/20 [00:39<00:47,  3.92s/it]Task 7, Epoch 9/20 => Loss 0.065, Train_accy 73.64:  40%|████      | 8/20 [00:41<00:47,  3.92s/it]Task 7, Epoch 9/20 => Loss 0.065, Train_accy 73.64:  45%|████▌     | 9/20 [00:41<00:34,  3.11s/it]Task 7, Epoch 10/20 => Loss 0.049, Train_accy 74.42:  45%|████▌     | 9/20 [00:42<00:34,  3.11s/it]Task 7, Epoch 10/20 => Loss 0.049, Train_accy 74.42:  50%|█████     | 10/20 [00:42<00:25,  2.50s/it]Task 7, Epoch 11/20 => Loss 0.050, Train_accy 76.74, Test_accy 35.69:  50%|█████     | 10/20 [00:58<00:25,  2.50s/it]Task 7, Epoch 11/20 => Loss 0.050, Train_accy 76.74, Test_accy 35.69:  55%|█████▌    | 11/20 [00:58<01:00,  6.72s/it]Task 7, Epoch 12/20 => Loss 0.025, Train_accy 84.50:  55%|█████▌    | 11/20 [00:59<01:00,  6.72s/it]                 Task 7, Epoch 12/20 => Loss 0.025, Train_accy 84.50:  60%|██████    | 12/20 [00:59<00:40,  5.03s/it]Task 7, Epoch 13/20 => Loss 0.031, Train_accy 86.82:  60%|██████    | 12/20 [01:00<00:40,  5.03s/it]Task 7, Epoch 13/20 => Loss 0.031, Train_accy 86.82:  65%|██████▌   | 13/20 [01:00<00:27,  3.88s/it]Task 7, Epoch 14/20 => Loss 0.123, Train_accy 83.72:  65%|██████▌   | 13/20 [01:02<00:27,  3.88s/it]Task 7, Epoch 14/20 => Loss 0.123, Train_accy 83.72:  70%|███████   | 14/20 [01:02<00:18,  3.06s/it]Task 7, Epoch 15/20 => Loss 0.042, Train_accy 92.25:  70%|███████   | 14/20 [01:03<00:18,  3.06s/it]Task 7, Epoch 15/20 => Loss 0.042, Train_accy 92.25:  75%|███████▌  | 15/20 [01:03<00:12,  2.50s/it]Task 7, Epoch 16/20 => Loss 0.078, Train_accy 87.60, Test_accy 40.94:  75%|███████▌  | 15/20 [01:19<00:12,  2.50s/it]Task 7, Epoch 16/20 => Loss 0.078, Train_accy 87.60, Test_accy 40.94:  80%|████████  | 16/20 [01:19<00:26,  6.64s/it]Task 7, Epoch 17/20 => Loss 0.039, Train_accy 82.95:  80%|████████  | 16/20 [01:20<00:26,  6.64s/it]                 Task 7, Epoch 17/20 => Loss 0.039, Train_accy 82.95:  85%|████████▌ | 17/20 [01:20<00:15,  5.01s/it]Task 7, Epoch 18/20 => Loss 0.032, Train_accy 85.27:  85%|████████▌ | 17/20 [01:22<00:15,  5.01s/it]Task 7, Epoch 18/20 => Loss 0.032, Train_accy 85.27:  90%|█████████ | 18/20 [01:22<00:07,  3.86s/it]Task 7, Epoch 19/20 => Loss 0.050, Train_accy 82.17:  90%|█████████ | 18/20 [01:23<00:07,  3.86s/it]Task 7, Epoch 19/20 => Loss 0.050, Train_accy 82.17:  95%|█████████▌| 19/20 [01:23<00:03,  3.05s/it]Task 7, Epoch 20/20 => Loss 0.007, Train_accy 89.92:  95%|█████████▌| 19/20 [01:24<00:03,  3.05s/it]Task 7, Epoch 20/20 => Loss 0.007, Train_accy 89.92: 100%|██████████| 20/20 [01:24<00:00,  2.48s/it]Task 7, Epoch 20/20 => Loss 0.007, Train_accy 89.92: 100%|██████████| 20/20 [01:24<00:00,  4.22s/it]
2024-05-09 22:20:42,393 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.007, Train_accy 89.92
2024-05-09 22:20:57,622 [trainer.py] => No NME accuracy.
2024-05-09 22:20:57,622 [trainer.py] => CNN: {'total': 39.3, '00-04': 37.41, '05-09': 42.78, '10-14': 17.48, '15-19': 20.01, '20-24': 27.17, '25-29': 36.77, '30-34': 81.26, '35-39': 87.93, 'old': 35.27, 'new': 87.93}
2024-05-09 22:20:57,622 [trainer.py] => CNN top1 curve: [96.5, 92.13, 76.56, 84.3, 69.09, 71.74, 34.93, 39.3]
2024-05-09 22:20:57,622 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.03, 98.67, 98.49, 97.59, 69.23, 81.99]

Average Accuracy (CNN): 70.57
2024-05-09 22:20:57,622 [trainer.py] => Average Accuracy (CNN): 70.57 

2024-05-09 22:20:57,623 [trainer.py] => Train Time: 514.27
2024-05-09 22:20:57,623 [trainer.py] => Test Time: 67.73 

2024-05-09 22:20:57,623 [trainer.py] => All params: 85829416
2024-05-09 22:20:57,624 [trainer.py] => Trainable params: 85829416
2024-05-09 22:20:57,625 [finetune.py] => Learning on 40-45
  0%|          | 0/20 [00:00<?, ?it/s]Task 8, Epoch 1/20 => Loss 1.433, Train_accy 28.87, Test_accy 36.49:   0%|          | 0/20 [00:21<?, ?it/s]Task 8, Epoch 1/20 => Loss 1.433, Train_accy 28.87, Test_accy 36.49:   5%|▌         | 1/20 [00:21<06:44, 21.29s/it]Task 8, Epoch 2/20 => Loss 0.260, Train_accy 52.92:   5%|▌         | 1/20 [00:23<06:44, 21.29s/it]                 Task 8, Epoch 2/20 => Loss 0.260, Train_accy 52.92:  10%|█         | 2/20 [00:23<03:01, 10.06s/it]Task 8, Epoch 3/20 => Loss 0.206, Train_accy 84.88:  10%|█         | 2/20 [00:25<03:01, 10.06s/it]Task 8, Epoch 3/20 => Loss 0.206, Train_accy 84.88:  15%|█▌        | 3/20 [00:25<01:51,  6.54s/it]Task 8, Epoch 4/20 => Loss 0.114, Train_accy 91.75:  15%|█▌        | 3/20 [00:28<01:51,  6.54s/it]Task 8, Epoch 4/20 => Loss 0.114, Train_accy 91.75:  20%|██        | 4/20 [00:28<01:17,  4.82s/it]Task 8, Epoch 5/20 => Loss 0.038, Train_accy 94.50:  20%|██        | 4/20 [00:30<01:17,  4.82s/it]Task 8, Epoch 5/20 => Loss 0.038, Train_accy 94.50:  25%|██▌       | 5/20 [00:30<00:58,  3.89s/it]Task 8, Epoch 6/20 => Loss 0.069, Train_accy 95.53, Test_accy 28.41:  25%|██▌       | 5/20 [00:51<00:58,  3.89s/it]Task 8, Epoch 6/20 => Loss 0.069, Train_accy 95.53, Test_accy 28.41:  30%|███       | 6/20 [00:51<02:15,  9.71s/it]Task 8, Epoch 7/20 => Loss 1.220, Train_accy 77.32:  30%|███       | 6/20 [00:53<02:15,  9.71s/it]                 Task 8, Epoch 7/20 => Loss 1.220, Train_accy 77.32:  35%|███▌      | 7/20 [00:53<01:34,  7.28s/it]Task 8, Epoch 8/20 => Loss 0.408, Train_accy 52.23:  35%|███▌      | 7/20 [00:55<01:34,  7.28s/it]Task 8, Epoch 8/20 => Loss 0.408, Train_accy 52.23:  40%|████      | 8/20 [00:55<01:08,  5.68s/it]Task 8, Epoch 9/20 => Loss 0.189, Train_accy 82.82:  40%|████      | 8/20 [00:57<01:08,  5.68s/it]Task 8, Epoch 9/20 => Loss 0.189, Train_accy 82.82:  45%|████▌     | 9/20 [00:57<00:50,  4.59s/it]Task 8, Epoch 10/20 => Loss 0.220, Train_accy 90.38:  45%|████▌     | 9/20 [01:00<00:50,  4.59s/it]Task 8, Epoch 10/20 => Loss 0.220, Train_accy 90.38:  50%|█████     | 10/20 [01:00<00:38,  3.88s/it]Task 8, Epoch 11/20 => Loss 0.270, Train_accy 82.13, Test_accy 39.28:  50%|█████     | 10/20 [01:21<00:38,  3.88s/it]Task 8, Epoch 11/20 => Loss 0.270, Train_accy 82.13, Test_accy 39.28:  55%|█████▌    | 11/20 [01:21<01:22,  9.22s/it]Task 8, Epoch 12/20 => Loss 0.147, Train_accy 86.25:  55%|█████▌    | 11/20 [01:23<01:22,  9.22s/it]                 Task 8, Epoch 12/20 => Loss 0.147, Train_accy 86.25:  60%|██████    | 12/20 [01:23<00:56,  7.08s/it]Task 8, Epoch 13/20 => Loss 0.129, Train_accy 87.29:  60%|██████    | 12/20 [01:26<00:56,  7.08s/it]Task 8, Epoch 13/20 => Loss 0.129, Train_accy 87.29:  65%|██████▌   | 13/20 [01:26<00:39,  5.62s/it]Task 8, Epoch 14/20 => Loss 0.082, Train_accy 95.53:  65%|██████▌   | 13/20 [01:28<00:39,  5.62s/it]Task 8, Epoch 14/20 => Loss 0.082, Train_accy 95.53:  70%|███████   | 14/20 [01:28<00:27,  4.59s/it]Task 8, Epoch 15/20 => Loss 0.079, Train_accy 95.88:  70%|███████   | 14/20 [01:30<00:27,  4.59s/it]Task 8, Epoch 15/20 => Loss 0.079, Train_accy 95.88:  75%|███████▌  | 15/20 [01:30<00:19,  3.89s/it]Task 8, Epoch 16/20 => Loss 0.058, Train_accy 94.16, Test_accy 43.59:  75%|███████▌  | 15/20 [01:51<00:19,  3.89s/it]Task 8, Epoch 16/20 => Loss 0.058, Train_accy 94.16, Test_accy 43.59:  80%|████████  | 16/20 [01:51<00:36,  9.05s/it]Task 8, Epoch 17/20 => Loss 0.050, Train_accy 97.25:  80%|████████  | 16/20 [01:53<00:36,  9.05s/it]                 Task 8, Epoch 17/20 => Loss 0.050, Train_accy 97.25:  85%|████████▌ | 17/20 [01:53<00:21,  7.02s/it]Task 8, Epoch 18/20 => Loss 0.066, Train_accy 97.94:  85%|████████▌ | 17/20 [01:56<00:21,  7.02s/it]Task 8, Epoch 18/20 => Loss 0.066, Train_accy 97.94:  90%|█████████ | 18/20 [01:56<00:11,  5.58s/it]Task 8, Epoch 19/20 => Loss 0.196, Train_accy 82.13:  90%|█████████ | 18/20 [01:58<00:11,  5.58s/it]Task 8, Epoch 19/20 => Loss 0.196, Train_accy 82.13:  95%|█████████▌| 19/20 [01:58<00:04,  4.59s/it]Task 8, Epoch 20/20 => Loss 0.405, Train_accy 84.19:  95%|█████████▌| 19/20 [02:00<00:04,  4.59s/it]Task 8, Epoch 20/20 => Loss 0.405, Train_accy 84.19: 100%|██████████| 20/20 [02:00<00:00,  3.90s/it]Task 8, Epoch 20/20 => Loss 0.405, Train_accy 84.19: 100%|██████████| 20/20 [02:00<00:00,  6.03s/it]
2024-05-09 22:22:58,288 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.405, Train_accy 84.19
2024-05-09 22:23:17,164 [trainer.py] => No NME accuracy.
2024-05-09 22:23:17,165 [trainer.py] => CNN: {'total': 36.86, '00-04': 14.69, '05-09': 12.22, '10-14': 43.63, '15-19': 14.12, '20-24': 31.71, '25-29': 41.27, '30-34': 37.73, '35-39': 27.79, '40-44': 73.44, 'old': 27.16, 'new': 73.44}
2024-05-09 22:23:17,165 [trainer.py] => CNN top1 curve: [96.5, 92.13, 76.56, 84.3, 69.09, 71.74, 34.93, 39.3, 36.86]
2024-05-09 22:23:17,165 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.03, 98.67, 98.49, 97.59, 69.23, 81.99, 83.89]

Average Accuracy (CNN): 66.82
2024-05-09 22:23:17,165 [trainer.py] => Average Accuracy (CNN): 66.82 

2024-05-09 22:23:17,165 [trainer.py] => Train Time: 634.93
2024-05-09 22:23:17,165 [trainer.py] => Test Time: 86.60000000000001 

2024-05-09 22:23:17,166 [trainer.py] => All params: 85833261
2024-05-09 22:23:17,166 [trainer.py] => Trainable params: 85833261
2024-05-09 22:23:17,168 [finetune.py] => Learning on 45-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 9, Epoch 1/20 => Loss 0.808, Train_accy 8.02, Test_accy 28.75:   0%|          | 0/20 [00:24<?, ?it/s]Task 9, Epoch 1/20 => Loss 0.808, Train_accy 8.02, Test_accy 28.75:   5%|▌         | 1/20 [00:24<07:43, 24.39s/it]Task 9, Epoch 2/20 => Loss 0.168, Train_accy 38.17:   5%|▌         | 1/20 [00:26<07:43, 24.39s/it]                Task 9, Epoch 2/20 => Loss 0.168, Train_accy 38.17:  10%|█         | 2/20 [00:26<03:22, 11.24s/it]Task 9, Epoch 3/20 => Loss 0.112, Train_accy 63.36:  10%|█         | 2/20 [00:28<03:22, 11.24s/it]Task 9, Epoch 3/20 => Loss 0.112, Train_accy 63.36:  15%|█▌        | 3/20 [00:28<02:00,  7.08s/it]Task 9, Epoch 4/20 => Loss 0.132, Train_accy 72.90:  15%|█▌        | 3/20 [00:30<02:00,  7.08s/it]Task 9, Epoch 4/20 => Loss 0.132, Train_accy 72.90:  20%|██        | 4/20 [00:30<01:20,  5.06s/it]Task 9, Epoch 5/20 => Loss 0.038, Train_accy 66.79:  20%|██        | 4/20 [00:32<01:20,  5.06s/it]Task 9, Epoch 5/20 => Loss 0.038, Train_accy 66.79:  25%|██▌       | 5/20 [00:32<01:00,  4.02s/it]Task 9, Epoch 6/20 => Loss 0.081, Train_accy 80.53, Test_accy 29.23:  25%|██▌       | 5/20 [00:56<01:00,  4.02s/it]Task 9, Epoch 6/20 => Loss 0.081, Train_accy 80.53, Test_accy 29.23:  30%|███       | 6/20 [00:56<02:32, 10.90s/it]Task 9, Epoch 7/20 => Loss 0.034, Train_accy 70.99:  30%|███       | 6/20 [00:59<02:32, 10.90s/it]                 Task 9, Epoch 7/20 => Loss 0.034, Train_accy 70.99:  35%|███▌      | 7/20 [00:59<01:44,  8.04s/it]Task 9, Epoch 8/20 => Loss 0.046, Train_accy 77.86:  35%|███▌      | 7/20 [01:01<01:44,  8.04s/it]Task 9, Epoch 8/20 => Loss 0.046, Train_accy 77.86:  40%|████      | 8/20 [01:01<01:13,  6.17s/it]Task 9, Epoch 9/20 => Loss 0.088, Train_accy 70.99:  40%|████      | 8/20 [01:03<01:13,  6.17s/it]Task 9, Epoch 9/20 => Loss 0.088, Train_accy 70.99:  45%|████▌     | 9/20 [01:03<00:53,  4.87s/it]Task 9, Epoch 10/20 => Loss 0.051, Train_accy 50.38:  45%|████▌     | 9/20 [01:05<00:53,  4.87s/it]Task 9, Epoch 10/20 => Loss 0.051, Train_accy 50.38:  50%|█████     | 10/20 [01:05<00:39,  4.00s/it]Task 9, Epoch 11/20 => Loss 0.033, Train_accy 46.18, Test_accy 30.47:  50%|█████     | 10/20 [01:29<00:39,  4.00s/it]Task 9, Epoch 11/20 => Loss 0.033, Train_accy 46.18, Test_accy 30.47:  55%|█████▌    | 11/20 [01:29<01:32, 10.30s/it]Task 9, Epoch 12/20 => Loss 0.036, Train_accy 52.29:  55%|█████▌    | 11/20 [01:31<01:32, 10.30s/it]                 Task 9, Epoch 12/20 => Loss 0.036, Train_accy 52.29:  60%|██████    | 12/20 [01:31<01:02,  7.79s/it]Task 9, Epoch 13/20 => Loss 0.036, Train_accy 66.79:  60%|██████    | 12/20 [01:33<01:02,  7.79s/it]Task 9, Epoch 13/20 => Loss 0.036, Train_accy 66.79:  65%|██████▌   | 13/20 [01:33<00:42,  6.03s/it]Task 9, Epoch 14/20 => Loss 0.055, Train_accy 75.95:  65%|██████▌   | 13/20 [01:35<00:42,  6.03s/it]Task 9, Epoch 14/20 => Loss 0.055, Train_accy 75.95:  70%|███████   | 14/20 [01:35<00:28,  4.83s/it]Task 9, Epoch 15/20 => Loss 0.074, Train_accy 72.90:  70%|███████   | 14/20 [01:38<00:28,  4.83s/it]Task 9, Epoch 15/20 => Loss 0.074, Train_accy 72.90:  75%|███████▌  | 15/20 [01:38<00:20,  4.03s/it]Task 9, Epoch 16/20 => Loss 0.104, Train_accy 50.76, Test_accy 23.52:  75%|███████▌  | 15/20 [02:02<00:20,  4.03s/it]Task 9, Epoch 16/20 => Loss 0.104, Train_accy 50.76, Test_accy 23.52:  80%|████████  | 16/20 [02:02<00:40, 10.17s/it]Task 9, Epoch 17/20 => Loss 0.086, Train_accy 50.38:  80%|████████  | 16/20 [02:04<00:40, 10.17s/it]                 Task 9, Epoch 17/20 => Loss 0.086, Train_accy 50.38:  85%|████████▌ | 17/20 [02:04<00:23,  7.74s/it]Task 9, Epoch 18/20 => Loss 0.051, Train_accy 53.05:  85%|████████▌ | 17/20 [02:06<00:23,  7.74s/it]Task 9, Epoch 18/20 => Loss 0.051, Train_accy 53.05:  90%|█████████ | 18/20 [02:06<00:12,  6.01s/it]Task 9, Epoch 19/20 => Loss 0.035, Train_accy 51.53:  90%|█████████ | 18/20 [02:08<00:12,  6.01s/it]Task 9, Epoch 19/20 => Loss 0.035, Train_accy 51.53:  95%|█████████▌| 19/20 [02:08<00:04,  4.84s/it]Task 9, Epoch 20/20 => Loss 0.011, Train_accy 53.05:  95%|█████████▌| 19/20 [02:10<00:04,  4.84s/it]Task 9, Epoch 20/20 => Loss 0.011, Train_accy 53.05: 100%|██████████| 20/20 [02:10<00:00,  4.01s/it]Task 9, Epoch 20/20 => Loss 0.011, Train_accy 53.05: 100%|██████████| 20/20 [02:10<00:00,  6.54s/it]
2024-05-09 22:25:28,054 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.011, Train_accy 53.05
2024-05-09 22:25:50,235 [trainer.py] => No NME accuracy.
2024-05-09 22:25:50,235 [trainer.py] => CNN: {'total': 34.13, '00-04': 5.94, '05-09': 4.63, '10-14': 8.99, '15-19': 27.47, '20-24': 25.1, '25-29': 25.4, '30-34': 22.19, '35-39': 25.74, '40-44': 66.27, '45-49': 54.53, 'old': 30.29, 'new': 54.53}
2024-05-09 22:25:50,235 [trainer.py] => CNN top1 curve: [96.5, 92.13, 76.56, 84.3, 69.09, 71.74, 34.93, 39.3, 36.86, 34.13]
2024-05-09 22:25:50,236 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.03, 98.67, 98.49, 97.59, 69.23, 81.99, 83.89, 76.42]

Average Accuracy (CNN): 63.55
2024-05-09 22:25:50,236 [trainer.py] => Average Accuracy (CNN): 63.55 

2024-05-09 22:25:50,236 [trainer.py] => Train Time: 765.81
2024-05-09 22:25:50,236 [trainer.py] => Test Time: 108.78 

Accuracy Matrix (CNN):
[[96.5  91.96 69.58 86.01 41.61 51.75 30.07 37.41 14.69  5.94]
 [ 0.   92.22 55.93 75.37 40.   59.63 21.67 42.78 12.22  4.63]
 [ 0.    0.   98.04 71.9  54.41 75.65 15.69 17.48 43.63  8.99]
 [ 0.    0.    0.   92.76 70.83 65.37  6.53 20.01 14.12 27.47]
 [ 0.    0.    0.    0.   93.07 81.59 41.67 27.17 31.71 25.1 ]
 [ 0.    0.    0.    0.    0.   88.89 52.12 36.77 41.27 25.4 ]
 [ 0.    0.    0.    0.    0.    0.   90.88 81.26 37.73 22.19]
 [ 0.    0.    0.    0.    0.    0.    0.   87.93 27.79 25.74]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   73.44 66.27]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   54.53]]
2024-05-09 22:25:50,237 [trainer.py] => Forgetting (CNN): 66.88888888888889
2024-05-09 22:25:52,960 [trainer.py] => config: ./exps/icarl_vtab_B0_Inc10.json
2024-05-09 22:25:52,961 [trainer.py] => prefix: reproduce
2024-05-09 22:25:52,961 [trainer.py] => dataset: cifar224
2024-05-09 22:25:52,961 [trainer.py] => memory_size: 1000
2024-05-09 22:25:52,961 [trainer.py] => memory_per_class: 20
2024-05-09 22:25:52,961 [trainer.py] => fixed_memory: True
2024-05-09 22:25:52,961 [trainer.py] => shuffle: True
2024-05-09 22:25:52,961 [trainer.py] => init_cls: 5
2024-05-09 22:25:52,961 [trainer.py] => increment: 5
2024-05-09 22:25:52,961 [trainer.py] => model_name: icarl
2024-05-09 22:25:52,961 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-05-09 22:25:52,961 [trainer.py] => device: [device(type='cuda', index=4)]
2024-05-09 22:25:52,961 [trainer.py] => seed: 1993
2024-05-09 22:25:52,961 [trainer.py] => init_epoch: 20
2024-05-09 22:25:52,961 [trainer.py] => init_lr: 0.001
2024-05-09 22:25:52,961 [trainer.py] => init_milestones: [60, 120, 170]
2024-05-09 22:25:52,961 [trainer.py] => init_lr_decay: 0.1
2024-05-09 22:25:52,961 [trainer.py] => init_weight_decay: 0.0005
2024-05-09 22:25:52,961 [trainer.py] => epochs: 20
2024-05-09 22:25:52,961 [trainer.py] => lrate: 0.001
2024-05-09 22:25:52,961 [trainer.py] => milestones: [80, 120]
2024-05-09 22:25:52,961 [trainer.py] => lrate_decay: 0.1
2024-05-09 22:25:52,961 [trainer.py] => batch_size: 48
2024-05-09 22:25:52,962 [trainer.py] => weight_decay: 0.0002
2024-05-09 22:25:52,962 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-05-09 22:25:55,069 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-05-09 22:25:58,933 [trainer.py] => All params: 85798656
2024-05-09 22:25:58,934 [trainer.py] => Trainable params: 85798656
2024-05-09 22:25:58,934 [icarl.py] => Learning on 0-5
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.707, Train_accy 75.04, Test_accy 98.40:   0%|          | 0/20 [00:18<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.707, Train_accy 75.04, Test_accy 98.40:   5%|▌         | 1/20 [00:18<05:53, 18.59s/it]Task 0, Epoch 2/20 => Loss 0.275, Train_accy 90.24:   5%|▌         | 1/20 [00:35<05:53, 18.59s/it]                 Task 0, Epoch 2/20 => Loss 0.275, Train_accy 90.24:  10%|█         | 2/20 [00:35<05:16, 17.58s/it]Task 0, Epoch 3/20 => Loss 0.211, Train_accy 92.16:  10%|█         | 2/20 [00:52<05:16, 17.58s/it]Task 0, Epoch 3/20 => Loss 0.211, Train_accy 92.16:  15%|█▌        | 3/20 [00:52<04:52, 17.23s/it]Task 0, Epoch 4/20 => Loss 0.239, Train_accy 91.88:  15%|█▌        | 3/20 [01:09<04:52, 17.23s/it]Task 0, Epoch 4/20 => Loss 0.239, Train_accy 91.88:  20%|██        | 4/20 [01:09<04:33, 17.12s/it]Task 0, Epoch 5/20 => Loss 0.184, Train_accy 93.96:  20%|██        | 4/20 [01:26<04:33, 17.12s/it]Task 0, Epoch 5/20 => Loss 0.184, Train_accy 93.96:  25%|██▌       | 5/20 [01:26<04:16, 17.10s/it]Task 0, Epoch 6/20 => Loss 0.245, Train_accy 92.08, Test_accy 99.00:  25%|██▌       | 5/20 [01:44<04:16, 17.10s/it]Task 0, Epoch 6/20 => Loss 0.245, Train_accy 92.08, Test_accy 99.00:  30%|███       | 6/20 [01:44<04:06, 17.63s/it]Task 0, Epoch 7/20 => Loss 0.150, Train_accy 94.48:  30%|███       | 6/20 [02:01<04:06, 17.63s/it]                 Task 0, Epoch 7/20 => Loss 0.150, Train_accy 94.48:  35%|███▌      | 7/20 [02:01<03:46, 17.42s/it]Task 0, Epoch 8/20 => Loss 0.140, Train_accy 94.76:  35%|███▌      | 7/20 [02:18<03:46, 17.42s/it]Task 0, Epoch 8/20 => Loss 0.140, Train_accy 94.76:  40%|████      | 8/20 [02:18<03:27, 17.26s/it]Task 0, Epoch 9/20 => Loss 0.119, Train_accy 95.76:  40%|████      | 8/20 [02:35<03:27, 17.26s/it]Task 0, Epoch 9/20 => Loss 0.119, Train_accy 95.76:  45%|████▌     | 9/20 [02:35<03:08, 17.17s/it]Task 0, Epoch 10/20 => Loss 0.130, Train_accy 95.44:  45%|████▌     | 9/20 [02:52<03:08, 17.17s/it]Task 0, Epoch 10/20 => Loss 0.130, Train_accy 95.44:  50%|█████     | 10/20 [02:52<02:50, 17.09s/it]Task 0, Epoch 11/20 => Loss 0.118, Train_accy 95.64, Test_accy 99.40:  50%|█████     | 10/20 [03:11<02:50, 17.09s/it]Task 0, Epoch 11/20 => Loss 0.118, Train_accy 95.64, Test_accy 99.40:  55%|█████▌    | 11/20 [03:11<02:37, 17.55s/it]Task 0, Epoch 12/20 => Loss 0.130, Train_accy 95.76:  55%|█████▌    | 11/20 [03:28<02:37, 17.55s/it]                 Task 0, Epoch 12/20 => Loss 0.130, Train_accy 95.76:  60%|██████    | 12/20 [03:28<02:18, 17.34s/it]Task 0, Epoch 13/20 => Loss 0.159, Train_accy 94.64:  60%|██████    | 12/20 [03:45<02:18, 17.34s/it]Task 0, Epoch 13/20 => Loss 0.159, Train_accy 94.64:  65%|██████▌   | 13/20 [03:45<02:00, 17.24s/it]Task 0, Epoch 14/20 => Loss 0.128, Train_accy 96.12:  65%|██████▌   | 13/20 [04:02<02:00, 17.24s/it]Task 0, Epoch 14/20 => Loss 0.128, Train_accy 96.12:  70%|███████   | 14/20 [04:02<01:42, 17.16s/it]Task 0, Epoch 15/20 => Loss 0.211, Train_accy 92.20:  70%|███████   | 14/20 [04:19<01:42, 17.16s/it]Task 0, Epoch 15/20 => Loss 0.211, Train_accy 92.20:  75%|███████▌  | 15/20 [04:19<01:25, 17.08s/it]Task 0, Epoch 16/20 => Loss 0.116, Train_accy 96.16, Test_accy 98.60:  75%|███████▌  | 15/20 [04:37<01:25, 17.08s/it]Task 0, Epoch 16/20 => Loss 0.116, Train_accy 96.16, Test_accy 98.60:  80%|████████  | 16/20 [04:37<01:09, 17.48s/it]Task 0, Epoch 17/20 => Loss 0.130, Train_accy 95.44:  80%|████████  | 16/20 [04:54<01:09, 17.48s/it]                 Task 0, Epoch 17/20 => Loss 0.130, Train_accy 95.44:  85%|████████▌ | 17/20 [04:54<00:51, 17.31s/it]Task 0, Epoch 18/20 => Loss 0.109, Train_accy 95.96:  85%|████████▌ | 17/20 [05:11<00:51, 17.31s/it]Task 0, Epoch 18/20 => Loss 0.109, Train_accy 95.96:  90%|█████████ | 18/20 [05:11<00:34, 17.21s/it]Task 0, Epoch 19/20 => Loss 0.096, Train_accy 96.92:  90%|█████████ | 18/20 [05:28<00:34, 17.21s/it]Task 0, Epoch 19/20 => Loss 0.096, Train_accy 96.92:  95%|█████████▌| 19/20 [05:28<00:17, 17.09s/it]Task 0, Epoch 20/20 => Loss 0.099, Train_accy 96.40:  95%|█████████▌| 19/20 [05:45<00:17, 17.09s/it]Task 0, Epoch 20/20 => Loss 0.099, Train_accy 96.40: 100%|██████████| 20/20 [05:45<00:00, 17.02s/it]Task 0, Epoch 20/20 => Loss 0.099, Train_accy 96.40: 100%|██████████| 20/20 [05:45<00:00, 17.25s/it]
2024-05-09 22:31:44,444 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.099, Train_accy 96.40
2024-05-09 22:31:44,445 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-09 22:31:56,756 [icarl.py] => Exemplar size: 100
2024-05-09 22:31:56,756 [trainer.py] => CNN: {'total': 99.8, '00-04': 99.8, 'old': 0, 'new': 99.8}
2024-05-09 22:31:56,756 [trainer.py] => NME: {'total': 100.0, '00-04': 100.0, 'old': 0, 'new': 100.0}
2024-05-09 22:31:56,756 [trainer.py] => CNN top1 curve: [99.8]
2024-05-09 22:31:56,756 [trainer.py] => CNN top5 curve: [100.0]
2024-05-09 22:31:56,756 [trainer.py] => NME top1 curve: [100.0]
2024-05-09 22:31:56,756 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 99.8
Average Accuracy (NME): 100.0
2024-05-09 22:31:56,756 [trainer.py] => Average Accuracy (CNN): 99.8
2024-05-09 22:31:56,757 [trainer.py] => Average Accuracy (NME): 100.0
2024-05-09 22:31:56,757 [trainer.py] => Train Time: 0
2024-05-09 22:31:56,757 [trainer.py] => Test Time: 3.22 

2024-05-09 22:31:56,758 [trainer.py] => All params: 85802501
2024-05-09 22:31:56,758 [trainer.py] => Trainable params: 85802501
2024-05-09 22:31:56,760 [icarl.py] => Learning on 5-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.825, Train_accy 76.62, Test_accy 95.90:   0%|          | 0/20 [00:26<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.825, Train_accy 76.62, Test_accy 95.90:   5%|▌         | 1/20 [00:26<08:25, 26.58s/it]Task 1, Epoch 2/20 => Loss 1.322, Train_accy 91.23:   5%|▌         | 1/20 [00:50<08:25, 26.58s/it]                 Task 1, Epoch 2/20 => Loss 1.322, Train_accy 91.23:  10%|█         | 2/20 [00:50<07:27, 24.84s/it]Task 1, Epoch 3/20 => Loss 1.287, Train_accy 91.88:  10%|█         | 2/20 [01:13<07:27, 24.84s/it]Task 1, Epoch 3/20 => Loss 1.287, Train_accy 91.88:  15%|█▌        | 3/20 [01:13<06:52, 24.25s/it]Task 1, Epoch 4/20 => Loss 1.255, Train_accy 92.62:  15%|█▌        | 3/20 [01:37<06:52, 24.25s/it]Task 1, Epoch 4/20 => Loss 1.255, Train_accy 92.62:  20%|██        | 4/20 [01:37<06:24, 24.01s/it]Task 1, Epoch 5/20 => Loss 1.229, Train_accy 93.35:  20%|██        | 4/20 [02:01<06:24, 24.01s/it]Task 1, Epoch 5/20 => Loss 1.229, Train_accy 93.35:  25%|██▌       | 5/20 [02:01<05:58, 23.87s/it]Task 1, Epoch 6/20 => Loss 1.246, Train_accy 93.42, Test_accy 97.00:  25%|██▌       | 5/20 [02:27<05:58, 23.87s/it]Task 1, Epoch 6/20 => Loss 1.246, Train_accy 93.42, Test_accy 97.00:  30%|███       | 6/20 [02:27<05:46, 24.74s/it]Task 1, Epoch 7/20 => Loss 1.231, Train_accy 94.27:  30%|███       | 6/20 [02:51<05:46, 24.74s/it]                 Task 1, Epoch 7/20 => Loss 1.231, Train_accy 94.27:  35%|███▌      | 7/20 [02:51<05:16, 24.38s/it]Task 1, Epoch 8/20 => Loss 1.222, Train_accy 94.96:  35%|███▌      | 7/20 [03:14<05:16, 24.38s/it]Task 1, Epoch 8/20 => Loss 1.222, Train_accy 94.96:  40%|████      | 8/20 [03:14<04:49, 24.15s/it]Task 1, Epoch 9/20 => Loss 1.231, Train_accy 94.12:  40%|████      | 8/20 [03:38<04:49, 24.15s/it]Task 1, Epoch 9/20 => Loss 1.231, Train_accy 94.12:  45%|████▌     | 9/20 [03:38<04:23, 23.98s/it]Task 1, Epoch 10/20 => Loss 1.228, Train_accy 94.46:  45%|████▌     | 9/20 [04:01<04:23, 23.98s/it]Task 1, Epoch 10/20 => Loss 1.228, Train_accy 94.46:  50%|█████     | 10/20 [04:01<03:58, 23.84s/it]Task 1, Epoch 11/20 => Loss 1.186, Train_accy 95.12, Test_accy 97.30:  50%|█████     | 10/20 [04:28<03:58, 23.84s/it]Task 1, Epoch 11/20 => Loss 1.186, Train_accy 95.12, Test_accy 97.30:  55%|█████▌    | 11/20 [04:28<03:42, 24.69s/it]Task 1, Epoch 12/20 => Loss 1.218, Train_accy 94.65:  55%|█████▌    | 11/20 [04:52<03:42, 24.69s/it]                 Task 1, Epoch 12/20 => Loss 1.218, Train_accy 94.65:  60%|██████    | 12/20 [04:52<03:14, 24.34s/it]Task 1, Epoch 13/20 => Loss 1.205, Train_accy 94.77:  60%|██████    | 12/20 [05:15<03:14, 24.34s/it]Task 1, Epoch 13/20 => Loss 1.205, Train_accy 94.77:  65%|██████▌   | 13/20 [05:15<02:48, 24.13s/it]Task 1, Epoch 14/20 => Loss 1.231, Train_accy 94.42:  65%|██████▌   | 13/20 [05:39<02:48, 24.13s/it]Task 1, Epoch 14/20 => Loss 1.231, Train_accy 94.42:  70%|███████   | 14/20 [05:39<02:24, 24.01s/it]Task 1, Epoch 15/20 => Loss 1.205, Train_accy 94.88:  70%|███████   | 14/20 [06:03<02:24, 24.01s/it]Task 1, Epoch 15/20 => Loss 1.205, Train_accy 94.88:  75%|███████▌  | 15/20 [06:03<01:59, 23.92s/it]Task 1, Epoch 16/20 => Loss 1.220, Train_accy 94.62, Test_accy 96.60:  75%|███████▌  | 15/20 [06:29<01:59, 23.92s/it]Task 1, Epoch 16/20 => Loss 1.220, Train_accy 94.62, Test_accy 96.60:  80%|████████  | 16/20 [06:29<01:38, 24.69s/it]Task 1, Epoch 17/20 => Loss 1.196, Train_accy 95.23:  80%|████████  | 16/20 [06:53<01:38, 24.69s/it]                 Task 1, Epoch 17/20 => Loss 1.196, Train_accy 95.23:  85%|████████▌ | 17/20 [06:53<01:13, 24.37s/it]Task 1, Epoch 18/20 => Loss 1.207, Train_accy 94.73:  85%|████████▌ | 17/20 [07:16<01:13, 24.37s/it]Task 1, Epoch 18/20 => Loss 1.207, Train_accy 94.73:  90%|█████████ | 18/20 [07:16<00:48, 24.13s/it]Task 1, Epoch 19/20 => Loss 1.197, Train_accy 94.69:  90%|█████████ | 18/20 [07:40<00:48, 24.13s/it]Task 1, Epoch 19/20 => Loss 1.197, Train_accy 94.69:  95%|█████████▌| 19/20 [07:40<00:23, 23.95s/it]Task 1, Epoch 20/20 => Loss 1.161, Train_accy 95.65:  95%|█████████▌| 19/20 [08:03<00:23, 23.95s/it]Task 1, Epoch 20/20 => Loss 1.161, Train_accy 95.65: 100%|██████████| 20/20 [08:03<00:00, 23.86s/it]Task 1, Epoch 20/20 => Loss 1.161, Train_accy 95.65: 100%|██████████| 20/20 [08:03<00:00, 24.20s/it]
2024-05-09 22:40:00,788 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.161, Train_accy 95.65
2024-05-09 22:40:00,789 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-09 22:40:16,662 [icarl.py] => Exemplar size: 200
2024-05-09 22:40:16,662 [trainer.py] => CNN: {'total': 97.0, '00-04': 95.6, '05-09': 98.4, 'old': 95.6, 'new': 98.4}
2024-05-09 22:40:16,662 [trainer.py] => NME: {'total': 98.8, '00-04': 99.8, '05-09': 97.8, 'old': 99.8, 'new': 97.8}
2024-05-09 22:40:16,662 [trainer.py] => CNN top1 curve: [99.8, 97.0]
2024-05-09 22:40:16,662 [trainer.py] => CNN top5 curve: [100.0, 100.0]
2024-05-09 22:40:16,662 [trainer.py] => NME top1 curve: [100.0, 98.8]
2024-05-09 22:40:16,663 [trainer.py] => NME top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 98.4
Average Accuracy (NME): 99.4
2024-05-09 22:40:16,663 [trainer.py] => Average Accuracy (CNN): 98.4
2024-05-09 22:40:16,663 [trainer.py] => Average Accuracy (NME): 99.4
2024-05-09 22:40:16,663 [trainer.py] => Train Time: 0
2024-05-09 22:40:16,663 [trainer.py] => Test Time: 8.74 

2024-05-09 22:40:16,663 [trainer.py] => All params: 85806346
2024-05-09 22:40:16,664 [trainer.py] => Trainable params: 85806346
2024-05-09 22:40:16,664 [icarl.py] => Learning on 10-15
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.279, Train_accy 74.59, Test_accy 87.73:   0%|          | 0/20 [00:28<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.279, Train_accy 74.59, Test_accy 87.73:   5%|▌         | 1/20 [00:28<09:01, 28.50s/it]Task 2, Epoch 2/20 => Loss 1.475, Train_accy 89.81:   5%|▌         | 1/20 [00:53<09:01, 28.50s/it]                 Task 2, Epoch 2/20 => Loss 1.475, Train_accy 89.81:  10%|█         | 2/20 [00:53<07:50, 26.15s/it]Task 2, Epoch 3/20 => Loss 1.414, Train_accy 92.33:  10%|█         | 2/20 [01:17<07:50, 26.15s/it]Task 2, Epoch 3/20 => Loss 1.414, Train_accy 92.33:  15%|█▌        | 3/20 [01:17<07:11, 25.37s/it]Task 2, Epoch 4/20 => Loss 1.409, Train_accy 92.93:  15%|█▌        | 3/20 [01:42<07:11, 25.37s/it]Task 2, Epoch 4/20 => Loss 1.409, Train_accy 92.93:  20%|██        | 4/20 [01:42<06:41, 25.12s/it]Task 2, Epoch 5/20 => Loss 1.384, Train_accy 92.78:  20%|██        | 4/20 [02:06<06:41, 25.12s/it]Task 2, Epoch 5/20 => Loss 1.384, Train_accy 92.78:  25%|██▌       | 5/20 [02:06<06:13, 24.90s/it]Task 2, Epoch 6/20 => Loss 1.359, Train_accy 94.07, Test_accy 92.60:  25%|██▌       | 5/20 [02:35<06:13, 24.90s/it]Task 2, Epoch 6/20 => Loss 1.359, Train_accy 94.07, Test_accy 92.60:  30%|███       | 6/20 [02:35<06:07, 26.22s/it]Task 2, Epoch 7/20 => Loss 1.345, Train_accy 94.15:  30%|███       | 6/20 [02:59<06:07, 26.22s/it]                 Task 2, Epoch 7/20 => Loss 1.345, Train_accy 94.15:  35%|███▌      | 7/20 [02:59<05:33, 25.64s/it]Task 2, Epoch 8/20 => Loss 1.327, Train_accy 94.11:  35%|███▌      | 7/20 [03:24<05:33, 25.64s/it]Task 2, Epoch 8/20 => Loss 1.327, Train_accy 94.11:  40%|████      | 8/20 [03:24<05:03, 25.29s/it]Task 2, Epoch 9/20 => Loss 1.342, Train_accy 94.22:  40%|████      | 8/20 [03:49<05:03, 25.29s/it]Task 2, Epoch 9/20 => Loss 1.342, Train_accy 94.22:  45%|████▌     | 9/20 [03:49<04:35, 25.06s/it]Task 2, Epoch 10/20 => Loss 1.351, Train_accy 93.78:  45%|████▌     | 9/20 [04:13<04:35, 25.06s/it]Task 2, Epoch 10/20 => Loss 1.351, Train_accy 93.78:  50%|█████     | 10/20 [04:13<04:09, 24.91s/it]Task 2, Epoch 11/20 => Loss 1.304, Train_accy 94.63, Test_accy 92.27:  50%|█████     | 10/20 [04:42<04:09, 24.91s/it]Task 2, Epoch 11/20 => Loss 1.304, Train_accy 94.63, Test_accy 92.27:  55%|█████▌    | 11/20 [04:42<03:54, 26.09s/it]Task 2, Epoch 12/20 => Loss 1.336, Train_accy 94.15:  55%|█████▌    | 11/20 [05:06<03:54, 26.09s/it]                 Task 2, Epoch 12/20 => Loss 1.336, Train_accy 94.15:  60%|██████    | 12/20 [05:06<03:24, 25.58s/it]Task 2, Epoch 13/20 => Loss 1.334, Train_accy 94.41:  60%|██████    | 12/20 [05:31<03:24, 25.58s/it]Task 2, Epoch 13/20 => Loss 1.334, Train_accy 94.41:  65%|██████▌   | 13/20 [05:31<02:56, 25.24s/it]Task 2, Epoch 14/20 => Loss 1.320, Train_accy 94.37:  65%|██████▌   | 13/20 [05:55<02:56, 25.24s/it]Task 2, Epoch 14/20 => Loss 1.320, Train_accy 94.37:  70%|███████   | 14/20 [05:55<02:30, 25.01s/it]Task 2, Epoch 15/20 => Loss 1.328, Train_accy 95.70:  70%|███████   | 14/20 [06:20<02:30, 25.01s/it]Task 2, Epoch 15/20 => Loss 1.328, Train_accy 95.70:  75%|███████▌  | 15/20 [06:20<02:04, 24.88s/it]Task 2, Epoch 16/20 => Loss 1.293, Train_accy 95.56, Test_accy 93.87:  75%|███████▌  | 15/20 [06:48<02:04, 24.88s/it]Task 2, Epoch 16/20 => Loss 1.293, Train_accy 95.56, Test_accy 93.87:  80%|████████  | 16/20 [06:48<01:43, 26.00s/it]Task 2, Epoch 17/20 => Loss 1.279, Train_accy 95.67:  80%|████████  | 16/20 [07:13<01:43, 26.00s/it]                 Task 2, Epoch 17/20 => Loss 1.279, Train_accy 95.67:  85%|████████▌ | 17/20 [07:13<01:16, 25.57s/it]Task 2, Epoch 18/20 => Loss 1.356, Train_accy 93.59:  85%|████████▌ | 17/20 [07:37<01:16, 25.57s/it]Task 2, Epoch 18/20 => Loss 1.356, Train_accy 93.59:  90%|█████████ | 18/20 [07:37<00:50, 25.26s/it]Task 2, Epoch 19/20 => Loss 1.334, Train_accy 94.52:  90%|█████████ | 18/20 [08:02<00:50, 25.26s/it]Task 2, Epoch 19/20 => Loss 1.334, Train_accy 94.52:  95%|█████████▌| 19/20 [08:02<00:25, 25.07s/it]Task 2, Epoch 20/20 => Loss 1.337, Train_accy 94.30:  95%|█████████▌| 19/20 [08:27<00:25, 25.07s/it]Task 2, Epoch 20/20 => Loss 1.337, Train_accy 94.30: 100%|██████████| 20/20 [08:27<00:00, 24.89s/it]Task 2, Epoch 20/20 => Loss 1.337, Train_accy 94.30: 100%|██████████| 20/20 [08:27<00:00, 25.35s/it]
2024-05-09 22:48:43,790 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.337, Train_accy 94.30
2024-05-09 22:48:43,791 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-09 22:49:03,598 [icarl.py] => Exemplar size: 300
2024-05-09 22:49:03,598 [trainer.py] => CNN: {'total': 93.0, '00-04': 94.4, '05-09': 85.4, '10-14': 99.2, 'old': 89.9, 'new': 99.2}
2024-05-09 22:49:03,598 [trainer.py] => NME: {'total': 96.93, '00-04': 99.0, '05-09': 94.8, '10-14': 97.0, 'old': 96.9, 'new': 97.0}
2024-05-09 22:49:03,598 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0]
2024-05-09 22:49:03,598 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33]
2024-05-09 22:49:03,598 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93]
2024-05-09 22:49:03,598 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87]

Average Accuracy (CNN): 96.6
Average Accuracy (NME): 98.58
2024-05-09 22:49:03,599 [trainer.py] => Average Accuracy (CNN): 96.6
2024-05-09 22:49:03,599 [trainer.py] => Average Accuracy (NME): 98.58
2024-05-09 22:49:03,599 [trainer.py] => Train Time: 0
2024-05-09 22:49:03,599 [trainer.py] => Test Time: 17.18 

2024-05-09 22:49:03,599 [trainer.py] => All params: 85810191
2024-05-09 22:49:03,600 [trainer.py] => Trainable params: 85810191
2024-05-09 22:49:03,600 [icarl.py] => Learning on 15-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.706, Train_accy 67.79, Test_accy 83.50:   0%|          | 0/20 [00:30<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.706, Train_accy 67.79, Test_accy 83.50:   5%|▌         | 1/20 [00:30<09:43, 30.69s/it]Task 3, Epoch 2/20 => Loss 1.597, Train_accy 88.89:   5%|▌         | 1/20 [00:56<09:43, 30.69s/it]                 Task 3, Epoch 2/20 => Loss 1.597, Train_accy 88.89:  10%|█         | 2/20 [00:56<08:16, 27.60s/it]Task 3, Epoch 3/20 => Loss 1.522, Train_accy 90.32:  10%|█         | 2/20 [01:21<08:16, 27.60s/it]Task 3, Epoch 3/20 => Loss 1.522, Train_accy 90.32:  15%|█▌        | 3/20 [01:21<07:32, 26.63s/it]Task 3, Epoch 4/20 => Loss 1.457, Train_accy 91.43:  15%|█▌        | 3/20 [01:46<07:32, 26.63s/it]Task 3, Epoch 4/20 => Loss 1.457, Train_accy 91.43:  20%|██        | 4/20 [01:46<06:57, 26.11s/it]Task 3, Epoch 5/20 => Loss 1.442, Train_accy 91.96:  20%|██        | 4/20 [02:12<06:57, 26.11s/it]Task 3, Epoch 5/20 => Loss 1.442, Train_accy 91.96:  25%|██▌       | 5/20 [02:12<06:27, 25.86s/it]Task 3, Epoch 6/20 => Loss 1.424, Train_accy 92.18, Test_accy 89.15:  25%|██▌       | 5/20 [02:43<06:27, 25.86s/it]Task 3, Epoch 6/20 => Loss 1.424, Train_accy 92.18, Test_accy 89.15:  30%|███       | 6/20 [02:43<06:26, 27.60s/it]Task 3, Epoch 7/20 => Loss 1.361, Train_accy 93.96:  30%|███       | 6/20 [03:08<06:26, 27.60s/it]                 Task 3, Epoch 7/20 => Loss 1.361, Train_accy 93.96:  35%|███▌      | 7/20 [03:08<05:49, 26.88s/it]Task 3, Epoch 8/20 => Loss 1.418, Train_accy 93.46:  35%|███▌      | 7/20 [03:34<05:49, 26.88s/it]Task 3, Epoch 8/20 => Loss 1.418, Train_accy 93.46:  40%|████      | 8/20 [03:34<05:16, 26.42s/it]Task 3, Epoch 9/20 => Loss 1.364, Train_accy 93.82:  40%|████      | 8/20 [03:59<05:16, 26.42s/it]Task 3, Epoch 9/20 => Loss 1.364, Train_accy 93.82:  45%|████▌     | 9/20 [03:59<04:47, 26.12s/it]Task 3, Epoch 10/20 => Loss 1.401, Train_accy 93.71:  45%|████▌     | 9/20 [04:25<04:47, 26.12s/it]Task 3, Epoch 10/20 => Loss 1.401, Train_accy 93.71:  50%|█████     | 10/20 [04:25<04:19, 25.92s/it]Task 3, Epoch 11/20 => Loss 1.401, Train_accy 93.89, Test_accy 90.00:  50%|█████     | 10/20 [04:55<04:19, 25.92s/it]Task 3, Epoch 11/20 => Loss 1.401, Train_accy 93.89, Test_accy 90.00:  55%|█████▌    | 11/20 [04:55<04:06, 27.42s/it]Task 3, Epoch 12/20 => Loss 1.348, Train_accy 94.25:  55%|█████▌    | 11/20 [05:21<04:06, 27.42s/it]                 Task 3, Epoch 12/20 => Loss 1.348, Train_accy 94.25:  60%|██████    | 12/20 [05:21<03:34, 26.87s/it]Task 3, Epoch 13/20 => Loss 1.379, Train_accy 93.82:  60%|██████    | 12/20 [05:46<03:34, 26.87s/it]Task 3, Epoch 13/20 => Loss 1.379, Train_accy 93.82:  65%|██████▌   | 13/20 [05:46<03:05, 26.44s/it]Task 3, Epoch 14/20 => Loss 1.353, Train_accy 94.18:  65%|██████▌   | 13/20 [06:12<03:05, 26.44s/it]Task 3, Epoch 14/20 => Loss 1.353, Train_accy 94.18:  70%|███████   | 14/20 [06:12<02:36, 26.16s/it]Task 3, Epoch 15/20 => Loss 1.343, Train_accy 95.07:  70%|███████   | 14/20 [06:37<02:36, 26.16s/it]Task 3, Epoch 15/20 => Loss 1.343, Train_accy 95.07:  75%|███████▌  | 15/20 [06:37<02:09, 25.93s/it]Task 3, Epoch 16/20 => Loss 1.378, Train_accy 93.96, Test_accy 90.30:  75%|███████▌  | 15/20 [07:08<02:09, 25.93s/it]Task 3, Epoch 16/20 => Loss 1.378, Train_accy 93.96, Test_accy 90.30:  80%|████████  | 16/20 [07:08<01:49, 27.47s/it]Task 3, Epoch 17/20 => Loss 1.345, Train_accy 94.93:  80%|████████  | 16/20 [07:34<01:49, 27.47s/it]                 Task 3, Epoch 17/20 => Loss 1.345, Train_accy 94.93:  85%|████████▌ | 17/20 [07:34<01:20, 26.85s/it]Task 3, Epoch 18/20 => Loss 1.365, Train_accy 94.29:  85%|████████▌ | 17/20 [07:59<01:20, 26.85s/it]Task 3, Epoch 18/20 => Loss 1.365, Train_accy 94.29:  90%|█████████ | 18/20 [07:59<00:52, 26.40s/it]Task 3, Epoch 19/20 => Loss 1.352, Train_accy 94.07:  90%|█████████ | 18/20 [08:25<00:52, 26.40s/it]Task 3, Epoch 19/20 => Loss 1.352, Train_accy 94.07:  95%|█████████▌| 19/20 [08:25<00:26, 26.11s/it]Task 3, Epoch 20/20 => Loss 1.334, Train_accy 95.18:  95%|█████████▌| 19/20 [08:50<00:26, 26.11s/it]Task 3, Epoch 20/20 => Loss 1.334, Train_accy 95.18: 100%|██████████| 20/20 [08:50<00:00, 25.89s/it]Task 3, Epoch 20/20 => Loss 1.334, Train_accy 95.18: 100%|██████████| 20/20 [08:50<00:00, 26.52s/it]
2024-05-09 22:57:54,101 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.334, Train_accy 95.18
2024-05-09 22:57:54,103 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-09 22:58:18,444 [icarl.py] => Exemplar size: 400
2024-05-09 22:58:18,444 [trainer.py] => CNN: {'total': 91.0, '00-04': 93.8, '05-09': 80.8, '10-14': 91.2, '15-19': 98.2, 'old': 88.6, 'new': 98.2}
2024-05-09 22:58:18,444 [trainer.py] => NME: {'total': 95.4, '00-04': 98.0, '05-09': 92.0, '10-14': 95.4, '15-19': 96.2, 'old': 95.13, 'new': 96.2}
2024-05-09 22:58:18,444 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0]
2024-05-09 22:58:18,444 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5]
2024-05-09 22:58:18,444 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4]
2024-05-09 22:58:18,444 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45]

Average Accuracy (CNN): 95.2
Average Accuracy (NME): 97.78
2024-05-09 22:58:18,444 [trainer.py] => Average Accuracy (CNN): 95.2
2024-05-09 22:58:18,444 [trainer.py] => Average Accuracy (NME): 97.78
2024-05-09 22:58:18,444 [trainer.py] => Train Time: 0
2024-05-09 22:58:18,444 [trainer.py] => Test Time: 28.009999999999998 

2024-05-09 22:58:18,445 [trainer.py] => All params: 85814036
2024-05-09 22:58:18,445 [trainer.py] => Trainable params: 85814036
2024-05-09 22:58:18,446 [icarl.py] => Learning on 20-25
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.603, Train_accy 80.03, Test_accy 86.40:   0%|          | 0/20 [00:32<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.603, Train_accy 80.03, Test_accy 86.40:   5%|▌         | 1/20 [00:32<10:23, 32.84s/it]Task 4, Epoch 2/20 => Loss 1.718, Train_accy 92.48:   5%|▌         | 1/20 [00:59<10:23, 32.84s/it]                 Task 4, Epoch 2/20 => Loss 1.718, Train_accy 92.48:  10%|█         | 2/20 [00:59<08:42, 29.04s/it]Task 4, Epoch 3/20 => Loss 1.661, Train_accy 93.52:  10%|█         | 2/20 [01:25<08:42, 29.04s/it]Task 4, Epoch 3/20 => Loss 1.661, Train_accy 93.52:  15%|█▌        | 3/20 [01:25<07:54, 27.89s/it]Task 4, Epoch 4/20 => Loss 1.612, Train_accy 94.62:  15%|█▌        | 3/20 [01:51<07:54, 27.89s/it]Task 4, Epoch 4/20 => Loss 1.612, Train_accy 94.62:  20%|██        | 4/20 [01:51<07:15, 27.24s/it]Task 4, Epoch 5/20 => Loss 1.584, Train_accy 95.21:  20%|██        | 4/20 [02:18<07:15, 27.24s/it]Task 4, Epoch 5/20 => Loss 1.584, Train_accy 95.21:  25%|██▌       | 5/20 [02:18<06:43, 26.92s/it]Task 4, Epoch 6/20 => Loss 1.563, Train_accy 95.52, Test_accy 89.00:  25%|██▌       | 5/20 [02:51<06:43, 26.92s/it]Task 4, Epoch 6/20 => Loss 1.563, Train_accy 95.52, Test_accy 89.00:  30%|███       | 6/20 [02:51<06:45, 28.96s/it]Task 4, Epoch 7/20 => Loss 1.553, Train_accy 96.07:  30%|███       | 6/20 [03:17<06:45, 28.96s/it]                 Task 4, Epoch 7/20 => Loss 1.553, Train_accy 96.07:  35%|███▌      | 7/20 [03:17<06:05, 28.08s/it]Task 4, Epoch 8/20 => Loss 1.552, Train_accy 95.93:  35%|███▌      | 7/20 [03:43<06:05, 28.08s/it]Task 4, Epoch 8/20 => Loss 1.552, Train_accy 95.93:  40%|████      | 8/20 [03:43<05:30, 27.53s/it]Task 4, Epoch 9/20 => Loss 1.579, Train_accy 95.79:  40%|████      | 8/20 [04:10<05:30, 27.53s/it]Task 4, Epoch 9/20 => Loss 1.579, Train_accy 95.79:  45%|████▌     | 9/20 [04:10<04:58, 27.16s/it]Task 4, Epoch 10/20 => Loss 1.559, Train_accy 95.76:  45%|████▌     | 9/20 [04:36<04:58, 27.16s/it]Task 4, Epoch 10/20 => Loss 1.559, Train_accy 95.76:  50%|█████     | 10/20 [04:36<04:29, 26.95s/it]Task 4, Epoch 11/20 => Loss 1.545, Train_accy 96.03, Test_accy 88.00:  50%|█████     | 10/20 [05:09<04:29, 26.95s/it]Task 4, Epoch 11/20 => Loss 1.545, Train_accy 96.03, Test_accy 88.00:  55%|█████▌    | 11/20 [05:09<04:19, 28.80s/it]Task 4, Epoch 12/20 => Loss 1.561, Train_accy 95.83:  55%|█████▌    | 11/20 [05:36<04:19, 28.80s/it]                 Task 4, Epoch 12/20 => Loss 1.561, Train_accy 95.83:  60%|██████    | 12/20 [05:36<03:44, 28.07s/it]Task 4, Epoch 13/20 => Loss 1.554, Train_accy 96.10:  60%|██████    | 12/20 [06:02<03:44, 28.07s/it]Task 4, Epoch 13/20 => Loss 1.554, Train_accy 96.10:  65%|██████▌   | 13/20 [06:02<03:12, 27.52s/it]Task 4, Epoch 14/20 => Loss 1.551, Train_accy 96.52:  65%|██████▌   | 13/20 [06:28<03:12, 27.52s/it]Task 4, Epoch 14/20 => Loss 1.551, Train_accy 96.52:  70%|███████   | 14/20 [06:28<02:42, 27.16s/it]Task 4, Epoch 15/20 => Loss 1.578, Train_accy 95.66:  70%|███████   | 14/20 [06:54<02:42, 27.16s/it]Task 4, Epoch 15/20 => Loss 1.578, Train_accy 95.66:  75%|███████▌  | 15/20 [06:54<02:14, 26.89s/it]Task 4, Epoch 16/20 => Loss 1.522, Train_accy 96.69, Test_accy 88.80:  75%|███████▌  | 15/20 [07:28<02:14, 26.89s/it]Task 4, Epoch 16/20 => Loss 1.522, Train_accy 96.69, Test_accy 88.80:  80%|████████  | 16/20 [07:28<01:55, 28.75s/it]Task 4, Epoch 17/20 => Loss 1.538, Train_accy 96.24:  80%|████████  | 16/20 [07:54<01:55, 28.75s/it]                 Task 4, Epoch 17/20 => Loss 1.538, Train_accy 96.24:  85%|████████▌ | 17/20 [07:54<01:23, 27.98s/it]Task 4, Epoch 18/20 => Loss 1.532, Train_accy 96.76:  85%|████████▌ | 17/20 [08:20<01:23, 27.98s/it]Task 4, Epoch 18/20 => Loss 1.532, Train_accy 96.76:  90%|█████████ | 18/20 [08:20<00:54, 27.44s/it]Task 4, Epoch 19/20 => Loss 1.544, Train_accy 96.17:  90%|█████████ | 18/20 [08:46<00:54, 27.44s/it]Task 4, Epoch 19/20 => Loss 1.544, Train_accy 96.17:  95%|█████████▌| 19/20 [08:46<00:27, 27.10s/it]Task 4, Epoch 20/20 => Loss 1.524, Train_accy 96.62:  95%|█████████▌| 19/20 [09:12<00:27, 27.10s/it]Task 4, Epoch 20/20 => Loss 1.524, Train_accy 96.62: 100%|██████████| 20/20 [09:12<00:00, 26.84s/it]Task 4, Epoch 20/20 => Loss 1.524, Train_accy 96.62: 100%|██████████| 20/20 [09:12<00:00, 27.65s/it]
2024-05-09 23:07:31,415 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.524, Train_accy 96.62
2024-05-09 23:07:31,417 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-09 23:07:58,697 [icarl.py] => Exemplar size: 500
2024-05-09 23:07:58,698 [trainer.py] => CNN: {'total': 88.48, '00-04': 91.6, '05-09': 76.0, '10-14': 79.4, '15-19': 95.8, '20-24': 99.6, 'old': 85.7, 'new': 99.6}
2024-05-09 23:07:58,698 [trainer.py] => NME: {'total': 93.96, '00-04': 97.0, '05-09': 89.4, '10-14': 89.0, '15-19': 95.4, '20-24': 99.0, 'old': 92.7, 'new': 99.0}
2024-05-09 23:07:58,698 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48]
2024-05-09 23:07:58,698 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96]
2024-05-09 23:07:58,698 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96]
2024-05-09 23:07:58,698 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36]

Average Accuracy (CNN): 93.86
Average Accuracy (NME): 97.02
2024-05-09 23:07:58,698 [trainer.py] => Average Accuracy (CNN): 93.86
2024-05-09 23:07:58,698 [trainer.py] => Average Accuracy (NME): 97.02
2024-05-09 23:07:58,698 [trainer.py] => Train Time: 0
2024-05-09 23:07:58,698 [trainer.py] => Test Time: 41.3 

2024-05-09 23:07:58,699 [trainer.py] => All params: 85817881
2024-05-09 23:07:58,700 [trainer.py] => Trainable params: 85817881
2024-05-09 23:07:58,701 [icarl.py] => Learning on 25-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.839, Train_accy 79.20, Test_accy 84.57:   0%|          | 0/20 [00:34<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.839, Train_accy 79.20, Test_accy 84.57:   5%|▌         | 1/20 [00:34<11:02, 34.87s/it]Task 5, Epoch 2/20 => Loss 1.967, Train_accy 92.07:   5%|▌         | 1/20 [01:01<11:02, 34.87s/it]                 Task 5, Epoch 2/20 => Loss 1.967, Train_accy 92.07:  10%|█         | 2/20 [01:01<09:03, 30.22s/it]Task 5, Epoch 3/20 => Loss 1.909, Train_accy 94.17:  10%|█         | 2/20 [01:28<09:03, 30.22s/it]Task 5, Epoch 3/20 => Loss 1.909, Train_accy 94.17:  15%|█▌        | 3/20 [01:28<08:09, 28.76s/it]Task 5, Epoch 4/20 => Loss 1.918, Train_accy 94.33:  15%|█▌        | 3/20 [01:55<08:09, 28.76s/it]Task 5, Epoch 4/20 => Loss 1.918, Train_accy 94.33:  20%|██        | 4/20 [01:55<07:29, 28.08s/it]Task 5, Epoch 5/20 => Loss 1.872, Train_accy 95.30:  20%|██        | 4/20 [02:23<07:29, 28.08s/it]Task 5, Epoch 5/20 => Loss 1.872, Train_accy 95.30:  25%|██▌       | 5/20 [02:23<06:56, 27.75s/it]Task 5, Epoch 6/20 => Loss 1.899, Train_accy 94.87, Test_accy 83.90:  25%|██▌       | 5/20 [02:57<06:56, 27.75s/it]Task 5, Epoch 6/20 => Loss 1.899, Train_accy 94.87, Test_accy 83.90:  30%|███       | 6/20 [02:57<07:02, 30.18s/it]Task 5, Epoch 7/20 => Loss 1.865, Train_accy 95.63:  30%|███       | 6/20 [03:25<07:02, 30.18s/it]                 Task 5, Epoch 7/20 => Loss 1.865, Train_accy 95.63:  35%|███▌      | 7/20 [03:25<06:19, 29.20s/it]Task 5, Epoch 8/20 => Loss 1.893, Train_accy 95.33:  35%|███▌      | 7/20 [03:52<06:19, 29.20s/it]Task 5, Epoch 8/20 => Loss 1.893, Train_accy 95.33:  40%|████      | 8/20 [03:52<05:42, 28.52s/it]Task 5, Epoch 9/20 => Loss 1.889, Train_accy 94.90:  40%|████      | 8/20 [04:19<05:42, 28.52s/it]Task 5, Epoch 9/20 => Loss 1.889, Train_accy 94.90:  45%|████▌     | 9/20 [04:19<05:09, 28.12s/it]Task 5, Epoch 10/20 => Loss 1.863, Train_accy 95.73:  45%|████▌     | 9/20 [04:46<05:09, 28.12s/it]Task 5, Epoch 10/20 => Loss 1.863, Train_accy 95.73:  50%|█████     | 10/20 [04:46<04:38, 27.86s/it]Task 5, Epoch 11/20 => Loss 1.834, Train_accy 95.87, Test_accy 85.87:  50%|█████     | 10/20 [05:22<04:38, 27.86s/it]Task 5, Epoch 11/20 => Loss 1.834, Train_accy 95.87, Test_accy 85.87:  55%|█████▌    | 11/20 [05:22<04:31, 30.14s/it]Task 5, Epoch 12/20 => Loss 1.850, Train_accy 95.53:  55%|█████▌    | 11/20 [05:49<04:31, 30.14s/it]                 Task 5, Epoch 12/20 => Loss 1.850, Train_accy 95.53:  60%|██████    | 12/20 [05:49<03:53, 29.21s/it]Task 5, Epoch 13/20 => Loss 1.856, Train_accy 95.70:  60%|██████    | 12/20 [06:16<03:53, 29.21s/it]Task 5, Epoch 13/20 => Loss 1.856, Train_accy 95.70:  65%|██████▌   | 13/20 [06:16<03:19, 28.55s/it]Task 5, Epoch 14/20 => Loss 1.868, Train_accy 95.53:  65%|██████▌   | 13/20 [06:43<03:19, 28.55s/it]Task 5, Epoch 14/20 => Loss 1.868, Train_accy 95.53:  70%|███████   | 14/20 [06:43<02:48, 28.12s/it]Task 5, Epoch 15/20 => Loss 1.832, Train_accy 96.40:  70%|███████   | 14/20 [07:10<02:48, 28.12s/it]Task 5, Epoch 15/20 => Loss 1.832, Train_accy 96.40:  75%|███████▌  | 15/20 [07:10<02:18, 27.79s/it]Task 5, Epoch 16/20 => Loss 1.876, Train_accy 95.43, Test_accy 85.23:  75%|███████▌  | 15/20 [07:45<02:18, 27.79s/it]Task 5, Epoch 16/20 => Loss 1.876, Train_accy 95.43, Test_accy 85.23:  80%|████████  | 16/20 [07:45<01:59, 29.99s/it]Task 5, Epoch 17/20 => Loss 1.843, Train_accy 95.97:  80%|████████  | 16/20 [08:12<01:59, 29.99s/it]                 Task 5, Epoch 17/20 => Loss 1.843, Train_accy 95.97:  85%|████████▌ | 17/20 [08:12<01:27, 29.13s/it]Task 5, Epoch 18/20 => Loss 1.860, Train_accy 95.77:  85%|████████▌ | 17/20 [08:39<01:27, 29.13s/it]Task 5, Epoch 18/20 => Loss 1.860, Train_accy 95.77:  90%|█████████ | 18/20 [08:39<00:57, 28.52s/it]Task 5, Epoch 19/20 => Loss 1.840, Train_accy 96.30:  90%|█████████ | 18/20 [09:06<00:57, 28.52s/it]Task 5, Epoch 19/20 => Loss 1.840, Train_accy 96.30:  95%|█████████▌| 19/20 [09:06<00:28, 28.09s/it]Task 5, Epoch 20/20 => Loss 1.827, Train_accy 96.00:  95%|█████████▌| 19/20 [09:33<00:28, 28.09s/it]Task 5, Epoch 20/20 => Loss 1.827, Train_accy 96.00: 100%|██████████| 20/20 [09:33<00:00, 27.78s/it]Task 5, Epoch 20/20 => Loss 1.827, Train_accy 96.00: 100%|██████████| 20/20 [09:33<00:00, 28.69s/it]
2024-05-09 23:17:32,519 [icarl.py] => Task 5, Epoch 20/20 => Loss 1.827, Train_accy 96.00
2024-05-09 23:17:32,521 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-09 23:18:04,047 [icarl.py] => Exemplar size: 600
2024-05-09 23:18:04,047 [trainer.py] => CNN: {'total': 83.97, '00-04': 89.6, '05-09': 62.0, '10-14': 71.2, '15-19': 86.4, '20-24': 95.2, '25-29': 99.4, 'old': 80.88, 'new': 99.4}
2024-05-09 23:18:04,047 [trainer.py] => NME: {'total': 92.43, '00-04': 97.2, '05-09': 83.8, '10-14': 85.6, '15-19': 92.0, '20-24': 98.2, '25-29': 97.8, 'old': 91.36, 'new': 97.8}
2024-05-09 23:18:04,048 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97]
2024-05-09 23:18:04,048 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87]
2024-05-09 23:18:04,048 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43]
2024-05-09 23:18:04,048 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13]

Average Accuracy (CNN): 92.21
Average Accuracy (NME): 96.25
2024-05-09 23:18:04,048 [trainer.py] => Average Accuracy (CNN): 92.21
2024-05-09 23:18:04,048 [trainer.py] => Average Accuracy (NME): 96.25
2024-05-09 23:18:04,048 [trainer.py] => Train Time: 0
2024-05-09 23:18:04,048 [trainer.py] => Test Time: 57.06999999999999 

2024-05-09 23:18:04,049 [trainer.py] => All params: 85821726
2024-05-09 23:18:04,049 [trainer.py] => Trainable params: 85821726
2024-05-09 23:18:04,050 [icarl.py] => Learning on 30-35
  0%|          | 0/20 [00:00<?, ?it/s]Task 6, Epoch 1/20 => Loss 2.977, Train_accy 72.16, Test_accy 76.77:   0%|          | 0/20 [00:37<?, ?it/s]Task 6, Epoch 1/20 => Loss 2.977, Train_accy 72.16, Test_accy 76.77:   5%|▌         | 1/20 [00:37<11:45, 37.13s/it]Task 6, Epoch 2/20 => Loss 1.949, Train_accy 87.68:   5%|▌         | 1/20 [01:05<11:45, 37.13s/it]                 Task 6, Epoch 2/20 => Loss 1.949, Train_accy 87.68:  10%|█         | 2/20 [01:05<09:30, 31.69s/it]Task 6, Epoch 3/20 => Loss 1.865, Train_accy 90.48:  10%|█         | 2/20 [01:33<09:30, 31.69s/it]Task 6, Epoch 3/20 => Loss 1.865, Train_accy 90.48:  15%|█▌        | 3/20 [01:33<08:30, 30.00s/it]Task 6, Epoch 4/20 => Loss 1.839, Train_accy 91.42:  15%|█▌        | 3/20 [02:01<08:30, 30.00s/it]Task 6, Epoch 4/20 => Loss 1.839, Train_accy 91.42:  20%|██        | 4/20 [02:01<07:47, 29.24s/it]Task 6, Epoch 5/20 => Loss 1.830, Train_accy 92.61:  20%|██        | 4/20 [02:29<07:47, 29.24s/it]Task 6, Epoch 5/20 => Loss 1.830, Train_accy 92.61:  25%|██▌       | 5/20 [02:29<07:12, 28.81s/it]Task 6, Epoch 6/20 => Loss 1.825, Train_accy 92.32, Test_accy 80.43:  25%|██▌       | 5/20 [03:06<07:12, 28.81s/it]Task 6, Epoch 6/20 => Loss 1.825, Train_accy 92.32, Test_accy 80.43:  30%|███       | 6/20 [03:06<07:23, 31.68s/it]Task 6, Epoch 7/20 => Loss 1.778, Train_accy 93.13:  30%|███       | 6/20 [03:34<07:23, 31.68s/it]                 Task 6, Epoch 7/20 => Loss 1.778, Train_accy 93.13:  35%|███▌      | 7/20 [03:34<06:36, 30.50s/it]Task 6, Epoch 8/20 => Loss 1.744, Train_accy 93.84:  35%|███▌      | 7/20 [04:02<06:36, 30.50s/it]Task 6, Epoch 8/20 => Loss 1.744, Train_accy 93.84:  40%|████      | 8/20 [04:02<05:56, 29.69s/it]Task 6, Epoch 9/20 => Loss 1.772, Train_accy 93.10:  40%|████      | 8/20 [04:30<05:56, 29.69s/it]Task 6, Epoch 9/20 => Loss 1.772, Train_accy 93.10:  45%|████▌     | 9/20 [04:30<05:20, 29.15s/it]Task 6, Epoch 10/20 => Loss 1.837, Train_accy 92.39:  45%|████▌     | 9/20 [04:58<05:20, 29.15s/it]Task 6, Epoch 10/20 => Loss 1.837, Train_accy 92.39:  50%|█████     | 10/20 [04:58<04:48, 28.82s/it]Task 6, Epoch 11/20 => Loss 1.782, Train_accy 93.58, Test_accy 81.60:  50%|█████     | 10/20 [05:35<04:48, 28.82s/it]Task 6, Epoch 11/20 => Loss 1.782, Train_accy 93.58, Test_accy 81.60:  55%|█████▌    | 11/20 [05:35<04:42, 31.42s/it]Task 6, Epoch 12/20 => Loss 1.771, Train_accy 93.65:  55%|█████▌    | 11/20 [06:03<04:42, 31.42s/it]                 Task 6, Epoch 12/20 => Loss 1.771, Train_accy 93.65:  60%|██████    | 12/20 [06:03<04:03, 30.40s/it]Task 6, Epoch 13/20 => Loss 1.756, Train_accy 94.26:  60%|██████    | 12/20 [06:31<04:03, 30.40s/it]Task 6, Epoch 13/20 => Loss 1.756, Train_accy 94.26:  65%|██████▌   | 13/20 [06:31<03:27, 29.67s/it]Task 6, Epoch 14/20 => Loss 1.746, Train_accy 94.65:  65%|██████▌   | 13/20 [06:59<03:27, 29.67s/it]Task 6, Epoch 14/20 => Loss 1.746, Train_accy 94.65:  70%|███████   | 14/20 [06:59<02:55, 29.17s/it]Task 6, Epoch 15/20 => Loss 1.761, Train_accy 94.03:  70%|███████   | 14/20 [07:27<02:55, 29.17s/it]Task 6, Epoch 15/20 => Loss 1.761, Train_accy 94.03:  75%|███████▌  | 15/20 [07:27<02:24, 28.83s/it]Task 6, Epoch 16/20 => Loss 1.754, Train_accy 94.87, Test_accy 82.80:  75%|███████▌  | 15/20 [08:05<02:24, 28.83s/it]Task 6, Epoch 16/20 => Loss 1.754, Train_accy 94.87, Test_accy 82.80:  80%|████████  | 16/20 [08:05<02:05, 31.36s/it]Task 6, Epoch 17/20 => Loss 1.749, Train_accy 94.45:  80%|████████  | 16/20 [08:33<02:05, 31.36s/it]                 Task 6, Epoch 17/20 => Loss 1.749, Train_accy 94.45:  85%|████████▌ | 17/20 [08:33<01:31, 30.38s/it]Task 6, Epoch 18/20 => Loss 1.770, Train_accy 94.29:  85%|████████▌ | 17/20 [09:01<01:31, 30.38s/it]Task 6, Epoch 18/20 => Loss 1.770, Train_accy 94.29:  90%|█████████ | 18/20 [09:01<00:59, 29.69s/it]Task 6, Epoch 19/20 => Loss 1.772, Train_accy 94.19:  90%|█████████ | 18/20 [09:29<00:59, 29.69s/it]Task 6, Epoch 19/20 => Loss 1.772, Train_accy 94.19:  95%|█████████▌| 19/20 [09:29<00:29, 29.23s/it]Task 6, Epoch 20/20 => Loss 1.748, Train_accy 94.81:  95%|█████████▌| 19/20 [09:57<00:29, 29.23s/it]Task 6, Epoch 20/20 => Loss 1.748, Train_accy 94.81: 100%|██████████| 20/20 [09:57<00:00, 28.88s/it]Task 6, Epoch 20/20 => Loss 1.748, Train_accy 94.81: 100%|██████████| 20/20 [09:57<00:00, 29.88s/it]
2024-05-09 23:28:01,607 [icarl.py] => Task 6, Epoch 20/20 => Loss 1.748, Train_accy 94.81
2024-05-09 23:28:01,609 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-09 23:28:37,129 [icarl.py] => Exemplar size: 700
2024-05-09 23:28:37,130 [trainer.py] => CNN: {'total': 81.2, '00-04': 85.6, '05-09': 52.6, '10-14': 70.8, '15-19': 80.8, '20-24': 86.2, '25-29': 96.2, '30-34': 96.2, 'old': 78.7, 'new': 96.2}
2024-05-09 23:28:37,130 [trainer.py] => NME: {'total': 91.09, '00-04': 96.0, '05-09': 79.0, '10-14': 86.2, '15-19': 88.6, '20-24': 96.2, '25-29': 97.2, '30-34': 94.4, 'old': 90.53, 'new': 94.4}
2024-05-09 23:28:37,130 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2]
2024-05-09 23:28:37,130 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66]
2024-05-09 23:28:37,130 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09]
2024-05-09 23:28:37,130 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94]

Average Accuracy (CNN): 90.64
Average Accuracy (NME): 95.52
2024-05-09 23:28:37,130 [trainer.py] => Average Accuracy (CNN): 90.64
2024-05-09 23:28:37,130 [trainer.py] => Average Accuracy (NME): 95.52
2024-05-09 23:28:37,130 [trainer.py] => Train Time: 0
2024-05-09 23:28:37,130 [trainer.py] => Test Time: 75.82 

2024-05-09 23:28:37,131 [trainer.py] => All params: 85825571
2024-05-09 23:28:37,132 [trainer.py] => Trainable params: 85825571
2024-05-09 23:28:37,133 [icarl.py] => Learning on 35-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 2.871, Train_accy 78.91, Test_accy 77.75:   0%|          | 0/20 [00:39<?, ?it/s]Task 7, Epoch 1/20 => Loss 2.871, Train_accy 78.91, Test_accy 77.75:   5%|▌         | 1/20 [00:39<12:30, 39.51s/it]Task 7, Epoch 2/20 => Loss 1.955, Train_accy 92.75:   5%|▌         | 1/20 [01:08<12:30, 39.51s/it]                 Task 7, Epoch 2/20 => Loss 1.955, Train_accy 92.75:  10%|█         | 2/20 [01:08<09:58, 33.27s/it]Task 7, Epoch 3/20 => Loss 1.892, Train_accy 93.00:  10%|█         | 2/20 [01:37<09:58, 33.27s/it]Task 7, Epoch 3/20 => Loss 1.892, Train_accy 93.00:  15%|█▌        | 3/20 [01:37<08:53, 31.36s/it]Task 7, Epoch 4/20 => Loss 1.864, Train_accy 94.34:  15%|█▌        | 3/20 [02:06<08:53, 31.36s/it]Task 7, Epoch 4/20 => Loss 1.864, Train_accy 94.34:  20%|██        | 4/20 [02:06<08:06, 30.44s/it]Task 7, Epoch 5/20 => Loss 1.855, Train_accy 94.66:  20%|██        | 4/20 [02:35<08:06, 30.44s/it]Task 7, Epoch 5/20 => Loss 1.855, Train_accy 94.66:  25%|██▌       | 5/20 [02:35<07:28, 29.92s/it]Task 7, Epoch 6/20 => Loss 1.876, Train_accy 94.28, Test_accy 78.70:  25%|██▌       | 5/20 [03:15<07:28, 29.92s/it]Task 7, Epoch 6/20 => Loss 1.876, Train_accy 94.28, Test_accy 78.70:  30%|███       | 6/20 [03:15<07:45, 33.23s/it]Task 7, Epoch 7/20 => Loss 1.840, Train_accy 94.88:  30%|███       | 6/20 [03:44<07:45, 33.23s/it]                 Task 7, Epoch 7/20 => Loss 1.840, Train_accy 94.88:  35%|███▌      | 7/20 [03:44<06:53, 31.83s/it]Task 7, Epoch 8/20 => Loss 1.857, Train_accy 94.41:  35%|███▌      | 7/20 [04:13<06:53, 31.83s/it]Task 7, Epoch 8/20 => Loss 1.857, Train_accy 94.41:  40%|████      | 8/20 [04:13<06:11, 30.94s/it]Task 7, Epoch 9/20 => Loss 1.842, Train_accy 94.69:  40%|████      | 8/20 [04:42<06:11, 30.94s/it]Task 7, Epoch 9/20 => Loss 1.842, Train_accy 94.69:  45%|████▌     | 9/20 [04:42<05:34, 30.39s/it]Task 7, Epoch 10/20 => Loss 1.861, Train_accy 94.84:  45%|████▌     | 9/20 [05:11<05:34, 30.39s/it]Task 7, Epoch 10/20 => Loss 1.861, Train_accy 94.84:  50%|█████     | 10/20 [05:11<04:59, 29.93s/it]Task 7, Epoch 11/20 => Loss 1.821, Train_accy 95.72, Test_accy 78.80:  50%|█████     | 10/20 [05:50<04:59, 29.93s/it]Task 7, Epoch 11/20 => Loss 1.821, Train_accy 95.72, Test_accy 78.80:  55%|█████▌    | 11/20 [05:50<04:55, 32.85s/it]Task 7, Epoch 12/20 => Loss 1.848, Train_accy 95.12:  55%|█████▌    | 11/20 [06:19<04:55, 32.85s/it]                 Task 7, Epoch 12/20 => Loss 1.848, Train_accy 95.12:  60%|██████    | 12/20 [06:19<04:13, 31.68s/it]Task 7, Epoch 13/20 => Loss 1.829, Train_accy 94.97:  60%|██████    | 12/20 [06:48<04:13, 31.68s/it]Task 7, Epoch 13/20 => Loss 1.829, Train_accy 94.97:  65%|██████▌   | 13/20 [06:48<03:35, 30.85s/it]Task 7, Epoch 14/20 => Loss 1.830, Train_accy 95.19:  65%|██████▌   | 13/20 [07:17<03:35, 30.85s/it]Task 7, Epoch 14/20 => Loss 1.830, Train_accy 95.19:  70%|███████   | 14/20 [07:17<03:01, 30.28s/it]Task 7, Epoch 15/20 => Loss 1.811, Train_accy 95.81:  70%|███████   | 14/20 [07:46<03:01, 30.28s/it]Task 7, Epoch 15/20 => Loss 1.811, Train_accy 95.81:  75%|███████▌  | 15/20 [07:46<02:29, 29.89s/it]Task 7, Epoch 16/20 => Loss 1.826, Train_accy 95.47, Test_accy 77.62:  75%|███████▌  | 15/20 [08:26<02:29, 29.89s/it]Task 7, Epoch 16/20 => Loss 1.826, Train_accy 95.47, Test_accy 77.62:  80%|████████  | 16/20 [08:26<02:11, 32.80s/it]Task 7, Epoch 17/20 => Loss 1.815, Train_accy 95.69:  80%|████████  | 16/20 [08:55<02:11, 32.80s/it]                 Task 7, Epoch 17/20 => Loss 1.815, Train_accy 95.69:  85%|████████▌ | 17/20 [08:55<01:34, 31.66s/it]Task 7, Epoch 18/20 => Loss 1.799, Train_accy 95.81:  85%|████████▌ | 17/20 [09:24<01:34, 31.66s/it]Task 7, Epoch 18/20 => Loss 1.799, Train_accy 95.81:  90%|█████████ | 18/20 [09:24<01:01, 30.90s/it]Task 7, Epoch 19/20 => Loss 1.831, Train_accy 95.28:  90%|█████████ | 18/20 [09:53<01:01, 30.90s/it]Task 7, Epoch 19/20 => Loss 1.831, Train_accy 95.28:  95%|█████████▌| 19/20 [09:53<00:30, 30.32s/it]Task 7, Epoch 20/20 => Loss 1.794, Train_accy 96.19:  95%|█████████▌| 19/20 [10:22<00:30, 30.32s/it]Task 7, Epoch 20/20 => Loss 1.794, Train_accy 96.19: 100%|██████████| 20/20 [10:22<00:00, 29.92s/it]Task 7, Epoch 20/20 => Loss 1.794, Train_accy 96.19: 100%|██████████| 20/20 [10:22<00:00, 31.11s/it]
2024-05-09 23:38:59,446 [icarl.py] => Task 7, Epoch 20/20 => Loss 1.794, Train_accy 96.19
2024-05-09 23:38:59,448 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-09 23:39:38,471 [icarl.py] => Exemplar size: 800
2024-05-09 23:39:38,472 [trainer.py] => CNN: {'total': 78.08, '00-04': 76.8, '05-09': 49.8, '10-14': 64.6, '15-19': 71.4, '20-24': 85.2, '25-29': 86.0, '30-34': 91.4, '35-39': 99.4, 'old': 75.03, 'new': 99.4}
2024-05-09 23:39:38,472 [trainer.py] => NME: {'total': 89.6, '00-04': 93.6, '05-09': 78.0, '10-14': 83.6, '15-19': 83.6, '20-24': 96.2, '25-29': 94.2, '30-34': 92.4, '35-39': 95.2, 'old': 88.8, 'new': 95.2}
2024-05-09 23:39:38,472 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08]
2024-05-09 23:39:38,472 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7]
2024-05-09 23:39:38,472 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6]
2024-05-09 23:39:38,472 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4]

Average Accuracy (CNN): 89.07
Average Accuracy (NME): 94.78
2024-05-09 23:39:38,472 [trainer.py] => Average Accuracy (CNN): 89.07
2024-05-09 23:39:38,472 [trainer.py] => Average Accuracy (NME): 94.78
2024-05-09 23:39:38,472 [trainer.py] => Train Time: 0
2024-05-09 23:39:38,472 [trainer.py] => Test Time: 96.67999999999999 

2024-05-09 23:39:38,473 [trainer.py] => All params: 85829416
2024-05-09 23:39:38,474 [trainer.py] => Trainable params: 85829416
2024-05-09 23:39:38,475 [icarl.py] => Learning on 40-45
  0%|          | 0/20 [00:00<?, ?it/s]Task 8, Epoch 1/20 => Loss 3.121, Train_accy 77.42, Test_accy 76.67:   0%|          | 0/20 [00:41<?, ?it/s]Task 8, Epoch 1/20 => Loss 3.121, Train_accy 77.42, Test_accy 76.67:   5%|▌         | 1/20 [00:41<13:12, 41.71s/it]Task 8, Epoch 2/20 => Loss 2.210, Train_accy 91.52:   5%|▌         | 1/20 [01:11<13:12, 41.71s/it]                 Task 8, Epoch 2/20 => Loss 2.210, Train_accy 91.52:  10%|█         | 2/20 [01:11<10:25, 34.76s/it]Task 8, Epoch 3/20 => Loss 2.109, Train_accy 92.94:  10%|█         | 2/20 [01:41<10:25, 34.76s/it]Task 8, Epoch 3/20 => Loss 2.109, Train_accy 92.94:  15%|█▌        | 3/20 [01:41<09:12, 32.48s/it]Task 8, Epoch 4/20 => Loss 2.076, Train_accy 93.85:  15%|█▌        | 3/20 [02:11<09:12, 32.48s/it]Task 8, Epoch 4/20 => Loss 2.076, Train_accy 93.85:  20%|██        | 4/20 [02:11<08:23, 31.47s/it]Task 8, Epoch 5/20 => Loss 2.087, Train_accy 93.79:  20%|██        | 4/20 [02:41<08:23, 31.47s/it]Task 8, Epoch 5/20 => Loss 2.087, Train_accy 93.79:  25%|██▌       | 5/20 [02:41<07:43, 30.91s/it]Task 8, Epoch 6/20 => Loss 2.098, Train_accy 94.36, Test_accy 77.04:  25%|██▌       | 5/20 [03:22<07:43, 30.91s/it]Task 8, Epoch 6/20 => Loss 2.098, Train_accy 94.36, Test_accy 77.04:  30%|███       | 6/20 [03:22<08:04, 34.57s/it]Task 8, Epoch 7/20 => Loss 2.030, Train_accy 95.00:  30%|███       | 6/20 [03:52<08:04, 34.57s/it]                 Task 8, Epoch 7/20 => Loss 2.030, Train_accy 95.00:  35%|███▌      | 7/20 [03:52<07:09, 33.07s/it]Task 8, Epoch 8/20 => Loss 2.060, Train_accy 94.85:  35%|███▌      | 7/20 [04:22<07:09, 33.07s/it]Task 8, Epoch 8/20 => Loss 2.060, Train_accy 94.85:  40%|████      | 8/20 [04:22<06:24, 32.08s/it]Task 8, Epoch 9/20 => Loss 2.049, Train_accy 94.67:  40%|████      | 8/20 [04:52<06:24, 32.08s/it]Task 8, Epoch 9/20 => Loss 2.049, Train_accy 94.67:  45%|████▌     | 9/20 [04:52<05:45, 31.38s/it]Task 8, Epoch 10/20 => Loss 2.037, Train_accy 95.42:  45%|████▌     | 9/20 [05:22<05:45, 31.38s/it]Task 8, Epoch 10/20 => Loss 2.037, Train_accy 95.42:  50%|█████     | 10/20 [05:22<05:09, 30.93s/it]Task 8, Epoch 11/20 => Loss 2.051, Train_accy 94.61, Test_accy 76.18:  50%|█████     | 10/20 [06:04<05:09, 30.93s/it]Task 8, Epoch 11/20 => Loss 2.051, Train_accy 94.61, Test_accy 76.18:  55%|█████▌    | 11/20 [06:04<05:07, 34.20s/it]Task 8, Epoch 12/20 => Loss 2.038, Train_accy 95.24:  55%|█████▌    | 11/20 [06:34<05:07, 34.20s/it]                 Task 8, Epoch 12/20 => Loss 2.038, Train_accy 95.24:  60%|██████    | 12/20 [06:34<04:23, 32.94s/it]Task 8, Epoch 13/20 => Loss 2.049, Train_accy 95.15:  60%|██████    | 12/20 [07:04<04:23, 32.94s/it]Task 8, Epoch 13/20 => Loss 2.049, Train_accy 95.15:  65%|██████▌   | 13/20 [07:04<03:44, 32.01s/it]Task 8, Epoch 14/20 => Loss 2.044, Train_accy 94.91:  65%|██████▌   | 13/20 [07:34<03:44, 32.01s/it]Task 8, Epoch 14/20 => Loss 2.044, Train_accy 94.91:  70%|███████   | 14/20 [07:34<03:08, 31.38s/it]Task 8, Epoch 15/20 => Loss 2.028, Train_accy 94.88:  70%|███████   | 14/20 [08:04<03:08, 31.38s/it]Task 8, Epoch 15/20 => Loss 2.028, Train_accy 94.88:  75%|███████▌  | 15/20 [08:04<02:34, 30.98s/it]Task 8, Epoch 16/20 => Loss 2.018, Train_accy 95.58, Test_accy 76.07:  75%|███████▌  | 15/20 [08:45<02:34, 30.98s/it]Task 8, Epoch 16/20 => Loss 2.018, Train_accy 95.58, Test_accy 76.07:  80%|████████  | 16/20 [08:45<02:16, 34.18s/it]Task 8, Epoch 17/20 => Loss 2.065, Train_accy 95.42:  80%|████████  | 16/20 [09:15<02:16, 34.18s/it]                 Task 8, Epoch 17/20 => Loss 2.065, Train_accy 95.42:  85%|████████▌ | 17/20 [09:15<01:38, 32.91s/it]Task 8, Epoch 18/20 => Loss 2.002, Train_accy 95.88:  85%|████████▌ | 17/20 [09:45<01:38, 32.91s/it]Task 8, Epoch 18/20 => Loss 2.002, Train_accy 95.88:  90%|█████████ | 18/20 [09:45<01:04, 32.02s/it]Task 8, Epoch 19/20 => Loss 2.045, Train_accy 95.15:  90%|█████████ | 18/20 [10:15<01:04, 32.02s/it]Task 8, Epoch 19/20 => Loss 2.045, Train_accy 95.15:  95%|█████████▌| 19/20 [10:15<00:31, 31.44s/it]Task 8, Epoch 20/20 => Loss 1.985, Train_accy 96.33:  95%|█████████▌| 19/20 [10:45<00:31, 31.44s/it]Task 8, Epoch 20/20 => Loss 1.985, Train_accy 96.33: 100%|██████████| 20/20 [10:45<00:00, 31.00s/it]Task 8, Epoch 20/20 => Loss 1.985, Train_accy 96.33: 100%|██████████| 20/20 [10:45<00:00, 32.28s/it]
2024-05-09 23:50:24,228 [icarl.py] => Task 8, Epoch 20/20 => Loss 1.985, Train_accy 96.33
2024-05-09 23:50:24,230 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-09 23:51:08,231 [icarl.py] => Exemplar size: 900
2024-05-09 23:51:08,232 [trainer.py] => CNN: {'total': 74.2, '00-04': 70.0, '05-09': 50.0, '10-14': 48.2, '15-19': 63.6, '20-24': 76.8, '25-29': 84.2, '30-34': 84.6, '35-39': 91.2, '40-44': 99.2, 'old': 71.08, 'new': 99.2}
2024-05-09 23:51:08,232 [trainer.py] => NME: {'total': 87.91, '00-04': 92.6, '05-09': 77.2, '10-14': 75.2, '15-19': 80.8, '20-24': 94.2, '25-29': 91.8, '30-34': 89.8, '35-39': 93.8, '40-44': 95.8, 'old': 86.92, 'new': 95.8}
2024-05-09 23:51:08,232 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2]
2024-05-09 23:51:08,232 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38]
2024-05-09 23:51:08,232 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91]
2024-05-09 23:51:08,232 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18]

Average Accuracy (CNN): 87.41
Average Accuracy (NME): 94.01
2024-05-09 23:51:08,232 [trainer.py] => Average Accuracy (CNN): 87.41
2024-05-09 23:51:08,232 [trainer.py] => Average Accuracy (NME): 94.01
2024-05-09 23:51:08,232 [trainer.py] => Train Time: 0
2024-05-09 23:51:08,232 [trainer.py] => Test Time: 120.44999999999999 

2024-05-09 23:51:08,233 [trainer.py] => All params: 85833261
2024-05-09 23:51:08,233 [trainer.py] => Trainable params: 85833261
2024-05-09 23:51:08,234 [icarl.py] => Learning on 45-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 9, Epoch 1/20 => Loss 2.915, Train_accy 80.94, Test_accy 74.38:   0%|          | 0/20 [00:43<?, ?it/s]Task 9, Epoch 1/20 => Loss 2.915, Train_accy 80.94, Test_accy 74.38:   5%|▌         | 1/20 [00:43<13:52, 43.82s/it]Task 9, Epoch 2/20 => Loss 1.953, Train_accy 92.59:   5%|▌         | 1/20 [01:14<13:52, 43.82s/it]                 Task 9, Epoch 2/20 => Loss 1.953, Train_accy 92.59:  10%|█         | 2/20 [01:14<10:51, 36.18s/it]Task 9, Epoch 3/20 => Loss 1.840, Train_accy 94.62:  10%|█         | 2/20 [01:45<10:51, 36.18s/it]Task 9, Epoch 3/20 => Loss 1.840, Train_accy 94.62:  15%|█▌        | 3/20 [01:45<09:33, 33.72s/it]Task 9, Epoch 4/20 => Loss 1.822, Train_accy 94.82:  15%|█▌        | 3/20 [02:16<09:33, 33.72s/it]Task 9, Epoch 4/20 => Loss 1.822, Train_accy 94.82:  20%|██        | 4/20 [02:16<08:41, 32.61s/it]Task 9, Epoch 5/20 => Loss 1.843, Train_accy 94.29:  20%|██        | 4/20 [02:47<08:41, 32.61s/it]Task 9, Epoch 5/20 => Loss 1.843, Train_accy 94.29:  25%|██▌       | 5/20 [02:47<07:59, 31.97s/it]Task 9, Epoch 6/20 => Loss 1.832, Train_accy 94.94, Test_accy 73.12:  25%|██▌       | 5/20 [03:31<07:59, 31.97s/it]Task 9, Epoch 6/20 => Loss 1.832, Train_accy 94.94, Test_accy 73.12:  30%|███       | 6/20 [03:31<08:24, 36.03s/it]Task 9, Epoch 7/20 => Loss 1.814, Train_accy 95.32:  30%|███       | 6/20 [04:02<08:24, 36.03s/it]                 Task 9, Epoch 7/20 => Loss 1.814, Train_accy 95.32:  35%|███▌      | 7/20 [04:02<07:26, 34.36s/it]Task 9, Epoch 8/20 => Loss 1.837, Train_accy 94.94:  35%|███▌      | 7/20 [04:32<07:26, 34.36s/it]Task 9, Epoch 8/20 => Loss 1.837, Train_accy 94.94:  40%|████      | 8/20 [04:32<06:38, 33.21s/it]Task 9, Epoch 9/20 => Loss 1.807, Train_accy 95.03:  40%|████      | 8/20 [05:03<06:38, 33.21s/it]Task 9, Epoch 9/20 => Loss 1.807, Train_accy 95.03:  45%|████▌     | 9/20 [05:03<05:57, 32.48s/it]Task 9, Epoch 10/20 => Loss 1.816, Train_accy 95.09:  45%|████▌     | 9/20 [05:34<05:57, 32.48s/it]Task 9, Epoch 10/20 => Loss 1.816, Train_accy 95.09:  50%|█████     | 10/20 [05:34<05:19, 31.98s/it]Task 9, Epoch 11/20 => Loss 1.784, Train_accy 95.79, Test_accy 73.58:  50%|█████     | 10/20 [06:18<05:19, 31.98s/it]Task 9, Epoch 11/20 => Loss 1.784, Train_accy 95.79, Test_accy 73.58:  55%|█████▌    | 11/20 [06:18<05:20, 35.58s/it]Task 9, Epoch 12/20 => Loss 1.813, Train_accy 95.32:  55%|█████▌    | 11/20 [06:48<05:20, 35.58s/it]                 Task 9, Epoch 12/20 => Loss 1.813, Train_accy 95.32:  60%|██████    | 12/20 [06:48<04:32, 34.10s/it]Task 9, Epoch 13/20 => Loss 1.794, Train_accy 96.26:  60%|██████    | 12/20 [07:19<04:32, 34.10s/it]Task 9, Epoch 13/20 => Loss 1.794, Train_accy 96.26:  65%|██████▌   | 13/20 [07:19<03:51, 33.06s/it]Task 9, Epoch 14/20 => Loss 1.789, Train_accy 95.68:  65%|██████▌   | 13/20 [07:50<03:51, 33.06s/it]Task 9, Epoch 14/20 => Loss 1.789, Train_accy 95.68:  70%|███████   | 14/20 [07:50<03:13, 32.31s/it]Task 9, Epoch 15/20 => Loss 1.761, Train_accy 96.44:  70%|███████   | 14/20 [08:21<03:13, 32.31s/it]Task 9, Epoch 15/20 => Loss 1.761, Train_accy 96.44:  75%|███████▌  | 15/20 [08:21<02:39, 31.86s/it]Task 9, Epoch 16/20 => Loss 1.798, Train_accy 95.76, Test_accy 73.88:  75%|███████▌  | 15/20 [09:04<02:39, 31.86s/it]Task 9, Epoch 16/20 => Loss 1.798, Train_accy 95.76, Test_accy 73.88:  80%|████████  | 16/20 [09:04<02:21, 35.35s/it]Task 9, Epoch 17/20 => Loss 1.811, Train_accy 95.97:  80%|████████  | 16/20 [09:35<02:21, 35.35s/it]                 Task 9, Epoch 17/20 => Loss 1.811, Train_accy 95.97:  85%|████████▌ | 17/20 [09:35<01:41, 33.95s/it]Task 9, Epoch 18/20 => Loss 1.741, Train_accy 96.71:  85%|████████▌ | 17/20 [10:05<01:41, 33.95s/it]Task 9, Epoch 18/20 => Loss 1.741, Train_accy 96.71:  90%|█████████ | 18/20 [10:05<01:05, 32.95s/it]Task 9, Epoch 19/20 => Loss 1.750, Train_accy 96.32:  90%|█████████ | 18/20 [10:36<01:05, 32.95s/it]Task 9, Epoch 19/20 => Loss 1.750, Train_accy 96.32:  95%|█████████▌| 19/20 [10:36<00:32, 32.23s/it]Task 9, Epoch 20/20 => Loss 1.775, Train_accy 96.41:  95%|█████████▌| 19/20 [11:06<00:32, 32.23s/it]Task 9, Epoch 20/20 => Loss 1.775, Train_accy 96.41: 100%|██████████| 20/20 [11:06<00:00, 31.76s/it]Task 9, Epoch 20/20 => Loss 1.775, Train_accy 96.41: 100%|██████████| 20/20 [11:06<00:00, 33.35s/it]
2024-05-10 00:02:15,285 [icarl.py] => Task 9, Epoch 20/20 => Loss 1.775, Train_accy 96.41
2024-05-10 00:02:15,287 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 00:03:01,459 [icarl.py] => Exemplar size: 1000
2024-05-10 00:03:01,460 [trainer.py] => CNN: {'total': 75.32, '00-04': 76.8, '05-09': 49.8, '10-14': 47.6, '15-19': 65.4, '20-24': 74.2, '25-29': 82.6, '30-34': 82.8, '35-39': 79.6, '40-44': 95.8, '45-49': 98.6, 'old': 72.73, 'new': 98.6}
2024-05-10 00:03:01,460 [trainer.py] => NME: {'total': 85.96, '00-04': 93.0, '05-09': 70.8, '10-14': 73.0, '15-19': 80.6, '20-24': 91.0, '25-29': 88.2, '30-34': 88.0, '35-39': 84.0, '40-44': 95.4, '45-49': 95.6, 'old': 84.89, 'new': 95.6}
2024-05-10 00:03:01,460 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32]
2024-05-10 00:03:01,460 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46]
2024-05-10 00:03:01,460 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96]
2024-05-10 00:03:01,460 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88]

Average Accuracy (CNN): 86.21
Average Accuracy (NME): 93.21
2024-05-10 00:03:01,460 [trainer.py] => Average Accuracy (CNN): 86.21
2024-05-10 00:03:01,460 [trainer.py] => Average Accuracy (NME): 93.21
2024-05-10 00:03:01,460 [trainer.py] => Train Time: 0
2024-05-10 00:03:01,460 [trainer.py] => Test Time: 146.08999999999997 

2024-05-10 00:03:01,461 [trainer.py] => All params: 85837106
2024-05-10 00:03:01,461 [trainer.py] => Trainable params: 85837106
2024-05-10 00:03:01,462 [icarl.py] => Learning on 50-55
  0%|          | 0/20 [00:00<?, ?it/s]Task 10, Epoch 1/20 => Loss 3.024, Train_accy 78.63, Test_accy 75.24:   0%|          | 0/20 [00:45<?, ?it/s]Task 10, Epoch 1/20 => Loss 3.024, Train_accy 78.63, Test_accy 75.24:   5%|▌         | 1/20 [00:45<14:29, 45.75s/it]Task 10, Epoch 2/20 => Loss 1.998, Train_accy 92.60:   5%|▌         | 1/20 [01:17<14:29, 45.75s/it]                 Task 10, Epoch 2/20 => Loss 1.998, Train_accy 92.60:  10%|█         | 2/20 [01:17<11:13, 37.40s/it]Task 10, Epoch 3/20 => Loss 1.951, Train_accy 93.57:  10%|█         | 2/20 [01:48<11:13, 37.40s/it]Task 10, Epoch 3/20 => Loss 1.951, Train_accy 93.57:  15%|█▌        | 3/20 [01:48<09:49, 34.69s/it]Task 10, Epoch 4/20 => Loss 1.938, Train_accy 93.74:  15%|█▌        | 3/20 [02:20<09:49, 34.69s/it]Task 10, Epoch 4/20 => Loss 1.938, Train_accy 93.74:  20%|██        | 4/20 [02:20<08:55, 33.47s/it]Task 10, Epoch 5/20 => Loss 1.936, Train_accy 93.80:  20%|██        | 4/20 [02:51<08:55, 33.47s/it]Task 10, Epoch 5/20 => Loss 1.936, Train_accy 93.80:  25%|██▌       | 5/20 [02:51<08:12, 32.80s/it]Task 10, Epoch 6/20 => Loss 1.941, Train_accy 93.94, Test_accy 73.16:  25%|██▌       | 5/20 [03:38<08:12, 32.80s/it]Task 10, Epoch 6/20 => Loss 1.941, Train_accy 93.94, Test_accy 73.16:  30%|███       | 6/20 [03:38<08:42, 37.33s/it]Task 10, Epoch 7/20 => Loss 1.917, Train_accy 94.17:  30%|███       | 6/20 [04:09<08:42, 37.33s/it]                 Task 10, Epoch 7/20 => Loss 1.917, Train_accy 94.17:  35%|███▌      | 7/20 [04:09<07:40, 35.41s/it]Task 10, Epoch 8/20 => Loss 1.911, Train_accy 94.77:  35%|███▌      | 7/20 [04:40<07:40, 35.41s/it]Task 10, Epoch 8/20 => Loss 1.911, Train_accy 94.77:  40%|████      | 8/20 [04:40<06:49, 34.14s/it]Task 10, Epoch 9/20 => Loss 1.916, Train_accy 94.94:  40%|████      | 8/20 [05:12<06:49, 34.14s/it]Task 10, Epoch 9/20 => Loss 1.916, Train_accy 94.94:  45%|████▌     | 9/20 [05:12<06:07, 33.38s/it]Task 10, Epoch 10/20 => Loss 1.867, Train_accy 95.51:  45%|████▌     | 9/20 [05:44<06:07, 33.38s/it]Task 10, Epoch 10/20 => Loss 1.867, Train_accy 95.51:  50%|█████     | 10/20 [05:44<05:28, 32.82s/it]Task 10, Epoch 11/20 => Loss 1.857, Train_accy 95.51, Test_accy 75.25:  50%|█████     | 10/20 [06:30<05:28, 32.82s/it]Task 10, Epoch 11/20 => Loss 1.857, Train_accy 95.51, Test_accy 75.25:  55%|█████▌    | 11/20 [06:30<05:31, 36.87s/it]Task 10, Epoch 12/20 => Loss 1.868, Train_accy 95.77:  55%|█████▌    | 11/20 [07:01<05:31, 36.87s/it]                 Task 10, Epoch 12/20 => Loss 1.868, Train_accy 95.77:  60%|██████    | 12/20 [07:01<04:42, 35.27s/it]Task 10, Epoch 13/20 => Loss 1.888, Train_accy 95.46:  60%|██████    | 12/20 [07:33<04:42, 35.27s/it]Task 10, Epoch 13/20 => Loss 1.888, Train_accy 95.46:  65%|██████▌   | 13/20 [07:33<03:59, 34.18s/it]Task 10, Epoch 14/20 => Loss 1.863, Train_accy 95.46:  65%|██████▌   | 13/20 [08:05<03:59, 34.18s/it]Task 10, Epoch 14/20 => Loss 1.863, Train_accy 95.46:  70%|███████   | 14/20 [08:05<03:20, 33.39s/it]Task 10, Epoch 15/20 => Loss 1.879, Train_accy 95.43:  70%|███████   | 14/20 [08:37<03:20, 33.39s/it]Task 10, Epoch 15/20 => Loss 1.879, Train_accy 95.43:  75%|███████▌  | 15/20 [08:37<02:44, 32.92s/it]Task 10, Epoch 16/20 => Loss 1.813, Train_accy 96.60, Test_accy 75.42:  75%|███████▌  | 15/20 [09:22<02:44, 32.92s/it]Task 10, Epoch 16/20 => Loss 1.813, Train_accy 96.60, Test_accy 75.42:  80%|████████  | 16/20 [09:22<02:27, 36.80s/it]Task 10, Epoch 17/20 => Loss 1.866, Train_accy 96.03:  80%|████████  | 16/20 [09:54<02:27, 36.80s/it]                 Task 10, Epoch 17/20 => Loss 1.866, Train_accy 96.03:  85%|████████▌ | 17/20 [09:54<01:45, 35.22s/it]Task 10, Epoch 18/20 => Loss 1.857, Train_accy 95.91:  85%|████████▌ | 17/20 [10:25<01:45, 35.22s/it]Task 10, Epoch 18/20 => Loss 1.857, Train_accy 95.91:  90%|█████████ | 18/20 [10:25<01:08, 34.11s/it]Task 10, Epoch 19/20 => Loss 1.893, Train_accy 94.71:  90%|█████████ | 18/20 [10:57<01:08, 34.11s/it]Task 10, Epoch 19/20 => Loss 1.893, Train_accy 94.71:  95%|█████████▌| 19/20 [10:57<00:33, 33.44s/it]Task 10, Epoch 20/20 => Loss 1.886, Train_accy 95.77:  95%|█████████▌| 19/20 [11:29<00:33, 33.44s/it]Task 10, Epoch 20/20 => Loss 1.886, Train_accy 95.77: 100%|██████████| 20/20 [11:29<00:00, 32.91s/it]Task 10, Epoch 20/20 => Loss 1.886, Train_accy 95.77: 100%|██████████| 20/20 [11:29<00:00, 34.47s/it]
2024-05-10 00:14:30,952 [icarl.py] => Task 10, Epoch 20/20 => Loss 1.886, Train_accy 95.77
2024-05-10 00:14:30,953 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 00:15:21,542 [icarl.py] => Exemplar size: 1100
2024-05-10 00:15:21,542 [trainer.py] => CNN: {'total': 74.44, '00-04': 70.0, '05-09': 51.2, '10-14': 49.4, '15-19': 67.4, '20-24': 75.2, '25-29': 78.4, '30-34': 77.8, '35-39': 78.4, '40-44': 86.0, '45-49': 86.2, '50-54': 98.8, 'old': 72.0, 'new': 98.8}
2024-05-10 00:15:21,542 [trainer.py] => NME: {'total': 85.07, '00-04': 89.0, '05-09': 72.4, '10-14': 71.6, '15-19': 81.4, '20-24': 90.4, '25-29': 87.2, '30-34': 86.4, '35-39': 82.8, '40-44': 89.4, '45-49': 92.6, '50-54': 92.6, 'old': 84.32, 'new': 92.6}
2024-05-10 00:15:21,542 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44]
2024-05-10 00:15:21,542 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51]
2024-05-10 00:15:21,542 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07]
2024-05-10 00:15:21,543 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76]

Average Accuracy (CNN): 85.14
Average Accuracy (NME): 92.47
2024-05-10 00:15:21,543 [trainer.py] => Average Accuracy (CNN): 85.14
2024-05-10 00:15:21,543 [trainer.py] => Average Accuracy (NME): 92.47
2024-05-10 00:15:21,543 [trainer.py] => Train Time: 0
2024-05-10 00:15:21,543 [trainer.py] => Test Time: 174.61999999999998 

2024-05-10 00:15:21,543 [trainer.py] => All params: 85840951
2024-05-10 00:15:21,544 [trainer.py] => Trainable params: 85840951
2024-05-10 00:15:21,545 [icarl.py] => Learning on 55-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 11, Epoch 1/20 => Loss 3.131, Train_accy 77.72, Test_accy 74.38:   0%|          | 0/20 [00:47<?, ?it/s]Task 11, Epoch 1/20 => Loss 3.131, Train_accy 77.72, Test_accy 74.38:   5%|▌         | 1/20 [00:47<15:09, 47.84s/it]Task 11, Epoch 2/20 => Loss 2.437, Train_accy 88.83:   5%|▌         | 1/20 [01:20<15:09, 47.84s/it]                 Task 11, Epoch 2/20 => Loss 2.437, Train_accy 88.83:  10%|█         | 2/20 [01:20<11:38, 38.78s/it]Task 11, Epoch 3/20 => Loss 2.417, Train_accy 89.22:  10%|█         | 2/20 [01:52<11:38, 38.78s/it]Task 11, Epoch 3/20 => Loss 2.417, Train_accy 89.22:  15%|█▌        | 3/20 [01:52<10:11, 35.99s/it]Task 11, Epoch 4/20 => Loss 2.390, Train_accy 90.56:  15%|█▌        | 3/20 [02:25<10:11, 35.99s/it]Task 11, Epoch 4/20 => Loss 2.390, Train_accy 90.56:  20%|██        | 4/20 [02:25<09:14, 34.66s/it]Task 11, Epoch 5/20 => Loss 2.356, Train_accy 91.56:  20%|██        | 4/20 [02:58<09:14, 34.66s/it]Task 11, Epoch 5/20 => Loss 2.356, Train_accy 91.56:  25%|██▌       | 5/20 [02:58<08:28, 33.90s/it]Task 11, Epoch 6/20 => Loss 2.320, Train_accy 93.06, Test_accy 73.58:  25%|██▌       | 5/20 [03:46<08:28, 33.90s/it]Task 11, Epoch 6/20 => Loss 2.320, Train_accy 93.06, Test_accy 73.58:  30%|███       | 6/20 [03:46<09:02, 38.72s/it]Task 11, Epoch 7/20 => Loss 2.310, Train_accy 92.83:  30%|███       | 6/20 [04:18<09:02, 38.72s/it]                 Task 11, Epoch 7/20 => Loss 2.310, Train_accy 92.83:  35%|███▌      | 7/20 [04:18<07:57, 36.71s/it]Task 11, Epoch 8/20 => Loss 2.303, Train_accy 92.97:  35%|███▌      | 7/20 [04:51<07:57, 36.71s/it]Task 11, Epoch 8/20 => Loss 2.303, Train_accy 92.97:  40%|████      | 8/20 [04:51<07:04, 35.39s/it]Task 11, Epoch 9/20 => Loss 2.305, Train_accy 92.97:  40%|████      | 8/20 [05:24<07:04, 35.39s/it]Task 11, Epoch 9/20 => Loss 2.305, Train_accy 92.97:  45%|████▌     | 9/20 [05:24<06:19, 34.54s/it]Task 11, Epoch 10/20 => Loss 2.286, Train_accy 93.31:  45%|████▌     | 9/20 [05:56<06:19, 34.54s/it]Task 11, Epoch 10/20 => Loss 2.286, Train_accy 93.31:  50%|█████     | 10/20 [05:56<05:39, 33.96s/it]Task 11, Epoch 11/20 => Loss 2.317, Train_accy 92.25, Test_accy 74.52:  50%|█████     | 10/20 [06:44<05:39, 33.96s/it]Task 11, Epoch 11/20 => Loss 2.317, Train_accy 92.25, Test_accy 74.52:  55%|█████▌    | 11/20 [06:44<05:44, 38.30s/it]Task 11, Epoch 12/20 => Loss 2.296, Train_accy 93.25:  55%|█████▌    | 11/20 [07:17<05:44, 38.30s/it]                 Task 11, Epoch 12/20 => Loss 2.296, Train_accy 93.25:  60%|██████    | 12/20 [07:17<04:52, 36.54s/it]Task 11, Epoch 13/20 => Loss 2.292, Train_accy 93.22:  60%|██████    | 12/20 [07:49<04:52, 36.54s/it]Task 11, Epoch 13/20 => Loss 2.292, Train_accy 93.22:  65%|██████▌   | 13/20 [07:49<04:07, 35.36s/it]Task 11, Epoch 14/20 => Loss 2.259, Train_accy 93.42:  65%|██████▌   | 13/20 [08:22<04:07, 35.36s/it]Task 11, Epoch 14/20 => Loss 2.259, Train_accy 93.42:  70%|███████   | 14/20 [08:22<03:27, 34.51s/it]Task 11, Epoch 15/20 => Loss 2.266, Train_accy 93.61:  70%|███████   | 14/20 [08:55<03:27, 34.51s/it]Task 11, Epoch 15/20 => Loss 2.266, Train_accy 93.61:  75%|███████▌  | 15/20 [08:55<02:49, 33.92s/it]Task 11, Epoch 16/20 => Loss 2.270, Train_accy 93.47, Test_accy 76.10:  75%|███████▌  | 15/20 [09:43<02:49, 33.92s/it]Task 11, Epoch 16/20 => Loss 2.270, Train_accy 93.47, Test_accy 76.10:  80%|████████  | 16/20 [09:43<02:32, 38.25s/it]Task 11, Epoch 17/20 => Loss 2.280, Train_accy 93.50:  80%|████████  | 16/20 [10:15<02:32, 38.25s/it]                 Task 11, Epoch 17/20 => Loss 2.280, Train_accy 93.50:  85%|████████▌ | 17/20 [10:15<01:49, 36.55s/it]Task 11, Epoch 18/20 => Loss 2.286, Train_accy 93.39:  85%|████████▌ | 17/20 [10:48<01:49, 36.55s/it]Task 11, Epoch 18/20 => Loss 2.286, Train_accy 93.39:  90%|█████████ | 18/20 [10:48<01:10, 35.36s/it]Task 11, Epoch 19/20 => Loss 2.266, Train_accy 93.64:  90%|█████████ | 18/20 [11:21<01:10, 35.36s/it]Task 11, Epoch 19/20 => Loss 2.266, Train_accy 93.64:  95%|█████████▌| 19/20 [11:21<00:34, 34.54s/it]Task 11, Epoch 20/20 => Loss 2.293, Train_accy 93.47:  95%|█████████▌| 19/20 [11:53<00:34, 34.54s/it]Task 11, Epoch 20/20 => Loss 2.293, Train_accy 93.47: 100%|██████████| 20/20 [11:53<00:00, 34.02s/it]Task 11, Epoch 20/20 => Loss 2.293, Train_accy 93.47: 100%|██████████| 20/20 [11:53<00:00, 35.70s/it]
2024-05-10 00:27:15,580 [icarl.py] => Task 11, Epoch 20/20 => Loss 2.293, Train_accy 93.47
2024-05-10 00:27:15,582 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 00:28:09,944 [icarl.py] => Exemplar size: 1200
2024-05-10 00:28:09,944 [trainer.py] => CNN: {'total': 75.55, '00-04': 73.6, '05-09': 51.8, '10-14': 50.2, '15-19': 60.8, '20-24': 75.0, '25-29': 75.8, '30-34': 77.0, '35-39': 77.0, '40-44': 86.0, '45-49': 86.0, '50-54': 97.4, '55-59': 96.0, 'old': 73.69, 'new': 96.0}
2024-05-10 00:28:09,944 [trainer.py] => NME: {'total': 85.6, '00-04': 89.6, '05-09': 73.4, '10-14': 72.2, '15-19': 79.2, '20-24': 91.8, '25-29': 86.0, '30-34': 85.6, '35-39': 83.4, '40-44': 89.0, '45-49': 92.8, '50-54': 91.6, '55-59': 92.6, 'old': 84.96, 'new': 92.6}
2024-05-10 00:28:09,944 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44, 75.55]
2024-05-10 00:28:09,944 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51, 91.55]
2024-05-10 00:28:09,944 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07, 85.6]
2024-05-10 00:28:09,944 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76, 97.43]

Average Accuracy (CNN): 84.34
Average Accuracy (NME): 91.9
2024-05-10 00:28:09,944 [trainer.py] => Average Accuracy (CNN): 84.34
2024-05-10 00:28:09,944 [trainer.py] => Average Accuracy (NME): 91.9
2024-05-10 00:28:09,945 [trainer.py] => Train Time: 0
2024-05-10 00:28:09,945 [trainer.py] => Test Time: 205.26999999999998 

2024-05-10 00:28:09,945 [trainer.py] => All params: 85844796
2024-05-10 00:28:09,946 [trainer.py] => Trainable params: 85844796
2024-05-10 00:28:09,947 [icarl.py] => Learning on 60-65
  0%|          | 0/20 [00:00<?, ?it/s]Task 12, Epoch 1/20 => Loss 2.895, Train_accy 82.03, Test_accy 74.58:   0%|          | 0/20 [00:50<?, ?it/s]Task 12, Epoch 1/20 => Loss 2.895, Train_accy 82.03, Test_accy 74.58:   5%|▌         | 1/20 [00:50<15:56, 50.33s/it]Task 12, Epoch 2/20 => Loss 1.996, Train_accy 92.76:   5%|▌         | 1/20 [01:23<15:56, 50.33s/it]                 Task 12, Epoch 2/20 => Loss 1.996, Train_accy 92.76:  10%|█         | 2/20 [01:23<12:08, 40.45s/it]Task 12, Epoch 3/20 => Loss 1.948, Train_accy 93.54:  10%|█         | 2/20 [01:57<12:08, 40.45s/it]Task 12, Epoch 3/20 => Loss 1.948, Train_accy 93.54:  15%|█▌        | 3/20 [01:57<10:34, 37.30s/it]Task 12, Epoch 4/20 => Loss 1.960, Train_accy 94.03:  15%|█▌        | 3/20 [02:31<10:34, 37.30s/it]Task 12, Epoch 4/20 => Loss 1.960, Train_accy 94.03:  20%|██        | 4/20 [02:31<09:33, 35.86s/it]Task 12, Epoch 5/20 => Loss 1.920, Train_accy 94.70:  20%|██        | 4/20 [03:04<09:33, 35.86s/it]Task 12, Epoch 5/20 => Loss 1.920, Train_accy 94.70:  25%|██▌       | 5/20 [03:04<08:44, 34.99s/it]Task 12, Epoch 6/20 => Loss 1.923, Train_accy 94.49, Test_accy 72.69:  25%|██▌       | 5/20 [03:54<08:44, 34.99s/it]Task 12, Epoch 6/20 => Loss 1.923, Train_accy 94.49, Test_accy 72.69:  30%|███       | 6/20 [03:54<09:22, 40.19s/it]Task 12, Epoch 7/20 => Loss 1.913, Train_accy 95.22:  30%|███       | 6/20 [04:28<09:22, 40.19s/it]                 Task 12, Epoch 7/20 => Loss 1.913, Train_accy 95.22:  35%|███▌      | 7/20 [04:28<08:14, 38.01s/it]Task 12, Epoch 8/20 => Loss 1.934, Train_accy 95.08:  35%|███▌      | 7/20 [05:01<08:14, 38.01s/it]Task 12, Epoch 8/20 => Loss 1.934, Train_accy 95.08:  40%|████      | 8/20 [05:01<07:18, 36.57s/it]Task 12, Epoch 9/20 => Loss 1.882, Train_accy 95.46:  40%|████      | 8/20 [05:35<07:18, 36.57s/it]Task 12, Epoch 9/20 => Loss 1.882, Train_accy 95.46:  45%|████▌     | 9/20 [05:35<06:31, 35.60s/it]Task 12, Epoch 10/20 => Loss 1.922, Train_accy 95.00:  45%|████▌     | 9/20 [06:09<06:31, 35.60s/it]Task 12, Epoch 10/20 => Loss 1.922, Train_accy 95.00:  50%|█████     | 10/20 [06:09<05:50, 35.03s/it]Task 12, Epoch 11/20 => Loss 1.916, Train_accy 95.16, Test_accy 72.37:  50%|█████     | 10/20 [06:59<05:50, 35.03s/it]Task 12, Epoch 11/20 => Loss 1.916, Train_accy 95.16, Test_accy 72.37:  55%|█████▌    | 11/20 [06:59<05:57, 39.68s/it]Task 12, Epoch 12/20 => Loss 1.931, Train_accy 94.70:  55%|█████▌    | 11/20 [07:32<05:57, 39.68s/it]                 Task 12, Epoch 12/20 => Loss 1.931, Train_accy 94.70:  60%|██████    | 12/20 [07:32<05:02, 37.81s/it]Task 12, Epoch 13/20 => Loss 1.893, Train_accy 95.16:  60%|██████    | 12/20 [08:06<05:02, 37.81s/it]Task 12, Epoch 13/20 => Loss 1.893, Train_accy 95.16:  65%|██████▌   | 13/20 [08:06<04:15, 36.47s/it]Task 12, Epoch 14/20 => Loss 1.901, Train_accy 95.54:  65%|██████▌   | 13/20 [08:39<04:15, 36.47s/it]Task 12, Epoch 14/20 => Loss 1.901, Train_accy 95.54:  70%|███████   | 14/20 [08:39<03:33, 35.60s/it]Task 12, Epoch 15/20 => Loss 1.884, Train_accy 96.00:  70%|███████   | 14/20 [09:13<03:33, 35.60s/it]Task 12, Epoch 15/20 => Loss 1.884, Train_accy 96.00:  75%|███████▌  | 15/20 [09:13<02:54, 35.00s/it]Task 12, Epoch 16/20 => Loss 1.900, Train_accy 95.62, Test_accy 72.26:  75%|███████▌  | 15/20 [10:03<02:54, 35.00s/it]Task 12, Epoch 16/20 => Loss 1.900, Train_accy 95.62, Test_accy 72.26:  80%|████████  | 16/20 [10:03<02:38, 39.69s/it]Task 12, Epoch 17/20 => Loss 1.857, Train_accy 96.00:  80%|████████  | 16/20 [10:37<02:38, 39.69s/it]                 Task 12, Epoch 17/20 => Loss 1.857, Train_accy 96.00:  85%|████████▌ | 17/20 [10:37<01:53, 37.78s/it]Task 12, Epoch 18/20 => Loss 1.904, Train_accy 94.95:  85%|████████▌ | 17/20 [11:10<01:53, 37.78s/it]Task 12, Epoch 18/20 => Loss 1.904, Train_accy 94.95:  90%|█████████ | 18/20 [11:10<01:12, 36.47s/it]Task 12, Epoch 19/20 => Loss 1.916, Train_accy 95.14:  90%|█████████ | 18/20 [11:44<01:12, 36.47s/it]Task 12, Epoch 19/20 => Loss 1.916, Train_accy 95.14:  95%|█████████▌| 19/20 [11:44<00:35, 35.66s/it]Task 12, Epoch 20/20 => Loss 1.858, Train_accy 96.19:  95%|█████████▌| 19/20 [12:17<00:35, 35.66s/it]Task 12, Epoch 20/20 => Loss 1.858, Train_accy 96.19: 100%|██████████| 20/20 [12:17<00:00, 35.00s/it]Task 12, Epoch 20/20 => Loss 1.858, Train_accy 96.19: 100%|██████████| 20/20 [12:17<00:00, 36.90s/it]
2024-05-10 00:40:27,930 [icarl.py] => Task 12, Epoch 20/20 => Loss 1.858, Train_accy 96.19
2024-05-10 00:40:27,931 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 00:41:25,480 [icarl.py] => Exemplar size: 1300
2024-05-10 00:41:25,480 [trainer.py] => CNN: {'total': 74.75, '00-04': 77.2, '05-09': 54.6, '10-14': 48.8, '15-19': 60.0, '20-24': 76.0, '25-29': 80.0, '30-34': 74.6, '35-39': 70.2, '40-44': 83.2, '45-49': 81.6, '50-54': 94.2, '55-59': 72.2, '60-64': 99.2, 'old': 72.72, 'new': 99.2}
2024-05-10 00:41:25,480 [trainer.py] => NME: {'total': 84.85, '00-04': 90.4, '05-09': 75.0, '10-14': 69.6, '15-19': 79.2, '20-24': 91.0, '25-29': 86.8, '30-34': 83.8, '35-39': 80.6, '40-44': 86.8, '45-49': 92.4, '50-54': 91.2, '55-59': 82.6, '60-64': 93.6, 'old': 84.12, 'new': 93.6}
2024-05-10 00:41:25,480 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44, 75.55, 74.75]
2024-05-10 00:41:25,480 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51, 91.55, 91.55]
2024-05-10 00:41:25,480 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07, 85.6, 84.85]
2024-05-10 00:41:25,480 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76, 97.43, 97.42]

Average Accuracy (CNN): 83.6
Average Accuracy (NME): 91.35
2024-05-10 00:41:25,480 [trainer.py] => Average Accuracy (CNN): 83.6
2024-05-10 00:41:25,480 [trainer.py] => Average Accuracy (NME): 91.35
2024-05-10 00:41:25,480 [trainer.py] => Train Time: 0
2024-05-10 00:41:25,481 [trainer.py] => Test Time: 238.82 

2024-05-10 00:41:25,481 [trainer.py] => All params: 85848641
2024-05-10 00:41:25,481 [trainer.py] => Trainable params: 85848641
2024-05-10 00:41:25,483 [icarl.py] => Learning on 65-70
  0%|          | 0/20 [00:00<?, ?it/s]Task 13, Epoch 1/20 => Loss 2.871, Train_accy 83.47, Test_accy 71.00:   0%|          | 0/20 [00:52<?, ?it/s]Task 13, Epoch 1/20 => Loss 2.871, Train_accy 83.47, Test_accy 71.00:   5%|▌         | 1/20 [00:52<16:28, 52.02s/it]Task 13, Epoch 2/20 => Loss 2.103, Train_accy 94.71:   5%|▌         | 1/20 [01:26<16:28, 52.02s/it]                 Task 13, Epoch 2/20 => Loss 2.103, Train_accy 94.71:  10%|█         | 2/20 [01:26<12:28, 41.56s/it]Task 13, Epoch 3/20 => Loss 2.063, Train_accy 94.47:  10%|█         | 2/20 [02:00<12:28, 41.56s/it]Task 13, Epoch 3/20 => Loss 2.063, Train_accy 94.47:  15%|█▌        | 3/20 [02:00<10:48, 38.17s/it]Task 13, Epoch 4/20 => Loss 2.077, Train_accy 95.08:  15%|█▌        | 3/20 [02:34<10:48, 38.17s/it]Task 13, Epoch 4/20 => Loss 2.077, Train_accy 95.08:  20%|██        | 4/20 [02:34<09:45, 36.58s/it]Task 13, Epoch 5/20 => Loss 2.083, Train_accy 94.82:  20%|██        | 4/20 [03:08<09:45, 36.58s/it]Task 13, Epoch 5/20 => Loss 2.083, Train_accy 94.82:  25%|██▌       | 5/20 [03:08<08:56, 35.76s/it]Task 13, Epoch 6/20 => Loss 2.040, Train_accy 95.50, Test_accy 72.73:  25%|██▌       | 5/20 [04:01<08:56, 35.76s/it]Task 13, Epoch 6/20 => Loss 2.040, Train_accy 95.50, Test_accy 72.73:  30%|███       | 6/20 [04:01<09:39, 41.40s/it]Task 13, Epoch 7/20 => Loss 2.061, Train_accy 95.39:  30%|███       | 6/20 [04:35<09:39, 41.40s/it]                 Task 13, Epoch 7/20 => Loss 2.061, Train_accy 95.39:  35%|███▌      | 7/20 [04:35<08:27, 39.03s/it]Task 13, Epoch 8/20 => Loss 2.043, Train_accy 95.55:  35%|███▌      | 7/20 [05:09<08:27, 39.03s/it]Task 13, Epoch 8/20 => Loss 2.043, Train_accy 95.55:  40%|████      | 8/20 [05:09<07:29, 37.49s/it]Task 13, Epoch 9/20 => Loss 2.080, Train_accy 94.74:  40%|████      | 8/20 [05:43<07:29, 37.49s/it]Task 13, Epoch 9/20 => Loss 2.080, Train_accy 94.74:  45%|████▌     | 9/20 [05:43<06:41, 36.47s/it]Task 13, Epoch 10/20 => Loss 2.064, Train_accy 95.29:  45%|████▌     | 9/20 [06:17<06:41, 36.47s/it]Task 13, Epoch 10/20 => Loss 2.064, Train_accy 95.29:  50%|█████     | 10/20 [06:17<05:57, 35.75s/it]Task 13, Epoch 11/20 => Loss 2.092, Train_accy 95.18, Test_accy 72.54:  50%|█████     | 10/20 [07:10<05:57, 35.75s/it]Task 13, Epoch 11/20 => Loss 2.092, Train_accy 95.18, Test_accy 72.54:  55%|█████▌    | 11/20 [07:10<06:07, 40.79s/it]Task 13, Epoch 12/20 => Loss 2.066, Train_accy 95.39:  55%|█████▌    | 11/20 [07:44<06:07, 40.79s/it]                 Task 13, Epoch 12/20 => Loss 2.066, Train_accy 95.39:  60%|██████    | 12/20 [07:44<05:10, 38.79s/it]Task 13, Epoch 13/20 => Loss 2.039, Train_accy 95.39:  60%|██████    | 12/20 [08:18<05:10, 38.79s/it]Task 13, Epoch 13/20 => Loss 2.039, Train_accy 95.39:  65%|██████▌   | 13/20 [08:18<04:21, 37.39s/it]Task 13, Epoch 14/20 => Loss 2.045, Train_accy 95.76:  65%|██████▌   | 13/20 [08:52<04:21, 37.39s/it]Task 13, Epoch 14/20 => Loss 2.045, Train_accy 95.76:  70%|███████   | 14/20 [08:52<03:38, 36.43s/it]Task 13, Epoch 15/20 => Loss 2.028, Train_accy 95.79:  70%|███████   | 14/20 [09:27<03:38, 36.43s/it]Task 13, Epoch 15/20 => Loss 2.028, Train_accy 95.79:  75%|███████▌  | 15/20 [09:27<02:58, 35.79s/it]Task 13, Epoch 16/20 => Loss 2.063, Train_accy 94.97, Test_accy 73.93:  75%|███████▌  | 15/20 [10:19<02:58, 35.79s/it]Task 13, Epoch 16/20 => Loss 2.063, Train_accy 94.97, Test_accy 73.93:  80%|████████  | 16/20 [10:19<02:42, 40.68s/it]Task 13, Epoch 17/20 => Loss 2.043, Train_accy 95.63:  80%|████████  | 16/20 [10:53<02:42, 40.68s/it]                 Task 13, Epoch 17/20 => Loss 2.043, Train_accy 95.63:  85%|████████▌ | 17/20 [10:53<01:56, 38.77s/it]Task 13, Epoch 18/20 => Loss 2.052, Train_accy 95.34:  85%|████████▌ | 17/20 [11:27<01:56, 38.77s/it]Task 13, Epoch 18/20 => Loss 2.052, Train_accy 95.34:  90%|█████████ | 18/20 [11:27<01:14, 37.42s/it]Task 13, Epoch 19/20 => Loss 2.021, Train_accy 96.32:  90%|█████████ | 18/20 [12:01<01:14, 37.42s/it]Task 13, Epoch 19/20 => Loss 2.021, Train_accy 96.32:  95%|█████████▌| 19/20 [12:01<00:36, 36.47s/it]Task 13, Epoch 20/20 => Loss 2.005, Train_accy 96.61:  95%|█████████▌| 19/20 [12:36<00:36, 36.47s/it]Task 13, Epoch 20/20 => Loss 2.005, Train_accy 96.61: 100%|██████████| 20/20 [12:36<00:00, 35.83s/it]Task 13, Epoch 20/20 => Loss 2.005, Train_accy 96.61: 100%|██████████| 20/20 [12:36<00:00, 37.81s/it]
2024-05-10 00:54:01,811 [icarl.py] => Task 13, Epoch 20/20 => Loss 2.005, Train_accy 96.61
2024-05-10 00:54:01,812 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 00:55:03,523 [icarl.py] => Exemplar size: 1400
2024-05-10 00:55:03,523 [trainer.py] => CNN: {'total': 73.89, '00-04': 70.8, '05-09': 53.8, '10-14': 46.6, '15-19': 52.2, '20-24': 79.4, '25-29': 76.0, '30-34': 74.6, '35-39': 67.6, '40-44': 80.4, '45-49': 80.6, '50-54': 90.4, '55-59': 70.8, '60-64': 91.4, '65-69': 99.8, 'old': 71.89, 'new': 99.8}
2024-05-10 00:55:03,523 [trainer.py] => NME: {'total': 84.69, '00-04': 86.0, '05-09': 72.8, '10-14': 66.4, '15-19': 78.4, '20-24': 91.6, '25-29': 86.2, '30-34': 83.6, '35-39': 80.2, '40-44': 87.4, '45-49': 92.0, '50-54': 89.2, '55-59': 84.0, '60-64': 91.0, '65-69': 96.8, 'old': 83.75, 'new': 96.8}
2024-05-10 00:55:03,523 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44, 75.55, 74.75, 73.89]
2024-05-10 00:55:03,524 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51, 91.55, 91.55, 90.21]
2024-05-10 00:55:03,524 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07, 85.6, 84.85, 84.69]
2024-05-10 00:55:03,524 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76, 97.43, 97.42, 97.0]

Average Accuracy (CNN): 82.91
Average Accuracy (NME): 90.88
2024-05-10 00:55:03,524 [trainer.py] => Average Accuracy (CNN): 82.91
2024-05-10 00:55:03,524 [trainer.py] => Average Accuracy (NME): 90.88
2024-05-10 00:55:03,524 [trainer.py] => Train Time: 0
2024-05-10 00:55:03,524 [trainer.py] => Test Time: 274.95 

2024-05-10 00:55:03,524 [trainer.py] => All params: 85852486
2024-05-10 00:55:03,525 [trainer.py] => Trainable params: 85852486
2024-05-10 00:55:03,526 [icarl.py] => Learning on 70-75
  0%|          | 0/20 [00:00<?, ?it/s]Task 14, Epoch 1/20 => Loss 2.879, Train_accy 79.90, Test_accy 70.59:   0%|          | 0/20 [00:54<?, ?it/s]Task 14, Epoch 1/20 => Loss 2.879, Train_accy 79.90, Test_accy 70.59:   5%|▌         | 1/20 [00:54<17:11, 54.29s/it]Task 14, Epoch 2/20 => Loss 2.008, Train_accy 91.33:   5%|▌         | 1/20 [01:29<17:11, 54.29s/it]                 Task 14, Epoch 2/20 => Loss 2.008, Train_accy 91.33:  10%|█         | 2/20 [01:29<12:53, 42.99s/it]Task 14, Epoch 3/20 => Loss 1.869, Train_accy 93.41:  10%|█         | 2/20 [02:04<12:53, 42.99s/it]Task 14, Epoch 3/20 => Loss 1.869, Train_accy 93.41:  15%|█▌        | 3/20 [02:04<11:10, 39.43s/it]Task 14, Epoch 4/20 => Loss 1.837, Train_accy 93.87:  15%|█▌        | 3/20 [02:39<11:10, 39.43s/it]Task 14, Epoch 4/20 => Loss 1.837, Train_accy 93.87:  20%|██        | 4/20 [02:39<10:04, 37.76s/it]Task 14, Epoch 5/20 => Loss 1.844, Train_accy 93.92:  20%|██        | 4/20 [03:14<10:04, 37.76s/it]Task 14, Epoch 5/20 => Loss 1.844, Train_accy 93.92:  25%|██▌       | 5/20 [03:14<09:12, 36.81s/it]Task 14, Epoch 6/20 => Loss 1.866, Train_accy 94.15, Test_accy 71.68:  25%|██▌       | 5/20 [04:09<09:12, 36.81s/it]Task 14, Epoch 6/20 => Loss 1.866, Train_accy 94.15, Test_accy 71.68:  30%|███       | 6/20 [04:09<09:59, 42.83s/it]Task 14, Epoch 7/20 => Loss 1.802, Train_accy 95.03:  30%|███       | 6/20 [04:44<09:59, 42.83s/it]                 Task 14, Epoch 7/20 => Loss 1.802, Train_accy 95.03:  35%|███▌      | 7/20 [04:44<08:44, 40.33s/it]Task 14, Epoch 8/20 => Loss 1.818, Train_accy 94.77:  35%|███▌      | 7/20 [05:19<08:44, 40.33s/it]Task 14, Epoch 8/20 => Loss 1.818, Train_accy 94.77:  40%|████      | 8/20 [05:19<07:44, 38.74s/it]Task 14, Epoch 9/20 => Loss 1.842, Train_accy 94.08:  40%|████      | 8/20 [05:55<07:44, 38.74s/it]Task 14, Epoch 9/20 => Loss 1.842, Train_accy 94.08:  45%|████▌     | 9/20 [05:55<06:54, 37.65s/it]Task 14, Epoch 10/20 => Loss 1.818, Train_accy 94.87:  45%|████▌     | 9/20 [06:30<06:54, 37.65s/it]Task 14, Epoch 10/20 => Loss 1.818, Train_accy 94.87:  50%|█████     | 10/20 [06:30<06:08, 36.86s/it]Task 14, Epoch 11/20 => Loss 1.858, Train_accy 94.67, Test_accy 71.56:  50%|█████     | 10/20 [07:24<06:08, 36.86s/it]Task 14, Epoch 11/20 => Loss 1.858, Train_accy 94.67, Test_accy 71.56:  55%|█████▌    | 11/20 [07:24<06:20, 42.29s/it]Task 14, Epoch 12/20 => Loss 1.837, Train_accy 95.38:  55%|█████▌    | 11/20 [08:00<06:20, 42.29s/it]                 Task 14, Epoch 12/20 => Loss 1.837, Train_accy 95.38:  60%|██████    | 12/20 [08:00<05:21, 40.19s/it]Task 14, Epoch 13/20 => Loss 1.784, Train_accy 95.77:  60%|██████    | 12/20 [08:35<05:21, 40.19s/it]Task 14, Epoch 13/20 => Loss 1.784, Train_accy 95.77:  65%|██████▌   | 13/20 [08:35<04:30, 38.67s/it]Task 14, Epoch 14/20 => Loss 1.792, Train_accy 95.28:  65%|██████▌   | 13/20 [09:10<04:30, 38.67s/it]Task 14, Epoch 14/20 => Loss 1.792, Train_accy 95.28:  70%|███████   | 14/20 [09:10<03:45, 37.63s/it]Task 14, Epoch 15/20 => Loss 1.827, Train_accy 94.92:  70%|███████   | 14/20 [09:45<03:45, 37.63s/it]Task 14, Epoch 15/20 => Loss 1.827, Train_accy 94.92:  75%|███████▌  | 15/20 [09:45<03:04, 36.92s/it]Task 14, Epoch 16/20 => Loss 1.819, Train_accy 95.41, Test_accy 71.16:  75%|███████▌  | 15/20 [10:40<03:04, 36.92s/it]Task 14, Epoch 16/20 => Loss 1.819, Train_accy 95.41, Test_accy 71.16:  80%|████████  | 16/20 [10:40<02:48, 42.21s/it]Task 14, Epoch 17/20 => Loss 1.792, Train_accy 95.90:  80%|████████  | 16/20 [11:15<02:48, 42.21s/it]                 Task 14, Epoch 17/20 => Loss 1.792, Train_accy 95.90:  85%|████████▌ | 17/20 [11:15<02:00, 40.06s/it]Task 14, Epoch 18/20 => Loss 1.834, Train_accy 94.69:  85%|████████▌ | 17/20 [11:50<02:00, 40.06s/it]Task 14, Epoch 18/20 => Loss 1.834, Train_accy 94.69:  90%|█████████ | 18/20 [11:50<01:17, 38.61s/it]Task 14, Epoch 19/20 => Loss 1.813, Train_accy 95.51:  90%|█████████ | 18/20 [12:25<01:17, 38.61s/it]Task 14, Epoch 19/20 => Loss 1.813, Train_accy 95.51:  95%|█████████▌| 19/20 [12:25<00:37, 37.60s/it]Task 14, Epoch 20/20 => Loss 1.795, Train_accy 95.59:  95%|█████████▌| 19/20 [13:01<00:37, 37.60s/it]Task 14, Epoch 20/20 => Loss 1.795, Train_accy 95.59: 100%|██████████| 20/20 [13:01<00:00, 36.87s/it]Task 14, Epoch 20/20 => Loss 1.795, Train_accy 95.59: 100%|██████████| 20/20 [13:01<00:00, 39.06s/it]
2024-05-10 01:08:04,707 [icarl.py] => Task 14, Epoch 20/20 => Loss 1.795, Train_accy 95.59
2024-05-10 01:08:04,708 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 01:09:10,198 [icarl.py] => Exemplar size: 1500
2024-05-10 01:09:10,198 [trainer.py] => CNN: {'total': 72.29, '00-04': 67.6, '05-09': 51.8, '10-14': 47.8, '15-19': 54.4, '20-24': 77.4, '25-29': 78.8, '30-34': 74.4, '35-39': 62.4, '40-44': 75.0, '45-49': 81.4, '50-54': 85.0, '55-59': 60.0, '60-64': 74.2, '65-69': 94.6, '70-74': 99.6, 'old': 70.34, 'new': 99.6}
2024-05-10 01:09:10,198 [trainer.py] => NME: {'total': 83.45, '00-04': 84.0, '05-09': 71.4, '10-14': 66.8, '15-19': 77.2, '20-24': 92.0, '25-29': 87.0, '30-34': 84.4, '35-39': 79.0, '40-44': 83.8, '45-49': 89.2, '50-54': 88.6, '55-59': 77.4, '60-64': 80.2, '65-69': 95.6, '70-74': 95.2, 'old': 82.61, 'new': 95.2}
2024-05-10 01:09:10,198 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44, 75.55, 74.75, 73.89, 72.29]
2024-05-10 01:09:10,198 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51, 91.55, 91.55, 90.21, 89.96]
2024-05-10 01:09:10,198 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07, 85.6, 84.85, 84.69, 83.45]
2024-05-10 01:09:10,198 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76, 97.43, 97.42, 97.0, 96.37]

Average Accuracy (CNN): 82.2
Average Accuracy (NME): 90.38
2024-05-10 01:09:10,198 [trainer.py] => Average Accuracy (CNN): 82.2
2024-05-10 01:09:10,198 [trainer.py] => Average Accuracy (NME): 90.38
2024-05-10 01:09:10,198 [trainer.py] => Train Time: 0
2024-05-10 01:09:10,198 [trainer.py] => Test Time: 313.64 

2024-05-10 01:09:10,199 [trainer.py] => All params: 85856331
2024-05-10 01:09:10,199 [trainer.py] => Trainable params: 85856331
2024-05-10 01:09:10,201 [icarl.py] => Learning on 75-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 15, Epoch 1/20 => Loss 2.886, Train_accy 80.68, Test_accy 68.56:   0%|          | 0/20 [00:56<?, ?it/s]Task 15, Epoch 1/20 => Loss 2.886, Train_accy 80.68, Test_accy 68.56:   5%|▌         | 1/20 [00:56<17:50, 56.36s/it]Task 15, Epoch 2/20 => Loss 1.992, Train_accy 91.15:   5%|▌         | 1/20 [01:32<17:50, 56.36s/it]                 Task 15, Epoch 2/20 => Loss 1.992, Train_accy 91.15:  10%|█         | 2/20 [01:32<13:19, 44.40s/it]Task 15, Epoch 3/20 => Loss 1.936, Train_accy 92.38:  10%|█         | 2/20 [02:08<13:19, 44.40s/it]Task 15, Epoch 3/20 => Loss 1.936, Train_accy 92.38:  15%|█▌        | 3/20 [02:08<11:29, 40.58s/it]Task 15, Epoch 4/20 => Loss 1.884, Train_accy 93.12:  15%|█▌        | 3/20 [02:44<11:29, 40.58s/it]Task 15, Epoch 4/20 => Loss 1.884, Train_accy 93.12:  20%|██        | 4/20 [02:44<10:21, 38.82s/it]Task 15, Epoch 5/20 => Loss 1.859, Train_accy 93.82:  20%|██        | 4/20 [03:20<10:21, 38.82s/it]Task 15, Epoch 5/20 => Loss 1.859, Train_accy 93.82:  25%|██▌       | 5/20 [03:20<09:27, 37.86s/it]Task 15, Epoch 6/20 => Loss 1.850, Train_accy 94.20, Test_accy 68.11:  25%|██▌       | 5/20 [04:17<09:27, 37.86s/it]Task 15, Epoch 6/20 => Loss 1.850, Train_accy 94.20, Test_accy 68.11:  30%|███       | 6/20 [04:17<10:19, 44.24s/it]Task 15, Epoch 7/20 => Loss 1.876, Train_accy 93.75:  30%|███       | 6/20 [04:53<10:19, 44.24s/it]                 Task 15, Epoch 7/20 => Loss 1.876, Train_accy 93.75:  35%|███▌      | 7/20 [04:53<09:00, 41.57s/it]Task 15, Epoch 8/20 => Loss 1.828, Train_accy 94.95:  35%|███▌      | 7/20 [05:29<09:00, 41.57s/it]Task 15, Epoch 8/20 => Loss 1.828, Train_accy 94.95:  40%|████      | 8/20 [05:29<07:58, 39.84s/it]Task 15, Epoch 9/20 => Loss 1.849, Train_accy 93.88:  40%|████      | 8/20 [06:05<07:58, 39.84s/it]Task 15, Epoch 9/20 => Loss 1.849, Train_accy 93.88:  45%|████▌     | 9/20 [06:05<07:05, 38.68s/it]Task 15, Epoch 10/20 => Loss 1.845, Train_accy 94.45:  45%|████▌     | 9/20 [06:41<07:05, 38.68s/it]Task 15, Epoch 10/20 => Loss 1.845, Train_accy 94.45:  50%|█████     | 10/20 [06:41<06:19, 37.90s/it]Task 15, Epoch 11/20 => Loss 1.851, Train_accy 94.52, Test_accy 68.53:  50%|█████     | 10/20 [07:38<06:19, 37.90s/it]Task 15, Epoch 11/20 => Loss 1.851, Train_accy 94.52, Test_accy 68.53:  55%|█████▌    | 11/20 [07:38<06:32, 43.63s/it]Task 15, Epoch 12/20 => Loss 1.819, Train_accy 95.42:  55%|█████▌    | 11/20 [08:14<06:32, 43.63s/it]                 Task 15, Epoch 12/20 => Loss 1.819, Train_accy 95.42:  60%|██████    | 12/20 [08:14<05:31, 41.41s/it]Task 15, Epoch 13/20 => Loss 1.852, Train_accy 95.15:  60%|██████    | 12/20 [08:51<05:31, 41.41s/it]Task 15, Epoch 13/20 => Loss 1.852, Train_accy 95.15:  65%|██████▌   | 13/20 [08:51<04:38, 39.85s/it]Task 15, Epoch 14/20 => Loss 1.834, Train_accy 95.00:  65%|██████▌   | 13/20 [09:27<04:38, 39.85s/it]Task 15, Epoch 14/20 => Loss 1.834, Train_accy 95.00:  70%|███████   | 14/20 [09:27<03:52, 38.72s/it]Task 15, Epoch 15/20 => Loss 1.819, Train_accy 95.28:  70%|███████   | 14/20 [10:03<03:52, 38.72s/it]Task 15, Epoch 15/20 => Loss 1.819, Train_accy 95.28:  75%|███████▌  | 15/20 [10:03<03:09, 38.00s/it]Task 15, Epoch 16/20 => Loss 1.812, Train_accy 95.70, Test_accy 69.01:  75%|███████▌  | 15/20 [11:00<03:09, 38.00s/it]Task 15, Epoch 16/20 => Loss 1.812, Train_accy 95.70, Test_accy 69.01:  80%|████████  | 16/20 [11:00<02:54, 43.64s/it]Task 15, Epoch 17/20 => Loss 1.798, Train_accy 95.55:  80%|████████  | 16/20 [11:36<02:54, 43.64s/it]                 Task 15, Epoch 17/20 => Loss 1.798, Train_accy 95.55:  85%|████████▌ | 17/20 [11:36<02:04, 41.42s/it]Task 15, Epoch 18/20 => Loss 1.812, Train_accy 96.02:  85%|████████▌ | 17/20 [12:12<02:04, 41.42s/it]Task 15, Epoch 18/20 => Loss 1.812, Train_accy 96.02:  90%|█████████ | 18/20 [12:12<01:19, 39.88s/it]Task 15, Epoch 19/20 => Loss 1.816, Train_accy 95.68:  90%|█████████ | 18/20 [12:49<01:19, 39.88s/it]Task 15, Epoch 19/20 => Loss 1.816, Train_accy 95.68:  95%|█████████▌| 19/20 [12:49<00:38, 38.81s/it]Task 15, Epoch 20/20 => Loss 1.807, Train_accy 95.68:  95%|█████████▌| 19/20 [13:25<00:38, 38.81s/it]Task 15, Epoch 20/20 => Loss 1.807, Train_accy 95.68: 100%|██████████| 20/20 [13:25<00:00, 37.99s/it]Task 15, Epoch 20/20 => Loss 1.807, Train_accy 95.68: 100%|██████████| 20/20 [13:25<00:00, 40.26s/it]
2024-05-10 01:22:35,388 [icarl.py] => Task 15, Epoch 20/20 => Loss 1.807, Train_accy 95.68
2024-05-10 01:22:35,390 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 01:23:44,878 [icarl.py] => Exemplar size: 1600
2024-05-10 01:23:44,878 [trainer.py] => CNN: {'total': 68.79, '00-04': 63.4, '05-09': 46.6, '10-14': 48.6, '15-19': 57.4, '20-24': 74.6, '25-29': 76.8, '30-34': 75.0, '35-39': 57.8, '40-44': 72.6, '45-49': 58.8, '50-54': 62.4, '55-59': 58.8, '60-64': 72.6, '65-69': 93.6, '70-74': 82.2, '75-79': 99.4, 'old': 66.75, 'new': 99.4}
2024-05-10 01:23:44,878 [trainer.py] => NME: {'total': 81.65, '00-04': 83.4, '05-09': 71.8, '10-14': 65.2, '15-19': 75.0, '20-24': 91.8, '25-29': 87.8, '30-34': 82.0, '35-39': 77.2, '40-44': 83.6, '45-49': 83.0, '50-54': 78.6, '55-59': 74.6, '60-64': 81.6, '65-69': 94.0, '70-74': 87.6, '75-79': 89.2, 'old': 81.15, 'new': 89.2}
2024-05-10 01:23:44,878 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44, 75.55, 74.75, 73.89, 72.29, 68.79]
2024-05-10 01:23:44,878 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51, 91.55, 91.55, 90.21, 89.96, 88.78]
2024-05-10 01:23:44,878 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07, 85.6, 84.85, 84.69, 83.45, 81.65]
2024-05-10 01:23:44,878 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76, 97.43, 97.42, 97.0, 96.37, 96.18]

Average Accuracy (CNN): 81.36
Average Accuracy (NME): 89.84
2024-05-10 01:23:44,878 [trainer.py] => Average Accuracy (CNN): 81.36
2024-05-10 01:23:44,878 [trainer.py] => Average Accuracy (NME): 89.84
2024-05-10 01:23:44,878 [trainer.py] => Train Time: 0
2024-05-10 01:23:44,878 [trainer.py] => Test Time: 354.98 

2024-05-10 01:23:44,879 [trainer.py] => All params: 85860176
2024-05-10 01:23:44,879 [trainer.py] => Trainable params: 85860176
2024-05-10 01:23:44,880 [icarl.py] => Learning on 80-85
  0%|          | 0/20 [00:00<?, ?it/s]Task 16, Epoch 1/20 => Loss 2.946, Train_accy 83.71, Test_accy 68.51:   0%|          | 0/20 [00:58<?, ?it/s]Task 16, Epoch 1/20 => Loss 2.946, Train_accy 83.71, Test_accy 68.51:   5%|▌         | 1/20 [00:58<18:36, 58.78s/it]Task 16, Epoch 2/20 => Loss 2.179, Train_accy 94.17:   5%|▌         | 1/20 [01:35<18:36, 58.78s/it]                 Task 16, Epoch 2/20 => Loss 2.179, Train_accy 94.17:  10%|█         | 2/20 [01:35<13:48, 46.02s/it]Task 16, Epoch 3/20 => Loss 2.191, Train_accy 93.95:  10%|█         | 2/20 [02:12<13:48, 46.02s/it]Task 16, Epoch 3/20 => Loss 2.191, Train_accy 93.95:  15%|█▌        | 3/20 [02:12<11:51, 41.88s/it]Task 16, Epoch 4/20 => Loss 2.153, Train_accy 94.56:  15%|█▌        | 3/20 [02:49<11:51, 41.88s/it]Task 16, Epoch 4/20 => Loss 2.153, Train_accy 94.56:  20%|██        | 4/20 [02:49<10:39, 39.96s/it]Task 16, Epoch 5/20 => Loss 2.195, Train_accy 93.83:  20%|██        | 4/20 [03:26<10:39, 39.96s/it]Task 16, Epoch 5/20 => Loss 2.195, Train_accy 93.83:  25%|██▌       | 5/20 [03:26<09:43, 38.92s/it]Task 16, Epoch 6/20 => Loss 2.160, Train_accy 94.83, Test_accy 67.78:  25%|██▌       | 5/20 [04:25<09:43, 38.92s/it]Task 16, Epoch 6/20 => Loss 2.160, Train_accy 94.83, Test_accy 67.78:  30%|███       | 6/20 [04:25<10:39, 45.68s/it]Task 16, Epoch 7/20 => Loss 2.165, Train_accy 94.83:  30%|███       | 6/20 [05:02<10:39, 45.68s/it]                 Task 16, Epoch 7/20 => Loss 2.165, Train_accy 94.83:  35%|███▌      | 7/20 [05:02<09:17, 42.86s/it]Task 16, Epoch 8/20 => Loss 2.131, Train_accy 95.37:  35%|███▌      | 7/20 [05:39<09:17, 42.86s/it]Task 16, Epoch 8/20 => Loss 2.131, Train_accy 95.37:  40%|████      | 8/20 [05:39<08:12, 41.03s/it]Task 16, Epoch 9/20 => Loss 2.128, Train_accy 95.46:  40%|████      | 8/20 [06:16<08:12, 41.03s/it]Task 16, Epoch 9/20 => Loss 2.128, Train_accy 95.46:  45%|████▌     | 9/20 [06:16<07:17, 39.78s/it]Task 16, Epoch 10/20 => Loss 2.135, Train_accy 95.61:  45%|████▌     | 9/20 [06:54<07:17, 39.78s/it]Task 16, Epoch 10/20 => Loss 2.135, Train_accy 95.61:  50%|█████     | 10/20 [06:54<06:29, 38.96s/it]Task 16, Epoch 11/20 => Loss 2.137, Train_accy 95.46, Test_accy 67.19:  50%|█████     | 10/20 [07:52<06:29, 38.96s/it]Task 16, Epoch 11/20 => Loss 2.137, Train_accy 95.46, Test_accy 67.19:  55%|█████▌    | 11/20 [07:52<06:45, 45.06s/it]Task 16, Epoch 12/20 => Loss 2.115, Train_accy 95.68:  55%|█████▌    | 11/20 [08:29<06:45, 45.06s/it]                 Task 16, Epoch 12/20 => Loss 2.115, Train_accy 95.68:  60%|██████    | 12/20 [08:29<05:40, 42.62s/it]Task 16, Epoch 13/20 => Loss 2.114, Train_accy 95.83:  60%|██████    | 12/20 [09:07<05:40, 42.62s/it]Task 16, Epoch 13/20 => Loss 2.114, Train_accy 95.83:  65%|██████▌   | 13/20 [09:07<04:46, 40.94s/it]Task 16, Epoch 14/20 => Loss 2.124, Train_accy 95.78:  65%|██████▌   | 13/20 [09:44<04:46, 40.94s/it]Task 16, Epoch 14/20 => Loss 2.124, Train_accy 95.78:  70%|███████   | 14/20 [09:44<03:58, 39.75s/it]Task 16, Epoch 15/20 => Loss 2.102, Train_accy 96.20:  70%|███████   | 14/20 [10:21<03:58, 39.75s/it]Task 16, Epoch 15/20 => Loss 2.102, Train_accy 96.20:  75%|███████▌  | 15/20 [10:21<03:14, 38.96s/it]Task 16, Epoch 16/20 => Loss 2.115, Train_accy 95.83, Test_accy 67.72:  75%|███████▌  | 15/20 [11:20<03:14, 38.96s/it]Task 16, Epoch 16/20 => Loss 2.115, Train_accy 95.83, Test_accy 67.72:  80%|████████  | 16/20 [11:20<02:59, 44.97s/it]Task 16, Epoch 17/20 => Loss 2.122, Train_accy 95.83:  80%|████████  | 16/20 [11:57<02:59, 44.97s/it]                 Task 16, Epoch 17/20 => Loss 2.122, Train_accy 95.83:  85%|████████▌ | 17/20 [11:57<02:07, 42.60s/it]Task 16, Epoch 18/20 => Loss 2.098, Train_accy 96.10:  85%|████████▌ | 17/20 [12:34<02:07, 42.60s/it]Task 16, Epoch 18/20 => Loss 2.098, Train_accy 96.10:  90%|█████████ | 18/20 [12:34<01:21, 40.97s/it]Task 16, Epoch 19/20 => Loss 2.126, Train_accy 95.76:  90%|█████████ | 18/20 [13:11<01:21, 40.97s/it]Task 16, Epoch 19/20 => Loss 2.126, Train_accy 95.76:  95%|█████████▌| 19/20 [13:11<00:39, 39.81s/it]Task 16, Epoch 20/20 => Loss 2.100, Train_accy 96.05:  95%|█████████▌| 19/20 [13:48<00:39, 39.81s/it]Task 16, Epoch 20/20 => Loss 2.100, Train_accy 96.05: 100%|██████████| 20/20 [13:48<00:00, 39.00s/it]Task 16, Epoch 20/20 => Loss 2.100, Train_accy 96.05: 100%|██████████| 20/20 [13:48<00:00, 41.43s/it]
2024-05-10 01:37:33,501 [icarl.py] => Task 16, Epoch 20/20 => Loss 2.100, Train_accy 96.05
2024-05-10 01:37:33,502 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 01:38:47,281 [icarl.py] => Exemplar size: 1700
2024-05-10 01:38:47,281 [trainer.py] => CNN: {'total': 68.25, '00-04': 71.2, '05-09': 45.4, '10-14': 43.6, '15-19': 54.2, '20-24': 69.4, '25-29': 68.4, '30-34': 70.2, '35-39': 59.0, '40-44': 69.8, '45-49': 57.0, '50-54': 61.6, '55-59': 58.0, '60-64': 65.0, '65-69': 91.4, '70-74': 80.6, '75-79': 97.0, '80-84': 98.4, 'old': 66.36, 'new': 98.4}
2024-05-10 01:38:47,281 [trainer.py] => NME: {'total': 80.73, '00-04': 85.4, '05-09': 70.2, '10-14': 61.0, '15-19': 74.8, '20-24': 88.6, '25-29': 84.6, '30-34': 81.6, '35-39': 77.4, '40-44': 81.0, '45-49': 80.0, '50-54': 78.2, '55-59': 72.2, '60-64': 78.2, '65-69': 93.4, '70-74': 86.0, '75-79': 88.0, '80-84': 91.8, 'old': 80.04, 'new': 91.8}
2024-05-10 01:38:47,282 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44, 75.55, 74.75, 73.89, 72.29, 68.79, 68.25]
2024-05-10 01:38:47,282 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51, 91.55, 91.55, 90.21, 89.96, 88.78, 88.55]
2024-05-10 01:38:47,282 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07, 85.6, 84.85, 84.69, 83.45, 81.65, 80.73]
2024-05-10 01:38:47,282 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76, 97.43, 97.42, 97.0, 96.37, 96.18, 95.86]

Average Accuracy (CNN): 80.59
Average Accuracy (NME): 89.3
2024-05-10 01:38:47,282 [trainer.py] => Average Accuracy (CNN): 80.59
2024-05-10 01:38:47,282 [trainer.py] => Average Accuracy (NME): 89.3
2024-05-10 01:38:47,282 [trainer.py] => Train Time: 0
2024-05-10 01:38:47,282 [trainer.py] => Test Time: 398.82000000000005 

2024-05-10 01:38:47,282 [trainer.py] => All params: 85864021
2024-05-10 01:38:47,283 [trainer.py] => Trainable params: 85864021
2024-05-10 01:38:47,284 [icarl.py] => Learning on 85-90
  0%|          | 0/20 [00:00<?, ?it/s]Task 17, Epoch 1/20 => Loss 3.083, Train_accy 78.93, Test_accy 66.77:   0%|          | 0/20 [01:00<?, ?it/s]Task 17, Epoch 1/20 => Loss 3.083, Train_accy 78.93, Test_accy 66.77:   5%|▌         | 1/20 [01:00<19:15, 60.83s/it]Task 17, Epoch 2/20 => Loss 2.331, Train_accy 90.57:   5%|▌         | 1/20 [01:38<19:15, 60.83s/it]                 Task 17, Epoch 2/20 => Loss 2.331, Train_accy 90.57:  10%|█         | 2/20 [01:38<14:12, 47.39s/it]Task 17, Epoch 3/20 => Loss 2.294, Train_accy 92.00:  10%|█         | 2/20 [02:16<14:12, 47.39s/it]Task 17, Epoch 3/20 => Loss 2.294, Train_accy 92.00:  15%|█▌        | 3/20 [02:16<12:12, 43.07s/it]Task 17, Epoch 4/20 => Loss 2.286, Train_accy 92.21:  15%|█▌        | 3/20 [02:54<12:12, 43.07s/it]Task 17, Epoch 4/20 => Loss 2.286, Train_accy 92.21:  20%|██        | 4/20 [02:54<10:56, 41.01s/it]Task 17, Epoch 5/20 => Loss 2.245, Train_accy 92.79:  20%|██        | 4/20 [03:32<10:56, 41.01s/it]Task 17, Epoch 5/20 => Loss 2.245, Train_accy 92.79:  25%|██▌       | 5/20 [03:32<09:58, 39.89s/it]Task 17, Epoch 6/20 => Loss 2.250, Train_accy 93.17, Test_accy 67.19:  25%|██▌       | 5/20 [04:33<09:58, 39.89s/it]Task 17, Epoch 6/20 => Loss 2.250, Train_accy 93.17, Test_accy 67.19:  30%|███       | 6/20 [04:33<10:59, 47.14s/it]Task 17, Epoch 7/20 => Loss 2.244, Train_accy 93.81:  30%|███       | 6/20 [05:11<10:59, 47.14s/it]                 Task 17, Epoch 7/20 => Loss 2.244, Train_accy 93.81:  35%|███▌      | 7/20 [05:11<09:33, 44.15s/it]Task 17, Epoch 8/20 => Loss 2.206, Train_accy 93.79:  35%|███▌      | 7/20 [05:49<09:33, 44.15s/it]Task 17, Epoch 8/20 => Loss 2.206, Train_accy 93.79:  40%|████      | 8/20 [05:49<08:25, 42.17s/it]Task 17, Epoch 9/20 => Loss 2.244, Train_accy 93.55:  40%|████      | 8/20 [06:27<08:25, 42.17s/it]Task 17, Epoch 9/20 => Loss 2.244, Train_accy 93.55:  45%|████▌     | 9/20 [06:27<07:29, 40.83s/it]Task 17, Epoch 10/20 => Loss 2.193, Train_accy 93.45:  45%|████▌     | 9/20 [07:05<07:29, 40.83s/it]Task 17, Epoch 10/20 => Loss 2.193, Train_accy 93.45:  50%|█████     | 10/20 [07:05<06:39, 39.93s/it]Task 17, Epoch 11/20 => Loss 2.197, Train_accy 93.74, Test_accy 67.39:  50%|█████     | 10/20 [08:06<06:39, 39.93s/it]Task 17, Epoch 11/20 => Loss 2.197, Train_accy 93.74, Test_accy 67.39:  55%|█████▌    | 11/20 [08:06<06:57, 46.35s/it]Task 17, Epoch 12/20 => Loss 2.220, Train_accy 93.95:  55%|█████▌    | 11/20 [08:44<06:57, 46.35s/it]                 Task 17, Epoch 12/20 => Loss 2.220, Train_accy 93.95:  60%|██████    | 12/20 [08:44<05:50, 43.77s/it]Task 17, Epoch 13/20 => Loss 2.185, Train_accy 94.79:  60%|██████    | 12/20 [09:22<05:50, 43.77s/it]Task 17, Epoch 13/20 => Loss 2.185, Train_accy 94.79:  65%|██████▌   | 13/20 [09:22<04:54, 42.01s/it]Task 17, Epoch 14/20 => Loss 2.206, Train_accy 94.21:  65%|██████▌   | 13/20 [10:00<04:54, 42.01s/it]Task 17, Epoch 14/20 => Loss 2.206, Train_accy 94.21:  70%|███████   | 14/20 [10:00<04:04, 40.78s/it]Task 17, Epoch 15/20 => Loss 2.193, Train_accy 93.90:  70%|███████   | 14/20 [10:38<04:04, 40.78s/it]Task 17, Epoch 15/20 => Loss 2.193, Train_accy 93.90:  75%|███████▌  | 15/20 [10:38<03:19, 39.92s/it]Task 17, Epoch 16/20 => Loss 2.217, Train_accy 94.17, Test_accy 65.39:  75%|███████▌  | 15/20 [11:39<03:19, 39.92s/it]Task 17, Epoch 16/20 => Loss 2.217, Train_accy 94.17, Test_accy 65.39:  80%|████████  | 16/20 [11:39<03:05, 46.26s/it]Task 17, Epoch 17/20 => Loss 2.204, Train_accy 94.52:  80%|████████  | 16/20 [12:16<03:05, 46.26s/it]                 Task 17, Epoch 17/20 => Loss 2.204, Train_accy 94.52:  85%|████████▌ | 17/20 [12:16<02:11, 43.76s/it]Task 17, Epoch 18/20 => Loss 2.204, Train_accy 94.07:  85%|████████▌ | 17/20 [12:54<02:11, 43.76s/it]Task 17, Epoch 18/20 => Loss 2.204, Train_accy 94.07:  90%|█████████ | 18/20 [12:54<01:24, 42.02s/it]Task 17, Epoch 19/20 => Loss 2.178, Train_accy 94.29:  90%|█████████ | 18/20 [13:32<01:24, 42.02s/it]Task 17, Epoch 19/20 => Loss 2.178, Train_accy 94.29:  95%|█████████▌| 19/20 [13:32<00:40, 40.78s/it]Task 17, Epoch 20/20 => Loss 2.215, Train_accy 94.17:  95%|█████████▌| 19/20 [14:10<00:40, 40.78s/it]Task 17, Epoch 20/20 => Loss 2.215, Train_accy 94.17: 100%|██████████| 20/20 [14:10<00:00, 39.94s/it]Task 17, Epoch 20/20 => Loss 2.215, Train_accy 94.17: 100%|██████████| 20/20 [14:10<00:00, 42.54s/it]
2024-05-10 01:52:58,165 [icarl.py] => Task 17, Epoch 20/20 => Loss 2.215, Train_accy 94.17
2024-05-10 01:52:58,167 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 01:54:14,550 [icarl.py] => Exemplar size: 1800
2024-05-10 01:54:14,550 [trainer.py] => CNN: {'total': 66.84, '00-04': 69.8, '05-09': 42.6, '10-14': 40.2, '15-19': 50.8, '20-24': 65.0, '25-29': 68.8, '30-34': 71.0, '35-39': 57.4, '40-44': 61.2, '45-49': 62.2, '50-54': 60.8, '55-59': 54.2, '60-64': 64.4, '65-69': 88.2, '70-74': 72.4, '75-79': 83.0, '80-84': 96.4, '85-89': 94.8, 'old': 65.2, 'new': 94.8}
2024-05-10 01:54:14,550 [trainer.py] => NME: {'total': 79.01, '00-04': 81.6, '05-09': 63.2, '10-14': 56.6, '15-19': 72.4, '20-24': 85.2, '25-29': 83.8, '30-34': 80.6, '35-39': 74.6, '40-44': 79.2, '45-49': 79.0, '50-54': 77.6, '55-59': 71.0, '60-64': 75.0, '65-69': 92.4, '70-74': 83.4, '75-79': 83.6, '80-84': 91.6, '85-89': 91.4, 'old': 78.28, 'new': 91.4}
2024-05-10 01:54:14,550 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44, 75.55, 74.75, 73.89, 72.29, 68.79, 68.25, 66.84]
2024-05-10 01:54:14,550 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51, 91.55, 91.55, 90.21, 89.96, 88.78, 88.55, 86.94]
2024-05-10 01:54:14,550 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07, 85.6, 84.85, 84.69, 83.45, 81.65, 80.73, 79.01]
2024-05-10 01:54:14,550 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76, 97.43, 97.42, 97.0, 96.37, 96.18, 95.86, 95.04]

Average Accuracy (CNN): 79.82
Average Accuracy (NME): 88.73
2024-05-10 01:54:14,550 [trainer.py] => Average Accuracy (CNN): 79.82
2024-05-10 01:54:14,550 [trainer.py] => Average Accuracy (NME): 88.73
2024-05-10 01:54:14,550 [trainer.py] => Train Time: 0
2024-05-10 01:54:14,550 [trainer.py] => Test Time: 444.83000000000004 

2024-05-10 01:54:14,551 [trainer.py] => All params: 85867866
2024-05-10 01:54:14,551 [trainer.py] => Trainable params: 85867866
2024-05-10 01:54:14,553 [icarl.py] => Learning on 90-95
  0%|          | 0/20 [00:00<?, ?it/s]Task 18, Epoch 1/20 => Loss 2.991, Train_accy 83.70, Test_accy 66.88:   0%|          | 0/20 [01:03<?, ?it/s]Task 18, Epoch 1/20 => Loss 2.991, Train_accy 83.70, Test_accy 66.88:   5%|▌         | 1/20 [01:03<20:05, 63.43s/it]Task 18, Epoch 2/20 => Loss 2.295, Train_accy 91.67:   5%|▌         | 1/20 [01:42<20:05, 63.43s/it]                 Task 18, Epoch 2/20 => Loss 2.295, Train_accy 91.67:  10%|█         | 2/20 [01:42<14:40, 48.91s/it]Task 18, Epoch 3/20 => Loss 2.244, Train_accy 92.93:  10%|█         | 2/20 [02:21<14:40, 48.91s/it]Task 18, Epoch 3/20 => Loss 2.244, Train_accy 92.93:  15%|█▌        | 3/20 [02:21<12:35, 44.43s/it]Task 18, Epoch 4/20 => Loss 2.212, Train_accy 93.95:  15%|█▌        | 3/20 [03:00<12:35, 44.43s/it]Task 18, Epoch 4/20 => Loss 2.212, Train_accy 93.95:  20%|██        | 4/20 [03:00<11:15, 42.22s/it]Task 18, Epoch 5/20 => Loss 2.182, Train_accy 94.44:  20%|██        | 4/20 [03:38<11:15, 42.22s/it]Task 18, Epoch 5/20 => Loss 2.182, Train_accy 94.44:  25%|██▌       | 5/20 [03:38<10:14, 40.98s/it]Task 18, Epoch 6/20 => Loss 2.184, Train_accy 94.58, Test_accy 65.67:  25%|██▌       | 5/20 [04:42<10:14, 40.98s/it]Task 18, Epoch 6/20 => Loss 2.184, Train_accy 94.58, Test_accy 65.67:  30%|███       | 6/20 [04:42<11:21, 48.65s/it]Task 18, Epoch 7/20 => Loss 2.182, Train_accy 94.88:  30%|███       | 6/20 [05:21<11:21, 48.65s/it]                 Task 18, Epoch 7/20 => Loss 2.182, Train_accy 94.88:  35%|███▌      | 7/20 [05:21<09:50, 45.45s/it]Task 18, Epoch 8/20 => Loss 2.166, Train_accy 95.21:  35%|███▌      | 7/20 [06:00<09:50, 45.45s/it]Task 18, Epoch 8/20 => Loss 2.166, Train_accy 95.21:  40%|████      | 8/20 [06:00<08:39, 43.33s/it]Task 18, Epoch 9/20 => Loss 2.170, Train_accy 94.77:  40%|████      | 8/20 [06:38<08:39, 43.33s/it]Task 18, Epoch 9/20 => Loss 2.170, Train_accy 94.77:  45%|████▌     | 9/20 [06:38<07:41, 41.94s/it]Task 18, Epoch 10/20 => Loss 2.158, Train_accy 95.33:  45%|████▌     | 9/20 [07:17<07:41, 41.94s/it]Task 18, Epoch 10/20 => Loss 2.158, Train_accy 95.33:  50%|█████     | 10/20 [07:17<06:50, 41.01s/it]Task 18, Epoch 11/20 => Loss 2.158, Train_accy 95.19, Test_accy 65.99:  50%|█████     | 10/20 [08:21<06:50, 41.01s/it]Task 18, Epoch 11/20 => Loss 2.158, Train_accy 95.19, Test_accy 65.99:  55%|█████▌    | 11/20 [08:21<07:10, 47.79s/it]Task 18, Epoch 12/20 => Loss 2.153, Train_accy 95.21:  55%|█████▌    | 11/20 [08:59<07:10, 47.79s/it]                 Task 18, Epoch 12/20 => Loss 2.153, Train_accy 95.21:  60%|██████    | 12/20 [08:59<06:00, 45.05s/it]Task 18, Epoch 13/20 => Loss 2.148, Train_accy 95.37:  60%|██████    | 12/20 [09:38<06:00, 45.05s/it]Task 18, Epoch 13/20 => Loss 2.148, Train_accy 95.37:  65%|██████▌   | 13/20 [09:38<05:02, 43.22s/it]Task 18, Epoch 14/20 => Loss 2.185, Train_accy 95.26:  65%|██████▌   | 13/20 [10:17<05:02, 43.22s/it]Task 18, Epoch 14/20 => Loss 2.185, Train_accy 95.26:  70%|███████   | 14/20 [10:17<04:11, 41.85s/it]Task 18, Epoch 15/20 => Loss 2.127, Train_accy 95.70:  70%|███████   | 14/20 [10:56<04:11, 41.85s/it]Task 18, Epoch 15/20 => Loss 2.127, Train_accy 95.70:  75%|███████▌  | 15/20 [10:56<03:24, 40.94s/it]Task 18, Epoch 16/20 => Loss 2.128, Train_accy 95.53, Test_accy 68.13:  75%|███████▌  | 15/20 [11:59<03:24, 40.94s/it]Task 18, Epoch 16/20 => Loss 2.128, Train_accy 95.53, Test_accy 68.13:  80%|████████  | 16/20 [11:59<03:10, 47.61s/it]Task 18, Epoch 17/20 => Loss 2.129, Train_accy 95.65:  80%|████████  | 16/20 [12:38<03:10, 47.61s/it]                 Task 18, Epoch 17/20 => Loss 2.129, Train_accy 95.65:  85%|████████▌ | 17/20 [12:38<02:14, 44.95s/it]Task 18, Epoch 18/20 => Loss 2.120, Train_accy 95.21:  85%|████████▌ | 17/20 [13:16<02:14, 44.95s/it]Task 18, Epoch 18/20 => Loss 2.120, Train_accy 95.21:  90%|█████████ | 18/20 [13:16<01:26, 43.06s/it]Task 18, Epoch 19/20 => Loss 2.157, Train_accy 95.30:  90%|█████████ | 18/20 [13:55<01:26, 43.06s/it]Task 18, Epoch 19/20 => Loss 2.157, Train_accy 95.30:  95%|█████████▌| 19/20 [13:55<00:41, 41.74s/it]Task 18, Epoch 20/20 => Loss 2.085, Train_accy 96.12:  95%|█████████▌| 19/20 [14:34<00:41, 41.74s/it]Task 18, Epoch 20/20 => Loss 2.085, Train_accy 96.12: 100%|██████████| 20/20 [14:34<00:00, 40.85s/it]Task 18, Epoch 20/20 => Loss 2.085, Train_accy 96.12: 100%|██████████| 20/20 [14:34<00:00, 43.72s/it]
2024-05-10 02:08:48,924 [icarl.py] => Task 18, Epoch 20/20 => Loss 2.085, Train_accy 96.12
2024-05-10 02:08:48,926 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 02:10:09,511 [icarl.py] => Exemplar size: 1900
2024-05-10 02:10:09,512 [trainer.py] => CNN: {'total': 65.53, '00-04': 62.8, '05-09': 46.2, '10-14': 36.4, '15-19': 46.2, '20-24': 61.2, '25-29': 68.8, '30-34': 65.8, '35-39': 58.0, '40-44': 53.6, '45-49': 59.6, '50-54': 58.2, '55-59': 54.4, '60-64': 62.6, '65-69': 88.4, '70-74': 69.6, '75-79': 73.4, '80-84': 93.6, '85-89': 87.6, '90-94': 98.6, 'old': 63.69, 'new': 98.6}
2024-05-10 02:10:09,512 [trainer.py] => NME: {'total': 78.57, '00-04': 77.8, '05-09': 65.0, '10-14': 56.0, '15-19': 72.8, '20-24': 83.4, '25-29': 82.8, '30-34': 79.0, '35-39': 75.6, '40-44': 76.0, '45-49': 78.4, '50-54': 74.8, '55-59': 70.6, '60-64': 75.6, '65-69': 93.2, '70-74': 82.0, '75-79': 78.8, '80-84': 90.4, '85-89': 88.0, '90-94': 92.6, 'old': 77.79, 'new': 92.6}
2024-05-10 02:10:09,512 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44, 75.55, 74.75, 73.89, 72.29, 68.79, 68.25, 66.84, 65.53]
2024-05-10 02:10:09,512 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51, 91.55, 91.55, 90.21, 89.96, 88.78, 88.55, 86.94, 85.84]
2024-05-10 02:10:09,512 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07, 85.6, 84.85, 84.69, 83.45, 81.65, 80.73, 79.01, 78.57]
2024-05-10 02:10:09,512 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76, 97.43, 97.42, 97.0, 96.37, 96.18, 95.86, 95.04, 94.6]

Average Accuracy (CNN): 79.07
Average Accuracy (NME): 88.19
2024-05-10 02:10:09,512 [trainer.py] => Average Accuracy (CNN): 79.07
2024-05-10 02:10:09,512 [trainer.py] => Average Accuracy (NME): 88.19
2024-05-10 02:10:09,512 [trainer.py] => Train Time: 0
2024-05-10 02:10:09,512 [trainer.py] => Test Time: 493.48 

2024-05-10 02:10:09,513 [trainer.py] => All params: 85871711
2024-05-10 02:10:09,513 [trainer.py] => Trainable params: 85871711
2024-05-10 02:10:09,514 [icarl.py] => Learning on 95-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 19, Epoch 1/20 => Loss 3.042, Train_accy 80.66, Test_accy 62.65:   0%|          | 0/20 [01:04<?, ?it/s]Task 19, Epoch 1/20 => Loss 3.042, Train_accy 80.66, Test_accy 62.65:   5%|▌         | 1/20 [01:04<20:34, 64.95s/it]Task 19, Epoch 2/20 => Loss 2.245, Train_accy 91.43:   5%|▌         | 1/20 [01:44<20:34, 64.95s/it]                 Task 19, Epoch 2/20 => Loss 2.245, Train_accy 91.43:  10%|█         | 2/20 [01:44<14:59, 49.96s/it]Task 19, Epoch 3/20 => Loss 2.194, Train_accy 93.14:  10%|█         | 2/20 [02:23<14:59, 49.96s/it]Task 19, Epoch 3/20 => Loss 2.194, Train_accy 93.14:  15%|█▌        | 3/20 [02:23<12:48, 45.21s/it]Task 19, Epoch 4/20 => Loss 2.226, Train_accy 92.75:  15%|█▌        | 3/20 [03:03<12:48, 45.21s/it]Task 19, Epoch 4/20 => Loss 2.226, Train_accy 92.75:  20%|██        | 4/20 [03:03<11:28, 43.01s/it]Task 19, Epoch 5/20 => Loss 2.167, Train_accy 93.55:  20%|██        | 4/20 [03:43<11:28, 43.01s/it]Task 19, Epoch 5/20 => Loss 2.167, Train_accy 93.55:  25%|██▌       | 5/20 [03:43<10:26, 41.75s/it]Task 19, Epoch 6/20 => Loss 2.175, Train_accy 93.68, Test_accy 62.80:  25%|██▌       | 5/20 [04:48<10:26, 41.75s/it]Task 19, Epoch 6/20 => Loss 2.175, Train_accy 93.68, Test_accy 62.80:  30%|███       | 6/20 [04:48<11:34, 49.62s/it]Task 19, Epoch 7/20 => Loss 2.203, Train_accy 93.61:  30%|███       | 6/20 [05:27<11:34, 49.62s/it]                 Task 19, Epoch 7/20 => Loss 2.203, Train_accy 93.61:  35%|███▌      | 7/20 [05:27<10:02, 46.34s/it]Task 19, Epoch 8/20 => Loss 2.172, Train_accy 94.07:  35%|███▌      | 7/20 [06:07<10:02, 46.34s/it]Task 19, Epoch 8/20 => Loss 2.172, Train_accy 94.07:  40%|████      | 8/20 [06:07<08:50, 44.19s/it]Task 19, Epoch 9/20 => Loss 2.183, Train_accy 93.70:  40%|████      | 8/20 [06:46<08:50, 44.19s/it]Task 19, Epoch 9/20 => Loss 2.183, Train_accy 93.70:  45%|████▌     | 9/20 [06:46<07:49, 42.72s/it]Task 19, Epoch 10/20 => Loss 2.115, Train_accy 95.05:  45%|████▌     | 9/20 [07:26<07:49, 42.72s/it]Task 19, Epoch 10/20 => Loss 2.115, Train_accy 95.05:  50%|█████     | 10/20 [07:26<06:57, 41.77s/it]Task 19, Epoch 11/20 => Loss 2.135, Train_accy 95.07, Test_accy 62.48:  50%|█████     | 10/20 [08:31<06:57, 41.77s/it]Task 19, Epoch 11/20 => Loss 2.135, Train_accy 95.07, Test_accy 62.48:  55%|█████▌    | 11/20 [08:31<07:20, 48.90s/it]Task 19, Epoch 12/20 => Loss 2.128, Train_accy 94.84:  55%|█████▌    | 11/20 [09:11<07:20, 48.90s/it]                 Task 19, Epoch 12/20 => Loss 2.128, Train_accy 94.84:  60%|██████    | 12/20 [09:11<06:08, 46.08s/it]Task 19, Epoch 13/20 => Loss 2.129, Train_accy 94.36:  60%|██████    | 12/20 [09:50<06:08, 46.08s/it]Task 19, Epoch 13/20 => Loss 2.129, Train_accy 94.36:  65%|██████▌   | 13/20 [09:50<05:09, 44.16s/it]Task 19, Epoch 14/20 => Loss 2.135, Train_accy 94.70:  65%|██████▌   | 13/20 [10:30<05:09, 44.16s/it]Task 19, Epoch 14/20 => Loss 2.135, Train_accy 94.70:  70%|███████   | 14/20 [10:30<04:16, 42.79s/it]Task 19, Epoch 15/20 => Loss 2.141, Train_accy 95.00:  70%|███████   | 14/20 [11:10<04:16, 42.79s/it]Task 19, Epoch 15/20 => Loss 2.141, Train_accy 95.00:  75%|███████▌  | 15/20 [11:10<03:29, 41.86s/it]Task 19, Epoch 16/20 => Loss 2.158, Train_accy 95.05, Test_accy 66.27:  75%|███████▌  | 15/20 [12:15<03:29, 41.86s/it]Task 19, Epoch 16/20 => Loss 2.158, Train_accy 95.05, Test_accy 66.27:  80%|████████  | 16/20 [12:15<03:15, 48.86s/it]Task 19, Epoch 17/20 => Loss 2.100, Train_accy 95.70:  80%|████████  | 16/20 [12:54<03:15, 48.86s/it]                 Task 19, Epoch 17/20 => Loss 2.100, Train_accy 95.70:  85%|████████▌ | 17/20 [12:54<02:18, 46.08s/it]Task 19, Epoch 18/20 => Loss 2.095, Train_accy 95.61:  85%|████████▌ | 17/20 [13:34<02:18, 46.08s/it]Task 19, Epoch 18/20 => Loss 2.095, Train_accy 95.61:  90%|█████████ | 18/20 [13:34<01:28, 44.15s/it]Task 19, Epoch 19/20 => Loss 2.118, Train_accy 95.18:  90%|█████████ | 18/20 [14:14<01:28, 44.15s/it]Task 19, Epoch 19/20 => Loss 2.118, Train_accy 95.18:  95%|█████████▌| 19/20 [14:14<00:42, 42.81s/it]Task 19, Epoch 20/20 => Loss 2.093, Train_accy 95.57:  95%|█████████▌| 19/20 [14:53<00:42, 42.81s/it]Task 19, Epoch 20/20 => Loss 2.093, Train_accy 95.57: 100%|██████████| 20/20 [14:53<00:00, 41.87s/it]Task 19, Epoch 20/20 => Loss 2.093, Train_accy 95.57: 100%|██████████| 20/20 [14:53<00:00, 44.69s/it]
2024-05-10 02:25:03,420 [icarl.py] => Task 19, Epoch 20/20 => Loss 2.093, Train_accy 95.57
2024-05-10 02:25:03,422 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-05-10 02:26:27,354 [icarl.py] => Exemplar size: 2000
2024-05-10 02:26:27,354 [trainer.py] => CNN: {'total': 62.7, '00-04': 59.0, '05-09': 46.4, '10-14': 33.8, '15-19': 44.0, '20-24': 64.0, '25-29': 59.2, '30-34': 60.0, '35-39': 52.2, '40-44': 51.8, '45-49': 51.4, '50-54': 52.2, '55-59': 48.6, '60-64': 66.2, '65-69': 77.4, '70-74': 64.4, '75-79': 72.0, '80-84': 89.0, '85-89': 78.6, '90-94': 86.6, '95-99': 97.2, 'old': 60.88, 'new': 97.2}
2024-05-10 02:26:27,354 [trainer.py] => NME: {'total': 77.56, '00-04': 76.0, '05-09': 62.4, '10-14': 55.2, '15-19': 72.6, '20-24': 82.6, '25-29': 77.8, '30-34': 78.2, '35-39': 72.8, '40-44': 75.0, '45-49': 77.0, '50-54': 70.0, '55-59': 69.6, '60-64': 74.6, '65-69': 91.4, '70-74': 80.6, '75-79': 78.2, '80-84': 90.4, '85-89': 85.8, '90-94': 89.2, '95-99': 91.8, 'old': 76.81, 'new': 91.8}
2024-05-10 02:26:27,354 [trainer.py] => CNN top1 curve: [99.8, 97.0, 93.0, 91.0, 88.48, 83.97, 81.2, 78.08, 74.2, 75.32, 74.44, 75.55, 74.75, 73.89, 72.29, 68.79, 68.25, 66.84, 65.53, 62.7]
2024-05-10 02:26:27,355 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.33, 98.5, 97.96, 96.87, 95.66, 93.7, 92.38, 92.46, 92.51, 91.55, 91.55, 90.21, 89.96, 88.78, 88.55, 86.94, 85.84, 83.88]
2024-05-10 02:26:27,355 [trainer.py] => NME top1 curve: [100.0, 98.8, 96.93, 95.4, 93.96, 92.43, 91.09, 89.6, 87.91, 85.96, 85.07, 85.6, 84.85, 84.69, 83.45, 81.65, 80.73, 79.01, 78.57, 77.56]
2024-05-10 02:26:27,355 [trainer.py] => NME top5 curve: [100.0, 100.0, 99.87, 99.45, 99.36, 99.13, 98.94, 98.4, 98.18, 97.88, 97.76, 97.43, 97.42, 97.0, 96.37, 96.18, 95.86, 95.04, 94.6, 93.46]

Average Accuracy (CNN): 78.25
Average Accuracy (NME): 87.66
2024-05-10 02:26:27,355 [trainer.py] => Average Accuracy (CNN): 78.25
2024-05-10 02:26:27,355 [trainer.py] => Average Accuracy (NME): 87.66
2024-05-10 02:26:27,355 [trainer.py] => Train Time: 0
2024-05-10 02:26:27,355 [trainer.py] => Test Time: 544.46 

Accuracy Matrix (CNN):
[[99.8 95.6 94.4 93.8 91.6 89.6 85.6 76.8 70.  76.8 70.  73.6 77.2 70.8
  67.6 63.4 71.2 69.8 62.8 59. ]
 [ 0.  98.4 85.4 80.8 76.  62.  52.6 49.8 50.  49.8 51.2 51.8 54.6 53.8
  51.8 46.6 45.4 42.6 46.2 46.4]
 [ 0.   0.  99.2 91.2 79.4 71.2 70.8 64.6 48.2 47.6 49.4 50.2 48.8 46.6
  47.8 48.6 43.6 40.2 36.4 33.8]
 [ 0.   0.   0.  98.2 95.8 86.4 80.8 71.4 63.6 65.4 67.4 60.8 60.  52.2
  54.4 57.4 54.2 50.8 46.2 44. ]
 [ 0.   0.   0.   0.  99.6 95.2 86.2 85.2 76.8 74.2 75.2 75.  76.  79.4
  77.4 74.6 69.4 65.  61.2 64. ]
 [ 0.   0.   0.   0.   0.  99.4 96.2 86.  84.2 82.6 78.4 75.8 80.  76.
  78.8 76.8 68.4 68.8 68.8 59.2]
 [ 0.   0.   0.   0.   0.   0.  96.2 91.4 84.6 82.8 77.8 77.  74.6 74.6
  74.4 75.  70.2 71.  65.8 60. ]
 [ 0.   0.   0.   0.   0.   0.   0.  99.4 91.2 79.6 78.4 77.  70.2 67.6
  62.4 57.8 59.  57.4 58.  52.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  99.2 95.8 86.  86.  83.2 80.4
  75.  72.6 69.8 61.2 53.6 51.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  98.6 86.2 86.  81.6 80.6
  81.4 58.8 57.  62.2 59.6 51.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  98.8 97.4 94.2 90.4
  85.  62.4 61.6 60.8 58.2 52.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  96.  72.2 70.8
  60.  58.8 58.  54.2 54.4 48.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  99.2 91.4
  74.2 72.6 65.  64.4 62.6 66.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  99.8
  94.6 93.6 91.4 88.2 88.4 77.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  99.6 82.2 80.6 72.4 69.6 64.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  99.4 97.  83.  73.4 72. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  98.4 96.4 93.6 89. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  94.8 87.6 78.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  98.6 86.6]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  97.2]]
2024-05-10 02:26:27,358 [trainer.py] => Forgetting (CNN): 37.67368421052632
Accuracy Matrix (NME):
[[100.   99.8  99.   98.   97.   97.2  96.   93.6  92.6  93.   89.   89.6
   90.4  86.   84.   83.4  85.4  81.6  77.8  76. ]
 [  0.   97.8  94.8  92.   89.4  83.8  79.   78.   77.2  70.8  72.4  73.4
   75.   72.8  71.4  71.8  70.2  63.2  65.   62.4]
 [  0.    0.   97.   95.4  89.   85.6  86.2  83.6  75.2  73.   71.6  72.2
   69.6  66.4  66.8  65.2  61.   56.6  56.   55.2]
 [  0.    0.    0.   96.2  95.4  92.   88.6  83.6  80.8  80.6  81.4  79.2
   79.2  78.4  77.2  75.   74.8  72.4  72.8  72.6]
 [  0.    0.    0.    0.   99.   98.2  96.2  96.2  94.2  91.   90.4  91.8
   91.   91.6  92.   91.8  88.6  85.2  83.4  82.6]
 [  0.    0.    0.    0.    0.   97.8  97.2  94.2  91.8  88.2  87.2  86.
   86.8  86.2  87.   87.8  84.6  83.8  82.8  77.8]
 [  0.    0.    0.    0.    0.    0.   94.4  92.4  89.8  88.   86.4  85.6
   83.8  83.6  84.4  82.   81.6  80.6  79.   78.2]
 [  0.    0.    0.    0.    0.    0.    0.   95.2  93.8  84.   82.8  83.4
   80.6  80.2  79.   77.2  77.4  74.6  75.6  72.8]
 [  0.    0.    0.    0.    0.    0.    0.    0.   95.8  95.4  89.4  89.
   86.8  87.4  83.8  83.6  81.   79.2  76.   75. ]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.   95.6  92.6  92.8
   92.4  92.   89.2  83.   80.   79.   78.4  77. ]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   92.6  91.6
   91.2  89.2  88.6  78.6  78.2  77.6  74.8  70. ]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   92.6
   82.6  84.   77.4  74.6  72.2  71.   70.6  69.6]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
   93.6  91.   80.2  81.6  78.2  75.   75.6  74.6]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
    0.   96.8  95.6  94.   93.4  92.4  93.2  91.4]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
    0.    0.   95.2  87.6  86.   83.4  82.   80.6]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
    0.    0.    0.   89.2  88.   83.6  78.8  78.2]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
    0.    0.    0.    0.   91.8  91.6  90.4  90.4]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
    0.    0.    0.    0.    0.   91.4  88.   85.8]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
    0.    0.    0.    0.    0.    0.   92.6  89.2]
 [  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
    0.    0.    0.    0.    0.    0.    0.   91.8]]
2024-05-10 02:26:27,360 [trainer.py] => Forgetting (NME): 18.16842105263158
2024-05-10 02:26:30,262 [trainer.py] => config: ./exps/der_vtab_B0_Inc10.json
2024-05-10 02:26:30,262 [trainer.py] => prefix: reproduce
2024-05-10 02:26:30,262 [trainer.py] => dataset: vtab
2024-05-10 02:26:30,262 [trainer.py] => memory_size: 1000
2024-05-10 02:26:30,262 [trainer.py] => memory_per_class: 20
2024-05-10 02:26:30,262 [trainer.py] => fixed_memory: True
2024-05-10 02:26:30,262 [trainer.py] => shuffle: True
2024-05-10 02:26:30,262 [trainer.py] => init_cls: 5
2024-05-10 02:26:30,262 [trainer.py] => increment: 5
2024-05-10 02:26:30,262 [trainer.py] => model_name: der
2024-05-10 02:26:30,262 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-05-10 02:26:30,262 [trainer.py] => device: [device(type='cuda', index=4)]
2024-05-10 02:26:30,262 [trainer.py] => seed: 1993
2024-05-10 02:26:30,262 [trainer.py] => init_epoch: 20
2024-05-10 02:26:30,262 [trainer.py] => init_lr: 0.001
2024-05-10 02:26:30,262 [trainer.py] => init_milestones: [60, 120, 170]
2024-05-10 02:26:30,262 [trainer.py] => init_lr_decay: 0.1
2024-05-10 02:26:30,262 [trainer.py] => init_weight_decay: 0.0005
2024-05-10 02:26:30,262 [trainer.py] => epochs: 20
2024-05-10 02:26:30,262 [trainer.py] => lrate: 0.001
2024-05-10 02:26:30,263 [trainer.py] => milestones: [80, 120, 150]
2024-05-10 02:26:30,263 [trainer.py] => lrate_decay: 0.1
2024-05-10 02:26:30,263 [trainer.py] => batch_size: 48
2024-05-10 02:26:30,263 [trainer.py] => weight_decay: 0.0002
2024-05-10 02:26:30,263 [trainer.py] => T: 2
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-05-10 02:26:30,305 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-05-10 02:26:30,610 [trainer.py] => All params: 0
2024-05-10 02:26:30,610 [trainer.py] => Trainable params: 0
2024-05-10 02:26:32,594 [der.py] => Learning on 0-5
2024-05-10 02:26:32,595 [der.py] => All params: 85807115
2024-05-10 02:26:32,595 [der.py] => Trainable params: 85807115
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.720, Train_accy 25.27, Test_accy 52.45:   0%|          | 0/20 [00:02<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.720, Train_accy 25.27, Test_accy 52.45:   5%|▌         | 1/20 [00:02<00:51,  2.69s/it]Task 0, Epoch 2/20 => Loss 1.151, Train_accy 59.34:   5%|▌         | 1/20 [00:03<00:51,  2.69s/it]                 Task 0, Epoch 2/20 => Loss 1.151, Train_accy 59.34:  10%|█         | 2/20 [00:03<00:30,  1.69s/it]Task 0, Epoch 3/20 => Loss 0.516, Train_accy 83.52:  10%|█         | 2/20 [00:04<00:30,  1.69s/it]Task 0, Epoch 3/20 => Loss 0.516, Train_accy 83.52:  15%|█▌        | 3/20 [00:04<00:22,  1.34s/it]Task 0, Epoch 4/20 => Loss 0.800, Train_accy 72.53:  15%|█▌        | 3/20 [00:05<00:22,  1.34s/it]Task 0, Epoch 4/20 => Loss 0.800, Train_accy 72.53:  20%|██        | 4/20 [00:05<00:18,  1.18s/it]Task 0, Epoch 5/20 => Loss 3.429, Train_accy 50.55:  20%|██        | 4/20 [00:06<00:18,  1.18s/it]Task 0, Epoch 5/20 => Loss 3.429, Train_accy 50.55:  25%|██▌       | 5/20 [00:06<00:16,  1.13s/it]Task 0, Epoch 6/20 => Loss 10.163, Train_accy 20.88, Test_accy 22.73:  25%|██▌       | 5/20 [00:08<00:16,  1.13s/it]Task 0, Epoch 6/20 => Loss 10.163, Train_accy 20.88, Test_accy 22.73:  30%|███       | 6/20 [00:08<00:21,  1.56s/it]Task 0, Epoch 7/20 => Loss 6.990, Train_accy 19.78:  30%|███       | 6/20 [00:09<00:21,  1.56s/it]                  Task 0, Epoch 7/20 => Loss 6.990, Train_accy 19.78:  35%|███▌      | 7/20 [00:09<00:17,  1.36s/it]Task 0, Epoch 8/20 => Loss 10.083, Train_accy 14.29:  35%|███▌      | 7/20 [00:10<00:17,  1.36s/it]Task 0, Epoch 8/20 => Loss 10.083, Train_accy 14.29:  40%|████      | 8/20 [00:10<00:14,  1.21s/it]Task 0, Epoch 9/20 => Loss 9.008, Train_accy 27.47:  40%|████      | 8/20 [00:11<00:14,  1.21s/it] Task 0, Epoch 9/20 => Loss 9.008, Train_accy 27.47:  45%|████▌     | 9/20 [00:11<00:12,  1.12s/it]Task 0, Epoch 10/20 => Loss 7.917, Train_accy 27.47:  45%|████▌     | 9/20 [00:12<00:12,  1.12s/it]Task 0, Epoch 10/20 => Loss 7.917, Train_accy 27.47:  50%|█████     | 10/20 [00:12<00:10,  1.07s/it]Task 0, Epoch 11/20 => Loss 7.074, Train_accy 23.08, Test_accy 13.29:  50%|█████     | 10/20 [00:14<00:10,  1.07s/it]Task 0, Epoch 11/20 => Loss 7.074, Train_accy 23.08, Test_accy 13.29:  55%|█████▌    | 11/20 [00:14<00:12,  1.41s/it]Task 0, Epoch 12/20 => Loss 3.301, Train_accy 26.37:  55%|█████▌    | 11/20 [00:15<00:12,  1.41s/it]                 Task 0, Epoch 12/20 => Loss 3.301, Train_accy 26.37:  60%|██████    | 12/20 [00:15<00:10,  1.27s/it]Task 0, Epoch 13/20 => Loss 4.242, Train_accy 14.29:  60%|██████    | 12/20 [00:16<00:10,  1.27s/it]Task 0, Epoch 13/20 => Loss 4.242, Train_accy 14.29:  65%|██████▌   | 13/20 [00:16<00:08,  1.17s/it]Task 0, Epoch 14/20 => Loss 3.696, Train_accy 13.19:  65%|██████▌   | 13/20 [00:17<00:08,  1.17s/it]Task 0, Epoch 14/20 => Loss 3.696, Train_accy 13.19:  70%|███████   | 14/20 [00:17<00:06,  1.09s/it]Task 0, Epoch 15/20 => Loss 2.653, Train_accy 24.18:  70%|███████   | 14/20 [00:18<00:06,  1.09s/it]Task 0, Epoch 15/20 => Loss 2.653, Train_accy 24.18:  75%|███████▌  | 15/20 [00:18<00:05,  1.03s/it]Task 0, Epoch 16/20 => Loss 3.306, Train_accy 25.27, Test_accy 34.97:  75%|███████▌  | 15/20 [00:20<00:05,  1.03s/it]Task 0, Epoch 16/20 => Loss 3.306, Train_accy 25.27, Test_accy 34.97:  80%|████████  | 16/20 [00:20<00:05,  1.39s/it]Task 0, Epoch 17/20 => Loss 2.356, Train_accy 40.66:  80%|████████  | 16/20 [00:21<00:05,  1.39s/it]                 Task 0, Epoch 17/20 => Loss 2.356, Train_accy 40.66:  85%|████████▌ | 17/20 [00:21<00:03,  1.26s/it]Task 0, Epoch 18/20 => Loss 2.202, Train_accy 26.37:  85%|████████▌ | 17/20 [00:22<00:03,  1.26s/it]Task 0, Epoch 18/20 => Loss 2.202, Train_accy 26.37:  90%|█████████ | 18/20 [00:22<00:02,  1.15s/it]Task 0, Epoch 19/20 => Loss 1.994, Train_accy 24.18:  90%|█████████ | 18/20 [00:23<00:02,  1.15s/it]Task 0, Epoch 19/20 => Loss 1.994, Train_accy 24.18:  95%|█████████▌| 19/20 [00:23<00:01,  1.07s/it]Task 0, Epoch 20/20 => Loss 1.865, Train_accy 47.25:  95%|█████████▌| 19/20 [00:24<00:01,  1.07s/it]Task 0, Epoch 20/20 => Loss 1.865, Train_accy 47.25: 100%|██████████| 20/20 [00:24<00:00,  1.03s/it]Task 0, Epoch 20/20 => Loss 1.865, Train_accy 47.25: 100%|██████████| 20/20 [00:24<00:00,  1.22s/it]
2024-05-10 02:26:57,465 [der.py] => Task 0, Epoch 20/20 => Loss 1.865, Train_accy 47.25
2024-05-10 02:26:57,466 [base.py] => Constructing exemplars for new classes...(20 per classes)
Traceback (most recent call last):
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 25, in <module>
    main()
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 11, in main
    train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 19, in train
    _train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 73, in _train
    model.incremental_train(data_manager)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/der.py", line 75, in incremental_train
    self.build_rehearsal_memory(data_manager, self.samples_per_class)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/base.py", line 56, in build_rehearsal_memory
    self._construct_exemplar_unified(data_manager, per_class)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/base.py", line 362, in _construct_exemplar_unified
    i = np.argmin(np.sqrt(np.sum((class_mean - mu_p) ** 2, axis=1)))
  File "/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 1325, in argmin
    return _wrapfunc(a, 'argmin', axis=axis, out=out, **kwds)
  File "/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
    return bound(*args, **kwds)
ValueError: attempt to get argmin of an empty sequence
2024-05-10 02:27:00,437 [trainer.py] => config: ./exps/foster_vtab_B0_Inc10.json
2024-05-10 02:27:00,438 [trainer.py] => prefix: cil
2024-05-10 02:27:00,438 [trainer.py] => dataset: vtab
2024-05-10 02:27:00,438 [trainer.py] => memory_size: 1000
2024-05-10 02:27:00,438 [trainer.py] => memory_per_class: 20
2024-05-10 02:27:00,438 [trainer.py] => fixed_memory: True
2024-05-10 02:27:00,438 [trainer.py] => shuffle: True
2024-05-10 02:27:00,438 [trainer.py] => init_cls: 5
2024-05-10 02:27:00,438 [trainer.py] => increment: 5
2024-05-10 02:27:00,438 [trainer.py] => model_name: foster
2024-05-10 02:27:00,438 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-05-10 02:27:00,438 [trainer.py] => device: [device(type='cuda', index=4)]
2024-05-10 02:27:00,438 [trainer.py] => seed: 1993
2024-05-10 02:27:00,438 [trainer.py] => beta1: 0.96
2024-05-10 02:27:00,438 [trainer.py] => beta2: 0.97
2024-05-10 02:27:00,438 [trainer.py] => oofc: ft
2024-05-10 02:27:00,438 [trainer.py] => is_teacher_wa: False
2024-05-10 02:27:00,438 [trainer.py] => is_student_wa: False
2024-05-10 02:27:00,438 [trainer.py] => lambda_okd: 1
2024-05-10 02:27:00,438 [trainer.py] => wa_value: 1
2024-05-10 02:27:00,438 [trainer.py] => init_epochs: 20
2024-05-10 02:27:00,438 [trainer.py] => init_lr: 0.001
2024-05-10 02:27:00,438 [trainer.py] => init_weight_decay: 0.0005
2024-05-10 02:27:00,438 [trainer.py] => boosting_epochs: 20
2024-05-10 02:27:00,438 [trainer.py] => compression_epochs: 20
2024-05-10 02:27:00,438 [trainer.py] => lr: 0.001
2024-05-10 02:27:00,439 [trainer.py] => batch_size: 48
2024-05-10 02:27:00,439 [trainer.py] => weight_decay: 0.0005
2024-05-10 02:27:00,439 [trainer.py] => num_workers: 8
2024-05-10 02:27:00,439 [trainer.py] => T: 2
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-05-10 02:27:00,471 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-05-10 02:27:00,798 [trainer.py] => All params: 0
2024-05-10 02:27:00,798 [trainer.py] => Trainable params: 0
2024-05-10 02:27:03,031 [foster.py] => Learning on 0-5
2024-05-10 02:27:03,032 [foster.py] => All params: 85806346
2024-05-10 02:27:03,032 [foster.py] => Trainable params: 85806346
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.802, Train_accy 27.47, Test_accy 43.36:   0%|          | 0/20 [00:02<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.802, Train_accy 27.47, Test_accy 43.36:   5%|▌         | 1/20 [00:02<00:45,  2.40s/it]Task 0, Epoch 2/20 => Loss 1.303, Train_accy 51.65:   5%|▌         | 1/20 [00:03<00:45,  2.40s/it]                 Task 0, Epoch 2/20 => Loss 1.303, Train_accy 51.65:  10%|█         | 2/20 [00:03<00:27,  1.55s/it]Task 0, Epoch 3/20 => Loss 0.696, Train_accy 79.12:  10%|█         | 2/20 [00:04<00:27,  1.55s/it]Task 0, Epoch 3/20 => Loss 0.696, Train_accy 79.12:  15%|█▌        | 3/20 [00:04<00:21,  1.25s/it]Task 0, Epoch 4/20 => Loss 0.313, Train_accy 90.11:  15%|█▌        | 3/20 [00:05<00:21,  1.25s/it]Task 0, Epoch 4/20 => Loss 0.313, Train_accy 90.11:  20%|██        | 4/20 [00:05<00:17,  1.11s/it]Task 0, Epoch 5/20 => Loss 0.422, Train_accy 89.01:  20%|██        | 4/20 [00:06<00:17,  1.11s/it]Task 0, Epoch 5/20 => Loss 0.422, Train_accy 89.01:  25%|██▌       | 5/20 [00:06<00:15,  1.06s/it]Task 0, Epoch 6/20 => Loss 0.290, Train_accy 91.21, Test_accy 92.66:  25%|██▌       | 5/20 [00:08<00:15,  1.06s/it]Task 0, Epoch 6/20 => Loss 0.290, Train_accy 91.21, Test_accy 92.66:  30%|███       | 6/20 [00:08<00:20,  1.43s/it]Task 0, Epoch 7/20 => Loss 0.218, Train_accy 92.31:  30%|███       | 6/20 [00:09<00:20,  1.43s/it]                 Task 0, Epoch 7/20 => Loss 0.218, Train_accy 92.31:  35%|███▌      | 7/20 [00:09<00:16,  1.26s/it]Task 0, Epoch 8/20 => Loss 0.127, Train_accy 94.51:  35%|███▌      | 7/20 [00:10<00:16,  1.26s/it]Task 0, Epoch 8/20 => Loss 0.127, Train_accy 94.51:  40%|████      | 8/20 [00:10<00:13,  1.14s/it]Task 0, Epoch 9/20 => Loss 0.067, Train_accy 97.80:  40%|████      | 8/20 [00:10<00:13,  1.14s/it]Task 0, Epoch 9/20 => Loss 0.067, Train_accy 97.80:  45%|████▌     | 9/20 [00:10<00:11,  1.07s/it]Task 0, Epoch 10/20 => Loss 0.061, Train_accy 97.80:  45%|████▌     | 9/20 [00:11<00:11,  1.07s/it]Task 0, Epoch 10/20 => Loss 0.061, Train_accy 97.80:  50%|█████     | 10/20 [00:11<00:10,  1.01s/it]Task 0, Epoch 11/20 => Loss 0.091, Train_accy 96.70, Test_accy 96.15:  50%|█████     | 10/20 [00:14<00:10,  1.01s/it]Task 0, Epoch 11/20 => Loss 0.091, Train_accy 96.70, Test_accy 96.15:  55%|█████▌    | 11/20 [00:14<00:12,  1.38s/it]Task 0, Epoch 12/20 => Loss 0.017, Train_accy 98.90:  55%|█████▌    | 11/20 [00:14<00:12,  1.38s/it]                 Task 0, Epoch 12/20 => Loss 0.017, Train_accy 98.90:  60%|██████    | 12/20 [00:14<00:09,  1.23s/it]Task 0, Epoch 13/20 => Loss 0.057, Train_accy 97.80:  60%|██████    | 12/20 [00:15<00:09,  1.23s/it]Task 0, Epoch 13/20 => Loss 0.057, Train_accy 97.80:  65%|██████▌   | 13/20 [00:15<00:07,  1.13s/it]Task 0, Epoch 14/20 => Loss 0.016, Train_accy 98.90:  65%|██████▌   | 13/20 [00:16<00:07,  1.13s/it]Task 0, Epoch 14/20 => Loss 0.016, Train_accy 98.90:  70%|███████   | 14/20 [00:16<00:06,  1.06s/it]Task 0, Epoch 15/20 => Loss 0.002, Train_accy 100.00:  70%|███████   | 14/20 [00:17<00:06,  1.06s/it]Task 0, Epoch 15/20 => Loss 0.002, Train_accy 100.00:  75%|███████▌  | 15/20 [00:17<00:05,  1.02s/it]Task 0, Epoch 16/20 => Loss 0.007, Train_accy 100.00, Test_accy 95.45:  75%|███████▌  | 15/20 [00:19<00:05,  1.02s/it]Task 0, Epoch 16/20 => Loss 0.007, Train_accy 100.00, Test_accy 95.45:  80%|████████  | 16/20 [00:20<00:05,  1.41s/it]Task 0, Epoch 17/20 => Loss 0.096, Train_accy 96.70:  80%|████████  | 16/20 [00:20<00:05,  1.41s/it]                  Task 0, Epoch 17/20 => Loss 0.096, Train_accy 96.70:  85%|████████▌ | 17/20 [00:20<00:03,  1.26s/it]Task 0, Epoch 18/20 => Loss 0.009, Train_accy 100.00:  85%|████████▌ | 17/20 [00:21<00:03,  1.26s/it]Task 0, Epoch 18/20 => Loss 0.009, Train_accy 100.00:  90%|█████████ | 18/20 [00:21<00:02,  1.15s/it]Task 0, Epoch 19/20 => Loss 0.002, Train_accy 100.00:  90%|█████████ | 18/20 [00:22<00:02,  1.15s/it]Task 0, Epoch 19/20 => Loss 0.002, Train_accy 100.00:  95%|█████████▌| 19/20 [00:22<00:01,  1.08s/it]Task 0, Epoch 20/20 => Loss 0.026, Train_accy 98.90:  95%|█████████▌| 19/20 [00:23<00:01,  1.08s/it] Task 0, Epoch 20/20 => Loss 0.026, Train_accy 98.90: 100%|██████████| 20/20 [00:23<00:00,  1.05s/it]Task 0, Epoch 20/20 => Loss 0.026, Train_accy 98.90: 100%|██████████| 20/20 [00:23<00:00,  1.18s/it]
2024-05-10 02:27:27,170 [foster.py] => Task 0, Epoch 20/20 => Loss 0.026, Train_accy 98.90
2024-05-10 02:27:27,172 [base.py] => Constructing exemplars for new classes...(20 per classes)
Traceback (most recent call last):
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 25, in <module>
    main()
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 11, in main
    train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 19, in train
    _train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 73, in _train
    model.incremental_train(data_manager)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/foster.py", line 95, in incremental_train
    self.build_rehearsal_memory(data_manager, self.samples_per_class)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/base.py", line 56, in build_rehearsal_memory
    self._construct_exemplar_unified(data_manager, per_class)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/base.py", line 362, in _construct_exemplar_unified
    i = np.argmin(np.sqrt(np.sum((class_mean - mu_p) ** 2, axis=1)))
  File "/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 1325, in argmin
    return _wrapfunc(a, 'argmin', axis=axis, out=out, **kwds)
  File "/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
    return bound(*args, **kwds)
ValueError: attempt to get argmin of an empty sequence
2024-05-10 02:27:29,967 [trainer.py] => config: ./exps/l2p_vtab_B0_Inc10.json
2024-05-10 02:27:29,967 [trainer.py] => prefix:  
2024-05-10 02:27:29,967 [trainer.py] => dataset: vtab
2024-05-10 02:27:29,967 [trainer.py] => memory_size: 0
2024-05-10 02:27:29,967 [trainer.py] => memory_per_class: 0
2024-05-10 02:27:29,967 [trainer.py] => fixed_memory: False
2024-05-10 02:27:29,967 [trainer.py] => shuffle: True
2024-05-10 02:27:29,968 [trainer.py] => init_cls: 5
2024-05-10 02:27:29,968 [trainer.py] => increment: 5
2024-05-10 02:27:29,968 [trainer.py] => model_name: l2p
2024-05-10 02:27:29,968 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-05-10 02:27:29,968 [trainer.py] => get_original_backbone: True
2024-05-10 02:27:29,968 [trainer.py] => device: [device(type='cuda', index=4)]
2024-05-10 02:27:29,968 [trainer.py] => seed: 1993
2024-05-10 02:27:29,968 [trainer.py] => tuned_epoch: 20
2024-05-10 02:27:29,968 [trainer.py] => init_lr: 0.001875
2024-05-10 02:27:29,968 [trainer.py] => batch_size: 48
2024-05-10 02:27:29,968 [trainer.py] => weight_decay: 0
2024-05-10 02:27:29,968 [trainer.py] => min_lr: 1e-05
2024-05-10 02:27:29,968 [trainer.py] => optimizer: adam
2024-05-10 02:27:29,968 [trainer.py] => scheduler: constant
2024-05-10 02:27:29,968 [trainer.py] => reinit_optimizer: True
2024-05-10 02:27:29,968 [trainer.py] => global_pool: token
2024-05-10 02:27:29,968 [trainer.py] => head_type: prompt
2024-05-10 02:27:29,968 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-05-10 02:27:29,968 [trainer.py] => pretrained: True
2024-05-10 02:27:29,968 [trainer.py] => drop: 0.0
2024-05-10 02:27:29,968 [trainer.py] => drop_path: 0.0
2024-05-10 02:27:29,968 [trainer.py] => prompt_pool: True
2024-05-10 02:27:29,968 [trainer.py] => size: 10
2024-05-10 02:27:29,968 [trainer.py] => length: 5
2024-05-10 02:27:29,968 [trainer.py] => top_k: 5
2024-05-10 02:27:29,968 [trainer.py] => initializer: uniform
2024-05-10 02:27:29,968 [trainer.py] => prompt_key: True
2024-05-10 02:27:29,968 [trainer.py] => prompt_key_init: uniform
2024-05-10 02:27:29,968 [trainer.py] => use_prompt_mask: False
2024-05-10 02:27:29,968 [trainer.py] => shared_prompt_pool: False
2024-05-10 02:27:29,968 [trainer.py] => shared_prompt_key: False
2024-05-10 02:27:29,968 [trainer.py] => batchwise_prompt: True
2024-05-10 02:27:29,968 [trainer.py] => embedding_key: cls
2024-05-10 02:27:29,968 [trainer.py] => predefined_key: 
2024-05-10 02:27:29,968 [trainer.py] => pull_constraint: True
2024-05-10 02:27:29,969 [trainer.py] => pull_constraint_coeff: 0.1
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-05-10 02:27:29,996 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-05-10 02:27:31,517 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-05-10 02:27:31,517 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-05-10 02:27:34,549 [l2p.py] => 85,902,386 model total parameters.
2024-05-10 02:27:34,550 [l2p.py] => 84,530 model training parameters.
2024-05-10 02:27:34,550 [l2p.py] => prompt.prompt: 38400
2024-05-10 02:27:34,550 [l2p.py] => prompt.prompt_key: 7680
2024-05-10 02:27:34,550 [l2p.py] => head.weight: 38400
2024-05-10 02:27:34,550 [l2p.py] => head.bias: 50
2024-05-10 02:27:34,551 [trainer.py] => All params: 171739492
2024-05-10 02:27:34,552 [trainer.py] => Trainable params: 84530
2024-05-10 02:27:34,552 [l2p.py] => Learning on 0-5
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.170, Train_accy 27.47:   0%|          | 0/20 [00:01<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.170, Train_accy 27.47:   5%|▌         | 1/20 [00:01<00:30,  1.59s/it]Task 0, Epoch 2/20 => Loss 1.185, Train_accy 52.75:   5%|▌         | 1/20 [00:02<00:30,  1.59s/it]Task 0, Epoch 2/20 => Loss 1.185, Train_accy 52.75:  10%|█         | 2/20 [00:02<00:23,  1.30s/it]Task 0, Epoch 3/20 => Loss 0.700, Train_accy 69.23:  10%|█         | 2/20 [00:03<00:23,  1.30s/it]Task 0, Epoch 3/20 => Loss 0.700, Train_accy 69.23:  15%|█▌        | 3/20 [00:03<00:20,  1.21s/it]Task 0, Epoch 4/20 => Loss 0.324, Train_accy 89.01:  15%|█▌        | 3/20 [00:04<00:20,  1.21s/it]Task 0, Epoch 4/20 => Loss 0.324, Train_accy 89.01:  20%|██        | 4/20 [00:04<00:18,  1.18s/it]Task 0, Epoch 5/20 => Loss 0.243, Train_accy 94.51, Test_accy 93.71:  20%|██        | 4/20 [00:08<00:18,  1.18s/it]Task 0, Epoch 5/20 => Loss 0.243, Train_accy 94.51, Test_accy 93.71:  25%|██▌       | 5/20 [00:08<00:28,  1.92s/it]Task 0, Epoch 6/20 => Loss 0.174, Train_accy 94.51:  25%|██▌       | 5/20 [00:09<00:28,  1.92s/it]                 Task 0, Epoch 6/20 => Loss 0.174, Train_accy 94.51:  30%|███       | 6/20 [00:09<00:23,  1.65s/it]Task 0, Epoch 7/20 => Loss 0.116, Train_accy 98.90:  30%|███       | 6/20 [00:10<00:23,  1.65s/it]Task 0, Epoch 7/20 => Loss 0.116, Train_accy 98.90:  35%|███▌      | 7/20 [00:10<00:19,  1.48s/it]Task 0, Epoch 8/20 => Loss 0.149, Train_accy 95.60:  35%|███▌      | 7/20 [00:11<00:19,  1.48s/it]Task 0, Epoch 8/20 => Loss 0.149, Train_accy 95.60:  40%|████      | 8/20 [00:11<00:16,  1.38s/it]Task 0, Epoch 9/20 => Loss 0.100, Train_accy 96.70:  40%|████      | 8/20 [00:12<00:16,  1.38s/it]Task 0, Epoch 9/20 => Loss 0.100, Train_accy 96.70:  45%|████▌     | 9/20 [00:12<00:14,  1.35s/it]Task 0, Epoch 10/20 => Loss 0.060, Train_accy 97.80, Test_accy 95.80:  45%|████▌     | 9/20 [00:15<00:14,  1.35s/it]Task 0, Epoch 10/20 => Loss 0.060, Train_accy 97.80, Test_accy 95.80:  50%|█████     | 10/20 [00:15<00:18,  1.90s/it]Task 0, Epoch 11/20 => Loss 0.062, Train_accy 97.80:  50%|█████     | 10/20 [00:17<00:18,  1.90s/it]                 Task 0, Epoch 11/20 => Loss 0.062, Train_accy 97.80:  55%|█████▌    | 11/20 [00:17<00:14,  1.66s/it]Task 0, Epoch 12/20 => Loss 0.058, Train_accy 97.80:  55%|█████▌    | 11/20 [00:18<00:14,  1.66s/it]Task 0, Epoch 12/20 => Loss 0.058, Train_accy 97.80:  60%|██████    | 12/20 [00:18<00:12,  1.50s/it]Task 0, Epoch 13/20 => Loss 0.061, Train_accy 97.80:  60%|██████    | 12/20 [00:19<00:12,  1.50s/it]Task 0, Epoch 13/20 => Loss 0.061, Train_accy 97.80:  65%|██████▌   | 13/20 [00:19<00:10,  1.44s/it]Task 0, Epoch 14/20 => Loss 0.079, Train_accy 98.90:  65%|██████▌   | 13/20 [00:20<00:10,  1.44s/it]Task 0, Epoch 14/20 => Loss 0.079, Train_accy 98.90:  70%|███████   | 14/20 [00:20<00:08,  1.37s/it]Task 0, Epoch 15/20 => Loss 0.015, Train_accy 100.00, Test_accy 96.50:  70%|███████   | 14/20 [00:23<00:08,  1.37s/it]Task 0, Epoch 15/20 => Loss 0.015, Train_accy 100.00, Test_accy 96.50:  75%|███████▌  | 15/20 [00:23<00:09,  1.89s/it]Task 0, Epoch 16/20 => Loss 0.049, Train_accy 97.80:  75%|███████▌  | 15/20 [00:25<00:09,  1.89s/it]                  Task 0, Epoch 16/20 => Loss 0.049, Train_accy 97.80:  80%|████████  | 16/20 [00:25<00:06,  1.68s/it]Task 0, Epoch 17/20 => Loss 0.014, Train_accy 100.00:  80%|████████  | 16/20 [00:26<00:06,  1.68s/it]Task 0, Epoch 17/20 => Loss 0.014, Train_accy 100.00:  85%|████████▌ | 17/20 [00:26<00:04,  1.53s/it]Task 0, Epoch 18/20 => Loss 0.039, Train_accy 96.70:  85%|████████▌ | 17/20 [00:27<00:04,  1.53s/it] Task 0, Epoch 18/20 => Loss 0.039, Train_accy 96.70:  90%|█████████ | 18/20 [00:27<00:02,  1.42s/it]Task 0, Epoch 19/20 => Loss 0.001, Train_accy 100.00:  90%|█████████ | 18/20 [00:28<00:02,  1.42s/it]Task 0, Epoch 19/20 => Loss 0.001, Train_accy 100.00:  95%|█████████▌| 19/20 [00:28<00:01,  1.35s/it]Task 0, Epoch 20/20 => Loss 0.021, Train_accy 98.90, Test_accy 95.10:  95%|█████████▌| 19/20 [00:31<00:01,  1.35s/it]Task 0, Epoch 20/20 => Loss 0.021, Train_accy 98.90, Test_accy 95.10: 100%|██████████| 20/20 [00:31<00:00,  1.89s/it]Task 0, Epoch 20/20 => Loss 0.021, Train_accy 98.90, Test_accy 95.10: 100%|██████████| 20/20 [00:31<00:00,  1.59s/it]
2024-05-10 02:28:06,850 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.021, Train_accy 98.90, Test_accy 95.10
2024-05-10 02:28:08,895 [trainer.py] => No NME accuracy.
2024-05-10 02:28:08,895 [trainer.py] => CNN: {'total': 95.1, '00-04': 95.1, 'old': 0, 'new': 95.1}
2024-05-10 02:28:08,895 [trainer.py] => CNN top1 curve: [95.1]
2024-05-10 02:28:08,895 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 95.1
2024-05-10 02:28:08,895 [trainer.py] => Average Accuracy (CNN): 95.1 

2024-05-10 02:28:08,895 [trainer.py] => Train Time: 64.00999999999999
2024-05-10 02:28:08,895 [trainer.py] => Test Time: 2.04 

2024-05-10 02:28:08,897 [trainer.py] => All params: 171739492
2024-05-10 02:28:08,898 [trainer.py] => Trainable params: 84530
2024-05-10 02:28:08,898 [l2p.py] => Learning on 5-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.657, Train_accy 22.86:   0%|          | 0/20 [00:01<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.657, Train_accy 22.86:   5%|▌         | 1/20 [00:01<00:20,  1.09s/it]Task 1, Epoch 2/20 => Loss 0.666, Train_accy 67.14:   5%|▌         | 1/20 [00:02<00:20,  1.09s/it]Task 1, Epoch 2/20 => Loss 0.666, Train_accy 67.14:  10%|█         | 2/20 [00:02<00:18,  1.04s/it]Task 1, Epoch 3/20 => Loss 0.185, Train_accy 98.57:  10%|█         | 2/20 [00:03<00:18,  1.04s/it]Task 1, Epoch 3/20 => Loss 0.185, Train_accy 98.57:  15%|█▌        | 3/20 [00:03<00:17,  1.03s/it]Task 1, Epoch 4/20 => Loss 0.093, Train_accy 98.57:  15%|█▌        | 3/20 [00:04<00:17,  1.03s/it]Task 1, Epoch 4/20 => Loss 0.093, Train_accy 98.57:  20%|██        | 4/20 [00:04<00:16,  1.00s/it]Task 1, Epoch 5/20 => Loss 0.162, Train_accy 94.29, Test_accy 91.65:  20%|██        | 4/20 [00:09<00:16,  1.00s/it]Task 1, Epoch 5/20 => Loss 0.162, Train_accy 94.29, Test_accy 91.65:  25%|██▌       | 5/20 [00:09<00:40,  2.72s/it]Task 1, Epoch 6/20 => Loss 0.022, Train_accy 98.57:  25%|██▌       | 5/20 [00:10<00:40,  2.72s/it]                 Task 1, Epoch 6/20 => Loss 0.022, Train_accy 98.57:  30%|███       | 6/20 [00:10<00:29,  2.14s/it]Task 1, Epoch 7/20 => Loss 0.001, Train_accy 100.00:  30%|███       | 6/20 [00:11<00:29,  2.14s/it]Task 1, Epoch 7/20 => Loss 0.001, Train_accy 100.00:  35%|███▌      | 7/20 [00:11<00:23,  1.79s/it]Task 1, Epoch 8/20 => Loss -0.001, Train_accy 100.00:  35%|███▌      | 7/20 [00:12<00:23,  1.79s/it]Task 1, Epoch 8/20 => Loss -0.001, Train_accy 100.00:  40%|████      | 8/20 [00:12<00:18,  1.52s/it]Task 1, Epoch 9/20 => Loss 0.034, Train_accy 97.14:  40%|████      | 8/20 [00:13<00:18,  1.52s/it]  Task 1, Epoch 9/20 => Loss 0.034, Train_accy 97.14:  45%|████▌     | 9/20 [00:13<00:14,  1.36s/it]Task 1, Epoch 10/20 => Loss 0.020, Train_accy 97.14, Test_accy 96.61:  45%|████▌     | 9/20 [00:19<00:14,  1.36s/it]Task 1, Epoch 10/20 => Loss 0.020, Train_accy 97.14, Test_accy 96.61:  50%|█████     | 10/20 [00:19<00:27,  2.78s/it]Task 1, Epoch 11/20 => Loss -0.014, Train_accy 98.57:  50%|█████     | 10/20 [00:20<00:27,  2.78s/it]                Task 1, Epoch 11/20 => Loss -0.014, Train_accy 98.57:  55%|█████▌    | 11/20 [00:20<00:20,  2.23s/it]Task 1, Epoch 12/20 => Loss 0.015, Train_accy 98.57:  55%|█████▌    | 11/20 [00:21<00:20,  2.23s/it] Task 1, Epoch 12/20 => Loss 0.015, Train_accy 98.57:  60%|██████    | 12/20 [00:21<00:15,  1.88s/it]Task 1, Epoch 13/20 => Loss 0.010, Train_accy 98.57:  60%|██████    | 12/20 [00:22<00:15,  1.88s/it]Task 1, Epoch 13/20 => Loss 0.010, Train_accy 98.57:  65%|██████▌   | 13/20 [00:22<00:11,  1.60s/it]Task 1, Epoch 14/20 => Loss -0.017, Train_accy 100.00:  65%|██████▌   | 13/20 [00:23<00:11,  1.60s/it]Task 1, Epoch 14/20 => Loss -0.017, Train_accy 100.00:  70%|███████   | 14/20 [00:23<00:08,  1.41s/it]Task 1, Epoch 15/20 => Loss -0.015, Train_accy 100.00, Test_accy 97.46:  70%|███████   | 14/20 [00:29<00:08,  1.41s/it]Task 1, Epoch 15/20 => Loss -0.015, Train_accy 100.00, Test_accy 97.46:  75%|███████▌  | 15/20 [00:29<00:13,  2.77s/it]Task 1, Epoch 16/20 => Loss 0.009, Train_accy 97.14:  75%|███████▌  | 15/20 [00:30<00:13,  2.77s/it]                   Task 1, Epoch 16/20 => Loss 0.009, Train_accy 97.14:  80%|████████  | 16/20 [00:30<00:09,  2.26s/it]Task 1, Epoch 17/20 => Loss -0.032, Train_accy 100.00:  80%|████████  | 16/20 [00:31<00:09,  2.26s/it]Task 1, Epoch 17/20 => Loss -0.032, Train_accy 100.00:  85%|████████▌ | 17/20 [00:31<00:05,  1.91s/it]Task 1, Epoch 18/20 => Loss 0.064, Train_accy 98.57:  85%|████████▌ | 17/20 [00:32<00:05,  1.91s/it]  Task 1, Epoch 18/20 => Loss 0.064, Train_accy 98.57:  90%|█████████ | 18/20 [00:32<00:03,  1.64s/it]Task 1, Epoch 19/20 => Loss -0.030, Train_accy 100.00:  90%|█████████ | 18/20 [00:33<00:03,  1.64s/it]Task 1, Epoch 19/20 => Loss -0.030, Train_accy 100.00:  95%|█████████▌| 19/20 [00:33<00:01,  1.46s/it]Task 1, Epoch 20/20 => Loss 0.004, Train_accy 98.57, Test_accy 97.09:  95%|█████████▌| 19/20 [00:39<00:01,  1.46s/it]Task 1, Epoch 20/20 => Loss 0.004, Train_accy 98.57, Test_accy 97.09: 100%|██████████| 20/20 [00:39<00:00,  2.78s/it]Task 1, Epoch 20/20 => Loss 0.004, Train_accy 98.57, Test_accy 97.09: 100%|██████████| 20/20 [00:39<00:00,  1.99s/it]
2024-05-10 02:28:48,732 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.004, Train_accy 98.57, Test_accy 97.09
2024-05-10 02:28:53,527 [trainer.py] => No NME accuracy.
2024-05-10 02:28:53,527 [trainer.py] => CNN: {'total': 97.09, '00-04': 92.31, '05-09': 99.63, 'old': 92.31, 'new': 99.63}
2024-05-10 02:28:53,527 [trainer.py] => CNN top1 curve: [95.1, 97.09]
2024-05-10 02:28:53,527 [trainer.py] => CNN top5 curve: [100.0, 99.39]

Average Accuracy (CNN): 96.1
2024-05-10 02:28:53,527 [trainer.py] => Average Accuracy (CNN): 96.1 

2024-05-10 02:28:53,527 [trainer.py] => Train Time: 143.67
2024-05-10 02:28:53,527 [trainer.py] => Test Time: 6.83 

2024-05-10 02:28:53,529 [trainer.py] => All params: 171739492
2024-05-10 02:28:53,530 [trainer.py] => Trainable params: 84530
2024-05-10 02:28:53,530 [l2p.py] => Learning on 10-15
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.655, Train_accy 35.51:   0%|          | 0/20 [00:01<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.655, Train_accy 35.51:   5%|▌         | 1/20 [00:01<00:30,  1.61s/it]Task 2, Epoch 2/20 => Loss 0.740, Train_accy 69.57:   5%|▌         | 1/20 [00:03<00:30,  1.61s/it]Task 2, Epoch 2/20 => Loss 0.740, Train_accy 69.57:  10%|█         | 2/20 [00:03<00:27,  1.53s/it]Task 2, Epoch 3/20 => Loss 0.264, Train_accy 88.41:  10%|█         | 2/20 [00:04<00:27,  1.53s/it]Task 2, Epoch 3/20 => Loss 0.264, Train_accy 88.41:  15%|█▌        | 3/20 [00:04<00:25,  1.51s/it]Task 2, Epoch 4/20 => Loss 0.155, Train_accy 97.10:  15%|█▌        | 3/20 [00:06<00:25,  1.51s/it]Task 2, Epoch 4/20 => Loss 0.155, Train_accy 97.10:  20%|██        | 4/20 [00:06<00:24,  1.53s/it]Task 2, Epoch 5/20 => Loss 0.044, Train_accy 100.00, Test_accy 97.08:  20%|██        | 4/20 [00:15<00:24,  1.53s/it]Task 2, Epoch 5/20 => Loss 0.044, Train_accy 100.00, Test_accy 97.08:  25%|██▌       | 5/20 [00:15<01:05,  4.39s/it]Task 2, Epoch 6/20 => Loss 0.090, Train_accy 96.38:  25%|██▌       | 5/20 [00:17<01:05,  4.39s/it]                  Task 2, Epoch 6/20 => Loss 0.090, Train_accy 96.38:  30%|███       | 6/20 [00:17<00:47,  3.42s/it]Task 2, Epoch 7/20 => Loss -0.014, Train_accy 100.00:  30%|███       | 6/20 [00:18<00:47,  3.42s/it]Task 2, Epoch 7/20 => Loss -0.014, Train_accy 100.00:  35%|███▌      | 7/20 [00:18<00:36,  2.78s/it]Task 2, Epoch 8/20 => Loss -0.007, Train_accy 100.00:  35%|███▌      | 7/20 [00:20<00:36,  2.78s/it]Task 2, Epoch 8/20 => Loss -0.007, Train_accy 100.00:  40%|████      | 8/20 [00:20<00:28,  2.36s/it]Task 2, Epoch 9/20 => Loss -0.018, Train_accy 100.00:  40%|████      | 8/20 [00:21<00:28,  2.36s/it]Task 2, Epoch 9/20 => Loss -0.018, Train_accy 100.00:  45%|████▌     | 9/20 [00:21<00:23,  2.10s/it]Task 2, Epoch 10/20 => Loss -0.015, Train_accy 100.00, Test_accy 96.94:  45%|████▌     | 9/20 [00:31<00:23,  2.10s/it]Task 2, Epoch 10/20 => Loss -0.015, Train_accy 100.00, Test_accy 96.94:  50%|█████     | 10/20 [00:31<00:43,  4.37s/it]Task 2, Epoch 11/20 => Loss 0.000, Train_accy 99.28:  50%|█████     | 10/20 [00:32<00:43,  4.37s/it]                   Task 2, Epoch 11/20 => Loss 0.000, Train_accy 99.28:  55%|█████▌    | 11/20 [00:32<00:31,  3.53s/it]Task 2, Epoch 12/20 => Loss -0.034, Train_accy 100.00:  55%|█████▌    | 11/20 [00:34<00:31,  3.53s/it]Task 2, Epoch 12/20 => Loss -0.034, Train_accy 100.00:  60%|██████    | 12/20 [00:34<00:23,  2.91s/it]Task 2, Epoch 13/20 => Loss 0.039, Train_accy 97.10:  60%|██████    | 12/20 [00:35<00:23,  2.91s/it]  Task 2, Epoch 13/20 => Loss 0.039, Train_accy 97.10:  65%|██████▌   | 13/20 [00:35<00:17,  2.48s/it]Task 2, Epoch 14/20 => Loss -0.010, Train_accy 98.55:  65%|██████▌   | 13/20 [00:37<00:17,  2.48s/it]Task 2, Epoch 14/20 => Loss -0.010, Train_accy 98.55:  70%|███████   | 14/20 [00:37<00:13,  2.18s/it]Task 2, Epoch 15/20 => Loss -0.031, Train_accy 100.00, Test_accy 97.15:  70%|███████   | 14/20 [00:46<00:13,  2.18s/it]Task 2, Epoch 15/20 => Loss -0.031, Train_accy 100.00, Test_accy 97.15:  75%|███████▌  | 15/20 [00:46<00:21,  4.36s/it]Task 2, Epoch 16/20 => Loss -0.020, Train_accy 99.28:  75%|███████▌  | 15/20 [00:48<00:21,  4.36s/it]                  Task 2, Epoch 16/20 => Loss -0.020, Train_accy 99.28:  80%|████████  | 16/20 [00:48<00:14,  3.50s/it]Task 2, Epoch 17/20 => Loss -0.029, Train_accy 99.28:  80%|████████  | 16/20 [00:49<00:14,  3.50s/it]Task 2, Epoch 17/20 => Loss -0.029, Train_accy 99.28:  85%|████████▌ | 17/20 [00:49<00:08,  2.91s/it]Task 2, Epoch 18/20 => Loss -0.030, Train_accy 99.28:  85%|████████▌ | 17/20 [00:51<00:08,  2.91s/it]Task 2, Epoch 18/20 => Loss -0.030, Train_accy 99.28:  90%|█████████ | 18/20 [00:51<00:04,  2.48s/it]Task 2, Epoch 19/20 => Loss -0.038, Train_accy 100.00:  90%|█████████ | 18/20 [00:52<00:04,  2.48s/it]Task 2, Epoch 19/20 => Loss -0.038, Train_accy 100.00:  95%|█████████▌| 19/20 [00:52<00:02,  2.17s/it]Task 2, Epoch 20/20 => Loss 0.010, Train_accy 98.55, Test_accy 97.15:  95%|█████████▌| 19/20 [01:01<00:02,  2.17s/it]Task 2, Epoch 20/20 => Loss 0.010, Train_accy 98.55, Test_accy 97.15: 100%|██████████| 20/20 [01:01<00:00,  4.33s/it]Task 2, Epoch 20/20 => Loss 0.010, Train_accy 98.55, Test_accy 97.15: 100%|██████████| 20/20 [01:01<00:00,  3.09s/it]
2024-05-10 02:29:55,413 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.010, Train_accy 98.55, Test_accy 97.15
2024-05-10 02:30:03,360 [trainer.py] => No NME accuracy.
2024-05-10 02:30:03,360 [trainer.py] => CNN: {'total': 97.15, '00-04': 87.76, '05-09': 99.44, '10-14': 99.51, 'old': 95.4, 'new': 99.51}
2024-05-10 02:30:03,361 [trainer.py] => CNN top1 curve: [95.1, 97.09, 97.15]
2024-05-10 02:30:03,361 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58]

Average Accuracy (CNN): 96.45
2024-05-10 02:30:03,361 [trainer.py] => Average Accuracy (CNN): 96.45 

2024-05-10 02:30:03,361 [trainer.py] => Train Time: 267.42
2024-05-10 02:30:03,361 [trainer.py] => Test Time: 14.780000000000001 

2024-05-10 02:30:03,362 [trainer.py] => All params: 171739492
2024-05-10 02:30:03,364 [trainer.py] => Trainable params: 84530
2024-05-10 02:30:03,364 [l2p.py] => Learning on 15-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.448, Train_accy 45.65:   0%|          | 0/20 [00:02<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.448, Train_accy 45.65:   5%|▌         | 1/20 [00:02<00:50,  2.65s/it]Task 3, Epoch 2/20 => Loss 0.655, Train_accy 77.90:   5%|▌         | 1/20 [00:05<00:50,  2.65s/it]Task 3, Epoch 2/20 => Loss 0.655, Train_accy 77.90:  10%|█         | 2/20 [00:05<00:47,  2.63s/it]Task 3, Epoch 3/20 => Loss 0.339, Train_accy 85.14:  10%|█         | 2/20 [00:07<00:47,  2.63s/it]Task 3, Epoch 3/20 => Loss 0.339, Train_accy 85.14:  15%|█▌        | 3/20 [00:07<00:44,  2.60s/it]Task 3, Epoch 4/20 => Loss 0.265, Train_accy 89.86:  15%|█▌        | 3/20 [00:10<00:44,  2.60s/it]Task 3, Epoch 4/20 => Loss 0.265, Train_accy 89.86:  20%|██        | 4/20 [00:10<00:41,  2.61s/it]Task 3, Epoch 5/20 => Loss 0.233, Train_accy 89.49, Test_accy 87.78:  20%|██        | 4/20 [00:28<00:41,  2.61s/it]Task 3, Epoch 5/20 => Loss 0.233, Train_accy 89.49, Test_accy 87.78:  25%|██▌       | 5/20 [00:28<02:01,  8.11s/it]Task 3, Epoch 6/20 => Loss 0.231, Train_accy 90.22:  25%|██▌       | 5/20 [00:30<02:01,  8.11s/it]                 Task 3, Epoch 6/20 => Loss 0.231, Train_accy 90.22:  30%|███       | 6/20 [00:30<01:27,  6.22s/it]Task 3, Epoch 7/20 => Loss 0.140, Train_accy 93.84:  30%|███       | 6/20 [00:33<01:27,  6.22s/it]Task 3, Epoch 7/20 => Loss 0.140, Train_accy 93.84:  35%|███▌      | 7/20 [00:33<01:05,  5.03s/it]Task 3, Epoch 8/20 => Loss 0.124, Train_accy 93.12:  35%|███▌      | 7/20 [00:36<01:05,  5.03s/it]Task 3, Epoch 8/20 => Loss 0.124, Train_accy 93.12:  40%|████      | 8/20 [00:36<00:51,  4.25s/it]Task 3, Epoch 9/20 => Loss 0.089, Train_accy 95.65:  40%|████      | 8/20 [00:38<00:51,  4.25s/it]Task 3, Epoch 9/20 => Loss 0.089, Train_accy 95.65:  45%|████▌     | 9/20 [00:38<00:40,  3.72s/it]Task 3, Epoch 10/20 => Loss 0.060, Train_accy 95.65, Test_accy 92.80:  45%|████▌     | 9/20 [00:56<00:40,  3.72s/it]Task 3, Epoch 10/20 => Loss 0.060, Train_accy 95.65, Test_accy 92.80:  50%|█████     | 10/20 [00:56<01:21,  8.13s/it]Task 3, Epoch 11/20 => Loss 0.048, Train_accy 96.01:  50%|█████     | 10/20 [00:59<01:21,  8.13s/it]                 Task 3, Epoch 11/20 => Loss 0.048, Train_accy 96.01:  55%|█████▌    | 11/20 [00:59<00:58,  6.45s/it]Task 3, Epoch 12/20 => Loss 0.045, Train_accy 96.01:  55%|█████▌    | 11/20 [01:01<00:58,  6.45s/it]Task 3, Epoch 12/20 => Loss 0.045, Train_accy 96.01:  60%|██████    | 12/20 [01:01<00:42,  5.28s/it]Task 3, Epoch 13/20 => Loss 0.072, Train_accy 94.57:  60%|██████    | 12/20 [01:04<00:42,  5.28s/it]Task 3, Epoch 13/20 => Loss 0.072, Train_accy 94.57:  65%|██████▌   | 13/20 [01:04<00:31,  4.46s/it]Task 3, Epoch 14/20 => Loss 0.074, Train_accy 94.93:  65%|██████▌   | 13/20 [01:06<00:31,  4.46s/it]Task 3, Epoch 14/20 => Loss 0.074, Train_accy 94.93:  70%|███████   | 14/20 [01:06<00:23,  3.87s/it]Task 3, Epoch 15/20 => Loss 0.050, Train_accy 96.01, Test_accy 91.92:  70%|███████   | 14/20 [01:24<00:23,  3.87s/it]Task 3, Epoch 15/20 => Loss 0.050, Train_accy 96.01, Test_accy 91.92:  75%|███████▌  | 15/20 [01:24<00:40,  8.04s/it]Task 3, Epoch 16/20 => Loss 0.028, Train_accy 96.74:  75%|███████▌  | 15/20 [01:27<00:40,  8.04s/it]                 Task 3, Epoch 16/20 => Loss 0.028, Train_accy 96.74:  80%|████████  | 16/20 [01:27<00:25,  6.38s/it]Task 3, Epoch 17/20 => Loss 0.013, Train_accy 96.38:  80%|████████  | 16/20 [01:29<00:25,  6.38s/it]Task 3, Epoch 17/20 => Loss 0.013, Train_accy 96.38:  85%|████████▌ | 17/20 [01:29<00:15,  5.25s/it]Task 3, Epoch 18/20 => Loss -0.014, Train_accy 97.46:  85%|████████▌ | 17/20 [01:32<00:15,  5.25s/it]Task 3, Epoch 18/20 => Loss -0.014, Train_accy 97.46:  90%|█████████ | 18/20 [01:32<00:08,  4.45s/it]Task 3, Epoch 19/20 => Loss -0.017, Train_accy 97.46:  90%|█████████ | 18/20 [01:34<00:08,  4.45s/it]Task 3, Epoch 19/20 => Loss -0.017, Train_accy 97.46:  95%|█████████▌| 19/20 [01:34<00:03,  3.91s/it]Task 3, Epoch 20/20 => Loss -0.041, Train_accy 98.91, Test_accy 92.76:  95%|█████████▌| 19/20 [01:52<00:03,  3.91s/it]Task 3, Epoch 20/20 => Loss -0.041, Train_accy 98.91, Test_accy 92.76: 100%|██████████| 20/20 [01:52<00:00,  8.08s/it]Task 3, Epoch 20/20 => Loss -0.041, Train_accy 98.91, Test_accy 92.76: 100%|██████████| 20/20 [01:52<00:00,  5.64s/it]
2024-05-10 02:31:56,184 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.041, Train_accy 98.91, Test_accy 92.76
2024-05-10 02:32:11,379 [trainer.py] => No NME accuracy.
2024-05-10 02:32:11,380 [trainer.py] => CNN: {'total': 92.76, '00-04': 87.76, '05-09': 99.07, '10-14': 92.97, '15-19': 91.27, 'old': 94.23, 'new': 91.27}
2024-05-10 02:32:11,380 [trainer.py] => CNN top1 curve: [95.1, 97.09, 97.15, 92.76]
2024-05-10 02:32:11,380 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.33]

Average Accuracy (CNN): 95.52
2024-05-10 02:32:11,380 [trainer.py] => Average Accuracy (CNN): 95.52 

2024-05-10 02:32:11,380 [trainer.py] => Train Time: 493.05
2024-05-10 02:32:11,380 [trainer.py] => Test Time: 29.97 

2024-05-10 02:32:11,383 [trainer.py] => All params: 171739492
2024-05-10 02:32:11,386 [trainer.py] => Trainable params: 84530
2024-05-10 02:32:11,386 [l2p.py] => Learning on 20-25
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.524, Train_accy 41.60:   0%|          | 0/20 [00:02<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.524, Train_accy 41.60:   5%|▌         | 1/20 [00:02<00:44,  2.36s/it]Task 4, Epoch 2/20 => Loss 0.942, Train_accy 56.40:   5%|▌         | 1/20 [00:04<00:44,  2.36s/it]Task 4, Epoch 2/20 => Loss 0.942, Train_accy 56.40:  10%|█         | 2/20 [00:04<00:42,  2.38s/it]Task 4, Epoch 3/20 => Loss 0.539, Train_accy 75.60:  10%|█         | 2/20 [00:07<00:42,  2.38s/it]Task 4, Epoch 3/20 => Loss 0.539, Train_accy 75.60:  15%|█▌        | 3/20 [00:07<00:40,  2.38s/it]Task 4, Epoch 4/20 => Loss 0.340, Train_accy 79.20:  15%|█▌        | 3/20 [00:09<00:40,  2.38s/it]Task 4, Epoch 4/20 => Loss 0.340, Train_accy 79.20:  20%|██        | 4/20 [00:09<00:38,  2.39s/it]Task 4, Epoch 5/20 => Loss 0.221, Train_accy 84.40, Test_accy 78.01:  20%|██        | 4/20 [00:33<00:38,  2.39s/it]Task 4, Epoch 5/20 => Loss 0.221, Train_accy 84.40, Test_accy 78.01:  25%|██▌       | 5/20 [00:33<02:33, 10.20s/it]Task 4, Epoch 6/20 => Loss 0.130, Train_accy 88.80:  25%|██▌       | 5/20 [00:35<02:33, 10.20s/it]                 Task 4, Epoch 6/20 => Loss 0.130, Train_accy 88.80:  30%|███       | 6/20 [00:35<01:45,  7.54s/it]Task 4, Epoch 7/20 => Loss 0.101, Train_accy 93.60:  30%|███       | 6/20 [00:38<01:45,  7.54s/it]Task 4, Epoch 7/20 => Loss 0.101, Train_accy 93.60:  35%|███▌      | 7/20 [00:38<01:15,  5.84s/it]Task 4, Epoch 8/20 => Loss 0.101, Train_accy 94.00:  35%|███▌      | 7/20 [00:40<01:15,  5.84s/it]Task 4, Epoch 8/20 => Loss 0.101, Train_accy 94.00:  40%|████      | 8/20 [00:40<00:56,  4.73s/it]Task 4, Epoch 9/20 => Loss 0.089, Train_accy 94.40:  40%|████      | 8/20 [00:43<00:56,  4.73s/it]Task 4, Epoch 9/20 => Loss 0.089, Train_accy 94.40:  45%|████▌     | 9/20 [00:43<00:44,  4.00s/it]Task 4, Epoch 10/20 => Loss 0.041, Train_accy 96.00, Test_accy 78.43:  45%|████▌     | 9/20 [01:07<00:44,  4.00s/it]Task 4, Epoch 10/20 => Loss 0.041, Train_accy 96.00, Test_accy 78.43:  50%|█████     | 10/20 [01:07<01:41, 10.18s/it]Task 4, Epoch 11/20 => Loss 0.003, Train_accy 95.60:  50%|█████     | 10/20 [01:09<01:41, 10.18s/it]                 Task 4, Epoch 11/20 => Loss 0.003, Train_accy 95.60:  55%|█████▌    | 11/20 [01:09<01:10,  7.80s/it]Task 4, Epoch 12/20 => Loss 0.023, Train_accy 96.00:  55%|█████▌    | 11/20 [01:11<01:10,  7.80s/it]Task 4, Epoch 12/20 => Loss 0.023, Train_accy 96.00:  60%|██████    | 12/20 [01:11<00:49,  6.14s/it]Task 4, Epoch 13/20 => Loss 0.030, Train_accy 93.60:  60%|██████    | 12/20 [01:14<00:49,  6.14s/it]Task 4, Epoch 13/20 => Loss 0.030, Train_accy 93.60:  65%|██████▌   | 13/20 [01:14<00:34,  4.99s/it]Task 4, Epoch 14/20 => Loss 0.028, Train_accy 93.60:  65%|██████▌   | 13/20 [01:16<00:34,  4.99s/it]Task 4, Epoch 14/20 => Loss 0.028, Train_accy 93.60:  70%|███████   | 14/20 [01:16<00:25,  4.22s/it]Task 4, Epoch 15/20 => Loss -0.028, Train_accy 96.40, Test_accy 77.11:  70%|███████   | 14/20 [01:40<00:25,  4.22s/it]Task 4, Epoch 15/20 => Loss -0.028, Train_accy 96.40, Test_accy 77.11:  75%|███████▌  | 15/20 [01:40<00:51, 10.20s/it]Task 4, Epoch 16/20 => Loss -0.032, Train_accy 96.40:  75%|███████▌  | 15/20 [01:43<00:51, 10.20s/it]                 Task 4, Epoch 16/20 => Loss -0.032, Train_accy 96.40:  80%|████████  | 16/20 [01:43<00:31,  7.85s/it]Task 4, Epoch 17/20 => Loss -0.023, Train_accy 96.40:  80%|████████  | 16/20 [01:45<00:31,  7.85s/it]Task 4, Epoch 17/20 => Loss -0.023, Train_accy 96.40:  85%|████████▌ | 17/20 [01:45<00:18,  6.19s/it]Task 4, Epoch 18/20 => Loss -0.038, Train_accy 96.80:  85%|████████▌ | 17/20 [01:47<00:18,  6.19s/it]Task 4, Epoch 18/20 => Loss -0.038, Train_accy 96.80:  90%|█████████ | 18/20 [01:47<00:10,  5.03s/it]Task 4, Epoch 19/20 => Loss -0.061, Train_accy 96.40:  90%|█████████ | 18/20 [01:50<00:10,  5.03s/it]Task 4, Epoch 19/20 => Loss -0.061, Train_accy 96.40:  95%|█████████▌| 19/20 [01:50<00:04,  4.26s/it]Task 4, Epoch 20/20 => Loss -0.050, Train_accy 96.40, Test_accy 76.86:  95%|█████████▌| 19/20 [02:14<00:04,  4.26s/it]Task 4, Epoch 20/20 => Loss -0.050, Train_accy 96.40, Test_accy 76.86: 100%|██████████| 20/20 [02:14<00:00, 10.13s/it]Task 4, Epoch 20/20 => Loss -0.050, Train_accy 96.40, Test_accy 76.86: 100%|██████████| 20/20 [02:14<00:00,  6.70s/it]
2024-05-10 02:34:25,417 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.050, Train_accy 96.40, Test_accy 76.86
2024-05-10 02:34:47,011 [trainer.py] => No NME accuracy.
2024-05-10 02:34:47,012 [trainer.py] => CNN: {'total': 76.86, '00-04': 79.37, '05-09': 80.19, '10-14': 60.29, '15-19': 69.13, '20-24': 91.63, 'old': 70.35, 'new': 91.63}
2024-05-10 02:34:47,012 [trainer.py] => CNN top1 curve: [95.1, 97.09, 97.15, 92.76, 76.86]
2024-05-10 02:34:47,012 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.33, 97.78]

Average Accuracy (CNN): 91.79
2024-05-10 02:34:47,012 [trainer.py] => Average Accuracy (CNN): 91.79 

2024-05-10 02:34:47,012 [trainer.py] => Train Time: 761.1
2024-05-10 02:34:47,012 [trainer.py] => Test Time: 51.56 

2024-05-10 02:34:47,015 [trainer.py] => All params: 171739492
2024-05-10 02:34:47,017 [trainer.py] => Trainable params: 84530
2024-05-10 02:34:47,017 [l2p.py] => Learning on 25-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.555, Train_accy 27.83:   0%|          | 0/20 [00:01<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.555, Train_accy 27.83:   5%|▌         | 1/20 [00:01<00:29,  1.57s/it]Task 5, Epoch 2/20 => Loss 0.263, Train_accy 93.04:   5%|▌         | 1/20 [00:02<00:29,  1.57s/it]Task 5, Epoch 2/20 => Loss 0.263, Train_accy 93.04:  10%|█         | 2/20 [00:02<00:25,  1.44s/it]Task 5, Epoch 3/20 => Loss 0.016, Train_accy 100.00:  10%|█         | 2/20 [00:04<00:25,  1.44s/it]Task 5, Epoch 3/20 => Loss 0.016, Train_accy 100.00:  15%|█▌        | 3/20 [00:04<00:23,  1.39s/it]Task 5, Epoch 4/20 => Loss 0.002, Train_accy 96.52:  15%|█▌        | 3/20 [00:05<00:23,  1.39s/it] Task 5, Epoch 4/20 => Loss 0.002, Train_accy 96.52:  20%|██        | 4/20 [00:05<00:21,  1.35s/it]Task 5, Epoch 5/20 => Loss 0.010, Train_accy 99.13, Test_accy 71.72:  20%|██        | 4/20 [00:30<00:21,  1.35s/it]Task 5, Epoch 5/20 => Loss 0.010, Train_accy 99.13, Test_accy 71.72:  25%|██▌       | 5/20 [00:30<02:27,  9.86s/it]Task 5, Epoch 6/20 => Loss -0.064, Train_accy 100.00:  25%|██▌       | 5/20 [00:31<02:27,  9.86s/it]               Task 5, Epoch 6/20 => Loss -0.064, Train_accy 100.00:  30%|███       | 6/20 [00:31<01:37,  6.95s/it]Task 5, Epoch 7/20 => Loss -0.022, Train_accy 97.39:  30%|███       | 6/20 [00:33<01:37,  6.95s/it] Task 5, Epoch 7/20 => Loss -0.022, Train_accy 97.39:  35%|███▌      | 7/20 [00:33<01:06,  5.13s/it]Task 5, Epoch 8/20 => Loss 0.038, Train_accy 95.65:  35%|███▌      | 7/20 [00:34<01:06,  5.13s/it] Task 5, Epoch 8/20 => Loss 0.038, Train_accy 95.65:  40%|████      | 8/20 [00:34<00:47,  3.93s/it]Task 5, Epoch 9/20 => Loss -0.037, Train_accy 98.26:  40%|████      | 8/20 [00:35<00:47,  3.93s/it]Task 5, Epoch 9/20 => Loss -0.037, Train_accy 98.26:  45%|████▌     | 9/20 [00:35<00:34,  3.11s/it]Task 5, Epoch 10/20 => Loss -0.057, Train_accy 99.13, Test_accy 74.89:  45%|████▌     | 9/20 [01:00<00:34,  3.11s/it]Task 5, Epoch 10/20 => Loss -0.057, Train_accy 99.13, Test_accy 74.89:  50%|█████     | 10/20 [01:00<01:38,  9.81s/it]Task 5, Epoch 11/20 => Loss -0.083, Train_accy 100.00:  50%|█████     | 10/20 [01:02<01:38,  9.81s/it]                Task 5, Epoch 11/20 => Loss -0.083, Train_accy 100.00:  55%|█████▌    | 11/20 [01:02<01:05,  7.23s/it]Task 5, Epoch 12/20 => Loss -0.067, Train_accy 99.13:  55%|█████▌    | 11/20 [01:03<01:05,  7.23s/it] Task 5, Epoch 12/20 => Loss -0.067, Train_accy 99.13:  60%|██████    | 12/20 [01:03<00:43,  5.44s/it]Task 5, Epoch 13/20 => Loss -0.080, Train_accy 99.13:  60%|██████    | 12/20 [01:04<00:43,  5.44s/it]Task 5, Epoch 13/20 => Loss -0.080, Train_accy 99.13:  65%|██████▌   | 13/20 [01:04<00:29,  4.21s/it]Task 5, Epoch 14/20 => Loss -0.021, Train_accy 95.65:  65%|██████▌   | 13/20 [01:06<00:29,  4.21s/it]Task 5, Epoch 14/20 => Loss -0.021, Train_accy 95.65:  70%|███████   | 14/20 [01:06<00:20,  3.37s/it]Task 5, Epoch 15/20 => Loss -0.078, Train_accy 99.13, Test_accy 76.07:  70%|███████   | 14/20 [01:31<00:20,  3.37s/it]Task 5, Epoch 15/20 => Loss -0.078, Train_accy 99.13, Test_accy 76.07:  75%|███████▌  | 15/20 [01:31<00:49,  9.87s/it]Task 5, Epoch 16/20 => Loss -0.088, Train_accy 100.00:  75%|███████▌  | 15/20 [01:32<00:49,  9.87s/it]                Task 5, Epoch 16/20 => Loss -0.088, Train_accy 100.00:  80%|████████  | 16/20 [01:32<00:29,  7.31s/it]Task 5, Epoch 17/20 => Loss -0.064, Train_accy 98.26:  80%|████████  | 16/20 [01:33<00:29,  7.31s/it] Task 5, Epoch 17/20 => Loss -0.064, Train_accy 98.26:  85%|████████▌ | 17/20 [01:33<00:16,  5.52s/it]Task 5, Epoch 18/20 => Loss -0.071, Train_accy 100.00:  85%|████████▌ | 17/20 [01:35<00:16,  5.52s/it]Task 5, Epoch 18/20 => Loss -0.071, Train_accy 100.00:  90%|█████████ | 18/20 [01:35<00:08,  4.26s/it]Task 5, Epoch 19/20 => Loss -0.057, Train_accy 98.26:  90%|█████████ | 18/20 [01:36<00:08,  4.26s/it] Task 5, Epoch 19/20 => Loss -0.057, Train_accy 98.26:  95%|█████████▌| 19/20 [01:36<00:03,  3.40s/it]Task 5, Epoch 20/20 => Loss -0.066, Train_accy 99.13, Test_accy 75.87:  95%|█████████▌| 19/20 [02:01<00:03,  3.40s/it]Task 5, Epoch 20/20 => Loss -0.066, Train_accy 99.13, Test_accy 75.87: 100%|██████████| 20/20 [02:01<00:00,  9.79s/it]Task 5, Epoch 20/20 => Loss -0.066, Train_accy 99.13, Test_accy 75.87: 100%|██████████| 20/20 [02:01<00:00,  6.06s/it]
2024-05-10 02:36:48,273 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.066, Train_accy 99.13, Test_accy 75.87
2024-05-10 02:37:11,837 [trainer.py] => No NME accuracy.
2024-05-10 02:37:11,838 [trainer.py] => CNN: {'total': 75.87, '00-04': 52.45, '05-09': 80.56, '10-14': 58.82, '15-19': 69.27, '20-24': 91.31, '25-29': 87.83, 'old': 74.77, 'new': 87.83}
2024-05-10 02:37:11,838 [trainer.py] => CNN top1 curve: [95.1, 97.09, 97.15, 92.76, 76.86, 75.87]
2024-05-10 02:37:11,838 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.33, 97.78, 97.39]

Average Accuracy (CNN): 89.14
2024-05-10 02:37:11,838 [trainer.py] => Average Accuracy (CNN): 89.14 

2024-05-10 02:37:11,838 [trainer.py] => Train Time: 1003.59
2024-05-10 02:37:11,838 [trainer.py] => Test Time: 75.12 

2024-05-10 02:37:11,841 [trainer.py] => All params: 171739492
2024-05-10 02:37:11,844 [trainer.py] => Trainable params: 84530
2024-05-10 02:37:11,844 [l2p.py] => Learning on 30-35
  0%|          | 0/20 [00:00<?, ?it/s]Task 6, Epoch 1/20 => Loss 1.476, Train_accy 45.98:   0%|          | 0/20 [00:01<?, ?it/s]Task 6, Epoch 1/20 => Loss 1.476, Train_accy 45.98:   5%|▌         | 1/20 [00:01<00:35,  1.88s/it]Task 6, Epoch 2/20 => Loss 0.422, Train_accy 86.78:   5%|▌         | 1/20 [00:03<00:35,  1.88s/it]Task 6, Epoch 2/20 => Loss 0.422, Train_accy 86.78:  10%|█         | 2/20 [00:03<00:32,  1.80s/it]Task 6, Epoch 3/20 => Loss 0.103, Train_accy 91.38:  10%|█         | 2/20 [00:05<00:32,  1.80s/it]Task 6, Epoch 3/20 => Loss 0.103, Train_accy 91.38:  15%|█▌        | 3/20 [00:05<00:30,  1.80s/it]Task 6, Epoch 4/20 => Loss -0.095, Train_accy 99.43:  15%|█▌        | 3/20 [00:07<00:30,  1.80s/it]Task 6, Epoch 4/20 => Loss -0.095, Train_accy 99.43:  20%|██        | 4/20 [00:07<00:29,  1.82s/it]Task 6, Epoch 5/20 => Loss -0.049, Train_accy 97.13, Test_accy 65.77:  20%|██        | 4/20 [00:36<00:29,  1.82s/it]Task 6, Epoch 5/20 => Loss -0.049, Train_accy 97.13, Test_accy 65.77:  25%|██▌       | 5/20 [00:36<02:56, 11.76s/it]Task 6, Epoch 6/20 => Loss -0.114, Train_accy 99.43:  25%|██▌       | 5/20 [00:38<02:56, 11.76s/it]                 Task 6, Epoch 6/20 => Loss -0.114, Train_accy 99.43:  30%|███       | 6/20 [00:38<01:57,  8.39s/it]Task 6, Epoch 7/20 => Loss -0.101, Train_accy 98.85:  30%|███       | 6/20 [00:40<01:57,  8.39s/it]Task 6, Epoch 7/20 => Loss -0.101, Train_accy 98.85:  35%|███▌      | 7/20 [00:40<01:20,  6.22s/it]Task 6, Epoch 8/20 => Loss -0.111, Train_accy 100.00:  35%|███▌      | 7/20 [00:41<01:20,  6.22s/it]Task 6, Epoch 8/20 => Loss -0.111, Train_accy 100.00:  40%|████      | 8/20 [00:41<00:57,  4.78s/it]Task 6, Epoch 9/20 => Loss -0.116, Train_accy 98.85:  40%|████      | 8/20 [00:43<00:57,  4.78s/it] Task 6, Epoch 9/20 => Loss -0.116, Train_accy 98.85:  45%|████▌     | 9/20 [00:43<00:42,  3.83s/it]Task 6, Epoch 10/20 => Loss -0.112, Train_accy 99.43, Test_accy 65.68:  45%|████▌     | 9/20 [01:13<00:42,  3.83s/it]Task 6, Epoch 10/20 => Loss -0.112, Train_accy 99.43, Test_accy 65.68:  50%|█████     | 10/20 [01:13<01:57, 11.79s/it]Task 6, Epoch 11/20 => Loss -0.130, Train_accy 98.85:  50%|█████     | 10/20 [01:15<01:57, 11.79s/it]                 Task 6, Epoch 11/20 => Loss -0.130, Train_accy 98.85:  55%|█████▌    | 11/20 [01:15<01:18,  8.74s/it]Task 6, Epoch 12/20 => Loss -0.123, Train_accy 99.43:  55%|█████▌    | 11/20 [01:16<01:18,  8.74s/it]Task 6, Epoch 12/20 => Loss -0.123, Train_accy 99.43:  60%|██████    | 12/20 [01:16<00:52,  6.61s/it]Task 6, Epoch 13/20 => Loss -0.138, Train_accy 100.00:  60%|██████    | 12/20 [01:18<00:52,  6.61s/it]Task 6, Epoch 13/20 => Loss -0.138, Train_accy 100.00:  65%|██████▌   | 13/20 [01:18<00:35,  5.13s/it]Task 6, Epoch 14/20 => Loss -0.142, Train_accy 100.00:  65%|██████▌   | 13/20 [01:20<00:35,  5.13s/it]Task 6, Epoch 14/20 => Loss -0.142, Train_accy 100.00:  70%|███████   | 14/20 [01:20<00:24,  4.11s/it]Task 6, Epoch 15/20 => Loss -0.143, Train_accy 100.00, Test_accy 63.88:  70%|███████   | 14/20 [01:49<00:24,  4.11s/it]Task 6, Epoch 15/20 => Loss -0.143, Train_accy 100.00, Test_accy 63.88:  75%|███████▌  | 15/20 [01:49<00:58, 11.76s/it]Task 6, Epoch 16/20 => Loss -0.122, Train_accy 98.85:  75%|███████▌  | 15/20 [01:51<00:58, 11.76s/it]                  Task 6, Epoch 16/20 => Loss -0.122, Train_accy 98.85:  80%|████████  | 16/20 [01:51<00:35,  8.76s/it]Task 6, Epoch 17/20 => Loss -0.151, Train_accy 100.00:  80%|████████  | 16/20 [01:53<00:35,  8.76s/it]Task 6, Epoch 17/20 => Loss -0.151, Train_accy 100.00:  85%|████████▌ | 17/20 [01:53<00:20,  6.68s/it]Task 6, Epoch 18/20 => Loss -0.150, Train_accy 100.00:  85%|████████▌ | 17/20 [01:55<00:20,  6.68s/it]Task 6, Epoch 18/20 => Loss -0.150, Train_accy 100.00:  90%|█████████ | 18/20 [01:55<00:10,  5.23s/it]Task 6, Epoch 19/20 => Loss -0.153, Train_accy 100.00:  90%|█████████ | 18/20 [01:57<00:10,  5.23s/it]Task 6, Epoch 19/20 => Loss -0.153, Train_accy 100.00:  95%|█████████▌| 19/20 [01:57<00:04,  4.20s/it]Task 6, Epoch 20/20 => Loss -0.116, Train_accy 98.85, Test_accy 63.11:  95%|█████████▌| 19/20 [02:26<00:04,  4.20s/it]Task 6, Epoch 20/20 => Loss -0.116, Train_accy 98.85, Test_accy 63.11: 100%|██████████| 20/20 [02:26<00:00, 11.82s/it]Task 6, Epoch 20/20 => Loss -0.116, Train_accy 98.85, Test_accy 63.11: 100%|██████████| 20/20 [02:26<00:00,  7.34s/it]
2024-05-10 02:39:38,580 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.116, Train_accy 98.85, Test_accy 63.11
2024-05-10 02:40:06,537 [trainer.py] => No NME accuracy.
2024-05-10 02:40:06,537 [trainer.py] => CNN: {'total': 63.11, '00-04': 50.0, '05-09': 80.37, '10-14': 36.6, '15-19': 54.51, '20-24': 53.63, '25-29': 79.89, '30-34': 98.03, 'old': 56.79, 'new': 98.03}
2024-05-10 02:40:06,538 [trainer.py] => CNN top1 curve: [95.1, 97.09, 97.15, 92.76, 76.86, 75.87, 63.11]
2024-05-10 02:40:06,538 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.33, 97.78, 97.39, 97.3]

Average Accuracy (CNN): 85.42
2024-05-10 02:40:06,538 [trainer.py] => Average Accuracy (CNN): 85.42 

2024-05-10 02:40:06,538 [trainer.py] => Train Time: 1297.04
2024-05-10 02:40:06,538 [trainer.py] => Test Time: 103.08000000000001 

2024-05-10 02:40:06,541 [trainer.py] => All params: 171739492
2024-05-10 02:40:06,543 [trainer.py] => Trainable params: 84530
2024-05-10 02:40:06,543 [l2p.py] => Learning on 35-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.300, Train_accy 48.84:   0%|          | 0/20 [00:01<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.300, Train_accy 48.84:   5%|▌         | 1/20 [00:01<00:27,  1.43s/it]Task 7, Epoch 2/20 => Loss 0.236, Train_accy 89.92:   5%|▌         | 1/20 [00:02<00:27,  1.43s/it]Task 7, Epoch 2/20 => Loss 0.236, Train_accy 89.92:  10%|█         | 2/20 [00:02<00:25,  1.42s/it]Task 7, Epoch 3/20 => Loss 0.095, Train_accy 91.47:  10%|█         | 2/20 [00:04<00:25,  1.42s/it]Task 7, Epoch 3/20 => Loss 0.095, Train_accy 91.47:  15%|█▌        | 3/20 [00:04<00:25,  1.47s/it]Task 7, Epoch 4/20 => Loss -0.008, Train_accy 95.35:  15%|█▌        | 3/20 [00:05<00:25,  1.47s/it]Task 7, Epoch 4/20 => Loss -0.008, Train_accy 95.35:  20%|██        | 4/20 [00:05<00:23,  1.47s/it]Task 7, Epoch 5/20 => Loss -0.059, Train_accy 98.45, Test_accy 57.84:  20%|██        | 4/20 [00:37<00:23,  1.47s/it]Task 7, Epoch 5/20 => Loss -0.059, Train_accy 98.45, Test_accy 57.84:  25%|██▌       | 5/20 [00:37<03:04, 12.27s/it]Task 7, Epoch 6/20 => Loss -0.089, Train_accy 97.67:  25%|██▌       | 5/20 [00:38<03:04, 12.27s/it]                 Task 7, Epoch 6/20 => Loss -0.089, Train_accy 97.67:  30%|███       | 6/20 [00:38<02:00,  8.61s/it]Task 7, Epoch 7/20 => Loss -0.027, Train_accy 95.35:  30%|███       | 6/20 [00:40<02:00,  8.61s/it]Task 7, Epoch 7/20 => Loss -0.027, Train_accy 95.35:  35%|███▌      | 7/20 [00:40<01:21,  6.26s/it]Task 7, Epoch 8/20 => Loss -0.044, Train_accy 97.67:  35%|███▌      | 7/20 [00:41<01:21,  6.26s/it]Task 7, Epoch 8/20 => Loss -0.044, Train_accy 97.67:  40%|████      | 8/20 [00:41<00:56,  4.73s/it]Task 7, Epoch 9/20 => Loss -0.078, Train_accy 97.67:  40%|████      | 8/20 [00:43<00:56,  4.73s/it]Task 7, Epoch 9/20 => Loss -0.078, Train_accy 97.67:  45%|████▌     | 9/20 [00:43<00:40,  3.72s/it]Task 7, Epoch 10/20 => Loss -0.099, Train_accy 98.45, Test_accy 60.94:  45%|████▌     | 9/20 [01:14<00:40,  3.72s/it]Task 7, Epoch 10/20 => Loss -0.099, Train_accy 98.45, Test_accy 60.94:  50%|█████     | 10/20 [01:14<02:02, 12.25s/it]Task 7, Epoch 11/20 => Loss -0.089, Train_accy 98.45:  50%|█████     | 10/20 [01:16<02:02, 12.25s/it]                 Task 7, Epoch 11/20 => Loss -0.089, Train_accy 98.45:  55%|█████▌    | 11/20 [01:16<01:20,  9.00s/it]Task 7, Epoch 12/20 => Loss -0.119, Train_accy 99.22:  55%|█████▌    | 11/20 [01:17<01:20,  9.00s/it]Task 7, Epoch 12/20 => Loss -0.119, Train_accy 99.22:  60%|██████    | 12/20 [01:17<00:53,  6.71s/it]Task 7, Epoch 13/20 => Loss -0.113, Train_accy 98.45:  60%|██████    | 12/20 [01:19<00:53,  6.71s/it]Task 7, Epoch 13/20 => Loss -0.113, Train_accy 98.45:  65%|██████▌   | 13/20 [01:19<00:36,  5.14s/it]Task 7, Epoch 14/20 => Loss -0.120, Train_accy 98.45:  65%|██████▌   | 13/20 [01:20<00:36,  5.14s/it]Task 7, Epoch 14/20 => Loss -0.120, Train_accy 98.45:  70%|███████   | 14/20 [01:20<00:24,  4.01s/it]Task 7, Epoch 15/20 => Loss -0.097, Train_accy 98.45, Test_accy 62.41:  70%|███████   | 14/20 [01:52<00:24,  4.01s/it]Task 7, Epoch 15/20 => Loss -0.097, Train_accy 98.45, Test_accy 62.41:  75%|███████▌  | 15/20 [01:52<01:01, 12.33s/it]Task 7, Epoch 16/20 => Loss -0.130, Train_accy 100.00:  75%|███████▌  | 15/20 [01:53<01:01, 12.33s/it]                Task 7, Epoch 16/20 => Loss -0.130, Train_accy 100.00:  80%|████████  | 16/20 [01:53<00:36,  9.04s/it]Task 7, Epoch 17/20 => Loss -0.141, Train_accy 100.00:  80%|████████  | 16/20 [01:54<00:36,  9.04s/it]Task 7, Epoch 17/20 => Loss -0.141, Train_accy 100.00:  85%|████████▌ | 17/20 [01:54<00:20,  6.76s/it]Task 7, Epoch 18/20 => Loss -0.112, Train_accy 99.22:  85%|████████▌ | 17/20 [01:56<00:20,  6.76s/it] Task 7, Epoch 18/20 => Loss -0.112, Train_accy 99.22:  90%|█████████ | 18/20 [01:56<00:10,  5.15s/it]Task 7, Epoch 19/20 => Loss -0.146, Train_accy 100.00:  90%|█████████ | 18/20 [01:57<00:10,  5.15s/it]Task 7, Epoch 19/20 => Loss -0.146, Train_accy 100.00:  95%|█████████▌| 19/20 [01:57<00:04,  4.03s/it]Task 7, Epoch 20/20 => Loss -0.138, Train_accy 100.00, Test_accy 61.48:  95%|█████████▌| 19/20 [02:29<00:04,  4.03s/it]Task 7, Epoch 20/20 => Loss -0.138, Train_accy 100.00, Test_accy 61.48: 100%|██████████| 20/20 [02:29<00:00, 12.20s/it]Task 7, Epoch 20/20 => Loss -0.138, Train_accy 100.00, Test_accy 61.48: 100%|██████████| 20/20 [02:29<00:00,  7.45s/it]
2024-05-10 02:42:35,595 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.138, Train_accy 100.00, Test_accy 61.48
2024-05-10 02:43:05,410 [trainer.py] => No NME accuracy.
2024-05-10 02:43:05,410 [trainer.py] => CNN: {'total': 61.48, '00-04': 51.75, '05-09': 80.74, '10-14': 34.8, '15-19': 50.32, '20-24': 51.95, '25-29': 80.16, '30-34': 97.9, '35-39': 61.05, 'old': 61.52, 'new': 61.05}
2024-05-10 02:43:05,410 [trainer.py] => CNN top1 curve: [95.1, 97.09, 97.15, 92.76, 76.86, 75.87, 63.11, 61.48]
2024-05-10 02:43:05,410 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.33, 97.78, 97.39, 97.3, 96.6]

Average Accuracy (CNN): 82.43
2024-05-10 02:43:05,411 [trainer.py] => Average Accuracy (CNN): 82.43 

2024-05-10 02:43:05,411 [trainer.py] => Train Time: 1595.1299999999999
2024-05-10 02:43:05,411 [trainer.py] => Test Time: 132.89000000000001 

2024-05-10 02:43:05,412 [trainer.py] => All params: 171739492
2024-05-10 02:43:05,413 [trainer.py] => Trainable params: 84530
2024-05-10 02:43:05,413 [l2p.py] => Learning on 40-45
  0%|          | 0/20 [00:00<?, ?it/s]Task 8, Epoch 1/20 => Loss 1.080, Train_accy 51.55:   0%|          | 0/20 [00:02<?, ?it/s]Task 8, Epoch 1/20 => Loss 1.080, Train_accy 51.55:   5%|▌         | 1/20 [00:02<00:54,  2.86s/it]Task 8, Epoch 2/20 => Loss 0.193, Train_accy 87.63:   5%|▌         | 1/20 [00:05<00:54,  2.86s/it]Task 8, Epoch 2/20 => Loss 0.193, Train_accy 87.63:  10%|█         | 2/20 [00:05<00:50,  2.80s/it]Task 8, Epoch 3/20 => Loss 0.098, Train_accy 89.00:  10%|█         | 2/20 [00:08<00:50,  2.80s/it]Task 8, Epoch 3/20 => Loss 0.098, Train_accy 89.00:  15%|█▌        | 3/20 [00:08<00:47,  2.78s/it]Task 8, Epoch 4/20 => Loss -0.061, Train_accy 94.85:  15%|█▌        | 3/20 [00:11<00:47,  2.78s/it]Task 8, Epoch 4/20 => Loss -0.061, Train_accy 94.85:  20%|██        | 4/20 [00:11<00:43,  2.72s/it]Task 8, Epoch 5/20 => Loss 0.033, Train_accy 95.53, Test_accy 60.31:  20%|██        | 4/20 [00:51<00:43,  2.72s/it]Task 8, Epoch 5/20 => Loss 0.033, Train_accy 95.53, Test_accy 60.31:  25%|██▌       | 5/20 [00:51<04:05, 16.35s/it]Task 8, Epoch 6/20 => Loss -0.039, Train_accy 92.78:  25%|██▌       | 5/20 [00:54<04:05, 16.35s/it]                Task 8, Epoch 6/20 => Loss -0.039, Train_accy 92.78:  30%|███       | 6/20 [00:54<02:43, 11.71s/it]Task 8, Epoch 7/20 => Loss -0.124, Train_accy 97.94:  30%|███       | 6/20 [00:56<02:43, 11.71s/it]Task 8, Epoch 7/20 => Loss -0.124, Train_accy 97.94:  35%|███▌      | 7/20 [00:56<01:53,  8.75s/it]Task 8, Epoch 8/20 => Loss -0.105, Train_accy 95.19:  35%|███▌      | 7/20 [00:59<01:53,  8.75s/it]Task 8, Epoch 8/20 => Loss -0.105, Train_accy 95.19:  40%|████      | 8/20 [00:59<01:22,  6.85s/it]Task 8, Epoch 9/20 => Loss -0.122, Train_accy 98.28:  40%|████      | 8/20 [01:02<01:22,  6.85s/it]Task 8, Epoch 9/20 => Loss -0.122, Train_accy 98.28:  45%|████▌     | 9/20 [01:02<01:01,  5.55s/it]Task 8, Epoch 10/20 => Loss -0.160, Train_accy 98.63, Test_accy 60.14:  45%|████▌     | 9/20 [01:42<01:01,  5.55s/it]Task 8, Epoch 10/20 => Loss -0.160, Train_accy 98.63, Test_accy 60.14:  50%|█████     | 10/20 [01:42<02:42, 16.26s/it]Task 8, Epoch 11/20 => Loss -0.146, Train_accy 98.28:  50%|█████     | 10/20 [01:45<02:42, 16.26s/it]                 Task 8, Epoch 11/20 => Loss -0.146, Train_accy 98.28:  55%|█████▌    | 11/20 [01:45<01:49, 12.15s/it]Task 8, Epoch 12/20 => Loss -0.151, Train_accy 97.94:  55%|█████▌    | 11/20 [01:48<01:49, 12.15s/it]Task 8, Epoch 12/20 => Loss -0.151, Train_accy 97.94:  60%|██████    | 12/20 [01:48<01:14,  9.29s/it]Task 8, Epoch 13/20 => Loss -0.171, Train_accy 98.28:  60%|██████    | 12/20 [01:50<01:14,  9.29s/it]Task 8, Epoch 13/20 => Loss -0.171, Train_accy 98.28:  65%|██████▌   | 13/20 [01:50<00:50,  7.28s/it]Task 8, Epoch 14/20 => Loss -0.154, Train_accy 97.94:  65%|██████▌   | 13/20 [01:53<00:50,  7.28s/it]Task 8, Epoch 14/20 => Loss -0.154, Train_accy 97.94:  70%|███████   | 14/20 [01:53<00:35,  5.87s/it]Task 8, Epoch 15/20 => Loss -0.143, Train_accy 97.59, Test_accy 61.15:  70%|███████   | 14/20 [02:33<00:35,  5.87s/it]Task 8, Epoch 15/20 => Loss -0.143, Train_accy 97.59, Test_accy 61.15:  75%|███████▌  | 15/20 [02:33<01:21, 16.26s/it]Task 8, Epoch 16/20 => Loss -0.175, Train_accy 99.31:  75%|███████▌  | 15/20 [02:36<01:21, 16.26s/it]                 Task 8, Epoch 16/20 => Loss -0.175, Train_accy 99.31:  80%|████████  | 16/20 [02:36<00:48, 12.18s/it]Task 8, Epoch 17/20 => Loss -0.196, Train_accy 98.97:  80%|████████  | 16/20 [02:39<00:48, 12.18s/it]Task 8, Epoch 17/20 => Loss -0.196, Train_accy 98.97:  85%|████████▌ | 17/20 [02:39<00:28,  9.34s/it]Task 8, Epoch 18/20 => Loss -0.142, Train_accy 96.91:  85%|████████▌ | 17/20 [02:41<00:28,  9.34s/it]Task 8, Epoch 18/20 => Loss -0.142, Train_accy 96.91:  90%|█████████ | 18/20 [02:41<00:14,  7.34s/it]Task 8, Epoch 19/20 => Loss -0.202, Train_accy 99.66:  90%|█████████ | 18/20 [02:44<00:14,  7.34s/it]Task 8, Epoch 19/20 => Loss -0.202, Train_accy 99.66:  95%|█████████▌| 19/20 [02:44<00:05,  5.99s/it]Task 8, Epoch 20/20 => Loss -0.203, Train_accy 98.63, Test_accy 60.87:  95%|█████████▌| 19/20 [03:25<00:05,  5.99s/it]Task 8, Epoch 20/20 => Loss -0.203, Train_accy 98.63, Test_accy 60.87: 100%|██████████| 20/20 [03:25<00:00, 16.28s/it]Task 8, Epoch 20/20 => Loss -0.203, Train_accy 98.63, Test_accy 60.87: 100%|██████████| 20/20 [03:25<00:00, 10.25s/it]
2024-05-10 02:46:30,430 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.203, Train_accy 98.63, Test_accy 60.87
2024-05-10 02:47:08,183 [trainer.py] => No NME accuracy.
2024-05-10 02:47:08,184 [trainer.py] => CNN: {'total': 60.87, '00-04': 50.35, '05-09': 79.81, '10-14': 26.47, '15-19': 34.14, '20-24': 44.7, '25-29': 79.63, '30-34': 97.16, '35-39': 60.36, '40-44': 84.22, 'old': 54.68, 'new': 84.22}
2024-05-10 02:47:08,184 [trainer.py] => CNN top1 curve: [95.1, 97.09, 97.15, 92.76, 76.86, 75.87, 63.11, 61.48, 60.87]
2024-05-10 02:47:08,184 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.33, 97.78, 97.39, 97.3, 96.6, 94.21]

Average Accuracy (CNN): 80.03
2024-05-10 02:47:08,184 [trainer.py] => Average Accuracy (CNN): 80.03 

2024-05-10 02:47:08,184 [trainer.py] => Train Time: 2005.1499999999999
2024-05-10 02:47:08,184 [trainer.py] => Test Time: 170.64000000000001 

2024-05-10 02:47:08,187 [trainer.py] => All params: 171739492
2024-05-10 02:47:08,189 [trainer.py] => Trainable params: 84530
2024-05-10 02:47:08,189 [l2p.py] => Learning on 45-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 9, Epoch 1/20 => Loss 0.906, Train_accy 62.60:   0%|          | 0/20 [00:02<?, ?it/s]Task 9, Epoch 1/20 => Loss 0.906, Train_accy 62.60:   5%|▌         | 1/20 [00:02<00:46,  2.44s/it]Task 9, Epoch 2/20 => Loss 0.065, Train_accy 90.46:   5%|▌         | 1/20 [00:04<00:46,  2.44s/it]Task 9, Epoch 2/20 => Loss 0.065, Train_accy 90.46:  10%|█         | 2/20 [00:04<00:44,  2.48s/it]Task 9, Epoch 3/20 => Loss -0.152, Train_accy 97.33:  10%|█         | 2/20 [00:07<00:44,  2.48s/it]Task 9, Epoch 3/20 => Loss -0.152, Train_accy 97.33:  15%|█▌        | 3/20 [00:07<00:41,  2.45s/it]Task 9, Epoch 4/20 => Loss -0.136, Train_accy 96.18:  15%|█▌        | 3/20 [00:09<00:41,  2.45s/it]Task 9, Epoch 4/20 => Loss -0.136, Train_accy 96.18:  20%|██        | 4/20 [00:09<00:38,  2.44s/it]Task 9, Epoch 5/20 => Loss -0.174, Train_accy 98.09, Test_accy 55.78:  20%|██        | 4/20 [00:57<00:38,  2.44s/it]Task 9, Epoch 5/20 => Loss -0.174, Train_accy 98.09, Test_accy 55.78:  25%|██▌       | 5/20 [00:57<04:39, 18.61s/it]Task 9, Epoch 6/20 => Loss -0.169, Train_accy 97.33:  25%|██▌       | 5/20 [00:59<04:39, 18.61s/it]                 Task 9, Epoch 6/20 => Loss -0.169, Train_accy 97.33:  30%|███       | 6/20 [00:59<03:04, 13.16s/it]Task 9, Epoch 7/20 => Loss -0.106, Train_accy 96.56:  30%|███       | 6/20 [01:02<03:04, 13.16s/it]Task 9, Epoch 7/20 => Loss -0.106, Train_accy 96.56:  35%|███▌      | 7/20 [01:02<02:05,  9.64s/it]Task 9, Epoch 8/20 => Loss -0.179, Train_accy 97.33:  35%|███▌      | 7/20 [01:04<02:05,  9.64s/it]Task 9, Epoch 8/20 => Loss -0.179, Train_accy 97.33:  40%|████      | 8/20 [01:04<01:28,  7.37s/it]Task 9, Epoch 9/20 => Loss -0.175, Train_accy 98.47:  40%|████      | 8/20 [01:06<01:28,  7.37s/it]Task 9, Epoch 9/20 => Loss -0.175, Train_accy 98.47:  45%|████▌     | 9/20 [01:07<01:04,  5.83s/it]Task 9, Epoch 10/20 => Loss -0.199, Train_accy 98.09, Test_accy 53.58:  45%|████▌     | 9/20 [01:54<01:04,  5.83s/it]Task 9, Epoch 10/20 => Loss -0.199, Train_accy 98.09, Test_accy 53.58:  50%|█████     | 10/20 [01:54<03:05, 18.56s/it]Task 9, Epoch 11/20 => Loss -0.198, Train_accy 98.47:  50%|█████     | 10/20 [01:56<03:05, 18.56s/it]                 Task 9, Epoch 11/20 => Loss -0.198, Train_accy 98.47:  55%|█████▌    | 11/20 [01:56<02:02, 13.65s/it]Task 9, Epoch 12/20 => Loss -0.198, Train_accy 99.24:  55%|█████▌    | 11/20 [01:58<02:02, 13.65s/it]Task 9, Epoch 12/20 => Loss -0.198, Train_accy 99.24:  60%|██████    | 12/20 [01:58<01:21, 10.23s/it]Task 9, Epoch 13/20 => Loss -0.226, Train_accy 98.85:  60%|██████    | 12/20 [02:01<01:21, 10.23s/it]Task 9, Epoch 13/20 => Loss -0.226, Train_accy 98.85:  65%|██████▌   | 13/20 [02:01<00:55,  7.91s/it]Task 9, Epoch 14/20 => Loss -0.232, Train_accy 99.24:  65%|██████▌   | 13/20 [02:03<00:55,  7.91s/it]Task 9, Epoch 14/20 => Loss -0.232, Train_accy 99.24:  70%|███████   | 14/20 [02:03<00:37,  6.25s/it]Task 9, Epoch 15/20 => Loss -0.212, Train_accy 97.71, Test_accy 55.64:  70%|███████   | 14/20 [02:50<00:37,  6.25s/it]Task 9, Epoch 15/20 => Loss -0.212, Train_accy 97.71, Test_accy 55.64:  75%|███████▌  | 15/20 [02:50<01:32, 18.53s/it]Task 9, Epoch 16/20 => Loss -0.228, Train_accy 98.85:  75%|███████▌  | 15/20 [02:53<01:32, 18.53s/it]                 Task 9, Epoch 16/20 => Loss -0.228, Train_accy 98.85:  80%|████████  | 16/20 [02:53<00:54, 13.68s/it]Task 9, Epoch 17/20 => Loss -0.190, Train_accy 97.71:  80%|████████  | 16/20 [02:55<00:54, 13.68s/it]Task 9, Epoch 17/20 => Loss -0.190, Train_accy 97.71:  85%|████████▌ | 17/20 [02:55<00:30, 10.31s/it]Task 9, Epoch 18/20 => Loss -0.243, Train_accy 100.00:  85%|████████▌ | 17/20 [02:58<00:30, 10.31s/it]Task 9, Epoch 18/20 => Loss -0.243, Train_accy 100.00:  90%|█████████ | 18/20 [02:58<00:15,  7.95s/it]Task 9, Epoch 19/20 => Loss -0.232, Train_accy 98.85:  90%|█████████ | 18/20 [03:00<00:15,  7.95s/it] Task 9, Epoch 19/20 => Loss -0.232, Train_accy 98.85:  95%|█████████▌| 19/20 [03:00<00:06,  6.32s/it]Task 9, Epoch 20/20 => Loss -0.170, Train_accy 96.56, Test_accy 54.39:  95%|█████████▌| 19/20 [03:47<00:06,  6.32s/it]Task 9, Epoch 20/20 => Loss -0.170, Train_accy 96.56, Test_accy 54.39: 100%|██████████| 20/20 [03:47<00:00, 18.57s/it]Task 9, Epoch 20/20 => Loss -0.170, Train_accy 96.56, Test_accy 54.39: 100%|██████████| 20/20 [03:47<00:00, 11.40s/it]
2024-05-10 02:50:56,165 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.170, Train_accy 96.56, Test_accy 54.39
2024-05-10 02:51:40,763 [trainer.py] => No NME accuracy.
2024-05-10 02:51:40,763 [trainer.py] => CNN: {'total': 54.39, '00-04': 50.0, '05-09': 79.26, '10-14': 16.5, '15-19': 29.6, '20-24': 33.47, '25-29': 67.2, '30-34': 80.64, '35-39': 37.13, '40-44': 68.9, '45-49': 77.49, 'old': 50.03, 'new': 77.49}
2024-05-10 02:51:40,763 [trainer.py] => CNN top1 curve: [95.1, 97.09, 97.15, 92.76, 76.86, 75.87, 63.11, 61.48, 60.87, 54.39]
2024-05-10 02:51:40,763 [trainer.py] => CNN top5 curve: [100.0, 99.39, 99.58, 99.33, 97.78, 97.39, 97.3, 96.6, 94.21, 91.07]

Average Accuracy (CNN): 77.47
2024-05-10 02:51:40,764 [trainer.py] => Average Accuracy (CNN): 77.47 

2024-05-10 02:51:40,764 [trainer.py] => Train Time: 2461.0799999999995
2024-05-10 02:51:40,764 [trainer.py] => Test Time: 215.24 

Accuracy Matrix (CNN):
[[95.1  92.31 87.76 87.76 79.37 52.45 50.   51.75 50.35 50.  ]
 [ 0.   99.63 99.44 99.07 80.19 80.56 80.37 80.74 79.81 79.26]
 [ 0.    0.   99.51 92.97 60.29 58.82 36.6  34.8  26.47 16.5 ]
 [ 0.    0.    0.   91.27 69.13 69.27 54.51 50.32 34.14 29.6 ]
 [ 0.    0.    0.    0.   91.63 91.31 53.63 51.95 44.7  33.47]
 [ 0.    0.    0.    0.    0.   87.83 79.89 80.16 79.63 67.2 ]
 [ 0.    0.    0.    0.    0.    0.   98.03 97.9  97.16 80.64]
 [ 0.    0.    0.    0.    0.    0.    0.   61.05 60.36 37.13]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   84.22 68.9 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   77.49]]
2024-05-10 02:51:40,765 [trainer.py] => Forgetting (CNN): 38.39666666666667
2024-05-10 02:51:44,650 [trainer.py] => config: ./exps/dualprompt_vtab_B0_Inc10.json
2024-05-10 02:51:44,650 [trainer.py] => prefix:  
2024-05-10 02:51:44,650 [trainer.py] => dataset: vtab
2024-05-10 02:51:44,650 [trainer.py] => memory_size: 0
2024-05-10 02:51:44,650 [trainer.py] => memory_per_class: 0
2024-05-10 02:51:44,650 [trainer.py] => fixed_memory: False
2024-05-10 02:51:44,650 [trainer.py] => shuffle: True
2024-05-10 02:51:44,650 [trainer.py] => init_cls: 5
2024-05-10 02:51:44,650 [trainer.py] => increment: 5
2024-05-10 02:51:44,650 [trainer.py] => model_name: dualprompt
2024-05-10 02:51:44,650 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-05-10 02:51:44,650 [trainer.py] => get_original_backbone: True
2024-05-10 02:51:44,650 [trainer.py] => device: [device(type='cuda', index=4)]
2024-05-10 02:51:44,650 [trainer.py] => seed: 1993
2024-05-10 02:51:44,650 [trainer.py] => tuned_epoch: 20
2024-05-10 02:51:44,650 [trainer.py] => init_lr: 0.001
2024-05-10 02:51:44,650 [trainer.py] => batch_size: 48
2024-05-10 02:51:44,651 [trainer.py] => weight_decay: 0
2024-05-10 02:51:44,651 [trainer.py] => min_lr: 1e-05
2024-05-10 02:51:44,651 [trainer.py] => optimizer: adam
2024-05-10 02:51:44,651 [trainer.py] => scheduler: constant
2024-05-10 02:51:44,651 [trainer.py] => reinit_optimizer: True
2024-05-10 02:51:44,651 [trainer.py] => global_pool: token
2024-05-10 02:51:44,651 [trainer.py] => head_type: token
2024-05-10 02:51:44,651 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-05-10 02:51:44,651 [trainer.py] => pretrained: True
2024-05-10 02:51:44,651 [trainer.py] => drop: 0.0
2024-05-10 02:51:44,651 [trainer.py] => drop_path: 0.0
2024-05-10 02:51:44,651 [trainer.py] => use_g_prompt: True
2024-05-10 02:51:44,651 [trainer.py] => g_prompt_length: 5
2024-05-10 02:51:44,651 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-05-10 02:51:44,651 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-05-10 02:51:44,651 [trainer.py] => use_e_prompt: True
2024-05-10 02:51:44,651 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-05-10 02:51:44,651 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-05-10 02:51:44,651 [trainer.py] => prompt_pool: True
2024-05-10 02:51:44,651 [trainer.py] => size: 10
2024-05-10 02:51:44,651 [trainer.py] => length: 5
2024-05-10 02:51:44,651 [trainer.py] => top_k: 1
2024-05-10 02:51:44,652 [trainer.py] => initializer: uniform
2024-05-10 02:51:44,652 [trainer.py] => prompt_key: True
2024-05-10 02:51:44,652 [trainer.py] => prompt_key_init: uniform
2024-05-10 02:51:44,652 [trainer.py] => use_prompt_mask: True
2024-05-10 02:51:44,652 [trainer.py] => shared_prompt_pool: True
2024-05-10 02:51:44,652 [trainer.py] => shared_prompt_key: False
2024-05-10 02:51:44,652 [trainer.py] => batchwise_prompt: True
2024-05-10 02:51:44,652 [trainer.py] => embedding_key: cls
2024-05-10 02:51:44,652 [trainer.py] => predefined_key: 
2024-05-10 02:51:44,652 [trainer.py] => pull_constraint: True
2024-05-10 02:51:44,652 [trainer.py] => pull_constraint_coeff: 0.1
2024-05-10 02:51:44,652 [trainer.py] => same_key_value: False
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-05-10 02:51:44,697 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-05-10 02:51:51,084 [dualprompt.py] => 86,090,546 model total parameters.
2024-05-10 02:51:51,084 [dualprompt.py] => 291,890 model training parameters.
2024-05-10 02:51:51,085 [dualprompt.py] => g_prompt: 15360
2024-05-10 02:51:51,085 [dualprompt.py] => e_prompt.prompt: 230400
2024-05-10 02:51:51,085 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-05-10 02:51:51,085 [dualprompt.py] => head.weight: 38400
2024-05-10 02:51:51,085 [dualprompt.py] => head.bias: 50
2024-05-10 02:51:51,086 [trainer.py] => All params: 171927652
2024-05-10 02:51:51,087 [trainer.py] => Trainable params: 291890
2024-05-10 02:51:51,087 [dualprompt.py] => Learning on 0-5
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.640, Train_accy 16.48:   0%|          | 0/20 [00:01<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.640, Train_accy 16.48:   5%|▌         | 1/20 [00:01<00:33,  1.77s/it]Task 0, Epoch 2/20 => Loss 1.452, Train_accy 36.26:   5%|▌         | 1/20 [00:02<00:33,  1.77s/it]Task 0, Epoch 2/20 => Loss 1.452, Train_accy 36.26:  10%|█         | 2/20 [00:02<00:23,  1.33s/it]Task 0, Epoch 3/20 => Loss 0.748, Train_accy 80.22:  10%|█         | 2/20 [00:03<00:23,  1.33s/it]Task 0, Epoch 3/20 => Loss 0.748, Train_accy 80.22:  15%|█▌        | 3/20 [00:03<00:20,  1.18s/it]Task 0, Epoch 4/20 => Loss 0.422, Train_accy 91.21:  15%|█▌        | 3/20 [00:04<00:20,  1.18s/it]Task 0, Epoch 4/20 => Loss 0.422, Train_accy 91.21:  20%|██        | 4/20 [00:04<00:18,  1.14s/it]Task 0, Epoch 5/20 => Loss 0.290, Train_accy 93.41, Test_accy 93.71:  20%|██        | 4/20 [00:08<00:18,  1.14s/it]Task 0, Epoch 5/20 => Loss 0.290, Train_accy 93.41, Test_accy 93.71:  25%|██▌       | 5/20 [00:08<00:28,  1.88s/it]Task 0, Epoch 6/20 => Loss 0.211, Train_accy 93.41:  25%|██▌       | 5/20 [00:09<00:28,  1.88s/it]                 Task 0, Epoch 6/20 => Loss 0.211, Train_accy 93.41:  30%|███       | 6/20 [00:09<00:22,  1.59s/it]Task 0, Epoch 7/20 => Loss 0.154, Train_accy 94.51:  30%|███       | 6/20 [00:10<00:22,  1.59s/it]Task 0, Epoch 7/20 => Loss 0.154, Train_accy 94.51:  35%|███▌      | 7/20 [00:10<00:18,  1.41s/it]Task 0, Epoch 8/20 => Loss 0.093, Train_accy 97.80:  35%|███▌      | 7/20 [00:11<00:18,  1.41s/it]Task 0, Epoch 8/20 => Loss 0.093, Train_accy 97.80:  40%|████      | 8/20 [00:11<00:16,  1.34s/it]Task 0, Epoch 9/20 => Loss 0.080, Train_accy 97.80:  40%|████      | 8/20 [00:12<00:16,  1.34s/it]Task 0, Epoch 9/20 => Loss 0.080, Train_accy 97.80:  45%|████▌     | 9/20 [00:12<00:13,  1.24s/it]Task 0, Epoch 10/20 => Loss 0.062, Train_accy 98.90, Test_accy 96.85:  45%|████▌     | 9/20 [00:15<00:13,  1.24s/it]Task 0, Epoch 10/20 => Loss 0.062, Train_accy 98.90, Test_accy 96.85:  50%|█████     | 10/20 [00:15<00:17,  1.76s/it]Task 0, Epoch 11/20 => Loss 0.045, Train_accy 100.00:  50%|█████     | 10/20 [00:16<00:17,  1.76s/it]                Task 0, Epoch 11/20 => Loss 0.045, Train_accy 100.00:  55%|█████▌    | 11/20 [00:16<00:13,  1.53s/it]Task 0, Epoch 12/20 => Loss 0.039, Train_accy 98.90:  55%|█████▌    | 11/20 [00:17<00:13,  1.53s/it] Task 0, Epoch 12/20 => Loss 0.039, Train_accy 98.90:  60%|██████    | 12/20 [00:17<00:11,  1.38s/it]Task 0, Epoch 13/20 => Loss 0.043, Train_accy 98.90:  60%|██████    | 12/20 [00:18<00:11,  1.38s/it]Task 0, Epoch 13/20 => Loss 0.043, Train_accy 98.90:  65%|██████▌   | 13/20 [00:18<00:09,  1.29s/it]Task 0, Epoch 14/20 => Loss 0.024, Train_accy 100.00:  65%|██████▌   | 13/20 [00:19<00:09,  1.29s/it]Task 0, Epoch 14/20 => Loss 0.024, Train_accy 100.00:  70%|███████   | 14/20 [00:19<00:07,  1.21s/it]Task 0, Epoch 15/20 => Loss 0.021, Train_accy 100.00, Test_accy 97.20:  70%|███████   | 14/20 [00:22<00:07,  1.21s/it]Task 0, Epoch 15/20 => Loss 0.021, Train_accy 100.00, Test_accy 97.20:  75%|███████▌  | 15/20 [00:22<00:08,  1.72s/it]Task 0, Epoch 16/20 => Loss 0.029, Train_accy 100.00:  75%|███████▌  | 15/20 [00:23<00:08,  1.72s/it]                 Task 0, Epoch 16/20 => Loss 0.029, Train_accy 100.00:  80%|████████  | 16/20 [00:23<00:06,  1.59s/it]Task 0, Epoch 17/20 => Loss 0.011, Train_accy 100.00:  80%|████████  | 16/20 [00:24<00:06,  1.59s/it]Task 0, Epoch 17/20 => Loss 0.011, Train_accy 100.00:  85%|████████▌ | 17/20 [00:24<00:04,  1.43s/it]Task 0, Epoch 18/20 => Loss 0.034, Train_accy 98.90:  85%|████████▌ | 17/20 [00:25<00:04,  1.43s/it] Task 0, Epoch 18/20 => Loss 0.034, Train_accy 98.90:  90%|█████████ | 18/20 [00:25<00:02,  1.32s/it]Task 0, Epoch 19/20 => Loss 0.038, Train_accy 98.90:  90%|█████████ | 18/20 [00:26<00:02,  1.32s/it]Task 0, Epoch 19/20 => Loss 0.038, Train_accy 98.90:  95%|█████████▌| 19/20 [00:26<00:01,  1.24s/it]Task 0, Epoch 20/20 => Loss 0.033, Train_accy 100.00, Test_accy 97.20:  95%|█████████▌| 19/20 [00:29<00:01,  1.24s/it]Task 0, Epoch 20/20 => Loss 0.033, Train_accy 100.00, Test_accy 97.20: 100%|██████████| 20/20 [00:29<00:00,  1.77s/it]Task 0, Epoch 20/20 => Loss 0.033, Train_accy 100.00, Test_accy 97.20: 100%|██████████| 20/20 [00:29<00:00,  1.49s/it]
2024-05-10 02:52:21,458 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.033, Train_accy 100.00, Test_accy 97.20
2024-05-10 02:52:23,361 [trainer.py] => No NME accuracy.
2024-05-10 02:52:23,361 [trainer.py] => CNN: {'total': 97.2, '00-04': 97.2, 'old': 0, 'new': 97.2}
2024-05-10 02:52:23,362 [trainer.py] => CNN top1 curve: [97.2]
2024-05-10 02:52:23,362 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.2
2024-05-10 02:52:23,362 [trainer.py] => Average Accuracy (CNN): 97.2 

2024-05-10 02:52:23,362 [trainer.py] => Train Time: 60.17
2024-05-10 02:52:23,362 [trainer.py] => Test Time: 1.9 

2024-05-10 02:52:23,365 [trainer.py] => All params: 171927652
2024-05-10 02:52:23,367 [trainer.py] => Trainable params: 291890
2024-05-10 02:52:23,367 [dualprompt.py] => Learning on 5-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.494, Train_accy 37.14:   0%|          | 0/20 [00:01<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.494, Train_accy 37.14:   5%|▌         | 1/20 [00:01<00:22,  1.16s/it]Task 1, Epoch 2/20 => Loss 0.664, Train_accy 81.43:   5%|▌         | 1/20 [00:02<00:22,  1.16s/it]Task 1, Epoch 2/20 => Loss 0.664, Train_accy 81.43:  10%|█         | 2/20 [00:02<00:18,  1.02s/it]Task 1, Epoch 3/20 => Loss 0.332, Train_accy 95.71:  10%|█         | 2/20 [00:03<00:18,  1.02s/it]Task 1, Epoch 3/20 => Loss 0.332, Train_accy 95.71:  15%|█▌        | 3/20 [00:03<00:16,  1.01it/s]Task 1, Epoch 4/20 => Loss 0.144, Train_accy 100.00:  15%|█▌        | 3/20 [00:03<00:16,  1.01it/s]Task 1, Epoch 4/20 => Loss 0.144, Train_accy 100.00:  20%|██        | 4/20 [00:03<00:15,  1.03it/s]Task 1, Epoch 5/20 => Loss 0.110, Train_accy 98.57, Test_accy 95.52:  20%|██        | 4/20 [00:09<00:15,  1.03it/s]Task 1, Epoch 5/20 => Loss 0.110, Train_accy 98.57, Test_accy 95.52:  25%|██▌       | 5/20 [00:09<00:39,  2.61s/it]Task 1, Epoch 6/20 => Loss 0.070, Train_accy 98.57:  25%|██▌       | 5/20 [00:10<00:39,  2.61s/it]                 Task 1, Epoch 6/20 => Loss 0.070, Train_accy 98.57:  30%|███       | 6/20 [00:10<00:28,  2.05s/it]Task 1, Epoch 7/20 => Loss 0.033, Train_accy 100.00:  30%|███       | 6/20 [00:11<00:28,  2.05s/it]Task 1, Epoch 7/20 => Loss 0.033, Train_accy 100.00:  35%|███▌      | 7/20 [00:11<00:22,  1.70s/it]Task 1, Epoch 8/20 => Loss 0.030, Train_accy 100.00:  35%|███▌      | 7/20 [00:12<00:22,  1.70s/it]Task 1, Epoch 8/20 => Loss 0.030, Train_accy 100.00:  40%|████      | 8/20 [00:12<00:17,  1.44s/it]Task 1, Epoch 9/20 => Loss 0.033, Train_accy 98.57:  40%|████      | 8/20 [00:13<00:17,  1.44s/it] Task 1, Epoch 9/20 => Loss 0.033, Train_accy 98.57:  45%|████▌     | 9/20 [00:13<00:14,  1.31s/it]Task 1, Epoch 10/20 => Loss 0.046, Train_accy 100.00, Test_accy 97.70:  45%|████▌     | 9/20 [00:19<00:14,  1.31s/it]Task 1, Epoch 10/20 => Loss 0.046, Train_accy 100.00, Test_accy 97.70:  50%|█████     | 10/20 [00:19<00:26,  2.67s/it]Task 1, Epoch 11/20 => Loss 0.085, Train_accy 98.57:  50%|█████     | 10/20 [00:20<00:26,  2.67s/it]                  Task 1, Epoch 11/20 => Loss 0.085, Train_accy 98.57:  55%|█████▌    | 11/20 [00:20<00:19,  2.15s/it]Task 1, Epoch 12/20 => Loss 0.008, Train_accy 100.00:  55%|█████▌    | 11/20 [00:20<00:19,  2.15s/it]Task 1, Epoch 12/20 => Loss 0.008, Train_accy 100.00:  60%|██████    | 12/20 [00:20<00:14,  1.77s/it]Task 1, Epoch 13/20 => Loss 0.012, Train_accy 100.00:  60%|██████    | 12/20 [00:21<00:14,  1.77s/it]Task 1, Epoch 13/20 => Loss 0.012, Train_accy 100.00:  65%|██████▌   | 13/20 [00:21<00:10,  1.51s/it]Task 1, Epoch 14/20 => Loss 0.040, Train_accy 100.00:  65%|██████▌   | 13/20 [00:22<00:10,  1.51s/it]Task 1, Epoch 14/20 => Loss 0.040, Train_accy 100.00:  70%|███████   | 14/20 [00:22<00:08,  1.36s/it]Task 1, Epoch 15/20 => Loss 0.006, Train_accy 100.00, Test_accy 97.58:  70%|███████   | 14/20 [00:28<00:08,  1.36s/it]Task 1, Epoch 15/20 => Loss 0.006, Train_accy 100.00, Test_accy 97.58:  75%|███████▌  | 15/20 [00:28<00:13,  2.61s/it]Task 1, Epoch 16/20 => Loss 0.038, Train_accy 98.57:  75%|███████▌  | 15/20 [00:29<00:13,  2.61s/it]                  Task 1, Epoch 16/20 => Loss 0.038, Train_accy 98.57:  80%|████████  | 16/20 [00:29<00:08,  2.10s/it]Task 1, Epoch 17/20 => Loss 0.015, Train_accy 100.00:  80%|████████  | 16/20 [00:30<00:08,  2.10s/it]Task 1, Epoch 17/20 => Loss 0.015, Train_accy 100.00:  85%|████████▌ | 17/20 [00:30<00:05,  1.74s/it]Task 1, Epoch 18/20 => Loss 0.004, Train_accy 100.00:  85%|████████▌ | 17/20 [00:31<00:05,  1.74s/it]Task 1, Epoch 18/20 => Loss 0.004, Train_accy 100.00:  90%|█████████ | 18/20 [00:31<00:03,  1.51s/it]Task 1, Epoch 19/20 => Loss 0.029, Train_accy 98.57:  90%|█████████ | 18/20 [00:32<00:03,  1.51s/it] Task 1, Epoch 19/20 => Loss 0.029, Train_accy 98.57:  95%|█████████▌| 19/20 [00:32<00:01,  1.33s/it]Task 1, Epoch 20/20 => Loss 0.003, Train_accy 100.00, Test_accy 97.70:  95%|█████████▌| 19/20 [00:37<00:01,  1.33s/it]Task 1, Epoch 20/20 => Loss 0.003, Train_accy 100.00, Test_accy 97.70: 100%|██████████| 20/20 [00:37<00:00,  2.64s/it]Task 1, Epoch 20/20 => Loss 0.003, Train_accy 100.00, Test_accy 97.70: 100%|██████████| 20/20 [00:37<00:00,  1.89s/it]
2024-05-10 02:53:01,163 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.003, Train_accy 100.00, Test_accy 97.70
2024-05-10 02:53:05,732 [trainer.py] => No NME accuracy.
2024-05-10 02:53:05,733 [trainer.py] => CNN: {'total': 97.7, '00-04': 93.36, '05-09': 100.0, 'old': 93.36, 'new': 100.0}
2024-05-10 02:53:05,733 [trainer.py] => CNN top1 curve: [97.2, 97.7]
2024-05-10 02:53:05,733 [trainer.py] => CNN top5 curve: [100.0, 99.88]

Average Accuracy (CNN): 97.45
2024-05-10 02:53:05,733 [trainer.py] => Average Accuracy (CNN): 97.45 

2024-05-10 02:53:05,733 [trainer.py] => Train Time: 135.76
2024-05-10 02:53:05,733 [trainer.py] => Test Time: 6.470000000000001 

2024-05-10 02:53:05,735 [trainer.py] => All params: 171927652
2024-05-10 02:53:05,736 [trainer.py] => Trainable params: 291890
2024-05-10 02:53:05,736 [dualprompt.py] => Learning on 10-15
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.709, Train_accy 26.81:   0%|          | 0/20 [00:01<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.709, Train_accy 26.81:   5%|▌         | 1/20 [00:01<00:27,  1.44s/it]Task 2, Epoch 2/20 => Loss 0.670, Train_accy 84.06:   5%|▌         | 1/20 [00:02<00:27,  1.44s/it]Task 2, Epoch 2/20 => Loss 0.670, Train_accy 84.06:  10%|█         | 2/20 [00:02<00:25,  1.42s/it]Task 2, Epoch 3/20 => Loss 0.310, Train_accy 94.93:  10%|█         | 2/20 [00:04<00:25,  1.42s/it]Task 2, Epoch 3/20 => Loss 0.310, Train_accy 94.93:  15%|█▌        | 3/20 [00:04<00:23,  1.41s/it]Task 2, Epoch 4/20 => Loss 0.117, Train_accy 98.55:  15%|█▌        | 3/20 [00:05<00:23,  1.41s/it]Task 2, Epoch 4/20 => Loss 0.117, Train_accy 98.55:  20%|██        | 4/20 [00:05<00:22,  1.40s/it]Task 2, Epoch 5/20 => Loss 0.092, Train_accy 97.10, Test_accy 97.01:  20%|██        | 4/20 [00:14<00:22,  1.40s/it]Task 2, Epoch 5/20 => Loss 0.092, Train_accy 97.10, Test_accy 97.01:  25%|██▌       | 5/20 [00:14<01:02,  4.16s/it]Task 2, Epoch 6/20 => Loss 0.059, Train_accy 98.55:  25%|██▌       | 5/20 [00:16<01:02,  4.16s/it]                 Task 2, Epoch 6/20 => Loss 0.059, Train_accy 98.55:  30%|███       | 6/20 [00:16<00:45,  3.23s/it]Task 2, Epoch 7/20 => Loss 0.028, Train_accy 100.00:  30%|███       | 6/20 [00:17<00:45,  3.23s/it]Task 2, Epoch 7/20 => Loss 0.028, Train_accy 100.00:  35%|███▌      | 7/20 [00:17<00:34,  2.62s/it]Task 2, Epoch 8/20 => Loss 0.018, Train_accy 100.00:  35%|███▌      | 7/20 [00:18<00:34,  2.62s/it]Task 2, Epoch 8/20 => Loss 0.018, Train_accy 100.00:  40%|████      | 8/20 [00:18<00:27,  2.27s/it]Task 2, Epoch 9/20 => Loss 0.016, Train_accy 99.28:  40%|████      | 8/20 [00:20<00:27,  2.27s/it] Task 2, Epoch 9/20 => Loss 0.016, Train_accy 99.28:  45%|████▌     | 9/20 [00:20<00:21,  2.00s/it]Task 2, Epoch 10/20 => Loss 0.021, Train_accy 99.28, Test_accy 97.57:  45%|████▌     | 9/20 [00:29<00:21,  2.00s/it]Task 2, Epoch 10/20 => Loss 0.021, Train_accy 99.28, Test_accy 97.57:  50%|█████     | 10/20 [00:29<00:41,  4.16s/it]Task 2, Epoch 11/20 => Loss 0.012, Train_accy 99.28:  50%|█████     | 10/20 [00:30<00:41,  4.16s/it]                 Task 2, Epoch 11/20 => Loss 0.012, Train_accy 99.28:  55%|█████▌    | 11/20 [00:30<00:29,  3.33s/it]Task 2, Epoch 12/20 => Loss 0.009, Train_accy 100.00:  55%|█████▌    | 11/20 [00:32<00:29,  3.33s/it]Task 2, Epoch 12/20 => Loss 0.009, Train_accy 100.00:  60%|██████    | 12/20 [00:32<00:22,  2.76s/it]Task 2, Epoch 13/20 => Loss 0.032, Train_accy 99.28:  60%|██████    | 12/20 [00:33<00:22,  2.76s/it] Task 2, Epoch 13/20 => Loss 0.032, Train_accy 99.28:  65%|██████▌   | 13/20 [00:33<00:16,  2.34s/it]Task 2, Epoch 14/20 => Loss 0.052, Train_accy 98.55:  65%|██████▌   | 13/20 [00:35<00:16,  2.34s/it]Task 2, Epoch 14/20 => Loss 0.052, Train_accy 98.55:  70%|███████   | 14/20 [00:35<00:12,  2.09s/it]Task 2, Epoch 15/20 => Loss 0.019, Train_accy 99.28, Test_accy 97.43:  70%|███████   | 14/20 [00:44<00:12,  2.09s/it]Task 2, Epoch 15/20 => Loss 0.019, Train_accy 99.28, Test_accy 97.43:  75%|███████▌  | 15/20 [00:44<00:20,  4.16s/it]Task 2, Epoch 16/20 => Loss 0.013, Train_accy 99.28:  75%|███████▌  | 15/20 [00:45<00:20,  4.16s/it]                 Task 2, Epoch 16/20 => Loss 0.013, Train_accy 99.28:  80%|████████  | 16/20 [00:45<00:13,  3.34s/it]Task 2, Epoch 17/20 => Loss 0.028, Train_accy 99.28:  80%|████████  | 16/20 [00:46<00:13,  3.34s/it]Task 2, Epoch 17/20 => Loss 0.028, Train_accy 99.28:  85%|████████▌ | 17/20 [00:46<00:08,  2.74s/it]Task 2, Epoch 18/20 => Loss 0.011, Train_accy 99.28:  85%|████████▌ | 17/20 [00:48<00:08,  2.74s/it]Task 2, Epoch 18/20 => Loss 0.011, Train_accy 99.28:  90%|█████████ | 18/20 [00:48<00:04,  2.35s/it]Task 2, Epoch 19/20 => Loss 0.001, Train_accy 100.00:  90%|█████████ | 18/20 [00:49<00:04,  2.35s/it]Task 2, Epoch 19/20 => Loss 0.001, Train_accy 100.00:  95%|█████████▌| 19/20 [00:49<00:02,  2.07s/it]Task 2, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 97.43:  95%|█████████▌| 19/20 [00:58<00:02,  2.07s/it]Task 2, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 97.43: 100%|██████████| 20/20 [00:58<00:00,  4.12s/it]Task 2, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 97.43: 100%|██████████| 20/20 [00:58<00:00,  2.93s/it]
2024-05-10 02:54:04,438 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 97.43
2024-05-10 02:54:11,911 [trainer.py] => No NME accuracy.
2024-05-10 02:54:11,911 [trainer.py] => CNN: {'total': 97.43, '00-04': 91.61, '05-09': 99.07, '10-14': 98.69, 'old': 96.49, 'new': 98.69}
2024-05-10 02:54:11,911 [trainer.py] => CNN top1 curve: [97.2, 97.7, 97.43]
2024-05-10 02:54:11,912 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72]

Average Accuracy (CNN): 97.44
2024-05-10 02:54:11,912 [trainer.py] => Average Accuracy (CNN): 97.44 

2024-05-10 02:54:11,912 [trainer.py] => Train Time: 253.14999999999998
2024-05-10 02:54:11,912 [trainer.py] => Test Time: 13.940000000000001 

2024-05-10 02:54:11,916 [trainer.py] => All params: 171927652
2024-05-10 02:54:11,919 [trainer.py] => Trainable params: 291890
2024-05-10 02:54:11,919 [dualprompt.py] => Learning on 15-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.150, Train_accy 59.42:   0%|          | 0/20 [00:02<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.150, Train_accy 59.42:   5%|▌         | 1/20 [00:02<00:46,  2.45s/it]Task 3, Epoch 2/20 => Loss 0.402, Train_accy 90.22:   5%|▌         | 1/20 [00:04<00:46,  2.45s/it]Task 3, Epoch 2/20 => Loss 0.402, Train_accy 90.22:  10%|█         | 2/20 [00:04<00:43,  2.42s/it]Task 3, Epoch 3/20 => Loss 0.256, Train_accy 92.03:  10%|█         | 2/20 [00:07<00:43,  2.42s/it]Task 3, Epoch 3/20 => Loss 0.256, Train_accy 92.03:  15%|█▌        | 3/20 [00:07<00:40,  2.39s/it]Task 3, Epoch 4/20 => Loss 0.133, Train_accy 96.01:  15%|█▌        | 3/20 [00:09<00:40,  2.39s/it]Task 3, Epoch 4/20 => Loss 0.133, Train_accy 96.01:  20%|██        | 4/20 [00:09<00:38,  2.38s/it]Task 3, Epoch 5/20 => Loss 0.207, Train_accy 93.48, Test_accy 89.36:  20%|██        | 4/20 [00:26<00:38,  2.38s/it]Task 3, Epoch 5/20 => Loss 0.207, Train_accy 93.48, Test_accy 89.36:  25%|██▌       | 5/20 [00:26<01:54,  7.62s/it]Task 3, Epoch 6/20 => Loss 0.166, Train_accy 94.20:  25%|██▌       | 5/20 [00:28<01:54,  7.62s/it]                 Task 3, Epoch 6/20 => Loss 0.166, Train_accy 94.20:  30%|███       | 6/20 [00:28<01:21,  5.84s/it]Task 3, Epoch 7/20 => Loss 0.126, Train_accy 95.29:  30%|███       | 6/20 [00:31<01:21,  5.84s/it]Task 3, Epoch 7/20 => Loss 0.126, Train_accy 95.29:  35%|███▌      | 7/20 [00:31<01:01,  4.71s/it]Task 3, Epoch 8/20 => Loss 0.120, Train_accy 94.57:  35%|███▌      | 7/20 [00:33<01:01,  4.71s/it]Task 3, Epoch 8/20 => Loss 0.120, Train_accy 94.57:  40%|████      | 8/20 [00:33<00:47,  3.96s/it]Task 3, Epoch 9/20 => Loss 0.105, Train_accy 96.74:  40%|████      | 8/20 [00:36<00:47,  3.96s/it]Task 3, Epoch 9/20 => Loss 0.105, Train_accy 96.74:  45%|████▌     | 9/20 [00:36<00:38,  3.48s/it]Task 3, Epoch 10/20 => Loss 0.109, Train_accy 97.10, Test_accy 92.48:  45%|████▌     | 9/20 [00:52<00:38,  3.48s/it]Task 3, Epoch 10/20 => Loss 0.109, Train_accy 97.10, Test_accy 92.48:  50%|█████     | 10/20 [00:52<01:16,  7.64s/it]Task 3, Epoch 11/20 => Loss 0.097, Train_accy 97.10:  50%|█████     | 10/20 [00:55<01:16,  7.64s/it]                 Task 3, Epoch 11/20 => Loss 0.097, Train_accy 97.10:  55%|█████▌    | 11/20 [00:55<00:54,  6.02s/it]Task 3, Epoch 12/20 => Loss 0.068, Train_accy 98.19:  55%|█████▌    | 11/20 [00:57<00:54,  6.02s/it]Task 3, Epoch 12/20 => Loss 0.068, Train_accy 98.19:  60%|██████    | 12/20 [00:57<00:39,  4.92s/it]Task 3, Epoch 13/20 => Loss 0.061, Train_accy 98.19:  60%|██████    | 12/20 [01:00<00:39,  4.92s/it]Task 3, Epoch 13/20 => Loss 0.061, Train_accy 98.19:  65%|██████▌   | 13/20 [01:00<00:28,  4.14s/it]Task 3, Epoch 14/20 => Loss 0.058, Train_accy 98.19:  65%|██████▌   | 13/20 [01:02<00:28,  4.14s/it]Task 3, Epoch 14/20 => Loss 0.058, Train_accy 98.19:  70%|███████   | 14/20 [01:02<00:21,  3.60s/it]Task 3, Epoch 15/20 => Loss 0.080, Train_accy 97.10, Test_accy 94.73:  70%|███████   | 14/20 [01:19<00:21,  3.60s/it]Task 3, Epoch 15/20 => Loss 0.080, Train_accy 97.10, Test_accy 94.73:  75%|███████▌  | 15/20 [01:19<00:37,  7.56s/it]Task 3, Epoch 16/20 => Loss 0.085, Train_accy 96.74:  75%|███████▌  | 15/20 [01:21<00:37,  7.56s/it]                 Task 3, Epoch 16/20 => Loss 0.085, Train_accy 96.74:  80%|████████  | 16/20 [01:21<00:23,  6.00s/it]Task 3, Epoch 17/20 => Loss 0.089, Train_accy 96.74:  80%|████████  | 16/20 [01:23<00:23,  6.00s/it]Task 3, Epoch 17/20 => Loss 0.089, Train_accy 96.74:  85%|████████▌ | 17/20 [01:23<00:14,  4.92s/it]Task 3, Epoch 18/20 => Loss 0.099, Train_accy 96.38:  85%|████████▌ | 17/20 [01:26<00:14,  4.92s/it]Task 3, Epoch 18/20 => Loss 0.099, Train_accy 96.38:  90%|█████████ | 18/20 [01:26<00:08,  4.16s/it]Task 3, Epoch 19/20 => Loss 0.050, Train_accy 97.46:  90%|█████████ | 18/20 [01:28<00:08,  4.16s/it]Task 3, Epoch 19/20 => Loss 0.050, Train_accy 97.46:  95%|█████████▌| 19/20 [01:28<00:03,  3.61s/it]Task 3, Epoch 20/20 => Loss 0.049, Train_accy 98.19, Test_accy 94.84:  95%|█████████▌| 19/20 [01:45<00:03,  3.61s/it]Task 3, Epoch 20/20 => Loss 0.049, Train_accy 98.19, Test_accy 94.84: 100%|██████████| 20/20 [01:45<00:00,  7.56s/it]Task 3, Epoch 20/20 => Loss 0.049, Train_accy 98.19, Test_accy 94.84: 100%|██████████| 20/20 [01:45<00:00,  5.27s/it]
2024-05-10 02:55:57,365 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.049, Train_accy 98.19, Test_accy 94.84
2024-05-10 02:56:11,762 [trainer.py] => No NME accuracy.
2024-05-10 02:56:11,762 [trainer.py] => CNN: {'total': 94.84, '00-04': 91.26, '05-09': 99.07, '10-14': 97.88, '15-19': 92.62, 'old': 97.01, 'new': 92.62}
2024-05-10 02:56:11,763 [trainer.py] => CNN top1 curve: [97.2, 97.7, 97.43, 94.84]
2024-05-10 02:56:11,763 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72]

Average Accuracy (CNN): 96.79
2024-05-10 02:56:11,763 [trainer.py] => Average Accuracy (CNN): 96.79 

2024-05-10 02:56:11,763 [trainer.py] => Train Time: 464.02
2024-05-10 02:56:11,763 [trainer.py] => Test Time: 28.330000000000002 

2024-05-10 02:56:11,766 [trainer.py] => All params: 171927652
2024-05-10 02:56:11,769 [trainer.py] => Trainable params: 291890
2024-05-10 02:56:11,769 [dualprompt.py] => Learning on 20-25
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.334, Train_accy 45.60:   0%|          | 0/20 [00:02<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.334, Train_accy 45.60:   5%|▌         | 1/20 [00:02<00:44,  2.35s/it]Task 4, Epoch 2/20 => Loss 0.486, Train_accy 82.40:   5%|▌         | 1/20 [00:04<00:44,  2.35s/it]Task 4, Epoch 2/20 => Loss 0.486, Train_accy 82.40:  10%|█         | 2/20 [00:04<00:40,  2.26s/it]Task 4, Epoch 3/20 => Loss 0.248, Train_accy 90.80:  10%|█         | 2/20 [00:06<00:40,  2.26s/it]Task 4, Epoch 3/20 => Loss 0.248, Train_accy 90.80:  15%|█▌        | 3/20 [00:06<00:37,  2.23s/it]Task 4, Epoch 4/20 => Loss 0.272, Train_accy 90.40:  15%|█▌        | 3/20 [00:08<00:37,  2.23s/it]Task 4, Epoch 4/20 => Loss 0.272, Train_accy 90.40:  20%|██        | 4/20 [00:08<00:35,  2.22s/it]Task 4, Epoch 5/20 => Loss 0.166, Train_accy 94.80, Test_accy 81.76:  20%|██        | 4/20 [00:31<00:35,  2.22s/it]Task 4, Epoch 5/20 => Loss 0.166, Train_accy 94.80, Test_accy 81.76:  25%|██▌       | 5/20 [00:31<02:24,  9.66s/it]Task 4, Epoch 6/20 => Loss 0.179, Train_accy 94.40:  25%|██▌       | 5/20 [00:33<02:24,  9.66s/it]                 Task 4, Epoch 6/20 => Loss 0.179, Train_accy 94.40:  30%|███       | 6/20 [00:33<01:39,  7.11s/it]Task 4, Epoch 7/20 => Loss 0.085, Train_accy 98.00:  30%|███       | 6/20 [00:36<01:39,  7.11s/it]Task 4, Epoch 7/20 => Loss 0.085, Train_accy 98.00:  35%|███▌      | 7/20 [00:36<01:11,  5.51s/it]Task 4, Epoch 8/20 => Loss 0.113, Train_accy 96.80:  35%|███▌      | 7/20 [00:38<01:11,  5.51s/it]Task 4, Epoch 8/20 => Loss 0.113, Train_accy 96.80:  40%|████      | 8/20 [00:38<00:53,  4.46s/it]Task 4, Epoch 9/20 => Loss 0.081, Train_accy 96.80:  40%|████      | 8/20 [00:40<00:53,  4.46s/it]Task 4, Epoch 9/20 => Loss 0.081, Train_accy 96.80:  45%|████▌     | 9/20 [00:40<00:41,  3.75s/it]Task 4, Epoch 10/20 => Loss 0.083, Train_accy 97.20, Test_accy 86.91:  45%|████▌     | 9/20 [01:03<00:41,  3.75s/it]Task 4, Epoch 10/20 => Loss 0.083, Train_accy 97.20, Test_accy 86.91:  50%|█████     | 10/20 [01:03<01:36,  9.65s/it]Task 4, Epoch 11/20 => Loss 0.076, Train_accy 97.20:  50%|█████     | 10/20 [01:05<01:36,  9.65s/it]                 Task 4, Epoch 11/20 => Loss 0.076, Train_accy 97.20:  55%|█████▌    | 11/20 [01:05<01:06,  7.37s/it]Task 4, Epoch 12/20 => Loss 0.068, Train_accy 98.40:  55%|█████▌    | 11/20 [01:07<01:06,  7.37s/it]Task 4, Epoch 12/20 => Loss 0.068, Train_accy 98.40:  60%|██████    | 12/20 [01:07<00:46,  5.80s/it]Task 4, Epoch 13/20 => Loss 0.070, Train_accy 97.60:  60%|██████    | 12/20 [01:10<00:46,  5.80s/it]Task 4, Epoch 13/20 => Loss 0.070, Train_accy 97.60:  65%|██████▌   | 13/20 [01:10<00:33,  4.72s/it]Task 4, Epoch 14/20 => Loss 0.077, Train_accy 98.00:  65%|██████▌   | 13/20 [01:12<00:33,  4.72s/it]Task 4, Epoch 14/20 => Loss 0.077, Train_accy 98.00:  70%|███████   | 14/20 [01:12<00:23,  3.94s/it]Task 4, Epoch 15/20 => Loss 0.073, Train_accy 98.80, Test_accy 87.27:  70%|███████   | 14/20 [01:34<00:23,  3.94s/it]Task 4, Epoch 15/20 => Loss 0.073, Train_accy 98.80, Test_accy 87.27:  75%|███████▌  | 15/20 [01:34<00:48,  9.61s/it]Task 4, Epoch 16/20 => Loss 0.052, Train_accy 98.00:  75%|███████▌  | 15/20 [01:37<00:48,  9.61s/it]                 Task 4, Epoch 16/20 => Loss 0.052, Train_accy 98.00:  80%|████████  | 16/20 [01:37<00:29,  7.39s/it]Task 4, Epoch 17/20 => Loss 0.078, Train_accy 97.60:  80%|████████  | 16/20 [01:39<00:29,  7.39s/it]Task 4, Epoch 17/20 => Loss 0.078, Train_accy 97.60:  85%|████████▌ | 17/20 [01:39<00:17,  5.84s/it]Task 4, Epoch 18/20 => Loss 0.089, Train_accy 97.20:  85%|████████▌ | 17/20 [01:41<00:17,  5.84s/it]Task 4, Epoch 18/20 => Loss 0.089, Train_accy 97.20:  90%|█████████ | 18/20 [01:41<00:09,  4.73s/it]Task 4, Epoch 19/20 => Loss 0.038, Train_accy 98.80:  90%|█████████ | 18/20 [01:43<00:09,  4.73s/it]Task 4, Epoch 19/20 => Loss 0.038, Train_accy 98.80:  95%|█████████▌| 19/20 [01:43<00:03,  3.98s/it]Task 4, Epoch 20/20 => Loss 0.054, Train_accy 98.00, Test_accy 87.47:  95%|█████████▌| 19/20 [02:06<00:03,  3.98s/it]Task 4, Epoch 20/20 => Loss 0.054, Train_accy 98.00, Test_accy 87.47: 100%|██████████| 20/20 [02:06<00:00,  9.57s/it]Task 4, Epoch 20/20 => Loss 0.054, Train_accy 98.00, Test_accy 87.47: 100%|██████████| 20/20 [02:06<00:00,  6.32s/it]
2024-05-10 02:58:18,204 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.054, Train_accy 98.00, Test_accy 87.47
2024-05-10 02:58:38,575 [trainer.py] => No NME accuracy.
2024-05-10 02:58:38,575 [trainer.py] => CNN: {'total': 87.47, '00-04': 90.91, '05-09': 93.7, '10-14': 88.07, '15-19': 91.41, '20-24': 79.28, 'old': 91.08, 'new': 79.28}
2024-05-10 02:58:38,575 [trainer.py] => CNN top1 curve: [97.2, 97.7, 97.43, 94.84, 87.47]
2024-05-10 02:58:38,575 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.22]

Average Accuracy (CNN): 94.93
2024-05-10 02:58:38,576 [trainer.py] => Average Accuracy (CNN): 94.93 

2024-05-10 02:58:38,576 [trainer.py] => Train Time: 716.8699999999999
2024-05-10 02:58:38,576 [trainer.py] => Test Time: 48.7 

2024-05-10 02:58:38,578 [trainer.py] => All params: 171927652
2024-05-10 02:58:38,581 [trainer.py] => Trainable params: 291890
2024-05-10 02:58:38,581 [dualprompt.py] => Learning on 25-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.140, Train_accy 16.52:   0%|          | 0/20 [00:01<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.140, Train_accy 16.52:   5%|▌         | 1/20 [00:01<00:24,  1.26s/it]Task 5, Epoch 2/20 => Loss 0.896, Train_accy 65.22:   5%|▌         | 1/20 [00:02<00:24,  1.26s/it]Task 5, Epoch 2/20 => Loss 0.896, Train_accy 65.22:  10%|█         | 2/20 [00:02<00:22,  1.24s/it]Task 5, Epoch 3/20 => Loss 0.373, Train_accy 87.83:  10%|█         | 2/20 [00:03<00:22,  1.24s/it]Task 5, Epoch 3/20 => Loss 0.373, Train_accy 87.83:  15%|█▌        | 3/20 [00:03<00:21,  1.28s/it]Task 5, Epoch 4/20 => Loss 0.207, Train_accy 93.04:  15%|█▌        | 3/20 [00:05<00:21,  1.28s/it]Task 5, Epoch 4/20 => Loss 0.207, Train_accy 93.04:  20%|██        | 4/20 [00:05<00:20,  1.28s/it]Task 5, Epoch 5/20 => Loss 0.192, Train_accy 94.78, Test_accy 84.02:  20%|██        | 4/20 [00:28<00:20,  1.28s/it]Task 5, Epoch 5/20 => Loss 0.192, Train_accy 94.78, Test_accy 84.02:  25%|██▌       | 5/20 [00:28<02:19,  9.30s/it]Task 5, Epoch 6/20 => Loss 0.089, Train_accy 96.52:  25%|██▌       | 5/20 [00:30<02:19,  9.30s/it]                 Task 5, Epoch 6/20 => Loss 0.089, Train_accy 96.52:  30%|███       | 6/20 [00:30<01:32,  6.61s/it]Task 5, Epoch 7/20 => Loss 0.060, Train_accy 97.39:  30%|███       | 6/20 [00:31<01:32,  6.61s/it]Task 5, Epoch 7/20 => Loss 0.060, Train_accy 97.39:  35%|███▌      | 7/20 [00:31<01:03,  4.89s/it]Task 5, Epoch 8/20 => Loss 0.069, Train_accy 98.26:  35%|███▌      | 7/20 [00:32<01:03,  4.89s/it]Task 5, Epoch 8/20 => Loss 0.069, Train_accy 98.26:  40%|████      | 8/20 [00:32<00:45,  3.77s/it]Task 5, Epoch 9/20 => Loss 0.019, Train_accy 100.00:  40%|████      | 8/20 [00:33<00:45,  3.77s/it]Task 5, Epoch 9/20 => Loss 0.019, Train_accy 100.00:  45%|████▌     | 9/20 [00:33<00:32,  2.98s/it]Task 5, Epoch 10/20 => Loss 0.026, Train_accy 100.00, Test_accy 86.21:  45%|████▌     | 9/20 [00:57<00:32,  2.98s/it]Task 5, Epoch 10/20 => Loss 0.026, Train_accy 100.00, Test_accy 86.21:  50%|█████     | 10/20 [00:57<01:33,  9.34s/it]Task 5, Epoch 11/20 => Loss 0.048, Train_accy 98.26:  50%|█████     | 10/20 [00:58<01:33,  9.34s/it]                  Task 5, Epoch 11/20 => Loss 0.048, Train_accy 98.26:  55%|█████▌    | 11/20 [00:58<01:01,  6.88s/it]Task 5, Epoch 12/20 => Loss 0.012, Train_accy 100.00:  55%|█████▌    | 11/20 [01:00<01:01,  6.88s/it]Task 5, Epoch 12/20 => Loss 0.012, Train_accy 100.00:  60%|██████    | 12/20 [01:00<00:41,  5.21s/it]Task 5, Epoch 13/20 => Loss 0.024, Train_accy 100.00:  60%|██████    | 12/20 [01:01<00:41,  5.21s/it]Task 5, Epoch 13/20 => Loss 0.024, Train_accy 100.00:  65%|██████▌   | 13/20 [01:01<00:28,  4.02s/it]Task 5, Epoch 14/20 => Loss 0.023, Train_accy 100.00:  65%|██████▌   | 13/20 [01:02<00:28,  4.02s/it]Task 5, Epoch 14/20 => Loss 0.023, Train_accy 100.00:  70%|███████   | 14/20 [01:02<00:19,  3.18s/it]Task 5, Epoch 15/20 => Loss 0.023, Train_accy 99.13, Test_accy 86.63:  70%|███████   | 14/20 [01:26<00:19,  3.18s/it]Task 5, Epoch 15/20 => Loss 0.023, Train_accy 99.13, Test_accy 86.63:  75%|███████▌  | 15/20 [01:26<00:46,  9.39s/it]Task 5, Epoch 16/20 => Loss 0.017, Train_accy 100.00:  75%|███████▌  | 15/20 [01:27<00:46,  9.39s/it]                Task 5, Epoch 16/20 => Loss 0.017, Train_accy 100.00:  80%|████████  | 16/20 [01:27<00:27,  6.95s/it]Task 5, Epoch 17/20 => Loss 0.017, Train_accy 100.00:  80%|████████  | 16/20 [01:29<00:27,  6.95s/it]Task 5, Epoch 17/20 => Loss 0.017, Train_accy 100.00:  85%|████████▌ | 17/20 [01:29<00:15,  5.24s/it]Task 5, Epoch 18/20 => Loss 0.063, Train_accy 99.13:  85%|████████▌ | 17/20 [01:30<00:15,  5.24s/it] Task 5, Epoch 18/20 => Loss 0.063, Train_accy 99.13:  90%|█████████ | 18/20 [01:30<00:08,  4.05s/it]Task 5, Epoch 19/20 => Loss 0.014, Train_accy 100.00:  90%|█████████ | 18/20 [01:31<00:08,  4.05s/it]Task 5, Epoch 19/20 => Loss 0.014, Train_accy 100.00:  95%|█████████▌| 19/20 [01:31<00:03,  3.22s/it]Task 5, Epoch 20/20 => Loss 0.013, Train_accy 100.00, Test_accy 86.61:  95%|█████████▌| 19/20 [01:55<00:03,  3.22s/it]Task 5, Epoch 20/20 => Loss 0.013, Train_accy 100.00, Test_accy 86.61: 100%|██████████| 20/20 [01:55<00:00,  9.40s/it]Task 5, Epoch 20/20 => Loss 0.013, Train_accy 100.00, Test_accy 86.61: 100%|██████████| 20/20 [01:55<00:00,  5.77s/it]
2024-05-10 03:00:34,058 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.013, Train_accy 100.00, Test_accy 86.61
2024-05-10 03:00:56,400 [trainer.py] => No NME accuracy.
2024-05-10 03:00:56,401 [trainer.py] => CNN: {'total': 86.61, '00-04': 86.71, '05-09': 93.7, '10-14': 89.05, '15-19': 90.99, '20-24': 79.04, '25-29': 81.22, 'old': 87.1, 'new': 81.22}
2024-05-10 03:00:56,401 [trainer.py] => CNN top1 curve: [97.2, 97.7, 97.43, 94.84, 87.47, 86.61]
2024-05-10 03:00:56,401 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.22, 99.04]

Average Accuracy (CNN): 93.54
2024-05-10 03:00:56,401 [trainer.py] => Average Accuracy (CNN): 93.54 

2024-05-10 03:00:56,401 [trainer.py] => Train Time: 947.8
2024-05-10 03:00:56,401 [trainer.py] => Test Time: 71.04 

2024-05-10 03:00:56,403 [trainer.py] => All params: 171927652
2024-05-10 03:00:56,405 [trainer.py] => Trainable params: 291890
2024-05-10 03:00:56,405 [dualprompt.py] => Learning on 30-35
  0%|          | 0/20 [00:00<?, ?it/s]Task 6, Epoch 1/20 => Loss 1.760, Train_accy 25.29:   0%|          | 0/20 [00:01<?, ?it/s]Task 6, Epoch 1/20 => Loss 1.760, Train_accy 25.29:   5%|▌         | 1/20 [00:01<00:30,  1.61s/it]Task 6, Epoch 2/20 => Loss 0.441, Train_accy 90.80:   5%|▌         | 1/20 [00:03<00:30,  1.61s/it]Task 6, Epoch 2/20 => Loss 0.441, Train_accy 90.80:  10%|█         | 2/20 [00:03<00:29,  1.62s/it]Task 6, Epoch 3/20 => Loss 0.136, Train_accy 97.70:  10%|█         | 2/20 [00:04<00:29,  1.62s/it]Task 6, Epoch 3/20 => Loss 0.136, Train_accy 97.70:  15%|█▌        | 3/20 [00:04<00:27,  1.64s/it]Task 6, Epoch 4/20 => Loss 0.071, Train_accy 98.85:  15%|█▌        | 3/20 [00:06<00:27,  1.64s/it]Task 6, Epoch 4/20 => Loss 0.071, Train_accy 98.85:  20%|██        | 4/20 [00:06<00:26,  1.63s/it]Task 6, Epoch 5/20 => Loss 0.037, Train_accy 99.43, Test_accy 82.95:  20%|██        | 4/20 [00:34<00:26,  1.63s/it]Task 6, Epoch 5/20 => Loss 0.037, Train_accy 99.43, Test_accy 82.95:  25%|██▌       | 5/20 [00:34<02:46, 11.07s/it]Task 6, Epoch 6/20 => Loss 0.062, Train_accy 98.28:  25%|██▌       | 5/20 [00:35<02:46, 11.07s/it]                 Task 6, Epoch 6/20 => Loss 0.062, Train_accy 98.28:  30%|███       | 6/20 [00:35<01:50,  7.87s/it]Task 6, Epoch 7/20 => Loss 0.026, Train_accy 99.43:  30%|███       | 6/20 [00:37<01:50,  7.87s/it]Task 6, Epoch 7/20 => Loss 0.026, Train_accy 99.43:  35%|███▌      | 7/20 [00:37<01:16,  5.87s/it]Task 6, Epoch 8/20 => Loss 0.030, Train_accy 99.43:  35%|███▌      | 7/20 [00:39<01:16,  5.87s/it]Task 6, Epoch 8/20 => Loss 0.030, Train_accy 99.43:  40%|████      | 8/20 [00:39<00:54,  4.53s/it]Task 6, Epoch 9/20 => Loss 0.006, Train_accy 100.00:  40%|████      | 8/20 [00:41<00:54,  4.53s/it]Task 6, Epoch 9/20 => Loss 0.006, Train_accy 100.00:  45%|████▌     | 9/20 [00:41<00:39,  3.63s/it]Task 6, Epoch 10/20 => Loss 0.004, Train_accy 100.00, Test_accy 83.78:  45%|████▌     | 9/20 [01:08<00:39,  3.63s/it]Task 6, Epoch 10/20 => Loss 0.004, Train_accy 100.00, Test_accy 83.78:  50%|█████     | 10/20 [01:08<01:50, 11.09s/it]Task 6, Epoch 11/20 => Loss 0.007, Train_accy 100.00:  50%|█████     | 10/20 [01:10<01:50, 11.09s/it]                 Task 6, Epoch 11/20 => Loss 0.007, Train_accy 100.00:  55%|█████▌    | 11/20 [01:10<01:13,  8.20s/it]Task 6, Epoch 12/20 => Loss 0.025, Train_accy 99.43:  55%|█████▌    | 11/20 [01:12<01:13,  8.20s/it] Task 6, Epoch 12/20 => Loss 0.025, Train_accy 99.43:  60%|██████    | 12/20 [01:12<00:50,  6.25s/it]Task 6, Epoch 13/20 => Loss 0.010, Train_accy 100.00:  60%|██████    | 12/20 [01:14<00:50,  6.25s/it]Task 6, Epoch 13/20 => Loss 0.010, Train_accy 100.00:  65%|██████▌   | 13/20 [01:14<00:34,  4.89s/it]Task 6, Epoch 14/20 => Loss 0.052, Train_accy 98.28:  65%|██████▌   | 13/20 [01:15<00:34,  4.89s/it] Task 6, Epoch 14/20 => Loss 0.052, Train_accy 98.28:  70%|███████   | 14/20 [01:15<00:23,  3.90s/it]Task 6, Epoch 15/20 => Loss 0.002, Train_accy 100.00, Test_accy 83.71:  70%|███████   | 14/20 [01:43<00:23,  3.90s/it]Task 6, Epoch 15/20 => Loss 0.002, Train_accy 100.00, Test_accy 83.71:  75%|███████▌  | 15/20 [01:43<00:55, 11.08s/it]Task 6, Epoch 16/20 => Loss 0.023, Train_accy 98.85:  75%|███████▌  | 15/20 [01:45<00:55, 11.08s/it]                  Task 6, Epoch 16/20 => Loss 0.023, Train_accy 98.85:  80%|████████  | 16/20 [01:45<00:32,  8.24s/it]Task 6, Epoch 17/20 => Loss 0.001, Train_accy 100.00:  80%|████████  | 16/20 [01:46<00:32,  8.24s/it]Task 6, Epoch 17/20 => Loss 0.001, Train_accy 100.00:  85%|████████▌ | 17/20 [01:46<00:18,  6.27s/it]Task 6, Epoch 18/20 => Loss 0.000, Train_accy 100.00:  85%|████████▌ | 17/20 [01:48<00:18,  6.27s/it]Task 6, Epoch 18/20 => Loss 0.000, Train_accy 100.00:  90%|█████████ | 18/20 [01:48<00:09,  4.91s/it]Task 6, Epoch 19/20 => Loss 0.002, Train_accy 100.00:  90%|█████████ | 18/20 [01:50<00:09,  4.91s/it]Task 6, Epoch 19/20 => Loss 0.002, Train_accy 100.00:  95%|█████████▌| 19/20 [01:50<00:03,  3.96s/it]Task 6, Epoch 20/20 => Loss 0.014, Train_accy 99.43, Test_accy 83.78:  95%|█████████▌| 19/20 [02:18<00:03,  3.96s/it]Task 6, Epoch 20/20 => Loss 0.014, Train_accy 99.43, Test_accy 83.78: 100%|██████████| 20/20 [02:18<00:00, 11.16s/it]Task 6, Epoch 20/20 => Loss 0.014, Train_accy 99.43, Test_accy 83.78: 100%|██████████| 20/20 [02:18<00:00,  6.91s/it]
2024-05-10 03:03:14,561 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.014, Train_accy 99.43, Test_accy 83.78
2024-05-10 03:03:40,708 [trainer.py] => No NME accuracy.
2024-05-10 03:03:40,708 [trainer.py] => CNN: {'total': 83.78, '00-04': 86.71, '05-09': 93.33, '10-14': 76.47, '15-19': 89.28, '20-24': 74.66, '25-29': 81.48, '30-34': 87.55, 'old': 83.1, 'new': 87.55}
2024-05-10 03:03:40,708 [trainer.py] => CNN top1 curve: [97.2, 97.7, 97.43, 94.84, 87.47, 86.61, 83.78]
2024-05-10 03:03:40,708 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.22, 99.04, 98.77]

Average Accuracy (CNN): 92.15
2024-05-10 03:03:40,708 [trainer.py] => Average Accuracy (CNN): 92.15 

2024-05-10 03:03:40,708 [trainer.py] => Train Time: 1224.0900000000001
2024-05-10 03:03:40,708 [trainer.py] => Test Time: 97.19 

2024-05-10 03:03:40,710 [trainer.py] => All params: 171927652
2024-05-10 03:03:40,711 [trainer.py] => Trainable params: 291890
2024-05-10 03:03:40,711 [dualprompt.py] => Learning on 35-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.470, Train_accy 35.66:   0%|          | 0/20 [00:01<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.470, Train_accy 35.66:   5%|▌         | 1/20 [00:01<00:26,  1.39s/it]Task 7, Epoch 2/20 => Loss 0.590, Train_accy 79.84:   5%|▌         | 1/20 [00:02<00:26,  1.39s/it]Task 7, Epoch 2/20 => Loss 0.590, Train_accy 79.84:  10%|█         | 2/20 [00:02<00:25,  1.39s/it]Task 7, Epoch 3/20 => Loss 0.265, Train_accy 88.37:  10%|█         | 2/20 [00:04<00:25,  1.39s/it]Task 7, Epoch 3/20 => Loss 0.265, Train_accy 88.37:  15%|█▌        | 3/20 [00:04<00:22,  1.35s/it]Task 7, Epoch 4/20 => Loss 0.137, Train_accy 94.57:  15%|█▌        | 3/20 [00:05<00:22,  1.35s/it]Task 7, Epoch 4/20 => Loss 0.137, Train_accy 94.57:  20%|██        | 4/20 [00:05<00:22,  1.40s/it]Task 7, Epoch 5/20 => Loss 0.100, Train_accy 97.67, Test_accy 78.53:  20%|██        | 4/20 [00:35<00:22,  1.40s/it]Task 7, Epoch 5/20 => Loss 0.100, Train_accy 97.67, Test_accy 78.53:  25%|██▌       | 5/20 [00:35<02:53, 11.58s/it]Task 7, Epoch 6/20 => Loss 0.042, Train_accy 99.22:  25%|██▌       | 5/20 [00:36<02:53, 11.58s/it]                 Task 7, Epoch 6/20 => Loss 0.042, Train_accy 99.22:  30%|███       | 6/20 [00:36<01:53,  8.12s/it]Task 7, Epoch 7/20 => Loss 0.040, Train_accy 99.22:  30%|███       | 6/20 [00:37<01:53,  8.12s/it]Task 7, Epoch 7/20 => Loss 0.040, Train_accy 99.22:  35%|███▌      | 7/20 [00:37<01:16,  5.91s/it]Task 7, Epoch 8/20 => Loss 0.050, Train_accy 99.22:  35%|███▌      | 7/20 [00:39<01:16,  5.91s/it]Task 7, Epoch 8/20 => Loss 0.050, Train_accy 99.22:  40%|████      | 8/20 [00:39<00:53,  4.46s/it]Task 7, Epoch 9/20 => Loss 0.021, Train_accy 99.22:  40%|████      | 8/20 [00:40<00:53,  4.46s/it]Task 7, Epoch 9/20 => Loss 0.021, Train_accy 99.22:  45%|████▌     | 9/20 [00:40<00:38,  3.49s/it]Task 7, Epoch 10/20 => Loss 0.027, Train_accy 99.22, Test_accy 79.70:  45%|████▌     | 9/20 [01:10<00:38,  3.49s/it]Task 7, Epoch 10/20 => Loss 0.027, Train_accy 99.22, Test_accy 79.70:  50%|█████     | 10/20 [01:10<01:57, 11.71s/it]Task 7, Epoch 11/20 => Loss 0.028, Train_accy 99.22:  50%|█████     | 10/20 [01:12<01:57, 11.71s/it]                 Task 7, Epoch 11/20 => Loss 0.028, Train_accy 99.22:  55%|█████▌    | 11/20 [01:12<01:16,  8.55s/it]Task 7, Epoch 12/20 => Loss 0.025, Train_accy 99.22:  55%|█████▌    | 11/20 [01:13<01:16,  8.55s/it]Task 7, Epoch 12/20 => Loss 0.025, Train_accy 99.22:  60%|██████    | 12/20 [01:13<00:51,  6.39s/it]Task 7, Epoch 13/20 => Loss 0.010, Train_accy 100.00:  60%|██████    | 12/20 [01:14<00:51,  6.39s/it]Task 7, Epoch 13/20 => Loss 0.010, Train_accy 100.00:  65%|██████▌   | 13/20 [01:14<00:33,  4.85s/it]Task 7, Epoch 14/20 => Loss 0.020, Train_accy 99.22:  65%|██████▌   | 13/20 [01:16<00:33,  4.85s/it] Task 7, Epoch 14/20 => Loss 0.020, Train_accy 99.22:  70%|███████   | 14/20 [01:16<00:22,  3.81s/it]Task 7, Epoch 15/20 => Loss 0.038, Train_accy 99.22, Test_accy 79.84:  70%|███████   | 14/20 [01:45<00:22,  3.81s/it]Task 7, Epoch 15/20 => Loss 0.038, Train_accy 99.22, Test_accy 79.84:  75%|███████▌  | 15/20 [01:45<00:57, 11.58s/it]Task 7, Epoch 16/20 => Loss 0.019, Train_accy 99.22:  75%|███████▌  | 15/20 [01:47<00:57, 11.58s/it]                 Task 7, Epoch 16/20 => Loss 0.019, Train_accy 99.22:  80%|████████  | 16/20 [01:47<00:34,  8.52s/it]Task 7, Epoch 17/20 => Loss 0.088, Train_accy 98.45:  80%|████████  | 16/20 [01:48<00:34,  8.52s/it]Task 7, Epoch 17/20 => Loss 0.088, Train_accy 98.45:  85%|████████▌ | 17/20 [01:48<00:19,  6.38s/it]Task 7, Epoch 18/20 => Loss 0.009, Train_accy 100.00:  85%|████████▌ | 17/20 [01:50<00:19,  6.38s/it]Task 7, Epoch 18/20 => Loss 0.009, Train_accy 100.00:  90%|█████████ | 18/20 [01:50<00:09,  4.86s/it]Task 7, Epoch 19/20 => Loss 0.015, Train_accy 99.22:  90%|█████████ | 18/20 [01:51<00:09,  4.86s/it] Task 7, Epoch 19/20 => Loss 0.015, Train_accy 99.22:  95%|█████████▌| 19/20 [01:51<00:03,  3.80s/it]Task 7, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 79.70:  95%|█████████▌| 19/20 [02:21<00:03,  3.80s/it]Task 7, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 79.70: 100%|██████████| 20/20 [02:21<00:00, 11.58s/it]Task 7, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 79.70: 100%|██████████| 20/20 [02:21<00:00,  7.06s/it]
2024-05-10 03:06:01,826 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.002, Train_accy 100.00, Test_accy 79.70
2024-05-10 03:06:30,191 [trainer.py] => No NME accuracy.
2024-05-10 03:06:30,191 [trainer.py] => CNN: {'total': 79.7, '00-04': 86.36, '05-09': 87.78, '10-14': 70.1, '15-19': 83.18, '20-24': 68.53, '25-29': 81.75, '30-34': 88.29, '35-39': 82.0, 'old': 79.51, 'new': 82.0}
2024-05-10 03:06:30,191 [trainer.py] => CNN top1 curve: [97.2, 97.7, 97.43, 94.84, 87.47, 86.61, 83.78, 79.7]
2024-05-10 03:06:30,191 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.22, 99.04, 98.77, 97.68]

Average Accuracy (CNN): 90.59
2024-05-10 03:06:30,192 [trainer.py] => Average Accuracy (CNN): 90.59 

2024-05-10 03:06:30,192 [trainer.py] => Train Time: 1506.3100000000004
2024-05-10 03:06:30,192 [trainer.py] => Test Time: 125.55 

2024-05-10 03:06:30,193 [trainer.py] => All params: 171927652
2024-05-10 03:06:30,194 [trainer.py] => Trainable params: 291890
2024-05-10 03:06:30,194 [dualprompt.py] => Learning on 40-45
  0%|          | 0/20 [00:00<?, ?it/s]Task 8, Epoch 1/20 => Loss 1.058, Train_accy 58.42:   0%|          | 0/20 [00:02<?, ?it/s]Task 8, Epoch 1/20 => Loss 1.058, Train_accy 58.42:   5%|▌         | 1/20 [00:02<00:48,  2.54s/it]Task 8, Epoch 2/20 => Loss 0.314, Train_accy 92.78:   5%|▌         | 1/20 [00:05<00:48,  2.54s/it]Task 8, Epoch 2/20 => Loss 0.314, Train_accy 92.78:  10%|█         | 2/20 [00:05<00:45,  2.51s/it]Task 8, Epoch 3/20 => Loss 0.088, Train_accy 98.28:  10%|█         | 2/20 [00:07<00:45,  2.51s/it]Task 8, Epoch 3/20 => Loss 0.088, Train_accy 98.28:  15%|█▌        | 3/20 [00:07<00:42,  2.51s/it]Task 8, Epoch 4/20 => Loss 0.086, Train_accy 97.25:  15%|█▌        | 3/20 [00:10<00:42,  2.51s/it]Task 8, Epoch 4/20 => Loss 0.086, Train_accy 97.25:  20%|██        | 4/20 [00:10<00:40,  2.51s/it]Task 8, Epoch 5/20 => Loss 0.077, Train_accy 97.59, Test_accy 77.71:  20%|██        | 4/20 [00:48<00:40,  2.51s/it]Task 8, Epoch 5/20 => Loss 0.077, Train_accy 97.59, Test_accy 77.71:  25%|██▌       | 5/20 [00:48<03:50, 15.40s/it]Task 8, Epoch 6/20 => Loss 0.048, Train_accy 99.31:  25%|██▌       | 5/20 [00:50<03:50, 15.40s/it]                 Task 8, Epoch 6/20 => Loss 0.048, Train_accy 99.31:  30%|███       | 6/20 [00:50<02:34, 11.04s/it]Task 8, Epoch 7/20 => Loss 0.057, Train_accy 98.28:  30%|███       | 6/20 [00:53<02:34, 11.04s/it]Task 8, Epoch 7/20 => Loss 0.057, Train_accy 98.28:  35%|███▌      | 7/20 [00:53<01:47,  8.28s/it]Task 8, Epoch 8/20 => Loss 0.041, Train_accy 98.97:  35%|███▌      | 7/20 [00:55<01:47,  8.28s/it]Task 8, Epoch 8/20 => Loss 0.041, Train_accy 98.97:  40%|████      | 8/20 [00:55<01:17,  6.45s/it]Task 8, Epoch 9/20 => Loss 0.033, Train_accy 98.97:  40%|████      | 8/20 [00:58<01:17,  6.45s/it]Task 8, Epoch 9/20 => Loss 0.033, Train_accy 98.97:  45%|████▌     | 9/20 [00:58<00:57,  5.22s/it]Task 8, Epoch 10/20 => Loss 0.052, Train_accy 98.97, Test_accy 77.75:  45%|████▌     | 9/20 [01:36<00:57,  5.22s/it]Task 8, Epoch 10/20 => Loss 0.052, Train_accy 98.97, Test_accy 77.75:  50%|█████     | 10/20 [01:36<02:33, 15.38s/it]Task 8, Epoch 11/20 => Loss 0.027, Train_accy 98.97:  50%|█████     | 10/20 [01:39<02:33, 15.38s/it]                 Task 8, Epoch 11/20 => Loss 0.027, Train_accy 98.97:  55%|█████▌    | 11/20 [01:39<01:42, 11.42s/it]Task 8, Epoch 12/20 => Loss 0.056, Train_accy 98.63:  55%|█████▌    | 11/20 [01:41<01:42, 11.42s/it]Task 8, Epoch 12/20 => Loss 0.056, Train_accy 98.63:  60%|██████    | 12/20 [01:41<01:09,  8.70s/it]Task 8, Epoch 13/20 => Loss 0.027, Train_accy 98.97:  60%|██████    | 12/20 [01:44<01:09,  8.70s/it]Task 8, Epoch 13/20 => Loss 0.027, Train_accy 98.97:  65%|██████▌   | 13/20 [01:44<00:47,  6.81s/it]Task 8, Epoch 14/20 => Loss 0.029, Train_accy 98.63:  65%|██████▌   | 13/20 [01:46<00:47,  6.81s/it]Task 8, Epoch 14/20 => Loss 0.029, Train_accy 98.63:  70%|███████   | 14/20 [01:46<00:33,  5.50s/it]Task 8, Epoch 15/20 => Loss 0.020, Train_accy 99.31, Test_accy 78.51:  70%|███████   | 14/20 [02:24<00:33,  5.50s/it]Task 8, Epoch 15/20 => Loss 0.020, Train_accy 99.31, Test_accy 78.51:  75%|███████▌  | 15/20 [02:24<01:16, 15.30s/it]Task 8, Epoch 16/20 => Loss 0.018, Train_accy 99.31:  75%|███████▌  | 15/20 [02:26<01:16, 15.30s/it]                 Task 8, Epoch 16/20 => Loss 0.018, Train_accy 99.31:  80%|████████  | 16/20 [02:26<00:45, 11.44s/it]Task 8, Epoch 17/20 => Loss 0.007, Train_accy 99.31:  80%|████████  | 16/20 [02:29<00:45, 11.44s/it]Task 8, Epoch 17/20 => Loss 0.007, Train_accy 99.31:  85%|████████▌ | 17/20 [02:29<00:26,  8.74s/it]Task 8, Epoch 18/20 => Loss 0.011, Train_accy 99.31:  85%|████████▌ | 17/20 [02:31<00:26,  8.74s/it]Task 8, Epoch 18/20 => Loss 0.011, Train_accy 99.31:  90%|█████████ | 18/20 [02:31<00:13,  6.86s/it]Task 8, Epoch 19/20 => Loss 0.010, Train_accy 99.66:  90%|█████████ | 18/20 [02:34<00:13,  6.86s/it]Task 8, Epoch 19/20 => Loss 0.010, Train_accy 99.66:  95%|█████████▌| 19/20 [02:34<00:05,  5.54s/it]Task 8, Epoch 20/20 => Loss 0.013, Train_accy 99.66, Test_accy 78.39:  95%|█████████▌| 19/20 [03:12<00:05,  5.54s/it]Task 8, Epoch 20/20 => Loss 0.013, Train_accy 99.66, Test_accy 78.39: 100%|██████████| 20/20 [03:12<00:00, 15.33s/it]Task 8, Epoch 20/20 => Loss 0.013, Train_accy 99.66, Test_accy 78.39: 100%|██████████| 20/20 [03:12<00:00,  9.63s/it]
2024-05-10 03:09:42,747 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.013, Train_accy 99.66, Test_accy 78.39
2024-05-10 03:10:18,676 [trainer.py] => No NME accuracy.
2024-05-10 03:10:18,677 [trainer.py] => CNN: {'total': 78.39, '00-04': 86.36, '05-09': 85.0, '10-14': 61.6, '15-19': 78.57, '20-24': 62.55, '25-29': 80.16, '30-34': 87.79, '35-39': 80.41, '40-44': 88.17, 'old': 75.79, 'new': 88.17}
2024-05-10 03:10:18,677 [trainer.py] => CNN top1 curve: [97.2, 97.7, 97.43, 94.84, 87.47, 86.61, 83.78, 79.7, 78.39]
2024-05-10 03:10:18,677 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.22, 99.04, 98.77, 97.68, 97.26]

Average Accuracy (CNN): 89.24
2024-05-10 03:10:18,677 [trainer.py] => Average Accuracy (CNN): 89.24 

2024-05-10 03:10:18,678 [trainer.py] => Train Time: 1891.4000000000003
2024-05-10 03:10:18,678 [trainer.py] => Test Time: 161.48 

2024-05-10 03:10:18,680 [trainer.py] => All params: 171927652
2024-05-10 03:10:18,682 [trainer.py] => Trainable params: 291890
2024-05-10 03:10:18,682 [dualprompt.py] => Learning on 45-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 9, Epoch 1/20 => Loss 0.944, Train_accy 64.12:   0%|          | 0/20 [00:02<?, ?it/s]Task 9, Epoch 1/20 => Loss 0.944, Train_accy 64.12:   5%|▌         | 1/20 [00:02<00:42,  2.25s/it]Task 9, Epoch 2/20 => Loss 0.189, Train_accy 94.66:   5%|▌         | 1/20 [00:04<00:42,  2.25s/it]Task 9, Epoch 2/20 => Loss 0.189, Train_accy 94.66:  10%|█         | 2/20 [00:04<00:40,  2.25s/it]Task 9, Epoch 3/20 => Loss 0.116, Train_accy 95.80:  10%|█         | 2/20 [00:06<00:40,  2.25s/it]Task 9, Epoch 3/20 => Loss 0.116, Train_accy 95.80:  15%|█▌        | 3/20 [00:06<00:39,  2.34s/it]Task 9, Epoch 4/20 => Loss 0.076, Train_accy 98.09:  15%|█▌        | 3/20 [00:09<00:39,  2.34s/it]Task 9, Epoch 4/20 => Loss 0.076, Train_accy 98.09:  20%|██        | 4/20 [00:09<00:36,  2.31s/it]Task 9, Epoch 5/20 => Loss 0.067, Train_accy 98.09, Test_accy 71.13:  20%|██        | 4/20 [00:53<00:36,  2.31s/it]Task 9, Epoch 5/20 => Loss 0.067, Train_accy 98.09, Test_accy 71.13:  25%|██▌       | 5/20 [00:53<04:22, 17.52s/it]Task 9, Epoch 6/20 => Loss 0.053, Train_accy 98.09:  25%|██▌       | 5/20 [00:56<04:22, 17.52s/it]                 Task 9, Epoch 6/20 => Loss 0.053, Train_accy 98.09:  30%|███       | 6/20 [00:56<02:53, 12.38s/it]Task 9, Epoch 7/20 => Loss 0.050, Train_accy 98.47:  30%|███       | 6/20 [00:58<02:53, 12.38s/it]Task 9, Epoch 7/20 => Loss 0.050, Train_accy 98.47:  35%|███▌      | 7/20 [00:58<01:57,  9.06s/it]Task 9, Epoch 8/20 => Loss 0.031, Train_accy 99.24:  35%|███▌      | 7/20 [01:00<01:57,  9.06s/it]Task 9, Epoch 8/20 => Loss 0.031, Train_accy 99.24:  40%|████      | 8/20 [01:00<01:22,  6.90s/it]Task 9, Epoch 9/20 => Loss 0.028, Train_accy 99.24:  40%|████      | 8/20 [01:02<01:22,  6.90s/it]Task 9, Epoch 9/20 => Loss 0.028, Train_accy 99.24:  45%|████▌     | 9/20 [01:02<01:00,  5.46s/it]Task 9, Epoch 10/20 => Loss 0.023, Train_accy 99.62, Test_accy 70.99:  45%|████▌     | 9/20 [01:47<01:00,  5.46s/it]Task 9, Epoch 10/20 => Loss 0.023, Train_accy 99.62, Test_accy 70.99:  50%|█████     | 10/20 [01:47<02:55, 17.57s/it]Task 9, Epoch 11/20 => Loss 0.037, Train_accy 98.09:  50%|█████     | 10/20 [01:49<02:55, 17.57s/it]                 Task 9, Epoch 11/20 => Loss 0.037, Train_accy 98.09:  55%|█████▌    | 11/20 [01:49<01:56, 12.93s/it]Task 9, Epoch 12/20 => Loss 0.034, Train_accy 98.09:  55%|█████▌    | 11/20 [01:52<01:56, 12.93s/it]Task 9, Epoch 12/20 => Loss 0.034, Train_accy 98.09:  60%|██████    | 12/20 [01:52<01:17,  9.67s/it]Task 9, Epoch 13/20 => Loss 0.021, Train_accy 99.62:  60%|██████    | 12/20 [01:54<01:17,  9.67s/it]Task 9, Epoch 13/20 => Loss 0.021, Train_accy 99.62:  65%|██████▌   | 13/20 [01:54<00:51,  7.43s/it]Task 9, Epoch 14/20 => Loss 0.009, Train_accy 100.00:  65%|██████▌   | 13/20 [01:56<00:51,  7.43s/it]Task 9, Epoch 14/20 => Loss 0.009, Train_accy 100.00:  70%|███████   | 14/20 [01:56<00:35,  5.89s/it]Task 9, Epoch 15/20 => Loss 0.035, Train_accy 98.47, Test_accy 71.38:  70%|███████   | 14/20 [02:41<00:35,  5.89s/it]Task 9, Epoch 15/20 => Loss 0.035, Train_accy 98.47, Test_accy 71.38:  75%|███████▌  | 15/20 [02:41<01:27, 17.57s/it]Task 9, Epoch 16/20 => Loss 0.019, Train_accy 99.62:  75%|███████▌  | 15/20 [02:43<01:27, 17.57s/it]                 Task 9, Epoch 16/20 => Loss 0.019, Train_accy 99.62:  80%|████████  | 16/20 [02:43<00:51, 12.97s/it]Task 9, Epoch 17/20 => Loss 0.037, Train_accy 99.24:  80%|████████  | 16/20 [02:46<00:51, 12.97s/it]Task 9, Epoch 17/20 => Loss 0.037, Train_accy 99.24:  85%|████████▌ | 17/20 [02:46<00:29,  9.76s/it]Task 9, Epoch 18/20 => Loss 0.039, Train_accy 97.71:  85%|████████▌ | 17/20 [02:48<00:29,  9.76s/it]Task 9, Epoch 18/20 => Loss 0.039, Train_accy 97.71:  90%|█████████ | 18/20 [02:48<00:15,  7.52s/it]Task 9, Epoch 19/20 => Loss 0.016, Train_accy 99.24:  90%|█████████ | 18/20 [02:50<00:15,  7.52s/it]Task 9, Epoch 19/20 => Loss 0.016, Train_accy 99.24:  95%|█████████▌| 19/20 [02:50<00:05,  5.94s/it]Task 9, Epoch 20/20 => Loss 0.015, Train_accy 99.62, Test_accy 71.40:  95%|█████████▌| 19/20 [03:35<00:05,  5.94s/it]Task 9, Epoch 20/20 => Loss 0.015, Train_accy 99.62, Test_accy 71.40: 100%|██████████| 20/20 [03:35<00:00, 17.49s/it]Task 9, Epoch 20/20 => Loss 0.015, Train_accy 99.62, Test_accy 71.40: 100%|██████████| 20/20 [03:35<00:00, 10.75s/it]
2024-05-10 03:13:53,708 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.015, Train_accy 99.62, Test_accy 71.40
2024-05-10 03:14:35,838 [trainer.py] => No NME accuracy.
2024-05-10 03:14:35,838 [trainer.py] => CNN: {'total': 71.4, '00-04': 86.36, '05-09': 84.44, '10-14': 56.37, '15-19': 66.15, '20-24': 49.48, '25-29': 78.57, '30-34': 81.26, '35-39': 61.28, '40-44': 80.47, '45-49': 80.7, 'old': 69.65, 'new': 80.7}
2024-05-10 03:14:35,839 [trainer.py] => CNN top1 curve: [97.2, 97.7, 97.43, 94.84, 87.47, 86.61, 83.78, 79.7, 78.39, 71.4]
2024-05-10 03:14:35,839 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.72, 99.72, 99.22, 99.04, 98.77, 97.68, 97.26, 96.25]

Average Accuracy (CNN): 87.45
2024-05-10 03:14:35,839 [trainer.py] => Average Accuracy (CNN): 87.45 

2024-05-10 03:14:35,839 [trainer.py] => Train Time: 2321.4300000000003
2024-05-10 03:14:35,839 [trainer.py] => Test Time: 203.60999999999999 

Accuracy Matrix (CNN):
[[ 97.2   93.36  91.61  91.26  90.91  86.71  86.71  86.36  86.36  86.36]
 [  0.   100.    99.07  99.07  93.7   93.7   93.33  87.78  85.    84.44]
 [  0.     0.    98.69  97.88  88.07  89.05  76.47  70.1   61.6   56.37]
 [  0.     0.     0.    92.62  91.41  90.99  89.28  83.18  78.57  66.15]
 [  0.     0.     0.     0.    79.28  79.04  74.66  68.53  62.55  49.48]
 [  0.     0.     0.     0.     0.    81.22  81.48  81.75  80.16  78.57]
 [  0.     0.     0.     0.     0.     0.    87.55  88.29  87.79  81.26]
 [  0.     0.     0.     0.     0.     0.     0.    82.    80.41  61.28]
 [  0.     0.     0.     0.     0.     0.     0.     0.    88.17  80.47]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    80.7 ]]
2024-05-10 03:14:35,841 [trainer.py] => Forgetting (CNN): 18.18
2024-05-10 03:14:38,857 [trainer.py] => config: ./exps/coda_prompt_vtab_B0_Inc10.json
2024-05-10 03:14:38,857 [trainer.py] => prefix:  
2024-05-10 03:14:38,857 [trainer.py] => dataset: vtab
2024-05-10 03:14:38,857 [trainer.py] => memory_size: 0
2024-05-10 03:14:38,857 [trainer.py] => memory_per_class: 0
2024-05-10 03:14:38,857 [trainer.py] => fixed_memory: False
2024-05-10 03:14:38,857 [trainer.py] => shuffle: True
2024-05-10 03:14:38,857 [trainer.py] => init_cls: 5
2024-05-10 03:14:38,857 [trainer.py] => increment: 5
2024-05-10 03:14:38,857 [trainer.py] => model_name: coda_prompt
2024-05-10 03:14:38,857 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-05-10 03:14:38,858 [trainer.py] => device: [device(type='cuda', index=4)]
2024-05-10 03:14:38,858 [trainer.py] => seed: 1993
2024-05-10 03:14:38,858 [trainer.py] => tuned_epoch: 20
2024-05-10 03:14:38,858 [trainer.py] => init_lr: 0.001
2024-05-10 03:14:38,858 [trainer.py] => batch_size: 48
2024-05-10 03:14:38,858 [trainer.py] => weight_decay: 0
2024-05-10 03:14:38,858 [trainer.py] => min_lr: 1e-05
2024-05-10 03:14:38,858 [trainer.py] => optimizer: adam
2024-05-10 03:14:38,858 [trainer.py] => scheduler: cosine
2024-05-10 03:14:38,858 [trainer.py] => reinit_optimizer: True
2024-05-10 03:14:38,858 [trainer.py] => pretrained: True
2024-05-10 03:14:38,858 [trainer.py] => drop: 0.0
2024-05-10 03:14:38,858 [trainer.py] => drop_path: 0.0
2024-05-10 03:14:38,858 [trainer.py] => prompt_param: [100, 8.0, 0.0]
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-05-10 03:14:38,899 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-05-10 03:14:41,629 [coda_prompt.py] => 89,677,106 total parameters.
2024-05-10 03:14:41,629 [coda_prompt.py] => 3,878,450 fc and prompt training parameters.
2024-05-10 03:14:41,629 [trainer.py] => All params: 89677106
2024-05-10 03:14:41,630 [trainer.py] => Trainable params: 89677106
2024-05-10 03:14:41,630 [coda_prompt.py] => Learning on 0-5
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.384, Train_accy 10.42:   0%|          | 0/20 [00:01<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.384, Train_accy 10.42:   5%|▌         | 1/20 [00:01<00:27,  1.42s/it]Task 0, Epoch 2/20 => Loss 1.848, Train_accy 22.92:   5%|▌         | 1/20 [00:02<00:27,  1.42s/it]Task 0, Epoch 2/20 => Loss 1.848, Train_accy 22.92:  10%|█         | 2/20 [00:02<00:18,  1.04s/it]Task 0, Epoch 3/20 => Loss 1.337, Train_accy 45.83:  10%|█         | 2/20 [00:02<00:18,  1.04s/it]Task 0, Epoch 3/20 => Loss 1.337, Train_accy 45.83:  15%|█▌        | 3/20 [00:02<00:15,  1.08it/s]Task 0, Epoch 4/20 => Loss 1.178, Train_accy 54.17:  15%|█▌        | 3/20 [00:03<00:15,  1.08it/s]Task 0, Epoch 4/20 => Loss 1.178, Train_accy 54.17:  20%|██        | 4/20 [00:03<00:13,  1.16it/s]Task 0, Epoch 5/20 => Loss 0.670, Train_accy 81.25, Test_accy 86.71:  20%|██        | 4/20 [00:06<00:13,  1.16it/s]Task 0, Epoch 5/20 => Loss 0.670, Train_accy 81.25, Test_accy 86.71:  25%|██▌       | 5/20 [00:06<00:23,  1.57s/it]Task 0, Epoch 6/20 => Loss 0.594, Train_accy 83.33:  25%|██▌       | 5/20 [00:07<00:23,  1.57s/it]                 Task 0, Epoch 6/20 => Loss 0.594, Train_accy 83.33:  30%|███       | 6/20 [00:07<00:18,  1.31s/it]Task 0, Epoch 7/20 => Loss 0.352, Train_accy 95.83:  30%|███       | 6/20 [00:08<00:18,  1.31s/it]Task 0, Epoch 7/20 => Loss 0.352, Train_accy 95.83:  35%|███▌      | 7/20 [00:08<00:14,  1.15s/it]Task 0, Epoch 8/20 => Loss 0.342, Train_accy 95.83:  35%|███▌      | 7/20 [00:09<00:14,  1.15s/it]Task 0, Epoch 8/20 => Loss 0.342, Train_accy 95.83:  40%|████      | 8/20 [00:09<00:12,  1.08s/it]Task 0, Epoch 9/20 => Loss 0.258, Train_accy 93.75:  40%|████      | 8/20 [00:09<00:12,  1.08s/it]Task 0, Epoch 9/20 => Loss 0.258, Train_accy 93.75:  45%|████▌     | 9/20 [00:09<00:10,  1.01it/s]Task 0, Epoch 10/20 => Loss 0.155, Train_accy 95.83, Test_accy 92.31:  45%|████▌     | 9/20 [00:12<00:10,  1.01it/s]Task 0, Epoch 10/20 => Loss 0.155, Train_accy 95.83, Test_accy 92.31:  50%|█████     | 10/20 [00:12<00:15,  1.51s/it]Task 0, Epoch 11/20 => Loss 0.143, Train_accy 97.92:  50%|█████     | 10/20 [00:13<00:15,  1.51s/it]                 Task 0, Epoch 11/20 => Loss 0.143, Train_accy 97.92:  55%|█████▌    | 11/20 [00:13<00:11,  1.28s/it]Task 0, Epoch 12/20 => Loss 0.138, Train_accy 95.83:  55%|█████▌    | 11/20 [00:14<00:11,  1.28s/it]Task 0, Epoch 12/20 => Loss 0.138, Train_accy 95.83:  60%|██████    | 12/20 [00:14<00:09,  1.14s/it]Task 0, Epoch 13/20 => Loss 0.100, Train_accy 100.00:  60%|██████    | 12/20 [00:14<00:09,  1.14s/it]Task 0, Epoch 13/20 => Loss 0.100, Train_accy 100.00:  65%|██████▌   | 13/20 [00:14<00:07,  1.02s/it]Task 0, Epoch 14/20 => Loss 0.089, Train_accy 100.00:  65%|██████▌   | 13/20 [00:15<00:07,  1.02s/it]Task 0, Epoch 14/20 => Loss 0.089, Train_accy 100.00:  70%|███████   | 14/20 [00:15<00:05,  1.04it/s]Task 0, Epoch 15/20 => Loss 0.111, Train_accy 100.00, Test_accy 94.41:  70%|███████   | 14/20 [00:18<00:05,  1.04it/s]Task 0, Epoch 15/20 => Loss 0.111, Train_accy 100.00, Test_accy 94.41:  75%|███████▌  | 15/20 [00:18<00:07,  1.47s/it]Task 0, Epoch 16/20 => Loss 0.055, Train_accy 100.00:  75%|███████▌  | 15/20 [00:19<00:07,  1.47s/it]                 Task 0, Epoch 16/20 => Loss 0.055, Train_accy 100.00:  80%|████████  | 16/20 [00:19<00:05,  1.26s/it]Task 0, Epoch 17/20 => Loss 0.075, Train_accy 97.92:  80%|████████  | 16/20 [00:20<00:05,  1.26s/it] Task 0, Epoch 17/20 => Loss 0.075, Train_accy 97.92:  85%|████████▌ | 17/20 [00:20<00:03,  1.18s/it]Task 0, Epoch 18/20 => Loss 0.075, Train_accy 100.00:  85%|████████▌ | 17/20 [00:20<00:03,  1.18s/it]Task 0, Epoch 18/20 => Loss 0.075, Train_accy 100.00:  90%|█████████ | 18/20 [00:20<00:02,  1.05s/it]Task 0, Epoch 19/20 => Loss 0.069, Train_accy 97.92:  90%|█████████ | 18/20 [00:21<00:02,  1.05s/it] Task 0, Epoch 19/20 => Loss 0.069, Train_accy 97.92:  95%|█████████▌| 19/20 [00:21<00:00,  1.02it/s]Task 0, Epoch 20/20 => Loss 0.059, Train_accy 100.00, Test_accy 95.10:  95%|█████████▌| 19/20 [00:24<00:00,  1.02it/s]Task 0, Epoch 20/20 => Loss 0.059, Train_accy 100.00, Test_accy 95.10: 100%|██████████| 20/20 [00:24<00:00,  1.50s/it]Task 0, Epoch 20/20 => Loss 0.059, Train_accy 100.00, Test_accy 95.10: 100%|██████████| 20/20 [00:24<00:00,  1.22s/it]
2024-05-10 03:15:06,512 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.059, Train_accy 100.00, Test_accy 95.10
2024-05-10 03:15:08,515 [trainer.py] => No NME accuracy.
2024-05-10 03:15:08,515 [trainer.py] => CNN: {'total': 95.1, '00-04': 95.1, 'old': 0, 'new': 95.1}
2024-05-10 03:15:08,516 [trainer.py] => CNN top1 curve: [95.1]
2024-05-10 03:15:08,516 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 95.1
2024-05-10 03:15:08,516 [trainer.py] => Average Accuracy (CNN): 95.1 

2024-05-10 03:15:08,516 [trainer.py] => Train Time: 49.32
2024-05-10 03:15:08,516 [trainer.py] => Test Time: 2.0 

2024-05-10 03:15:08,518 [trainer.py] => All params: 89677106
2024-05-10 03:15:08,519 [trainer.py] => Trainable params: 89677106
2024-05-10 03:15:08,824 [coda_prompt.py] => Learning on 5-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.176, Train_accy 14.58:   0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.176, Train_accy 14.58:   5%|▌         | 1/20 [00:00<00:15,  1.26it/s]Task 1, Epoch 2/20 => Loss 1.649, Train_accy 27.08:   5%|▌         | 1/20 [00:01<00:15,  1.26it/s]Task 1, Epoch 2/20 => Loss 1.649, Train_accy 27.08:  10%|█         | 2/20 [00:01<00:14,  1.23it/s]Task 1, Epoch 3/20 => Loss 1.043, Train_accy 64.58:  10%|█         | 2/20 [00:02<00:14,  1.23it/s]Task 1, Epoch 3/20 => Loss 1.043, Train_accy 64.58:  15%|█▌        | 3/20 [00:02<00:14,  1.20it/s]Task 1, Epoch 4/20 => Loss 0.706, Train_accy 85.42:  15%|█▌        | 3/20 [00:03<00:14,  1.20it/s]Task 1, Epoch 4/20 => Loss 0.706, Train_accy 85.42:  20%|██        | 4/20 [00:03<00:14,  1.14it/s]Task 1, Epoch 5/20 => Loss 0.516, Train_accy 95.83, Test_accy 83.90:  20%|██        | 4/20 [00:08<00:14,  1.14it/s]Task 1, Epoch 5/20 => Loss 0.516, Train_accy 95.83, Test_accy 83.90:  25%|██▌       | 5/20 [00:08<00:37,  2.48s/it]Task 1, Epoch 6/20 => Loss 0.334, Train_accy 93.75:  25%|██▌       | 5/20 [00:09<00:37,  2.48s/it]                 Task 1, Epoch 6/20 => Loss 0.334, Train_accy 93.75:  30%|███       | 6/20 [00:09<00:27,  1.96s/it]Task 1, Epoch 7/20 => Loss 0.279, Train_accy 95.83:  30%|███       | 6/20 [00:10<00:27,  1.96s/it]Task 1, Epoch 7/20 => Loss 0.279, Train_accy 95.83:  35%|███▌      | 7/20 [00:10<00:20,  1.59s/it]Task 1, Epoch 8/20 => Loss 0.147, Train_accy 100.00:  35%|███▌      | 7/20 [00:11<00:20,  1.59s/it]Task 1, Epoch 8/20 => Loss 0.147, Train_accy 100.00:  40%|████      | 8/20 [00:11<00:16,  1.36s/it]Task 1, Epoch 9/20 => Loss 0.166, Train_accy 97.92:  40%|████      | 8/20 [00:12<00:16,  1.36s/it] Task 1, Epoch 9/20 => Loss 0.166, Train_accy 97.92:  45%|████▌     | 9/20 [00:12<00:13,  1.21s/it]Task 1, Epoch 10/20 => Loss 0.072, Train_accy 100.00, Test_accy 95.04:  45%|████▌     | 9/20 [00:17<00:13,  1.21s/it]Task 1, Epoch 10/20 => Loss 0.072, Train_accy 100.00, Test_accy 95.04:  50%|█████     | 10/20 [00:17<00:24,  2.49s/it]Task 1, Epoch 11/20 => Loss 0.065, Train_accy 100.00:  50%|█████     | 10/20 [00:18<00:24,  2.49s/it]                 Task 1, Epoch 11/20 => Loss 0.065, Train_accy 100.00:  55%|█████▌    | 11/20 [00:18<00:17,  2.00s/it]Task 1, Epoch 12/20 => Loss 0.064, Train_accy 100.00:  55%|█████▌    | 11/20 [00:19<00:17,  2.00s/it]Task 1, Epoch 12/20 => Loss 0.064, Train_accy 100.00:  60%|██████    | 12/20 [00:19<00:13,  1.67s/it]Task 1, Epoch 13/20 => Loss 0.044, Train_accy 97.92:  60%|██████    | 12/20 [00:20<00:13,  1.67s/it] Task 1, Epoch 13/20 => Loss 0.044, Train_accy 97.92:  65%|██████▌   | 13/20 [00:20<00:10,  1.45s/it]Task 1, Epoch 14/20 => Loss 0.041, Train_accy 100.00:  65%|██████▌   | 13/20 [00:21<00:10,  1.45s/it]Task 1, Epoch 14/20 => Loss 0.041, Train_accy 100.00:  70%|███████   | 14/20 [00:21<00:07,  1.27s/it]Task 1, Epoch 15/20 => Loss 0.029, Train_accy 100.00, Test_accy 96.25:  70%|███████   | 14/20 [00:26<00:07,  1.27s/it]Task 1, Epoch 15/20 => Loss 0.029, Train_accy 100.00, Test_accy 96.25:  75%|███████▌  | 15/20 [00:26<00:12,  2.48s/it]Task 1, Epoch 16/20 => Loss 0.017, Train_accy 100.00:  75%|███████▌  | 15/20 [00:27<00:12,  2.48s/it]                 Task 1, Epoch 16/20 => Loss 0.017, Train_accy 100.00:  80%|████████  | 16/20 [00:27<00:07,  1.97s/it]Task 1, Epoch 17/20 => Loss 0.100, Train_accy 97.92:  80%|████████  | 16/20 [00:28<00:07,  1.97s/it] Task 1, Epoch 17/20 => Loss 0.100, Train_accy 97.92:  85%|████████▌ | 17/20 [00:28<00:04,  1.64s/it]Task 1, Epoch 18/20 => Loss 0.022, Train_accy 100.00:  85%|████████▌ | 17/20 [00:28<00:04,  1.64s/it]Task 1, Epoch 18/20 => Loss 0.022, Train_accy 100.00:  90%|█████████ | 18/20 [00:28<00:02,  1.39s/it]Task 1, Epoch 19/20 => Loss 0.053, Train_accy 97.92:  90%|█████████ | 18/20 [00:29<00:02,  1.39s/it] Task 1, Epoch 19/20 => Loss 0.053, Train_accy 97.92:  95%|█████████▌| 19/20 [00:29<00:01,  1.24s/it]Task 1, Epoch 20/20 => Loss 0.020, Train_accy 100.00, Test_accy 96.25:  95%|█████████▌| 19/20 [00:35<00:01,  1.24s/it]Task 1, Epoch 20/20 => Loss 0.020, Train_accy 100.00, Test_accy 96.25: 100%|██████████| 20/20 [00:35<00:00,  2.50s/it]Task 1, Epoch 20/20 => Loss 0.020, Train_accy 100.00, Test_accy 96.25: 100%|██████████| 20/20 [00:35<00:00,  1.76s/it]
2024-05-10 03:15:44,117 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.020, Train_accy 100.00, Test_accy 96.25
2024-05-10 03:15:48,661 [trainer.py] => No NME accuracy.
2024-05-10 03:15:48,662 [trainer.py] => CNN: {'total': 96.25, '00-04': 90.91, '05-09': 99.07, 'old': 90.91, 'new': 99.07}
2024-05-10 03:15:48,662 [trainer.py] => CNN top1 curve: [95.1, 96.25]
2024-05-10 03:15:48,662 [trainer.py] => CNN top5 curve: [100.0, 99.15]

Average Accuracy (CNN): 95.68
2024-05-10 03:15:48,662 [trainer.py] => Average Accuracy (CNN): 95.68 

2024-05-10 03:15:48,662 [trainer.py] => Train Time: 119.9
2024-05-10 03:15:48,662 [trainer.py] => Test Time: 6.54 

2024-05-10 03:15:48,664 [trainer.py] => All params: 89677106
2024-05-10 03:15:48,665 [trainer.py] => Trainable params: 89677106
2024-05-10 03:15:49,244 [coda_prompt.py] => Learning on 10-15
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.486, Train_accy 48.96:   0%|          | 0/20 [00:01<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.486, Train_accy 48.96:   5%|▌         | 1/20 [00:01<00:22,  1.20s/it]Task 2, Epoch 2/20 => Loss 0.711, Train_accy 78.12:   5%|▌         | 1/20 [00:02<00:22,  1.20s/it]Task 2, Epoch 2/20 => Loss 0.711, Train_accy 78.12:  10%|█         | 2/20 [00:02<00:21,  1.21s/it]Task 2, Epoch 3/20 => Loss 0.371, Train_accy 92.71:  10%|█         | 2/20 [00:03<00:21,  1.21s/it]Task 2, Epoch 3/20 => Loss 0.371, Train_accy 92.71:  15%|█▌        | 3/20 [00:03<00:20,  1.21s/it]Task 2, Epoch 4/20 => Loss 0.188, Train_accy 96.88:  15%|█▌        | 3/20 [00:04<00:20,  1.21s/it]Task 2, Epoch 4/20 => Loss 0.188, Train_accy 96.88:  20%|██        | 4/20 [00:04<00:19,  1.22s/it]Task 2, Epoch 5/20 => Loss 0.142, Train_accy 97.92, Test_accy 95.83:  20%|██        | 4/20 [00:13<00:19,  1.22s/it]Task 2, Epoch 5/20 => Loss 0.142, Train_accy 97.92, Test_accy 95.83:  25%|██▌       | 5/20 [00:13<00:59,  3.96s/it]Task 2, Epoch 6/20 => Loss 0.105, Train_accy 96.88:  25%|██▌       | 5/20 [00:14<00:59,  3.96s/it]                 Task 2, Epoch 6/20 => Loss 0.105, Train_accy 96.88:  30%|███       | 6/20 [00:14<00:42,  3.04s/it]Task 2, Epoch 7/20 => Loss 0.049, Train_accy 98.96:  30%|███       | 6/20 [00:16<00:42,  3.04s/it]Task 2, Epoch 7/20 => Loss 0.049, Train_accy 98.96:  35%|███▌      | 7/20 [00:16<00:31,  2.44s/it]Task 2, Epoch 8/20 => Loss 0.030, Train_accy 100.00:  35%|███▌      | 7/20 [00:17<00:31,  2.44s/it]Task 2, Epoch 8/20 => Loss 0.030, Train_accy 100.00:  40%|████      | 8/20 [00:17<00:24,  2.08s/it]Task 2, Epoch 9/20 => Loss 0.017, Train_accy 100.00:  40%|████      | 8/20 [00:18<00:24,  2.08s/it]Task 2, Epoch 9/20 => Loss 0.017, Train_accy 100.00:  45%|████▌     | 9/20 [00:18<00:20,  1.83s/it]Task 2, Epoch 10/20 => Loss 0.014, Train_accy 100.00, Test_accy 96.38:  45%|████▌     | 9/20 [00:27<00:20,  1.83s/it]Task 2, Epoch 10/20 => Loss 0.014, Train_accy 100.00, Test_accy 96.38:  50%|█████     | 10/20 [00:27<00:39,  3.97s/it]Task 2, Epoch 11/20 => Loss 0.012, Train_accy 100.00:  50%|█████     | 10/20 [00:28<00:39,  3.97s/it]                 Task 2, Epoch 11/20 => Loss 0.012, Train_accy 100.00:  55%|█████▌    | 11/20 [00:28<00:28,  3.15s/it]Task 2, Epoch 12/20 => Loss 0.027, Train_accy 100.00:  55%|█████▌    | 11/20 [00:30<00:28,  3.15s/it]Task 2, Epoch 12/20 => Loss 0.027, Train_accy 100.00:  60%|██████    | 12/20 [00:30<00:20,  2.59s/it]Task 2, Epoch 13/20 => Loss 0.009, Train_accy 100.00:  60%|██████    | 12/20 [00:31<00:20,  2.59s/it]Task 2, Epoch 13/20 => Loss 0.009, Train_accy 100.00:  65%|██████▌   | 13/20 [00:31<00:15,  2.19s/it]Task 2, Epoch 14/20 => Loss 0.009, Train_accy 100.00:  65%|██████▌   | 13/20 [00:32<00:15,  2.19s/it]Task 2, Epoch 14/20 => Loss 0.009, Train_accy 100.00:  70%|███████   | 14/20 [00:32<00:11,  1.93s/it]Task 2, Epoch 15/20 => Loss 0.010, Train_accy 100.00, Test_accy 96.38:  70%|███████   | 14/20 [00:41<00:11,  1.93s/it]Task 2, Epoch 15/20 => Loss 0.010, Train_accy 100.00, Test_accy 96.38:  75%|███████▌  | 15/20 [00:41<00:19,  4.00s/it]Task 2, Epoch 16/20 => Loss 0.017, Train_accy 100.00:  75%|███████▌  | 15/20 [00:42<00:19,  4.00s/it]                 Task 2, Epoch 16/20 => Loss 0.017, Train_accy 100.00:  80%|████████  | 16/20 [00:42<00:12,  3.16s/it]Task 2, Epoch 17/20 => Loss 0.018, Train_accy 98.96:  80%|████████  | 16/20 [00:43<00:12,  3.16s/it] Task 2, Epoch 17/20 => Loss 0.018, Train_accy 98.96:  85%|████████▌ | 17/20 [00:43<00:07,  2.57s/it]Task 2, Epoch 18/20 => Loss 0.003, Train_accy 100.00:  85%|████████▌ | 17/20 [00:45<00:07,  2.57s/it]Task 2, Epoch 18/20 => Loss 0.003, Train_accy 100.00:  90%|█████████ | 18/20 [00:45<00:04,  2.17s/it]Task 2, Epoch 19/20 => Loss 0.010, Train_accy 100.00:  90%|█████████ | 18/20 [00:46<00:04,  2.17s/it]Task 2, Epoch 19/20 => Loss 0.010, Train_accy 100.00:  95%|█████████▌| 19/20 [00:46<00:01,  1.90s/it]Task 2, Epoch 20/20 => Loss 0.049, Train_accy 98.96, Test_accy 96.31:  95%|█████████▌| 19/20 [00:55<00:01,  1.90s/it]Task 2, Epoch 20/20 => Loss 0.049, Train_accy 98.96, Test_accy 96.31: 100%|██████████| 20/20 [00:55<00:00,  3.94s/it]Task 2, Epoch 20/20 => Loss 0.049, Train_accy 98.96, Test_accy 96.31: 100%|██████████| 20/20 [00:55<00:00,  2.75s/it]
2024-05-10 03:16:44,346 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.049, Train_accy 98.96, Test_accy 96.31
2024-05-10 03:16:51,958 [trainer.py] => No NME accuracy.
2024-05-10 03:16:51,958 [trainer.py] => CNN: {'total': 96.31, '00-04': 87.06, '05-09': 97.41, '10-14': 99.67, 'old': 93.83, 'new': 99.67}
2024-05-10 03:16:51,958 [trainer.py] => CNN top1 curve: [95.1, 96.25, 96.31]
2024-05-10 03:16:51,958 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.24]

Average Accuracy (CNN): 95.89
2024-05-10 03:16:51,959 [trainer.py] => Average Accuracy (CNN): 95.89 

2024-05-10 03:16:51,959 [trainer.py] => Train Time: 230.1
2024-05-10 03:16:51,959 [trainer.py] => Test Time: 14.15 

2024-05-10 03:16:51,960 [trainer.py] => All params: 89677106
2024-05-10 03:16:51,961 [trainer.py] => Trainable params: 89677106
2024-05-10 03:16:52,632 [coda_prompt.py] => Learning on 15-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.422, Train_accy 46.25:   0%|          | 0/20 [00:02<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.422, Train_accy 46.25:   5%|▌         | 1/20 [00:02<00:47,  2.51s/it]Task 3, Epoch 2/20 => Loss 0.521, Train_accy 81.25:   5%|▌         | 1/20 [00:05<00:47,  2.51s/it]Task 3, Epoch 2/20 => Loss 0.521, Train_accy 81.25:  10%|█         | 2/20 [00:05<00:45,  2.55s/it]Task 3, Epoch 3/20 => Loss 0.268, Train_accy 92.08:  10%|█         | 2/20 [00:07<00:45,  2.55s/it]Task 3, Epoch 3/20 => Loss 0.268, Train_accy 92.08:  15%|█▌        | 3/20 [00:07<00:43,  2.56s/it]Task 3, Epoch 4/20 => Loss 0.184, Train_accy 92.92:  15%|█▌        | 3/20 [00:10<00:43,  2.56s/it]Task 3, Epoch 4/20 => Loss 0.184, Train_accy 92.92:  20%|██        | 4/20 [00:10<00:40,  2.54s/it]Task 3, Epoch 5/20 => Loss 0.153, Train_accy 95.83, Test_accy 83.63:  20%|██        | 4/20 [00:27<00:40,  2.54s/it]Task 3, Epoch 5/20 => Loss 0.153, Train_accy 95.83, Test_accy 83.63:  25%|██▌       | 5/20 [00:27<01:56,  7.79s/it]Task 3, Epoch 6/20 => Loss 0.147, Train_accy 93.33:  25%|██▌       | 5/20 [00:29<01:56,  7.79s/it]                 Task 3, Epoch 6/20 => Loss 0.147, Train_accy 93.33:  30%|███       | 6/20 [00:29<01:23,  6.00s/it]Task 3, Epoch 7/20 => Loss 0.095, Train_accy 97.50:  30%|███       | 6/20 [00:32<01:23,  6.00s/it]Task 3, Epoch 7/20 => Loss 0.095, Train_accy 97.50:  35%|███▌      | 7/20 [00:32<01:03,  4.89s/it]Task 3, Epoch 8/20 => Loss 0.103, Train_accy 96.67:  35%|███▌      | 7/20 [00:34<01:03,  4.89s/it]Task 3, Epoch 8/20 => Loss 0.103, Train_accy 96.67:  40%|████      | 8/20 [00:34<00:49,  4.15s/it]Task 3, Epoch 9/20 => Loss 0.079, Train_accy 97.08:  40%|████      | 8/20 [00:37<00:49,  4.15s/it]Task 3, Epoch 9/20 => Loss 0.079, Train_accy 97.08:  45%|████▌     | 9/20 [00:37<00:40,  3.65s/it]Task 3, Epoch 10/20 => Loss 0.072, Train_accy 97.92, Test_accy 88.69:  45%|████▌     | 9/20 [00:54<00:40,  3.65s/it]Task 3, Epoch 10/20 => Loss 0.072, Train_accy 97.92, Test_accy 88.69:  50%|█████     | 10/20 [00:54<01:17,  7.75s/it]Task 3, Epoch 11/20 => Loss 0.093, Train_accy 97.92:  50%|█████     | 10/20 [00:56<01:17,  7.75s/it]                 Task 3, Epoch 11/20 => Loss 0.093, Train_accy 97.92:  55%|█████▌    | 11/20 [00:56<00:55,  6.14s/it]Task 3, Epoch 12/20 => Loss 0.087, Train_accy 97.50:  55%|█████▌    | 11/20 [00:59<00:55,  6.14s/it]Task 3, Epoch 12/20 => Loss 0.087, Train_accy 97.50:  60%|██████    | 12/20 [00:59<00:40,  5.03s/it]Task 3, Epoch 13/20 => Loss 0.132, Train_accy 95.83:  60%|██████    | 12/20 [01:01<00:40,  5.03s/it]Task 3, Epoch 13/20 => Loss 0.132, Train_accy 95.83:  65%|██████▌   | 13/20 [01:01<00:29,  4.27s/it]Task 3, Epoch 14/20 => Loss 0.083, Train_accy 97.92:  65%|██████▌   | 13/20 [01:04<00:29,  4.27s/it]Task 3, Epoch 14/20 => Loss 0.083, Train_accy 97.92:  70%|███████   | 14/20 [01:04<00:22,  3.75s/it]Task 3, Epoch 15/20 => Loss 0.086, Train_accy 97.50, Test_accy 90.38:  70%|███████   | 14/20 [01:21<00:22,  3.75s/it]Task 3, Epoch 15/20 => Loss 0.086, Train_accy 97.50, Test_accy 90.38:  75%|███████▌  | 15/20 [01:21<00:38,  7.74s/it]Task 3, Epoch 16/20 => Loss 0.067, Train_accy 97.08:  75%|███████▌  | 15/20 [01:24<00:38,  7.74s/it]                 Task 3, Epoch 16/20 => Loss 0.067, Train_accy 97.08:  80%|████████  | 16/20 [01:24<00:24,  6.18s/it]Task 3, Epoch 17/20 => Loss 0.057, Train_accy 98.75:  80%|████████  | 16/20 [01:26<00:24,  6.18s/it]Task 3, Epoch 17/20 => Loss 0.057, Train_accy 98.75:  85%|████████▌ | 17/20 [01:26<00:15,  5.12s/it]Task 3, Epoch 18/20 => Loss 0.039, Train_accy 98.75:  85%|████████▌ | 17/20 [01:29<00:15,  5.12s/it]Task 3, Epoch 18/20 => Loss 0.039, Train_accy 98.75:  90%|█████████ | 18/20 [01:29<00:08,  4.35s/it]Task 3, Epoch 19/20 => Loss 0.070, Train_accy 97.08:  90%|█████████ | 18/20 [01:32<00:08,  4.35s/it]Task 3, Epoch 19/20 => Loss 0.070, Train_accy 97.08:  95%|█████████▌| 19/20 [01:32<00:03,  3.87s/it]Task 3, Epoch 20/20 => Loss 0.102, Train_accy 95.83, Test_accy 90.62:  95%|█████████▌| 19/20 [01:48<00:03,  3.87s/it]Task 3, Epoch 20/20 => Loss 0.102, Train_accy 95.83, Test_accy 90.62: 100%|██████████| 20/20 [01:48<00:00,  7.80s/it]Task 3, Epoch 20/20 => Loss 0.102, Train_accy 95.83, Test_accy 90.62: 100%|██████████| 20/20 [01:48<00:00,  5.45s/it]
2024-05-10 03:18:41,611 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.102, Train_accy 95.83, Test_accy 90.62
2024-05-10 03:18:56,017 [trainer.py] => No NME accuracy.
2024-05-10 03:18:56,017 [trainer.py] => CNN: {'total': 90.62, '00-04': 87.06, '05-09': 97.22, '10-14': 98.37, '15-19': 85.45, 'old': 95.69, 'new': 85.45}
2024-05-10 03:18:56,017 [trainer.py] => CNN top1 curve: [95.1, 96.25, 96.31, 90.62]
2024-05-10 03:18:56,017 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.24, 99.12]

Average Accuracy (CNN): 94.57
2024-05-10 03:18:56,017 [trainer.py] => Average Accuracy (CNN): 94.57 

2024-05-10 03:18:56,017 [trainer.py] => Train Time: 448.05
2024-05-10 03:18:56,017 [trainer.py] => Test Time: 28.55 

2024-05-10 03:18:56,018 [trainer.py] => All params: 89677106
2024-05-10 03:18:56,019 [trainer.py] => Trainable params: 89677106
2024-05-10 03:18:57,007 [coda_prompt.py] => Learning on 20-25
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.112, Train_accy 57.08:   0%|          | 0/20 [00:02<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.112, Train_accy 57.08:   5%|▌         | 1/20 [00:02<00:51,  2.73s/it]Task 4, Epoch 2/20 => Loss 0.423, Train_accy 84.17:   5%|▌         | 1/20 [00:05<00:51,  2.73s/it]Task 4, Epoch 2/20 => Loss 0.423, Train_accy 84.17:  10%|█         | 2/20 [00:05<00:47,  2.61s/it]Task 4, Epoch 3/20 => Loss 0.184, Train_accy 95.00:  10%|█         | 2/20 [00:07<00:47,  2.61s/it]Task 4, Epoch 3/20 => Loss 0.184, Train_accy 95.00:  15%|█▌        | 3/20 [00:07<00:44,  2.63s/it]Task 4, Epoch 4/20 => Loss 0.153, Train_accy 94.58:  15%|█▌        | 3/20 [00:10<00:44,  2.63s/it]Task 4, Epoch 4/20 => Loss 0.153, Train_accy 94.58:  20%|██        | 4/20 [00:10<00:41,  2.59s/it]Task 4, Epoch 5/20 => Loss 0.125, Train_accy 95.42, Test_accy 77.60:  20%|██        | 4/20 [00:33<00:41,  2.59s/it]Task 4, Epoch 5/20 => Loss 0.125, Train_accy 95.42, Test_accy 77.60:  25%|██▌       | 5/20 [00:33<02:29,  9.99s/it]Task 4, Epoch 6/20 => Loss 0.084, Train_accy 97.08:  25%|██▌       | 5/20 [00:36<02:29,  9.99s/it]                 Task 4, Epoch 6/20 => Loss 0.084, Train_accy 97.08:  30%|███       | 6/20 [00:36<01:44,  7.46s/it]Task 4, Epoch 7/20 => Loss 0.111, Train_accy 95.00:  30%|███       | 6/20 [00:38<01:44,  7.46s/it]Task 4, Epoch 7/20 => Loss 0.111, Train_accy 95.00:  35%|███▌      | 7/20 [00:38<01:16,  5.86s/it]Task 4, Epoch 8/20 => Loss 0.089, Train_accy 96.67:  35%|███▌      | 7/20 [00:41<01:16,  5.86s/it]Task 4, Epoch 8/20 => Loss 0.089, Train_accy 96.67:  40%|████      | 8/20 [00:41<00:57,  4.82s/it]Task 4, Epoch 9/20 => Loss 0.053, Train_accy 98.75:  40%|████      | 8/20 [00:43<00:57,  4.82s/it]Task 4, Epoch 9/20 => Loss 0.053, Train_accy 98.75:  45%|████▌     | 9/20 [00:43<00:45,  4.10s/it]Task 4, Epoch 10/20 => Loss 0.069, Train_accy 97.92, Test_accy 80.81:  45%|████▌     | 9/20 [01:06<00:45,  4.10s/it]Task 4, Epoch 10/20 => Loss 0.069, Train_accy 97.92, Test_accy 80.81:  50%|█████     | 10/20 [01:06<01:39,  9.96s/it]Task 4, Epoch 11/20 => Loss 0.045, Train_accy 99.17:  50%|█████     | 10/20 [01:09<01:39,  9.96s/it]                 Task 4, Epoch 11/20 => Loss 0.045, Train_accy 99.17:  55%|█████▌    | 11/20 [01:09<01:09,  7.68s/it]Task 4, Epoch 12/20 => Loss 0.071, Train_accy 97.50:  55%|█████▌    | 11/20 [01:11<01:09,  7.68s/it]Task 4, Epoch 12/20 => Loss 0.071, Train_accy 97.50:  60%|██████    | 12/20 [01:11<00:48,  6.11s/it]Task 4, Epoch 13/20 => Loss 0.037, Train_accy 98.75:  60%|██████    | 12/20 [01:14<00:48,  6.11s/it]Task 4, Epoch 13/20 => Loss 0.037, Train_accy 98.75:  65%|██████▌   | 13/20 [01:14<00:35,  5.03s/it]Task 4, Epoch 14/20 => Loss 0.056, Train_accy 97.08:  65%|██████▌   | 13/20 [01:17<00:35,  5.03s/it]Task 4, Epoch 14/20 => Loss 0.056, Train_accy 97.08:  70%|███████   | 14/20 [01:17<00:25,  4.30s/it]Task 4, Epoch 15/20 => Loss 0.053, Train_accy 98.33, Test_accy 80.57:  70%|███████   | 14/20 [01:40<00:25,  4.30s/it]Task 4, Epoch 15/20 => Loss 0.053, Train_accy 98.33, Test_accy 80.57:  75%|███████▌  | 15/20 [01:40<00:49,  9.93s/it]Task 4, Epoch 16/20 => Loss 0.097, Train_accy 96.67:  75%|███████▌  | 15/20 [01:42<00:49,  9.93s/it]                 Task 4, Epoch 16/20 => Loss 0.097, Train_accy 96.67:  80%|████████  | 16/20 [01:42<00:30,  7.72s/it]Task 4, Epoch 17/20 => Loss 0.055, Train_accy 98.75:  80%|████████  | 16/20 [01:45<00:30,  7.72s/it]Task 4, Epoch 17/20 => Loss 0.055, Train_accy 98.75:  85%|████████▌ | 17/20 [01:45<00:18,  6.17s/it]Task 4, Epoch 18/20 => Loss 0.044, Train_accy 98.33:  85%|████████▌ | 17/20 [01:47<00:18,  6.17s/it]Task 4, Epoch 18/20 => Loss 0.044, Train_accy 98.33:  90%|█████████ | 18/20 [01:47<00:10,  5.08s/it]Task 4, Epoch 19/20 => Loss 0.061, Train_accy 97.50:  90%|█████████ | 18/20 [01:50<00:10,  5.08s/it]Task 4, Epoch 19/20 => Loss 0.061, Train_accy 97.50:  95%|█████████▌| 19/20 [01:50<00:04,  4.31s/it]Task 4, Epoch 20/20 => Loss 0.057, Train_accy 97.50, Test_accy 80.84:  95%|█████████▌| 19/20 [02:13<00:04,  4.31s/it]Task 4, Epoch 20/20 => Loss 0.057, Train_accy 97.50, Test_accy 80.84: 100%|██████████| 20/20 [02:13<00:00,  9.91s/it]Task 4, Epoch 20/20 => Loss 0.057, Train_accy 97.50, Test_accy 80.84: 100%|██████████| 20/20 [02:13<00:00,  6.66s/it]
2024-05-10 03:21:10,226 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.057, Train_accy 97.50, Test_accy 80.84
2024-05-10 03:21:30,739 [trainer.py] => No NME accuracy.
2024-05-10 03:21:30,740 [trainer.py] => CNN: {'total': 80.84, '00-04': 86.36, '05-09': 86.85, '10-14': 89.54, '15-19': 74.17, '20-24': 80.24, 'old': 81.1, 'new': 80.24}
2024-05-10 03:21:30,740 [trainer.py] => CNN top1 curve: [95.1, 96.25, 96.31, 90.62, 80.84]
2024-05-10 03:21:30,740 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.24, 99.12, 98.73]

Average Accuracy (CNN): 91.82
2024-05-10 03:21:30,741 [trainer.py] => Average Accuracy (CNN): 91.82 

2024-05-10 03:21:30,741 [trainer.py] => Train Time: 714.48
2024-05-10 03:21:30,741 [trainer.py] => Test Time: 49.06 

2024-05-10 03:21:30,742 [trainer.py] => All params: 89677106
2024-05-10 03:21:30,744 [trainer.py] => Trainable params: 89677106
2024-05-10 03:21:31,912 [coda_prompt.py] => Learning on 25-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.732, Train_accy 11.46:   0%|          | 0/20 [00:01<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.732, Train_accy 11.46:   5%|▌         | 1/20 [00:01<00:24,  1.28s/it]Task 5, Epoch 2/20 => Loss 1.467, Train_accy 35.42:   5%|▌         | 1/20 [00:02<00:24,  1.28s/it]Task 5, Epoch 2/20 => Loss 1.467, Train_accy 35.42:  10%|█         | 2/20 [00:02<00:22,  1.23s/it]Task 5, Epoch 3/20 => Loss 0.949, Train_accy 70.83:  10%|█         | 2/20 [00:03<00:22,  1.23s/it]Task 5, Epoch 3/20 => Loss 0.949, Train_accy 70.83:  15%|█▌        | 3/20 [00:03<00:21,  1.24s/it]Task 5, Epoch 4/20 => Loss 0.519, Train_accy 82.29:  15%|█▌        | 3/20 [00:05<00:21,  1.24s/it]Task 5, Epoch 4/20 => Loss 0.519, Train_accy 82.29:  20%|██        | 4/20 [00:05<00:20,  1.28s/it]Task 5, Epoch 5/20 => Loss 0.236, Train_accy 92.71, Test_accy 77.50:  20%|██        | 4/20 [00:28<00:20,  1.28s/it]Task 5, Epoch 5/20 => Loss 0.236, Train_accy 92.71, Test_accy 77.50:  25%|██▌       | 5/20 [00:28<02:18,  9.25s/it]Task 5, Epoch 6/20 => Loss 0.144, Train_accy 97.92:  25%|██▌       | 5/20 [00:29<02:18,  9.25s/it]                 Task 5, Epoch 6/20 => Loss 0.144, Train_accy 97.92:  30%|███       | 6/20 [00:29<01:31,  6.54s/it]Task 5, Epoch 7/20 => Loss 0.119, Train_accy 98.96:  30%|███       | 6/20 [00:30<01:31,  6.54s/it]Task 5, Epoch 7/20 => Loss 0.119, Train_accy 98.96:  35%|███▌      | 7/20 [00:30<01:02,  4.81s/it]Task 5, Epoch 8/20 => Loss 0.107, Train_accy 96.88:  35%|███▌      | 7/20 [00:32<01:02,  4.81s/it]Task 5, Epoch 8/20 => Loss 0.107, Train_accy 96.88:  40%|████      | 8/20 [00:32<00:44,  3.74s/it]Task 5, Epoch 9/20 => Loss 0.063, Train_accy 98.96:  40%|████      | 8/20 [00:33<00:44,  3.74s/it]Task 5, Epoch 9/20 => Loss 0.063, Train_accy 98.96:  45%|████▌     | 9/20 [00:33<00:32,  2.98s/it]Task 5, Epoch 10/20 => Loss 0.062, Train_accy 98.96, Test_accy 79.35:  45%|████▌     | 9/20 [00:57<00:32,  2.98s/it]Task 5, Epoch 10/20 => Loss 0.062, Train_accy 98.96, Test_accy 79.35:  50%|█████     | 10/20 [00:57<01:32,  9.27s/it]Task 5, Epoch 11/20 => Loss 0.067, Train_accy 98.96:  50%|█████     | 10/20 [00:58<01:32,  9.27s/it]                 Task 5, Epoch 11/20 => Loss 0.067, Train_accy 98.96:  55%|█████▌    | 11/20 [00:58<01:01,  6.84s/it]Task 5, Epoch 12/20 => Loss 0.031, Train_accy 100.00:  55%|█████▌    | 11/20 [00:59<01:01,  6.84s/it]Task 5, Epoch 12/20 => Loss 0.031, Train_accy 100.00:  60%|██████    | 12/20 [00:59<00:41,  5.14s/it]Task 5, Epoch 13/20 => Loss 0.045, Train_accy 98.96:  60%|██████    | 12/20 [01:01<00:41,  5.14s/it] Task 5, Epoch 13/20 => Loss 0.045, Train_accy 98.96:  65%|██████▌   | 13/20 [01:01<00:28,  4.01s/it]Task 5, Epoch 14/20 => Loss 0.034, Train_accy 100.00:  65%|██████▌   | 13/20 [01:02<00:28,  4.01s/it]Task 5, Epoch 14/20 => Loss 0.034, Train_accy 100.00:  70%|███████   | 14/20 [01:02<00:19,  3.19s/it]Task 5, Epoch 15/20 => Loss 0.028, Train_accy 100.00, Test_accy 79.35:  70%|███████   | 14/20 [01:25<00:19,  3.19s/it]Task 5, Epoch 15/20 => Loss 0.028, Train_accy 100.00, Test_accy 79.35:  75%|███████▌  | 15/20 [01:25<00:46,  9.32s/it]Task 5, Epoch 16/20 => Loss 0.032, Train_accy 98.96:  75%|███████▌  | 15/20 [01:27<00:46,  9.32s/it]                  Task 5, Epoch 16/20 => Loss 0.032, Train_accy 98.96:  80%|████████  | 16/20 [01:27<00:27,  6.91s/it]Task 5, Epoch 17/20 => Loss 0.053, Train_accy 97.92:  80%|████████  | 16/20 [01:28<00:27,  6.91s/it]Task 5, Epoch 17/20 => Loss 0.053, Train_accy 97.92:  85%|████████▌ | 17/20 [01:28<00:15,  5.20s/it]Task 5, Epoch 18/20 => Loss 0.022, Train_accy 100.00:  85%|████████▌ | 17/20 [01:29<00:15,  5.20s/it]Task 5, Epoch 18/20 => Loss 0.022, Train_accy 100.00:  90%|█████████ | 18/20 [01:29<00:08,  4.04s/it]Task 5, Epoch 19/20 => Loss 0.021, Train_accy 100.00:  90%|█████████ | 18/20 [01:31<00:08,  4.04s/it]Task 5, Epoch 19/20 => Loss 0.021, Train_accy 100.00:  95%|█████████▌| 19/20 [01:31<00:03,  3.26s/it]Task 5, Epoch 20/20 => Loss 0.044, Train_accy 98.96, Test_accy 79.33:  95%|█████████▌| 19/20 [01:54<00:03,  3.26s/it]Task 5, Epoch 20/20 => Loss 0.044, Train_accy 98.96, Test_accy 79.33: 100%|██████████| 20/20 [01:54<00:00,  9.39s/it]Task 5, Epoch 20/20 => Loss 0.044, Train_accy 98.96, Test_accy 79.33: 100%|██████████| 20/20 [01:54<00:00,  5.74s/it]
2024-05-10 03:23:26,796 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.044, Train_accy 98.96, Test_accy 79.33
2024-05-10 03:23:49,268 [trainer.py] => No NME accuracy.
2024-05-10 03:23:49,269 [trainer.py] => CNN: {'total': 79.33, '00-04': 75.17, '05-09': 85.37, '10-14': 89.71, '15-19': 70.62, '20-24': 79.36, '25-29': 89.42, 'old': 78.4, 'new': 89.42}
2024-05-10 03:23:49,269 [trainer.py] => CNN top1 curve: [95.1, 96.25, 96.31, 90.62, 80.84, 79.33]
2024-05-10 03:23:49,269 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.24, 99.12, 98.73, 97.99]

Average Accuracy (CNN): 89.74
2024-05-10 03:23:49,269 [trainer.py] => Average Accuracy (CNN): 89.74 

2024-05-10 03:23:49,269 [trainer.py] => Train Time: 944.24
2024-05-10 03:23:49,270 [trainer.py] => Test Time: 71.53 

2024-05-10 03:23:49,271 [trainer.py] => All params: 89677106
2024-05-10 03:23:49,272 [trainer.py] => Trainable params: 89677106
2024-05-10 03:23:50,679 [coda_prompt.py] => Learning on 30-35
  0%|          | 0/20 [00:00<?, ?it/s]Task 6, Epoch 1/20 => Loss 2.382, Train_accy 18.06:   0%|          | 0/20 [00:01<?, ?it/s]Task 6, Epoch 1/20 => Loss 2.382, Train_accy 18.06:   5%|▌         | 1/20 [00:01<00:33,  1.74s/it]Task 6, Epoch 2/20 => Loss 0.831, Train_accy 65.97:   5%|▌         | 1/20 [00:03<00:33,  1.74s/it]Task 6, Epoch 2/20 => Loss 0.831, Train_accy 65.97:  10%|█         | 2/20 [00:03<00:31,  1.72s/it]Task 6, Epoch 3/20 => Loss 0.317, Train_accy 93.75:  10%|█         | 2/20 [00:05<00:31,  1.72s/it]Task 6, Epoch 3/20 => Loss 0.317, Train_accy 93.75:  15%|█▌        | 3/20 [00:05<00:28,  1.69s/it]Task 6, Epoch 4/20 => Loss 0.150, Train_accy 97.22:  15%|█▌        | 3/20 [00:06<00:28,  1.69s/it]Task 6, Epoch 4/20 => Loss 0.150, Train_accy 97.22:  20%|██        | 4/20 [00:06<00:26,  1.66s/it]Task 6, Epoch 5/20 => Loss 0.079, Train_accy 98.61, Test_accy 75.51:  20%|██        | 4/20 [00:34<00:26,  1.66s/it]Task 6, Epoch 5/20 => Loss 0.079, Train_accy 98.61, Test_accy 75.51:  25%|██▌       | 5/20 [00:34<02:47, 11.18s/it]Task 6, Epoch 6/20 => Loss 0.034, Train_accy 100.00:  25%|██▌       | 5/20 [00:36<02:47, 11.18s/it]                Task 6, Epoch 6/20 => Loss 0.034, Train_accy 100.00:  30%|███       | 6/20 [00:36<01:51,  7.98s/it]Task 6, Epoch 7/20 => Loss 0.059, Train_accy 97.92:  30%|███       | 6/20 [00:38<01:51,  7.98s/it] Task 6, Epoch 7/20 => Loss 0.059, Train_accy 97.92:  35%|███▌      | 7/20 [00:38<01:17,  5.94s/it]Task 6, Epoch 8/20 => Loss 0.039, Train_accy 99.31:  35%|███▌      | 7/20 [00:40<01:17,  5.94s/it]Task 6, Epoch 8/20 => Loss 0.039, Train_accy 99.31:  40%|████      | 8/20 [00:40<00:55,  4.60s/it]Task 6, Epoch 9/20 => Loss 0.020, Train_accy 100.00:  40%|████      | 8/20 [00:41<00:55,  4.60s/it]Task 6, Epoch 9/20 => Loss 0.020, Train_accy 100.00:  45%|████▌     | 9/20 [00:41<00:40,  3.69s/it]Task 6, Epoch 10/20 => Loss 0.040, Train_accy 99.31, Test_accy 78.28:  45%|████▌     | 9/20 [01:09<00:40,  3.69s/it]Task 6, Epoch 10/20 => Loss 0.040, Train_accy 99.31, Test_accy 78.28:  50%|█████     | 10/20 [01:09<01:51, 11.13s/it]Task 6, Epoch 11/20 => Loss 0.026, Train_accy 99.31:  50%|█████     | 10/20 [01:11<01:51, 11.13s/it]                 Task 6, Epoch 11/20 => Loss 0.026, Train_accy 99.31:  55%|█████▌    | 11/20 [01:11<01:14,  8.24s/it]Task 6, Epoch 12/20 => Loss 0.015, Train_accy 100.00:  55%|█████▌    | 11/20 [01:12<01:14,  8.24s/it]Task 6, Epoch 12/20 => Loss 0.015, Train_accy 100.00:  60%|██████    | 12/20 [01:12<00:50,  6.27s/it]Task 6, Epoch 13/20 => Loss 0.006, Train_accy 100.00:  60%|██████    | 12/20 [01:14<00:50,  6.27s/it]Task 6, Epoch 13/20 => Loss 0.006, Train_accy 100.00:  65%|██████▌   | 13/20 [01:14<00:34,  4.92s/it]Task 6, Epoch 14/20 => Loss 0.022, Train_accy 98.61:  65%|██████▌   | 13/20 [01:16<00:34,  4.92s/it] Task 6, Epoch 14/20 => Loss 0.022, Train_accy 98.61:  70%|███████   | 14/20 [01:16<00:23,  3.96s/it]Task 6, Epoch 15/20 => Loss 0.005, Train_accy 100.00, Test_accy 77.91:  70%|███████   | 14/20 [01:44<00:23,  3.96s/it]Task 6, Epoch 15/20 => Loss 0.005, Train_accy 100.00, Test_accy 77.91:  75%|███████▌  | 15/20 [01:44<00:55, 11.17s/it]Task 6, Epoch 16/20 => Loss 0.007, Train_accy 100.00:  75%|███████▌  | 15/20 [01:46<00:55, 11.17s/it]                 Task 6, Epoch 16/20 => Loss 0.007, Train_accy 100.00:  80%|████████  | 16/20 [01:46<00:33,  8.30s/it]Task 6, Epoch 17/20 => Loss 0.005, Train_accy 100.00:  80%|████████  | 16/20 [01:47<00:33,  8.30s/it]Task 6, Epoch 17/20 => Loss 0.005, Train_accy 100.00:  85%|████████▌ | 17/20 [01:47<00:18,  6.31s/it]Task 6, Epoch 18/20 => Loss 0.012, Train_accy 100.00:  85%|████████▌ | 17/20 [01:49<00:18,  6.31s/it]Task 6, Epoch 18/20 => Loss 0.012, Train_accy 100.00:  90%|█████████ | 18/20 [01:49<00:09,  4.91s/it]Task 6, Epoch 19/20 => Loss 0.007, Train_accy 100.00:  90%|█████████ | 18/20 [01:50<00:09,  4.91s/it]Task 6, Epoch 19/20 => Loss 0.007, Train_accy 100.00:  95%|█████████▌| 19/20 [01:50<00:03,  3.92s/it]Task 6, Epoch 20/20 => Loss 0.024, Train_accy 99.31, Test_accy 77.81:  95%|█████████▌| 19/20 [02:18<00:03,  3.92s/it]Task 6, Epoch 20/20 => Loss 0.024, Train_accy 99.31, Test_accy 77.81: 100%|██████████| 20/20 [02:18<00:00, 11.14s/it]Task 6, Epoch 20/20 => Loss 0.024, Train_accy 99.31, Test_accy 77.81: 100%|██████████| 20/20 [02:18<00:00,  6.95s/it]
2024-05-10 03:26:09,630 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.024, Train_accy 99.31, Test_accy 77.81
2024-05-10 03:26:35,942 [trainer.py] => No NME accuracy.
2024-05-10 03:26:35,943 [trainer.py] => CNN: {'total': 77.81, '00-04': 70.98, '05-09': 85.0, '10-14': 83.01, '15-19': 68.91, '20-24': 74.9, '25-29': 83.86, '30-34': 88.66, 'old': 75.85, 'new': 88.66}
2024-05-10 03:26:35,943 [trainer.py] => CNN top1 curve: [95.1, 96.25, 96.31, 90.62, 80.84, 79.33, 77.81]
2024-05-10 03:26:35,943 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.24, 99.12, 98.73, 97.99, 97.66]

Average Accuracy (CNN): 88.04
2024-05-10 03:26:35,943 [trainer.py] => Average Accuracy (CNN): 88.04 

2024-05-10 03:26:35,943 [trainer.py] => Train Time: 1222.13
2024-05-10 03:26:35,943 [trainer.py] => Test Time: 97.84 

2024-05-10 03:26:35,945 [trainer.py] => All params: 89677106
2024-05-10 03:26:35,946 [trainer.py] => Trainable params: 89677106
2024-05-10 03:26:37,576 [coda_prompt.py] => Learning on 35-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.701, Train_accy 30.21:   0%|          | 0/20 [00:01<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.701, Train_accy 30.21:   5%|▌         | 1/20 [00:01<00:24,  1.31s/it]Task 7, Epoch 2/20 => Loss 0.872, Train_accy 64.58:   5%|▌         | 1/20 [00:02<00:24,  1.31s/it]Task 7, Epoch 2/20 => Loss 0.872, Train_accy 64.58:  10%|█         | 2/20 [00:02<00:23,  1.28s/it]Task 7, Epoch 3/20 => Loss 0.556, Train_accy 81.25:  10%|█         | 2/20 [00:03<00:23,  1.28s/it]Task 7, Epoch 3/20 => Loss 0.556, Train_accy 81.25:  15%|█▌        | 3/20 [00:03<00:22,  1.31s/it]Task 7, Epoch 4/20 => Loss 0.232, Train_accy 94.79:  15%|█▌        | 3/20 [00:05<00:22,  1.31s/it]Task 7, Epoch 4/20 => Loss 0.232, Train_accy 94.79:  20%|██        | 4/20 [00:05<00:20,  1.28s/it]Task 7, Epoch 5/20 => Loss 0.227, Train_accy 93.75, Test_accy 75.27:  20%|██        | 4/20 [00:34<00:20,  1.28s/it]Task 7, Epoch 5/20 => Loss 0.227, Train_accy 93.75, Test_accy 75.27:  25%|██▌       | 5/20 [00:34<02:52, 11.48s/it]Task 7, Epoch 6/20 => Loss 0.172, Train_accy 95.83:  25%|██▌       | 5/20 [00:35<02:52, 11.48s/it]                 Task 7, Epoch 6/20 => Loss 0.172, Train_accy 95.83:  30%|███       | 6/20 [00:35<01:51,  8.00s/it]Task 7, Epoch 7/20 => Loss 0.160, Train_accy 94.79:  30%|███       | 6/20 [00:37<01:51,  8.00s/it]Task 7, Epoch 7/20 => Loss 0.160, Train_accy 94.79:  35%|███▌      | 7/20 [00:37<01:15,  5.79s/it]Task 7, Epoch 8/20 => Loss 0.109, Train_accy 97.92:  35%|███▌      | 7/20 [00:38<01:15,  5.79s/it]Task 7, Epoch 8/20 => Loss 0.109, Train_accy 97.92:  40%|████      | 8/20 [00:38<00:52,  4.34s/it]Task 7, Epoch 9/20 => Loss 0.081, Train_accy 96.88:  40%|████      | 8/20 [00:39<00:52,  4.34s/it]Task 7, Epoch 9/20 => Loss 0.081, Train_accy 96.88:  45%|████▌     | 9/20 [00:39<00:37,  3.37s/it]Task 7, Epoch 10/20 => Loss 0.099, Train_accy 95.83, Test_accy 74.45:  45%|████▌     | 9/20 [01:09<00:37,  3.37s/it]Task 7, Epoch 10/20 => Loss 0.099, Train_accy 95.83, Test_accy 74.45:  50%|█████     | 10/20 [01:09<01:54, 11.46s/it]Task 7, Epoch 11/20 => Loss 0.056, Train_accy 98.96:  50%|█████     | 10/20 [01:10<01:54, 11.46s/it]                 Task 7, Epoch 11/20 => Loss 0.056, Train_accy 98.96:  55%|█████▌    | 11/20 [01:10<01:15,  8.34s/it]Task 7, Epoch 12/20 => Loss 0.044, Train_accy 98.96:  55%|█████▌    | 11/20 [01:11<01:15,  8.34s/it]Task 7, Epoch 12/20 => Loss 0.044, Train_accy 98.96:  60%|██████    | 12/20 [01:11<00:49,  6.17s/it]Task 7, Epoch 13/20 => Loss 0.064, Train_accy 98.96:  60%|██████    | 12/20 [01:13<00:49,  6.17s/it]Task 7, Epoch 13/20 => Loss 0.064, Train_accy 98.96:  65%|██████▌   | 13/20 [01:13<00:32,  4.69s/it]Task 7, Epoch 14/20 => Loss 0.082, Train_accy 96.88:  65%|██████▌   | 13/20 [01:14<00:32,  4.69s/it]Task 7, Epoch 14/20 => Loss 0.082, Train_accy 96.88:  70%|███████   | 14/20 [01:14<00:21,  3.66s/it]Task 7, Epoch 15/20 => Loss 0.063, Train_accy 98.96, Test_accy 73.60:  70%|███████   | 14/20 [01:43<00:21,  3.66s/it]Task 7, Epoch 15/20 => Loss 0.063, Train_accy 98.96, Test_accy 73.60:  75%|███████▌  | 15/20 [01:43<00:57, 11.45s/it]Task 7, Epoch 16/20 => Loss 0.037, Train_accy 98.96:  75%|███████▌  | 15/20 [01:45<00:57, 11.45s/it]                 Task 7, Epoch 16/20 => Loss 0.037, Train_accy 98.96:  80%|████████  | 16/20 [01:45<00:33,  8.37s/it]Task 7, Epoch 17/20 => Loss 0.014, Train_accy 100.00:  80%|████████  | 16/20 [01:46<00:33,  8.37s/it]Task 7, Epoch 17/20 => Loss 0.014, Train_accy 100.00:  85%|████████▌ | 17/20 [01:46<00:18,  6.23s/it]Task 7, Epoch 18/20 => Loss 0.013, Train_accy 100.00:  85%|████████▌ | 17/20 [01:47<00:18,  6.23s/it]Task 7, Epoch 18/20 => Loss 0.013, Train_accy 100.00:  90%|█████████ | 18/20 [01:47<00:09,  4.73s/it]Task 7, Epoch 19/20 => Loss 0.057, Train_accy 97.92:  90%|█████████ | 18/20 [01:48<00:09,  4.73s/it] Task 7, Epoch 19/20 => Loss 0.057, Train_accy 97.92:  95%|█████████▌| 19/20 [01:48<00:03,  3.68s/it]Task 7, Epoch 20/20 => Loss 0.031, Train_accy 100.00, Test_accy 73.42:  95%|█████████▌| 19/20 [02:18<00:03,  3.68s/it]Task 7, Epoch 20/20 => Loss 0.031, Train_accy 100.00, Test_accy 73.42: 100%|██████████| 20/20 [02:18<00:00, 11.45s/it]Task 7, Epoch 20/20 => Loss 0.031, Train_accy 100.00, Test_accy 73.42: 100%|██████████| 20/20 [02:18<00:00,  6.92s/it]
2024-05-10 03:28:55,901 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.031, Train_accy 100.00, Test_accy 73.42
2024-05-10 03:29:24,484 [trainer.py] => No NME accuracy.
2024-05-10 03:29:24,485 [trainer.py] => CNN: {'total': 73.42, '00-04': 69.93, '05-09': 77.04, '10-14': 82.35, '15-19': 59.97, '20-24': 66.22, '25-29': 80.95, '30-34': 89.03, '35-39': 87.24, 'old': 72.27, 'new': 87.24}
2024-05-10 03:29:24,485 [trainer.py] => CNN top1 curve: [95.1, 96.25, 96.31, 90.62, 80.84, 79.33, 77.81, 73.42]
2024-05-10 03:29:24,486 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.24, 99.12, 98.73, 97.99, 97.66, 96.14]

Average Accuracy (CNN): 86.21
2024-05-10 03:29:24,486 [trainer.py] => Average Accuracy (CNN): 86.21 

2024-05-10 03:29:24,486 [trainer.py] => Train Time: 1498.77
2024-05-10 03:29:24,486 [trainer.py] => Test Time: 126.42 

2024-05-10 03:29:24,488 [trainer.py] => All params: 89677106
2024-05-10 03:29:24,489 [trainer.py] => Trainable params: 89677106
2024-05-10 03:29:26,321 [coda_prompt.py] => Learning on 40-45
  0%|          | 0/20 [00:00<?, ?it/s]Task 8, Epoch 1/20 => Loss 0.966, Train_accy 67.01:   0%|          | 0/20 [00:02<?, ?it/s]Task 8, Epoch 1/20 => Loss 0.966, Train_accy 67.01:   5%|▌         | 1/20 [00:02<00:56,  3.00s/it]Task 8, Epoch 2/20 => Loss 0.210, Train_accy 93.75:   5%|▌         | 1/20 [00:05<00:56,  3.00s/it]Task 8, Epoch 2/20 => Loss 0.210, Train_accy 93.75:  10%|█         | 2/20 [00:05<00:53,  2.99s/it]Task 8, Epoch 3/20 => Loss 0.114, Train_accy 96.53:  10%|█         | 2/20 [00:09<00:53,  2.99s/it]Task 8, Epoch 3/20 => Loss 0.114, Train_accy 96.53:  15%|█▌        | 3/20 [00:09<00:51,  3.01s/it]Task 8, Epoch 4/20 => Loss 0.080, Train_accy 97.22:  15%|█▌        | 3/20 [00:12<00:51,  3.01s/it]Task 8, Epoch 4/20 => Loss 0.080, Train_accy 97.22:  20%|██        | 4/20 [00:12<00:48,  3.00s/it]Task 8, Epoch 5/20 => Loss 0.051, Train_accy 97.92, Test_accy 71.67:  20%|██        | 4/20 [00:51<00:48,  3.00s/it]Task 8, Epoch 5/20 => Loss 0.051, Train_accy 97.92, Test_accy 71.67:  25%|██▌       | 5/20 [00:51<04:00, 16.02s/it]Task 8, Epoch 6/20 => Loss 0.051, Train_accy 98.26:  25%|██▌       | 5/20 [00:54<04:00, 16.02s/it]                 Task 8, Epoch 6/20 => Loss 0.051, Train_accy 98.26:  30%|███       | 6/20 [00:54<02:43, 11.64s/it]Task 8, Epoch 7/20 => Loss 0.033, Train_accy 99.31:  30%|███       | 6/20 [00:57<02:43, 11.64s/it]Task 8, Epoch 7/20 => Loss 0.033, Train_accy 99.31:  35%|███▌      | 7/20 [00:57<01:55,  8.85s/it]Task 8, Epoch 8/20 => Loss 0.023, Train_accy 99.65:  35%|███▌      | 7/20 [01:00<01:55,  8.85s/it]Task 8, Epoch 8/20 => Loss 0.023, Train_accy 99.65:  40%|████      | 8/20 [01:00<01:23,  6.98s/it]Task 8, Epoch 9/20 => Loss 0.024, Train_accy 99.31:  40%|████      | 8/20 [01:03<01:23,  6.98s/it]Task 8, Epoch 9/20 => Loss 0.024, Train_accy 99.31:  45%|████▌     | 9/20 [01:03<01:03,  5.73s/it]Task 8, Epoch 10/20 => Loss 0.018, Train_accy 99.65, Test_accy 71.99:  45%|████▌     | 9/20 [01:41<01:03,  5.73s/it]Task 8, Epoch 10/20 => Loss 0.018, Train_accy 99.65, Test_accy 71.99:  50%|█████     | 10/20 [01:41<02:38, 15.89s/it]Task 8, Epoch 11/20 => Loss 0.068, Train_accy 98.26:  50%|█████     | 10/20 [01:44<02:38, 15.89s/it]                 Task 8, Epoch 11/20 => Loss 0.068, Train_accy 98.26:  55%|█████▌    | 11/20 [01:44<01:47, 11.94s/it]Task 8, Epoch 12/20 => Loss 0.041, Train_accy 99.31:  55%|█████▌    | 11/20 [01:47<01:47, 11.94s/it]Task 8, Epoch 12/20 => Loss 0.041, Train_accy 99.31:  60%|██████    | 12/20 [01:47<01:13,  9.22s/it]Task 8, Epoch 13/20 => Loss 0.026, Train_accy 99.31:  60%|██████    | 12/20 [01:51<01:13,  9.22s/it]Task 8, Epoch 13/20 => Loss 0.026, Train_accy 99.31:  65%|██████▌   | 13/20 [01:51<00:51,  7.36s/it]Task 8, Epoch 14/20 => Loss 0.022, Train_accy 99.65:  65%|██████▌   | 13/20 [01:54<00:51,  7.36s/it]Task 8, Epoch 14/20 => Loss 0.022, Train_accy 99.65:  70%|███████   | 14/20 [01:54<00:36,  6.06s/it]Task 8, Epoch 15/20 => Loss 0.029, Train_accy 99.31, Test_accy 72.16:  70%|███████   | 14/20 [02:32<00:36,  6.06s/it]Task 8, Epoch 15/20 => Loss 0.029, Train_accy 99.31, Test_accy 72.16:  75%|███████▌  | 15/20 [02:32<01:19, 15.94s/it]Task 8, Epoch 16/20 => Loss 0.012, Train_accy 99.65:  75%|███████▌  | 15/20 [02:35<01:19, 15.94s/it]                 Task 8, Epoch 16/20 => Loss 0.012, Train_accy 99.65:  80%|████████  | 16/20 [02:35<00:48, 12.04s/it]Task 8, Epoch 17/20 => Loss 0.011, Train_accy 99.65:  80%|████████  | 16/20 [02:38<00:48, 12.04s/it]Task 8, Epoch 17/20 => Loss 0.011, Train_accy 99.65:  85%|████████▌ | 17/20 [02:38<00:27,  9.30s/it]Task 8, Epoch 18/20 => Loss 0.027, Train_accy 98.96:  85%|████████▌ | 17/20 [02:41<00:27,  9.30s/it]Task 8, Epoch 18/20 => Loss 0.027, Train_accy 98.96:  90%|█████████ | 18/20 [02:41<00:14,  7.40s/it]Task 8, Epoch 19/20 => Loss 0.008, Train_accy 100.00:  90%|█████████ | 18/20 [02:44<00:14,  7.40s/it]Task 8, Epoch 19/20 => Loss 0.008, Train_accy 100.00:  95%|█████████▌| 19/20 [02:44<00:06,  6.08s/it]Task 8, Epoch 20/20 => Loss 0.012, Train_accy 99.65, Test_accy 72.14:  95%|█████████▌| 19/20 [03:23<00:06,  6.08s/it]Task 8, Epoch 20/20 => Loss 0.012, Train_accy 99.65, Test_accy 72.14: 100%|██████████| 20/20 [03:23<00:00, 15.82s/it]Task 8, Epoch 20/20 => Loss 0.012, Train_accy 99.65, Test_accy 72.14: 100%|██████████| 20/20 [03:23<00:00, 10.17s/it]
2024-05-10 03:32:49,674 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.012, Train_accy 99.65, Test_accy 72.14
2024-05-10 03:33:25,245 [trainer.py] => No NME accuracy.
2024-05-10 03:33:25,246 [trainer.py] => CNN: {'total': 72.14, '00-04': 69.93, '05-09': 76.67, '10-14': 78.27, '15-19': 57.49, '20-24': 64.78, '25-29': 80.95, '30-34': 90.51, '35-39': 84.28, '40-44': 72.65, 'old': 72.01, 'new': 72.65}
2024-05-10 03:33:25,246 [trainer.py] => CNN top1 curve: [95.1, 96.25, 96.31, 90.62, 80.84, 79.33, 77.81, 73.42, 72.14]
2024-05-10 03:33:25,246 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.24, 99.12, 98.73, 97.99, 97.66, 96.14, 95.84]

Average Accuracy (CNN): 84.65
2024-05-10 03:33:25,247 [trainer.py] => Average Accuracy (CNN): 84.65 

2024-05-10 03:33:25,247 [trainer.py] => Train Time: 1905.4699999999998
2024-05-10 03:33:25,247 [trainer.py] => Test Time: 161.99 

2024-05-10 03:33:25,248 [trainer.py] => All params: 89677106
2024-05-10 03:33:25,249 [trainer.py] => Trainable params: 89677106
2024-05-10 03:33:27,070 [coda_prompt.py] => Learning on 45-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 9, Epoch 1/20 => Loss 1.495, Train_accy 57.08:   0%|          | 0/20 [00:02<?, ?it/s]Task 9, Epoch 1/20 => Loss 1.495, Train_accy 57.08:   5%|▌         | 1/20 [00:02<00:47,  2.50s/it]Task 9, Epoch 2/20 => Loss 0.286, Train_accy 91.67:   5%|▌         | 1/20 [00:04<00:47,  2.50s/it]Task 9, Epoch 2/20 => Loss 0.286, Train_accy 91.67:  10%|█         | 2/20 [00:04<00:44,  2.47s/it]Task 9, Epoch 3/20 => Loss 0.101, Train_accy 97.50:  10%|█         | 2/20 [00:07<00:44,  2.47s/it]Task 9, Epoch 3/20 => Loss 0.101, Train_accy 97.50:  15%|█▌        | 3/20 [00:07<00:43,  2.54s/it]Task 9, Epoch 4/20 => Loss 0.061, Train_accy 98.33:  15%|█▌        | 3/20 [00:10<00:43,  2.54s/it]Task 9, Epoch 4/20 => Loss 0.061, Train_accy 98.33:  20%|██        | 4/20 [00:10<00:40,  2.54s/it]Task 9, Epoch 5/20 => Loss 0.071, Train_accy 97.92, Test_accy 66.98:  20%|██        | 4/20 [00:54<00:40,  2.54s/it]Task 9, Epoch 5/20 => Loss 0.071, Train_accy 97.92, Test_accy 66.98:  25%|██▌       | 5/20 [00:54<04:26, 17.74s/it]Task 9, Epoch 6/20 => Loss 0.064, Train_accy 98.33:  25%|██▌       | 5/20 [00:57<04:26, 17.74s/it]                 Task 9, Epoch 6/20 => Loss 0.064, Train_accy 98.33:  30%|███       | 6/20 [00:57<02:55, 12.55s/it]Task 9, Epoch 7/20 => Loss 0.041, Train_accy 99.17:  30%|███       | 6/20 [00:59<02:55, 12.55s/it]Task 9, Epoch 7/20 => Loss 0.041, Train_accy 99.17:  35%|███▌      | 7/20 [00:59<02:00,  9.27s/it]Task 9, Epoch 8/20 => Loss 0.068, Train_accy 97.92:  35%|███▌      | 7/20 [01:02<02:00,  9.27s/it]Task 9, Epoch 8/20 => Loss 0.068, Train_accy 97.92:  40%|████      | 8/20 [01:02<01:25,  7.15s/it]Task 9, Epoch 9/20 => Loss 0.065, Train_accy 97.50:  40%|████      | 8/20 [01:04<01:25,  7.15s/it]Task 9, Epoch 9/20 => Loss 0.065, Train_accy 97.50:  45%|████▌     | 9/20 [01:05<01:02,  5.73s/it]Task 9, Epoch 10/20 => Loss 0.036, Train_accy 99.17, Test_accy 66.70:  45%|████▌     | 9/20 [01:49<01:02,  5.73s/it]Task 9, Epoch 10/20 => Loss 0.036, Train_accy 99.17, Test_accy 66.70:  50%|█████     | 10/20 [01:49<02:57, 17.73s/it]Task 9, Epoch 11/20 => Loss 0.024, Train_accy 99.58:  50%|█████     | 10/20 [01:52<02:57, 17.73s/it]                 Task 9, Epoch 11/20 => Loss 0.024, Train_accy 99.58:  55%|█████▌    | 11/20 [01:52<01:57, 13.09s/it]Task 9, Epoch 12/20 => Loss 0.033, Train_accy 99.17:  55%|█████▌    | 11/20 [01:54<01:57, 13.09s/it]Task 9, Epoch 12/20 => Loss 0.033, Train_accy 99.17:  60%|██████    | 12/20 [01:54<01:19,  9.88s/it]Task 9, Epoch 13/20 => Loss 0.044, Train_accy 99.17:  60%|██████    | 12/20 [01:57<01:19,  9.88s/it]Task 9, Epoch 13/20 => Loss 0.044, Train_accy 99.17:  65%|██████▌   | 13/20 [01:57<00:53,  7.65s/it]Task 9, Epoch 14/20 => Loss 0.055, Train_accy 97.50:  65%|██████▌   | 13/20 [01:59<00:53,  7.65s/it]Task 9, Epoch 14/20 => Loss 0.055, Train_accy 97.50:  70%|███████   | 14/20 [01:59<00:36,  6.10s/it]Task 9, Epoch 15/20 => Loss 0.021, Train_accy 99.17, Test_accy 66.64:  70%|███████   | 14/20 [02:44<00:36,  6.10s/it]Task 9, Epoch 15/20 => Loss 0.021, Train_accy 99.17, Test_accy 66.64:  75%|███████▌  | 15/20 [02:44<01:28, 17.76s/it]Task 9, Epoch 16/20 => Loss 0.032, Train_accy 99.58:  75%|███████▌  | 15/20 [02:47<01:28, 17.76s/it]                 Task 9, Epoch 16/20 => Loss 0.032, Train_accy 99.58:  80%|████████  | 16/20 [02:47<00:52, 13.17s/it]Task 9, Epoch 17/20 => Loss 0.037, Train_accy 97.92:  80%|████████  | 16/20 [02:49<00:52, 13.17s/it]Task 9, Epoch 17/20 => Loss 0.037, Train_accy 97.92:  85%|████████▌ | 17/20 [02:49<00:29,  9.97s/it]Task 9, Epoch 18/20 => Loss 0.034, Train_accy 99.17:  85%|████████▌ | 17/20 [02:52<00:29,  9.97s/it]Task 9, Epoch 18/20 => Loss 0.034, Train_accy 99.17:  90%|█████████ | 18/20 [02:52<00:15,  7.75s/it]Task 9, Epoch 19/20 => Loss 0.040, Train_accy 98.33:  90%|█████████ | 18/20 [02:54<00:15,  7.75s/it]Task 9, Epoch 19/20 => Loss 0.040, Train_accy 98.33:  95%|█████████▌| 19/20 [02:54<00:06,  6.18s/it]Task 9, Epoch 20/20 => Loss 0.015, Train_accy 99.58, Test_accy 66.50:  95%|█████████▌| 19/20 [03:39<00:06,  6.18s/it]Task 9, Epoch 20/20 => Loss 0.015, Train_accy 99.58, Test_accy 66.50: 100%|██████████| 20/20 [03:39<00:00, 17.77s/it]Task 9, Epoch 20/20 => Loss 0.015, Train_accy 99.58, Test_accy 66.50: 100%|██████████| 20/20 [03:39<00:00, 10.97s/it]
2024-05-10 03:37:06,543 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.015, Train_accy 99.58, Test_accy 66.50
2024-05-10 03:37:48,831 [trainer.py] => No NME accuracy.
2024-05-10 03:37:48,831 [trainer.py] => CNN: {'total': 66.5, '00-04': 69.58, '05-09': 59.26, '10-14': 64.38, '15-19': 52.24, '20-24': 59.68, '25-29': 80.16, '30-34': 83.6, '35-39': 78.82, '40-44': 71.01, '45-49': 67.76, 'old': 66.27, 'new': 67.76}
2024-05-10 03:37:48,831 [trainer.py] => CNN top1 curve: [95.1, 96.25, 96.31, 90.62, 80.84, 79.33, 77.81, 73.42, 72.14, 66.5]
2024-05-10 03:37:48,831 [trainer.py] => CNN top5 curve: [100.0, 99.15, 99.24, 99.12, 98.73, 97.99, 97.66, 96.14, 95.84, 95.0]

Average Accuracy (CNN): 82.83
2024-05-10 03:37:48,831 [trainer.py] => Average Accuracy (CNN): 82.83 

2024-05-10 03:37:48,832 [trainer.py] => Train Time: 2344.3999999999996
2024-05-10 03:37:48,832 [trainer.py] => Test Time: 204.28 

Accuracy Matrix (CNN):
[[95.1  90.91 87.06 87.06 86.36 75.17 70.98 69.93 69.93 69.58]
 [ 0.   99.07 97.41 97.22 86.85 85.37 85.   77.04 76.67 59.26]
 [ 0.    0.   99.67 98.37 89.54 89.71 83.01 82.35 78.27 64.38]
 [ 0.    0.    0.   85.45 74.17 70.62 68.91 59.97 57.49 52.24]
 [ 0.    0.    0.    0.   80.24 79.36 74.9  66.22 64.78 59.68]
 [ 0.    0.    0.    0.    0.   89.42 83.86 80.95 80.95 80.16]
 [ 0.    0.    0.    0.    0.    0.   88.66 89.03 90.51 83.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.   87.24 84.28 78.82]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   72.65 71.01]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   67.76]]
2024-05-10 03:37:48,833 [trainer.py] => Forgetting (CNN): 20.06888888888889
2024-05-10 03:37:51,563 [trainer.py] => config: ./exps/simplecil_vtab_B0_Inc10.json
2024-05-10 03:37:51,579 [trainer.py] => prefix:  
2024-05-10 03:37:51,579 [trainer.py] => dataset: vtab
2024-05-10 03:37:51,579 [trainer.py] => memory_size: 0
2024-05-10 03:37:51,579 [trainer.py] => memory_per_class: 0
2024-05-10 03:37:51,579 [trainer.py] => fixed_memory: False
2024-05-10 03:37:51,579 [trainer.py] => shuffle: True
2024-05-10 03:37:51,579 [trainer.py] => init_cls: 5
2024-05-10 03:37:51,579 [trainer.py] => increment: 5
2024-05-10 03:37:51,579 [trainer.py] => model_name: simplecil
2024-05-10 03:37:51,579 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-05-10 03:37:51,579 [trainer.py] => device: [device(type='cuda', index=4)]
2024-05-10 03:37:51,579 [trainer.py] => seed: 1993
2024-05-10 03:37:51,580 [trainer.py] => tuned_epoch: 20
2024-05-10 03:37:51,580 [trainer.py] => init_lr: 0.01
2024-05-10 03:37:51,580 [trainer.py] => batch_size: 48
2024-05-10 03:37:51,580 [trainer.py] => weight_decay: 0.05
2024-05-10 03:37:51,580 [trainer.py] => min_lr: 1e-08
2024-05-10 03:37:51,580 [trainer.py] => optimizer: sgd
2024-05-10 03:37:51,580 [trainer.py] => vpt_type: shallow
2024-05-10 03:37:51,580 [trainer.py] => prompt_token_num: 3
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-05-10 03:37:51,622 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-05-10 03:37:56,033 [trainer.py] => All params: 85798656
2024-05-10 03:37:56,035 [trainer.py] => Trainable params: 85798656
2024-05-10 03:37:56,443 [simplecil.py] => Learning on 0-5
2024-05-10 03:37:59,837 [trainer.py] => No NME accuracy.
2024-05-10 03:37:59,837 [trainer.py] => CNN: {'total': 99.3, '00-04': 99.3, 'old': 0, 'new': 99.3}
2024-05-10 03:37:59,838 [trainer.py] => CNN top1 curve: [99.3]
2024-05-10 03:37:59,838 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.3
2024-05-10 03:37:59,838 [trainer.py] => Average Accuracy (CNN): 99.3 

2024-05-10 03:37:59,838 [trainer.py] => Train Time: 1.43
2024-05-10 03:37:59,838 [trainer.py] => Test Time: 1.97 

2024-05-10 03:37:59,840 [trainer.py] => All params: 85802497
2024-05-10 03:37:59,841 [trainer.py] => Trainable params: 85802497
2024-05-10 03:37:59,843 [simplecil.py] => Learning on 5-10
2024-05-10 03:38:03,561 [trainer.py] => No NME accuracy.
2024-05-10 03:38:03,561 [trainer.py] => CNN: {'total': 99.27, '00-04': 97.9, '05-09': 100.0, 'old': 97.9, 'new': 100.0}
2024-05-10 03:38:03,561 [trainer.py] => CNN top1 curve: [99.3, 99.27]
2024-05-10 03:38:03,561 [trainer.py] => CNN top5 curve: [100.0, 99.88]

Average Accuracy (CNN): 99.28
2024-05-10 03:38:03,562 [trainer.py] => Average Accuracy (CNN): 99.28 

2024-05-10 03:38:03,562 [trainer.py] => Train Time: 2.15
2024-05-10 03:38:03,562 [trainer.py] => Test Time: 4.97 

2024-05-10 03:38:03,562 [trainer.py] => All params: 85806337
2024-05-10 03:38:03,563 [trainer.py] => Trainable params: 85806337
2024-05-10 03:38:03,564 [simplecil.py] => Learning on 10-15
2024-05-10 03:38:09,235 [trainer.py] => No NME accuracy.
2024-05-10 03:38:09,236 [trainer.py] => CNN: {'total': 98.54, '00-04': 95.1, '05-09': 99.81, '10-14': 99.02, 'old': 98.18, 'new': 99.02}
2024-05-10 03:38:09,236 [trainer.py] => CNN top1 curve: [99.3, 99.27, 98.54]
2024-05-10 03:38:09,236 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86]

Average Accuracy (CNN): 99.04
2024-05-10 03:38:09,236 [trainer.py] => Average Accuracy (CNN): 99.04 

2024-05-10 03:38:09,236 [trainer.py] => Train Time: 3.23
2024-05-10 03:38:09,237 [trainer.py] => Test Time: 9.559999999999999 

2024-05-10 03:38:09,238 [trainer.py] => All params: 85810177
2024-05-10 03:38:09,239 [trainer.py] => Trainable params: 85810177
2024-05-10 03:38:09,241 [simplecil.py] => Learning on 15-20
2024-05-10 03:38:18,467 [trainer.py] => No NME accuracy.
2024-05-10 03:38:18,468 [trainer.py] => CNN: {'total': 94.63, '00-04': 94.76, '05-09': 99.63, '10-14': 97.71, '15-19': 91.34, 'old': 97.84, 'new': 91.34}
2024-05-10 03:38:18,468 [trainer.py] => CNN top1 curve: [99.3, 99.27, 98.54, 94.63]
2024-05-10 03:38:18,468 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86]

Average Accuracy (CNN): 97.94
2024-05-10 03:38:18,469 [trainer.py] => Average Accuracy (CNN): 97.94 

2024-05-10 03:38:18,469 [trainer.py] => Train Time: 4.32
2024-05-10 03:38:18,469 [trainer.py] => Test Time: 17.689999999999998 

2024-05-10 03:38:18,471 [trainer.py] => All params: 85814017
2024-05-10 03:38:18,472 [trainer.py] => Trainable params: 85814017
2024-05-10 03:38:18,473 [simplecil.py] => Learning on 20-25
2024-05-10 03:38:30,607 [trainer.py] => No NME accuracy.
2024-05-10 03:38:30,607 [trainer.py] => CNN: {'total': 88.71, '00-04': 94.41, '05-09': 97.78, '10-14': 94.28, '15-19': 89.71, '20-24': 79.68, 'old': 92.69, 'new': 79.68}
2024-05-10 03:38:30,607 [trainer.py] => CNN top1 curve: [99.3, 99.27, 98.54, 94.63, 88.71]
2024-05-10 03:38:30,607 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.71]

Average Accuracy (CNN): 96.09
2024-05-10 03:38:30,608 [trainer.py] => Average Accuracy (CNN): 96.09 

2024-05-10 03:38:30,608 [trainer.py] => Train Time: 5.6000000000000005
2024-05-10 03:38:30,608 [trainer.py] => Test Time: 28.54 

2024-05-10 03:38:30,609 [trainer.py] => All params: 85817857
2024-05-10 03:38:30,610 [trainer.py] => Trainable params: 85817857
2024-05-10 03:38:30,612 [simplecil.py] => Learning on 25-30
2024-05-10 03:38:43,679 [trainer.py] => No NME accuracy.
2024-05-10 03:38:43,679 [trainer.py] => CNN: {'total': 88.95, '00-04': 91.61, '05-09': 97.78, '10-14': 94.28, '15-19': 89.71, '20-24': 79.44, '25-29': 94.44, 'old': 88.44, 'new': 94.44}
2024-05-10 03:38:43,679 [trainer.py] => CNN top1 curve: [99.3, 99.27, 98.54, 94.63, 88.71, 88.95]
2024-05-10 03:38:43,679 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.71, 99.73]

Average Accuracy (CNN): 94.9
2024-05-10 03:38:43,680 [trainer.py] => Average Accuracy (CNN): 94.9 

2024-05-10 03:38:43,680 [trainer.py] => Train Time: 6.760000000000001
2024-05-10 03:38:43,680 [trainer.py] => Test Time: 40.44 

2024-05-10 03:38:43,681 [trainer.py] => All params: 85821697
2024-05-10 03:38:43,681 [trainer.py] => Trainable params: 85821697
2024-05-10 03:38:43,682 [simplecil.py] => Learning on 30-35
2024-05-10 03:38:58,883 [trainer.py] => No NME accuracy.
2024-05-10 03:38:58,883 [trainer.py] => CNN: {'total': 88.11, '00-04': 91.61, '05-09': 97.78, '10-14': 93.63, '15-19': 89.43, '20-24': 76.02, '25-29': 93.65, '30-34': 90.14, 'old': 87.75, 'new': 90.14}
2024-05-10 03:38:58,884 [trainer.py] => CNN top1 curve: [99.3, 99.27, 98.54, 94.63, 88.71, 88.95, 88.11]
2024-05-10 03:38:58,884 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.71, 99.73, 99.68]

Average Accuracy (CNN): 93.93
2024-05-10 03:38:58,884 [trainer.py] => Average Accuracy (CNN): 93.93 

2024-05-10 03:38:58,884 [trainer.py] => Train Time: 7.880000000000001
2024-05-10 03:38:58,884 [trainer.py] => Test Time: 54.519999999999996 

2024-05-10 03:38:58,885 [trainer.py] => All params: 85825537
2024-05-10 03:38:58,886 [trainer.py] => Trainable params: 85825537
2024-05-10 03:38:58,888 [simplecil.py] => Learning on 35-40
2024-05-10 03:39:15,005 [trainer.py] => No NME accuracy.
2024-05-10 03:39:15,005 [trainer.py] => CNN: {'total': 88.08, '00-04': 91.61, '05-09': 97.59, '10-14': 93.46, '15-19': 89.21, '20-24': 75.54, '25-29': 93.65, '30-34': 90.14, '35-39': 90.21, 'old': 87.9, 'new': 90.21}
2024-05-10 03:39:15,005 [trainer.py] => CNN top1 curve: [99.3, 99.27, 98.54, 94.63, 88.71, 88.95, 88.11, 88.08]
2024-05-10 03:39:15,005 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.71, 99.73, 99.68, 99.34]

Average Accuracy (CNN): 93.2
2024-05-10 03:39:15,006 [trainer.py] => Average Accuracy (CNN): 93.2 

2024-05-10 03:39:15,006 [trainer.py] => Train Time: 8.930000000000001
2024-05-10 03:39:15,006 [trainer.py] => Test Time: 69.58 

2024-05-10 03:39:15,007 [trainer.py] => All params: 85829377
2024-05-10 03:39:15,008 [trainer.py] => Trainable params: 85829377
2024-05-10 03:39:15,009 [simplecil.py] => Learning on 40-45
2024-05-10 03:39:34,905 [trainer.py] => No NME accuracy.
2024-05-10 03:39:34,905 [trainer.py] => CNN: {'total': 86.93, '00-04': 91.61, '05-09': 97.59, '10-14': 90.03, '15-19': 88.22, '20-24': 71.08, '25-29': 92.86, '30-34': 89.89, '35-39': 89.75, '40-44': 89.02, 'old': 86.37, 'new': 89.02}
2024-05-10 03:39:34,905 [trainer.py] => CNN top1 curve: [99.3, 99.27, 98.54, 94.63, 88.71, 88.95, 88.11, 88.08, 86.93]
2024-05-10 03:39:34,905 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.71, 99.73, 99.68, 99.34, 99.14]

Average Accuracy (CNN): 92.5
2024-05-10 03:39:34,905 [trainer.py] => Average Accuracy (CNN): 92.5 

2024-05-10 03:39:34,905 [trainer.py] => Train Time: 10.240000000000002
2024-05-10 03:39:34,905 [trainer.py] => Test Time: 88.16 

2024-05-10 03:39:34,907 [trainer.py] => All params: 85833217
2024-05-10 03:39:34,907 [trainer.py] => Trainable params: 85833217
2024-05-10 03:39:34,909 [simplecil.py] => Learning on 45-50
2024-05-10 03:39:58,267 [trainer.py] => No NME accuracy.
2024-05-10 03:39:58,267 [trainer.py] => CNN: {'total': 83.61, '00-04': 91.26, '05-09': 97.59, '10-14': 84.64, '15-19': 86.87, '20-24': 65.34, '25-29': 92.86, '30-34': 89.64, '35-39': 87.7, '40-44': 83.5, '45-49': 82.09, 'old': 83.89, 'new': 82.09}
2024-05-10 03:39:58,268 [trainer.py] => CNN top1 curve: [99.3, 99.27, 98.54, 94.63, 88.71, 88.95, 88.11, 88.08, 86.93, 83.61]
2024-05-10 03:39:58,268 [trainer.py] => CNN top5 curve: [100.0, 99.88, 99.86, 99.86, 99.71, 99.73, 99.68, 99.34, 99.14, 98.63]

Average Accuracy (CNN): 91.61
2024-05-10 03:39:58,268 [trainer.py] => Average Accuracy (CNN): 91.61 

2024-05-10 03:39:58,268 [trainer.py] => Train Time: 11.430000000000001
2024-05-10 03:39:58,268 [trainer.py] => Test Time: 110.32 

Accuracy Matrix (CNN):
[[ 99.3   97.9   95.1   94.76  94.41  91.61  91.61  91.61  91.61  91.26]
 [  0.   100.    99.81  99.63  97.78  97.78  97.78  97.59  97.59  97.59]
 [  0.     0.    99.02  97.71  94.28  94.28  93.63  93.46  90.03  84.64]
 [  0.     0.     0.    91.34  89.71  89.71  89.43  89.21  88.22  86.87]
 [  0.     0.     0.     0.    79.68  79.44  76.02  75.54  71.08  65.34]
 [  0.     0.     0.     0.     0.    94.44  93.65  93.65  92.86  92.86]
 [  0.     0.     0.     0.     0.     0.    90.14  90.14  89.89  89.64]
 [  0.     0.     0.     0.     0.     0.     0.    90.21  89.75  87.7 ]
 [  0.     0.     0.     0.     0.     0.     0.     0.    89.02  83.5 ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    82.09]]
2024-05-10 03:39:58,270 [trainer.py] => Forgetting (CNN): 5.972222222222219
2024-05-10 03:40:01,168 [trainer.py] => config: ./exps/ease_vtab_B0_Inc10.json
2024-05-10 03:40:01,168 [trainer.py] => prefix:  
2024-05-10 03:40:01,168 [trainer.py] => dataset: vtab
2024-05-10 03:40:01,168 [trainer.py] => memory_size: 0
2024-05-10 03:40:01,168 [trainer.py] => memory_per_class: 0
2024-05-10 03:40:01,168 [trainer.py] => fixed_memory: False
2024-05-10 03:40:01,168 [trainer.py] => shuffle: True
2024-05-10 03:40:01,168 [trainer.py] => init_cls: 5
2024-05-10 03:40:01,168 [trainer.py] => increment: 5
2024-05-10 03:40:01,168 [trainer.py] => model_name: ease
2024-05-10 03:40:01,168 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-05-10 03:40:01,168 [trainer.py] => device: [device(type='cuda', index=4)]
2024-05-10 03:40:01,168 [trainer.py] => seed: 1993
2024-05-10 03:40:01,168 [trainer.py] => init_epochs: 20
2024-05-10 03:40:01,168 [trainer.py] => init_lr: 0.05
2024-05-10 03:40:01,168 [trainer.py] => later_epochs: 20
2024-05-10 03:40:01,168 [trainer.py] => later_lr: 0.05
2024-05-10 03:40:01,168 [trainer.py] => batch_size: 48
2024-05-10 03:40:01,168 [trainer.py] => weight_decay: 0.005
2024-05-10 03:40:01,169 [trainer.py] => min_lr: 0
2024-05-10 03:40:01,169 [trainer.py] => optimizer: sgd
2024-05-10 03:40:01,169 [trainer.py] => scheduler: cosine
2024-05-10 03:40:01,169 [trainer.py] => pretrained: True
2024-05-10 03:40:01,169 [trainer.py] => vpt_type: Deep
2024-05-10 03:40:01,169 [trainer.py] => prompt_token_num: 5
2024-05-10 03:40:01,169 [trainer.py] => ffn_num: 64
2024-05-10 03:40:01,169 [trainer.py] => use_diagonal: False
2024-05-10 03:40:01,169 [trainer.py] => recalc_sim: True
2024-05-10 03:40:01,169 [trainer.py] => alpha: 0.1
2024-05-10 03:40:01,169 [trainer.py] => use_init_ptm: False
2024-05-10 03:40:01,169 [trainer.py] => beta: 0
2024-05-10 03:40:01,169 [trainer.py] => use_old_data: False
2024-05-10 03:40:01,169 [trainer.py] => use_reweight: True
2024-05-10 03:40:01,169 [trainer.py] => moni_adam: False
2024-05-10 03:40:01,169 [trainer.py] => adapter_num: -1
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-05-10 03:40:01,206 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
_IncompatibleKeys(missing_keys=['cur_adapter.0.down_proj.weight', 'cur_adapter.0.down_proj.bias', 'cur_adapter.0.up_proj.weight', 'cur_adapter.0.up_proj.bias', 'cur_adapter.1.down_proj.weight', 'cur_adapter.1.down_proj.bias', 'cur_adapter.1.up_proj.weight', 'cur_adapter.1.up_proj.bias', 'cur_adapter.2.down_proj.weight', 'cur_adapter.2.down_proj.bias', 'cur_adapter.2.up_proj.weight', 'cur_adapter.2.up_proj.bias', 'cur_adapter.3.down_proj.weight', 'cur_adapter.3.down_proj.bias', 'cur_adapter.3.up_proj.weight', 'cur_adapter.3.up_proj.bias', 'cur_adapter.4.down_proj.weight', 'cur_adapter.4.down_proj.bias', 'cur_adapter.4.up_proj.weight', 'cur_adapter.4.up_proj.bias', 'cur_adapter.5.down_proj.weight', 'cur_adapter.5.down_proj.bias', 'cur_adapter.5.up_proj.weight', 'cur_adapter.5.up_proj.bias', 'cur_adapter.6.down_proj.weight', 'cur_adapter.6.down_proj.bias', 'cur_adapter.6.up_proj.weight', 'cur_adapter.6.up_proj.bias', 'cur_adapter.7.down_proj.weight', 'cur_adapter.7.down_proj.bias', 'cur_adapter.7.up_proj.weight', 'cur_adapter.7.up_proj.bias', 'cur_adapter.8.down_proj.weight', 'cur_adapter.8.down_proj.bias', 'cur_adapter.8.up_proj.weight', 'cur_adapter.8.up_proj.bias', 'cur_adapter.9.down_proj.weight', 'cur_adapter.9.down_proj.bias', 'cur_adapter.9.up_proj.weight', 'cur_adapter.9.up_proj.bias', 'cur_adapter.10.down_proj.weight', 'cur_adapter.10.down_proj.bias', 'cur_adapter.10.up_proj.weight', 'cur_adapter.10.up_proj.bias', 'cur_adapter.11.down_proj.weight', 'cur_adapter.11.down_proj.bias', 'cur_adapter.11.up_proj.weight', 'cur_adapter.11.up_proj.bias'], unexpected_keys=[])
After BaseNet initialization.
2024-05-10 03:40:05,044 [trainer.py] => All params: 86988288
2024-05-10 03:40:05,045 [trainer.py] => Trainable params: 1189632
2024-05-10 03:40:05,054 [ease.py] => Learning on 0-5
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.611, Train_accy 23.08:   0%|          | 0/20 [00:01<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.611, Train_accy 23.08:   5%|▌         | 1/20 [00:01<00:21,  1.16s/it]Task 0, Epoch 2/20 => Loss 1.575, Train_accy 57.14:   5%|▌         | 1/20 [00:01<00:21,  1.16s/it]Task 0, Epoch 2/20 => Loss 1.575, Train_accy 57.14:  10%|█         | 2/20 [00:01<00:17,  1.04it/s]Task 0, Epoch 3/20 => Loss 1.511, Train_accy 83.52:  10%|█         | 2/20 [00:02<00:17,  1.04it/s]Task 0, Epoch 3/20 => Loss 1.511, Train_accy 83.52:  15%|█▌        | 3/20 [00:02<00:14,  1.15it/s]Task 0, Epoch 4/20 => Loss 1.425, Train_accy 92.31:  15%|█▌        | 3/20 [00:03<00:14,  1.15it/s]Task 0, Epoch 4/20 => Loss 1.425, Train_accy 92.31:  20%|██        | 4/20 [00:03<00:13,  1.20it/s]Task 0, Epoch 5/20 => Loss 1.343, Train_accy 95.60:  20%|██        | 4/20 [00:04<00:13,  1.20it/s]Task 0, Epoch 5/20 => Loss 1.343, Train_accy 95.60:  25%|██▌       | 5/20 [00:04<00:12,  1.20it/s]Task 0, Epoch 6/20 => Loss 1.254, Train_accy 94.51:  25%|██▌       | 5/20 [00:05<00:12,  1.20it/s]Task 0, Epoch 6/20 => Loss 1.254, Train_accy 94.51:  30%|███       | 6/20 [00:05<00:11,  1.22it/s]Task 0, Epoch 7/20 => Loss 1.166, Train_accy 95.60:  30%|███       | 6/20 [00:06<00:11,  1.22it/s]Task 0, Epoch 7/20 => Loss 1.166, Train_accy 95.60:  35%|███▌      | 7/20 [00:06<00:10,  1.18it/s]Task 0, Epoch 8/20 => Loss 1.077, Train_accy 97.80:  35%|███▌      | 7/20 [00:06<00:10,  1.18it/s]Task 0, Epoch 8/20 => Loss 1.077, Train_accy 97.80:  40%|████      | 8/20 [00:06<00:09,  1.22it/s]Task 0, Epoch 9/20 => Loss 1.002, Train_accy 97.80:  40%|████      | 8/20 [00:07<00:09,  1.22it/s]Task 0, Epoch 9/20 => Loss 1.002, Train_accy 97.80:  45%|████▌     | 9/20 [00:07<00:09,  1.20it/s]Task 0, Epoch 10/20 => Loss 0.941, Train_accy 95.60:  45%|████▌     | 9/20 [00:08<00:09,  1.20it/s]Task 0, Epoch 10/20 => Loss 0.941, Train_accy 95.60:  50%|█████     | 10/20 [00:08<00:08,  1.22it/s]Task 0, Epoch 11/20 => Loss 0.875, Train_accy 97.80:  50%|█████     | 10/20 [00:09<00:08,  1.22it/s]Task 0, Epoch 11/20 => Loss 0.875, Train_accy 97.80:  55%|█████▌    | 11/20 [00:09<00:07,  1.19it/s]Task 0, Epoch 12/20 => Loss 0.867, Train_accy 97.80:  55%|█████▌    | 11/20 [00:10<00:07,  1.19it/s]Task 0, Epoch 12/20 => Loss 0.867, Train_accy 97.80:  60%|██████    | 12/20 [00:10<00:06,  1.21it/s]Task 0, Epoch 13/20 => Loss 0.791, Train_accy 96.70:  60%|██████    | 12/20 [00:11<00:06,  1.21it/s]Task 0, Epoch 13/20 => Loss 0.791, Train_accy 96.70:  65%|██████▌   | 13/20 [00:11<00:05,  1.18it/s]Task 0, Epoch 14/20 => Loss 0.763, Train_accy 96.70:  65%|██████▌   | 13/20 [00:11<00:05,  1.18it/s]Task 0, Epoch 14/20 => Loss 0.763, Train_accy 96.70:  70%|███████   | 14/20 [00:11<00:04,  1.22it/s]Task 0, Epoch 15/20 => Loss 0.756, Train_accy 95.60:  70%|███████   | 14/20 [00:12<00:04,  1.22it/s]Task 0, Epoch 15/20 => Loss 0.756, Train_accy 95.60:  75%|███████▌  | 15/20 [00:12<00:04,  1.20it/s]Task 0, Epoch 16/20 => Loss 0.713, Train_accy 96.70:  75%|███████▌  | 15/20 [00:13<00:04,  1.20it/s]Task 0, Epoch 16/20 => Loss 0.713, Train_accy 96.70:  80%|████████  | 16/20 [00:13<00:03,  1.22it/s]Task 0, Epoch 17/20 => Loss 0.703, Train_accy 98.90:  80%|████████  | 16/20 [00:14<00:03,  1.22it/s]Task 0, Epoch 17/20 => Loss 0.703, Train_accy 98.90:  85%|████████▌ | 17/20 [00:14<00:02,  1.19it/s]Task 0, Epoch 18/20 => Loss 0.714, Train_accy 98.90:  85%|████████▌ | 17/20 [00:15<00:02,  1.19it/s]Task 0, Epoch 18/20 => Loss 0.714, Train_accy 98.90:  90%|█████████ | 18/20 [00:15<00:01,  1.17it/s]Task 0, Epoch 19/20 => Loss 0.693, Train_accy 96.70:  90%|█████████ | 18/20 [00:16<00:01,  1.17it/s]Task 0, Epoch 19/20 => Loss 0.693, Train_accy 96.70:  95%|█████████▌| 19/20 [00:16<00:00,  1.15it/s]Task 0, Epoch 20/20 => Loss 0.671, Train_accy 97.80:  95%|█████████▌| 19/20 [00:16<00:00,  1.15it/s]Task 0, Epoch 20/20 => Loss 0.671, Train_accy 97.80: 100%|██████████| 20/20 [00:16<00:00,  1.17it/s]Task 0, Epoch 20/20 => Loss 0.671, Train_accy 97.80: 100%|██████████| 20/20 [00:16<00:00,  1.18it/s]
2024-05-10 03:40:22,097 [ease.py] => Task 0, Epoch 20/20 => Loss 0.671, Train_accy 97.80
2024-05-10 03:40:24,107 [ease.py] => Task correct: 100.0
2024-05-10 03:40:24,108 [ease.py] => Task acc: 97.55244755244755
2024-05-10 03:40:24,147 [trainer.py] => No NME accuracy.
2024-05-10 03:40:24,147 [trainer.py] => CNN: {'total': 97.55, '00-04': 97.55, 'old': 0, 'new': 97.55}
2024-05-10 03:40:24,147 [trainer.py] => CNN top1 curve: [97.55]
2024-05-10 03:40:24,147 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.55
2024-05-10 03:40:24,147 [trainer.py] => Average Accuracy (CNN): 97.55 

2024-05-10 03:40:24,147 [trainer.py] => Train Time: 34.01
2024-05-10 03:40:24,147 [trainer.py] => Test Time: 1.25 

2024-05-10 03:40:24,148 [trainer.py] => All params: 86995970
2024-05-10 03:40:24,149 [trainer.py] => Trainable params: 1189632
2024-05-10 03:40:24,150 [ease.py] => Learning on 5-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.603, Train_accy 24.29:   0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.603, Train_accy 24.29:   5%|▌         | 1/20 [00:00<00:13,  1.40it/s]Task 1, Epoch 2/20 => Loss 1.557, Train_accy 64.29:   5%|▌         | 1/20 [00:01<00:13,  1.40it/s]Task 1, Epoch 2/20 => Loss 1.557, Train_accy 64.29:  10%|█         | 2/20 [00:01<00:13,  1.30it/s]Task 1, Epoch 3/20 => Loss 1.481, Train_accy 91.43:  10%|█         | 2/20 [00:02<00:13,  1.30it/s]Task 1, Epoch 3/20 => Loss 1.481, Train_accy 91.43:  15%|█▌        | 3/20 [00:02<00:12,  1.36it/s]Task 1, Epoch 4/20 => Loss 1.381, Train_accy 98.57:  15%|█▌        | 3/20 [00:02<00:12,  1.36it/s]Task 1, Epoch 4/20 => Loss 1.381, Train_accy 98.57:  20%|██        | 4/20 [00:02<00:11,  1.36it/s]Task 1, Epoch 5/20 => Loss 1.297, Train_accy 98.57:  20%|██        | 4/20 [00:03<00:11,  1.36it/s]Task 1, Epoch 5/20 => Loss 1.297, Train_accy 98.57:  25%|██▌       | 5/20 [00:03<00:11,  1.33it/s]Task 1, Epoch 6/20 => Loss 1.192, Train_accy 100.00:  25%|██▌       | 5/20 [00:04<00:11,  1.33it/s]Task 1, Epoch 6/20 => Loss 1.192, Train_accy 100.00:  30%|███       | 6/20 [00:04<00:10,  1.30it/s]Task 1, Epoch 7/20 => Loss 1.095, Train_accy 100.00:  30%|███       | 6/20 [00:05<00:10,  1.30it/s]Task 1, Epoch 7/20 => Loss 1.095, Train_accy 100.00:  35%|███▌      | 7/20 [00:05<00:09,  1.30it/s]Task 1, Epoch 8/20 => Loss 0.986, Train_accy 98.57:  35%|███▌      | 7/20 [00:05<00:09,  1.30it/s] Task 1, Epoch 8/20 => Loss 0.986, Train_accy 98.57:  40%|████      | 8/20 [00:05<00:08,  1.34it/s]Task 1, Epoch 9/20 => Loss 0.921, Train_accy 100.00:  40%|████      | 8/20 [00:06<00:08,  1.34it/s]Task 1, Epoch 9/20 => Loss 0.921, Train_accy 100.00:  45%|████▌     | 9/20 [00:06<00:07,  1.38it/s]Task 1, Epoch 10/20 => Loss 0.818, Train_accy 100.00:  45%|████▌     | 9/20 [00:07<00:07,  1.38it/s]Task 1, Epoch 10/20 => Loss 0.818, Train_accy 100.00:  50%|█████     | 10/20 [00:07<00:07,  1.38it/s]Task 1, Epoch 11/20 => Loss 0.751, Train_accy 100.00:  50%|█████     | 10/20 [00:08<00:07,  1.38it/s]Task 1, Epoch 11/20 => Loss 0.751, Train_accy 100.00:  55%|█████▌    | 11/20 [00:08<00:06,  1.34it/s]Task 1, Epoch 12/20 => Loss 0.728, Train_accy 100.00:  55%|█████▌    | 11/20 [00:08<00:06,  1.34it/s]Task 1, Epoch 12/20 => Loss 0.728, Train_accy 100.00:  60%|██████    | 12/20 [00:08<00:06,  1.32it/s]Task 1, Epoch 13/20 => Loss 0.666, Train_accy 98.57:  60%|██████    | 12/20 [00:09<00:06,  1.32it/s] Task 1, Epoch 13/20 => Loss 0.666, Train_accy 98.57:  65%|██████▌   | 13/20 [00:09<00:05,  1.35it/s]Task 1, Epoch 14/20 => Loss 0.652, Train_accy 100.00:  65%|██████▌   | 13/20 [00:10<00:05,  1.35it/s]Task 1, Epoch 14/20 => Loss 0.652, Train_accy 100.00:  70%|███████   | 14/20 [00:10<00:04,  1.32it/s]Task 1, Epoch 15/20 => Loss 0.617, Train_accy 100.00:  70%|███████   | 14/20 [00:11<00:04,  1.32it/s]Task 1, Epoch 15/20 => Loss 0.617, Train_accy 100.00:  75%|███████▌  | 15/20 [00:11<00:03,  1.35it/s]Task 1, Epoch 16/20 => Loss 0.610, Train_accy 100.00:  75%|███████▌  | 15/20 [00:11<00:03,  1.35it/s]Task 1, Epoch 16/20 => Loss 0.610, Train_accy 100.00:  80%|████████  | 16/20 [00:11<00:02,  1.34it/s]Task 1, Epoch 17/20 => Loss 0.582, Train_accy 100.00:  80%|████████  | 16/20 [00:12<00:02,  1.34it/s]Task 1, Epoch 17/20 => Loss 0.582, Train_accy 100.00:  85%|████████▌ | 17/20 [00:12<00:02,  1.37it/s]Task 1, Epoch 18/20 => Loss 0.573, Train_accy 100.00:  85%|████████▌ | 17/20 [00:13<00:02,  1.37it/s]Task 1, Epoch 18/20 => Loss 0.573, Train_accy 100.00:  90%|█████████ | 18/20 [00:13<00:01,  1.38it/s]Task 1, Epoch 19/20 => Loss 0.542, Train_accy 100.00:  90%|█████████ | 18/20 [00:14<00:01,  1.38it/s]Task 1, Epoch 19/20 => Loss 0.542, Train_accy 100.00:  95%|█████████▌| 19/20 [00:14<00:00,  1.35it/s]Task 1, Epoch 20/20 => Loss 0.574, Train_accy 100.00:  95%|█████████▌| 19/20 [00:14<00:00,  1.35it/s]Task 1, Epoch 20/20 => Loss 0.574, Train_accy 100.00: 100%|██████████| 20/20 [00:14<00:00,  1.38it/s]Task 1, Epoch 20/20 => Loss 0.574, Train_accy 100.00: 100%|██████████| 20/20 [00:14<00:00,  1.35it/s]
2024-05-10 03:40:38,972 [ease.py] => Task 1, Epoch 20/20 => Loss 0.574, Train_accy 100.00
2024-05-10 03:40:45,178 [ease.py] => Task correct: 99.27360774818402
2024-05-10 03:40:45,178 [ease.py] => Task acc: 99.15254237288136
2024-05-10 03:40:45,336 [trainer.py] => No NME accuracy.
2024-05-10 03:40:45,336 [trainer.py] => CNN: {'total': 98.79, '00-04': 96.5, '05-09': 100.0, 'old': 96.5, 'new': 100.0}
2024-05-10 03:40:45,336 [trainer.py] => CNN top1 curve: [97.55, 98.79]
2024-05-10 03:40:45,336 [trainer.py] => CNN top5 curve: [100.0, 99.64]

Average Accuracy (CNN): 98.17
2024-05-10 03:40:45,337 [trainer.py] => Average Accuracy (CNN): 98.17 

2024-05-10 03:40:45,337 [trainer.py] => Train Time: 63.65
2024-05-10 03:40:45,337 [trainer.py] => Test Time: 5.99 

2024-05-10 03:40:45,337 [trainer.py] => All params: 87007490
2024-05-10 03:40:45,338 [trainer.py] => Trainable params: 1189632
2024-05-10 03:40:45,339 [ease.py] => Learning on 10-15
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.583, Train_accy 32.61:   0%|          | 0/20 [00:01<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.583, Train_accy 32.61:   5%|▌         | 1/20 [00:01<00:20,  1.09s/it]Task 2, Epoch 2/20 => Loss 1.481, Train_accy 83.33:   5%|▌         | 1/20 [00:02<00:20,  1.09s/it]Task 2, Epoch 2/20 => Loss 1.481, Train_accy 83.33:  10%|█         | 2/20 [00:02<00:20,  1.13s/it]Task 2, Epoch 3/20 => Loss 1.313, Train_accy 85.51:  10%|█         | 2/20 [00:03<00:20,  1.13s/it]Task 2, Epoch 3/20 => Loss 1.313, Train_accy 85.51:  15%|█▌        | 3/20 [00:03<00:18,  1.09s/it]Task 2, Epoch 4/20 => Loss 1.158, Train_accy 87.68:  15%|█▌        | 3/20 [00:04<00:18,  1.09s/it]Task 2, Epoch 4/20 => Loss 1.158, Train_accy 87.68:  20%|██        | 4/20 [00:04<00:16,  1.06s/it]Task 2, Epoch 5/20 => Loss 1.001, Train_accy 85.51:  20%|██        | 4/20 [00:05<00:16,  1.06s/it]Task 2, Epoch 5/20 => Loss 1.001, Train_accy 85.51:  25%|██▌       | 5/20 [00:05<00:15,  1.03s/it]Task 2, Epoch 6/20 => Loss 0.845, Train_accy 92.03:  25%|██▌       | 5/20 [00:06<00:15,  1.03s/it]Task 2, Epoch 6/20 => Loss 0.845, Train_accy 92.03:  30%|███       | 6/20 [00:06<00:14,  1.04s/it]Task 2, Epoch 7/20 => Loss 0.718, Train_accy 94.93:  30%|███       | 6/20 [00:07<00:14,  1.04s/it]Task 2, Epoch 7/20 => Loss 0.718, Train_accy 94.93:  35%|███▌      | 7/20 [00:07<00:13,  1.05s/it]Task 2, Epoch 8/20 => Loss 0.644, Train_accy 93.48:  35%|███▌      | 7/20 [00:08<00:13,  1.05s/it]Task 2, Epoch 8/20 => Loss 0.644, Train_accy 93.48:  40%|████      | 8/20 [00:08<00:12,  1.04s/it]Task 2, Epoch 9/20 => Loss 0.550, Train_accy 96.38:  40%|████      | 8/20 [00:09<00:12,  1.04s/it]Task 2, Epoch 9/20 => Loss 0.550, Train_accy 96.38:  45%|████▌     | 9/20 [00:09<00:11,  1.03s/it]Task 2, Epoch 10/20 => Loss 0.481, Train_accy 97.83:  45%|████▌     | 9/20 [00:10<00:11,  1.03s/it]Task 2, Epoch 10/20 => Loss 0.481, Train_accy 97.83:  50%|█████     | 10/20 [00:10<00:10,  1.02s/it]Task 2, Epoch 11/20 => Loss 0.440, Train_accy 97.10:  50%|█████     | 10/20 [00:11<00:10,  1.02s/it]Task 2, Epoch 11/20 => Loss 0.440, Train_accy 97.10:  55%|█████▌    | 11/20 [00:11<00:09,  1.05s/it]Task 2, Epoch 12/20 => Loss 0.402, Train_accy 97.83:  55%|█████▌    | 11/20 [00:12<00:09,  1.05s/it]Task 2, Epoch 12/20 => Loss 0.402, Train_accy 97.83:  60%|██████    | 12/20 [00:12<00:08,  1.03s/it]Task 2, Epoch 13/20 => Loss 0.368, Train_accy 97.83:  60%|██████    | 12/20 [00:13<00:08,  1.03s/it]Task 2, Epoch 13/20 => Loss 0.368, Train_accy 97.83:  65%|██████▌   | 13/20 [00:13<00:07,  1.03s/it]Task 2, Epoch 14/20 => Loss 0.359, Train_accy 98.55:  65%|██████▌   | 13/20 [00:14<00:07,  1.03s/it]Task 2, Epoch 14/20 => Loss 0.359, Train_accy 98.55:  70%|███████   | 14/20 [00:14<00:06,  1.02s/it]Task 2, Epoch 15/20 => Loss 0.339, Train_accy 99.28:  70%|███████   | 14/20 [00:15<00:06,  1.02s/it]Task 2, Epoch 15/20 => Loss 0.339, Train_accy 99.28:  75%|███████▌  | 15/20 [00:15<00:05,  1.02s/it]Task 2, Epoch 16/20 => Loss 0.337, Train_accy 99.28:  75%|███████▌  | 15/20 [00:16<00:05,  1.02s/it]Task 2, Epoch 16/20 => Loss 0.337, Train_accy 99.28:  80%|████████  | 16/20 [00:16<00:04,  1.02s/it]Task 2, Epoch 17/20 => Loss 0.334, Train_accy 98.55:  80%|████████  | 16/20 [00:17<00:04,  1.02s/it]Task 2, Epoch 17/20 => Loss 0.334, Train_accy 98.55:  85%|████████▌ | 17/20 [00:17<00:03,  1.02s/it]Task 2, Epoch 18/20 => Loss 0.322, Train_accy 98.55:  85%|████████▌ | 17/20 [00:18<00:03,  1.02s/it]Task 2, Epoch 18/20 => Loss 0.322, Train_accy 98.55:  90%|█████████ | 18/20 [00:18<00:02,  1.02s/it]Task 2, Epoch 19/20 => Loss 0.317, Train_accy 98.55:  90%|█████████ | 18/20 [00:19<00:02,  1.02s/it]Task 2, Epoch 19/20 => Loss 0.317, Train_accy 98.55:  95%|█████████▌| 19/20 [00:19<00:01,  1.03s/it]Task 2, Epoch 20/20 => Loss 0.308, Train_accy 100.00:  95%|█████████▌| 19/20 [00:20<00:01,  1.03s/it]Task 2, Epoch 20/20 => Loss 0.308, Train_accy 100.00: 100%|██████████| 20/20 [00:20<00:00,  1.07s/it]Task 2, Epoch 20/20 => Loss 0.308, Train_accy 100.00: 100%|██████████| 20/20 [00:20<00:00,  1.04s/it]
2024-05-10 03:41:06,203 [ease.py] => Task 2, Epoch 20/20 => Loss 0.308, Train_accy 100.00
2024-05-10 03:41:19,886 [ease.py] => Task correct: 98.81780250347705
2024-05-10 03:41:19,887 [ease.py] => Task acc: 99.30458970792768
2024-05-10 03:41:20,067 [trainer.py] => No NME accuracy.
2024-05-10 03:41:20,068 [trainer.py] => CNN: {'total': 98.54, '00-04': 95.1, '05-09': 100.0, '10-14': 98.86, 'old': 98.31, 'new': 98.86}
2024-05-10 03:41:20,068 [trainer.py] => CNN top1 curve: [97.55, 98.79, 98.54]
2024-05-10 03:41:20,068 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79]

Average Accuracy (CNN): 98.29
2024-05-10 03:41:20,068 [trainer.py] => Average Accuracy (CNN): 98.29 

2024-05-10 03:41:20,068 [trainer.py] => Train Time: 105.36999999999999
2024-05-10 03:41:20,068 [trainer.py] => Test Time: 17.25 

2024-05-10 03:41:20,069 [trainer.py] => All params: 87026690
2024-05-10 03:41:20,069 [trainer.py] => Trainable params: 1189632
2024-05-10 03:41:20,071 [ease.py] => Learning on 15-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.559, Train_accy 47.46:   0%|          | 0/20 [00:01<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.559, Train_accy 47.46:   5%|▌         | 1/20 [00:01<00:33,  1.75s/it]Task 3, Epoch 2/20 => Loss 1.301, Train_accy 73.19:   5%|▌         | 1/20 [00:03<00:33,  1.75s/it]Task 3, Epoch 2/20 => Loss 1.301, Train_accy 73.19:  10%|█         | 2/20 [00:03<00:31,  1.72s/it]Task 3, Epoch 3/20 => Loss 1.027, Train_accy 71.74:  10%|█         | 2/20 [00:05<00:31,  1.72s/it]Task 3, Epoch 3/20 => Loss 1.027, Train_accy 71.74:  15%|█▌        | 3/20 [00:05<00:29,  1.74s/it]Task 3, Epoch 4/20 => Loss 0.841, Train_accy 72.10:  15%|█▌        | 3/20 [00:06<00:29,  1.74s/it]Task 3, Epoch 4/20 => Loss 0.841, Train_accy 72.10:  20%|██        | 4/20 [00:06<00:27,  1.74s/it]Task 3, Epoch 5/20 => Loss 0.712, Train_accy 73.19:  20%|██        | 4/20 [00:08<00:27,  1.74s/it]Task 3, Epoch 5/20 => Loss 0.712, Train_accy 73.19:  25%|██▌       | 5/20 [00:08<00:25,  1.72s/it]Task 3, Epoch 6/20 => Loss 0.587, Train_accy 81.88:  25%|██▌       | 5/20 [00:10<00:25,  1.72s/it]Task 3, Epoch 6/20 => Loss 0.587, Train_accy 81.88:  30%|███       | 6/20 [00:10<00:23,  1.71s/it]Task 3, Epoch 7/20 => Loss 0.539, Train_accy 86.59:  30%|███       | 6/20 [00:12<00:23,  1.71s/it]Task 3, Epoch 7/20 => Loss 0.539, Train_accy 86.59:  35%|███▌      | 7/20 [00:12<00:22,  1.70s/it]Task 3, Epoch 8/20 => Loss 0.467, Train_accy 89.86:  35%|███▌      | 7/20 [00:13<00:22,  1.70s/it]Task 3, Epoch 8/20 => Loss 0.467, Train_accy 89.86:  40%|████      | 8/20 [00:13<00:20,  1.71s/it]Task 3, Epoch 9/20 => Loss 0.465, Train_accy 90.94:  40%|████      | 8/20 [00:15<00:20,  1.71s/it]Task 3, Epoch 9/20 => Loss 0.465, Train_accy 90.94:  45%|████▌     | 9/20 [00:15<00:18,  1.70s/it]Task 3, Epoch 10/20 => Loss 0.405, Train_accy 92.75:  45%|████▌     | 9/20 [00:17<00:18,  1.70s/it]Task 3, Epoch 10/20 => Loss 0.405, Train_accy 92.75:  50%|█████     | 10/20 [00:17<00:16,  1.69s/it]Task 3, Epoch 11/20 => Loss 0.401, Train_accy 92.39:  50%|█████     | 10/20 [00:18<00:16,  1.69s/it]Task 3, Epoch 11/20 => Loss 0.401, Train_accy 92.39:  55%|█████▌    | 11/20 [00:18<00:15,  1.71s/it]Task 3, Epoch 12/20 => Loss 0.339, Train_accy 95.29:  55%|█████▌    | 11/20 [00:20<00:15,  1.71s/it]Task 3, Epoch 12/20 => Loss 0.339, Train_accy 95.29:  60%|██████    | 12/20 [00:20<00:13,  1.74s/it]Task 3, Epoch 13/20 => Loss 0.342, Train_accy 96.01:  60%|██████    | 12/20 [00:22<00:13,  1.74s/it]Task 3, Epoch 13/20 => Loss 0.342, Train_accy 96.01:  65%|██████▌   | 13/20 [00:22<00:12,  1.73s/it]Task 3, Epoch 14/20 => Loss 0.337, Train_accy 94.57:  65%|██████▌   | 13/20 [00:24<00:12,  1.73s/it]Task 3, Epoch 14/20 => Loss 0.337, Train_accy 94.57:  70%|███████   | 14/20 [00:24<00:10,  1.71s/it]Task 3, Epoch 15/20 => Loss 0.336, Train_accy 94.57:  70%|███████   | 14/20 [00:25<00:10,  1.71s/it]Task 3, Epoch 15/20 => Loss 0.336, Train_accy 94.57:  75%|███████▌  | 15/20 [00:25<00:08,  1.71s/it]Task 3, Epoch 16/20 => Loss 0.340, Train_accy 92.39:  75%|███████▌  | 15/20 [00:27<00:08,  1.71s/it]Task 3, Epoch 16/20 => Loss 0.340, Train_accy 92.39:  80%|████████  | 16/20 [00:27<00:06,  1.72s/it]Task 3, Epoch 17/20 => Loss 0.318, Train_accy 95.29:  80%|████████  | 16/20 [00:29<00:06,  1.72s/it]Task 3, Epoch 17/20 => Loss 0.318, Train_accy 95.29:  85%|████████▌ | 17/20 [00:29<00:05,  1.71s/it]Task 3, Epoch 18/20 => Loss 0.328, Train_accy 94.20:  85%|████████▌ | 17/20 [00:30<00:05,  1.71s/it]Task 3, Epoch 18/20 => Loss 0.328, Train_accy 94.20:  90%|█████████ | 18/20 [00:30<00:03,  1.72s/it]Task 3, Epoch 19/20 => Loss 0.300, Train_accy 95.65:  90%|█████████ | 18/20 [00:32<00:03,  1.72s/it]Task 3, Epoch 19/20 => Loss 0.300, Train_accy 95.65:  95%|█████████▌| 19/20 [00:32<00:01,  1.72s/it]Task 3, Epoch 20/20 => Loss 0.315, Train_accy 94.57:  95%|█████████▌| 19/20 [00:34<00:01,  1.72s/it]Task 3, Epoch 20/20 => Loss 0.315, Train_accy 94.57: 100%|██████████| 20/20 [00:34<00:00,  1.73s/it]Task 3, Epoch 20/20 => Loss 0.315, Train_accy 94.57: 100%|██████████| 20/20 [00:34<00:00,  1.72s/it]
2024-05-10 03:41:54,421 [ease.py] => Task 3, Epoch 20/20 => Loss 0.315, Train_accy 94.57
2024-05-10 03:42:27,643 [ease.py] => Task correct: 98.10326659641728
2024-05-10 03:42:27,644 [ease.py] => Task acc: 95.96066034422199
2024-05-10 03:42:27,877 [trainer.py] => No NME accuracy.
2024-05-10 03:42:27,878 [trainer.py] => CNN: {'total': 94.59, '00-04': 95.1, '05-09': 100.0, '10-14': 97.55, '15-19': 91.13, 'old': 97.98, 'new': 91.13}
2024-05-10 03:42:27,878 [trainer.py] => CNN top1 curve: [97.55, 98.79, 98.54, 94.59]
2024-05-10 03:42:27,878 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.75]

Average Accuracy (CNN): 97.37
2024-05-10 03:42:27,878 [trainer.py] => Average Accuracy (CNN): 97.37 

2024-05-10 03:42:27,878 [trainer.py] => Train Time: 174.05999999999997
2024-05-10 03:42:27,878 [trainer.py] => Test Time: 46.03 

2024-05-10 03:42:27,879 [trainer.py] => All params: 87053570
2024-05-10 03:42:27,879 [trainer.py] => Trainable params: 1189632
2024-05-10 03:42:27,882 [ease.py] => Learning on 20-25
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.553, Train_accy 46.40:   0%|          | 0/20 [00:01<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.553, Train_accy 46.40:   5%|▌         | 1/20 [00:01<00:30,  1.62s/it]Task 4, Epoch 2/20 => Loss 1.323, Train_accy 78.40:   5%|▌         | 1/20 [00:03<00:30,  1.62s/it]Task 4, Epoch 2/20 => Loss 1.323, Train_accy 78.40:  10%|█         | 2/20 [00:03<00:28,  1.58s/it]Task 4, Epoch 3/20 => Loss 1.098, Train_accy 79.20:  10%|█         | 2/20 [00:04<00:28,  1.58s/it]Task 4, Epoch 3/20 => Loss 1.098, Train_accy 79.20:  15%|█▌        | 3/20 [00:04<00:27,  1.59s/it]Task 4, Epoch 4/20 => Loss 0.882, Train_accy 81.20:  15%|█▌        | 3/20 [00:06<00:27,  1.59s/it]Task 4, Epoch 4/20 => Loss 0.882, Train_accy 81.20:  20%|██        | 4/20 [00:06<00:25,  1.62s/it]Task 4, Epoch 5/20 => Loss 0.730, Train_accy 86.80:  20%|██        | 4/20 [00:08<00:25,  1.62s/it]Task 4, Epoch 5/20 => Loss 0.730, Train_accy 86.80:  25%|██▌       | 5/20 [00:08<00:23,  1.60s/it]Task 4, Epoch 6/20 => Loss 0.620, Train_accy 90.40:  25%|██▌       | 5/20 [00:09<00:23,  1.60s/it]Task 4, Epoch 6/20 => Loss 0.620, Train_accy 90.40:  30%|███       | 6/20 [00:09<00:22,  1.61s/it]Task 4, Epoch 7/20 => Loss 0.495, Train_accy 93.60:  30%|███       | 6/20 [00:11<00:22,  1.61s/it]Task 4, Epoch 7/20 => Loss 0.495, Train_accy 93.60:  35%|███▌      | 7/20 [00:11<00:21,  1.65s/it]Task 4, Epoch 8/20 => Loss 0.480, Train_accy 92.80:  35%|███▌      | 7/20 [00:12<00:21,  1.65s/it]Task 4, Epoch 8/20 => Loss 0.480, Train_accy 92.80:  40%|████      | 8/20 [00:12<00:19,  1.64s/it]Task 4, Epoch 9/20 => Loss 0.425, Train_accy 93.60:  40%|████      | 8/20 [00:14<00:19,  1.64s/it]Task 4, Epoch 9/20 => Loss 0.425, Train_accy 93.60:  45%|████▌     | 9/20 [00:14<00:18,  1.66s/it]Task 4, Epoch 10/20 => Loss 0.386, Train_accy 95.20:  45%|████▌     | 9/20 [00:16<00:18,  1.66s/it]Task 4, Epoch 10/20 => Loss 0.386, Train_accy 95.20:  50%|█████     | 10/20 [00:16<00:16,  1.67s/it]Task 4, Epoch 11/20 => Loss 0.342, Train_accy 94.40:  50%|█████     | 10/20 [00:18<00:16,  1.67s/it]Task 4, Epoch 11/20 => Loss 0.342, Train_accy 94.40:  55%|█████▌    | 11/20 [00:18<00:14,  1.66s/it]Task 4, Epoch 12/20 => Loss 0.351, Train_accy 93.20:  55%|█████▌    | 11/20 [00:19<00:14,  1.66s/it]Task 4, Epoch 12/20 => Loss 0.351, Train_accy 93.20:  60%|██████    | 12/20 [00:19<00:13,  1.64s/it]Task 4, Epoch 13/20 => Loss 0.332, Train_accy 95.60:  60%|██████    | 12/20 [00:21<00:13,  1.64s/it]Task 4, Epoch 13/20 => Loss 0.332, Train_accy 95.60:  65%|██████▌   | 13/20 [00:21<00:11,  1.63s/it]Task 4, Epoch 14/20 => Loss 0.325, Train_accy 93.60:  65%|██████▌   | 13/20 [00:22<00:11,  1.63s/it]Task 4, Epoch 14/20 => Loss 0.325, Train_accy 93.60:  70%|███████   | 14/20 [00:22<00:09,  1.60s/it]Task 4, Epoch 15/20 => Loss 0.285, Train_accy 96.00:  70%|███████   | 14/20 [00:24<00:09,  1.60s/it]Task 4, Epoch 15/20 => Loss 0.285, Train_accy 96.00:  75%|███████▌  | 15/20 [00:24<00:07,  1.59s/it]Task 4, Epoch 16/20 => Loss 0.279, Train_accy 96.00:  75%|███████▌  | 15/20 [00:25<00:07,  1.59s/it]Task 4, Epoch 16/20 => Loss 0.279, Train_accy 96.00:  80%|████████  | 16/20 [00:25<00:06,  1.60s/it]Task 4, Epoch 17/20 => Loss 0.350, Train_accy 95.20:  80%|████████  | 16/20 [00:27<00:06,  1.60s/it]Task 4, Epoch 17/20 => Loss 0.350, Train_accy 95.20:  85%|████████▌ | 17/20 [00:27<00:04,  1.60s/it]Task 4, Epoch 18/20 => Loss 0.290, Train_accy 94.40:  85%|████████▌ | 17/20 [00:29<00:04,  1.60s/it]Task 4, Epoch 18/20 => Loss 0.290, Train_accy 94.40:  90%|█████████ | 18/20 [00:29<00:03,  1.58s/it]Task 4, Epoch 19/20 => Loss 0.275, Train_accy 95.60:  90%|█████████ | 18/20 [00:30<00:03,  1.58s/it]Task 4, Epoch 19/20 => Loss 0.275, Train_accy 95.60:  95%|█████████▌| 19/20 [00:30<00:01,  1.59s/it]Task 4, Epoch 20/20 => Loss 0.278, Train_accy 96.40:  95%|█████████▌| 19/20 [00:32<00:01,  1.59s/it]Task 4, Epoch 20/20 => Loss 0.278, Train_accy 96.40: 100%|██████████| 20/20 [00:32<00:00,  1.60s/it]Task 4, Epoch 20/20 => Loss 0.278, Train_accy 96.40: 100%|██████████| 20/20 [00:32<00:00,  1.61s/it]
2024-05-10 03:43:00,183 [ease.py] => Task 4, Epoch 20/20 => Loss 0.278, Train_accy 96.40
2024-05-10 03:43:56,574 [ease.py] => Task correct: 90.51682106289614
2024-05-10 03:43:56,575 [ease.py] => Task acc: 96.09946367625548
2024-05-10 03:43:56,801 [trainer.py] => No NME accuracy.
2024-05-10 03:43:56,802 [trainer.py] => CNN: {'total': 88.08, '00-04': 93.36, '05-09': 98.15, '10-14': 91.5, '15-19': 88.86, '20-24': 80.0, 'old': 91.64, 'new': 80.0}
2024-05-10 03:43:56,802 [trainer.py] => CNN top1 curve: [97.55, 98.79, 98.54, 94.59, 88.08]
2024-05-10 03:43:56,802 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.75, 99.46]

Average Accuracy (CNN): 95.51
2024-05-10 03:43:56,802 [trainer.py] => Average Accuracy (CNN): 95.51 

2024-05-10 03:43:56,802 [trainer.py] => Train Time: 238.64999999999998
2024-05-10 03:43:56,802 [trainer.py] => Test Time: 97.27000000000001 

2024-05-10 03:43:56,803 [trainer.py] => All params: 87088130
2024-05-10 03:43:56,803 [trainer.py] => Trainable params: 1189632
2024-05-10 03:43:56,805 [ease.py] => Learning on 25-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.599, Train_accy 26.96:   0%|          | 0/20 [00:01<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.599, Train_accy 26.96:   5%|▌         | 1/20 [00:01<00:19,  1.03s/it]Task 5, Epoch 2/20 => Loss 1.537, Train_accy 66.96:   5%|▌         | 1/20 [00:02<00:19,  1.03s/it]Task 5, Epoch 2/20 => Loss 1.537, Train_accy 66.96:  10%|█         | 2/20 [00:02<00:18,  1.01s/it]Task 5, Epoch 3/20 => Loss 1.424, Train_accy 94.78:  10%|█         | 2/20 [00:02<00:18,  1.01s/it]Task 5, Epoch 3/20 => Loss 1.424, Train_accy 94.78:  15%|█▌        | 3/20 [00:02<00:16,  1.02it/s]Task 5, Epoch 4/20 => Loss 1.298, Train_accy 95.65:  15%|█▌        | 3/20 [00:03<00:16,  1.02it/s]Task 5, Epoch 4/20 => Loss 1.298, Train_accy 95.65:  20%|██        | 4/20 [00:03<00:15,  1.05it/s]Task 5, Epoch 5/20 => Loss 1.155, Train_accy 100.00:  20%|██        | 4/20 [00:04<00:15,  1.05it/s]Task 5, Epoch 5/20 => Loss 1.155, Train_accy 100.00:  25%|██▌       | 5/20 [00:04<00:14,  1.01it/s]Task 5, Epoch 6/20 => Loss 1.073, Train_accy 96.52:  25%|██▌       | 5/20 [00:05<00:14,  1.01it/s] Task 5, Epoch 6/20 => Loss 1.073, Train_accy 96.52:  30%|███       | 6/20 [00:05<00:13,  1.01it/s]Task 5, Epoch 7/20 => Loss 0.921, Train_accy 98.26:  30%|███       | 6/20 [00:06<00:13,  1.01it/s]Task 5, Epoch 7/20 => Loss 0.921, Train_accy 98.26:  35%|███▌      | 7/20 [00:06<00:12,  1.00it/s]Task 5, Epoch 8/20 => Loss 0.807, Train_accy 99.13:  35%|███▌      | 7/20 [00:07<00:12,  1.00it/s]Task 5, Epoch 8/20 => Loss 0.807, Train_accy 99.13:  40%|████      | 8/20 [00:07<00:11,  1.01it/s]Task 5, Epoch 9/20 => Loss 0.715, Train_accy 99.13:  40%|████      | 8/20 [00:09<00:11,  1.01it/s]Task 5, Epoch 9/20 => Loss 0.715, Train_accy 99.13:  45%|████▌     | 9/20 [00:09<00:11,  1.03s/it]Task 5, Epoch 10/20 => Loss 0.627, Train_accy 99.13:  45%|████▌     | 9/20 [00:09<00:11,  1.03s/it]Task 5, Epoch 10/20 => Loss 0.627, Train_accy 99.13:  50%|█████     | 10/20 [00:09<00:10,  1.01s/it]Task 5, Epoch 11/20 => Loss 0.597, Train_accy 99.13:  50%|█████     | 10/20 [00:10<00:10,  1.01s/it]Task 5, Epoch 11/20 => Loss 0.597, Train_accy 99.13:  55%|█████▌    | 11/20 [00:10<00:09,  1.00s/it]Task 5, Epoch 12/20 => Loss 0.547, Train_accy 99.13:  55%|█████▌    | 11/20 [00:12<00:09,  1.00s/it]Task 5, Epoch 12/20 => Loss 0.547, Train_accy 99.13:  60%|██████    | 12/20 [00:12<00:08,  1.01s/it]Task 5, Epoch 13/20 => Loss 0.485, Train_accy 99.13:  60%|██████    | 12/20 [00:13<00:08,  1.01s/it]Task 5, Epoch 13/20 => Loss 0.485, Train_accy 99.13:  65%|██████▌   | 13/20 [00:13<00:07,  1.01s/it]Task 5, Epoch 14/20 => Loss 0.491, Train_accy 98.26:  65%|██████▌   | 13/20 [00:14<00:07,  1.01s/it]Task 5, Epoch 14/20 => Loss 0.491, Train_accy 98.26:  70%|███████   | 14/20 [00:14<00:06,  1.03s/it]Task 5, Epoch 15/20 => Loss 0.446, Train_accy 100.00:  70%|███████   | 14/20 [00:15<00:06,  1.03s/it]Task 5, Epoch 15/20 => Loss 0.446, Train_accy 100.00:  75%|███████▌  | 15/20 [00:15<00:05,  1.02s/it]Task 5, Epoch 16/20 => Loss 0.440, Train_accy 99.13:  75%|███████▌  | 15/20 [00:16<00:05,  1.02s/it] Task 5, Epoch 16/20 => Loss 0.440, Train_accy 99.13:  80%|████████  | 16/20 [00:16<00:03,  1.01it/s]Task 5, Epoch 17/20 => Loss 0.455, Train_accy 98.26:  80%|████████  | 16/20 [00:17<00:03,  1.01it/s]Task 5, Epoch 17/20 => Loss 0.455, Train_accy 98.26:  85%|████████▌ | 17/20 [00:17<00:03,  1.02s/it]Task 5, Epoch 18/20 => Loss 0.426, Train_accy 100.00:  85%|████████▌ | 17/20 [00:18<00:03,  1.02s/it]Task 5, Epoch 18/20 => Loss 0.426, Train_accy 100.00:  90%|█████████ | 18/20 [00:18<00:02,  1.03s/it]Task 5, Epoch 19/20 => Loss 0.444, Train_accy 98.26:  90%|█████████ | 18/20 [00:19<00:02,  1.03s/it] Task 5, Epoch 19/20 => Loss 0.444, Train_accy 98.26:  95%|█████████▌| 19/20 [00:19<00:01,  1.01s/it]Task 5, Epoch 20/20 => Loss 0.428, Train_accy 100.00:  95%|█████████▌| 19/20 [00:20<00:01,  1.01s/it]Task 5, Epoch 20/20 => Loss 0.428, Train_accy 100.00: 100%|██████████| 20/20 [00:20<00:00,  1.01s/it]Task 5, Epoch 20/20 => Loss 0.428, Train_accy 100.00: 100%|██████████| 20/20 [00:20<00:00,  1.01s/it]
2024-05-10 03:44:16,942 [ease.py] => Task 5, Epoch 20/20 => Loss 0.428, Train_accy 100.00
2024-05-10 03:45:29,049 [ease.py] => Task correct: 90.58035714285714
2024-05-10 03:45:29,049 [ease.py] => Task acc: 96.38392857142857
2024-05-10 03:45:29,080 [trainer.py] => No NME accuracy.
2024-05-10 03:45:29,081 [trainer.py] => CNN: {'total': 88.33, '00-04': 89.86, '05-09': 98.7, '10-14': 91.34, '15-19': 88.57, '20-24': 80.0, '25-29': 94.18, 'old': 87.79, 'new': 94.18}
2024-05-10 03:45:29,081 [trainer.py] => CNN top1 curve: [97.55, 98.79, 98.54, 94.59, 88.08, 88.33]
2024-05-10 03:45:29,081 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.75, 99.46, 99.46]

Average Accuracy (CNN): 94.31
2024-05-10 03:45:29,081 [trainer.py] => Average Accuracy (CNN): 94.31 

2024-05-10 03:45:29,081 [trainer.py] => Train Time: 278.91999999999996
2024-05-10 03:45:29,081 [trainer.py] => Test Time: 164.25 

2024-05-10 03:45:29,082 [trainer.py] => All params: 87130370
2024-05-10 03:45:29,082 [trainer.py] => Trainable params: 1189632
2024-05-10 03:45:29,085 [ease.py] => Learning on 30-35
  0%|          | 0/20 [00:00<?, ?it/s]Task 6, Epoch 1/20 => Loss 1.554, Train_accy 52.30:   0%|          | 0/20 [00:01<?, ?it/s]Task 6, Epoch 1/20 => Loss 1.554, Train_accy 52.30:   5%|▌         | 1/20 [00:01<00:22,  1.18s/it]Task 6, Epoch 2/20 => Loss 1.318, Train_accy 76.44:   5%|▌         | 1/20 [00:02<00:22,  1.18s/it]Task 6, Epoch 2/20 => Loss 1.318, Train_accy 76.44:  10%|█         | 2/20 [00:02<00:22,  1.24s/it]Task 6, Epoch 3/20 => Loss 1.066, Train_accy 85.06:  10%|█         | 2/20 [00:03<00:22,  1.24s/it]Task 6, Epoch 3/20 => Loss 1.066, Train_accy 85.06:  15%|█▌        | 3/20 [00:03<00:20,  1.21s/it]Task 6, Epoch 4/20 => Loss 0.834, Train_accy 88.51:  15%|█▌        | 3/20 [00:04<00:20,  1.21s/it]Task 6, Epoch 4/20 => Loss 0.834, Train_accy 88.51:  20%|██        | 4/20 [00:04<00:19,  1.21s/it]Task 6, Epoch 5/20 => Loss 0.637, Train_accy 95.98:  20%|██        | 4/20 [00:06<00:19,  1.21s/it]Task 6, Epoch 5/20 => Loss 0.637, Train_accy 95.98:  25%|██▌       | 5/20 [00:06<00:18,  1.22s/it]Task 6, Epoch 6/20 => Loss 0.517, Train_accy 93.10:  25%|██▌       | 5/20 [00:07<00:18,  1.22s/it]Task 6, Epoch 6/20 => Loss 0.517, Train_accy 93.10:  30%|███       | 6/20 [00:07<00:16,  1.21s/it]Task 6, Epoch 7/20 => Loss 0.409, Train_accy 98.28:  30%|███       | 6/20 [00:08<00:16,  1.21s/it]Task 6, Epoch 7/20 => Loss 0.409, Train_accy 98.28:  35%|███▌      | 7/20 [00:08<00:16,  1.25s/it]Task 6, Epoch 8/20 => Loss 0.353, Train_accy 97.70:  35%|███▌      | 7/20 [00:09<00:16,  1.25s/it]Task 6, Epoch 8/20 => Loss 0.353, Train_accy 97.70:  40%|████      | 8/20 [00:09<00:14,  1.23s/it]Task 6, Epoch 9/20 => Loss 0.288, Train_accy 99.43:  40%|████      | 8/20 [00:11<00:14,  1.23s/it]Task 6, Epoch 9/20 => Loss 0.288, Train_accy 99.43:  45%|████▌     | 9/20 [00:11<00:13,  1.23s/it]Task 6, Epoch 10/20 => Loss 0.275, Train_accy 97.70:  45%|████▌     | 9/20 [00:12<00:13,  1.23s/it]Task 6, Epoch 10/20 => Loss 0.275, Train_accy 97.70:  50%|█████     | 10/20 [00:12<00:12,  1.23s/it]Task 6, Epoch 11/20 => Loss 0.230, Train_accy 99.43:  50%|█████     | 10/20 [00:13<00:12,  1.23s/it]Task 6, Epoch 11/20 => Loss 0.230, Train_accy 99.43:  55%|█████▌    | 11/20 [00:13<00:11,  1.24s/it]Task 6, Epoch 12/20 => Loss 0.215, Train_accy 99.43:  55%|█████▌    | 11/20 [00:14<00:11,  1.24s/it]Task 6, Epoch 12/20 => Loss 0.215, Train_accy 99.43:  60%|██████    | 12/20 [00:14<00:09,  1.23s/it]Task 6, Epoch 13/20 => Loss 0.184, Train_accy 100.00:  60%|██████    | 12/20 [00:15<00:09,  1.23s/it]Task 6, Epoch 13/20 => Loss 0.184, Train_accy 100.00:  65%|██████▌   | 13/20 [00:15<00:08,  1.23s/it]Task 6, Epoch 14/20 => Loss 0.191, Train_accy 98.85:  65%|██████▌   | 13/20 [00:17<00:08,  1.23s/it] Task 6, Epoch 14/20 => Loss 0.191, Train_accy 98.85:  70%|███████   | 14/20 [00:17<00:07,  1.22s/it]Task 6, Epoch 15/20 => Loss 0.185, Train_accy 99.43:  70%|███████   | 14/20 [00:18<00:07,  1.22s/it]Task 6, Epoch 15/20 => Loss 0.185, Train_accy 99.43:  75%|███████▌  | 15/20 [00:18<00:06,  1.22s/it]Task 6, Epoch 16/20 => Loss 0.183, Train_accy 100.00:  75%|███████▌  | 15/20 [00:19<00:06,  1.22s/it]Task 6, Epoch 16/20 => Loss 0.183, Train_accy 100.00:  80%|████████  | 16/20 [00:19<00:04,  1.22s/it]Task 6, Epoch 17/20 => Loss 0.180, Train_accy 99.43:  80%|████████  | 16/20 [00:20<00:04,  1.22s/it] Task 6, Epoch 17/20 => Loss 0.180, Train_accy 99.43:  85%|████████▌ | 17/20 [00:20<00:03,  1.24s/it]Task 6, Epoch 18/20 => Loss 0.174, Train_accy 98.28:  85%|████████▌ | 17/20 [00:22<00:03,  1.24s/it]Task 6, Epoch 18/20 => Loss 0.174, Train_accy 98.28:  90%|█████████ | 18/20 [00:22<00:02,  1.23s/it]Task 6, Epoch 19/20 => Loss 0.173, Train_accy 99.43:  90%|█████████ | 18/20 [00:23<00:02,  1.23s/it]Task 6, Epoch 19/20 => Loss 0.173, Train_accy 99.43:  95%|█████████▌| 19/20 [00:23<00:01,  1.23s/it]Task 6, Epoch 20/20 => Loss 0.174, Train_accy 100.00:  95%|█████████▌| 19/20 [00:24<00:01,  1.23s/it]Task 6, Epoch 20/20 => Loss 0.174, Train_accy 100.00: 100%|██████████| 20/20 [00:24<00:00,  1.23s/it]Task 6, Epoch 20/20 => Loss 0.174, Train_accy 100.00: 100%|██████████| 20/20 [00:24<00:00,  1.23s/it]
2024-05-10 03:45:53,617 [ease.py] => Task 6, Epoch 20/20 => Loss 0.174, Train_accy 100.00
2024-05-10 03:47:31,957 [ease.py] => Task correct: 89.34038934038934
2024-05-10 03:47:31,958 [ease.py] => Task acc: 96.88149688149689
2024-05-10 03:47:32,027 [trainer.py] => No NME accuracy.
2024-05-10 03:47:32,027 [trainer.py] => CNN: {'total': 87.56, '00-04': 89.51, '05-09': 98.33, '10-14': 90.52, '15-19': 88.36, '20-24': 73.86, '25-29': 93.65, '30-34': 94.45, 'old': 86.32, 'new': 94.45}
2024-05-10 03:47:32,027 [trainer.py] => CNN top1 curve: [97.55, 98.79, 98.54, 94.59, 88.08, 88.33, 87.56]
2024-05-10 03:47:32,027 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.75, 99.46, 99.46, 99.13]

Average Accuracy (CNN): 93.35
2024-05-10 03:47:32,027 [trainer.py] => Average Accuracy (CNN): 93.35 

2024-05-10 03:47:32,027 [trainer.py] => Train Time: 327.9799999999999
2024-05-10 03:47:32,027 [trainer.py] => Test Time: 256.1 

2024-05-10 03:47:32,028 [trainer.py] => All params: 87180290
2024-05-10 03:47:32,029 [trainer.py] => Trainable params: 1189632
2024-05-10 03:47:32,031 [ease.py] => Learning on 35-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.587, Train_accy 41.86:   0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 1.587, Train_accy 41.86:   5%|▌         | 1/20 [00:00<00:18,  1.03it/s]Task 7, Epoch 2/20 => Loss 1.516, Train_accy 69.77:   5%|▌         | 1/20 [00:01<00:18,  1.03it/s]Task 7, Epoch 2/20 => Loss 1.516, Train_accy 69.77:  10%|█         | 2/20 [00:01<00:17,  1.03it/s]Task 7, Epoch 3/20 => Loss 1.409, Train_accy 77.52:  10%|█         | 2/20 [00:03<00:17,  1.03it/s]Task 7, Epoch 3/20 => Loss 1.409, Train_accy 77.52:  15%|█▌        | 3/20 [00:03<00:17,  1.02s/it]Task 7, Epoch 4/20 => Loss 1.259, Train_accy 83.72:  15%|█▌        | 3/20 [00:04<00:17,  1.02s/it]Task 7, Epoch 4/20 => Loss 1.259, Train_accy 83.72:  20%|██        | 4/20 [00:04<00:17,  1.07s/it]Task 7, Epoch 5/20 => Loss 1.122, Train_accy 87.60:  20%|██        | 4/20 [00:05<00:17,  1.07s/it]Task 7, Epoch 5/20 => Loss 1.122, Train_accy 87.60:  25%|██▌       | 5/20 [00:05<00:15,  1.05s/it]Task 7, Epoch 6/20 => Loss 1.024, Train_accy 85.27:  25%|██▌       | 5/20 [00:06<00:15,  1.05s/it]Task 7, Epoch 6/20 => Loss 1.024, Train_accy 85.27:  30%|███       | 6/20 [00:06<00:15,  1.07s/it]Task 7, Epoch 7/20 => Loss 0.875, Train_accy 92.25:  30%|███       | 6/20 [00:07<00:15,  1.07s/it]Task 7, Epoch 7/20 => Loss 0.875, Train_accy 92.25:  35%|███▌      | 7/20 [00:07<00:13,  1.04s/it]Task 7, Epoch 8/20 => Loss 0.781, Train_accy 91.47:  35%|███▌      | 7/20 [00:08<00:13,  1.04s/it]Task 7, Epoch 8/20 => Loss 0.781, Train_accy 91.47:  40%|████      | 8/20 [00:08<00:12,  1.07s/it]Task 7, Epoch 9/20 => Loss 0.696, Train_accy 94.57:  40%|████      | 8/20 [00:09<00:12,  1.07s/it]Task 7, Epoch 9/20 => Loss 0.696, Train_accy 94.57:  45%|████▌     | 9/20 [00:09<00:11,  1.06s/it]Task 7, Epoch 10/20 => Loss 0.625, Train_accy 97.67:  45%|████▌     | 9/20 [00:10<00:11,  1.06s/it]Task 7, Epoch 10/20 => Loss 0.625, Train_accy 97.67:  50%|█████     | 10/20 [00:10<00:10,  1.06s/it]Task 7, Epoch 11/20 => Loss 0.574, Train_accy 97.67:  50%|█████     | 10/20 [00:11<00:10,  1.06s/it]Task 7, Epoch 11/20 => Loss 0.574, Train_accy 97.67:  55%|█████▌    | 11/20 [00:11<00:09,  1.05s/it]Task 7, Epoch 12/20 => Loss 0.520, Train_accy 98.45:  55%|█████▌    | 11/20 [00:12<00:09,  1.05s/it]Task 7, Epoch 12/20 => Loss 0.520, Train_accy 98.45:  60%|██████    | 12/20 [00:12<00:08,  1.04s/it]Task 7, Epoch 13/20 => Loss 0.510, Train_accy 97.67:  60%|██████    | 12/20 [00:13<00:08,  1.04s/it]Task 7, Epoch 13/20 => Loss 0.510, Train_accy 97.67:  65%|██████▌   | 13/20 [00:13<00:07,  1.03s/it]Task 7, Epoch 14/20 => Loss 0.459, Train_accy 96.90:  65%|██████▌   | 13/20 [00:14<00:07,  1.03s/it]Task 7, Epoch 14/20 => Loss 0.459, Train_accy 96.90:  70%|███████   | 14/20 [00:14<00:06,  1.02s/it]Task 7, Epoch 15/20 => Loss 0.447, Train_accy 99.22:  70%|███████   | 14/20 [00:15<00:06,  1.02s/it]Task 7, Epoch 15/20 => Loss 0.447, Train_accy 99.22:  75%|███████▌  | 15/20 [00:15<00:05,  1.02s/it]Task 7, Epoch 16/20 => Loss 0.463, Train_accy 98.45:  75%|███████▌  | 15/20 [00:16<00:05,  1.02s/it]Task 7, Epoch 16/20 => Loss 0.463, Train_accy 98.45:  80%|████████  | 16/20 [00:16<00:04,  1.02s/it]Task 7, Epoch 17/20 => Loss 0.429, Train_accy 98.45:  80%|████████  | 16/20 [00:17<00:04,  1.02s/it]Task 7, Epoch 17/20 => Loss 0.429, Train_accy 98.45:  85%|████████▌ | 17/20 [00:17<00:03,  1.05s/it]Task 7, Epoch 18/20 => Loss 0.460, Train_accy 96.90:  85%|████████▌ | 17/20 [00:18<00:03,  1.05s/it]Task 7, Epoch 18/20 => Loss 0.460, Train_accy 96.90:  90%|█████████ | 18/20 [00:18<00:02,  1.03s/it]Task 7, Epoch 19/20 => Loss 0.439, Train_accy 98.45:  90%|█████████ | 18/20 [00:19<00:02,  1.03s/it]Task 7, Epoch 19/20 => Loss 0.439, Train_accy 98.45:  95%|█████████▌| 19/20 [00:19<00:01,  1.05s/it]Task 7, Epoch 20/20 => Loss 0.440, Train_accy 99.22:  95%|█████████▌| 19/20 [00:20<00:01,  1.05s/it]Task 7, Epoch 20/20 => Loss 0.440, Train_accy 99.22: 100%|██████████| 20/20 [00:20<00:00,  1.04s/it]Task 7, Epoch 20/20 => Loss 0.440, Train_accy 99.22: 100%|██████████| 20/20 [00:20<00:00,  1.04s/it]
2024-05-10 03:47:52,853 [ease.py] => Task 7, Epoch 20/20 => Loss 0.440, Train_accy 99.22
2024-05-10 03:49:52,970 [ease.py] => Task correct: 88.49912739965096
2024-05-10 03:49:52,971 [ease.py] => Task acc: 97.01570680628272
2024-05-10 03:49:53,017 [trainer.py] => No NME accuracy.
2024-05-10 03:49:53,017 [trainer.py] => CNN: {'total': 86.88, '00-04': 89.86, '05-09': 96.85, '10-14': 90.36, '15-19': 87.58, '20-24': 72.03, '25-29': 92.86, '30-34': 94.33, '35-39': 89.07, 'old': 86.69, 'new': 89.07}
2024-05-10 03:49:53,017 [trainer.py] => CNN top1 curve: [97.55, 98.79, 98.54, 94.59, 88.08, 88.33, 87.56, 86.88]
2024-05-10 03:49:53,017 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.75, 99.46, 99.46, 99.13, 98.87]

Average Accuracy (CNN): 92.54
2024-05-10 03:49:53,018 [trainer.py] => Average Accuracy (CNN): 92.54 

2024-05-10 03:49:53,018 [trainer.py] => Train Time: 369.6199999999999
2024-05-10 03:49:53,018 [trainer.py] => Test Time: 369.34000000000003 

2024-05-10 03:49:53,019 [trainer.py] => All params: 87237890
2024-05-10 03:49:53,019 [trainer.py] => Trainable params: 1189632
2024-05-10 03:49:53,024 [ease.py] => Learning on 40-45
  0%|          | 0/20 [00:00<?, ?it/s]Task 8, Epoch 1/20 => Loss 1.518, Train_accy 61.51:   0%|          | 0/20 [00:01<?, ?it/s]Task 8, Epoch 1/20 => Loss 1.518, Train_accy 61.51:   5%|▌         | 1/20 [00:01<00:36,  1.90s/it]Task 8, Epoch 2/20 => Loss 1.158, Train_accy 73.54:   5%|▌         | 1/20 [00:03<00:36,  1.90s/it]Task 8, Epoch 2/20 => Loss 1.158, Train_accy 73.54:  10%|█         | 2/20 [00:03<00:34,  1.89s/it]Task 8, Epoch 3/20 => Loss 0.814, Train_accy 75.95:  10%|█         | 2/20 [00:05<00:34,  1.89s/it]Task 8, Epoch 3/20 => Loss 0.814, Train_accy 75.95:  15%|█▌        | 3/20 [00:05<00:31,  1.84s/it]Task 8, Epoch 4/20 => Loss 0.619, Train_accy 83.16:  15%|█▌        | 3/20 [00:07<00:31,  1.84s/it]Task 8, Epoch 4/20 => Loss 0.619, Train_accy 83.16:  20%|██        | 4/20 [00:07<00:29,  1.85s/it]Task 8, Epoch 5/20 => Loss 0.452, Train_accy 90.03:  20%|██        | 4/20 [00:09<00:29,  1.85s/it]Task 8, Epoch 5/20 => Loss 0.452, Train_accy 90.03:  25%|██▌       | 5/20 [00:09<00:27,  1.83s/it]Task 8, Epoch 6/20 => Loss 0.402, Train_accy 95.19:  25%|██▌       | 5/20 [00:11<00:27,  1.83s/it]Task 8, Epoch 6/20 => Loss 0.402, Train_accy 95.19:  30%|███       | 6/20 [00:11<00:25,  1.83s/it]Task 8, Epoch 7/20 => Loss 0.303, Train_accy 95.19:  30%|███       | 6/20 [00:12<00:25,  1.83s/it]Task 8, Epoch 7/20 => Loss 0.303, Train_accy 95.19:  35%|███▌      | 7/20 [00:12<00:23,  1.81s/it]Task 8, Epoch 8/20 => Loss 0.252, Train_accy 96.22:  35%|███▌      | 7/20 [00:14<00:23,  1.81s/it]Task 8, Epoch 8/20 => Loss 0.252, Train_accy 96.22:  40%|████      | 8/20 [00:14<00:22,  1.83s/it]Task 8, Epoch 9/20 => Loss 0.257, Train_accy 96.56:  40%|████      | 8/20 [00:16<00:22,  1.83s/it]Task 8, Epoch 9/20 => Loss 0.257, Train_accy 96.56:  45%|████▌     | 9/20 [00:16<00:21,  1.91s/it]Task 8, Epoch 10/20 => Loss 0.295, Train_accy 94.85:  45%|████▌     | 9/20 [00:18<00:21,  1.91s/it]Task 8, Epoch 10/20 => Loss 0.295, Train_accy 94.85:  50%|█████     | 10/20 [00:18<00:19,  1.90s/it]Task 8, Epoch 11/20 => Loss 0.184, Train_accy 97.94:  50%|█████     | 10/20 [00:20<00:19,  1.90s/it]Task 8, Epoch 11/20 => Loss 0.184, Train_accy 97.94:  55%|█████▌    | 11/20 [00:20<00:16,  1.86s/it]Task 8, Epoch 12/20 => Loss 0.240, Train_accy 96.91:  55%|█████▌    | 11/20 [00:22<00:16,  1.86s/it]Task 8, Epoch 12/20 => Loss 0.240, Train_accy 96.91:  60%|██████    | 12/20 [00:22<00:14,  1.86s/it]Task 8, Epoch 13/20 => Loss 0.180, Train_accy 98.28:  60%|██████    | 12/20 [00:24<00:14,  1.86s/it]Task 8, Epoch 13/20 => Loss 0.180, Train_accy 98.28:  65%|██████▌   | 13/20 [00:24<00:12,  1.86s/it]Task 8, Epoch 14/20 => Loss 0.185, Train_accy 96.56:  65%|██████▌   | 13/20 [00:26<00:12,  1.86s/it]Task 8, Epoch 14/20 => Loss 0.185, Train_accy 96.56:  70%|███████   | 14/20 [00:26<00:11,  1.87s/it]Task 8, Epoch 15/20 => Loss 0.178, Train_accy 96.22:  70%|███████   | 14/20 [00:27<00:11,  1.87s/it]Task 8, Epoch 15/20 => Loss 0.178, Train_accy 96.22:  75%|███████▌  | 15/20 [00:27<00:09,  1.84s/it]Task 8, Epoch 16/20 => Loss 0.223, Train_accy 95.19:  75%|███████▌  | 15/20 [00:29<00:09,  1.84s/it]Task 8, Epoch 16/20 => Loss 0.223, Train_accy 95.19:  80%|████████  | 16/20 [00:29<00:07,  1.86s/it]Task 8, Epoch 17/20 => Loss 0.166, Train_accy 96.56:  80%|████████  | 16/20 [00:31<00:07,  1.86s/it]Task 8, Epoch 17/20 => Loss 0.166, Train_accy 96.56:  85%|████████▌ | 17/20 [00:31<00:05,  1.84s/it]Task 8, Epoch 18/20 => Loss 0.192, Train_accy 97.94:  85%|████████▌ | 17/20 [00:33<00:05,  1.84s/it]Task 8, Epoch 18/20 => Loss 0.192, Train_accy 97.94:  90%|█████████ | 18/20 [00:33<00:03,  1.82s/it]Task 8, Epoch 19/20 => Loss 0.169, Train_accy 96.91:  90%|█████████ | 18/20 [00:35<00:03,  1.82s/it]Task 8, Epoch 19/20 => Loss 0.169, Train_accy 96.91:  95%|█████████▌| 19/20 [00:35<00:01,  1.85s/it]Task 8, Epoch 20/20 => Loss 0.183, Train_accy 97.25:  95%|█████████▌| 19/20 [00:37<00:01,  1.85s/it]Task 8, Epoch 20/20 => Loss 0.183, Train_accy 97.25: 100%|██████████| 20/20 [00:37<00:00,  1.84s/it]Task 8, Epoch 20/20 => Loss 0.183, Train_accy 97.25: 100%|██████████| 20/20 [00:37<00:00,  1.85s/it]
2024-05-10 03:50:30,081 [ease.py] => Task 8, Epoch 20/20 => Loss 0.183, Train_accy 97.25
2024-05-10 03:53:21,072 [ease.py] => Task correct: 87.06385326161909
2024-05-10 03:53:21,073 [ease.py] => Task acc: 97.02110053785685
2024-05-10 03:53:21,125 [trainer.py] => No NME accuracy.
2024-05-10 03:53:21,125 [trainer.py] => CNN: {'total': 85.68, '00-04': 88.81, '05-09': 97.04, '10-14': 89.87, '15-19': 87.37, '20-24': 70.2, '25-29': 92.33, '30-34': 94.33, '35-39': 88.38, '40-44': 83.56, 'old': 86.25, 'new': 83.56}
2024-05-10 03:53:21,125 [trainer.py] => CNN top1 curve: [97.55, 98.79, 98.54, 94.59, 88.08, 88.33, 87.56, 86.88, 85.68]
2024-05-10 03:53:21,125 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.75, 99.46, 99.46, 99.13, 98.87, 98.65]

Average Accuracy (CNN): 91.78
2024-05-10 03:53:21,125 [trainer.py] => Average Accuracy (CNN): 91.78 

2024-05-10 03:53:21,125 [trainer.py] => Train Time: 443.7299999999999
2024-05-10 03:53:21,126 [trainer.py] => Test Time: 530.02 

2024-05-10 03:53:21,126 [trainer.py] => All params: 87303170
2024-05-10 03:53:21,127 [trainer.py] => Trainable params: 1189632
2024-05-10 03:53:21,132 [ease.py] => Learning on 45-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 9, Epoch 1/20 => Loss 1.533, Train_accy 44.27:   0%|          | 0/20 [00:01<?, ?it/s]Task 9, Epoch 1/20 => Loss 1.533, Train_accy 44.27:   5%|▌         | 1/20 [00:01<00:31,  1.68s/it]Task 9, Epoch 2/20 => Loss 1.151, Train_accy 74.43:   5%|▌         | 1/20 [00:03<00:31,  1.68s/it]Task 9, Epoch 2/20 => Loss 1.151, Train_accy 74.43:  10%|█         | 2/20 [00:03<00:29,  1.66s/it]Task 9, Epoch 3/20 => Loss 0.839, Train_accy 80.15:  10%|█         | 2/20 [00:04<00:29,  1.66s/it]Task 9, Epoch 3/20 => Loss 0.839, Train_accy 80.15:  15%|█▌        | 3/20 [00:04<00:28,  1.66s/it]Task 9, Epoch 4/20 => Loss 0.613, Train_accy 84.35:  15%|█▌        | 3/20 [00:06<00:28,  1.66s/it]Task 9, Epoch 4/20 => Loss 0.613, Train_accy 84.35:  20%|██        | 4/20 [00:06<00:26,  1.68s/it]Task 9, Epoch 5/20 => Loss 0.447, Train_accy 90.84:  20%|██        | 4/20 [00:08<00:26,  1.68s/it]Task 9, Epoch 5/20 => Loss 0.447, Train_accy 90.84:  25%|██▌       | 5/20 [00:08<00:24,  1.66s/it]Task 9, Epoch 6/20 => Loss 0.375, Train_accy 93.89:  25%|██▌       | 5/20 [00:09<00:24,  1.66s/it]Task 9, Epoch 6/20 => Loss 0.375, Train_accy 93.89:  30%|███       | 6/20 [00:09<00:23,  1.67s/it]Task 9, Epoch 7/20 => Loss 0.300, Train_accy 95.80:  30%|███       | 6/20 [00:11<00:23,  1.67s/it]Task 9, Epoch 7/20 => Loss 0.300, Train_accy 95.80:  35%|███▌      | 7/20 [00:11<00:21,  1.67s/it]Task 9, Epoch 8/20 => Loss 0.246, Train_accy 96.18:  35%|███▌      | 7/20 [00:13<00:21,  1.67s/it]Task 9, Epoch 8/20 => Loss 0.246, Train_accy 96.18:  40%|████      | 8/20 [00:13<00:19,  1.66s/it]Task 9, Epoch 9/20 => Loss 0.242, Train_accy 96.18:  40%|████      | 8/20 [00:14<00:19,  1.66s/it]Task 9, Epoch 9/20 => Loss 0.242, Train_accy 96.18:  45%|████▌     | 9/20 [00:14<00:18,  1.64s/it]Task 9, Epoch 10/20 => Loss 0.214, Train_accy 96.56:  45%|████▌     | 9/20 [00:16<00:18,  1.64s/it]Task 9, Epoch 10/20 => Loss 0.214, Train_accy 96.56:  50%|█████     | 10/20 [00:16<00:16,  1.66s/it]Task 9, Epoch 11/20 => Loss 0.197, Train_accy 97.33:  50%|█████     | 10/20 [00:18<00:16,  1.66s/it]Task 9, Epoch 11/20 => Loss 0.197, Train_accy 97.33:  55%|█████▌    | 11/20 [00:18<00:14,  1.66s/it]Task 9, Epoch 12/20 => Loss 0.186, Train_accy 97.71:  55%|█████▌    | 11/20 [00:19<00:14,  1.66s/it]Task 9, Epoch 12/20 => Loss 0.186, Train_accy 97.71:  60%|██████    | 12/20 [00:19<00:13,  1.67s/it]Task 9, Epoch 13/20 => Loss 0.176, Train_accy 96.95:  60%|██████    | 12/20 [00:21<00:13,  1.67s/it]Task 9, Epoch 13/20 => Loss 0.176, Train_accy 96.95:  65%|██████▌   | 13/20 [00:21<00:11,  1.68s/it]Task 9, Epoch 14/20 => Loss 0.163, Train_accy 97.33:  65%|██████▌   | 13/20 [00:23<00:11,  1.68s/it]Task 9, Epoch 14/20 => Loss 0.163, Train_accy 97.33:  70%|███████   | 14/20 [00:23<00:09,  1.66s/it]Task 9, Epoch 15/20 => Loss 0.141, Train_accy 98.85:  70%|███████   | 14/20 [00:24<00:09,  1.66s/it]Task 9, Epoch 15/20 => Loss 0.141, Train_accy 98.85:  75%|███████▌  | 15/20 [00:24<00:08,  1.67s/it]Task 9, Epoch 16/20 => Loss 0.163, Train_accy 97.71:  75%|███████▌  | 15/20 [00:26<00:08,  1.67s/it]Task 9, Epoch 16/20 => Loss 0.163, Train_accy 97.71:  80%|████████  | 16/20 [00:26<00:06,  1.66s/it]Task 9, Epoch 17/20 => Loss 0.161, Train_accy 96.95:  80%|████████  | 16/20 [00:28<00:06,  1.66s/it]Task 9, Epoch 17/20 => Loss 0.161, Train_accy 96.95:  85%|████████▌ | 17/20 [00:28<00:05,  1.68s/it]Task 9, Epoch 18/20 => Loss 0.156, Train_accy 96.56:  85%|████████▌ | 17/20 [00:30<00:05,  1.68s/it]Task 9, Epoch 18/20 => Loss 0.156, Train_accy 96.56:  90%|█████████ | 18/20 [00:30<00:03,  1.70s/it]Task 9, Epoch 19/20 => Loss 0.172, Train_accy 96.56:  90%|█████████ | 18/20 [00:31<00:03,  1.70s/it]Task 9, Epoch 19/20 => Loss 0.172, Train_accy 96.56:  95%|█████████▌| 19/20 [00:31<00:01,  1.67s/it]Task 9, Epoch 20/20 => Loss 0.163, Train_accy 97.33:  95%|█████████▌| 19/20 [00:33<00:01,  1.67s/it]Task 9, Epoch 20/20 => Loss 0.163, Train_accy 97.33: 100%|██████████| 20/20 [00:33<00:00,  1.66s/it]Task 9, Epoch 20/20 => Loss 0.163, Train_accy 97.33: 100%|██████████| 20/20 [00:33<00:00,  1.67s/it]
2024-05-10 03:53:54,481 [ease.py] => Task 9, Epoch 20/20 => Loss 0.163, Train_accy 97.33
2024-05-10 03:57:37,610 [ease.py] => Task correct: 83.8032254321847
2024-05-10 03:57:37,610 [ease.py] => Task acc: 97.29667014734888
2024-05-10 03:57:37,777 [trainer.py] => No NME accuracy.
2024-05-10 03:57:37,778 [trainer.py] => CNN: {'total': 82.75, '00-04': 88.81, '05-09': 97.04, '10-14': 86.27, '15-19': 85.88, '20-24': 66.14, '25-29': 92.33, '30-34': 94.2, '35-39': 85.19, '40-44': 80.8, '45-49': 78.22, 'old': 83.6, 'new': 78.22}
2024-05-10 03:57:37,778 [trainer.py] => CNN top1 curve: [97.55, 98.79, 98.54, 94.59, 88.08, 88.33, 87.56, 86.88, 85.68, 82.75]
2024-05-10 03:57:37,778 [trainer.py] => CNN top5 curve: [100.0, 99.64, 99.79, 99.75, 99.46, 99.46, 99.13, 98.87, 98.65, 98.16]

Average Accuracy (CNN): 90.88
2024-05-10 03:57:37,778 [trainer.py] => Average Accuracy (CNN): 90.88 

2024-05-10 03:57:37,778 [trainer.py] => Train Time: 510.41999999999996
2024-05-10 03:57:37,778 [trainer.py] => Test Time: 741.77 

Accuracy Matrix (CNN):
[[ 97.55  96.5   95.1   95.1   93.36  89.86  89.51  89.86  88.81  88.81]
 [  0.   100.   100.   100.    98.15  98.7   98.33  96.85  97.04  97.04]
 [  0.     0.    98.86  97.55  91.5   91.34  90.52  90.36  89.87  86.27]
 [  0.     0.     0.    91.13  88.86  88.57  88.36  87.58  87.37  85.88]
 [  0.     0.     0.     0.    80.    80.    73.86  72.03  70.2   66.14]
 [  0.     0.     0.     0.     0.    94.18  93.65  92.86  92.33  92.33]
 [  0.     0.     0.     0.     0.     0.    94.45  94.33  94.33  94.2 ]
 [  0.     0.     0.     0.     0.     0.     0.    89.07  88.38  85.19]
 [  0.     0.     0.     0.     0.     0.     0.     0.    83.56  80.8 ]
 [  0.     0.     0.     0.     0.     0.     0.     0.     0.    78.22]]
2024-05-10 03:57:37,779 [trainer.py] => Forgetting (CNN): 5.793333333333333

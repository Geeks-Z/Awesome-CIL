nohup: 忽略输入
2024-07-20 13:17:11,117 [trainer.py] => config: ./exps/icarl_vtab_B0_Inc5.json
2024-07-20 13:17:11,117 [trainer.py] => prefix: reproduce
2024-07-20 13:17:11,118 [trainer.py] => dataset: cifar224
2024-07-20 13:17:11,118 [trainer.py] => memory_size: 1000
2024-07-20 13:17:11,118 [trainer.py] => memory_per_class: 20
2024-07-20 13:17:11,118 [trainer.py] => fixed_memory: True
2024-07-20 13:17:11,118 [trainer.py] => shuffle: True
2024-07-20 13:17:11,118 [trainer.py] => init_cls: 10
2024-07-20 13:17:11,118 [trainer.py] => increment: 10
2024-07-20 13:17:11,118 [trainer.py] => model_name: icarl
2024-07-20 13:17:11,118 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-07-20 13:17:11,118 [trainer.py] => device: [device(type='cuda', index=0)]
2024-07-20 13:17:11,118 [trainer.py] => seed: 1993
2024-07-20 13:17:11,118 [trainer.py] => init_epoch: 20
2024-07-20 13:17:11,118 [trainer.py] => init_lr: 0.001
2024-07-20 13:17:11,118 [trainer.py] => init_milestones: [60, 120, 170]
2024-07-20 13:17:11,118 [trainer.py] => init_lr_decay: 0.1
2024-07-20 13:17:11,118 [trainer.py] => init_weight_decay: 0.0005
2024-07-20 13:17:11,118 [trainer.py] => epochs: 20
2024-07-20 13:17:11,118 [trainer.py] => lrate: 0.001
2024-07-20 13:17:11,118 [trainer.py] => milestones: [80, 120]
2024-07-20 13:17:11,118 [trainer.py] => lrate_decay: 0.1
2024-07-20 13:17:11,118 [trainer.py] => batch_size: 48
2024-07-20 13:17:11,118 [trainer.py] => weight_decay: 0.0002
2024-07-20 13:17:11,118 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-07-20 13:17:13,205 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-07-20 13:17:25,554 [trainer.py] => All params: 85798656
2024-07-20 13:17:25,555 [trainer.py] => Trainable params: 85798656
2024-07-20 13:17:25,555 [icarl.py] => Learning on 0-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.891, Train_accy 70.52, Test_accy 95.80:   0%|          | 0/20 [00:51<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.891, Train_accy 70.52, Test_accy 95.80:   5%|▌         | 1/20 [00:51<16:17, 51.44s/it]Task 0, Epoch 2/20 => Loss 0.434, Train_accy 86.30:   5%|▌         | 1/20 [01:42<16:17, 51.44s/it]                 Task 0, Epoch 2/20 => Loss 0.434, Train_accy 86.30:  10%|█         | 2/20 [01:42<15:23, 51.31s/it]Task 0, Epoch 3/20 => Loss 0.340, Train_accy 88.84:  10%|█         | 2/20 [02:34<15:23, 51.31s/it]Task 0, Epoch 3/20 => Loss 0.340, Train_accy 88.84:  15%|█▌        | 3/20 [02:34<14:33, 51.39s/it]Task 0, Epoch 4/20 => Loss 0.307, Train_accy 90.22:  15%|█▌        | 3/20 [03:21<14:33, 51.39s/it]Task 0, Epoch 4/20 => Loss 0.307, Train_accy 90.22:  20%|██        | 4/20 [03:21<13:16, 49.77s/it]Task 0, Epoch 5/20 => Loss 0.258, Train_accy 91.96:  20%|██        | 4/20 [04:11<13:16, 49.77s/it]Task 0, Epoch 5/20 => Loss 0.258, Train_accy 91.96:  25%|██▌       | 5/20 [04:11<12:27, 49.82s/it]Task 0, Epoch 6/20 => Loss 0.258, Train_accy 91.58, Test_accy 98.80:  25%|██▌       | 5/20 [05:07<12:27, 49.82s/it]Task 0, Epoch 6/20 => Loss 0.258, Train_accy 91.58, Test_accy 98.80:  30%|███       | 6/20 [05:07<12:07, 51.99s/it]Task 0, Epoch 7/20 => Loss 0.244, Train_accy 91.82:  30%|███       | 6/20 [05:59<12:07, 51.99s/it]                 Task 0, Epoch 7/20 => Loss 0.244, Train_accy 91.82:  35%|███▌      | 7/20 [05:59<11:13, 51.82s/it]Task 0, Epoch 8/20 => Loss 0.234, Train_accy 92.36:  35%|███▌      | 7/20 [06:48<11:13, 51.82s/it]Task 0, Epoch 8/20 => Loss 0.234, Train_accy 92.36:  40%|████      | 8/20 [06:48<10:11, 50.95s/it]Task 0, Epoch 9/20 => Loss 0.227, Train_accy 92.56:  40%|████      | 8/20 [07:37<10:11, 50.95s/it]Task 0, Epoch 9/20 => Loss 0.227, Train_accy 92.56:  45%|████▌     | 9/20 [07:37<09:13, 50.31s/it]Task 0, Epoch 10/20 => Loss 0.215, Train_accy 93.02:  45%|████▌     | 9/20 [08:30<09:13, 50.31s/it]Task 0, Epoch 10/20 => Loss 0.215, Train_accy 93.02:  50%|█████     | 10/20 [08:30<08:32, 51.23s/it]Task 0, Epoch 11/20 => Loss 0.214, Train_accy 92.90, Test_accy 98.30:  50%|█████     | 10/20 [09:28<08:32, 51.23s/it]Task 0, Epoch 11/20 => Loss 0.214, Train_accy 92.90, Test_accy 98.30:  55%|█████▌    | 11/20 [09:28<07:59, 53.27s/it]Task 0, Epoch 12/20 => Loss 0.212, Train_accy 93.30:  55%|█████▌    | 11/20 [10:19<07:59, 53.27s/it]                 Task 0, Epoch 12/20 => Loss 0.212, Train_accy 93.30:  60%|██████    | 12/20 [10:19<07:01, 52.74s/it]Task 0, Epoch 13/20 => Loss 0.203, Train_accy 93.44:  60%|██████    | 12/20 [11:06<07:01, 52.74s/it]Task 0, Epoch 13/20 => Loss 0.203, Train_accy 93.44:  65%|██████▌   | 13/20 [11:06<05:57, 51.02s/it]Task 0, Epoch 14/20 => Loss 0.188, Train_accy 94.02:  65%|██████▌   | 13/20 [11:58<05:57, 51.02s/it]Task 0, Epoch 14/20 => Loss 0.188, Train_accy 94.02:  70%|███████   | 14/20 [11:58<05:07, 51.32s/it]Task 0, Epoch 15/20 => Loss 0.194, Train_accy 93.76:  70%|███████   | 14/20 [12:50<05:07, 51.32s/it]Task 0, Epoch 15/20 => Loss 0.194, Train_accy 93.76:  75%|███████▌  | 15/20 [12:50<04:17, 51.57s/it]Task 0, Epoch 16/20 => Loss 0.184, Train_accy 94.54, Test_accy 98.40:  75%|███████▌  | 15/20 [13:46<04:17, 51.57s/it]Task 0, Epoch 16/20 => Loss 0.184, Train_accy 94.54, Test_accy 98.40:  80%|████████  | 16/20 [13:46<03:31, 52.80s/it]Task 0, Epoch 17/20 => Loss 0.193, Train_accy 93.64:  80%|████████  | 16/20 [14:36<03:31, 52.80s/it]                 Task 0, Epoch 17/20 => Loss 0.193, Train_accy 93.64:  85%|████████▌ | 17/20 [14:36<02:35, 51.81s/it]Task 0, Epoch 18/20 => Loss 0.183, Train_accy 93.84:  85%|████████▌ | 17/20 [15:25<02:35, 51.81s/it]Task 0, Epoch 18/20 => Loss 0.183, Train_accy 93.84:  90%|█████████ | 18/20 [15:25<01:42, 51.08s/it]Task 0, Epoch 19/20 => Loss 0.210, Train_accy 93.12:  90%|█████████ | 18/20 [16:16<01:42, 51.08s/it]Task 0, Epoch 19/20 => Loss 0.210, Train_accy 93.12:  95%|█████████▌| 19/20 [16:16<00:51, 51.13s/it]Task 0, Epoch 20/20 => Loss 0.194, Train_accy 93.84:  95%|█████████▌| 19/20 [17:07<00:51, 51.13s/it]Task 0, Epoch 20/20 => Loss 0.194, Train_accy 93.84: 100%|██████████| 20/20 [17:07<00:00, 51.08s/it]Task 0, Epoch 20/20 => Loss 0.194, Train_accy 93.84: 100%|██████████| 20/20 [17:07<00:00, 51.38s/it]
2024-07-20 13:34:33,862 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.194, Train_accy 93.84
2024-07-20 13:34:33,863 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 13:35:12,745 [icarl.py] => Exemplar size: 200
2024-07-20 13:35:12,746 [trainer.py] => CNN: {'total': 98.3, '00-09': 98.3, 'old': 0, 'new': 98.3}
2024-07-20 13:35:12,746 [trainer.py] => NME: {'total': 98.7, '00-09': 98.7, 'old': 0, 'new': 98.7}
2024-07-20 13:35:12,746 [trainer.py] => CNN top1 curve: [98.3]
2024-07-20 13:35:12,746 [trainer.py] => CNN top5 curve: [100.0]
2024-07-20 13:35:12,746 [trainer.py] => NME top1 curve: [98.7]
2024-07-20 13:35:12,746 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 98.3
Average Accuracy (NME): 98.7
2024-07-20 13:35:12,746 [trainer.py] => Average Accuracy (CNN): 98.3
2024-07-20 13:35:12,746 [trainer.py] => Average Accuracy (NME): 98.7
2024-07-20 13:35:12,746 [trainer.py] => Train Time: 0
2024-07-20 13:35:12,746 [trainer.py] => Test Time: 8.41 

2024-07-20 13:35:12,747 [trainer.py] => All params: 85806346
2024-07-20 13:35:12,748 [trainer.py] => Trainable params: 85806346
2024-07-20 13:35:12,749 [icarl.py] => Learning on 10-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.429, Train_accy 74.12, Test_accy 91.70:   0%|          | 0/20 [01:14<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.429, Train_accy 74.12, Test_accy 91.70:   5%|▌         | 1/20 [01:14<23:28, 74.16s/it]Task 1, Epoch 2/20 => Loss 1.927, Train_accy 86.31:   5%|▌         | 1/20 [02:26<23:28, 74.16s/it]                 Task 1, Epoch 2/20 => Loss 1.927, Train_accy 86.31:  10%|█         | 2/20 [02:26<21:59, 73.28s/it]Task 1, Epoch 3/20 => Loss 1.839, Train_accy 89.54:  10%|█         | 2/20 [03:39<21:59, 73.28s/it]Task 1, Epoch 3/20 => Loss 1.839, Train_accy 89.54:  15%|█▌        | 3/20 [03:39<20:44, 73.20s/it]Task 1, Epoch 4/20 => Loss 1.809, Train_accy 90.23:  15%|█▌        | 3/20 [04:47<20:44, 73.20s/it]Task 1, Epoch 4/20 => Loss 1.809, Train_accy 90.23:  20%|██        | 4/20 [04:47<18:57, 71.09s/it]Task 1, Epoch 5/20 => Loss 1.804, Train_accy 90.17:  20%|██        | 4/20 [06:02<18:57, 71.09s/it]Task 1, Epoch 5/20 => Loss 1.804, Train_accy 90.17:  25%|██▌       | 5/20 [06:02<18:06, 72.41s/it]Task 1, Epoch 6/20 => Loss 1.796, Train_accy 90.46, Test_accy 92.40:  25%|██▌       | 5/20 [07:26<18:06, 72.41s/it]Task 1, Epoch 6/20 => Loss 1.796, Train_accy 90.46, Test_accy 92.40:  30%|███       | 6/20 [07:26<17:47, 76.24s/it]Task 1, Epoch 7/20 => Loss 1.766, Train_accy 91.04:  30%|███       | 6/20 [08:33<17:47, 76.24s/it]                 Task 1, Epoch 7/20 => Loss 1.766, Train_accy 91.04:  35%|███▌      | 7/20 [08:33<15:53, 73.34s/it]Task 1, Epoch 8/20 => Loss 1.767, Train_accy 91.48:  35%|███▌      | 7/20 [09:47<15:53, 73.34s/it]Task 1, Epoch 8/20 => Loss 1.767, Train_accy 91.48:  40%|████      | 8/20 [09:47<14:41, 73.49s/it]Task 1, Epoch 9/20 => Loss 1.765, Train_accy 91.46:  40%|████      | 8/20 [11:00<14:41, 73.49s/it]Task 1, Epoch 9/20 => Loss 1.765, Train_accy 91.46:  45%|████▌     | 9/20 [11:00<13:28, 73.51s/it]Task 1, Epoch 10/20 => Loss 1.748, Train_accy 92.02:  45%|████▌     | 9/20 [12:08<13:28, 73.51s/it]Task 1, Epoch 10/20 => Loss 1.748, Train_accy 92.02:  50%|█████     | 10/20 [12:08<11:57, 71.71s/it]Task 1, Epoch 11/20 => Loss 1.737, Train_accy 92.44, Test_accy 91.85:  50%|█████     | 10/20 [13:29<11:57, 71.71s/it]Task 1, Epoch 11/20 => Loss 1.737, Train_accy 92.44, Test_accy 91.85:  55%|█████▌    | 11/20 [13:29<11:10, 74.55s/it]Task 1, Epoch 12/20 => Loss 1.749, Train_accy 92.12:  55%|█████▌    | 11/20 [14:42<11:10, 74.55s/it]                 Task 1, Epoch 12/20 => Loss 1.749, Train_accy 92.12:  60%|██████    | 12/20 [14:42<09:51, 73.94s/it]Task 1, Epoch 13/20 => Loss 1.732, Train_accy 92.63:  60%|██████    | 12/20 [15:49<09:51, 73.94s/it]Task 1, Epoch 13/20 => Loss 1.732, Train_accy 92.63:  65%|██████▌   | 13/20 [15:49<08:24, 72.02s/it]Task 1, Epoch 14/20 => Loss 1.727, Train_accy 93.02:  65%|██████▌   | 13/20 [17:01<08:24, 72.02s/it]Task 1, Epoch 14/20 => Loss 1.727, Train_accy 93.02:  70%|███████   | 14/20 [17:01<07:11, 71.85s/it]Task 1, Epoch 15/20 => Loss 1.714, Train_accy 92.85:  70%|███████   | 14/20 [18:13<07:11, 71.85s/it]Task 1, Epoch 15/20 => Loss 1.714, Train_accy 92.85:  75%|███████▌  | 15/20 [18:13<05:59, 71.92s/it]Task 1, Epoch 16/20 => Loss 1.699, Train_accy 93.52, Test_accy 92.95:  75%|███████▌  | 15/20 [19:29<05:59, 71.92s/it]Task 1, Epoch 16/20 => Loss 1.699, Train_accy 93.52, Test_accy 92.95:  80%|████████  | 16/20 [19:29<04:52, 73.20s/it]Task 1, Epoch 17/20 => Loss 1.719, Train_accy 92.81:  80%|████████  | 16/20 [20:39<04:52, 73.20s/it]                 Task 1, Epoch 17/20 => Loss 1.719, Train_accy 92.81:  85%|████████▌ | 17/20 [20:39<03:37, 72.35s/it]Task 1, Epoch 18/20 => Loss 1.709, Train_accy 93.19:  85%|████████▌ | 17/20 [21:51<03:37, 72.35s/it]Task 1, Epoch 18/20 => Loss 1.709, Train_accy 93.19:  90%|█████████ | 18/20 [21:51<02:24, 72.28s/it]Task 1, Epoch 19/20 => Loss 1.719, Train_accy 92.71:  90%|█████████ | 18/20 [23:02<02:24, 72.28s/it]Task 1, Epoch 19/20 => Loss 1.719, Train_accy 92.71:  95%|█████████▌| 19/20 [23:02<01:11, 71.84s/it]Task 1, Epoch 20/20 => Loss 1.692, Train_accy 93.73:  95%|█████████▌| 19/20 [24:12<01:11, 71.84s/it]Task 1, Epoch 20/20 => Loss 1.692, Train_accy 93.73: 100%|██████████| 20/20 [24:12<00:00, 71.09s/it]Task 1, Epoch 20/20 => Loss 1.692, Train_accy 93.73: 100%|██████████| 20/20 [24:12<00:00, 72.61s/it]
2024-07-20 13:59:24,950 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.692, Train_accy 93.73
2024-07-20 13:59:24,951 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 14:00:14,615 [icarl.py] => Exemplar size: 400
2024-07-20 14:00:14,616 [trainer.py] => CNN: {'total': 93.05, '00-09': 88.9, '10-19': 97.2, 'old': 88.9, 'new': 97.2}
2024-07-20 14:00:14,616 [trainer.py] => NME: {'total': 95.7, '00-09': 95.9, '10-19': 95.5, 'old': 95.9, 'new': 95.5}
2024-07-20 14:00:14,616 [trainer.py] => CNN top1 curve: [98.3, 93.05]
2024-07-20 14:00:14,616 [trainer.py] => CNN top5 curve: [100.0, 99.4]
2024-07-20 14:00:14,616 [trainer.py] => NME top1 curve: [98.7, 95.7]
2024-07-20 14:00:14,616 [trainer.py] => NME top5 curve: [100.0, 99.9]

Average Accuracy (CNN): 95.68
Average Accuracy (NME): 97.2
2024-07-20 14:00:14,617 [trainer.py] => Average Accuracy (CNN): 95.68
2024-07-20 14:00:14,617 [trainer.py] => Average Accuracy (NME): 97.2
2024-07-20 14:00:14,617 [trainer.py] => Train Time: 0
2024-07-20 14:00:14,617 [trainer.py] => Test Time: 25.15 

2024-07-20 14:00:14,619 [trainer.py] => All params: 85814036
2024-07-20 14:00:14,620 [trainer.py] => Trainable params: 85814036
2024-07-20 14:00:14,622 [icarl.py] => Learning on 20-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.547, Train_accy 77.59, Test_accy 85.30:   0%|          | 0/20 [01:26<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.547, Train_accy 77.59, Test_accy 85.30:   5%|▌         | 1/20 [01:26<27:22, 86.42s/it]Task 2, Epoch 2/20 => Loss 1.764, Train_accy 91.81:   5%|▌         | 1/20 [02:36<27:22, 86.42s/it]                 Task 2, Epoch 2/20 => Loss 1.764, Train_accy 91.81:  10%|█         | 2/20 [02:36<23:06, 77.01s/it]Task 2, Epoch 3/20 => Loss 1.718, Train_accy 93.00:  10%|█         | 2/20 [03:53<23:06, 77.01s/it]Task 2, Epoch 3/20 => Loss 1.718, Train_accy 93.00:  15%|█▌        | 3/20 [03:53<21:44, 76.73s/it]Task 2, Epoch 4/20 => Loss 1.714, Train_accy 93.17:  15%|█▌        | 3/20 [05:09<21:44, 76.73s/it]Task 2, Epoch 4/20 => Loss 1.714, Train_accy 93.17:  20%|██        | 4/20 [05:09<20:26, 76.63s/it]Task 2, Epoch 5/20 => Loss 1.707, Train_accy 93.63:  20%|██        | 4/20 [06:19<20:26, 76.63s/it]Task 2, Epoch 5/20 => Loss 1.707, Train_accy 93.63:  25%|██▌       | 5/20 [06:19<18:34, 74.27s/it]Task 2, Epoch 6/20 => Loss 1.675, Train_accy 94.24, Test_accy 89.70:  25%|██▌       | 5/20 [07:47<18:34, 74.27s/it]Task 2, Epoch 6/20 => Loss 1.675, Train_accy 94.24, Test_accy 89.70:  30%|███       | 6/20 [07:47<18:23, 78.84s/it]Task 2, Epoch 7/20 => Loss 1.675, Train_accy 94.19:  30%|███       | 6/20 [09:01<18:23, 78.84s/it]                 Task 2, Epoch 7/20 => Loss 1.675, Train_accy 94.19:  35%|███▌      | 7/20 [09:01<16:43, 77.19s/it]Task 2, Epoch 8/20 => Loss 1.694, Train_accy 93.46:  35%|███▌      | 7/20 [10:10<16:43, 77.19s/it]Task 2, Epoch 8/20 => Loss 1.694, Train_accy 93.46:  40%|████      | 8/20 [10:10<14:57, 74.80s/it]Task 2, Epoch 9/20 => Loss 1.666, Train_accy 94.59:  40%|████      | 8/20 [11:28<14:57, 74.80s/it]Task 2, Epoch 9/20 => Loss 1.666, Train_accy 94.59:  45%|████▌     | 9/20 [11:28<13:50, 75.52s/it]Task 2, Epoch 10/20 => Loss 1.660, Train_accy 94.39:  45%|████▌     | 9/20 [12:44<13:50, 75.52s/it]Task 2, Epoch 10/20 => Loss 1.660, Train_accy 94.39:  50%|█████     | 10/20 [12:44<12:37, 75.74s/it]Task 2, Epoch 11/20 => Loss 1.669, Train_accy 94.52, Test_accy 88.83:  50%|█████     | 10/20 [14:11<12:37, 75.74s/it]Task 2, Epoch 11/20 => Loss 1.669, Train_accy 94.52, Test_accy 88.83:  55%|█████▌    | 11/20 [14:11<11:52, 79.16s/it]Task 2, Epoch 12/20 => Loss 1.651, Train_accy 94.61:  55%|█████▌    | 11/20 [15:28<11:52, 79.16s/it]                 Task 2, Epoch 12/20 => Loss 1.651, Train_accy 94.61:  60%|██████    | 12/20 [15:28<10:28, 78.54s/it]Task 2, Epoch 13/20 => Loss 1.662, Train_accy 94.89:  60%|██████    | 12/20 [16:42<10:28, 78.54s/it]Task 2, Epoch 13/20 => Loss 1.662, Train_accy 94.89:  65%|██████▌   | 13/20 [16:42<09:01, 77.33s/it]Task 2, Epoch 14/20 => Loss 1.679, Train_accy 94.65:  65%|██████▌   | 13/20 [17:55<09:01, 77.33s/it]Task 2, Epoch 14/20 => Loss 1.679, Train_accy 94.65:  70%|███████   | 14/20 [17:55<07:35, 75.84s/it]Task 2, Epoch 15/20 => Loss 1.668, Train_accy 94.83:  70%|███████   | 14/20 [19:12<07:35, 75.84s/it]Task 2, Epoch 15/20 => Loss 1.668, Train_accy 94.83:  75%|███████▌  | 15/20 [19:12<06:21, 76.27s/it]Task 2, Epoch 16/20 => Loss 1.643, Train_accy 95.00, Test_accy 89.67:  75%|███████▌  | 15/20 [20:39<06:21, 76.27s/it]Task 2, Epoch 16/20 => Loss 1.643, Train_accy 95.00, Test_accy 89.67:  80%|████████  | 16/20 [20:39<05:17, 79.46s/it]Task 2, Epoch 17/20 => Loss 1.647, Train_accy 95.15:  80%|████████  | 16/20 [21:51<05:17, 79.46s/it]                 Task 2, Epoch 17/20 => Loss 1.647, Train_accy 95.15:  85%|████████▌ | 17/20 [21:51<03:51, 77.14s/it]Task 2, Epoch 18/20 => Loss 1.652, Train_accy 94.80:  85%|████████▌ | 17/20 [23:07<03:51, 77.14s/it]Task 2, Epoch 18/20 => Loss 1.652, Train_accy 94.80:  90%|█████████ | 18/20 [23:07<02:33, 76.90s/it]Task 2, Epoch 19/20 => Loss 1.600, Train_accy 96.04:  90%|█████████ | 18/20 [24:20<02:33, 76.90s/it]Task 2, Epoch 19/20 => Loss 1.600, Train_accy 96.04:  95%|█████████▌| 19/20 [24:20<01:15, 75.57s/it]Task 2, Epoch 20/20 => Loss 1.650, Train_accy 95.22:  95%|█████████▌| 19/20 [25:33<01:15, 75.57s/it]Task 2, Epoch 20/20 => Loss 1.650, Train_accy 95.22: 100%|██████████| 20/20 [25:33<00:00, 74.80s/it]Task 2, Epoch 20/20 => Loss 1.650, Train_accy 95.22: 100%|██████████| 20/20 [25:33<00:00, 76.65s/it]
2024-07-20 14:25:47,721 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.650, Train_accy 95.22
2024-07-20 14:25:47,722 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 14:26:50,287 [icarl.py] => Exemplar size: 600
2024-07-20 14:26:50,287 [trainer.py] => CNN: {'total': 89.67, '00-09': 84.4, '10-19': 86.0, '20-29': 98.6, 'old': 85.2, 'new': 98.6}
2024-07-20 14:26:50,287 [trainer.py] => NME: {'total': 93.6, '00-09': 92.5, '10-19': 90.7, '20-29': 97.6, 'old': 91.6, 'new': 97.6}
2024-07-20 14:26:50,288 [trainer.py] => CNN top1 curve: [98.3, 93.05, 89.67]
2024-07-20 14:26:50,288 [trainer.py] => CNN top5 curve: [100.0, 99.4, 98.3]
2024-07-20 14:26:50,288 [trainer.py] => NME top1 curve: [98.7, 95.7, 93.6]
2024-07-20 14:26:50,288 [trainer.py] => NME top5 curve: [100.0, 99.9, 99.33]

Average Accuracy (CNN): 93.67
Average Accuracy (NME): 96.0
2024-07-20 14:26:50,288 [trainer.py] => Average Accuracy (CNN): 93.67
2024-07-20 14:26:50,288 [trainer.py] => Average Accuracy (NME): 96.0
2024-07-20 14:26:50,288 [trainer.py] => Train Time: 0
2024-07-20 14:26:50,288 [trainer.py] => Test Time: 50.01 

2024-07-20 14:26:50,289 [trainer.py] => All params: 85821726
2024-07-20 14:26:50,289 [trainer.py] => Trainable params: 85821726
2024-07-20 14:26:50,290 [icarl.py] => Learning on 30-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.905, Train_accy 74.88, Test_accy 85.00:   0%|          | 0/20 [01:31<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.905, Train_accy 74.88, Test_accy 85.00:   5%|▌         | 1/20 [01:31<29:06, 91.92s/it]Task 3, Epoch 2/20 => Loss 2.045, Train_accy 89.54:   5%|▌         | 1/20 [02:49<29:06, 91.92s/it]                 Task 3, Epoch 2/20 => Loss 2.045, Train_accy 89.54:  10%|█         | 2/20 [02:49<24:59, 83.31s/it]Task 3, Epoch 3/20 => Loss 2.024, Train_accy 89.73:  10%|█         | 2/20 [04:11<24:59, 83.31s/it]Task 3, Epoch 3/20 => Loss 2.024, Train_accy 89.73:  15%|█▌        | 3/20 [04:11<23:25, 82.67s/it]Task 3, Epoch 4/20 => Loss 1.974, Train_accy 91.18:  15%|█▌        | 3/20 [05:26<23:25, 82.67s/it]Task 3, Epoch 4/20 => Loss 1.974, Train_accy 91.18:  20%|██        | 4/20 [05:26<21:13, 79.61s/it]Task 3, Epoch 5/20 => Loss 1.945, Train_accy 91.86:  20%|██        | 4/20 [06:45<21:13, 79.61s/it]Task 3, Epoch 5/20 => Loss 1.945, Train_accy 91.86:  25%|██▌       | 5/20 [06:45<19:53, 79.57s/it]Task 3, Epoch 6/20 => Loss 1.930, Train_accy 92.41, Test_accy 84.90:  25%|██▌       | 5/20 [08:22<19:53, 79.57s/it]Task 3, Epoch 6/20 => Loss 1.930, Train_accy 92.41, Test_accy 84.90:  30%|███       | 6/20 [08:22<19:54, 85.32s/it]Task 3, Epoch 7/20 => Loss 1.947, Train_accy 91.98:  30%|███       | 6/20 [09:35<19:54, 85.32s/it]                 Task 3, Epoch 7/20 => Loss 1.947, Train_accy 91.98:  35%|███▌      | 7/20 [09:35<17:37, 81.38s/it]Task 3, Epoch 8/20 => Loss 1.933, Train_accy 92.59:  35%|███▌      | 7/20 [10:54<17:37, 81.38s/it]Task 3, Epoch 8/20 => Loss 1.933, Train_accy 92.59:  40%|████      | 8/20 [10:54<16:08, 80.75s/it]Task 3, Epoch 9/20 => Loss 1.918, Train_accy 92.93:  40%|████      | 8/20 [12:14<16:08, 80.75s/it]Task 3, Epoch 9/20 => Loss 1.918, Train_accy 92.93:  45%|████▌     | 9/20 [12:14<14:46, 80.60s/it]Task 3, Epoch 10/20 => Loss 1.908, Train_accy 93.27:  45%|████▌     | 9/20 [13:27<14:46, 80.60s/it]Task 3, Epoch 10/20 => Loss 1.908, Train_accy 93.27:  50%|█████     | 10/20 [13:27<13:02, 78.25s/it]Task 3, Epoch 11/20 => Loss 1.915, Train_accy 93.41, Test_accy 85.05:  50%|█████     | 10/20 [15:03<13:02, 78.25s/it]Task 3, Epoch 11/20 => Loss 1.915, Train_accy 93.41, Test_accy 85.05:  55%|█████▌    | 11/20 [15:03<12:32, 83.63s/it]Task 3, Epoch 12/20 => Loss 1.908, Train_accy 94.07:  55%|█████▌    | 11/20 [16:19<12:32, 83.63s/it]                 Task 3, Epoch 12/20 => Loss 1.908, Train_accy 94.07:  60%|██████    | 12/20 [16:19<10:48, 81.12s/it]Task 3, Epoch 13/20 => Loss 1.868, Train_accy 94.05:  60%|██████    | 12/20 [17:33<10:48, 81.12s/it]Task 3, Epoch 13/20 => Loss 1.868, Train_accy 94.05:  65%|██████▌   | 13/20 [17:33<09:13, 79.10s/it]Task 3, Epoch 14/20 => Loss 1.862, Train_accy 94.14:  65%|██████▌   | 13/20 [18:52<09:13, 79.10s/it]Task 3, Epoch 14/20 => Loss 1.862, Train_accy 94.14:  70%|███████   | 14/20 [18:52<07:53, 78.92s/it]Task 3, Epoch 15/20 => Loss 1.900, Train_accy 93.73:  70%|███████   | 14/20 [20:08<07:53, 78.92s/it]Task 3, Epoch 15/20 => Loss 1.900, Train_accy 93.73:  75%|███████▌  | 15/20 [20:08<06:31, 78.29s/it]Task 3, Epoch 16/20 => Loss 1.900, Train_accy 93.73, Test_accy 85.45:  75%|███████▌  | 15/20 [21:42<06:31, 78.29s/it]Task 3, Epoch 16/20 => Loss 1.900, Train_accy 93.73, Test_accy 85.45:  80%|████████  | 16/20 [21:42<05:31, 82.96s/it]Task 3, Epoch 17/20 => Loss 1.847, Train_accy 94.36:  80%|████████  | 16/20 [23:04<05:31, 82.96s/it]                 Task 3, Epoch 17/20 => Loss 1.847, Train_accy 94.36:  85%|████████▌ | 17/20 [23:04<04:07, 82.66s/it]Task 3, Epoch 18/20 => Loss 1.882, Train_accy 94.23:  85%|████████▌ | 17/20 [24:18<04:07, 82.66s/it]Task 3, Epoch 18/20 => Loss 1.882, Train_accy 94.23:  90%|█████████ | 18/20 [24:18<02:39, 79.90s/it]Task 3, Epoch 19/20 => Loss 1.909, Train_accy 93.73:  90%|█████████ | 18/20 [25:36<02:39, 79.90s/it]Task 3, Epoch 19/20 => Loss 1.909, Train_accy 93.73:  95%|█████████▌| 19/20 [25:36<01:19, 79.51s/it]Task 3, Epoch 20/20 => Loss 1.865, Train_accy 94.77:  95%|█████████▌| 19/20 [26:56<01:19, 79.51s/it]Task 3, Epoch 20/20 => Loss 1.865, Train_accy 94.77: 100%|██████████| 20/20 [26:56<00:00, 79.52s/it]Task 3, Epoch 20/20 => Loss 1.865, Train_accy 94.77: 100%|██████████| 20/20 [26:56<00:00, 80.82s/it]
2024-07-20 14:53:46,811 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.865, Train_accy 94.77
2024-07-20 14:53:46,813 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 14:54:54,007 [icarl.py] => Exemplar size: 800
2024-07-20 14:54:54,008 [trainer.py] => CNN: {'total': 86.28, '00-09': 78.4, '10-19': 79.4, '20-29': 90.8, '30-39': 96.5, 'old': 82.87, 'new': 96.5}
2024-07-20 14:54:54,008 [trainer.py] => NME: {'total': 91.88, '00-09': 90.5, '10-19': 87.9, '20-29': 95.2, '30-39': 93.9, 'old': 91.2, 'new': 93.9}
2024-07-20 14:54:54,008 [trainer.py] => CNN top1 curve: [98.3, 93.05, 89.67, 86.28]
2024-07-20 14:54:54,008 [trainer.py] => CNN top5 curve: [100.0, 99.4, 98.3, 97.5]
2024-07-20 14:54:54,008 [trainer.py] => NME top1 curve: [98.7, 95.7, 93.6, 91.88]
2024-07-20 14:54:54,008 [trainer.py] => NME top5 curve: [100.0, 99.9, 99.33, 99.15]

Average Accuracy (CNN): 91.82
Average Accuracy (NME): 94.97
2024-07-20 14:54:54,008 [trainer.py] => Average Accuracy (CNN): 91.82
2024-07-20 14:54:54,008 [trainer.py] => Average Accuracy (NME): 94.97
2024-07-20 14:54:54,008 [trainer.py] => Train Time: 0
2024-07-20 14:54:54,008 [trainer.py] => Test Time: 80.5 

2024-07-20 14:54:54,009 [trainer.py] => All params: 85829416
2024-07-20 14:54:54,010 [trainer.py] => Trainable params: 85829416
2024-07-20 14:54:54,012 [icarl.py] => Learning on 40-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.838, Train_accy 79.31, Test_accy 79.42:   0%|          | 0/20 [01:41<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.838, Train_accy 79.31, Test_accy 79.42:   5%|▌         | 1/20 [01:41<32:15, 101.88s/it]Task 4, Epoch 2/20 => Loss 2.048, Train_accy 91.43:   5%|▌         | 1/20 [03:01<32:15, 101.88s/it]                 Task 4, Epoch 2/20 => Loss 2.048, Train_accy 91.43:  10%|█         | 2/20 [03:01<26:39, 88.87s/it] Task 4, Epoch 3/20 => Loss 2.028, Train_accy 91.29:  10%|█         | 2/20 [04:19<26:39, 88.87s/it]Task 4, Epoch 3/20 => Loss 2.028, Train_accy 91.29:  15%|█▌        | 3/20 [04:19<23:47, 83.98s/it]Task 4, Epoch 4/20 => Loss 1.949, Train_accy 93.17:  15%|█▌        | 3/20 [05:41<23:47, 83.98s/it]Task 4, Epoch 4/20 => Loss 1.949, Train_accy 93.17:  20%|██        | 4/20 [05:41<22:06, 82.93s/it]Task 4, Epoch 5/20 => Loss 1.980, Train_accy 92.79:  20%|██        | 4/20 [06:58<22:06, 82.93s/it]Task 4, Epoch 5/20 => Loss 1.980, Train_accy 92.79:  25%|██▌       | 5/20 [06:58<20:14, 80.94s/it]Task 4, Epoch 6/20 => Loss 1.961, Train_accy 93.21, Test_accy 81.94:  25%|██▌       | 5/20 [08:37<20:14, 80.94s/it]Task 4, Epoch 6/20 => Loss 1.961, Train_accy 93.21, Test_accy 81.94:  30%|███       | 6/20 [08:37<20:19, 87.12s/it]Task 4, Epoch 7/20 => Loss 1.947, Train_accy 93.91:  30%|███       | 6/20 [09:59<20:19, 87.12s/it]                 Task 4, Epoch 7/20 => Loss 1.947, Train_accy 93.91:  35%|███▌      | 7/20 [09:59<18:29, 85.33s/it]Task 4, Epoch 8/20 => Loss 1.919, Train_accy 94.07:  35%|███▌      | 7/20 [11:13<18:29, 85.33s/it]Task 4, Epoch 8/20 => Loss 1.919, Train_accy 94.07:  40%|████      | 8/20 [11:13<16:22, 81.87s/it]Task 4, Epoch 9/20 => Loss 1.940, Train_accy 93.86:  40%|████      | 8/20 [12:36<16:22, 81.87s/it]Task 4, Epoch 9/20 => Loss 1.940, Train_accy 93.86:  45%|████▌     | 9/20 [12:36<15:03, 82.10s/it]Task 4, Epoch 10/20 => Loss 1.946, Train_accy 94.24:  45%|████▌     | 9/20 [13:57<15:03, 82.10s/it]Task 4, Epoch 10/20 => Loss 1.946, Train_accy 94.24:  50%|█████     | 10/20 [13:57<13:36, 81.65s/it]Task 4, Epoch 11/20 => Loss 1.925, Train_accy 93.98, Test_accy 80.42:  50%|█████     | 10/20 [15:32<13:36, 81.65s/it]Task 4, Epoch 11/20 => Loss 1.925, Train_accy 93.98, Test_accy 80.42:  55%|█████▌    | 11/20 [15:32<12:54, 86.02s/it]Task 4, Epoch 12/20 => Loss 1.954, Train_accy 94.00:  55%|█████▌    | 11/20 [16:55<12:54, 86.02s/it]                 Task 4, Epoch 12/20 => Loss 1.954, Train_accy 94.00:  60%|██████    | 12/20 [16:55<11:18, 84.82s/it]Task 4, Epoch 13/20 => Loss 1.916, Train_accy 94.67:  60%|██████    | 12/20 [18:11<11:18, 84.82s/it]Task 4, Epoch 13/20 => Loss 1.916, Train_accy 94.67:  65%|██████▌   | 13/20 [18:11<09:36, 82.40s/it]Task 4, Epoch 14/20 => Loss 1.950, Train_accy 94.02:  65%|██████▌   | 13/20 [19:28<09:36, 82.40s/it]Task 4, Epoch 14/20 => Loss 1.950, Train_accy 94.02:  70%|███████   | 14/20 [19:28<08:03, 80.56s/it]Task 4, Epoch 15/20 => Loss 1.894, Train_accy 94.71:  70%|███████   | 14/20 [20:47<08:03, 80.56s/it]Task 4, Epoch 15/20 => Loss 1.894, Train_accy 94.71:  75%|███████▌  | 15/20 [20:47<06:40, 80.05s/it]Task 4, Epoch 16/20 => Loss 1.881, Train_accy 95.09, Test_accy 80.84:  75%|███████▌  | 15/20 [22:19<06:40, 80.05s/it]Task 4, Epoch 16/20 => Loss 1.881, Train_accy 95.09, Test_accy 80.84:  80%|████████  | 16/20 [22:19<05:35, 83.82s/it]Task 4, Epoch 17/20 => Loss 1.875, Train_accy 94.98:  80%|████████  | 16/20 [23:39<05:35, 83.82s/it]                 Task 4, Epoch 17/20 => Loss 1.875, Train_accy 94.98:  85%|████████▌ | 17/20 [23:39<04:08, 82.73s/it]Task 4, Epoch 18/20 => Loss 1.909, Train_accy 94.64:  85%|████████▌ | 17/20 [25:01<04:08, 82.73s/it]Task 4, Epoch 18/20 => Loss 1.909, Train_accy 94.64:  90%|█████████ | 18/20 [25:01<02:44, 82.37s/it]Task 4, Epoch 19/20 => Loss 1.876, Train_accy 94.98:  90%|█████████ | 18/20 [26:15<02:44, 82.37s/it]Task 4, Epoch 19/20 => Loss 1.876, Train_accy 94.98:  95%|█████████▌| 19/20 [26:15<01:19, 79.98s/it]Task 4, Epoch 20/20 => Loss 1.893, Train_accy 95.16:  95%|█████████▌| 19/20 [27:37<01:19, 79.98s/it]Task 4, Epoch 20/20 => Loss 1.893, Train_accy 95.16: 100%|██████████| 20/20 [27:37<00:00, 80.63s/it]Task 4, Epoch 20/20 => Loss 1.893, Train_accy 95.16: 100%|██████████| 20/20 [27:37<00:00, 82.89s/it]
2024-07-20 15:22:32,006 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.893, Train_accy 95.16
2024-07-20 15:22:32,007 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 15:23:56,453 [icarl.py] => Exemplar size: 1000
2024-07-20 15:23:56,453 [trainer.py] => CNN: {'total': 79.32, '00-09': 70.8, '10-19': 63.4, '20-29': 79.3, '30-39': 84.8, '40-49': 98.3, 'old': 74.58, 'new': 98.3}
2024-07-20 15:23:56,453 [trainer.py] => NME: {'total': 89.22, '00-09': 88.2, '10-19': 82.7, '20-29': 92.7, '30-39': 88.0, '40-49': 94.5, 'old': 87.9, 'new': 94.5}
2024-07-20 15:23:56,453 [trainer.py] => CNN top1 curve: [98.3, 93.05, 89.67, 86.28, 79.32]
2024-07-20 15:23:56,454 [trainer.py] => CNN top5 curve: [100.0, 99.4, 98.3, 97.5, 95.96]
2024-07-20 15:23:56,454 [trainer.py] => NME top1 curve: [98.7, 95.7, 93.6, 91.88, 89.22]
2024-07-20 15:23:56,454 [trainer.py] => NME top5 curve: [100.0, 99.9, 99.33, 99.15, 99.02]

Average Accuracy (CNN): 89.32
Average Accuracy (NME): 93.82
2024-07-20 15:23:56,454 [trainer.py] => Average Accuracy (CNN): 89.32
2024-07-20 15:23:56,454 [trainer.py] => Average Accuracy (NME): 93.82
2024-07-20 15:23:56,454 [trainer.py] => Train Time: 0
2024-07-20 15:23:56,454 [trainer.py] => Test Time: 118.89 

2024-07-20 15:23:56,455 [trainer.py] => All params: 85837106
2024-07-20 15:23:56,456 [trainer.py] => Trainable params: 85837106
2024-07-20 15:23:56,457 [icarl.py] => Learning on 50-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 3.093, Train_accy 76.25, Test_accy 76.63:   0%|          | 0/20 [01:44<?, ?it/s]Task 5, Epoch 1/20 => Loss 3.093, Train_accy 76.25, Test_accy 76.63:   5%|▌         | 1/20 [01:44<33:10, 104.74s/it]Task 5, Epoch 2/20 => Loss 2.326, Train_accy 88.50:   5%|▌         | 1/20 [03:09<33:10, 104.74s/it]                 Task 5, Epoch 2/20 => Loss 2.326, Train_accy 88.50:  10%|█         | 2/20 [03:09<27:48, 92.69s/it] Task 5, Epoch 3/20 => Loss 2.261, Train_accy 90.15:  10%|█         | 2/20 [04:24<27:48, 92.69s/it]Task 5, Epoch 3/20 => Loss 2.261, Train_accy 90.15:  15%|█▌        | 3/20 [04:24<24:06, 85.07s/it]Task 5, Epoch 4/20 => Loss 2.217, Train_accy 90.95:  15%|█▌        | 3/20 [05:47<24:06, 85.07s/it]Task 5, Epoch 4/20 => Loss 2.217, Train_accy 90.95:  20%|██        | 4/20 [05:47<22:23, 83.95s/it]Task 5, Epoch 5/20 => Loss 2.166, Train_accy 91.75:  20%|██        | 4/20 [07:10<22:23, 83.95s/it]Task 5, Epoch 5/20 => Loss 2.166, Train_accy 91.75:  25%|██▌       | 5/20 [07:10<20:55, 83.67s/it]Task 5, Epoch 6/20 => Loss 2.168, Train_accy 92.38, Test_accy 78.53:  25%|██▌       | 5/20 [08:50<20:55, 83.67s/it]Task 5, Epoch 6/20 => Loss 2.168, Train_accy 92.38, Test_accy 78.53:  30%|███       | 6/20 [08:50<20:51, 89.38s/it]Task 5, Epoch 7/20 => Loss 2.166, Train_accy 92.28:  30%|███       | 6/20 [10:14<20:51, 89.38s/it]                 Task 5, Epoch 7/20 => Loss 2.166, Train_accy 92.28:  35%|███▌      | 7/20 [10:14<18:59, 87.65s/it]Task 5, Epoch 8/20 => Loss 2.162, Train_accy 92.88:  35%|███▌      | 7/20 [11:33<18:59, 87.65s/it]Task 5, Epoch 8/20 => Loss 2.162, Train_accy 92.88:  40%|████      | 8/20 [11:33<16:56, 84.72s/it]Task 5, Epoch 9/20 => Loss 2.151, Train_accy 92.48:  40%|████      | 8/20 [12:56<16:56, 84.72s/it]Task 5, Epoch 9/20 => Loss 2.151, Train_accy 92.48:  45%|████▌     | 9/20 [12:56<15:27, 84.32s/it]Task 5, Epoch 10/20 => Loss 2.164, Train_accy 92.53:  45%|████▌     | 9/20 [14:20<15:27, 84.32s/it]Task 5, Epoch 10/20 => Loss 2.164, Train_accy 92.53:  50%|█████     | 10/20 [14:20<14:02, 84.22s/it]Task 5, Epoch 11/20 => Loss 2.125, Train_accy 93.23, Test_accy 79.32:  50%|█████     | 10/20 [16:02<14:02, 84.22s/it]Task 5, Epoch 11/20 => Loss 2.125, Train_accy 93.23, Test_accy 79.32:  55%|█████▌    | 11/20 [16:02<13:25, 89.52s/it]Task 5, Epoch 12/20 => Loss 2.114, Train_accy 93.60:  55%|█████▌    | 11/20 [17:26<13:25, 89.52s/it]                 Task 5, Epoch 12/20 => Loss 2.114, Train_accy 93.60:  60%|██████    | 12/20 [17:26<11:43, 88.00s/it]Task 5, Epoch 13/20 => Loss 2.118, Train_accy 93.45:  60%|██████    | 12/20 [18:47<11:43, 88.00s/it]Task 5, Epoch 13/20 => Loss 2.118, Train_accy 93.45:  65%|██████▌   | 13/20 [18:47<10:00, 85.85s/it]Task 5, Epoch 14/20 => Loss 2.123, Train_accy 93.47:  65%|██████▌   | 13/20 [20:09<10:00, 85.85s/it]Task 5, Epoch 14/20 => Loss 2.123, Train_accy 93.47:  70%|███████   | 14/20 [20:09<08:28, 84.67s/it]Task 5, Epoch 15/20 => Loss 2.111, Train_accy 93.83:  70%|███████   | 14/20 [21:33<08:28, 84.67s/it]Task 5, Epoch 15/20 => Loss 2.111, Train_accy 93.83:  75%|███████▌  | 15/20 [21:33<07:02, 84.47s/it]Task 5, Epoch 16/20 => Loss 2.130, Train_accy 93.52, Test_accy 77.68:  75%|███████▌  | 15/20 [23:16<07:02, 84.47s/it]Task 5, Epoch 16/20 => Loss 2.130, Train_accy 93.52, Test_accy 77.68:  80%|████████  | 16/20 [23:16<05:59, 89.87s/it]Task 5, Epoch 17/20 => Loss 2.099, Train_accy 94.15:  80%|████████  | 16/20 [24:40<05:59, 89.87s/it]                 Task 5, Epoch 17/20 => Loss 2.099, Train_accy 94.15:  85%|████████▌ | 17/20 [24:40<04:24, 88.07s/it]Task 5, Epoch 18/20 => Loss 2.108, Train_accy 93.75:  85%|████████▌ | 17/20 [26:01<04:24, 88.07s/it]Task 5, Epoch 18/20 => Loss 2.108, Train_accy 93.75:  90%|█████████ | 18/20 [26:01<02:52, 86.15s/it]Task 5, Epoch 19/20 => Loss 2.078, Train_accy 94.20:  90%|█████████ | 18/20 [27:15<02:52, 86.15s/it]Task 5, Epoch 19/20 => Loss 2.078, Train_accy 94.20:  95%|█████████▌| 19/20 [27:15<01:22, 82.51s/it]Task 5, Epoch 20/20 => Loss 2.081, Train_accy 94.45:  95%|█████████▌| 19/20 [28:28<01:22, 82.51s/it]Task 5, Epoch 20/20 => Loss 2.081, Train_accy 94.45: 100%|██████████| 20/20 [28:28<00:00, 79.46s/it]Task 5, Epoch 20/20 => Loss 2.081, Train_accy 94.45: 100%|██████████| 20/20 [28:28<00:00, 85.41s/it]
2024-07-20 15:52:24,684 [icarl.py] => Task 5, Epoch 20/20 => Loss 2.081, Train_accy 94.45
2024-07-20 15:52:24,685 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 15:53:49,417 [icarl.py] => Exemplar size: 1200
2024-07-20 15:53:49,417 [trainer.py] => CNN: {'total': 77.33, '00-09': 64.8, '10-19': 64.5, '20-29': 73.3, '30-39': 77.4, '40-49': 87.2, '50-59': 96.8, 'old': 73.44, 'new': 96.8}
2024-07-20 15:53:49,417 [trainer.py] => NME: {'total': 87.52, '00-09': 85.8, '10-19': 79.9, '20-29': 90.3, '30-39': 86.4, '40-49': 91.5, '50-59': 91.2, 'old': 86.78, 'new': 91.2}
2024-07-20 15:53:49,417 [trainer.py] => CNN top1 curve: [98.3, 93.05, 89.67, 86.28, 79.32, 77.33]
2024-07-20 15:53:49,417 [trainer.py] => CNN top5 curve: [100.0, 99.4, 98.3, 97.5, 95.96, 93.9]
2024-07-20 15:53:49,417 [trainer.py] => NME top1 curve: [98.7, 95.7, 93.6, 91.88, 89.22, 87.52]
2024-07-20 15:53:49,417 [trainer.py] => NME top5 curve: [100.0, 99.9, 99.33, 99.15, 99.02, 98.65]

Average Accuracy (CNN): 87.32
Average Accuracy (NME): 92.77
2024-07-20 15:53:49,417 [trainer.py] => Average Accuracy (CNN): 87.32
2024-07-20 15:53:49,417 [trainer.py] => Average Accuracy (NME): 92.77
2024-07-20 15:53:49,418 [trainer.py] => Train Time: 0
2024-07-20 15:53:49,418 [trainer.py] => Test Time: 160.22 

2024-07-20 15:53:49,418 [trainer.py] => All params: 85844796
2024-07-20 15:53:49,419 [trainer.py] => Trainable params: 85844796
2024-07-20 15:53:49,420 [icarl.py] => Learning on 60-70
  0%|          | 0/20 [00:00<?, ?it/s]Task 6, Epoch 1/20 => Loss 3.122, Train_accy 79.32, Test_accy 77.03:   0%|          | 0/20 [01:38<?, ?it/s]Task 6, Epoch 1/20 => Loss 3.122, Train_accy 79.32, Test_accy 77.03:   5%|▌         | 1/20 [01:38<31:10, 98.45s/it]Task 6, Epoch 2/20 => Loss 2.378, Train_accy 90.13:   5%|▌         | 1/20 [02:54<31:10, 98.45s/it]                 Task 6, Epoch 2/20 => Loss 2.378, Train_accy 90.13:  10%|█         | 2/20 [02:54<25:31, 85.08s/it]Task 6, Epoch 3/20 => Loss 2.240, Train_accy 91.84:  10%|█         | 2/20 [04:10<25:31, 85.08s/it]Task 6, Epoch 3/20 => Loss 2.240, Train_accy 91.84:  15%|█▌        | 3/20 [04:10<22:57, 81.02s/it]Task 6, Epoch 4/20 => Loss 2.243, Train_accy 92.32:  15%|█▌        | 3/20 [05:27<22:57, 81.02s/it]Task 6, Epoch 4/20 => Loss 2.243, Train_accy 92.32:  20%|██        | 4/20 [05:27<21:14, 79.66s/it]Task 6, Epoch 5/20 => Loss 2.236, Train_accy 92.89:  20%|██        | 4/20 [06:44<21:14, 79.66s/it]Task 6, Epoch 5/20 => Loss 2.236, Train_accy 92.89:  25%|██▌       | 5/20 [06:44<19:38, 78.59s/it]Task 6, Epoch 6/20 => Loss 2.227, Train_accy 92.95, Test_accy 76.34:  25%|██▌       | 5/20 [08:25<19:38, 78.59s/it]Task 6, Epoch 6/20 => Loss 2.227, Train_accy 92.95, Test_accy 76.34:  30%|███       | 6/20 [08:25<20:08, 86.31s/it]Task 6, Epoch 7/20 => Loss 2.188, Train_accy 93.50:  30%|███       | 6/20 [09:42<20:08, 86.31s/it]                 Task 6, Epoch 7/20 => Loss 2.188, Train_accy 93.50:  35%|███▌      | 7/20 [09:42<17:58, 82.99s/it]Task 6, Epoch 8/20 => Loss 2.200, Train_accy 93.58:  35%|███▌      | 7/20 [10:57<17:58, 82.99s/it]Task 6, Epoch 8/20 => Loss 2.200, Train_accy 93.58:  40%|████      | 8/20 [10:57<16:06, 80.55s/it]Task 6, Epoch 9/20 => Loss 2.171, Train_accy 93.81:  40%|████      | 8/20 [12:13<16:06, 80.55s/it]Task 6, Epoch 9/20 => Loss 2.171, Train_accy 93.81:  45%|████▌     | 9/20 [12:13<14:29, 79.05s/it]Task 6, Epoch 10/20 => Loss 2.184, Train_accy 94.05:  45%|████▌     | 9/20 [13:27<14:29, 79.05s/it]Task 6, Epoch 10/20 => Loss 2.184, Train_accy 94.05:  50%|█████     | 10/20 [13:27<12:56, 77.66s/it]Task 6, Epoch 11/20 => Loss 2.179, Train_accy 93.94, Test_accy 74.41:  50%|█████     | 10/20 [15:06<12:56, 77.66s/it]Task 6, Epoch 11/20 => Loss 2.179, Train_accy 93.94, Test_accy 74.41:  55%|█████▌    | 11/20 [15:06<12:37, 84.20s/it]Task 6, Epoch 12/20 => Loss 2.173, Train_accy 94.15:  55%|█████▌    | 11/20 [16:21<12:37, 84.20s/it]                 Task 6, Epoch 12/20 => Loss 2.173, Train_accy 94.15:  60%|██████    | 12/20 [16:21<10:50, 81.28s/it]Task 6, Epoch 13/20 => Loss 2.150, Train_accy 94.26:  60%|██████    | 12/20 [17:35<10:50, 81.28s/it]Task 6, Epoch 13/20 => Loss 2.150, Train_accy 94.26:  65%|██████▌   | 13/20 [17:35<09:14, 79.26s/it]Task 6, Epoch 14/20 => Loss 2.145, Train_accy 94.87:  65%|██████▌   | 13/20 [18:50<09:14, 79.26s/it]Task 6, Epoch 14/20 => Loss 2.145, Train_accy 94.87:  70%|███████   | 14/20 [18:50<07:46, 77.78s/it]Task 6, Epoch 15/20 => Loss 2.150, Train_accy 94.85:  70%|███████   | 14/20 [20:04<07:46, 77.78s/it]Task 6, Epoch 15/20 => Loss 2.150, Train_accy 94.85:  75%|███████▌  | 15/20 [20:04<06:24, 76.81s/it]Task 6, Epoch 16/20 => Loss 2.119, Train_accy 95.08, Test_accy 76.60:  75%|███████▌  | 15/20 [21:43<06:24, 76.81s/it]Task 6, Epoch 16/20 => Loss 2.119, Train_accy 95.08, Test_accy 76.60:  80%|████████  | 16/20 [21:43<05:33, 83.29s/it]Task 6, Epoch 17/20 => Loss 2.152, Train_accy 94.52:  80%|████████  | 16/20 [22:57<05:33, 83.29s/it]                 Task 6, Epoch 17/20 => Loss 2.152, Train_accy 94.52:  85%|████████▌ | 17/20 [22:57<04:01, 80.48s/it]Task 6, Epoch 18/20 => Loss 2.161, Train_accy 94.45:  85%|████████▌ | 17/20 [24:12<04:01, 80.48s/it]Task 6, Epoch 18/20 => Loss 2.161, Train_accy 94.45:  90%|█████████ | 18/20 [24:12<02:37, 78.88s/it]Task 6, Epoch 19/20 => Loss 2.137, Train_accy 94.97:  90%|█████████ | 18/20 [25:27<02:37, 78.88s/it]Task 6, Epoch 19/20 => Loss 2.137, Train_accy 94.97:  95%|█████████▌| 19/20 [25:27<01:17, 77.72s/it]Task 6, Epoch 20/20 => Loss 2.150, Train_accy 94.81:  95%|█████████▌| 19/20 [26:41<01:17, 77.72s/it]Task 6, Epoch 20/20 => Loss 2.150, Train_accy 94.81: 100%|██████████| 20/20 [26:41<00:00, 76.70s/it]Task 6, Epoch 20/20 => Loss 2.150, Train_accy 94.81: 100%|██████████| 20/20 [26:41<00:00, 80.08s/it]
2024-07-20 16:20:31,125 [icarl.py] => Task 6, Epoch 20/20 => Loss 2.150, Train_accy 94.81
2024-07-20 16:20:31,127 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 16:22:03,876 [icarl.py] => Exemplar size: 1400
2024-07-20 16:22:03,876 [trainer.py] => CNN: {'total': 76.41, '00-09': 61.3, '10-19': 55.1, '20-29': 75.8, '30-39': 75.8, '40-49': 86.4, '50-59': 82.6, '60-69': 97.9, 'old': 72.83, 'new': 97.9}
2024-07-20 16:22:03,876 [trainer.py] => NME: {'total': 86.54, '00-09': 82.9, '10-19': 79.0, '20-29': 90.3, '30-39': 85.7, '40-49': 89.0, '50-59': 84.3, '60-69': 94.6, 'old': 85.2, 'new': 94.6}
2024-07-20 16:22:03,876 [trainer.py] => CNN top1 curve: [98.3, 93.05, 89.67, 86.28, 79.32, 77.33, 76.41]
2024-07-20 16:22:03,876 [trainer.py] => CNN top5 curve: [100.0, 99.4, 98.3, 97.5, 95.96, 93.9, 93.29]
2024-07-20 16:22:03,876 [trainer.py] => NME top1 curve: [98.7, 95.7, 93.6, 91.88, 89.22, 87.52, 86.54]
2024-07-20 16:22:03,876 [trainer.py] => NME top5 curve: [100.0, 99.9, 99.33, 99.15, 99.02, 98.65, 98.1]

Average Accuracy (CNN): 85.77
Average Accuracy (NME): 91.88
2024-07-20 16:22:03,876 [trainer.py] => Average Accuracy (CNN): 85.77
2024-07-20 16:22:03,877 [trainer.py] => Average Accuracy (NME): 91.88
2024-07-20 16:22:03,877 [trainer.py] => Train Time: 0
2024-07-20 16:22:03,877 [trainer.py] => Test Time: 208.63 

2024-07-20 16:22:03,877 [trainer.py] => All params: 85852486
2024-07-20 16:22:03,878 [trainer.py] => Trainable params: 85852486
2024-07-20 16:22:03,880 [icarl.py] => Learning on 70-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 2.951, Train_accy 75.88, Test_accy 71.70:   0%|          | 0/20 [01:46<?, ?it/s]Task 7, Epoch 1/20 => Loss 2.951, Train_accy 75.88, Test_accy 71.70:   5%|▌         | 1/20 [01:46<33:48, 106.76s/it]Task 7, Epoch 2/20 => Loss 2.095, Train_accy 88.41:   5%|▌         | 1/20 [03:03<33:48, 106.76s/it]                 Task 7, Epoch 2/20 => Loss 2.095, Train_accy 88.41:  10%|█         | 2/20 [03:03<26:48, 89.36s/it] Task 7, Epoch 3/20 => Loss 2.030, Train_accy 89.95:  10%|█         | 2/20 [04:21<26:48, 89.36s/it]Task 7, Epoch 3/20 => Loss 2.030, Train_accy 89.95:  15%|█▌        | 3/20 [04:21<23:46, 83.90s/it]Task 7, Epoch 4/20 => Loss 2.015, Train_accy 90.44:  15%|█▌        | 3/20 [05:38<23:46, 83.90s/it]Task 7, Epoch 4/20 => Loss 2.015, Train_accy 90.44:  20%|██        | 4/20 [05:38<21:40, 81.25s/it]Task 7, Epoch 5/20 => Loss 1.978, Train_accy 91.69:  20%|██        | 4/20 [06:55<21:40, 81.25s/it]Task 7, Epoch 5/20 => Loss 1.978, Train_accy 91.69:  25%|██▌       | 5/20 [06:55<19:55, 79.73s/it]Task 7, Epoch 6/20 => Loss 1.982, Train_accy 91.78, Test_accy 70.75:  25%|██▌       | 5/20 [08:40<19:55, 79.73s/it]Task 7, Epoch 6/20 => Loss 1.982, Train_accy 91.78, Test_accy 70.75:  30%|███       | 6/20 [08:40<20:34, 88.17s/it]Task 7, Epoch 7/20 => Loss 1.945, Train_accy 92.64:  30%|███       | 6/20 [09:58<20:34, 88.17s/it]                 Task 7, Epoch 7/20 => Loss 1.945, Train_accy 92.64:  35%|███▌      | 7/20 [09:58<18:23, 84.87s/it]Task 7, Epoch 8/20 => Loss 1.937, Train_accy 92.44:  35%|███▌      | 7/20 [11:16<18:23, 84.87s/it]Task 7, Epoch 8/20 => Loss 1.937, Train_accy 92.44:  40%|████      | 8/20 [11:16<16:31, 82.66s/it]Task 7, Epoch 9/20 => Loss 1.942, Train_accy 92.91:  40%|████      | 8/20 [12:36<16:31, 82.66s/it]Task 7, Epoch 9/20 => Loss 1.942, Train_accy 92.91:  45%|████▌     | 9/20 [12:36<14:59, 81.80s/it]Task 7, Epoch 10/20 => Loss 1.904, Train_accy 93.12:  45%|████▌     | 9/20 [13:56<14:59, 81.80s/it]Task 7, Epoch 10/20 => Loss 1.904, Train_accy 93.12:  50%|█████     | 10/20 [13:56<13:32, 81.28s/it]Task 7, Epoch 11/20 => Loss 1.897, Train_accy 93.73, Test_accy 72.05:  50%|█████     | 10/20 [15:44<13:32, 81.28s/it]Task 7, Epoch 11/20 => Loss 1.897, Train_accy 93.73, Test_accy 72.05:  55%|█████▌    | 11/20 [15:44<13:24, 89.43s/it]Task 7, Epoch 12/20 => Loss 1.903, Train_accy 93.31:  55%|█████▌    | 11/20 [17:02<13:24, 89.43s/it]                 Task 7, Epoch 12/20 => Loss 1.903, Train_accy 93.31:  60%|██████    | 12/20 [17:02<11:28, 86.11s/it]Task 7, Epoch 13/20 => Loss 1.909, Train_accy 93.77:  60%|██████    | 12/20 [18:21<11:28, 86.11s/it]Task 7, Epoch 13/20 => Loss 1.909, Train_accy 93.77:  65%|██████▌   | 13/20 [18:21<09:46, 83.83s/it]Task 7, Epoch 14/20 => Loss 1.877, Train_accy 94.02:  65%|██████▌   | 13/20 [19:39<09:46, 83.83s/it]Task 7, Epoch 14/20 => Loss 1.877, Train_accy 94.02:  70%|███████   | 14/20 [19:39<08:13, 82.28s/it]Task 7, Epoch 15/20 => Loss 1.886, Train_accy 93.98:  70%|███████   | 14/20 [20:57<08:13, 82.28s/it]Task 7, Epoch 15/20 => Loss 1.886, Train_accy 93.98:  75%|███████▌  | 15/20 [20:57<06:44, 80.90s/it]Task 7, Epoch 16/20 => Loss 1.897, Train_accy 94.22, Test_accy 70.78:  75%|███████▌  | 15/20 [22:43<06:44, 80.90s/it]Task 7, Epoch 16/20 => Loss 1.897, Train_accy 94.22, Test_accy 70.78:  80%|████████  | 16/20 [22:43<05:54, 88.58s/it]Task 7, Epoch 17/20 => Loss 1.895, Train_accy 93.70:  80%|████████  | 16/20 [24:00<05:54, 88.58s/it]                 Task 7, Epoch 17/20 => Loss 1.895, Train_accy 93.70:  85%|████████▌ | 17/20 [24:00<04:15, 85.07s/it]Task 7, Epoch 18/20 => Loss 1.909, Train_accy 93.64:  85%|████████▌ | 17/20 [25:18<04:15, 85.07s/it]Task 7, Epoch 18/20 => Loss 1.909, Train_accy 93.64:  90%|█████████ | 18/20 [25:18<02:45, 82.74s/it]Task 7, Epoch 19/20 => Loss 1.881, Train_accy 93.77:  90%|█████████ | 18/20 [26:35<02:45, 82.74s/it]Task 7, Epoch 19/20 => Loss 1.881, Train_accy 93.77:  95%|█████████▌| 19/20 [26:35<01:21, 81.07s/it]Task 7, Epoch 20/20 => Loss 1.856, Train_accy 94.17:  95%|█████████▌| 19/20 [27:52<01:21, 81.07s/it]Task 7, Epoch 20/20 => Loss 1.856, Train_accy 94.17: 100%|██████████| 20/20 [27:52<00:00, 79.95s/it]Task 7, Epoch 20/20 => Loss 1.856, Train_accy 94.17: 100%|██████████| 20/20 [27:52<00:00, 83.63s/it]
2024-07-20 16:49:56,667 [icarl.py] => Task 7, Epoch 20/20 => Loss 1.856, Train_accy 94.17
2024-07-20 16:49:56,669 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 16:51:39,303 [icarl.py] => Exemplar size: 1600
2024-07-20 16:51:39,303 [trainer.py] => CNN: {'total': 71.75, '00-09': 57.0, '10-19': 56.5, '20-29': 72.5, '30-39': 69.7, '40-49': 76.0, '50-59': 62.7, '60-69': 84.2, '70-79': 95.4, 'old': 68.37, 'new': 95.4}
2024-07-20 16:51:39,303 [trainer.py] => NME: {'total': 83.91, '00-09': 82.3, '10-19': 76.3, '20-29': 88.7, '30-39': 82.6, '40-49': 85.7, '50-59': 76.4, '60-69': 89.4, '70-79': 89.9, 'old': 83.06, 'new': 89.9}
2024-07-20 16:51:39,303 [trainer.py] => CNN top1 curve: [98.3, 93.05, 89.67, 86.28, 79.32, 77.33, 76.41, 71.75]
2024-07-20 16:51:39,303 [trainer.py] => CNN top5 curve: [100.0, 99.4, 98.3, 97.5, 95.96, 93.9, 93.29, 91.95]
2024-07-20 16:51:39,303 [trainer.py] => NME top1 curve: [98.7, 95.7, 93.6, 91.88, 89.22, 87.52, 86.54, 83.91]
2024-07-20 16:51:39,303 [trainer.py] => NME top5 curve: [100.0, 99.9, 99.33, 99.15, 99.02, 98.65, 98.1, 97.54]

Average Accuracy (CNN): 84.01
Average Accuracy (NME): 90.88
2024-07-20 16:51:39,304 [trainer.py] => Average Accuracy (CNN): 84.01
2024-07-20 16:51:39,304 [trainer.py] => Average Accuracy (NME): 90.88
2024-07-20 16:51:39,304 [trainer.py] => Train Time: 0
2024-07-20 16:51:39,304 [trainer.py] => Test Time: 263.0 

2024-07-20 16:51:39,304 [trainer.py] => All params: 85860176
2024-07-20 16:51:39,305 [trainer.py] => Trainable params: 85860176
2024-07-20 16:51:39,307 [icarl.py] => Learning on 80-90
  0%|          | 0/20 [00:00<?, ?it/s]Task 8, Epoch 1/20 => Loss 3.259, Train_accy 78.05, Test_accy 70.81:   0%|          | 0/20 [01:50<?, ?it/s]Task 8, Epoch 1/20 => Loss 3.259, Train_accy 78.05, Test_accy 70.81:   5%|▌         | 1/20 [01:50<35:08, 110.97s/it]Task 8, Epoch 2/20 => Loss 2.500, Train_accy 89.70:   5%|▌         | 1/20 [03:10<35:08, 110.97s/it]                 Task 8, Epoch 2/20 => Loss 2.500, Train_accy 89.70:  10%|█         | 2/20 [03:10<27:49, 92.74s/it] Task 8, Epoch 3/20 => Loss 2.437, Train_accy 90.62:  10%|█         | 2/20 [04:32<27:49, 92.74s/it]Task 8, Epoch 3/20 => Loss 2.437, Train_accy 90.62:  15%|█▌        | 3/20 [04:32<24:47, 87.48s/it]Task 8, Epoch 4/20 => Loss 2.397, Train_accy 92.27:  15%|█▌        | 3/20 [05:51<24:47, 87.48s/it]Task 8, Epoch 4/20 => Loss 2.397, Train_accy 92.27:  20%|██        | 4/20 [05:51<22:31, 84.44s/it]Task 8, Epoch 5/20 => Loss 2.402, Train_accy 91.71:  20%|██        | 4/20 [07:11<22:31, 84.44s/it]Task 8, Epoch 5/20 => Loss 2.402, Train_accy 91.71:  25%|██▌       | 5/20 [07:11<20:42, 82.86s/it]Task 8, Epoch 6/20 => Loss 2.389, Train_accy 91.92, Test_accy 69.41:  25%|██▌       | 5/20 [09:02<20:42, 82.86s/it]Task 8, Epoch 6/20 => Loss 2.389, Train_accy 91.92, Test_accy 69.41:  30%|███       | 6/20 [09:02<21:32, 92.32s/it]Task 8, Epoch 7/20 => Loss 2.364, Train_accy 92.65:  30%|███       | 6/20 [10:21<21:32, 92.32s/it]                 Task 8, Epoch 7/20 => Loss 2.364, Train_accy 92.65:  35%|███▌      | 7/20 [10:21<19:02, 87.90s/it]Task 8, Epoch 8/20 => Loss 2.390, Train_accy 92.59:  35%|███▌      | 7/20 [11:40<19:02, 87.90s/it]Task 8, Epoch 8/20 => Loss 2.390, Train_accy 92.59:  40%|████      | 8/20 [11:40<17:01, 85.12s/it]Task 8, Epoch 9/20 => Loss 2.393, Train_accy 92.48:  40%|████      | 8/20 [13:00<17:01, 85.12s/it]Task 8, Epoch 9/20 => Loss 2.393, Train_accy 92.48:  45%|████▌     | 9/20 [13:00<15:16, 83.36s/it]Task 8, Epoch 10/20 => Loss 2.330, Train_accy 93.15:  45%|████▌     | 9/20 [14:19<15:16, 83.36s/it]Task 8, Epoch 10/20 => Loss 2.330, Train_accy 93.15:  50%|█████     | 10/20 [14:19<13:41, 82.18s/it]Task 8, Epoch 11/20 => Loss 2.329, Train_accy 93.71, Test_accy 70.40:  50%|█████     | 10/20 [16:10<13:41, 82.18s/it]Task 8, Epoch 11/20 => Loss 2.329, Train_accy 93.71, Test_accy 70.40:  55%|█████▌    | 11/20 [16:10<13:37, 90.85s/it]Task 8, Epoch 12/20 => Loss 2.351, Train_accy 92.95:  55%|█████▌    | 11/20 [17:29<13:37, 90.85s/it]                 Task 8, Epoch 12/20 => Loss 2.351, Train_accy 92.95:  60%|██████    | 12/20 [17:29<11:39, 87.49s/it]Task 8, Epoch 13/20 => Loss 2.340, Train_accy 93.05:  60%|██████    | 12/20 [18:49<11:39, 87.49s/it]Task 8, Epoch 13/20 => Loss 2.340, Train_accy 93.05:  65%|██████▌   | 13/20 [18:49<09:56, 85.18s/it]Task 8, Epoch 14/20 => Loss 2.337, Train_accy 93.76:  65%|██████▌   | 13/20 [20:09<09:56, 85.18s/it]Task 8, Epoch 14/20 => Loss 2.337, Train_accy 93.76:  70%|███████   | 14/20 [20:09<08:21, 83.63s/it]Task 8, Epoch 15/20 => Loss 2.351, Train_accy 93.82:  70%|███████   | 14/20 [21:29<08:21, 83.63s/it]Task 8, Epoch 15/20 => Loss 2.351, Train_accy 93.82:  75%|███████▌  | 15/20 [21:29<06:52, 82.40s/it]Task 8, Epoch 16/20 => Loss 2.354, Train_accy 93.44, Test_accy 69.32:  75%|███████▌  | 15/20 [23:21<06:52, 82.40s/it]Task 8, Epoch 16/20 => Loss 2.354, Train_accy 93.44, Test_accy 69.32:  80%|████████  | 16/20 [23:21<06:05, 91.33s/it]Task 8, Epoch 17/20 => Loss 2.349, Train_accy 93.47:  80%|████████  | 16/20 [24:41<06:05, 91.33s/it]                 Task 8, Epoch 17/20 => Loss 2.349, Train_accy 93.47:  85%|████████▌ | 17/20 [24:41<04:23, 87.77s/it]Task 8, Epoch 18/20 => Loss 2.316, Train_accy 94.08:  85%|████████▌ | 17/20 [26:00<04:23, 87.77s/it]Task 8, Epoch 18/20 => Loss 2.316, Train_accy 94.08:  90%|█████████ | 18/20 [26:00<02:50, 85.19s/it]Task 8, Epoch 19/20 => Loss 2.288, Train_accy 94.39:  90%|█████████ | 18/20 [27:19<02:50, 85.19s/it]Task 8, Epoch 19/20 => Loss 2.288, Train_accy 94.39:  95%|█████████▌| 19/20 [27:19<01:23, 83.28s/it]Task 8, Epoch 20/20 => Loss 2.289, Train_accy 94.52:  95%|█████████▌| 19/20 [28:37<01:23, 83.28s/it]Task 8, Epoch 20/20 => Loss 2.289, Train_accy 94.52: 100%|██████████| 20/20 [28:37<00:00, 81.90s/it]Task 8, Epoch 20/20 => Loss 2.289, Train_accy 94.52: 100%|██████████| 20/20 [28:37<00:00, 85.89s/it]
2024-07-20 17:20:17,141 [icarl.py] => Task 8, Epoch 20/20 => Loss 2.289, Train_accy 94.52
2024-07-20 17:20:17,142 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 17:22:08,672 [icarl.py] => Exemplar size: 1800
2024-07-20 17:22:08,672 [trainer.py] => CNN: {'total': 69.12, '00-09': 55.6, '10-19': 49.5, '20-29': 66.0, '30-39': 65.3, '40-49': 65.3, '50-59': 61.1, '60-69': 78.3, '70-79': 84.5, '80-89': 96.5, 'old': 65.7, 'new': 96.5}
2024-07-20 17:22:08,672 [trainer.py] => NME: {'total': 81.99, '00-09': 80.4, '10-19': 70.7, '20-29': 84.1, '30-39': 80.1, '40-49': 81.9, '50-59': 74.8, '60-69': 88.1, '70-79': 85.9, '80-89': 91.9, 'old': 80.75, 'new': 91.9}
2024-07-20 17:22:08,672 [trainer.py] => CNN top1 curve: [98.3, 93.05, 89.67, 86.28, 79.32, 77.33, 76.41, 71.75, 69.12]
2024-07-20 17:22:08,672 [trainer.py] => CNN top5 curve: [100.0, 99.4, 98.3, 97.5, 95.96, 93.9, 93.29, 91.95, 90.23]
2024-07-20 17:22:08,672 [trainer.py] => NME top1 curve: [98.7, 95.7, 93.6, 91.88, 89.22, 87.52, 86.54, 83.91, 81.99]
2024-07-20 17:22:08,672 [trainer.py] => NME top5 curve: [100.0, 99.9, 99.33, 99.15, 99.02, 98.65, 98.1, 97.54, 96.69]

Average Accuracy (CNN): 82.36
Average Accuracy (NME): 89.9
2024-07-20 17:22:08,673 [trainer.py] => Average Accuracy (CNN): 82.36
2024-07-20 17:22:08,673 [trainer.py] => Average Accuracy (NME): 89.9
2024-07-20 17:22:08,673 [trainer.py] => Train Time: 0
2024-07-20 17:22:08,673 [trainer.py] => Test Time: 324.29 

2024-07-20 17:22:08,673 [trainer.py] => All params: 85867866
2024-07-20 17:22:08,674 [trainer.py] => Trainable params: 85867866
2024-07-20 17:22:08,676 [icarl.py] => Learning on 90-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 9, Epoch 1/20 => Loss 3.362, Train_accy 77.06, Test_accy 69.78:   0%|          | 0/20 [01:57<?, ?it/s]Task 9, Epoch 1/20 => Loss 3.362, Train_accy 77.06, Test_accy 69.78:   5%|▌         | 1/20 [01:57<37:15, 117.68s/it]Task 9, Epoch 2/20 => Loss 2.570, Train_accy 88.60:   5%|▌         | 1/20 [03:22<37:15, 117.68s/it]                 Task 9, Epoch 2/20 => Loss 2.570, Train_accy 88.60:  10%|█         | 2/20 [03:22<29:25, 98.07s/it] Task 9, Epoch 3/20 => Loss 2.480, Train_accy 90.72:  10%|█         | 2/20 [04:45<29:25, 98.07s/it]Task 9, Epoch 3/20 => Loss 2.480, Train_accy 90.72:  15%|█▌        | 3/20 [04:45<25:55, 91.49s/it]Task 9, Epoch 4/20 => Loss 2.455, Train_accy 91.24:  15%|█▌        | 3/20 [06:09<25:55, 91.49s/it]Task 9, Epoch 4/20 => Loss 2.455, Train_accy 91.24:  20%|██        | 4/20 [06:09<23:34, 88.42s/it]Task 9, Epoch 5/20 => Loss 2.420, Train_accy 92.12:  20%|██        | 4/20 [07:32<23:34, 88.42s/it]Task 9, Epoch 5/20 => Loss 2.420, Train_accy 92.12:  25%|██▌       | 5/20 [07:32<21:36, 86.44s/it]Task 9, Epoch 6/20 => Loss 2.405, Train_accy 92.51, Test_accy 67.60:  25%|██▌       | 5/20 [09:30<21:36, 86.44s/it]Task 9, Epoch 6/20 => Loss 2.405, Train_accy 92.51, Test_accy 67.60:  30%|███       | 6/20 [09:30<22:42, 97.34s/it]Task 9, Epoch 7/20 => Loss 2.429, Train_accy 91.96:  30%|███       | 6/20 [10:53<22:42, 97.34s/it]                 Task 9, Epoch 7/20 => Loss 2.429, Train_accy 91.96:  35%|███▌      | 7/20 [10:53<20:04, 92.67s/it]Task 9, Epoch 8/20 => Loss 2.406, Train_accy 92.72:  35%|███▌      | 7/20 [12:15<20:04, 92.67s/it]Task 9, Epoch 8/20 => Loss 2.406, Train_accy 92.72:  40%|████      | 8/20 [12:15<17:49, 89.14s/it]Task 9, Epoch 9/20 => Loss 2.384, Train_accy 93.34:  40%|████      | 8/20 [13:37<17:49, 89.14s/it]Task 9, Epoch 9/20 => Loss 2.384, Train_accy 93.34:  45%|████▌     | 9/20 [13:37<15:56, 86.97s/it]Task 9, Epoch 10/20 => Loss 2.394, Train_accy 93.13:  45%|████▌     | 9/20 [14:58<15:56, 86.97s/it]Task 9, Epoch 10/20 => Loss 2.394, Train_accy 93.13:  50%|█████     | 10/20 [14:58<14:12, 85.22s/it]Task 9, Epoch 11/20 => Loss 2.386, Train_accy 92.97, Test_accy 67.81:  50%|█████     | 10/20 [16:53<14:12, 85.22s/it]Task 9, Epoch 11/20 => Loss 2.386, Train_accy 92.97, Test_accy 67.81:  55%|█████▌    | 11/20 [16:53<14:09, 94.34s/it]Task 9, Epoch 12/20 => Loss 2.359, Train_accy 93.25:  55%|█████▌    | 11/20 [18:15<14:09, 94.34s/it]                 Task 9, Epoch 12/20 => Loss 2.359, Train_accy 93.25:  60%|██████    | 12/20 [18:15<12:02, 90.33s/it]Task 9, Epoch 13/20 => Loss 2.403, Train_accy 92.84:  60%|██████    | 12/20 [19:36<12:02, 90.33s/it]Task 9, Epoch 13/20 => Loss 2.403, Train_accy 92.84:  65%|██████▌   | 13/20 [19:36<10:13, 87.65s/it]Task 9, Epoch 14/20 => Loss 2.402, Train_accy 93.32:  65%|██████▌   | 13/20 [20:58<10:13, 87.65s/it]Task 9, Epoch 14/20 => Loss 2.402, Train_accy 93.32:  70%|███████   | 14/20 [20:58<08:35, 85.90s/it]Task 9, Epoch 15/20 => Loss 2.346, Train_accy 94.01:  70%|███████   | 14/20 [22:20<08:35, 85.90s/it]Task 9, Epoch 15/20 => Loss 2.346, Train_accy 94.01:  75%|███████▌  | 15/20 [22:20<07:03, 84.73s/it]Task 9, Epoch 16/20 => Loss 2.366, Train_accy 94.03, Test_accy 68.84:  75%|███████▌  | 15/20 [24:15<07:03, 84.73s/it]Task 9, Epoch 16/20 => Loss 2.366, Train_accy 94.03, Test_accy 68.84:  80%|████████  | 16/20 [24:15<06:15, 93.98s/it]Task 9, Epoch 17/20 => Loss 2.375, Train_accy 93.41:  80%|████████  | 16/20 [25:38<06:15, 93.98s/it]                 Task 9, Epoch 17/20 => Loss 2.375, Train_accy 93.41:  85%|████████▌ | 17/20 [25:38<04:31, 90.43s/it]Task 9, Epoch 18/20 => Loss 2.342, Train_accy 93.79:  85%|████████▌ | 17/20 [27:00<04:31, 90.43s/it]Task 9, Epoch 18/20 => Loss 2.342, Train_accy 93.79:  90%|█████████ | 18/20 [27:00<02:55, 87.98s/it]Task 9, Epoch 19/20 => Loss 2.345, Train_accy 94.22:  90%|█████████ | 18/20 [28:22<02:55, 87.98s/it]Task 9, Epoch 19/20 => Loss 2.345, Train_accy 94.22:  95%|█████████▌| 19/20 [28:22<01:26, 86.28s/it]Task 9, Epoch 20/20 => Loss 2.325, Train_accy 94.44:  95%|█████████▌| 19/20 [29:44<01:26, 86.28s/it]Task 9, Epoch 20/20 => Loss 2.325, Train_accy 94.44: 100%|██████████| 20/20 [29:44<00:00, 85.07s/it]Task 9, Epoch 20/20 => Loss 2.325, Train_accy 94.44: 100%|██████████| 20/20 [29:44<00:00, 89.25s/it]
2024-07-20 17:51:53,741 [icarl.py] => Task 9, Epoch 20/20 => Loss 2.325, Train_accy 94.44
2024-07-20 17:51:53,743 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-07-20 17:53:56,574 [icarl.py] => Exemplar size: 2000
2024-07-20 17:53:56,575 [trainer.py] => CNN: {'total': 68.39, '00-09': 52.2, '10-19': 46.5, '20-29': 65.8, '30-39': 61.4, '40-49': 62.2, '50-59': 56.4, '60-69': 75.0, '70-79': 76.9, '80-89': 91.2, '90-99': 96.3, 'old': 65.29, 'new': 96.3}
2024-07-20 17:53:56,575 [trainer.py] => NME: {'total': 80.69, '00-09': 76.5, '10-19': 68.5, '20-29': 85.2, '30-39': 77.6, '40-49': 80.6, '50-59': 71.4, '60-69': 85.8, '70-79': 81.4, '80-89': 89.1, '90-99': 90.8, 'old': 79.57, 'new': 90.8}
2024-07-20 17:53:56,575 [trainer.py] => CNN top1 curve: [98.3, 93.05, 89.67, 86.28, 79.32, 77.33, 76.41, 71.75, 69.12, 68.39]
2024-07-20 17:53:56,575 [trainer.py] => CNN top5 curve: [100.0, 99.4, 98.3, 97.5, 95.96, 93.9, 93.29, 91.95, 90.23, 88.25]
2024-07-20 17:53:56,575 [trainer.py] => NME top1 curve: [98.7, 95.7, 93.6, 91.88, 89.22, 87.52, 86.54, 83.91, 81.99, 80.69]
2024-07-20 17:53:56,575 [trainer.py] => NME top5 curve: [100.0, 99.9, 99.33, 99.15, 99.02, 98.65, 98.1, 97.54, 96.69, 96.15]

Average Accuracy (CNN): 80.96
Average Accuracy (NME): 88.98
2024-07-20 17:53:56,575 [trainer.py] => Average Accuracy (CNN): 80.96
2024-07-20 17:53:56,575 [trainer.py] => Average Accuracy (NME): 88.98
2024-07-20 17:53:56,575 [trainer.py] => Train Time: 0
2024-07-20 17:53:56,575 [trainer.py] => Test Time: 393.06 

Accuracy Matrix (CNN):
[[98.3 88.9 84.4 78.4 70.8 64.8 61.3 57.  55.6 52.2]
 [ 0.  97.2 86.  79.4 63.4 64.5 55.1 56.5 49.5 46.5]
 [ 0.   0.  98.6 90.8 79.3 73.3 75.8 72.5 66.  65.8]
 [ 0.   0.   0.  96.5 84.8 77.4 75.8 69.7 65.3 61.4]
 [ 0.   0.   0.   0.  98.3 87.2 86.4 76.  65.3 62.2]
 [ 0.   0.   0.   0.   0.  96.8 82.6 62.7 61.1 56.4]
 [ 0.   0.   0.   0.   0.   0.  97.9 84.2 78.3 75. ]
 [ 0.   0.   0.   0.   0.   0.   0.  95.4 84.5 76.9]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  96.5 91.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  96.3]]
2024-07-20 17:53:56,577 [trainer.py] => Forgetting (CNN): 31.988888888888894
Accuracy Matrix (NME):
[[98.7 95.9 92.5 90.5 88.2 85.8 82.9 82.3 80.4 76.5]
 [ 0.  95.5 90.7 87.9 82.7 79.9 79.  76.3 70.7 68.5]
 [ 0.   0.  97.6 95.2 92.7 90.3 90.3 88.7 84.1 85.2]
 [ 0.   0.   0.  93.9 88.  86.4 85.7 82.6 80.1 77.6]
 [ 0.   0.   0.   0.  94.5 91.5 89.  85.7 81.9 80.6]
 [ 0.   0.   0.   0.   0.  91.2 84.3 76.4 74.8 71.4]
 [ 0.   0.   0.   0.   0.   0.  94.6 89.4 88.1 85.8]
 [ 0.   0.   0.   0.   0.   0.   0.  89.9 85.9 81.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  91.9 89.1]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  90.8]]
2024-07-20 17:53:56,577 [trainer.py] => Forgetting (NME): 14.633333333333335
2024-07-20 17:54:00,521 [trainer.py] => config: ./exps/der_vtab_B0_Inc5.json
2024-07-20 17:54:00,521 [trainer.py] => prefix: reproduce
2024-07-20 17:54:00,521 [trainer.py] => dataset: vtab
2024-07-20 17:54:00,521 [trainer.py] => memory_size: 1000
2024-07-20 17:54:00,521 [trainer.py] => memory_per_class: 20
2024-07-20 17:54:00,521 [trainer.py] => fixed_memory: True
2024-07-20 17:54:00,521 [trainer.py] => shuffle: True
2024-07-20 17:54:00,521 [trainer.py] => init_cls: 10
2024-07-20 17:54:00,521 [trainer.py] => increment: 10
2024-07-20 17:54:00,521 [trainer.py] => model_name: der
2024-07-20 17:54:00,521 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-07-20 17:54:00,521 [trainer.py] => device: [device(type='cuda', index=0)]
2024-07-20 17:54:00,522 [trainer.py] => seed: 1993
2024-07-20 17:54:00,522 [trainer.py] => init_epoch: 20
2024-07-20 17:54:00,522 [trainer.py] => init_lr: 0.001
2024-07-20 17:54:00,522 [trainer.py] => init_milestones: [60, 120, 170]
2024-07-20 17:54:00,522 [trainer.py] => init_lr_decay: 0.1
2024-07-20 17:54:00,522 [trainer.py] => init_weight_decay: 0.0005
2024-07-20 17:54:00,522 [trainer.py] => epochs: 20
2024-07-20 17:54:00,522 [trainer.py] => lrate: 0.001
2024-07-20 17:54:00,522 [trainer.py] => milestones: [80, 120, 150]
2024-07-20 17:54:00,522 [trainer.py] => lrate_decay: 0.1
2024-07-20 17:54:00,522 [trainer.py] => batch_size: 48
2024-07-20 17:54:00,522 [trainer.py] => weight_decay: 0.0002
2024-07-20 17:54:00,522 [trainer.py] => T: 2
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-07-20 17:54:00,568 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-07-20 17:54:00,848 [trainer.py] => All params: 0
2024-07-20 17:54:00,848 [trainer.py] => Trainable params: 0
2024-07-20 17:54:09,397 [der.py] => Learning on 0-10
2024-07-20 17:54:09,399 [der.py] => All params: 85814805
2024-07-20 17:54:09,400 [der.py] => Trainable params: 85814805
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.571, Train_accy 22.98, Test_accy 22.15:   0%|          | 0/20 [00:05<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.571, Train_accy 22.98, Test_accy 22.15:   5%|▌         | 1/20 [00:05<01:41,  5.32s/it]Task 0, Epoch 2/20 => Loss 1.146, Train_accy 63.35:   5%|▌         | 1/20 [00:07<01:41,  5.32s/it]                 Task 0, Epoch 2/20 => Loss 1.146, Train_accy 63.35:  10%|█         | 2/20 [00:07<00:58,  3.27s/it]Task 0, Epoch 3/20 => Loss 0.574, Train_accy 85.09:  10%|█         | 2/20 [00:08<00:58,  3.27s/it]Task 0, Epoch 3/20 => Loss 0.574, Train_accy 85.09:  15%|█▌        | 3/20 [00:08<00:44,  2.60s/it]Task 0, Epoch 4/20 => Loss 1.092, Train_accy 73.91:  15%|█▌        | 3/20 [00:10<00:44,  2.60s/it]Task 0, Epoch 4/20 => Loss 1.092, Train_accy 73.91:  20%|██        | 4/20 [00:10<00:37,  2.33s/it]Task 0, Epoch 5/20 => Loss 0.614, Train_accy 80.12:  20%|██        | 4/20 [00:12<00:37,  2.33s/it]Task 0, Epoch 5/20 => Loss 0.614, Train_accy 80.12:  25%|██▌       | 5/20 [00:12<00:32,  2.15s/it]Task 0, Epoch 6/20 => Loss 0.323, Train_accy 89.44, Test_accy 80.63:  25%|██▌       | 5/20 [00:18<00:32,  2.15s/it]Task 0, Epoch 6/20 => Loss 0.323, Train_accy 89.44, Test_accy 80.63:  30%|███       | 6/20 [00:18<00:45,  3.23s/it]Task 0, Epoch 7/20 => Loss 0.342, Train_accy 86.96:  30%|███       | 6/20 [00:19<00:45,  3.23s/it]                 Task 0, Epoch 7/20 => Loss 0.342, Train_accy 86.96:  35%|███▌      | 7/20 [00:19<00:36,  2.79s/it]Task 0, Epoch 8/20 => Loss 0.153, Train_accy 93.17:  35%|███▌      | 7/20 [00:21<00:36,  2.79s/it]Task 0, Epoch 8/20 => Loss 0.153, Train_accy 93.17:  40%|████      | 8/20 [00:21<00:30,  2.53s/it]Task 0, Epoch 9/20 => Loss 0.160, Train_accy 95.03:  40%|████      | 8/20 [00:23<00:30,  2.53s/it]Task 0, Epoch 9/20 => Loss 0.160, Train_accy 95.03:  45%|████▌     | 9/20 [00:23<00:25,  2.33s/it]Task 0, Epoch 10/20 => Loss 0.335, Train_accy 91.93:  45%|████▌     | 9/20 [00:25<00:25,  2.33s/it]Task 0, Epoch 10/20 => Loss 0.335, Train_accy 91.93:  50%|█████     | 10/20 [00:25<00:21,  2.19s/it]Task 0, Epoch 11/20 => Loss 0.197, Train_accy 96.27, Test_accy 88.38:  50%|█████     | 10/20 [00:31<00:21,  2.19s/it]Task 0, Epoch 11/20 => Loss 0.197, Train_accy 96.27, Test_accy 88.38:  55%|█████▌    | 11/20 [00:31<00:29,  3.24s/it]Task 0, Epoch 12/20 => Loss 0.284, Train_accy 87.58:  55%|█████▌    | 11/20 [00:33<00:29,  3.24s/it]                 Task 0, Epoch 12/20 => Loss 0.284, Train_accy 87.58:  60%|██████    | 12/20 [00:33<00:23,  2.88s/it]Task 0, Epoch 13/20 => Loss 0.121, Train_accy 95.03:  60%|██████    | 12/20 [00:35<00:23,  2.88s/it]Task 0, Epoch 13/20 => Loss 0.121, Train_accy 95.03:  65%|██████▌   | 13/20 [00:35<00:18,  2.59s/it]Task 0, Epoch 14/20 => Loss 0.190, Train_accy 95.65:  65%|██████▌   | 13/20 [00:37<00:18,  2.59s/it]Task 0, Epoch 14/20 => Loss 0.190, Train_accy 95.65:  70%|███████   | 14/20 [00:37<00:14,  2.36s/it]Task 0, Epoch 15/20 => Loss 0.055, Train_accy 96.89:  70%|███████   | 14/20 [00:39<00:14,  2.36s/it]Task 0, Epoch 15/20 => Loss 0.055, Train_accy 96.89:  75%|███████▌  | 15/20 [00:39<00:11,  2.25s/it]Task 0, Epoch 16/20 => Loss 0.163, Train_accy 93.17, Test_accy 89.71:  75%|███████▌  | 15/20 [00:44<00:11,  2.25s/it]Task 0, Epoch 16/20 => Loss 0.163, Train_accy 93.17, Test_accy 89.71:  80%|████████  | 16/20 [00:44<00:12,  3.18s/it]Task 0, Epoch 17/20 => Loss 0.091, Train_accy 95.65:  80%|████████  | 16/20 [00:46<00:12,  3.18s/it]                 Task 0, Epoch 17/20 => Loss 0.091, Train_accy 95.65:  85%|████████▌ | 17/20 [00:46<00:08,  2.77s/it]Task 0, Epoch 18/20 => Loss 0.053, Train_accy 97.52:  85%|████████▌ | 17/20 [00:48<00:08,  2.77s/it]Task 0, Epoch 18/20 => Loss 0.053, Train_accy 97.52:  90%|█████████ | 18/20 [00:48<00:05,  2.51s/it]Task 0, Epoch 19/20 => Loss 0.028, Train_accy 98.76:  90%|█████████ | 18/20 [00:50<00:05,  2.51s/it]Task 0, Epoch 19/20 => Loss 0.028, Train_accy 98.76:  95%|█████████▌| 19/20 [00:50<00:02,  2.33s/it]Task 0, Epoch 20/20 => Loss 0.082, Train_accy 96.89:  95%|█████████▌| 19/20 [00:51<00:02,  2.33s/it]Task 0, Epoch 20/20 => Loss 0.082, Train_accy 96.89: 100%|██████████| 20/20 [00:51<00:00,  2.20s/it]Task 0, Epoch 20/20 => Loss 0.082, Train_accy 96.89: 100%|██████████| 20/20 [00:51<00:00,  2.60s/it]
2024-07-20 17:55:01,835 [der.py] => Task 0, Epoch 20/20 => Loss 0.082, Train_accy 96.89
2024-07-20 17:55:01,836 [base.py] => Constructing exemplars for new classes...(20 per classes)
Traceback (most recent call last):
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 25, in <module>
    main()
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 11, in main
    train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 19, in train
    _train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 73, in _train
    model.incremental_train(data_manager)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/der.py", line 75, in incremental_train
    self.build_rehearsal_memory(data_manager, self.samples_per_class)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/base.py", line 56, in build_rehearsal_memory
    self._construct_exemplar_unified(data_manager, per_class)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/base.py", line 362, in _construct_exemplar_unified
    i = np.argmin(np.sqrt(np.sum((class_mean - mu_p) ** 2, axis=1)))
  File "/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 1325, in argmin
    return _wrapfunc(a, 'argmin', axis=axis, out=out, **kwds)
  File "/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
    return bound(*args, **kwds)
ValueError: attempt to get argmin of an empty sequence
2024-07-20 17:55:06,006 [trainer.py] => config: ./exps/foster_vtab_B0_Inc5.json
2024-07-20 17:55:06,006 [trainer.py] => prefix: cil
2024-07-20 17:55:06,006 [trainer.py] => dataset: vtab
2024-07-20 17:55:06,006 [trainer.py] => memory_size: 1000
2024-07-20 17:55:06,006 [trainer.py] => memory_per_class: 20
2024-07-20 17:55:06,007 [trainer.py] => fixed_memory: True
2024-07-20 17:55:06,007 [trainer.py] => shuffle: True
2024-07-20 17:55:06,007 [trainer.py] => init_cls: 10
2024-07-20 17:55:06,007 [trainer.py] => increment: 10
2024-07-20 17:55:06,007 [trainer.py] => model_name: foster
2024-07-20 17:55:06,007 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-07-20 17:55:06,007 [trainer.py] => device: [device(type='cuda', index=0)]
2024-07-20 17:55:06,007 [trainer.py] => seed: 1993
2024-07-20 17:55:06,007 [trainer.py] => beta1: 0.96
2024-07-20 17:55:06,007 [trainer.py] => beta2: 0.97
2024-07-20 17:55:06,007 [trainer.py] => oofc: ft
2024-07-20 17:55:06,007 [trainer.py] => is_teacher_wa: False
2024-07-20 17:55:06,007 [trainer.py] => is_student_wa: False
2024-07-20 17:55:06,007 [trainer.py] => lambda_okd: 1
2024-07-20 17:55:06,007 [trainer.py] => wa_value: 1
2024-07-20 17:55:06,007 [trainer.py] => init_epochs: 20
2024-07-20 17:55:06,007 [trainer.py] => init_lr: 0.001
2024-07-20 17:55:06,007 [trainer.py] => init_weight_decay: 0.0005
2024-07-20 17:55:06,007 [trainer.py] => boosting_epochs: 20
2024-07-20 17:55:06,007 [trainer.py] => compression_epochs: 20
2024-07-20 17:55:06,007 [trainer.py] => lr: 0.001
2024-07-20 17:55:06,007 [trainer.py] => batch_size: 48
2024-07-20 17:55:06,007 [trainer.py] => weight_decay: 0.0005
2024-07-20 17:55:06,007 [trainer.py] => num_workers: 8
2024-07-20 17:55:06,007 [trainer.py] => T: 2
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-07-20 17:55:06,048 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
2024-07-20 17:55:06,406 [trainer.py] => All params: 0
2024-07-20 17:55:06,410 [trainer.py] => Trainable params: 0
2024-07-20 17:55:15,471 [foster.py] => Learning on 0-10
2024-07-20 17:55:15,472 [foster.py] => All params: 85814036
2024-07-20 17:55:15,473 [foster.py] => Trainable params: 85814036
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.600, Train_accy 22.98, Test_accy 37.53:   0%|          | 0/20 [00:05<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.600, Train_accy 22.98, Test_accy 37.53:   5%|▌         | 1/20 [00:05<01:39,  5.26s/it]Task 0, Epoch 2/20 => Loss 1.248, Train_accy 64.60:   5%|▌         | 1/20 [00:07<01:39,  5.26s/it]                 Task 0, Epoch 2/20 => Loss 1.248, Train_accy 64.60:  10%|█         | 2/20 [00:07<00:57,  3.20s/it]Task 0, Epoch 3/20 => Loss 0.523, Train_accy 85.09:  10%|█         | 2/20 [00:08<00:57,  3.20s/it]Task 0, Epoch 3/20 => Loss 0.523, Train_accy 85.09:  15%|█▌        | 3/20 [00:08<00:42,  2.49s/it]Task 0, Epoch 4/20 => Loss 0.276, Train_accy 91.30:  15%|█▌        | 3/20 [00:10<00:42,  2.49s/it]Task 0, Epoch 4/20 => Loss 0.276, Train_accy 91.30:  20%|██        | 4/20 [00:10<00:34,  2.16s/it]Task 0, Epoch 5/20 => Loss 0.201, Train_accy 93.79:  20%|██        | 4/20 [00:12<00:34,  2.16s/it]Task 0, Epoch 5/20 => Loss 0.201, Train_accy 93.79:  25%|██▌       | 5/20 [00:12<00:29,  2.00s/it]Task 0, Epoch 6/20 => Loss 0.256, Train_accy 91.93, Test_accy 95.04:  25%|██▌       | 5/20 [00:16<00:29,  2.00s/it]Task 0, Epoch 6/20 => Loss 0.256, Train_accy 91.93, Test_accy 95.04:  30%|███       | 6/20 [00:16<00:41,  2.94s/it]Task 0, Epoch 7/20 => Loss 0.143, Train_accy 95.03:  30%|███       | 6/20 [00:18<00:41,  2.94s/it]                 Task 0, Epoch 7/20 => Loss 0.143, Train_accy 95.03:  35%|███▌      | 7/20 [00:18<00:33,  2.55s/it]Task 0, Epoch 8/20 => Loss 0.101, Train_accy 96.27:  35%|███▌      | 7/20 [00:20<00:33,  2.55s/it]Task 0, Epoch 8/20 => Loss 0.101, Train_accy 96.27:  40%|████      | 8/20 [00:20<00:27,  2.27s/it]Task 0, Epoch 9/20 => Loss 0.123, Train_accy 96.27:  40%|████      | 8/20 [00:21<00:27,  2.27s/it]Task 0, Epoch 9/20 => Loss 0.123, Train_accy 96.27:  45%|████▌     | 9/20 [00:21<00:22,  2.09s/it]Task 0, Epoch 10/20 => Loss 0.117, Train_accy 96.89:  45%|████▌     | 9/20 [00:23<00:22,  2.09s/it]Task 0, Epoch 10/20 => Loss 0.117, Train_accy 96.89:  50%|█████     | 10/20 [00:23<00:19,  1.99s/it]Task 0, Epoch 11/20 => Loss 0.050, Train_accy 98.76, Test_accy 98.67:  50%|█████     | 10/20 [00:28<00:19,  1.99s/it]Task 0, Epoch 11/20 => Loss 0.050, Train_accy 98.76, Test_accy 98.67:  55%|█████▌    | 11/20 [00:28<00:26,  2.93s/it]Task 0, Epoch 12/20 => Loss 0.034, Train_accy 99.38:  55%|█████▌    | 11/20 [00:30<00:26,  2.93s/it]                 Task 0, Epoch 12/20 => Loss 0.034, Train_accy 99.38:  60%|██████    | 12/20 [00:30<00:20,  2.56s/it]Task 0, Epoch 13/20 => Loss 0.061, Train_accy 98.76:  60%|██████    | 12/20 [00:32<00:20,  2.56s/it]Task 0, Epoch 13/20 => Loss 0.061, Train_accy 98.76:  65%|██████▌   | 13/20 [00:32<00:16,  2.30s/it]Task 0, Epoch 14/20 => Loss 0.042, Train_accy 98.76:  65%|██████▌   | 13/20 [00:33<00:16,  2.30s/it]Task 0, Epoch 14/20 => Loss 0.042, Train_accy 98.76:  70%|███████   | 14/20 [00:33<00:12,  2.11s/it]Task 0, Epoch 15/20 => Loss 0.041, Train_accy 99.38:  70%|███████   | 14/20 [00:35<00:12,  2.11s/it]Task 0, Epoch 15/20 => Loss 0.041, Train_accy 99.38:  75%|███████▌  | 15/20 [00:35<00:09,  1.98s/it]Task 0, Epoch 16/20 => Loss 0.036, Train_accy 98.76, Test_accy 98.18:  75%|███████▌  | 15/20 [00:40<00:09,  1.98s/it]Task 0, Epoch 16/20 => Loss 0.036, Train_accy 98.76, Test_accy 98.18:  80%|████████  | 16/20 [00:40<00:12,  3.01s/it]Task 0, Epoch 17/20 => Loss 0.053, Train_accy 98.76:  80%|████████  | 16/20 [00:42<00:12,  3.01s/it]                 Task 0, Epoch 17/20 => Loss 0.053, Train_accy 98.76:  85%|████████▌ | 17/20 [00:42<00:07,  2.64s/it]Task 0, Epoch 18/20 => Loss 0.047, Train_accy 98.14:  85%|████████▌ | 17/20 [00:44<00:07,  2.64s/it]Task 0, Epoch 18/20 => Loss 0.047, Train_accy 98.14:  90%|█████████ | 18/20 [00:44<00:04,  2.36s/it]Task 0, Epoch 19/20 => Loss 0.007, Train_accy 100.00:  90%|█████████ | 18/20 [00:46<00:04,  2.36s/it]Task 0, Epoch 19/20 => Loss 0.007, Train_accy 100.00:  95%|█████████▌| 19/20 [00:46<00:02,  2.18s/it]Task 0, Epoch 20/20 => Loss 0.016, Train_accy 99.38:  95%|█████████▌| 19/20 [00:47<00:02,  2.18s/it] Task 0, Epoch 20/20 => Loss 0.016, Train_accy 99.38: 100%|██████████| 20/20 [00:47<00:00,  2.05s/it]Task 0, Epoch 20/20 => Loss 0.016, Train_accy 99.38: 100%|██████████| 20/20 [00:47<00:00,  2.39s/it]
2024-07-20 17:56:03,866 [foster.py] => Task 0, Epoch 20/20 => Loss 0.016, Train_accy 99.38
2024-07-20 17:56:03,868 [base.py] => Constructing exemplars for new classes...(20 per classes)
Traceback (most recent call last):
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 25, in <module>
    main()
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 11, in main
    train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 19, in train
    _train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 73, in _train
    model.incremental_train(data_manager)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/foster.py", line 95, in incremental_train
    self.build_rehearsal_memory(data_manager, self.samples_per_class)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/base.py", line 56, in build_rehearsal_memory
    self._construct_exemplar_unified(data_manager, per_class)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/base.py", line 362, in _construct_exemplar_unified
    i = np.argmin(np.sqrt(np.sum((class_mean - mu_p) ** 2, axis=1)))
  File "/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 1325, in argmin
    return _wrapfunc(a, 'argmin', axis=axis, out=out, **kwds)
  File "/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
    return bound(*args, **kwds)
ValueError: attempt to get argmin of an empty sequence

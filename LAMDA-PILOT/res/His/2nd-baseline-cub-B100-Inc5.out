nohup: 忽略输入
2024-04-29 11:39:52,848 [trainer.py] => config: ./exps/finetune_cub_B100_Inc5.json
2024-04-29 11:39:52,848 [trainer.py] => prefix: reproduce
2024-04-29 11:39:52,848 [trainer.py] => dataset: cub
2024-04-29 11:39:52,849 [trainer.py] => memory_size: 0
2024-04-29 11:39:52,849 [trainer.py] => memory_per_class: 0
2024-04-29 11:39:52,849 [trainer.py] => fixed_memory: False
2024-04-29 11:39:52,849 [trainer.py] => shuffle: True
2024-04-29 11:39:52,849 [trainer.py] => init_cls: 100
2024-04-29 11:39:52,849 [trainer.py] => increment: 20
2024-04-29 11:39:52,849 [trainer.py] => model_name: finetune
2024-04-29 11:39:52,849 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-29 11:39:52,849 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-29 11:39:52,849 [trainer.py] => seed: 1993
2024-04-29 11:39:52,849 [trainer.py] => init_epoch: 20
2024-04-29 11:39:52,849 [trainer.py] => init_lr: 0.001
2024-04-29 11:39:52,849 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-29 11:39:52,849 [trainer.py] => init_lr_decay: 0.1
2024-04-29 11:39:52,849 [trainer.py] => init_weight_decay: 0.0005
2024-04-29 11:39:52,849 [trainer.py] => epochs: 20
2024-04-29 11:39:52,849 [trainer.py] => lrate: 0.001
2024-04-29 11:39:52,849 [trainer.py] => milestones: [40, 70]
2024-04-29 11:39:52,849 [trainer.py] => lrate_decay: 0.1
2024-04-29 11:39:52,849 [trainer.py] => batch_size: 48
2024-04-29 11:39:52,849 [trainer.py] => weight_decay: 0.0002
2024-04-29 11:39:52,890 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-29 11:39:55,093 [trainer.py] => All params: 85798656
2024-04-29 11:39:55,094 [trainer.py] => Trainable params: 85798656
2024-04-29 11:39:55,095 [finetune.py] => Learning on 0-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.025, Train_accy 31.53, Test_accy 74.83:   0%|          | 0/20 [00:35<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.025, Train_accy 31.53, Test_accy 74.83:   5%|▌         | 1/20 [00:35<11:20, 35.80s/it]Task 0, Epoch 2/20 => Loss 0.941, Train_accy 73.67:   5%|▌         | 1/20 [01:07<11:20, 35.80s/it]                 Task 0, Epoch 2/20 => Loss 0.941, Train_accy 73.67:  10%|█         | 2/20 [01:07<09:57, 33.20s/it]Task 0, Epoch 3/20 => Loss 0.724, Train_accy 80.10:  10%|█         | 2/20 [01:38<09:57, 33.20s/it]Task 0, Epoch 3/20 => Loss 0.724, Train_accy 80.10:  15%|█▌        | 3/20 [01:38<09:11, 32.41s/it]Task 0, Epoch 4/20 => Loss 0.649, Train_accy 82.17:  15%|█▌        | 3/20 [02:10<09:11, 32.41s/it]Task 0, Epoch 4/20 => Loss 0.649, Train_accy 82.17:  20%|██        | 4/20 [02:10<08:33, 32.07s/it]Task 0, Epoch 5/20 => Loss 0.552, Train_accy 85.07:  20%|██        | 4/20 [02:41<08:33, 32.07s/it]Task 0, Epoch 5/20 => Loss 0.552, Train_accy 85.07:  25%|██▌       | 5/20 [02:41<07:58, 31.91s/it]Task 0, Epoch 6/20 => Loss 0.459, Train_accy 87.43, Test_accy 88.64:  25%|██▌       | 5/20 [03:16<07:58, 31.91s/it]Task 0, Epoch 6/20 => Loss 0.459, Train_accy 87.43, Test_accy 88.64:  30%|███       | 6/20 [03:16<07:41, 32.99s/it]Task 0, Epoch 7/20 => Loss 0.497, Train_accy 86.56:  30%|███       | 6/20 [03:48<07:41, 32.99s/it]                 Task 0, Epoch 7/20 => Loss 0.497, Train_accy 86.56:  35%|███▌      | 7/20 [03:48<07:02, 32.51s/it]Task 0, Epoch 8/20 => Loss 0.445, Train_accy 88.09:  35%|███▌      | 7/20 [04:19<07:02, 32.51s/it]Task 0, Epoch 8/20 => Loss 0.445, Train_accy 88.09:  40%|████      | 8/20 [04:19<06:26, 32.21s/it]Task 0, Epoch 9/20 => Loss 0.397, Train_accy 89.48:  40%|████      | 8/20 [04:51<06:26, 32.21s/it]Task 0, Epoch 9/20 => Loss 0.397, Train_accy 89.48:  45%|████▌     | 9/20 [04:51<05:52, 32.02s/it]Task 0, Epoch 10/20 => Loss 0.426, Train_accy 88.33:  45%|████▌     | 9/20 [05:23<05:52, 32.02s/it]Task 0, Epoch 10/20 => Loss 0.426, Train_accy 88.33:  50%|█████     | 10/20 [05:23<05:18, 31.86s/it]Task 0, Epoch 11/20 => Loss 0.382, Train_accy 89.82, Test_accy 88.97:  50%|█████     | 10/20 [05:58<05:18, 31.86s/it]Task 0, Epoch 11/20 => Loss 0.382, Train_accy 89.82, Test_accy 88.97:  55%|█████▌    | 11/20 [05:58<04:56, 32.91s/it]Task 0, Epoch 12/20 => Loss 0.395, Train_accy 89.16:  55%|█████▌    | 11/20 [06:30<04:56, 32.91s/it]                 Task 0, Epoch 12/20 => Loss 0.395, Train_accy 89.16:  60%|██████    | 12/20 [06:30<04:20, 32.52s/it]Task 0, Epoch 13/20 => Loss 0.358, Train_accy 90.18:  60%|██████    | 12/20 [07:01<04:20, 32.52s/it]Task 0, Epoch 13/20 => Loss 0.358, Train_accy 90.18:  65%|██████▌   | 13/20 [07:01<03:46, 32.29s/it]Task 0, Epoch 14/20 => Loss 0.385, Train_accy 89.63:  65%|██████▌   | 13/20 [07:33<03:46, 32.29s/it]Task 0, Epoch 14/20 => Loss 0.385, Train_accy 89.63:  70%|███████   | 14/20 [07:33<03:12, 32.14s/it]Task 0, Epoch 15/20 => Loss 0.357, Train_accy 90.63:  70%|███████   | 14/20 [08:05<03:12, 32.14s/it]Task 0, Epoch 15/20 => Loss 0.357, Train_accy 90.63:  75%|███████▌  | 15/20 [08:05<02:40, 32.01s/it]Task 0, Epoch 16/20 => Loss 0.340, Train_accy 90.90, Test_accy 88.97:  75%|███████▌  | 15/20 [08:40<02:40, 32.01s/it]Task 0, Epoch 16/20 => Loss 0.340, Train_accy 90.90, Test_accy 88.97:  80%|████████  | 16/20 [08:40<02:12, 33.03s/it]Task 0, Epoch 17/20 => Loss 0.335, Train_accy 91.18:  80%|████████  | 16/20 [09:12<02:12, 33.03s/it]                 Task 0, Epoch 17/20 => Loss 0.335, Train_accy 91.18:  85%|████████▌ | 17/20 [09:12<01:37, 32.59s/it]Task 0, Epoch 18/20 => Loss 0.362, Train_accy 90.58:  85%|████████▌ | 17/20 [09:44<01:37, 32.59s/it]Task 0, Epoch 18/20 => Loss 0.362, Train_accy 90.58:  90%|█████████ | 18/20 [09:44<01:04, 32.34s/it]Task 0, Epoch 19/20 => Loss 0.319, Train_accy 91.41:  90%|█████████ | 18/20 [10:15<01:04, 32.34s/it]Task 0, Epoch 19/20 => Loss 0.319, Train_accy 91.41:  95%|█████████▌| 19/20 [10:15<00:32, 32.13s/it]Task 0, Epoch 20/20 => Loss 0.326, Train_accy 91.37:  95%|█████████▌| 19/20 [10:47<00:32, 32.13s/it]Task 0, Epoch 20/20 => Loss 0.326, Train_accy 91.37: 100%|██████████| 20/20 [10:47<00:00, 32.03s/it]Task 0, Epoch 20/20 => Loss 0.326, Train_accy 91.37: 100%|██████████| 20/20 [10:47<00:00, 32.37s/it]
2024-04-29 11:50:42,989 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.326, Train_accy 91.37
2024-04-29 11:50:46,673 [trainer.py] => No NME accuracy.
2024-04-29 11:50:46,673 [trainer.py] => CNN: {'total': 89.48, '00-99': 89.48, 'old': 0, 'new': 89.48}
2024-04-29 11:50:46,674 [trainer.py] => CNN top1 curve: [89.48]
2024-04-29 11:50:46,674 [trainer.py] => CNN top5 curve: [98.23]

Average Accuracy (CNN): 89.48
2024-04-29 11:50:46,674 [trainer.py] => Average Accuracy (CNN): 89.48 

2024-04-29 11:50:46,674 [trainer.py] => Train Time: 1295.3400000000001
2024-04-29 11:50:46,674 [trainer.py] => Test Time: 3.68 

2024-04-29 11:50:46,675 [trainer.py] => All params: 85875556
2024-04-29 11:50:46,677 [trainer.py] => Trainable params: 85875556
2024-04-29 11:50:46,680 [finetune.py] => Learning on 100-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.392, Train_accy 16.18, Test_accy 80.44:   0%|          | 0/20 [00:11<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.392, Train_accy 16.18, Test_accy 80.44:   5%|▌         | 1/20 [00:11<03:35, 11.33s/it]Task 1, Epoch 2/20 => Loss 0.277, Train_accy 71.43:   5%|▌         | 1/20 [00:18<03:35, 11.33s/it]                 Task 1, Epoch 2/20 => Loss 0.277, Train_accy 71.43:  10%|█         | 2/20 [00:18<02:36,  8.67s/it]Task 1, Epoch 3/20 => Loss 0.168, Train_accy 81.72:  10%|█         | 2/20 [00:24<02:36,  8.67s/it]Task 1, Epoch 3/20 => Loss 0.168, Train_accy 81.72:  15%|█▌        | 3/20 [00:24<02:13,  7.84s/it]Task 1, Epoch 4/20 => Loss 0.224, Train_accy 82.98:  15%|█▌        | 3/20 [00:31<02:13,  7.84s/it]Task 1, Epoch 4/20 => Loss 0.224, Train_accy 82.98:  20%|██        | 4/20 [00:31<01:59,  7.46s/it]Task 1, Epoch 5/20 => Loss 0.208, Train_accy 82.35:  20%|██        | 4/20 [00:38<01:59,  7.46s/it]Task 1, Epoch 5/20 => Loss 0.208, Train_accy 82.35:  25%|██▌       | 5/20 [00:38<01:47,  7.18s/it]Task 1, Epoch 6/20 => Loss 0.184, Train_accy 83.82, Test_accy 80.01:  25%|██▌       | 5/20 [00:49<01:47,  7.18s/it]Task 1, Epoch 6/20 => Loss 0.184, Train_accy 83.82, Test_accy 80.01:  30%|███       | 6/20 [00:49<01:59,  8.51s/it]Task 1, Epoch 7/20 => Loss 0.132, Train_accy 87.08:  30%|███       | 6/20 [00:56<01:59,  8.51s/it]                 Task 1, Epoch 7/20 => Loss 0.132, Train_accy 87.08:  35%|███▌      | 7/20 [00:56<01:43,  7.94s/it]Task 1, Epoch 8/20 => Loss 0.157, Train_accy 85.29:  35%|███▌      | 7/20 [01:03<01:43,  7.94s/it]Task 1, Epoch 8/20 => Loss 0.157, Train_accy 85.29:  40%|████      | 8/20 [01:03<01:31,  7.59s/it]Task 1, Epoch 9/20 => Loss 0.152, Train_accy 86.76:  40%|████      | 8/20 [01:09<01:31,  7.59s/it]Task 1, Epoch 9/20 => Loss 0.152, Train_accy 86.76:  45%|████▌     | 9/20 [01:09<01:20,  7.31s/it]Task 1, Epoch 10/20 => Loss 0.134, Train_accy 85.50:  45%|████▌     | 9/20 [01:16<01:20,  7.31s/it]Task 1, Epoch 10/20 => Loss 0.134, Train_accy 85.50:  50%|█████     | 10/20 [01:16<01:11,  7.19s/it]Task 1, Epoch 11/20 => Loss 0.116, Train_accy 88.97, Test_accy 78.60:  50%|█████     | 10/20 [01:28<01:11,  7.19s/it]Task 1, Epoch 11/20 => Loss 0.116, Train_accy 88.97, Test_accy 78.60:  55%|█████▌    | 11/20 [01:28<01:15,  8.40s/it]Task 1, Epoch 12/20 => Loss 0.123, Train_accy 89.81:  55%|█████▌    | 11/20 [01:34<01:15,  8.40s/it]                 Task 1, Epoch 12/20 => Loss 0.123, Train_accy 89.81:  60%|██████    | 12/20 [01:34<01:03,  7.95s/it]Task 1, Epoch 13/20 => Loss 0.155, Train_accy 87.39:  60%|██████    | 12/20 [01:41<01:03,  7.95s/it]Task 1, Epoch 13/20 => Loss 0.155, Train_accy 87.39:  65%|██████▌   | 13/20 [01:41<00:53,  7.62s/it]Task 1, Epoch 14/20 => Loss 0.151, Train_accy 86.76:  65%|██████▌   | 13/20 [01:48<00:53,  7.62s/it]Task 1, Epoch 14/20 => Loss 0.151, Train_accy 86.76:  70%|███████   | 14/20 [01:48<00:44,  7.37s/it]Task 1, Epoch 15/20 => Loss 0.172, Train_accy 88.55:  70%|███████   | 14/20 [01:55<00:44,  7.37s/it]Task 1, Epoch 15/20 => Loss 0.172, Train_accy 88.55:  75%|███████▌  | 15/20 [01:55<00:36,  7.22s/it]Task 1, Epoch 16/20 => Loss 0.153, Train_accy 87.08, Test_accy 79.03:  75%|███████▌  | 15/20 [02:06<00:36,  7.22s/it]Task 1, Epoch 16/20 => Loss 0.153, Train_accy 87.08, Test_accy 79.03:  80%|████████  | 16/20 [02:06<00:33,  8.41s/it]Task 1, Epoch 17/20 => Loss 0.111, Train_accy 90.02:  80%|████████  | 16/20 [02:13<00:33,  8.41s/it]                 Task 1, Epoch 17/20 => Loss 0.111, Train_accy 90.02:  85%|████████▌ | 17/20 [02:13<00:23,  7.92s/it]Task 1, Epoch 18/20 => Loss 0.107, Train_accy 91.70:  85%|████████▌ | 17/20 [02:20<00:23,  7.92s/it]Task 1, Epoch 18/20 => Loss 0.107, Train_accy 91.70:  90%|█████████ | 18/20 [02:20<00:15,  7.59s/it]Task 1, Epoch 19/20 => Loss 0.143, Train_accy 89.81:  90%|█████████ | 18/20 [02:27<00:15,  7.59s/it]Task 1, Epoch 19/20 => Loss 0.143, Train_accy 89.81:  95%|█████████▌| 19/20 [02:27<00:07,  7.35s/it]Task 1, Epoch 20/20 => Loss 0.116, Train_accy 91.81:  95%|█████████▌| 19/20 [02:33<00:07,  7.35s/it]Task 1, Epoch 20/20 => Loss 0.116, Train_accy 91.81: 100%|██████████| 20/20 [02:33<00:00,  7.19s/it]Task 1, Epoch 20/20 => Loss 0.116, Train_accy 91.81: 100%|██████████| 20/20 [02:33<00:00,  7.69s/it]
2024-04-29 11:53:20,544 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.116, Train_accy 91.81
2024-04-29 11:53:24,907 [trainer.py] => No NME accuracy.
2024-04-29 11:53:24,907 [trainer.py] => CNN: {'total': 79.38, '00-99': 76.68, '100-119': 93.42, 'old': 76.68, 'new': 93.42}
2024-04-29 11:53:24,907 [trainer.py] => CNN top1 curve: [89.48, 79.38]
2024-04-29 11:53:24,908 [trainer.py] => CNN top5 curve: [98.23, 97.81]

Average Accuracy (CNN): 84.43
2024-04-29 11:53:24,908 [trainer.py] => Average Accuracy (CNN): 84.43 

2024-04-29 11:53:24,908 [trainer.py] => Train Time: 1449.2000000000003
2024-04-29 11:53:24,908 [trainer.py] => Test Time: 8.040000000000001 

2024-04-29 11:53:24,909 [trainer.py] => All params: 85890936
2024-04-29 11:53:24,911 [trainer.py] => Trainable params: 85890936
2024-04-29 11:53:24,914 [finetune.py] => Learning on 120-140
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.738, Train_accy 11.95, Test_accy 71.24:   0%|          | 0/20 [00:11<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.738, Train_accy 11.95, Test_accy 71.24:   5%|▌         | 1/20 [00:11<03:42, 11.72s/it]Task 2, Epoch 2/20 => Loss 0.470, Train_accy 66.77:   5%|▌         | 1/20 [00:18<03:42, 11.72s/it]                 Task 2, Epoch 2/20 => Loss 0.470, Train_accy 66.77:  10%|█         | 2/20 [00:18<02:38,  8.83s/it]Task 2, Epoch 3/20 => Loss 0.446, Train_accy 75.16:  10%|█         | 2/20 [00:25<02:38,  8.83s/it]Task 2, Epoch 3/20 => Loss 0.446, Train_accy 75.16:  15%|█▌        | 3/20 [00:25<02:14,  7.92s/it]Task 2, Epoch 4/20 => Loss 0.328, Train_accy 82.08:  15%|█▌        | 3/20 [00:32<02:14,  7.92s/it]Task 2, Epoch 4/20 => Loss 0.328, Train_accy 82.08:  20%|██        | 4/20 [00:32<01:59,  7.47s/it]Task 2, Epoch 5/20 => Loss 0.284, Train_accy 83.75:  20%|██        | 4/20 [00:39<01:59,  7.47s/it]Task 2, Epoch 5/20 => Loss 0.284, Train_accy 83.75:  25%|██▌       | 5/20 [00:39<01:48,  7.25s/it]Task 2, Epoch 6/20 => Loss 0.244, Train_accy 85.12, Test_accy 75.08:  25%|██▌       | 5/20 [00:50<01:48,  7.25s/it]Task 2, Epoch 6/20 => Loss 0.244, Train_accy 85.12, Test_accy 75.08:  30%|███       | 6/20 [00:50<02:02,  8.77s/it]Task 2, Epoch 7/20 => Loss 0.320, Train_accy 82.49:  30%|███       | 6/20 [00:57<02:02,  8.77s/it]                 Task 2, Epoch 7/20 => Loss 0.320, Train_accy 82.49:  35%|███▌      | 7/20 [00:57<01:45,  8.13s/it]Task 2, Epoch 8/20 => Loss 0.206, Train_accy 85.22:  35%|███▌      | 7/20 [01:04<01:45,  8.13s/it]Task 2, Epoch 8/20 => Loss 0.206, Train_accy 85.22:  40%|████      | 8/20 [01:04<01:31,  7.66s/it]Task 2, Epoch 9/20 => Loss 0.232, Train_accy 87.32:  40%|████      | 8/20 [01:10<01:31,  7.66s/it]Task 2, Epoch 9/20 => Loss 0.232, Train_accy 87.32:  45%|████▌     | 9/20 [01:10<01:21,  7.38s/it]Task 2, Epoch 10/20 => Loss 0.219, Train_accy 87.63:  45%|████▌     | 9/20 [01:17<01:21,  7.38s/it]Task 2, Epoch 10/20 => Loss 0.219, Train_accy 87.63:  50%|█████     | 10/20 [01:17<01:11,  7.17s/it]Task 2, Epoch 11/20 => Loss 0.199, Train_accy 88.26, Test_accy 77.45:  50%|█████     | 10/20 [01:29<01:11,  7.17s/it]Task 2, Epoch 11/20 => Loss 0.199, Train_accy 88.26, Test_accy 77.45:  55%|█████▌    | 11/20 [01:29<01:16,  8.46s/it]Task 2, Epoch 12/20 => Loss 0.223, Train_accy 88.05:  55%|█████▌    | 11/20 [01:35<01:16,  8.46s/it]                 Task 2, Epoch 12/20 => Loss 0.223, Train_accy 88.05:  60%|██████    | 12/20 [01:35<01:03,  7.92s/it]Task 2, Epoch 13/20 => Loss 0.216, Train_accy 87.95:  60%|██████    | 12/20 [01:42<01:03,  7.92s/it]Task 2, Epoch 13/20 => Loss 0.216, Train_accy 87.95:  65%|██████▌   | 13/20 [01:42<00:53,  7.62s/it]Task 2, Epoch 14/20 => Loss 0.212, Train_accy 87.74:  65%|██████▌   | 13/20 [01:49<00:53,  7.62s/it]Task 2, Epoch 14/20 => Loss 0.212, Train_accy 87.74:  70%|███████   | 14/20 [01:49<00:44,  7.37s/it]Task 2, Epoch 15/20 => Loss 0.213, Train_accy 88.57:  70%|███████   | 14/20 [01:56<00:44,  7.37s/it]Task 2, Epoch 15/20 => Loss 0.213, Train_accy 88.57:  75%|███████▌  | 15/20 [01:56<00:35,  7.17s/it]Task 2, Epoch 16/20 => Loss 0.192, Train_accy 89.41, Test_accy 75.99:  75%|███████▌  | 15/20 [02:07<00:35,  7.17s/it]Task 2, Epoch 16/20 => Loss 0.192, Train_accy 89.41, Test_accy 75.99:  80%|████████  | 16/20 [02:07<00:34,  8.51s/it]Task 2, Epoch 17/20 => Loss 0.215, Train_accy 87.53:  80%|████████  | 16/20 [02:14<00:34,  8.51s/it]                 Task 2, Epoch 17/20 => Loss 0.215, Train_accy 87.53:  85%|████████▌ | 17/20 [02:14<00:23,  7.99s/it]Task 2, Epoch 18/20 => Loss 0.162, Train_accy 89.62:  85%|████████▌ | 17/20 [02:21<00:23,  7.99s/it]Task 2, Epoch 18/20 => Loss 0.162, Train_accy 89.62:  90%|█████████ | 18/20 [02:21<00:15,  7.62s/it]Task 2, Epoch 19/20 => Loss 0.189, Train_accy 88.26:  90%|█████████ | 18/20 [02:28<00:15,  7.62s/it]Task 2, Epoch 19/20 => Loss 0.189, Train_accy 88.26:  95%|█████████▌| 19/20 [02:28<00:07,  7.37s/it]Task 2, Epoch 20/20 => Loss 0.208, Train_accy 88.89:  95%|█████████▌| 19/20 [02:35<00:07,  7.37s/it]Task 2, Epoch 20/20 => Loss 0.208, Train_accy 88.89: 100%|██████████| 20/20 [02:35<00:00,  7.23s/it]Task 2, Epoch 20/20 => Loss 0.208, Train_accy 88.89: 100%|██████████| 20/20 [02:35<00:00,  7.75s/it]
2024-04-29 11:55:59,929 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.208, Train_accy 88.89
2024-04-29 11:56:04,717 [trainer.py] => No NME accuracy.
2024-04-29 11:56:04,717 [trainer.py] => CNN: {'total': 74.41, '00-99': 68.94, '100-119': 86.4, '120-139': 91.11, 'old': 71.75, 'new': 91.11}
2024-04-29 11:56:04,717 [trainer.py] => CNN top1 curve: [89.48, 79.38, 74.41]
2024-04-29 11:56:04,718 [trainer.py] => CNN top5 curve: [98.23, 97.81, 96.77]

Average Accuracy (CNN): 81.09
2024-04-29 11:56:04,718 [trainer.py] => Average Accuracy (CNN): 81.09 

2024-04-29 11:56:04,718 [trainer.py] => Train Time: 1604.2100000000003
2024-04-29 11:56:04,718 [trainer.py] => Test Time: 12.830000000000002 

2024-04-29 11:56:04,719 [trainer.py] => All params: 85906316
2024-04-29 11:56:04,719 [trainer.py] => Trainable params: 85906316
2024-04-29 11:56:04,722 [finetune.py] => Learning on 140-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.412, Train_accy 13.70, Test_accy 68.91:   0%|          | 0/20 [00:12<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.412, Train_accy 13.70, Test_accy 68.91:   5%|▌         | 1/20 [00:12<03:55, 12.42s/it]Task 3, Epoch 2/20 => Loss 0.406, Train_accy 60.00:   5%|▌         | 1/20 [00:19<03:55, 12.42s/it]                 Task 3, Epoch 2/20 => Loss 0.406, Train_accy 60.00:  10%|█         | 2/20 [00:19<02:42,  9.04s/it]Task 3, Epoch 3/20 => Loss 0.291, Train_accy 72.07:  10%|█         | 2/20 [00:25<02:42,  9.04s/it]Task 3, Epoch 3/20 => Loss 0.291, Train_accy 72.07:  15%|█▌        | 3/20 [00:25<02:14,  7.93s/it]Task 3, Epoch 4/20 => Loss 0.241, Train_accy 77.17:  15%|█▌        | 3/20 [00:32<02:14,  7.93s/it]Task 3, Epoch 4/20 => Loss 0.241, Train_accy 77.17:  20%|██        | 4/20 [00:32<02:00,  7.50s/it]Task 3, Epoch 5/20 => Loss 0.221, Train_accy 77.17:  20%|██        | 4/20 [00:39<02:00,  7.50s/it]Task 3, Epoch 5/20 => Loss 0.221, Train_accy 77.17:  25%|██▌       | 5/20 [00:39<01:48,  7.22s/it]Task 3, Epoch 6/20 => Loss 0.190, Train_accy 76.30, Test_accy 70.28:  25%|██▌       | 5/20 [00:51<01:48,  7.22s/it]Task 3, Epoch 6/20 => Loss 0.190, Train_accy 76.30, Test_accy 70.28:  30%|███       | 6/20 [00:51<02:04,  8.89s/it]Task 3, Epoch 7/20 => Loss 0.219, Train_accy 77.83:  30%|███       | 6/20 [00:58<02:04,  8.89s/it]                 Task 3, Epoch 7/20 => Loss 0.219, Train_accy 77.83:  35%|███▌      | 7/20 [00:58<01:46,  8.18s/it]Task 3, Epoch 8/20 => Loss 0.213, Train_accy 76.85:  35%|███▌      | 7/20 [01:04<01:46,  8.18s/it]Task 3, Epoch 8/20 => Loss 0.213, Train_accy 76.85:  40%|████      | 8/20 [01:04<01:32,  7.69s/it]Task 3, Epoch 9/20 => Loss 0.218, Train_accy 77.50:  40%|████      | 8/20 [01:11<01:32,  7.69s/it]Task 3, Epoch 9/20 => Loss 0.218, Train_accy 77.50:  45%|████▌     | 9/20 [01:11<01:21,  7.38s/it]Task 3, Epoch 10/20 => Loss 0.223, Train_accy 77.39:  45%|████▌     | 9/20 [01:18<01:21,  7.38s/it]Task 3, Epoch 10/20 => Loss 0.223, Train_accy 77.39:  50%|█████     | 10/20 [01:18<01:11,  7.18s/it]Task 3, Epoch 11/20 => Loss 0.181, Train_accy 78.15, Test_accy 70.49:  50%|█████     | 10/20 [01:30<01:11,  7.18s/it]Task 3, Epoch 11/20 => Loss 0.181, Train_accy 78.15, Test_accy 70.49:  55%|█████▌    | 11/20 [01:30<01:18,  8.69s/it]Task 3, Epoch 12/20 => Loss 0.198, Train_accy 77.72:  55%|█████▌    | 11/20 [01:37<01:18,  8.69s/it]                 Task 3, Epoch 12/20 => Loss 0.198, Train_accy 77.72:  60%|██████    | 12/20 [01:37<01:04,  8.09s/it]Task 3, Epoch 13/20 => Loss 0.186, Train_accy 80.33:  60%|██████    | 12/20 [01:43<01:04,  8.09s/it]Task 3, Epoch 13/20 => Loss 0.186, Train_accy 80.33:  65%|██████▌   | 13/20 [01:43<00:53,  7.65s/it]Task 3, Epoch 14/20 => Loss 0.186, Train_accy 82.17:  65%|██████▌   | 13/20 [01:50<00:53,  7.65s/it]Task 3, Epoch 14/20 => Loss 0.186, Train_accy 82.17:  70%|███████   | 14/20 [01:50<00:43,  7.33s/it]Task 3, Epoch 15/20 => Loss 0.147, Train_accy 83.91:  70%|███████   | 14/20 [01:56<00:43,  7.33s/it]Task 3, Epoch 15/20 => Loss 0.147, Train_accy 83.91:  75%|███████▌  | 15/20 [01:56<00:35,  7.09s/it]Task 3, Epoch 16/20 => Loss 0.112, Train_accy 85.43, Test_accy 69.70:  75%|███████▌  | 15/20 [02:08<00:35,  7.09s/it]Task 3, Epoch 16/20 => Loss 0.112, Train_accy 85.43, Test_accy 69.70:  80%|████████  | 16/20 [02:08<00:34,  8.54s/it]Task 3, Epoch 17/20 => Loss 0.211, Train_accy 83.04:  80%|████████  | 16/20 [02:15<00:34,  8.54s/it]                 Task 3, Epoch 17/20 => Loss 0.211, Train_accy 83.04:  85%|████████▌ | 17/20 [02:15<00:23,  7.99s/it]Task 3, Epoch 18/20 => Loss 0.139, Train_accy 85.87:  85%|████████▌ | 17/20 [02:22<00:23,  7.99s/it]Task 3, Epoch 18/20 => Loss 0.139, Train_accy 85.87:  90%|█████████ | 18/20 [02:22<00:15,  7.57s/it]Task 3, Epoch 19/20 => Loss 0.190, Train_accy 85.76:  90%|█████████ | 18/20 [02:28<00:15,  7.57s/it]Task 3, Epoch 19/20 => Loss 0.190, Train_accy 85.76:  95%|█████████▌| 19/20 [02:28<00:07,  7.28s/it]Task 3, Epoch 20/20 => Loss 0.194, Train_accy 82.28:  95%|█████████▌| 19/20 [02:35<00:07,  7.28s/it]Task 3, Epoch 20/20 => Loss 0.194, Train_accy 82.28: 100%|██████████| 20/20 [02:35<00:00,  7.09s/it]Task 3, Epoch 20/20 => Loss 0.194, Train_accy 82.28: 100%|██████████| 20/20 [02:35<00:00,  7.76s/it]
2024-04-29 11:58:39,970 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.194, Train_accy 82.28
2024-04-29 11:58:45,521 [trainer.py] => No NME accuracy.
2024-04-29 11:58:45,522 [trainer.py] => CNN: {'total': 69.86, '00-99': 62.21, '100-119': 82.02, '120-139': 80.44, '140-159': 85.6, 'old': 67.46, 'new': 85.6}
2024-04-29 11:58:45,522 [trainer.py] => CNN top1 curve: [89.48, 79.38, 74.41, 69.86]
2024-04-29 11:58:45,522 [trainer.py] => CNN top5 curve: [98.23, 97.81, 96.77, 96.19]

Average Accuracy (CNN): 78.28
2024-04-29 11:58:45,522 [trainer.py] => Average Accuracy (CNN): 78.28 

2024-04-29 11:58:45,522 [trainer.py] => Train Time: 1759.4500000000003
2024-04-29 11:58:45,522 [trainer.py] => Test Time: 18.380000000000003 

2024-04-29 11:58:45,523 [trainer.py] => All params: 85921696
2024-04-29 11:58:45,524 [trainer.py] => Trainable params: 85921696
2024-04-29 11:58:45,528 [finetune.py] => Learning on 160-180
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.659, Train_accy 7.72, Test_accy 63.20:   0%|          | 0/20 [00:13<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.659, Train_accy 7.72, Test_accy 63.20:   5%|▌         | 1/20 [00:13<04:08, 13.06s/it]Task 4, Epoch 2/20 => Loss 0.372, Train_accy 63.36:   5%|▌         | 1/20 [00:19<04:08, 13.06s/it]                Task 4, Epoch 2/20 => Loss 0.372, Train_accy 63.36:  10%|█         | 2/20 [00:19<02:49,  9.43s/it]Task 4, Epoch 3/20 => Loss 0.235, Train_accy 75.47:  10%|█         | 2/20 [00:26<02:49,  9.43s/it]Task 4, Epoch 3/20 => Loss 0.235, Train_accy 75.47:  15%|█▌        | 3/20 [00:26<02:21,  8.34s/it]Task 4, Epoch 4/20 => Loss 0.250, Train_accy 74.74:  15%|█▌        | 3/20 [00:33<02:21,  8.34s/it]Task 4, Epoch 4/20 => Loss 0.250, Train_accy 74.74:  20%|██        | 4/20 [00:33<02:04,  7.79s/it]Task 4, Epoch 5/20 => Loss 0.190, Train_accy 77.45:  20%|██        | 4/20 [00:40<02:04,  7.79s/it]Task 4, Epoch 5/20 => Loss 0.190, Train_accy 77.45:  25%|██▌       | 5/20 [00:40<01:51,  7.43s/it]Task 4, Epoch 6/20 => Loss 0.244, Train_accy 79.02, Test_accy 62.50:  25%|██▌       | 5/20 [00:53<01:51,  7.43s/it]Task 4, Epoch 6/20 => Loss 0.244, Train_accy 79.02, Test_accy 62.50:  30%|███       | 6/20 [00:53<02:10,  9.34s/it]Task 4, Epoch 7/20 => Loss 0.191, Train_accy 79.02:  30%|███       | 6/20 [01:00<02:10,  9.34s/it]                 Task 4, Epoch 7/20 => Loss 0.191, Train_accy 79.02:  35%|███▌      | 7/20 [01:00<01:50,  8.52s/it]Task 4, Epoch 8/20 => Loss 0.181, Train_accy 81.11:  35%|███▌      | 7/20 [01:07<01:50,  8.52s/it]Task 4, Epoch 8/20 => Loss 0.181, Train_accy 81.11:  40%|████      | 8/20 [01:07<01:36,  8.02s/it]Task 4, Epoch 9/20 => Loss 0.172, Train_accy 81.84:  40%|████      | 8/20 [01:14<01:36,  8.02s/it]Task 4, Epoch 9/20 => Loss 0.172, Train_accy 81.84:  45%|████▌     | 9/20 [01:14<01:24,  7.64s/it]Task 4, Epoch 10/20 => Loss 0.233, Train_accy 81.52:  45%|████▌     | 9/20 [01:21<01:24,  7.64s/it]Task 4, Epoch 10/20 => Loss 0.233, Train_accy 81.52:  50%|█████     | 10/20 [01:21<01:14,  7.40s/it]Task 4, Epoch 11/20 => Loss 0.176, Train_accy 81.94, Test_accy 64.71:  50%|█████     | 10/20 [01:34<01:14,  7.40s/it]Task 4, Epoch 11/20 => Loss 0.176, Train_accy 81.94, Test_accy 64.71:  55%|█████▌    | 11/20 [01:34<01:21,  9.10s/it]Task 4, Epoch 12/20 => Loss 0.134, Train_accy 85.39:  55%|█████▌    | 11/20 [01:41<01:21,  9.10s/it]                 Task 4, Epoch 12/20 => Loss 0.134, Train_accy 85.39:  60%|██████    | 12/20 [01:41<01:07,  8.43s/it]Task 4, Epoch 13/20 => Loss 0.153, Train_accy 86.22:  60%|██████    | 12/20 [01:47<01:07,  8.43s/it]Task 4, Epoch 13/20 => Loss 0.153, Train_accy 86.22:  65%|██████▌   | 13/20 [01:47<00:55,  7.95s/it]Task 4, Epoch 14/20 => Loss 0.154, Train_accy 85.59:  65%|██████▌   | 13/20 [01:54<00:55,  7.95s/it]Task 4, Epoch 14/20 => Loss 0.154, Train_accy 85.59:  70%|███████   | 14/20 [01:54<00:45,  7.61s/it]Task 4, Epoch 15/20 => Loss 0.174, Train_accy 85.39:  70%|███████   | 14/20 [02:01<00:45,  7.61s/it]Task 4, Epoch 15/20 => Loss 0.174, Train_accy 85.39:  75%|███████▌  | 15/20 [02:01<00:36,  7.38s/it]Task 4, Epoch 16/20 => Loss 0.170, Train_accy 84.45, Test_accy 64.47:  75%|███████▌  | 15/20 [02:14<00:36,  7.38s/it]Task 4, Epoch 16/20 => Loss 0.170, Train_accy 84.45, Test_accy 64.47:  80%|████████  | 16/20 [02:14<00:36,  9.08s/it]Task 4, Epoch 17/20 => Loss 0.149, Train_accy 86.12:  80%|████████  | 16/20 [02:21<00:36,  9.08s/it]                 Task 4, Epoch 17/20 => Loss 0.149, Train_accy 86.12:  85%|████████▌ | 17/20 [02:21<00:25,  8.42s/it]Task 4, Epoch 18/20 => Loss 0.156, Train_accy 86.01:  85%|████████▌ | 17/20 [02:28<00:25,  8.42s/it]Task 4, Epoch 18/20 => Loss 0.156, Train_accy 86.01:  90%|█████████ | 18/20 [02:28<00:15,  7.97s/it]Task 4, Epoch 19/20 => Loss 0.168, Train_accy 84.34:  90%|█████████ | 18/20 [02:35<00:15,  7.97s/it]Task 4, Epoch 19/20 => Loss 0.168, Train_accy 84.34:  95%|█████████▌| 19/20 [02:35<00:07,  7.64s/it]Task 4, Epoch 20/20 => Loss 0.145, Train_accy 84.76:  95%|█████████▌| 19/20 [02:42<00:07,  7.64s/it]Task 4, Epoch 20/20 => Loss 0.145, Train_accy 84.76: 100%|██████████| 20/20 [02:42<00:00,  7.39s/it]Task 4, Epoch 20/20 => Loss 0.145, Train_accy 84.76: 100%|██████████| 20/20 [02:42<00:00,  8.11s/it]
2024-04-29 12:01:27,664 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.145, Train_accy 84.76
2024-04-29 12:01:33,747 [trainer.py] => No NME accuracy.
2024-04-29 12:01:33,748 [trainer.py] => CNN: {'total': 64.24, '00-99': 55.05, '100-119': 75.44, '120-139': 64.0, '140-159': 72.0, '160-179': 91.56, 'old': 60.81, 'new': 91.56}
2024-04-29 12:01:33,748 [trainer.py] => CNN top1 curve: [89.48, 79.38, 74.41, 69.86, 64.24]
2024-04-29 12:01:33,748 [trainer.py] => CNN top5 curve: [98.23, 97.81, 96.77, 96.19, 94.22]

Average Accuracy (CNN): 75.47
2024-04-29 12:01:33,748 [trainer.py] => Average Accuracy (CNN): 75.47 

2024-04-29 12:01:33,748 [trainer.py] => Train Time: 1921.5800000000004
2024-04-29 12:01:33,748 [trainer.py] => Test Time: 24.46 

2024-04-29 12:01:33,750 [trainer.py] => All params: 85937076
2024-04-29 12:01:33,751 [trainer.py] => Trainable params: 85937076
2024-04-29 12:01:33,756 [finetune.py] => Learning on 180-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.784, Train_accy 7.04, Test_accy 51.23:   0%|          | 0/20 [00:13<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.784, Train_accy 7.04, Test_accy 51.23:   5%|▌         | 1/20 [00:13<04:16, 13.48s/it]Task 5, Epoch 2/20 => Loss 0.431, Train_accy 55.36:   5%|▌         | 1/20 [00:20<04:16, 13.48s/it]                Task 5, Epoch 2/20 => Loss 0.431, Train_accy 55.36:  10%|█         | 2/20 [00:20<02:50,  9.47s/it]Task 5, Epoch 3/20 => Loss 0.300, Train_accy 74.89:  10%|█         | 2/20 [00:26<02:50,  9.47s/it]Task 5, Epoch 3/20 => Loss 0.300, Train_accy 74.89:  15%|█▌        | 3/20 [00:26<02:19,  8.20s/it]Task 5, Epoch 4/20 => Loss 0.240, Train_accy 78.36:  15%|█▌        | 3/20 [00:33<02:19,  8.20s/it]Task 5, Epoch 4/20 => Loss 0.240, Train_accy 78.36:  20%|██        | 4/20 [00:33<02:03,  7.70s/it]Task 5, Epoch 5/20 => Loss 0.287, Train_accy 79.20:  20%|██        | 4/20 [00:40<02:03,  7.70s/it]Task 5, Epoch 5/20 => Loss 0.287, Train_accy 79.20:  25%|██▌       | 5/20 [00:40<01:50,  7.39s/it]Task 5, Epoch 6/20 => Loss 0.236, Train_accy 81.83, Test_accy 59.41:  25%|██▌       | 5/20 [00:54<01:50,  7.39s/it]Task 5, Epoch 6/20 => Loss 0.236, Train_accy 81.83, Test_accy 59.41:  30%|███       | 6/20 [00:54<02:13,  9.51s/it]Task 5, Epoch 7/20 => Loss 0.257, Train_accy 80.46:  30%|███       | 6/20 [01:01<02:13,  9.51s/it]                 Task 5, Epoch 7/20 => Loss 0.257, Train_accy 80.46:  35%|███▌      | 7/20 [01:01<01:52,  8.63s/it]Task 5, Epoch 8/20 => Loss 0.206, Train_accy 82.14:  35%|███▌      | 7/20 [01:07<01:52,  8.63s/it]Task 5, Epoch 8/20 => Loss 0.206, Train_accy 82.14:  40%|████      | 8/20 [01:07<01:36,  8.06s/it]Task 5, Epoch 9/20 => Loss 0.202, Train_accy 82.25:  40%|████      | 8/20 [01:14<01:36,  8.06s/it]Task 5, Epoch 9/20 => Loss 0.202, Train_accy 82.25:  45%|████▌     | 9/20 [01:14<01:24,  7.64s/it]Task 5, Epoch 10/20 => Loss 0.203, Train_accy 82.56:  45%|████▌     | 9/20 [01:21<01:24,  7.64s/it]Task 5, Epoch 10/20 => Loss 0.203, Train_accy 82.56:  50%|█████     | 10/20 [01:21<01:13,  7.37s/it]Task 5, Epoch 11/20 => Loss 0.166, Train_accy 84.24, Test_accy 60.69:  50%|█████     | 10/20 [01:34<01:13,  7.37s/it]Task 5, Epoch 11/20 => Loss 0.166, Train_accy 84.24, Test_accy 60.69:  55%|█████▌    | 11/20 [01:34<01:22,  9.20s/it]Task 5, Epoch 12/20 => Loss 0.205, Train_accy 84.35:  55%|█████▌    | 11/20 [01:41<01:22,  9.20s/it]                 Task 5, Epoch 12/20 => Loss 0.205, Train_accy 84.35:  60%|██████    | 12/20 [01:41<01:07,  8.45s/it]Task 5, Epoch 13/20 => Loss 0.181, Train_accy 86.34:  60%|██████    | 12/20 [01:48<01:07,  8.45s/it]Task 5, Epoch 13/20 => Loss 0.181, Train_accy 86.34:  65%|██████▌   | 13/20 [01:48<00:55,  7.97s/it]Task 5, Epoch 14/20 => Loss 0.178, Train_accy 87.39:  65%|██████▌   | 13/20 [01:55<00:55,  7.97s/it]Task 5, Epoch 14/20 => Loss 0.178, Train_accy 87.39:  70%|███████   | 14/20 [01:55<00:45,  7.63s/it]Task 5, Epoch 15/20 => Loss 0.128, Train_accy 89.60:  70%|███████   | 14/20 [02:01<00:45,  7.63s/it]Task 5, Epoch 15/20 => Loss 0.128, Train_accy 89.60:  75%|███████▌  | 15/20 [02:01<00:36,  7.38s/it]Task 5, Epoch 16/20 => Loss 0.133, Train_accy 87.61, Test_accy 62.09:  75%|███████▌  | 15/20 [02:15<00:36,  7.38s/it]Task 5, Epoch 16/20 => Loss 0.133, Train_accy 87.61, Test_accy 62.09:  80%|████████  | 16/20 [02:15<00:37,  9.25s/it]Task 5, Epoch 17/20 => Loss 0.156, Train_accy 87.50:  80%|████████  | 16/20 [02:22<00:37,  9.25s/it]                 Task 5, Epoch 17/20 => Loss 0.156, Train_accy 87.50:  85%|████████▌ | 17/20 [02:22<00:25,  8.56s/it]Task 5, Epoch 18/20 => Loss 0.169, Train_accy 86.97:  85%|████████▌ | 17/20 [02:29<00:25,  8.56s/it]Task 5, Epoch 18/20 => Loss 0.169, Train_accy 86.97:  90%|█████████ | 18/20 [02:29<00:16,  8.07s/it]Task 5, Epoch 19/20 => Loss 0.161, Train_accy 87.92:  90%|█████████ | 18/20 [02:36<00:16,  8.07s/it]Task 5, Epoch 19/20 => Loss 0.161, Train_accy 87.92:  95%|█████████▌| 19/20 [02:36<00:07,  7.66s/it]Task 5, Epoch 20/20 => Loss 0.136, Train_accy 87.82:  95%|█████████▌| 19/20 [02:43<00:07,  7.66s/it]Task 5, Epoch 20/20 => Loss 0.136, Train_accy 87.82: 100%|██████████| 20/20 [02:43<00:00,  7.46s/it]Task 5, Epoch 20/20 => Loss 0.136, Train_accy 87.82: 100%|██████████| 20/20 [02:43<00:00,  8.16s/it]
2024-04-29 12:04:16,894 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.136, Train_accy 87.82
2024-04-29 12:04:23,291 [trainer.py] => No NME accuracy.
2024-04-29 12:04:23,291 [trainer.py] => CNN: {'total': 62.09, '00-99': 49.49, '100-119': 72.81, '120-139': 64.44, '140-159': 71.2, '160-179': 76.37, '180-199': 89.57, 'old': 59.12, 'new': 89.57}
2024-04-29 12:04:23,291 [trainer.py] => CNN top1 curve: [89.48, 79.38, 74.41, 69.86, 64.24, 62.09]
2024-04-29 12:04:23,291 [trainer.py] => CNN top5 curve: [98.23, 97.81, 96.77, 96.19, 94.22, 92.83]

Average Accuracy (CNN): 73.24
2024-04-29 12:04:23,291 [trainer.py] => Average Accuracy (CNN): 73.24 

2024-04-29 12:04:23,291 [trainer.py] => Train Time: 2084.7100000000005
2024-04-29 12:04:23,291 [trainer.py] => Test Time: 30.86 

Accuracy Matrix (CNN):
[[89.48 76.68 68.94 62.21 55.05 49.49]
 [ 0.   93.42 86.4  82.02 75.44 72.81]
 [ 0.    0.   91.11 80.44 64.   64.44]
 [ 0.    0.    0.   85.6  72.   71.2 ]
 [ 0.    0.    0.    0.   91.56 76.37]
 [ 0.    0.    0.    0.    0.   89.57]]
2024-04-29 12:04:23,292 [trainer.py] => Forgetting (CNN): 23.372
2024-04-29 12:04:26,269 [trainer.py] => config: ./exps/icarl_cub_B100_Inc5.json
2024-04-29 12:04:26,269 [trainer.py] => prefix: reproduce
2024-04-29 12:04:26,270 [trainer.py] => dataset: cub
2024-04-29 12:04:26,270 [trainer.py] => memory_size: 4000
2024-04-29 12:04:26,270 [trainer.py] => memory_per_class: 20
2024-04-29 12:04:26,270 [trainer.py] => fixed_memory: True
2024-04-29 12:04:26,270 [trainer.py] => shuffle: True
2024-04-29 12:04:26,270 [trainer.py] => init_cls: 100
2024-04-29 12:04:26,270 [trainer.py] => increment: 20
2024-04-29 12:04:26,270 [trainer.py] => model_name: icarl
2024-04-29 12:04:26,270 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-29 12:04:26,270 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-29 12:04:26,270 [trainer.py] => seed: 1993
2024-04-29 12:04:26,270 [trainer.py] => init_epoch: 20
2024-04-29 12:04:26,270 [trainer.py] => init_lr: 0.001
2024-04-29 12:04:26,270 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-29 12:04:26,270 [trainer.py] => init_lr_decay: 0.1
2024-04-29 12:04:26,270 [trainer.py] => init_weight_decay: 0.0005
2024-04-29 12:04:26,270 [trainer.py] => epochs: 20
2024-04-29 12:04:26,270 [trainer.py] => lrate: 0.001
2024-04-29 12:04:26,270 [trainer.py] => milestones: [80, 120]
2024-04-29 12:04:26,270 [trainer.py] => lrate_decay: 0.1
2024-04-29 12:04:26,270 [trainer.py] => batch_size: 48
2024-04-29 12:04:26,270 [trainer.py] => weight_decay: 0.0002
2024-04-29 12:04:26,270 [trainer.py] => T: 2
2024-04-29 12:04:26,322 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-29 12:04:29,593 [trainer.py] => All params: 85798656
2024-04-29 12:04:29,594 [trainer.py] => Trainable params: 85798656
2024-04-29 12:04:29,594 [icarl.py] => Learning on 0-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.025, Train_accy 31.53, Test_accy 74.83:   0%|          | 0/20 [00:35<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.025, Train_accy 31.53, Test_accy 74.83:   5%|▌         | 1/20 [00:35<11:20, 35.80s/it]Task 0, Epoch 2/20 => Loss 0.941, Train_accy 73.67:   5%|▌         | 1/20 [01:07<11:20, 35.80s/it]                 Task 0, Epoch 2/20 => Loss 0.941, Train_accy 73.67:  10%|█         | 2/20 [01:07<10:02, 33.46s/it]Task 0, Epoch 3/20 => Loss 0.724, Train_accy 80.10:  10%|█         | 2/20 [01:39<10:02, 33.46s/it]Task 0, Epoch 3/20 => Loss 0.724, Train_accy 80.10:  15%|█▌        | 3/20 [01:39<09:15, 32.65s/it]Task 0, Epoch 4/20 => Loss 0.649, Train_accy 82.17:  15%|█▌        | 3/20 [02:11<09:15, 32.65s/it]Task 0, Epoch 4/20 => Loss 0.649, Train_accy 82.17:  20%|██        | 4/20 [02:11<08:37, 32.32s/it]Task 0, Epoch 5/20 => Loss 0.552, Train_accy 85.07:  20%|██        | 4/20 [02:42<08:37, 32.32s/it]Task 0, Epoch 5/20 => Loss 0.552, Train_accy 85.07:  25%|██▌       | 5/20 [02:42<08:01, 32.12s/it]Task 0, Epoch 6/20 => Loss 0.459, Train_accy 87.43, Test_accy 88.64:  25%|██▌       | 5/20 [03:18<08:01, 32.12s/it]Task 0, Epoch 6/20 => Loss 0.459, Train_accy 87.43, Test_accy 88.64:  30%|███       | 6/20 [03:18<07:47, 33.37s/it]Task 0, Epoch 7/20 => Loss 0.497, Train_accy 86.56:  30%|███       | 6/20 [03:50<07:47, 33.37s/it]                 Task 0, Epoch 7/20 => Loss 0.497, Train_accy 86.56:  35%|███▌      | 7/20 [03:50<07:06, 32.84s/it]Task 0, Epoch 8/20 => Loss 0.445, Train_accy 88.09:  35%|███▌      | 7/20 [04:22<07:06, 32.84s/it]Task 0, Epoch 8/20 => Loss 0.445, Train_accy 88.09:  40%|████      | 8/20 [04:22<06:29, 32.49s/it]Task 0, Epoch 9/20 => Loss 0.397, Train_accy 89.48:  40%|████      | 8/20 [04:53<06:29, 32.49s/it]Task 0, Epoch 9/20 => Loss 0.397, Train_accy 89.48:  45%|████▌     | 9/20 [04:53<05:54, 32.25s/it]Task 0, Epoch 10/20 => Loss 0.426, Train_accy 88.33:  45%|████▌     | 9/20 [05:25<05:54, 32.25s/it]Task 0, Epoch 10/20 => Loss 0.426, Train_accy 88.33:  50%|█████     | 10/20 [05:25<05:20, 32.08s/it]Task 0, Epoch 11/20 => Loss 0.382, Train_accy 89.82, Test_accy 88.97:  50%|█████     | 10/20 [06:01<05:20, 32.08s/it]Task 0, Epoch 11/20 => Loss 0.382, Train_accy 89.82, Test_accy 88.97:  55%|█████▌    | 11/20 [06:01<04:58, 33.14s/it]Task 0, Epoch 12/20 => Loss 0.395, Train_accy 89.16:  55%|█████▌    | 11/20 [06:32<04:58, 33.14s/it]                 Task 0, Epoch 12/20 => Loss 0.395, Train_accy 89.16:  60%|██████    | 12/20 [06:32<04:21, 32.70s/it]Task 0, Epoch 13/20 => Loss 0.358, Train_accy 90.18:  60%|██████    | 12/20 [07:04<04:21, 32.70s/it]Task 0, Epoch 13/20 => Loss 0.358, Train_accy 90.18:  65%|██████▌   | 13/20 [07:04<03:47, 32.44s/it]Task 0, Epoch 14/20 => Loss 0.385, Train_accy 89.63:  65%|██████▌   | 13/20 [07:36<03:47, 32.44s/it]Task 0, Epoch 14/20 => Loss 0.385, Train_accy 89.63:  70%|███████   | 14/20 [07:36<03:13, 32.28s/it]Task 0, Epoch 15/20 => Loss 0.357, Train_accy 90.63:  70%|███████   | 14/20 [08:08<03:13, 32.28s/it]Task 0, Epoch 15/20 => Loss 0.357, Train_accy 90.63:  75%|███████▌  | 15/20 [08:08<02:40, 32.18s/it]Task 0, Epoch 16/20 => Loss 0.340, Train_accy 90.90, Test_accy 88.97:  75%|███████▌  | 15/20 [08:44<02:40, 32.18s/it]Task 0, Epoch 16/20 => Loss 0.340, Train_accy 90.90, Test_accy 88.97:  80%|████████  | 16/20 [08:44<02:13, 33.27s/it]Task 0, Epoch 17/20 => Loss 0.335, Train_accy 91.18:  80%|████████  | 16/20 [09:16<02:13, 33.27s/it]                 Task 0, Epoch 17/20 => Loss 0.335, Train_accy 91.18:  85%|████████▌ | 17/20 [09:16<01:38, 32.83s/it]Task 0, Epoch 18/20 => Loss 0.362, Train_accy 90.58:  85%|████████▌ | 17/20 [09:48<01:38, 32.83s/it]Task 0, Epoch 18/20 => Loss 0.362, Train_accy 90.58:  90%|█████████ | 18/20 [09:48<01:05, 32.56s/it]Task 0, Epoch 19/20 => Loss 0.319, Train_accy 91.41:  90%|█████████ | 18/20 [10:20<01:05, 32.56s/it]Task 0, Epoch 19/20 => Loss 0.319, Train_accy 91.41:  95%|█████████▌| 19/20 [10:20<00:32, 32.39s/it]Task 0, Epoch 20/20 => Loss 0.326, Train_accy 91.37:  95%|█████████▌| 19/20 [10:51<00:32, 32.39s/it]Task 0, Epoch 20/20 => Loss 0.326, Train_accy 91.37: 100%|██████████| 20/20 [10:51<00:00, 32.21s/it]Task 0, Epoch 20/20 => Loss 0.326, Train_accy 91.37: 100%|██████████| 20/20 [10:51<00:00, 32.59s/it]
2024-04-29 12:15:22,008 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.326, Train_accy 91.37
2024-04-29 12:15:22,010 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 12:17:07,425 [icarl.py] => Exemplar size: 2000
2024-04-29 12:17:07,425 [trainer.py] => CNN: {'total': 89.48, '00-99': 89.48, 'old': 0, 'new': 89.48}
2024-04-29 12:17:07,425 [trainer.py] => NME: {'total': 90.57, '00-99': 90.57, 'old': 0, 'new': 90.57}
2024-04-29 12:17:07,425 [trainer.py] => CNN top1 curve: [89.48]
2024-04-29 12:17:07,425 [trainer.py] => CNN top5 curve: [98.23]
2024-04-29 12:17:07,425 [trainer.py] => NME top1 curve: [90.57]
2024-04-29 12:17:07,425 [trainer.py] => NME top5 curve: [98.91]

Average Accuracy (CNN): 89.48
Average Accuracy (NME): 90.57
2024-04-29 12:17:07,425 [trainer.py] => Average Accuracy (CNN): 89.48
2024-04-29 12:17:07,425 [trainer.py] => Average Accuracy (NME): 90.57
2024-04-29 12:17:07,425 [trainer.py] => Train Time: 0
2024-04-29 12:17:07,425 [trainer.py] => Test Time: 7.21 

2024-04-29 12:17:07,426 [trainer.py] => All params: 85875556
2024-04-29 12:17:07,427 [trainer.py] => Trainable params: 85875556
2024-04-29 12:17:07,429 [icarl.py] => Learning on 100-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.520, Train_accy 76.56, Test_accy 85.10:   0%|          | 0/20 [00:31<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.520, Train_accy 76.56, Test_accy 85.10:   5%|▌         | 1/20 [00:31<09:50, 31.07s/it]Task 1, Epoch 2/20 => Loss 1.647, Train_accy 87.64:   5%|▌         | 1/20 [00:58<09:50, 31.07s/it]                 Task 1, Epoch 2/20 => Loss 1.647, Train_accy 87.64:  10%|█         | 2/20 [00:58<08:35, 28.66s/it]Task 1, Epoch 3/20 => Loss 1.620, Train_accy 89.26:  10%|█         | 2/20 [01:24<08:35, 28.66s/it]Task 1, Epoch 3/20 => Loss 1.620, Train_accy 89.26:  15%|█▌        | 3/20 [01:24<07:53, 27.83s/it]Task 1, Epoch 4/20 => Loss 1.619, Train_accy 90.01:  15%|█▌        | 3/20 [01:51<07:53, 27.83s/it]Task 1, Epoch 4/20 => Loss 1.619, Train_accy 90.01:  20%|██        | 4/20 [01:51<07:19, 27.46s/it]Task 1, Epoch 5/20 => Loss 1.620, Train_accy 90.75:  20%|██        | 4/20 [02:18<07:19, 27.46s/it]Task 1, Epoch 5/20 => Loss 1.620, Train_accy 90.75:  25%|██▌       | 5/20 [02:18<06:49, 27.30s/it]Task 1, Epoch 6/20 => Loss 1.538, Train_accy 91.63, Test_accy 87.78:  25%|██▌       | 5/20 [02:49<06:49, 27.30s/it]Task 1, Epoch 6/20 => Loss 1.538, Train_accy 91.63, Test_accy 87.78:  30%|███       | 6/20 [02:49<06:40, 28.60s/it]Task 1, Epoch 7/20 => Loss 1.564, Train_accy 91.73:  30%|███       | 6/20 [03:16<06:40, 28.60s/it]                 Task 1, Epoch 7/20 => Loss 1.564, Train_accy 91.73:  35%|███▌      | 7/20 [03:16<06:04, 28.01s/it]Task 1, Epoch 8/20 => Loss 1.524, Train_accy 92.24:  35%|███▌      | 7/20 [03:43<06:04, 28.01s/it]Task 1, Epoch 8/20 => Loss 1.524, Train_accy 92.24:  40%|████      | 8/20 [03:43<05:32, 27.69s/it]Task 1, Epoch 9/20 => Loss 1.502, Train_accy 92.62:  40%|████      | 8/20 [04:10<05:32, 27.69s/it]Task 1, Epoch 9/20 => Loss 1.502, Train_accy 92.62:  45%|████▌     | 9/20 [04:10<05:01, 27.41s/it]Task 1, Epoch 10/20 => Loss 1.515, Train_accy 92.48:  45%|████▌     | 9/20 [04:37<05:01, 27.41s/it]Task 1, Epoch 10/20 => Loss 1.515, Train_accy 92.48:  50%|█████     | 10/20 [04:37<04:32, 27.25s/it]Task 1, Epoch 11/20 => Loss 1.542, Train_accy 91.97, Test_accy 88.49:  50%|█████     | 10/20 [05:08<04:32, 27.25s/it]Task 1, Epoch 11/20 => Loss 1.542, Train_accy 91.97, Test_accy 88.49:  55%|█████▌    | 11/20 [05:08<04:15, 28.41s/it]Task 1, Epoch 12/20 => Loss 1.527, Train_accy 92.38:  55%|█████▌    | 11/20 [05:35<04:15, 28.41s/it]                 Task 1, Epoch 12/20 => Loss 1.527, Train_accy 92.38:  60%|██████    | 12/20 [05:35<03:43, 27.91s/it]Task 1, Epoch 13/20 => Loss 1.563, Train_accy 91.53:  60%|██████    | 12/20 [06:02<03:43, 27.91s/it]Task 1, Epoch 13/20 => Loss 1.563, Train_accy 91.53:  65%|██████▌   | 13/20 [06:02<03:13, 27.61s/it]Task 1, Epoch 14/20 => Loss 1.443, Train_accy 93.87:  65%|██████▌   | 13/20 [06:29<03:13, 27.61s/it]Task 1, Epoch 14/20 => Loss 1.443, Train_accy 93.87:  70%|███████   | 14/20 [06:29<02:44, 27.39s/it]Task 1, Epoch 15/20 => Loss 1.508, Train_accy 92.45:  70%|███████   | 14/20 [06:56<02:44, 27.39s/it]Task 1, Epoch 15/20 => Loss 1.508, Train_accy 92.45:  75%|███████▌  | 15/20 [06:56<02:16, 27.28s/it]Task 1, Epoch 16/20 => Loss 1.472, Train_accy 93.60, Test_accy 87.36:  75%|███████▌  | 15/20 [07:27<02:16, 27.28s/it]Task 1, Epoch 16/20 => Loss 1.472, Train_accy 93.60, Test_accy 87.36:  80%|████████  | 16/20 [07:27<01:53, 28.40s/it]Task 1, Epoch 17/20 => Loss 1.403, Train_accy 94.41:  80%|████████  | 16/20 [07:53<01:53, 28.40s/it]                 Task 1, Epoch 17/20 => Loss 1.403, Train_accy 94.41:  85%|████████▌ | 17/20 [07:53<01:23, 27.89s/it]Task 1, Epoch 18/20 => Loss 1.476, Train_accy 93.29:  85%|████████▌ | 17/20 [08:20<01:23, 27.89s/it]Task 1, Epoch 18/20 => Loss 1.476, Train_accy 93.29:  90%|█████████ | 18/20 [08:20<00:55, 27.51s/it]Task 1, Epoch 19/20 => Loss 1.416, Train_accy 94.24:  90%|█████████ | 18/20 [08:47<00:55, 27.51s/it]Task 1, Epoch 19/20 => Loss 1.416, Train_accy 94.24:  95%|█████████▌| 19/20 [08:47<00:27, 27.25s/it]Task 1, Epoch 20/20 => Loss 1.462, Train_accy 93.56:  95%|█████████▌| 19/20 [09:13<00:27, 27.25s/it]Task 1, Epoch 20/20 => Loss 1.462, Train_accy 93.56: 100%|██████████| 20/20 [09:13<00:00, 27.07s/it]Task 1, Epoch 20/20 => Loss 1.462, Train_accy 93.56: 100%|██████████| 20/20 [09:13<00:00, 27.68s/it]
2024-04-29 12:26:21,130 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.462, Train_accy 93.56
2024-04-29 12:26:21,131 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 12:27:18,395 [icarl.py] => Exemplar size: 2400
2024-04-29 12:27:18,396 [trainer.py] => CNN: {'total': 87.85, '00-99': 86.87, '100-119': 92.98, 'old': 86.87, 'new': 92.98}
2024-04-29 12:27:18,396 [trainer.py] => NME: {'total': 89.48, '00-99': 89.56, '100-119': 89.04, 'old': 89.56, 'new': 89.04}
2024-04-29 12:27:18,396 [trainer.py] => CNN top1 curve: [89.48, 87.85]
2024-04-29 12:27:18,396 [trainer.py] => CNN top5 curve: [98.23, 97.95]
2024-04-29 12:27:18,396 [trainer.py] => NME top1 curve: [90.57, 89.48]
2024-04-29 12:27:18,396 [trainer.py] => NME top5 curve: [98.91, 98.66]

Average Accuracy (CNN): 88.66
Average Accuracy (NME): 90.02
2024-04-29 12:27:18,396 [trainer.py] => Average Accuracy (CNN): 88.66
2024-04-29 12:27:18,396 [trainer.py] => Average Accuracy (NME): 90.02
2024-04-29 12:27:18,396 [trainer.py] => Train Time: 0
2024-04-29 12:27:18,396 [trainer.py] => Test Time: 15.32 

2024-04-29 12:27:18,397 [trainer.py] => All params: 85890936
2024-04-29 12:27:18,397 [trainer.py] => Trainable params: 85890936
2024-04-29 12:27:18,398 [icarl.py] => Learning on 120-140
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.308, Train_accy 80.17, Test_accy 85.92:   0%|          | 0/20 [00:34<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.308, Train_accy 80.17, Test_accy 85.92:   5%|▌         | 1/20 [00:34<11:02, 34.86s/it]Task 2, Epoch 2/20 => Loss 1.661, Train_accy 88.97:   5%|▌         | 1/20 [01:05<11:02, 34.86s/it]                 Task 2, Epoch 2/20 => Loss 1.661, Train_accy 88.97:  10%|█         | 2/20 [01:05<09:39, 32.22s/it]Task 2, Epoch 3/20 => Loss 1.696, Train_accy 89.53:  10%|█         | 2/20 [01:35<09:39, 32.22s/it]Task 2, Epoch 3/20 => Loss 1.696, Train_accy 89.53:  15%|█▌        | 3/20 [01:35<08:53, 31.40s/it]Task 2, Epoch 4/20 => Loss 1.636, Train_accy 90.85:  15%|█▌        | 3/20 [02:06<08:53, 31.40s/it]Task 2, Epoch 4/20 => Loss 1.636, Train_accy 90.85:  20%|██        | 4/20 [02:06<08:16, 31.00s/it]Task 2, Epoch 5/20 => Loss 1.592, Train_accy 91.68:  20%|██        | 4/20 [02:36<08:16, 31.00s/it]Task 2, Epoch 5/20 => Loss 1.592, Train_accy 91.68:  25%|██▌       | 5/20 [02:36<07:41, 30.77s/it]Task 2, Epoch 6/20 => Loss 1.592, Train_accy 92.01, Test_accy 86.47:  25%|██▌       | 5/20 [03:11<07:41, 30.77s/it]Task 2, Epoch 6/20 => Loss 1.592, Train_accy 92.01, Test_accy 86.47:  30%|███       | 6/20 [03:11<07:31, 32.24s/it]Task 2, Epoch 7/20 => Loss 1.555, Train_accy 93.44:  30%|███       | 6/20 [03:41<07:31, 32.24s/it]                 Task 2, Epoch 7/20 => Loss 1.555, Train_accy 93.44:  35%|███▌      | 7/20 [03:41<06:51, 31.64s/it]Task 2, Epoch 8/20 => Loss 1.581, Train_accy 92.40:  35%|███▌      | 7/20 [04:12<06:51, 31.64s/it]Task 2, Epoch 8/20 => Loss 1.581, Train_accy 92.40:  40%|████      | 8/20 [04:12<06:14, 31.24s/it]Task 2, Epoch 9/20 => Loss 1.547, Train_accy 93.29:  40%|████      | 8/20 [04:42<06:14, 31.24s/it]Task 2, Epoch 9/20 => Loss 1.547, Train_accy 93.29:  45%|████▌     | 9/20 [04:42<05:40, 30.98s/it]Task 2, Epoch 10/20 => Loss 1.554, Train_accy 93.11:  45%|████▌     | 9/20 [05:12<05:40, 30.98s/it]Task 2, Epoch 10/20 => Loss 1.554, Train_accy 93.11:  50%|█████     | 10/20 [05:12<05:07, 30.77s/it]Task 2, Epoch 11/20 => Loss 1.545, Train_accy 93.20, Test_accy 87.14:  50%|█████     | 10/20 [05:48<05:07, 30.77s/it]Task 2, Epoch 11/20 => Loss 1.545, Train_accy 93.20, Test_accy 87.14:  55%|█████▌    | 11/20 [05:48<04:49, 32.13s/it]Task 2, Epoch 12/20 => Loss 1.539, Train_accy 93.47:  55%|█████▌    | 11/20 [06:18<04:49, 32.13s/it]                 Task 2, Epoch 12/20 => Loss 1.539, Train_accy 93.47:  60%|██████    | 12/20 [06:18<04:12, 31.60s/it]Task 2, Epoch 13/20 => Loss 1.535, Train_accy 93.44:  60%|██████    | 12/20 [06:49<04:12, 31.60s/it]Task 2, Epoch 13/20 => Loss 1.535, Train_accy 93.44:  65%|██████▌   | 13/20 [06:49<03:38, 31.26s/it]Task 2, Epoch 14/20 => Loss 1.528, Train_accy 93.68:  65%|██████▌   | 13/20 [07:19<03:38, 31.26s/it]Task 2, Epoch 14/20 => Loss 1.528, Train_accy 93.68:  70%|███████   | 14/20 [07:19<03:06, 31.02s/it]Task 2, Epoch 15/20 => Loss 1.533, Train_accy 93.98:  70%|███████   | 14/20 [07:50<03:06, 31.02s/it]Task 2, Epoch 15/20 => Loss 1.533, Train_accy 93.98:  75%|███████▌  | 15/20 [07:50<02:34, 30.86s/it]Task 2, Epoch 16/20 => Loss 1.484, Train_accy 94.69, Test_accy 86.84:  75%|███████▌  | 15/20 [08:25<02:34, 30.86s/it]Task 2, Epoch 16/20 => Loss 1.484, Train_accy 94.69, Test_accy 86.84:  80%|████████  | 16/20 [08:25<02:08, 32.13s/it]Task 2, Epoch 17/20 => Loss 1.463, Train_accy 94.39:  80%|████████  | 16/20 [08:55<02:08, 32.13s/it]                 Task 2, Epoch 17/20 => Loss 1.463, Train_accy 94.39:  85%|████████▌ | 17/20 [08:55<01:34, 31.61s/it]Task 2, Epoch 18/20 => Loss 1.471, Train_accy 94.36:  85%|████████▌ | 17/20 [09:26<01:34, 31.61s/it]Task 2, Epoch 18/20 => Loss 1.471, Train_accy 94.36:  90%|█████████ | 18/20 [09:26<01:02, 31.28s/it]Task 2, Epoch 19/20 => Loss 1.492, Train_accy 94.36:  90%|█████████ | 18/20 [09:56<01:02, 31.28s/it]Task 2, Epoch 19/20 => Loss 1.492, Train_accy 94.36:  95%|█████████▌| 19/20 [09:56<00:31, 31.02s/it]Task 2, Epoch 20/20 => Loss 1.509, Train_accy 94.22:  95%|█████████▌| 19/20 [10:26<00:31, 31.02s/it]Task 2, Epoch 20/20 => Loss 1.509, Train_accy 94.22: 100%|██████████| 20/20 [10:26<00:00, 30.87s/it]Task 2, Epoch 20/20 => Loss 1.509, Train_accy 94.22: 100%|██████████| 20/20 [10:26<00:00, 31.35s/it]
2024-04-29 12:37:45,367 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.509, Train_accy 94.22
2024-04-29 12:37:45,368 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 12:38:50,340 [icarl.py] => Exemplar size: 2800
2024-04-29 12:38:50,340 [trainer.py] => CNN: {'total': 87.08, '00-99': 85.69, '100-119': 90.35, '120-139': 91.11, 'old': 86.44, 'new': 91.11}
2024-04-29 12:38:50,340 [trainer.py] => NME: {'total': 88.36, '00-99': 88.05, '100-119': 89.47, '120-139': 88.89, 'old': 88.28, 'new': 88.89}
2024-04-29 12:38:50,341 [trainer.py] => CNN top1 curve: [89.48, 87.85, 87.08]
2024-04-29 12:38:50,341 [trainer.py] => CNN top5 curve: [98.23, 97.95, 97.81]
2024-04-29 12:38:50,341 [trainer.py] => NME top1 curve: [90.57, 89.48, 88.36]
2024-04-29 12:38:50,341 [trainer.py] => NME top5 curve: [98.91, 98.66, 98.35]

Average Accuracy (CNN): 88.14
Average Accuracy (NME): 89.47
2024-04-29 12:38:50,341 [trainer.py] => Average Accuracy (CNN): 88.14
2024-04-29 12:38:50,341 [trainer.py] => Average Accuracy (NME): 89.47
2024-04-29 12:38:50,341 [trainer.py] => Train Time: 0
2024-04-29 12:38:50,341 [trainer.py] => Test Time: 24.68 

2024-04-29 12:38:50,342 [trainer.py] => All params: 85906316
2024-04-29 12:38:50,343 [trainer.py] => Trainable params: 85906316
2024-04-29 12:38:50,345 [icarl.py] => Learning on 140-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.326, Train_accy 82.26, Test_accy 84.24:   0%|          | 0/20 [00:38<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.326, Train_accy 82.26, Test_accy 84.24:   5%|▌         | 1/20 [00:38<12:16, 38.78s/it]Task 3, Epoch 2/20 => Loss 1.764, Train_accy 88.47:   5%|▌         | 1/20 [01:12<12:16, 38.78s/it]                 Task 3, Epoch 2/20 => Loss 1.764, Train_accy 88.47:  10%|█         | 2/20 [01:12<10:43, 35.74s/it]Task 3, Epoch 3/20 => Loss 1.660, Train_accy 91.42:  10%|█         | 2/20 [01:46<10:43, 35.74s/it]Task 3, Epoch 3/20 => Loss 1.660, Train_accy 91.42:  15%|█▌        | 3/20 [01:46<09:52, 34.84s/it]Task 3, Epoch 4/20 => Loss 1.580, Train_accy 92.53:  15%|█▌        | 3/20 [02:20<09:52, 34.84s/it]Task 3, Epoch 4/20 => Loss 1.580, Train_accy 92.53:  20%|██        | 4/20 [02:20<09:11, 34.46s/it]Task 3, Epoch 5/20 => Loss 1.605, Train_accy 92.39:  20%|██        | 4/20 [02:53<09:11, 34.46s/it]Task 3, Epoch 5/20 => Loss 1.605, Train_accy 92.39:  25%|██▌       | 5/20 [02:53<08:33, 34.22s/it]Task 3, Epoch 6/20 => Loss 1.652, Train_accy 92.26, Test_accy 83.66:  25%|██▌       | 5/20 [03:32<08:33, 34.22s/it]Task 3, Epoch 6/20 => Loss 1.652, Train_accy 92.26, Test_accy 83.66:  30%|███       | 6/20 [03:32<08:22, 35.89s/it]Task 3, Epoch 7/20 => Loss 1.594, Train_accy 93.47:  30%|███       | 6/20 [04:06<08:22, 35.89s/it]                 Task 3, Epoch 7/20 => Loss 1.594, Train_accy 93.47:  35%|███▌      | 7/20 [04:06<07:37, 35.18s/it]Task 3, Epoch 8/20 => Loss 1.517, Train_accy 94.25:  35%|███▌      | 7/20 [04:40<07:37, 35.18s/it]Task 3, Epoch 8/20 => Loss 1.517, Train_accy 94.25:  40%|████      | 8/20 [04:40<06:56, 34.73s/it]Task 3, Epoch 9/20 => Loss 1.546, Train_accy 93.92:  40%|████      | 8/20 [05:14<06:56, 34.73s/it]Task 3, Epoch 9/20 => Loss 1.546, Train_accy 93.92:  45%|████▌     | 9/20 [05:14<06:18, 34.45s/it]Task 3, Epoch 10/20 => Loss 1.576, Train_accy 93.20:  45%|████▌     | 9/20 [05:48<06:18, 34.45s/it]Task 3, Epoch 10/20 => Loss 1.576, Train_accy 93.20:  50%|█████     | 10/20 [05:48<05:42, 34.27s/it]Task 3, Epoch 11/20 => Loss 1.515, Train_accy 94.54, Test_accy 85.72:  50%|█████     | 10/20 [06:27<05:42, 34.27s/it]Task 3, Epoch 11/20 => Loss 1.515, Train_accy 94.54, Test_accy 85.72:  55%|█████▌    | 11/20 [06:27<05:21, 35.77s/it]Task 3, Epoch 12/20 => Loss 1.534, Train_accy 94.49:  55%|█████▌    | 11/20 [07:00<05:21, 35.77s/it]                 Task 3, Epoch 12/20 => Loss 1.534, Train_accy 94.49:  60%|██████    | 12/20 [07:00<04:40, 35.11s/it]Task 3, Epoch 13/20 => Loss 1.574, Train_accy 93.55:  60%|██████    | 12/20 [07:34<04:40, 35.11s/it]Task 3, Epoch 13/20 => Loss 1.574, Train_accy 93.55:  65%|██████▌   | 13/20 [07:34<04:02, 34.66s/it]Task 3, Epoch 14/20 => Loss 1.508, Train_accy 94.09:  65%|██████▌   | 13/20 [08:08<04:02, 34.66s/it]Task 3, Epoch 14/20 => Loss 1.508, Train_accy 94.09:  70%|███████   | 14/20 [08:08<03:26, 34.44s/it]Task 3, Epoch 15/20 => Loss 1.511, Train_accy 94.81:  70%|███████   | 14/20 [08:42<03:26, 34.44s/it]Task 3, Epoch 15/20 => Loss 1.511, Train_accy 94.81:  75%|███████▌  | 15/20 [08:42<02:51, 34.29s/it]Task 3, Epoch 16/20 => Loss 1.560, Train_accy 94.73, Test_accy 85.14:  75%|███████▌  | 15/20 [09:21<02:51, 34.29s/it]Task 3, Epoch 16/20 => Loss 1.560, Train_accy 94.73, Test_accy 85.14:  80%|████████  | 16/20 [09:21<02:23, 35.84s/it]Task 3, Epoch 17/20 => Loss 1.542, Train_accy 94.65:  80%|████████  | 16/20 [09:55<02:23, 35.84s/it]                 Task 3, Epoch 17/20 => Loss 1.542, Train_accy 94.65:  85%|████████▌ | 17/20 [09:55<01:45, 35.25s/it]Task 3, Epoch 18/20 => Loss 1.453, Train_accy 95.40:  85%|████████▌ | 17/20 [10:29<01:45, 35.25s/it]Task 3, Epoch 18/20 => Loss 1.453, Train_accy 95.40:  90%|█████████ | 18/20 [10:29<01:09, 34.86s/it]Task 3, Epoch 19/20 => Loss 1.545, Train_accy 94.30:  90%|█████████ | 18/20 [11:03<01:09, 34.86s/it]Task 3, Epoch 19/20 => Loss 1.545, Train_accy 94.30:  95%|█████████▌| 19/20 [11:03<00:34, 34.57s/it]Task 3, Epoch 20/20 => Loss 1.527, Train_accy 94.70:  95%|█████████▌| 19/20 [11:37<00:34, 34.57s/it]Task 3, Epoch 20/20 => Loss 1.527, Train_accy 94.70: 100%|██████████| 20/20 [11:37<00:00, 34.39s/it]Task 3, Epoch 20/20 => Loss 1.527, Train_accy 94.70: 100%|██████████| 20/20 [11:37<00:00, 34.88s/it]
2024-04-29 12:50:27,908 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.527, Train_accy 94.70
2024-04-29 12:50:27,910 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 12:51:49,983 [icarl.py] => Exemplar size: 3200
2024-04-29 12:51:49,983 [trainer.py] => CNN: {'total': 84.98, '00-99': 81.73, '100-119': 87.72, '120-139': 88.89, '140-159': 94.4, 'old': 83.55, 'new': 94.4}
2024-04-29 12:51:49,983 [trainer.py] => NME: {'total': 87.68, '00-99': 86.28, '100-119': 88.6, '120-139': 88.89, '140-159': 92.4, 'old': 86.96, 'new': 92.4}
2024-04-29 12:51:49,984 [trainer.py] => CNN top1 curve: [89.48, 87.85, 87.08, 84.98]
2024-04-29 12:51:49,984 [trainer.py] => CNN top5 curve: [98.23, 97.95, 97.81, 97.09]
2024-04-29 12:51:49,984 [trainer.py] => NME top1 curve: [90.57, 89.48, 88.36, 87.68]
2024-04-29 12:51:49,984 [trainer.py] => NME top5 curve: [98.91, 98.66, 98.35, 98.2]

Average Accuracy (CNN): 87.35
Average Accuracy (NME): 89.02
2024-04-29 12:51:49,984 [trainer.py] => Average Accuracy (CNN): 87.35
2024-04-29 12:51:49,984 [trainer.py] => Average Accuracy (NME): 89.02
2024-04-29 12:51:49,984 [trainer.py] => Train Time: 0
2024-04-29 12:51:49,984 [trainer.py] => Test Time: 35.57 

2024-04-29 12:51:49,984 [trainer.py] => All params: 85921696
2024-04-29 12:51:49,985 [trainer.py] => Trainable params: 85921696
2024-04-29 12:51:49,986 [icarl.py] => Learning on 160-180
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.280, Train_accy 83.74, Test_accy 82.33:   0%|          | 0/20 [00:43<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.280, Train_accy 83.74, Test_accy 82.33:   5%|▌         | 1/20 [00:43<13:42, 43.31s/it]Task 4, Epoch 2/20 => Loss 1.732, Train_accy 91.01:   5%|▌         | 1/20 [01:20<13:42, 43.31s/it]                 Task 4, Epoch 2/20 => Loss 1.732, Train_accy 91.01:  10%|█         | 2/20 [01:20<11:57, 39.88s/it]Task 4, Epoch 3/20 => Loss 1.671, Train_accy 92.33:  10%|█         | 2/20 [01:58<11:57, 39.88s/it]Task 4, Epoch 3/20 => Loss 1.671, Train_accy 92.33:  15%|█▌        | 3/20 [01:58<11:01, 38.89s/it]Task 4, Epoch 4/20 => Loss 1.657, Train_accy 93.29:  15%|█▌        | 3/20 [02:36<11:01, 38.89s/it]Task 4, Epoch 4/20 => Loss 1.657, Train_accy 93.29:  20%|██        | 4/20 [02:36<10:15, 38.45s/it]Task 4, Epoch 5/20 => Loss 1.647, Train_accy 93.63:  20%|██        | 4/20 [03:14<10:15, 38.45s/it]Task 4, Epoch 5/20 => Loss 1.647, Train_accy 93.63:  25%|██▌       | 5/20 [03:14<09:33, 38.20s/it]Task 4, Epoch 6/20 => Loss 1.590, Train_accy 93.99, Test_accy 83.27:  25%|██▌       | 5/20 [03:57<09:33, 38.20s/it]Task 4, Epoch 6/20 => Loss 1.590, Train_accy 93.99, Test_accy 83.27:  30%|███       | 6/20 [03:57<09:21, 40.09s/it]Task 4, Epoch 7/20 => Loss 1.653, Train_accy 93.46:  30%|███       | 6/20 [04:35<09:21, 40.09s/it]                 Task 4, Epoch 7/20 => Loss 1.653, Train_accy 93.46:  35%|███▌      | 7/20 [04:35<08:30, 39.25s/it]Task 4, Epoch 8/20 => Loss 1.604, Train_accy 94.71:  35%|███▌      | 7/20 [05:13<08:30, 39.25s/it]Task 4, Epoch 8/20 => Loss 1.604, Train_accy 94.71:  40%|████      | 8/20 [05:13<07:45, 38.76s/it]Task 4, Epoch 9/20 => Loss 1.589, Train_accy 94.28:  40%|████      | 8/20 [05:50<07:45, 38.76s/it]Task 4, Epoch 9/20 => Loss 1.589, Train_accy 94.28:  45%|████▌     | 9/20 [05:50<07:03, 38.49s/it]Task 4, Epoch 10/20 => Loss 1.599, Train_accy 94.47:  45%|████▌     | 9/20 [06:28<07:03, 38.49s/it]Task 4, Epoch 10/20 => Loss 1.599, Train_accy 94.47:  50%|█████     | 10/20 [06:28<06:23, 38.32s/it]Task 4, Epoch 11/20 => Loss 1.552, Train_accy 94.71, Test_accy 84.30:  50%|█████     | 10/20 [07:12<06:23, 38.32s/it]Task 4, Epoch 11/20 => Loss 1.552, Train_accy 94.71, Test_accy 84.30:  55%|█████▌    | 11/20 [07:12<06:00, 40.06s/it]Task 4, Epoch 12/20 => Loss 1.584, Train_accy 94.68:  55%|█████▌    | 11/20 [07:50<06:00, 40.06s/it]                 Task 4, Epoch 12/20 => Loss 1.584, Train_accy 94.68:  60%|██████    | 12/20 [07:50<05:15, 39.44s/it]Task 4, Epoch 13/20 => Loss 1.521, Train_accy 95.65:  60%|██████    | 12/20 [08:28<05:15, 39.44s/it]Task 4, Epoch 13/20 => Loss 1.521, Train_accy 95.65:  65%|██████▌   | 13/20 [08:28<04:32, 38.94s/it]Task 4, Epoch 14/20 => Loss 1.626, Train_accy 94.35:  65%|██████▌   | 13/20 [09:06<04:32, 38.94s/it]Task 4, Epoch 14/20 => Loss 1.626, Train_accy 94.35:  70%|███████   | 14/20 [09:06<03:51, 38.51s/it]Task 4, Epoch 15/20 => Loss 1.638, Train_accy 94.40:  70%|███████   | 14/20 [09:43<03:51, 38.51s/it]Task 4, Epoch 15/20 => Loss 1.638, Train_accy 94.40:  75%|███████▌  | 15/20 [09:43<03:11, 38.23s/it]Task 4, Epoch 16/20 => Loss 1.591, Train_accy 94.64, Test_accy 83.60:  75%|███████▌  | 15/20 [10:27<03:11, 38.23s/it]Task 4, Epoch 16/20 => Loss 1.591, Train_accy 94.64, Test_accy 83.60:  80%|████████  | 16/20 [10:27<02:39, 39.81s/it]Task 4, Epoch 17/20 => Loss 1.599, Train_accy 94.66:  80%|████████  | 16/20 [11:04<02:39, 39.81s/it]                 Task 4, Epoch 17/20 => Loss 1.599, Train_accy 94.66:  85%|████████▌ | 17/20 [11:04<01:57, 39.14s/it]Task 4, Epoch 18/20 => Loss 1.558, Train_accy 95.38:  85%|████████▌ | 17/20 [11:42<01:57, 39.14s/it]Task 4, Epoch 18/20 => Loss 1.558, Train_accy 95.38:  90%|█████████ | 18/20 [11:42<01:17, 38.69s/it]Task 4, Epoch 19/20 => Loss 1.574, Train_accy 95.29:  90%|█████████ | 18/20 [12:20<01:17, 38.69s/it]Task 4, Epoch 19/20 => Loss 1.574, Train_accy 95.29:  95%|█████████▌| 19/20 [12:20<00:38, 38.38s/it]Task 4, Epoch 20/20 => Loss 1.599, Train_accy 94.68:  95%|█████████▌| 19/20 [12:58<00:38, 38.38s/it]Task 4, Epoch 20/20 => Loss 1.599, Train_accy 94.68: 100%|██████████| 20/20 [12:58<00:00, 38.23s/it]Task 4, Epoch 20/20 => Loss 1.599, Train_accy 94.68: 100%|██████████| 20/20 [12:58<00:00, 38.90s/it]
2024-04-29 13:04:48,002 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.599, Train_accy 94.68
2024-04-29 13:04:48,003 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 13:06:20,629 [icarl.py] => Exemplar size: 3600
2024-04-29 13:06:20,630 [trainer.py] => CNN: {'total': 84.12, '00-99': 79.88, '100-119': 87.28, '120-139': 87.56, '140-159': 88.8, '160-179': 94.09, 'old': 82.87, 'new': 94.09}
2024-04-29 13:06:20,630 [trainer.py] => NME: {'total': 87.83, '00-99': 86.78, '100-119': 87.28, '120-139': 88.44, '140-159': 90.4, '160-179': 90.3, 'old': 87.52, 'new': 90.3}
2024-04-29 13:06:20,630 [trainer.py] => CNN top1 curve: [89.48, 87.85, 87.08, 84.98, 84.12]
2024-04-29 13:06:20,630 [trainer.py] => CNN top5 curve: [98.23, 97.95, 97.81, 97.09, 96.62]
2024-04-29 13:06:20,630 [trainer.py] => NME top1 curve: [90.57, 89.48, 88.36, 87.68, 87.83]
2024-04-29 13:06:20,630 [trainer.py] => NME top5 curve: [98.91, 98.66, 98.35, 98.2, 98.21]

Average Accuracy (CNN): 86.7
Average Accuracy (NME): 88.78
2024-04-29 13:06:20,630 [trainer.py] => Average Accuracy (CNN): 86.7
2024-04-29 13:06:20,630 [trainer.py] => Average Accuracy (NME): 88.78
2024-04-29 13:06:20,630 [trainer.py] => Train Time: 0
2024-04-29 13:06:20,630 [trainer.py] => Test Time: 47.93 

2024-04-29 13:06:20,631 [trainer.py] => All params: 85937076
2024-04-29 13:06:20,631 [trainer.py] => Trainable params: 85937076
2024-04-29 13:06:20,633 [icarl.py] => Learning on 180-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.298, Train_accy 83.50, Test_accy 80.92:   0%|          | 0/20 [00:47<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.298, Train_accy 83.50, Test_accy 80.92:   5%|▌         | 1/20 [00:47<15:04, 47.62s/it]Task 5, Epoch 2/20 => Loss 1.719, Train_accy 91.87:   5%|▌         | 1/20 [01:28<15:04, 47.62s/it]                 Task 5, Epoch 2/20 => Loss 1.719, Train_accy 91.87:  10%|█         | 2/20 [01:28<13:09, 43.85s/it]Task 5, Epoch 3/20 => Loss 1.724, Train_accy 92.53:  10%|█         | 2/20 [02:09<13:09, 43.85s/it]Task 5, Epoch 3/20 => Loss 1.724, Train_accy 92.53:  15%|█▌        | 3/20 [02:09<12:04, 42.62s/it]Task 5, Epoch 4/20 => Loss 1.717, Train_accy 93.06:  15%|█▌        | 3/20 [02:51<12:04, 42.62s/it]Task 5, Epoch 4/20 => Loss 1.717, Train_accy 93.06:  20%|██        | 4/20 [02:51<11:14, 42.13s/it]Task 5, Epoch 5/20 => Loss 1.697, Train_accy 93.28:  20%|██        | 4/20 [03:32<11:14, 42.13s/it]Task 5, Epoch 5/20 => Loss 1.697, Train_accy 93.28:  25%|██▌       | 5/20 [03:32<10:27, 41.81s/it]Task 5, Epoch 6/20 => Loss 1.677, Train_accy 93.52, Test_accy 80.45:  25%|██▌       | 5/20 [04:20<10:27, 41.81s/it]Task 5, Epoch 6/20 => Loss 1.677, Train_accy 93.52, Test_accy 80.45:  30%|███       | 6/20 [04:20<10:15, 43.96s/it]Task 5, Epoch 7/20 => Loss 1.663, Train_accy 93.91:  30%|███       | 6/20 [05:01<10:15, 43.96s/it]                 Task 5, Epoch 7/20 => Loss 1.663, Train_accy 93.91:  35%|███▌      | 7/20 [05:01<09:19, 43.06s/it]Task 5, Epoch 8/20 => Loss 1.663, Train_accy 94.68:  35%|███▌      | 7/20 [05:43<09:19, 43.06s/it]Task 5, Epoch 8/20 => Loss 1.663, Train_accy 94.68:  40%|████      | 8/20 [05:43<08:29, 42.47s/it]Task 5, Epoch 9/20 => Loss 1.631, Train_accy 94.90:  40%|████      | 8/20 [06:24<08:29, 42.47s/it]Task 5, Epoch 9/20 => Loss 1.631, Train_accy 94.90:  45%|████▌     | 9/20 [06:24<07:43, 42.11s/it]Task 5, Epoch 10/20 => Loss 1.627, Train_accy 94.71:  45%|████▌     | 9/20 [07:05<07:43, 42.11s/it]Task 5, Epoch 10/20 => Loss 1.627, Train_accy 94.71:  50%|█████     | 10/20 [07:05<06:59, 41.90s/it]Task 5, Epoch 11/20 => Loss 1.634, Train_accy 94.44, Test_accy 82.61:  50%|█████     | 10/20 [07:54<06:59, 41.90s/it]Task 5, Epoch 11/20 => Loss 1.634, Train_accy 94.44, Test_accy 82.61:  55%|█████▌    | 11/20 [07:54<06:34, 43.85s/it]Task 5, Epoch 12/20 => Loss 1.574, Train_accy 95.56:  55%|█████▌    | 11/20 [08:35<06:34, 43.85s/it]                 Task 5, Epoch 12/20 => Loss 1.574, Train_accy 95.56:  60%|██████    | 12/20 [08:35<05:45, 43.15s/it]Task 5, Epoch 13/20 => Loss 1.637, Train_accy 94.71:  60%|██████    | 12/20 [09:17<05:45, 43.15s/it]Task 5, Epoch 13/20 => Loss 1.637, Train_accy 94.71:  65%|██████▌   | 13/20 [09:17<04:58, 42.65s/it]Task 5, Epoch 14/20 => Loss 1.613, Train_accy 95.43:  65%|██████▌   | 13/20 [09:58<04:58, 42.65s/it]Task 5, Epoch 14/20 => Loss 1.613, Train_accy 95.43:  70%|███████   | 14/20 [09:58<04:13, 42.29s/it]Task 5, Epoch 15/20 => Loss 1.642, Train_accy 95.28:  70%|███████   | 14/20 [10:40<04:13, 42.29s/it]Task 5, Epoch 15/20 => Loss 1.642, Train_accy 95.28:  75%|███████▌  | 15/20 [10:40<03:30, 42.00s/it]Task 5, Epoch 16/20 => Loss 1.635, Train_accy 94.62, Test_accy 82.32:  75%|███████▌  | 15/20 [11:28<03:30, 42.00s/it]Task 5, Epoch 16/20 => Loss 1.635, Train_accy 94.62, Test_accy 82.32:  80%|████████  | 16/20 [11:28<02:55, 43.81s/it]Task 5, Epoch 17/20 => Loss 1.602, Train_accy 95.32:  80%|████████  | 16/20 [12:09<02:55, 43.81s/it]                 Task 5, Epoch 17/20 => Loss 1.602, Train_accy 95.32:  85%|████████▌ | 17/20 [12:09<02:09, 43.08s/it]Task 5, Epoch 18/20 => Loss 1.640, Train_accy 95.34:  85%|████████▌ | 17/20 [12:50<02:09, 43.08s/it]Task 5, Epoch 18/20 => Loss 1.640, Train_accy 95.34:  90%|█████████ | 18/20 [12:50<01:25, 42.55s/it]Task 5, Epoch 19/20 => Loss 1.633, Train_accy 95.21:  90%|█████████ | 18/20 [13:32<01:25, 42.55s/it]Task 5, Epoch 19/20 => Loss 1.633, Train_accy 95.21:  95%|█████████▌| 19/20 [13:32<00:42, 42.23s/it]Task 5, Epoch 20/20 => Loss 1.580, Train_accy 95.83:  95%|█████████▌| 19/20 [14:13<00:42, 42.23s/it]Task 5, Epoch 20/20 => Loss 1.580, Train_accy 95.83: 100%|██████████| 20/20 [14:13<00:00, 42.04s/it]Task 5, Epoch 20/20 => Loss 1.580, Train_accy 95.83: 100%|██████████| 20/20 [14:13<00:00, 42.69s/it]
2024-04-29 13:20:34,452 [icarl.py] => Task 5, Epoch 20/20 => Loss 1.580, Train_accy 95.83
2024-04-29 13:20:34,453 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 13:22:13,093 [icarl.py] => Exemplar size: 4000
2024-04-29 13:22:13,093 [trainer.py] => CNN: {'total': 81.72, '00-99': 76.94, '100-119': 85.09, '120-139': 83.56, '140-159': 87.6, '160-179': 91.14, '180-199': 85.22, 'old': 81.34, 'new': 85.22}
2024-04-29 13:22:13,093 [trainer.py] => NME: {'total': 86.3, '00-99': 85.35, '100-119': 87.72, '120-139': 84.89, '140-159': 89.6, '160-179': 87.76, '180-199': 86.09, 'old': 86.33, 'new': 86.09}
2024-04-29 13:22:13,093 [trainer.py] => CNN top1 curve: [89.48, 87.85, 87.08, 84.98, 84.12, 81.72]
2024-04-29 13:22:13,093 [trainer.py] => CNN top5 curve: [98.23, 97.95, 97.81, 97.09, 96.62, 95.72]
2024-04-29 13:22:13,093 [trainer.py] => NME top1 curve: [90.57, 89.48, 88.36, 87.68, 87.83, 86.3]
2024-04-29 13:22:13,093 [trainer.py] => NME top5 curve: [98.91, 98.66, 98.35, 98.2, 98.21, 97.54]

Average Accuracy (CNN): 85.87
Average Accuracy (NME): 88.37
2024-04-29 13:22:13,093 [trainer.py] => Average Accuracy (CNN): 85.87
2024-04-29 13:22:13,093 [trainer.py] => Average Accuracy (NME): 88.37
2024-04-29 13:22:13,093 [trainer.py] => Train Time: 0
2024-04-29 13:22:13,093 [trainer.py] => Test Time: 61.21 

Accuracy Matrix (CNN):
[[89.48 86.87 85.69 81.73 79.88 76.94]
 [ 0.   92.98 90.35 87.72 87.28 85.09]
 [ 0.    0.   91.11 88.89 87.56 83.56]
 [ 0.    0.    0.   94.4  88.8  87.6 ]
 [ 0.    0.    0.    0.   94.09 91.14]
 [ 0.    0.    0.    0.    0.   85.22]]
2024-04-29 13:22:13,094 [trainer.py] => Forgetting (CNN): 7.546000000000004
Accuracy Matrix (NME):
[[90.57 89.56 88.05 86.28 86.78 85.35]
 [ 0.   89.04 89.47 88.6  87.28 87.72]
 [ 0.    0.   88.89 88.89 88.44 84.89]
 [ 0.    0.    0.   92.4  90.4  89.6 ]
 [ 0.    0.    0.    0.   90.3  87.76]
 [ 0.    0.    0.    0.    0.   86.09]]
2024-04-29 13:22:13,095 [trainer.py] => Forgetting (NME): 3.2620000000000005
2024-04-29 13:22:16,229 [trainer.py] => config: ./exps/der_cub_B100_Inc5.json
2024-04-29 13:22:16,229 [trainer.py] => prefix: reproduce
2024-04-29 13:22:16,229 [trainer.py] => dataset: cub
2024-04-29 13:22:16,229 [trainer.py] => memory_size: 2000
2024-04-29 13:22:16,229 [trainer.py] => memory_per_class: 20
2024-04-29 13:22:16,229 [trainer.py] => fixed_memory: False
2024-04-29 13:22:16,229 [trainer.py] => shuffle: True
2024-04-29 13:22:16,229 [trainer.py] => init_cls: 100
2024-04-29 13:22:16,229 [trainer.py] => increment: 20
2024-04-29 13:22:16,229 [trainer.py] => model_name: der
2024-04-29 13:22:16,230 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-29 13:22:16,230 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-29 13:22:16,230 [trainer.py] => seed: 1993
2024-04-29 13:22:16,230 [trainer.py] => init_epoch: 20
2024-04-29 13:22:16,230 [trainer.py] => init_lr: 0.001
2024-04-29 13:22:16,230 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-29 13:22:16,230 [trainer.py] => init_lr_decay: 0.1
2024-04-29 13:22:16,230 [trainer.py] => init_weight_decay: 0.0005
2024-04-29 13:22:16,230 [trainer.py] => epochs: 20
2024-04-29 13:22:16,230 [trainer.py] => lrate: 0.001
2024-04-29 13:22:16,230 [trainer.py] => milestones: [80, 120, 150]
2024-04-29 13:22:16,230 [trainer.py] => lrate_decay: 0.1
2024-04-29 13:22:16,230 [trainer.py] => batch_size: 48
2024-04-29 13:22:16,230 [trainer.py] => weight_decay: 0.0002
2024-04-29 13:22:16,230 [trainer.py] => T: 2
2024-04-29 13:22:16,285 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-29 13:22:16,665 [trainer.py] => All params: 0
2024-04-29 13:22:16,665 [trainer.py] => Trainable params: 0
2024-04-29 13:22:20,742 [der.py] => Learning on 0-100
2024-04-29 13:22:20,743 [der.py] => All params: 85953225
2024-04-29 13:22:20,744 [der.py] => Trainable params: 85953225
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.277, Train_accy 27.89, Test_accy 75.34:   0%|          | 0/20 [00:35<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.277, Train_accy 27.89, Test_accy 75.34:   5%|▌         | 1/20 [00:35<11:08, 35.20s/it]Task 0, Epoch 2/20 => Loss 0.990, Train_accy 72.22:   5%|▌         | 1/20 [01:06<11:08, 35.20s/it]                 Task 0, Epoch 2/20 => Loss 0.990, Train_accy 72.22:  10%|█         | 2/20 [01:06<09:54, 33.01s/it]Task 0, Epoch 3/20 => Loss 0.707, Train_accy 80.46:  10%|█         | 2/20 [01:38<09:54, 33.01s/it]Task 0, Epoch 3/20 => Loss 0.707, Train_accy 80.46:  15%|█▌        | 3/20 [01:38<09:09, 32.34s/it]Task 0, Epoch 4/20 => Loss 0.624, Train_accy 82.81:  15%|█▌        | 3/20 [02:09<09:09, 32.34s/it]Task 0, Epoch 4/20 => Loss 0.624, Train_accy 82.81:  20%|██        | 4/20 [02:09<08:31, 31.99s/it]Task 0, Epoch 5/20 => Loss 0.530, Train_accy 85.07:  20%|██        | 4/20 [02:41<08:31, 31.99s/it]Task 0, Epoch 5/20 => Loss 0.530, Train_accy 85.07:  25%|██▌       | 5/20 [02:41<07:57, 31.86s/it]Task 0, Epoch 6/20 => Loss 0.527, Train_accy 85.58, Test_accy 88.64:  25%|██▌       | 5/20 [03:16<07:57, 31.86s/it]Task 0, Epoch 6/20 => Loss 0.527, Train_accy 85.58, Test_accy 88.64:  30%|███       | 6/20 [03:16<07:42, 33.01s/it]Task 0, Epoch 7/20 => Loss 0.492, Train_accy 86.58:  30%|███       | 6/20 [03:48<07:42, 33.01s/it]                 Task 0, Epoch 7/20 => Loss 0.492, Train_accy 86.58:  35%|███▌      | 7/20 [03:48<07:03, 32.57s/it]Task 0, Epoch 8/20 => Loss 0.458, Train_accy 87.79:  35%|███▌      | 7/20 [04:20<07:03, 32.57s/it]Task 0, Epoch 8/20 => Loss 0.458, Train_accy 87.79:  40%|████      | 8/20 [04:20<06:28, 32.34s/it]Task 0, Epoch 9/20 => Loss 0.416, Train_accy 89.11:  40%|████      | 8/20 [04:51<06:28, 32.34s/it]Task 0, Epoch 9/20 => Loss 0.416, Train_accy 89.11:  45%|████▌     | 9/20 [04:51<05:53, 32.13s/it]Task 0, Epoch 10/20 => Loss 0.427, Train_accy 88.30:  45%|████▌     | 9/20 [05:23<05:53, 32.13s/it]Task 0, Epoch 10/20 => Loss 0.427, Train_accy 88.30:  50%|█████     | 10/20 [05:23<05:20, 32.02s/it]Task 0, Epoch 11/20 => Loss 0.421, Train_accy 88.71, Test_accy 88.30:  50%|█████     | 10/20 [05:58<05:20, 32.02s/it]Task 0, Epoch 11/20 => Loss 0.421, Train_accy 88.71, Test_accy 88.30:  55%|█████▌    | 11/20 [05:58<04:57, 33.07s/it]Task 0, Epoch 12/20 => Loss 0.393, Train_accy 89.39:  55%|█████▌    | 11/20 [06:31<04:57, 33.07s/it]                 Task 0, Epoch 12/20 => Loss 0.393, Train_accy 89.39:  60%|██████    | 12/20 [06:31<04:22, 32.83s/it]Task 0, Epoch 13/20 => Loss 0.367, Train_accy 89.75:  60%|██████    | 12/20 [07:03<04:22, 32.83s/it]Task 0, Epoch 13/20 => Loss 0.367, Train_accy 89.75:  65%|██████▌   | 13/20 [07:03<03:48, 32.65s/it]Task 0, Epoch 14/20 => Loss 0.377, Train_accy 89.37:  65%|██████▌   | 13/20 [07:35<03:48, 32.65s/it]Task 0, Epoch 14/20 => Loss 0.377, Train_accy 89.37:  70%|███████   | 14/20 [07:35<03:14, 32.47s/it]Task 0, Epoch 15/20 => Loss 0.368, Train_accy 90.16:  70%|███████   | 14/20 [08:07<03:14, 32.47s/it]Task 0, Epoch 15/20 => Loss 0.368, Train_accy 90.16:  75%|███████▌  | 15/20 [08:07<02:41, 32.33s/it]Task 0, Epoch 16/20 => Loss 0.352, Train_accy 90.75, Test_accy 90.32:  75%|███████▌  | 15/20 [08:42<02:41, 32.33s/it]Task 0, Epoch 16/20 => Loss 0.352, Train_accy 90.75, Test_accy 90.32:  80%|████████  | 16/20 [08:42<02:13, 33.27s/it]Task 0, Epoch 17/20 => Loss 0.364, Train_accy 89.97:  80%|████████  | 16/20 [09:14<02:13, 33.27s/it]                 Task 0, Epoch 17/20 => Loss 0.364, Train_accy 89.97:  85%|████████▌ | 17/20 [09:14<01:38, 32.83s/it]Task 0, Epoch 18/20 => Loss 0.356, Train_accy 90.54:  85%|████████▌ | 17/20 [09:46<01:38, 32.83s/it]Task 0, Epoch 18/20 => Loss 0.356, Train_accy 90.54:  90%|█████████ | 18/20 [09:46<01:05, 32.54s/it]Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.63:  90%|█████████ | 18/20 [10:18<01:05, 32.54s/it]Task 0, Epoch 19/20 => Loss 0.313, Train_accy 91.63:  95%|█████████▌| 19/20 [10:18<00:32, 32.33s/it]Task 0, Epoch 20/20 => Loss 0.353, Train_accy 91.01:  95%|█████████▌| 19/20 [10:50<00:32, 32.33s/it]Task 0, Epoch 20/20 => Loss 0.353, Train_accy 91.01: 100%|██████████| 20/20 [10:50<00:00, 32.14s/it]Task 0, Epoch 20/20 => Loss 0.353, Train_accy 91.01: 100%|██████████| 20/20 [10:50<00:00, 32.51s/it]
2024-04-29 13:33:11,406 [der.py] => Task 0, Epoch 20/20 => Loss 0.353, Train_accy 91.01
2024-04-29 13:33:11,408 [base.py] => Reducing exemplars...(20 per classes)
2024-04-29 13:33:11,409 [base.py] => Constructing exemplars...(20 per classes)
2024-04-29 13:34:44,187 [der.py] => Exemplar size: 2000
2024-04-29 13:34:44,188 [trainer.py] => CNN: {'total': 88.64, '00-99': 88.64, 'old': 0, 'new': 88.64}
2024-04-29 13:34:44,188 [trainer.py] => NME: {'total': 90.57, '00-99': 90.57, 'old': 0, 'new': 90.57}
2024-04-29 13:34:44,188 [trainer.py] => CNN top1 curve: [88.64]
2024-04-29 13:34:44,188 [trainer.py] => CNN top5 curve: [98.15]
2024-04-29 13:34:44,188 [trainer.py] => NME top1 curve: [90.57]
2024-04-29 13:34:44,188 [trainer.py] => NME top5 curve: [98.65]

Average Accuracy (CNN): 88.64
Average Accuracy (NME): 90.57
2024-04-29 13:34:44,188 [trainer.py] => Average Accuracy (CNN): 88.64
2024-04-29 13:34:44,188 [trainer.py] => Average Accuracy (NME): 90.57
2024-04-29 13:34:44,188 [trainer.py] => Train Time: 650.66
2024-04-29 13:34:44,188 [trainer.py] => Test Time: 6.99 

2024-04-29 13:34:44,189 [trainer.py] => All params: 85953225
2024-04-29 13:34:44,189 [trainer.py] => Trainable params: 85953225
2024-04-29 13:34:46,705 [der.py] => Learning on 100-120
2024-04-29 13:34:46,707 [der.py] => All params: 171797901
2024-04-29 13:34:46,708 [der.py] => Trainable params: 85999245
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.529, Loss_clf 1.498, Loss_aux 1.032, Train_accy 74.63, Test_accy 83.19:   0%|          | 0/20 [00:34<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.529, Loss_clf 1.498, Loss_aux 1.032, Train_accy 74.63, Test_accy 83.19:   5%|▌         | 1/20 [00:34<10:59, 34.71s/it]Task 1, Epoch 2/20 => Loss 0.814, Loss_clf 0.477, Loss_aux 0.337, Train_accy 86.42:   5%|▌         | 1/20 [01:01<10:59, 34.71s/it]                 Task 1, Epoch 2/20 => Loss 0.814, Loss_clf 0.477, Loss_aux 0.337, Train_accy 86.42:  10%|█         | 2/20 [01:01<09:05, 30.31s/it]Task 1, Epoch 3/20 => Loss 0.725, Loss_clf 0.451, Loss_aux 0.274, Train_accy 87.03:  10%|█         | 2/20 [01:29<09:05, 30.31s/it]Task 1, Epoch 3/20 => Loss 0.725, Loss_clf 0.451, Loss_aux 0.274, Train_accy 87.03:  15%|█▌        | 3/20 [01:29<08:13, 29.01s/it]Task 1, Epoch 4/20 => Loss 0.583, Loss_clf 0.367, Loss_aux 0.216, Train_accy 90.01:  15%|█▌        | 3/20 [01:56<08:13, 29.01s/it]Task 1, Epoch 4/20 => Loss 0.583, Loss_clf 0.367, Loss_aux 0.216, Train_accy 90.01:  20%|██        | 4/20 [01:56<07:34, 28.42s/it]Task 1, Epoch 5/20 => Loss 0.575, Loss_clf 0.367, Loss_aux 0.208, Train_accy 90.28:  20%|██        | 4/20 [02:24<07:34, 28.42s/it]Task 1, Epoch 5/20 => Loss 0.575, Loss_clf 0.367, Loss_aux 0.208, Train_accy 90.28:  25%|██▌       | 5/20 [02:24<07:01, 28.08s/it]Task 1, Epoch 6/20 => Loss 0.526, Loss_clf 0.344, Loss_aux 0.182, Train_accy 90.65, Test_accy 86.44:  25%|██▌       | 5/20 [02:59<07:01, 28.08s/it]Task 1, Epoch 6/20 => Loss 0.526, Loss_clf 0.344, Loss_aux 0.182, Train_accy 90.65, Test_accy 86.44:  30%|███       | 6/20 [02:59<07:07, 30.52s/it]Task 1, Epoch 7/20 => Loss 0.506, Loss_clf 0.322, Loss_aux 0.184, Train_accy 91.90:  30%|███       | 6/20 [03:26<07:07, 30.52s/it]                 Task 1, Epoch 7/20 => Loss 0.506, Loss_clf 0.322, Loss_aux 0.184, Train_accy 91.90:  35%|███▌      | 7/20 [03:26<06:23, 29.47s/it]Task 1, Epoch 8/20 => Loss 0.526, Loss_clf 0.332, Loss_aux 0.193, Train_accy 91.09:  35%|███▌      | 7/20 [03:54<06:23, 29.47s/it]Task 1, Epoch 8/20 => Loss 0.526, Loss_clf 0.332, Loss_aux 0.193, Train_accy 91.09:  40%|████      | 8/20 [03:54<05:45, 28.81s/it]Task 1, Epoch 9/20 => Loss 0.463, Loss_clf 0.300, Loss_aux 0.164, Train_accy 91.46:  40%|████      | 8/20 [04:21<05:45, 28.81s/it]Task 1, Epoch 9/20 => Loss 0.463, Loss_clf 0.300, Loss_aux 0.164, Train_accy 91.46:  45%|████▌     | 9/20 [04:21<05:11, 28.32s/it]Task 1, Epoch 10/20 => Loss 0.463, Loss_clf 0.297, Loss_aux 0.166, Train_accy 92.11:  45%|████▌     | 9/20 [04:48<05:11, 28.32s/it]Task 1, Epoch 10/20 => Loss 0.463, Loss_clf 0.297, Loss_aux 0.166, Train_accy 92.11:  50%|█████     | 10/20 [04:48<04:39, 27.97s/it]Task 1, Epoch 11/20 => Loss 0.441, Loss_clf 0.292, Loss_aux 0.149, Train_accy 92.51, Test_accy 87.92:  50%|█████     | 10/20 [05:23<04:39, 27.97s/it]Task 1, Epoch 11/20 => Loss 0.441, Loss_clf 0.292, Loss_aux 0.149, Train_accy 92.51, Test_accy 87.92:  55%|█████▌    | 11/20 [05:23<04:30, 30.09s/it]Task 1, Epoch 12/20 => Loss 0.419, Loss_clf 0.298, Loss_aux 0.121, Train_accy 91.80:  55%|█████▌    | 11/20 [05:50<04:30, 30.09s/it]                 Task 1, Epoch 12/20 => Loss 0.419, Loss_clf 0.298, Loss_aux 0.121, Train_accy 91.80:  60%|██████    | 12/20 [05:50<03:53, 29.23s/it]Task 1, Epoch 13/20 => Loss 0.430, Loss_clf 0.285, Loss_aux 0.145, Train_accy 92.14:  60%|██████    | 12/20 [06:18<03:53, 29.23s/it]Task 1, Epoch 13/20 => Loss 0.430, Loss_clf 0.285, Loss_aux 0.145, Train_accy 92.14:  65%|██████▌   | 13/20 [06:18<03:20, 28.62s/it]Task 1, Epoch 14/20 => Loss 0.443, Loss_clf 0.294, Loss_aux 0.149, Train_accy 92.28:  65%|██████▌   | 13/20 [06:45<03:20, 28.62s/it]Task 1, Epoch 14/20 => Loss 0.443, Loss_clf 0.294, Loss_aux 0.149, Train_accy 92.28:  70%|███████   | 14/20 [06:45<02:49, 28.19s/it]Task 1, Epoch 15/20 => Loss 0.398, Loss_clf 0.266, Loss_aux 0.133, Train_accy 92.82:  70%|███████   | 14/20 [07:12<02:49, 28.19s/it]Task 1, Epoch 15/20 => Loss 0.398, Loss_clf 0.266, Loss_aux 0.133, Train_accy 92.82:  75%|███████▌  | 15/20 [07:12<02:19, 27.96s/it]Task 1, Epoch 16/20 => Loss 0.427, Loss_clf 0.284, Loss_aux 0.143, Train_accy 92.48, Test_accy 87.64:  75%|███████▌  | 15/20 [07:48<02:19, 27.96s/it]Task 1, Epoch 16/20 => Loss 0.427, Loss_clf 0.284, Loss_aux 0.143, Train_accy 92.48, Test_accy 87.64:  80%|████████  | 16/20 [07:48<02:00, 30.17s/it]Task 1, Epoch 17/20 => Loss 0.420, Loss_clf 0.273, Loss_aux 0.147, Train_accy 92.48:  80%|████████  | 16/20 [08:15<02:00, 30.17s/it]                 Task 1, Epoch 17/20 => Loss 0.420, Loss_clf 0.273, Loss_aux 0.147, Train_accy 92.48:  85%|████████▌ | 17/20 [08:15<01:27, 29.30s/it]Task 1, Epoch 18/20 => Loss 0.391, Loss_clf 0.267, Loss_aux 0.124, Train_accy 92.82:  85%|████████▌ | 17/20 [08:42<01:27, 29.30s/it]Task 1, Epoch 18/20 => Loss 0.391, Loss_clf 0.267, Loss_aux 0.124, Train_accy 92.82:  90%|█████████ | 18/20 [08:42<00:57, 28.65s/it]Task 1, Epoch 19/20 => Loss 0.404, Loss_clf 0.262, Loss_aux 0.142, Train_accy 92.65:  90%|█████████ | 18/20 [09:09<00:57, 28.65s/it]Task 1, Epoch 19/20 => Loss 0.404, Loss_clf 0.262, Loss_aux 0.142, Train_accy 92.65:  95%|█████████▌| 19/20 [09:09<00:28, 28.27s/it]Task 1, Epoch 20/20 => Loss 0.392, Loss_clf 0.276, Loss_aux 0.116, Train_accy 92.65:  95%|█████████▌| 19/20 [09:37<00:28, 28.27s/it]Task 1, Epoch 20/20 => Loss 0.392, Loss_clf 0.276, Loss_aux 0.116, Train_accy 92.65: 100%|██████████| 20/20 [09:37<00:00, 27.95s/it]Task 1, Epoch 20/20 => Loss 0.392, Loss_clf 0.276, Loss_aux 0.116, Train_accy 92.65: 100%|██████████| 20/20 [09:37<00:00, 28.86s/it]
2024-04-29 13:44:23,864 [der.py] => Task 1, Epoch 20/20 => Loss 0.392, Loss_clf 0.276, Loss_aux 0.116, Train_accy 92.65
2024-04-29 13:44:23,865 [base.py] => Reducing exemplars...(16 per classes)
2024-04-29 13:45:03,351 [base.py] => Constructing exemplars...(16 per classes)
2024-04-29 13:45:40,498 [der.py] => Exemplar size: 1920
2024-04-29 13:45:40,499 [trainer.py] => CNN: {'total': 88.42, '00-99': 87.54, '100-119': 92.98, 'old': 87.54, 'new': 92.98}
2024-04-29 13:45:40,499 [trainer.py] => NME: {'total': 88.77, '00-99': 88.8, '100-119': 88.6, 'old': 88.8, 'new': 88.6}
2024-04-29 13:45:40,499 [trainer.py] => CNN top1 curve: [88.64, 88.42]
2024-04-29 13:45:40,499 [trainer.py] => CNN top5 curve: [98.15, 97.95]
2024-04-29 13:45:40,499 [trainer.py] => NME top1 curve: [90.57, 88.77]
2024-04-29 13:45:40,499 [trainer.py] => NME top5 curve: [98.65, 98.45]

Average Accuracy (CNN): 88.53
Average Accuracy (NME): 89.67
2024-04-29 13:45:40,499 [trainer.py] => Average Accuracy (CNN): 88.53
2024-04-29 13:45:40,499 [trainer.py] => Average Accuracy (NME): 89.67
2024-04-29 13:45:40,499 [trainer.py] => Train Time: 1227.81
2024-04-29 13:45:40,499 [trainer.py] => Test Time: 21.880000000000003 

2024-04-29 13:45:40,500 [trainer.py] => All params: 171797901
2024-04-29 13:45:40,501 [trainer.py] => Trainable params: 85999245
2024-04-29 13:45:42,666 [der.py] => Learning on 120-140
2024-04-29 13:45:42,669 [der.py] => All params: 257734817
2024-04-29 13:45:42,671 [der.py] => Trainable params: 86137505
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.610, Loss_clf 1.554, Loss_aux 1.056, Train_accy 73.94, Test_accy 86.05:   0%|          | 0/20 [00:45<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.610, Loss_clf 1.554, Loss_aux 1.056, Train_accy 73.94, Test_accy 86.05:   5%|▌         | 1/20 [00:45<14:21, 45.37s/it]Task 2, Epoch 2/20 => Loss 0.854, Loss_clf 0.491, Loss_aux 0.363, Train_accy 86.53:   5%|▌         | 1/20 [01:18<14:21, 45.37s/it]                 Task 2, Epoch 2/20 => Loss 0.854, Loss_clf 0.491, Loss_aux 0.363, Train_accy 86.53:  10%|█         | 2/20 [01:18<11:27, 38.18s/it]Task 2, Epoch 3/20 => Loss 0.703, Loss_clf 0.431, Loss_aux 0.273, Train_accy 87.89:  10%|█         | 2/20 [01:51<11:27, 38.18s/it]Task 2, Epoch 3/20 => Loss 0.703, Loss_clf 0.431, Loss_aux 0.273, Train_accy 87.89:  15%|█▌        | 3/20 [01:51<10:11, 35.95s/it]Task 2, Epoch 4/20 => Loss 0.615, Loss_clf 0.380, Loss_aux 0.235, Train_accy 89.39:  15%|█▌        | 3/20 [02:25<10:11, 35.95s/it]Task 2, Epoch 4/20 => Loss 0.615, Loss_clf 0.380, Loss_aux 0.235, Train_accy 89.39:  20%|██        | 4/20 [02:25<09:18, 34.90s/it]Task 2, Epoch 5/20 => Loss 0.635, Loss_clf 0.395, Loss_aux 0.240, Train_accy 89.28:  20%|██        | 4/20 [02:58<09:18, 34.90s/it]Task 2, Epoch 5/20 => Loss 0.635, Loss_clf 0.395, Loss_aux 0.240, Train_accy 89.28:  25%|██▌       | 5/20 [02:58<08:36, 34.41s/it]Task 2, Epoch 6/20 => Loss 0.583, Loss_clf 0.361, Loss_aux 0.222, Train_accy 90.74, Test_accy 86.53:  25%|██▌       | 5/20 [03:44<08:36, 34.41s/it]Task 2, Epoch 6/20 => Loss 0.583, Loss_clf 0.361, Loss_aux 0.222, Train_accy 90.74, Test_accy 86.53:  30%|███       | 6/20 [03:44<08:57, 38.36s/it]Task 2, Epoch 7/20 => Loss 0.593, Loss_clf 0.376, Loss_aux 0.217, Train_accy 89.84:  30%|███       | 6/20 [04:18<08:57, 38.36s/it]                 Task 2, Epoch 7/20 => Loss 0.593, Loss_clf 0.376, Loss_aux 0.217, Train_accy 89.84:  35%|███▌      | 7/20 [04:18<07:57, 36.75s/it]Task 2, Epoch 8/20 => Loss 0.533, Loss_clf 0.336, Loss_aux 0.197, Train_accy 90.92:  35%|███▌      | 7/20 [04:51<07:57, 36.75s/it]Task 2, Epoch 8/20 => Loss 0.533, Loss_clf 0.336, Loss_aux 0.197, Train_accy 90.92:  40%|████      | 8/20 [04:51<07:08, 35.70s/it]Task 2, Epoch 9/20 => Loss 0.538, Loss_clf 0.349, Loss_aux 0.189, Train_accy 91.02:  40%|████      | 8/20 [05:25<07:08, 35.70s/it]Task 2, Epoch 9/20 => Loss 0.538, Loss_clf 0.349, Loss_aux 0.189, Train_accy 91.02:  45%|████▌     | 9/20 [05:25<06:25, 35.06s/it]Task 2, Epoch 10/20 => Loss 0.509, Loss_clf 0.333, Loss_aux 0.176, Train_accy 91.06:  45%|████▌     | 9/20 [05:58<06:25, 35.06s/it]Task 2, Epoch 10/20 => Loss 0.509, Loss_clf 0.333, Loss_aux 0.176, Train_accy 91.06:  50%|█████     | 10/20 [05:58<05:45, 34.58s/it]Task 2, Epoch 11/20 => Loss 0.516, Loss_clf 0.338, Loss_aux 0.178, Train_accy 90.74, Test_accy 86.47:  50%|█████     | 10/20 [06:44<05:45, 34.58s/it]Task 2, Epoch 11/20 => Loss 0.516, Loss_clf 0.338, Loss_aux 0.178, Train_accy 90.74, Test_accy 86.47:  55%|█████▌    | 11/20 [06:44<05:43, 38.13s/it]Task 2, Epoch 12/20 => Loss 0.491, Loss_clf 0.311, Loss_aux 0.180, Train_accy 91.48:  55%|█████▌    | 11/20 [07:18<05:43, 38.13s/it]                 Task 2, Epoch 12/20 => Loss 0.491, Loss_clf 0.311, Loss_aux 0.180, Train_accy 91.48:  60%|██████    | 12/20 [07:18<04:53, 36.72s/it]Task 2, Epoch 13/20 => Loss 0.458, Loss_clf 0.305, Loss_aux 0.153, Train_accy 91.44:  60%|██████    | 12/20 [07:51<04:53, 36.72s/it]Task 2, Epoch 13/20 => Loss 0.458, Loss_clf 0.305, Loss_aux 0.153, Train_accy 91.44:  65%|██████▌   | 13/20 [07:51<04:10, 35.72s/it]Task 2, Epoch 14/20 => Loss 0.403, Loss_clf 0.271, Loss_aux 0.132, Train_accy 92.94:  65%|██████▌   | 13/20 [08:25<04:10, 35.72s/it]Task 2, Epoch 14/20 => Loss 0.403, Loss_clf 0.271, Loss_aux 0.132, Train_accy 92.94:  70%|███████   | 14/20 [08:25<03:29, 34.98s/it]Task 2, Epoch 15/20 => Loss 0.458, Loss_clf 0.301, Loss_aux 0.157, Train_accy 91.79:  70%|███████   | 14/20 [08:58<03:29, 34.98s/it]Task 2, Epoch 15/20 => Loss 0.458, Loss_clf 0.301, Loss_aux 0.157, Train_accy 91.79:  75%|███████▌  | 15/20 [08:58<02:52, 34.49s/it]Task 2, Epoch 16/20 => Loss 0.474, Loss_clf 0.298, Loss_aux 0.176, Train_accy 92.52, Test_accy 87.14:  75%|███████▌  | 15/20 [09:44<02:52, 34.49s/it]Task 2, Epoch 16/20 => Loss 0.474, Loss_clf 0.298, Loss_aux 0.176, Train_accy 92.52, Test_accy 87.14:  80%|████████  | 16/20 [09:44<02:31, 37.91s/it]Task 2, Epoch 17/20 => Loss 0.407, Loss_clf 0.271, Loss_aux 0.136, Train_accy 92.73:  80%|████████  | 16/20 [10:17<02:31, 37.91s/it]                 Task 2, Epoch 17/20 => Loss 0.407, Loss_clf 0.271, Loss_aux 0.136, Train_accy 92.73:  85%|████████▌ | 17/20 [10:17<01:49, 36.48s/it]Task 2, Epoch 18/20 => Loss 0.426, Loss_clf 0.287, Loss_aux 0.139, Train_accy 92.03:  85%|████████▌ | 17/20 [10:50<01:49, 36.48s/it]Task 2, Epoch 18/20 => Loss 0.426, Loss_clf 0.287, Loss_aux 0.139, Train_accy 92.03:  90%|█████████ | 18/20 [10:50<01:11, 35.55s/it]Task 2, Epoch 19/20 => Loss 0.443, Loss_clf 0.287, Loss_aux 0.156, Train_accy 92.31:  90%|█████████ | 18/20 [11:24<01:11, 35.55s/it]Task 2, Epoch 19/20 => Loss 0.443, Loss_clf 0.287, Loss_aux 0.156, Train_accy 92.31:  95%|█████████▌| 19/20 [11:24<00:34, 34.91s/it]Task 2, Epoch 20/20 => Loss 0.479, Loss_clf 0.321, Loss_aux 0.158, Train_accy 92.00:  95%|█████████▌| 19/20 [11:57<00:34, 34.91s/it]Task 2, Epoch 20/20 => Loss 0.479, Loss_clf 0.321, Loss_aux 0.158, Train_accy 92.00: 100%|██████████| 20/20 [11:57<00:00, 34.44s/it]Task 2, Epoch 20/20 => Loss 0.479, Loss_clf 0.321, Loss_aux 0.158, Train_accy 92.00: 100%|██████████| 20/20 [11:57<00:00, 35.88s/it]
2024-04-29 13:57:40,313 [der.py] => Task 2, Epoch 20/20 => Loss 0.479, Loss_clf 0.321, Loss_aux 0.158, Train_accy 92.00
2024-04-29 13:57:40,314 [base.py] => Reducing exemplars...(14 per classes)
2024-04-29 13:58:31,378 [base.py] => Constructing exemplars...(14 per classes)
2024-04-29 13:59:23,966 [der.py] => Exemplar size: 1960
2024-04-29 13:59:23,966 [trainer.py] => CNN: {'total': 87.02, '00-99': 85.86, '100-119': 90.35, '120-139': 89.78, 'old': 86.58, 'new': 89.78}
2024-04-29 13:59:23,966 [trainer.py] => NME: {'total': 87.75, '00-99': 87.54, '100-119': 89.91, '120-139': 86.67, 'old': 87.92, 'new': 86.67}
2024-04-29 13:59:23,966 [trainer.py] => CNN top1 curve: [88.64, 88.42, 87.02]
2024-04-29 13:59:23,966 [trainer.py] => CNN top5 curve: [98.15, 97.95, 97.32]
2024-04-29 13:59:23,966 [trainer.py] => NME top1 curve: [90.57, 88.77, 87.75]
2024-04-29 13:59:23,967 [trainer.py] => NME top5 curve: [98.65, 98.45, 98.54]

Average Accuracy (CNN): 88.03
Average Accuracy (NME): 89.03
2024-04-29 13:59:23,967 [trainer.py] => Average Accuracy (CNN): 88.03
2024-04-29 13:59:23,967 [trainer.py] => Average Accuracy (NME): 89.03
2024-04-29 13:59:23,967 [trainer.py] => Train Time: 1945.4499999999998
2024-04-29 13:59:23,967 [trainer.py] => Test Time: 47.45 

2024-04-29 13:59:23,970 [trainer.py] => All params: 257734817
2024-04-29 13:59:23,972 [trainer.py] => Trainable params: 86137505
2024-04-29 13:59:28,720 [der.py] => Learning on 140-160
2024-04-29 13:59:28,725 [der.py] => All params: 343702453
2024-04-29 13:59:28,726 [der.py] => Trainable params: 86306485
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.560, Loss_clf 1.491, Loss_aux 1.069, Train_accy 76.77, Test_accy 84.08:   0%|          | 0/20 [00:58<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.560, Loss_clf 1.491, Loss_aux 1.069, Train_accy 76.77, Test_accy 84.08:   5%|▌         | 1/20 [00:58<18:37, 58.84s/it]Task 3, Epoch 2/20 => Loss 0.831, Loss_clf 0.444, Loss_aux 0.387, Train_accy 87.92:   5%|▌         | 1/20 [01:39<18:37, 58.84s/it]                 Task 3, Epoch 2/20 => Loss 0.831, Loss_clf 0.444, Loss_aux 0.387, Train_accy 87.92:  10%|█         | 2/20 [01:39<14:22, 47.94s/it]Task 3, Epoch 3/20 => Loss 0.745, Loss_clf 0.434, Loss_aux 0.311, Train_accy 88.12:  10%|█         | 2/20 [02:19<14:22, 47.94s/it]Task 3, Epoch 3/20 => Loss 0.745, Loss_clf 0.434, Loss_aux 0.311, Train_accy 88.12:  15%|█▌        | 3/20 [02:19<12:34, 44.39s/it]Task 3, Epoch 4/20 => Loss 0.657, Loss_clf 0.401, Loss_aux 0.256, Train_accy 88.92:  15%|█▌        | 3/20 [02:59<12:34, 44.39s/it]Task 3, Epoch 4/20 => Loss 0.657, Loss_clf 0.401, Loss_aux 0.256, Train_accy 88.92:  20%|██        | 4/20 [02:59<11:23, 42.74s/it]Task 3, Epoch 5/20 => Loss 0.607, Loss_clf 0.361, Loss_aux 0.246, Train_accy 90.35:  20%|██        | 4/20 [03:39<11:23, 42.74s/it]Task 3, Epoch 5/20 => Loss 0.607, Loss_clf 0.361, Loss_aux 0.246, Train_accy 90.35:  25%|██▌       | 5/20 [03:39<10:27, 41.83s/it]Task 3, Epoch 6/20 => Loss 0.576, Loss_clf 0.354, Loss_aux 0.222, Train_accy 90.45, Test_accy 86.09:  25%|██▌       | 5/20 [04:38<10:27, 41.83s/it]Task 3, Epoch 6/20 => Loss 0.576, Loss_clf 0.354, Loss_aux 0.222, Train_accy 90.45, Test_accy 86.09:  30%|███       | 6/20 [04:38<11:08, 47.73s/it]Task 3, Epoch 7/20 => Loss 0.571, Loss_clf 0.376, Loss_aux 0.195, Train_accy 90.21:  30%|███       | 6/20 [05:19<11:08, 47.73s/it]                 Task 3, Epoch 7/20 => Loss 0.571, Loss_clf 0.376, Loss_aux 0.195, Train_accy 90.21:  35%|███▌      | 7/20 [05:19<09:48, 45.25s/it]Task 3, Epoch 8/20 => Loss 0.491, Loss_clf 0.314, Loss_aux 0.176, Train_accy 91.74:  35%|███▌      | 7/20 [05:59<09:48, 45.25s/it]Task 3, Epoch 8/20 => Loss 0.491, Loss_clf 0.314, Loss_aux 0.176, Train_accy 91.74:  40%|████      | 8/20 [05:59<08:43, 43.66s/it]Task 3, Epoch 9/20 => Loss 0.491, Loss_clf 0.327, Loss_aux 0.164, Train_accy 91.46:  40%|████      | 8/20 [06:39<08:43, 43.66s/it]Task 3, Epoch 9/20 => Loss 0.491, Loss_clf 0.327, Loss_aux 0.164, Train_accy 91.46:  45%|████▌     | 9/20 [06:39<07:49, 42.68s/it]Task 3, Epoch 10/20 => Loss 0.485, Loss_clf 0.324, Loss_aux 0.162, Train_accy 92.05:  45%|████▌     | 9/20 [07:20<07:49, 42.68s/it]Task 3, Epoch 10/20 => Loss 0.485, Loss_clf 0.324, Loss_aux 0.162, Train_accy 92.05:  50%|█████     | 10/20 [07:20<07:00, 42.01s/it]Task 3, Epoch 11/20 => Loss 0.498, Loss_clf 0.317, Loss_aux 0.181, Train_accy 91.74, Test_accy 85.03:  50%|█████     | 10/20 [08:19<07:00, 42.01s/it]Task 3, Epoch 11/20 => Loss 0.498, Loss_clf 0.317, Loss_aux 0.181, Train_accy 91.74, Test_accy 85.03:  55%|█████▌    | 11/20 [08:19<07:06, 47.38s/it]Task 3, Epoch 12/20 => Loss 0.549, Loss_clf 0.369, Loss_aux 0.181, Train_accy 90.42:  55%|█████▌    | 11/20 [09:00<07:06, 47.38s/it]                 Task 3, Epoch 12/20 => Loss 0.549, Loss_clf 0.369, Loss_aux 0.181, Train_accy 90.42:  60%|██████    | 12/20 [09:00<06:01, 45.25s/it]Task 3, Epoch 13/20 => Loss 0.503, Loss_clf 0.326, Loss_aux 0.177, Train_accy 91.49:  60%|██████    | 12/20 [09:40<06:01, 45.25s/it]Task 3, Epoch 13/20 => Loss 0.503, Loss_clf 0.326, Loss_aux 0.177, Train_accy 91.49:  65%|██████▌   | 13/20 [09:40<05:06, 43.73s/it]Task 3, Epoch 14/20 => Loss 0.473, Loss_clf 0.317, Loss_aux 0.156, Train_accy 91.81:  65%|██████▌   | 13/20 [10:20<05:06, 43.73s/it]Task 3, Epoch 14/20 => Loss 0.473, Loss_clf 0.317, Loss_aux 0.156, Train_accy 91.81:  70%|███████   | 14/20 [10:20<04:15, 42.65s/it]Task 3, Epoch 15/20 => Loss 0.415, Loss_clf 0.276, Loss_aux 0.139, Train_accy 92.81:  70%|███████   | 14/20 [11:00<04:15, 42.65s/it]Task 3, Epoch 15/20 => Loss 0.415, Loss_clf 0.276, Loss_aux 0.139, Train_accy 92.81:  75%|███████▌  | 15/20 [11:00<03:29, 41.91s/it]Task 3, Epoch 16/20 => Loss 0.412, Loss_clf 0.277, Loss_aux 0.135, Train_accy 92.40, Test_accy 86.36:  75%|███████▌  | 15/20 [11:59<03:29, 41.91s/it]Task 3, Epoch 16/20 => Loss 0.412, Loss_clf 0.277, Loss_aux 0.135, Train_accy 92.40, Test_accy 86.36:  80%|████████  | 16/20 [11:59<03:08, 47.04s/it]Task 3, Epoch 17/20 => Loss 0.425, Loss_clf 0.298, Loss_aux 0.127, Train_accy 92.60:  80%|████████  | 16/20 [12:40<03:08, 47.04s/it]                 Task 3, Epoch 17/20 => Loss 0.425, Loss_clf 0.298, Loss_aux 0.127, Train_accy 92.60:  85%|████████▌ | 17/20 [12:40<02:15, 45.01s/it]Task 3, Epoch 18/20 => Loss 0.406, Loss_clf 0.269, Loss_aux 0.137, Train_accy 93.09:  85%|████████▌ | 17/20 [13:20<02:15, 45.01s/it]Task 3, Epoch 18/20 => Loss 0.406, Loss_clf 0.269, Loss_aux 0.137, Train_accy 93.09:  90%|█████████ | 18/20 [13:20<01:27, 43.54s/it]Task 3, Epoch 19/20 => Loss 0.397, Loss_clf 0.281, Loss_aux 0.116, Train_accy 93.23:  90%|█████████ | 18/20 [14:00<01:27, 43.54s/it]Task 3, Epoch 19/20 => Loss 0.397, Loss_clf 0.281, Loss_aux 0.116, Train_accy 93.23:  95%|█████████▌| 19/20 [14:00<00:42, 42.60s/it]Task 3, Epoch 20/20 => Loss 0.414, Loss_clf 0.281, Loss_aux 0.133, Train_accy 93.16:  95%|█████████▌| 19/20 [14:41<00:42, 42.60s/it]Task 3, Epoch 20/20 => Loss 0.414, Loss_clf 0.281, Loss_aux 0.133, Train_accy 93.16: 100%|██████████| 20/20 [14:41<00:00, 41.95s/it]Task 3, Epoch 20/20 => Loss 0.414, Loss_clf 0.281, Loss_aux 0.133, Train_accy 93.16: 100%|██████████| 20/20 [14:41<00:00, 44.05s/it]
2024-04-29 14:14:09,877 [der.py] => Task 3, Epoch 20/20 => Loss 0.414, Loss_clf 0.281, Loss_aux 0.133, Train_accy 93.16
2024-04-29 14:14:09,879 [base.py] => Reducing exemplars...(12 per classes)
2024-04-29 14:15:13,808 [base.py] => Constructing exemplars...(12 per classes)
2024-04-29 14:16:21,112 [der.py] => Exemplar size: 1920
2024-04-29 14:16:21,112 [trainer.py] => CNN: {'total': 85.83, '00-99': 83.25, '100-119': 88.16, '120-139': 85.78, '140-159': 96.0, 'old': 84.28, 'new': 96.0}
2024-04-29 14:16:21,112 [trainer.py] => NME: {'total': 87.52, '00-99': 86.7, '100-119': 89.47, '120-139': 85.78, '140-159': 91.2, 'old': 86.96, 'new': 91.2}
2024-04-29 14:16:21,112 [trainer.py] => CNN top1 curve: [88.64, 88.42, 87.02, 85.83]
2024-04-29 14:16:21,112 [trainer.py] => CNN top5 curve: [98.15, 97.95, 97.32, 97.04]
2024-04-29 14:16:21,112 [trainer.py] => NME top1 curve: [90.57, 88.77, 87.75, 87.52]
2024-04-29 14:16:21,112 [trainer.py] => NME top5 curve: [98.65, 98.45, 98.54, 98.41]

Average Accuracy (CNN): 87.48
Average Accuracy (NME): 88.65
2024-04-29 14:16:21,112 [trainer.py] => Average Accuracy (CNN): 87.48
2024-04-29 14:16:21,112 [trainer.py] => Average Accuracy (NME): 88.65
2024-04-29 14:16:21,112 [trainer.py] => Train Time: 2826.6
2024-04-29 14:16:21,112 [trainer.py] => Test Time: 85.36 

2024-04-29 14:16:21,115 [trainer.py] => All params: 343702453
2024-04-29 14:16:21,117 [trainer.py] => Trainable params: 86306485
2024-04-29 14:16:24,013 [der.py] => Learning on 160-180
2024-04-29 14:16:24,018 [der.py] => All params: 429700809
2024-04-29 14:16:24,021 [der.py] => Trainable params: 86506185
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.654, Loss_clf 1.581, Loss_aux 1.073, Train_accy 76.96, Test_accy 82.10:   0%|          | 0/20 [01:13<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.654, Loss_clf 1.581, Loss_aux 1.073, Train_accy 76.96, Test_accy 82.10:   5%|▌         | 1/20 [01:13<23:11, 73.26s/it]Task 4, Epoch 2/20 => Loss 0.767, Loss_clf 0.423, Loss_aux 0.344, Train_accy 88.67:   5%|▌         | 1/20 [02:00<23:11, 73.26s/it]                 Task 4, Epoch 2/20 => Loss 0.767, Loss_clf 0.423, Loss_aux 0.344, Train_accy 88.67:  10%|█         | 2/20 [02:00<17:23, 57.99s/it]Task 4, Epoch 3/20 => Loss 0.668, Loss_clf 0.381, Loss_aux 0.288, Train_accy 89.92:  10%|█         | 2/20 [02:47<17:23, 57.99s/it]Task 4, Epoch 3/20 => Loss 0.668, Loss_clf 0.381, Loss_aux 0.288, Train_accy 89.92:  15%|█▌        | 3/20 [02:47<15:01, 53.00s/it]Task 4, Epoch 4/20 => Loss 0.641, Loss_clf 0.390, Loss_aux 0.251, Train_accy 89.54:  15%|█▌        | 3/20 [03:34<15:01, 53.00s/it]Task 4, Epoch 4/20 => Loss 0.641, Loss_clf 0.390, Loss_aux 0.251, Train_accy 89.54:  20%|██        | 4/20 [03:34<13:29, 50.58s/it]Task 4, Epoch 5/20 => Loss 0.548, Loss_clf 0.332, Loss_aux 0.216, Train_accy 90.83:  20%|██        | 4/20 [04:21<13:29, 50.58s/it]Task 4, Epoch 5/20 => Loss 0.548, Loss_clf 0.332, Loss_aux 0.216, Train_accy 90.83:  25%|██▌       | 5/20 [04:21<12:19, 49.30s/it]Task 4, Epoch 6/20 => Loss 0.506, Loss_clf 0.310, Loss_aux 0.195, Train_accy 91.63, Test_accy 82.99:  25%|██▌       | 5/20 [05:35<12:19, 49.30s/it]Task 4, Epoch 6/20 => Loss 0.506, Loss_clf 0.310, Loss_aux 0.195, Train_accy 91.63, Test_accy 82.99:  30%|███       | 6/20 [05:35<13:26, 57.59s/it]Task 4, Epoch 7/20 => Loss 0.548, Loss_clf 0.351, Loss_aux 0.197, Train_accy 91.28:  30%|███       | 6/20 [06:22<13:26, 57.59s/it]                 Task 4, Epoch 7/20 => Loss 0.548, Loss_clf 0.351, Loss_aux 0.197, Train_accy 91.28:  35%|███▌      | 7/20 [06:22<11:43, 54.15s/it]Task 4, Epoch 8/20 => Loss 0.477, Loss_clf 0.286, Loss_aux 0.190, Train_accy 92.63:  35%|███▌      | 7/20 [07:09<11:43, 54.15s/it]Task 4, Epoch 8/20 => Loss 0.477, Loss_clf 0.286, Loss_aux 0.190, Train_accy 92.63:  40%|████      | 8/20 [07:09<10:22, 51.91s/it]Task 4, Epoch 9/20 => Loss 0.525, Loss_clf 0.349, Loss_aux 0.176, Train_accy 90.65:  40%|████      | 8/20 [07:56<10:22, 51.91s/it]Task 4, Epoch 9/20 => Loss 0.525, Loss_clf 0.349, Loss_aux 0.176, Train_accy 90.65:  45%|████▌     | 9/20 [07:56<09:13, 50.34s/it]Task 4, Epoch 10/20 => Loss 0.527, Loss_clf 0.336, Loss_aux 0.190, Train_accy 91.04:  45%|████▌     | 9/20 [08:43<09:13, 50.34s/it]Task 4, Epoch 10/20 => Loss 0.527, Loss_clf 0.336, Loss_aux 0.190, Train_accy 91.04:  50%|█████     | 10/20 [08:43<08:12, 49.28s/it]Task 4, Epoch 11/20 => Loss 0.506, Loss_clf 0.326, Loss_aux 0.180, Train_accy 91.80, Test_accy 84.35:  50%|█████     | 10/20 [09:56<08:12, 49.28s/it]Task 4, Epoch 11/20 => Loss 0.506, Loss_clf 0.326, Loss_aux 0.180, Train_accy 91.80, Test_accy 84.35:  55%|█████▌    | 11/20 [09:56<08:28, 56.53s/it]Task 4, Epoch 12/20 => Loss 0.490, Loss_clf 0.324, Loss_aux 0.166, Train_accy 91.80:  55%|█████▌    | 11/20 [10:43<08:28, 56.53s/it]                 Task 4, Epoch 12/20 => Loss 0.490, Loss_clf 0.324, Loss_aux 0.166, Train_accy 91.80:  60%|██████    | 12/20 [10:43<07:08, 53.62s/it]Task 4, Epoch 13/20 => Loss 0.448, Loss_clf 0.292, Loss_aux 0.155, Train_accy 92.56:  60%|██████    | 12/20 [11:30<07:08, 53.62s/it]Task 4, Epoch 13/20 => Loss 0.448, Loss_clf 0.292, Loss_aux 0.155, Train_accy 92.56:  65%|██████▌   | 13/20 [11:30<06:01, 51.58s/it]Task 4, Epoch 14/20 => Loss 0.478, Loss_clf 0.307, Loss_aux 0.170, Train_accy 91.49:  65%|██████▌   | 13/20 [12:17<06:01, 51.58s/it]Task 4, Epoch 14/20 => Loss 0.478, Loss_clf 0.307, Loss_aux 0.170, Train_accy 91.49:  70%|███████   | 14/20 [12:17<05:01, 50.23s/it]Task 4, Epoch 15/20 => Loss 0.411, Loss_clf 0.265, Loss_aux 0.146, Train_accy 93.19:  70%|███████   | 14/20 [13:04<05:01, 50.23s/it]Task 4, Epoch 15/20 => Loss 0.411, Loss_clf 0.265, Loss_aux 0.146, Train_accy 93.19:  75%|███████▌  | 15/20 [13:04<04:06, 49.30s/it]Task 4, Epoch 16/20 => Loss 0.440, Loss_clf 0.283, Loss_aux 0.156, Train_accy 92.77, Test_accy 83.83:  75%|███████▌  | 15/20 [14:17<04:06, 49.30s/it]Task 4, Epoch 16/20 => Loss 0.440, Loss_clf 0.283, Loss_aux 0.156, Train_accy 92.77, Test_accy 83.83:  80%|████████  | 16/20 [14:17<03:46, 56.54s/it]Task 4, Epoch 17/20 => Loss 0.477, Loss_clf 0.315, Loss_aux 0.162, Train_accy 91.94:  80%|████████  | 16/20 [15:04<03:46, 56.54s/it]                 Task 4, Epoch 17/20 => Loss 0.477, Loss_clf 0.315, Loss_aux 0.162, Train_accy 91.94:  85%|████████▌ | 17/20 [15:04<02:40, 53.61s/it]Task 4, Epoch 18/20 => Loss 0.443, Loss_clf 0.282, Loss_aux 0.160, Train_accy 92.95:  85%|████████▌ | 17/20 [15:51<02:40, 53.61s/it]Task 4, Epoch 18/20 => Loss 0.443, Loss_clf 0.282, Loss_aux 0.160, Train_accy 92.95:  90%|█████████ | 18/20 [15:51<01:43, 51.55s/it]Task 4, Epoch 19/20 => Loss 0.422, Loss_clf 0.284, Loss_aux 0.137, Train_accy 92.70:  90%|█████████ | 18/20 [16:38<01:43, 51.55s/it]Task 4, Epoch 19/20 => Loss 0.422, Loss_clf 0.284, Loss_aux 0.137, Train_accy 92.70:  95%|█████████▌| 19/20 [16:38<00:50, 50.14s/it]Task 4, Epoch 20/20 => Loss 0.438, Loss_clf 0.302, Loss_aux 0.136, Train_accy 92.49:  95%|█████████▌| 19/20 [17:24<00:50, 50.14s/it]Task 4, Epoch 20/20 => Loss 0.438, Loss_clf 0.302, Loss_aux 0.136, Train_accy 92.49: 100%|██████████| 20/20 [17:24<00:00, 49.17s/it]Task 4, Epoch 20/20 => Loss 0.438, Loss_clf 0.302, Loss_aux 0.136, Train_accy 92.49: 100%|██████████| 20/20 [17:24<00:00, 52.25s/it]
2024-04-29 14:33:48,994 [der.py] => Task 4, Epoch 20/20 => Loss 0.438, Loss_clf 0.302, Loss_aux 0.136, Train_accy 92.49
2024-04-29 14:33:48,995 [base.py] => Reducing exemplars...(11 per classes)
2024-04-29 14:35:01,964 [base.py] => Constructing exemplars...(11 per classes)
2024-04-29 14:36:27,637 [der.py] => Exemplar size: 1980
2024-04-29 14:36:27,637 [trainer.py] => CNN: {'total': 83.69, '00-99': 80.81, '100-119': 85.53, '120-139': 81.78, '140-159': 86.8, '160-179': 94.94, 'old': 82.28, 'new': 94.94}
2024-04-29 14:36:27,637 [trainer.py] => NME: {'total': 86.94, '00-99': 86.2, '100-119': 89.04, '120-139': 83.56, '140-159': 89.6, '160-179': 89.03, 'old': 86.67, 'new': 89.03}
2024-04-29 14:36:27,637 [trainer.py] => CNN top1 curve: [88.64, 88.42, 87.02, 85.83, 83.69]
2024-04-29 14:36:27,637 [trainer.py] => CNN top5 curve: [98.15, 97.95, 97.32, 97.04, 96.43]
2024-04-29 14:36:27,637 [trainer.py] => NME top1 curve: [90.57, 88.77, 87.75, 87.52, 86.94]
2024-04-29 14:36:27,637 [trainer.py] => NME top5 curve: [98.65, 98.45, 98.54, 98.41, 98.31]

Average Accuracy (CNN): 86.72
Average Accuracy (NME): 88.31
2024-04-29 14:36:27,637 [trainer.py] => Average Accuracy (CNN): 86.72
2024-04-29 14:36:27,637 [trainer.py] => Average Accuracy (NME): 88.31
2024-04-29 14:36:27,637 [trainer.py] => Train Time: 3871.5699999999997
2024-04-29 14:36:27,638 [trainer.py] => Test Time: 138.4 

2024-04-29 14:36:27,641 [trainer.py] => All params: 429700809
2024-04-29 14:36:27,645 [trainer.py] => Trainable params: 86506185
2024-04-29 14:36:32,738 [der.py] => Learning on 180-200
2024-04-29 14:36:32,747 [der.py] => All params: 515729885
2024-04-29 14:36:32,750 [der.py] => Trainable params: 86736605
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.593, Loss_clf 1.468, Loss_aux 1.125, Train_accy 77.42, Test_accy 80.11:   0%|          | 0/20 [01:28<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.593, Loss_clf 1.468, Loss_aux 1.125, Train_accy 77.42, Test_accy 80.11:   5%|▌         | 1/20 [01:28<28:07, 88.83s/it]Task 5, Epoch 2/20 => Loss 0.827, Loss_clf 0.454, Loss_aux 0.373, Train_accy 87.72:   5%|▌         | 1/20 [02:23<28:07, 88.83s/it]                 Task 5, Epoch 2/20 => Loss 0.827, Loss_clf 0.454, Loss_aux 0.373, Train_accy 87.72:  10%|█         | 2/20 [02:23<20:35, 68.65s/it]Task 5, Epoch 3/20 => Loss 0.682, Loss_clf 0.381, Loss_aux 0.301, Train_accy 90.18:  10%|█         | 2/20 [03:17<20:35, 68.65s/it]Task 5, Epoch 3/20 => Loss 0.682, Loss_clf 0.381, Loss_aux 0.301, Train_accy 90.18:  15%|█▌        | 3/20 [03:17<17:38, 62.25s/it]Task 5, Epoch 4/20 => Loss 0.582, Loss_clf 0.336, Loss_aux 0.246, Train_accy 91.00:  15%|█▌        | 3/20 [04:12<17:38, 62.25s/it]Task 5, Epoch 4/20 => Loss 0.582, Loss_clf 0.336, Loss_aux 0.246, Train_accy 91.00:  20%|██        | 4/20 [04:12<15:45, 59.12s/it]Task 5, Epoch 5/20 => Loss 0.605, Loss_clf 0.363, Loss_aux 0.241, Train_accy 91.00:  20%|██        | 4/20 [05:06<15:45, 59.12s/it]Task 5, Epoch 5/20 => Loss 0.605, Loss_clf 0.363, Loss_aux 0.241, Train_accy 91.00:  25%|██▌       | 5/20 [05:06<14:21, 57.42s/it]Task 5, Epoch 6/20 => Loss 0.651, Loss_clf 0.377, Loss_aux 0.273, Train_accy 90.21, Test_accy 81.42:  25%|██▌       | 5/20 [06:36<14:21, 57.42s/it]Task 5, Epoch 6/20 => Loss 0.651, Loss_clf 0.377, Loss_aux 0.273, Train_accy 90.21, Test_accy 81.42:  30%|███       | 6/20 [06:36<15:58, 68.44s/it]Task 5, Epoch 7/20 => Loss 0.565, Loss_clf 0.332, Loss_aux 0.233, Train_accy 90.93:  30%|███       | 6/20 [07:31<15:58, 68.44s/it]                 Task 5, Epoch 7/20 => Loss 0.565, Loss_clf 0.332, Loss_aux 0.233, Train_accy 90.93:  35%|███▌      | 7/20 [07:31<13:52, 64.01s/it]Task 5, Epoch 8/20 => Loss 0.514, Loss_clf 0.315, Loss_aux 0.199, Train_accy 91.81:  35%|███▌      | 7/20 [08:26<13:52, 64.01s/it]Task 5, Epoch 8/20 => Loss 0.514, Loss_clf 0.315, Loss_aux 0.199, Train_accy 91.81:  40%|████      | 8/20 [08:26<12:12, 61.05s/it]Task 5, Epoch 9/20 => Loss 0.598, Loss_clf 0.344, Loss_aux 0.254, Train_accy 91.10:  40%|████      | 8/20 [09:21<12:12, 61.05s/it]Task 5, Epoch 9/20 => Loss 0.598, Loss_clf 0.344, Loss_aux 0.254, Train_accy 91.10:  45%|████▌     | 9/20 [09:21<10:50, 59.13s/it]Task 5, Epoch 10/20 => Loss 0.463, Loss_clf 0.301, Loss_aux 0.162, Train_accy 92.05:  45%|████▌     | 9/20 [10:15<10:50, 59.13s/it]Task 5, Epoch 10/20 => Loss 0.463, Loss_clf 0.301, Loss_aux 0.162, Train_accy 92.05:  50%|█████     | 10/20 [10:15<09:38, 57.83s/it]Task 5, Epoch 11/20 => Loss 0.448, Loss_clf 0.294, Loss_aux 0.154, Train_accy 92.22, Test_accy 82.99:  50%|█████     | 10/20 [11:45<09:38, 57.83s/it]Task 5, Epoch 11/20 => Loss 0.448, Loss_clf 0.294, Loss_aux 0.154, Train_accy 92.22, Test_accy 82.99:  55%|█████▌    | 11/20 [11:45<10:07, 67.51s/it]Task 5, Epoch 12/20 => Loss 0.476, Loss_clf 0.304, Loss_aux 0.172, Train_accy 92.33:  55%|█████▌    | 11/20 [12:40<10:07, 67.51s/it]                 Task 5, Epoch 12/20 => Loss 0.476, Loss_clf 0.304, Loss_aux 0.172, Train_accy 92.33:  60%|██████    | 12/20 [12:40<08:29, 63.63s/it]Task 5, Epoch 13/20 => Loss 0.457, Loss_clf 0.291, Loss_aux 0.166, Train_accy 92.36:  60%|██████    | 12/20 [13:35<08:29, 63.63s/it]Task 5, Epoch 13/20 => Loss 0.457, Loss_clf 0.291, Loss_aux 0.166, Train_accy 92.36:  65%|██████▌   | 13/20 [13:35<07:06, 60.98s/it]Task 5, Epoch 14/20 => Loss 0.467, Loss_clf 0.301, Loss_aux 0.166, Train_accy 92.05:  65%|██████▌   | 13/20 [14:29<07:06, 60.98s/it]Task 5, Epoch 14/20 => Loss 0.467, Loss_clf 0.301, Loss_aux 0.166, Train_accy 92.05:  70%|███████   | 14/20 [14:29<05:54, 59.09s/it]Task 5, Epoch 15/20 => Loss 0.467, Loss_clf 0.291, Loss_aux 0.177, Train_accy 92.22:  70%|███████   | 14/20 [15:24<05:54, 59.09s/it]Task 5, Epoch 15/20 => Loss 0.467, Loss_clf 0.291, Loss_aux 0.177, Train_accy 92.22:  75%|███████▌  | 15/20 [15:24<04:49, 57.84s/it]Task 5, Epoch 16/20 => Loss 0.427, Loss_clf 0.279, Loss_aux 0.148, Train_accy 92.46, Test_accy 82.95:  75%|███████▌  | 15/20 [16:54<04:49, 57.84s/it]Task 5, Epoch 16/20 => Loss 0.427, Loss_clf 0.279, Loss_aux 0.148, Train_accy 92.46, Test_accy 82.95:  80%|████████  | 16/20 [16:54<04:29, 67.38s/it]Task 5, Epoch 17/20 => Loss 0.391, Loss_clf 0.241, Loss_aux 0.150, Train_accy 93.55:  80%|████████  | 16/20 [17:49<04:29, 67.38s/it]                 Task 5, Epoch 17/20 => Loss 0.391, Loss_clf 0.241, Loss_aux 0.150, Train_accy 93.55:  85%|████████▌ | 17/20 [17:49<03:10, 63.60s/it]Task 5, Epoch 18/20 => Loss 0.417, Loss_clf 0.280, Loss_aux 0.137, Train_accy 92.26:  85%|████████▌ | 17/20 [18:43<03:10, 63.60s/it]Task 5, Epoch 18/20 => Loss 0.417, Loss_clf 0.280, Loss_aux 0.137, Train_accy 92.26:  90%|█████████ | 18/20 [18:43<02:01, 60.90s/it]Task 5, Epoch 19/20 => Loss 0.451, Loss_clf 0.297, Loss_aux 0.154, Train_accy 91.68:  90%|█████████ | 18/20 [19:38<02:01, 60.90s/it]Task 5, Epoch 19/20 => Loss 0.451, Loss_clf 0.297, Loss_aux 0.154, Train_accy 91.68:  95%|█████████▌| 19/20 [19:38<00:59, 59.06s/it]Task 5, Epoch 20/20 => Loss 0.414, Loss_clf 0.275, Loss_aux 0.139, Train_accy 92.87:  95%|█████████▌| 19/20 [20:33<00:59, 59.06s/it]Task 5, Epoch 20/20 => Loss 0.414, Loss_clf 0.275, Loss_aux 0.139, Train_accy 92.87: 100%|██████████| 20/20 [20:33<00:00, 57.73s/it]Task 5, Epoch 20/20 => Loss 0.414, Loss_clf 0.275, Loss_aux 0.139, Train_accy 92.87: 100%|██████████| 20/20 [20:33<00:00, 61.65s/it]
2024-04-29 14:57:05,921 [der.py] => Task 5, Epoch 20/20 => Loss 0.414, Loss_clf 0.275, Loss_aux 0.139, Train_accy 92.87
2024-04-29 14:57:05,923 [base.py] => Reducing exemplars...(10 per classes)
2024-04-29 14:58:33,696 [base.py] => Constructing exemplars...(10 per classes)
2024-04-29 15:00:19,731 [der.py] => Exemplar size: 2000
2024-04-29 15:00:19,732 [trainer.py] => CNN: {'total': 82.82, '00-99': 79.88, '100-119': 83.33, '120-139': 76.0, '140-159': 86.4, '160-179': 88.19, '180-199': 94.78, 'old': 81.53, 'new': 94.78}
2024-04-29 15:00:19,732 [trainer.py] => NME: {'total': 86.77, '00-99': 85.52, '100-119': 89.47, '120-139': 83.11, '140-159': 89.6, '160-179': 89.45, '180-199': 88.26, 'old': 86.61, 'new': 88.26}
2024-04-29 15:00:19,732 [trainer.py] => CNN top1 curve: [88.64, 88.42, 87.02, 85.83, 83.69, 82.82]
2024-04-29 15:00:19,732 [trainer.py] => CNN top5 curve: [98.15, 97.95, 97.32, 97.04, 96.43, 96.18]
2024-04-29 15:00:19,732 [trainer.py] => NME top1 curve: [90.57, 88.77, 87.75, 87.52, 86.94, 86.77]
2024-04-29 15:00:19,732 [trainer.py] => NME top5 curve: [98.65, 98.45, 98.54, 98.41, 98.31, 98.05]

Average Accuracy (CNN): 86.07
Average Accuracy (NME): 88.05
2024-04-29 15:00:19,732 [trainer.py] => Average Accuracy (CNN): 86.07
2024-04-29 15:00:19,732 [trainer.py] => Average Accuracy (NME): 88.05
2024-04-29 15:00:19,732 [trainer.py] => Train Time: 5104.73
2024-04-29 15:00:19,732 [trainer.py] => Test Time: 208.51 

Accuracy Matrix (CNN):
[[88.64 87.54 85.86 83.25 80.81 79.88]
 [ 0.   92.98 90.35 88.16 85.53 83.33]
 [ 0.    0.   89.78 85.78 81.78 76.  ]
 [ 0.    0.    0.   96.   86.8  86.4 ]
 [ 0.    0.    0.    0.   94.94 88.19]
 [ 0.    0.    0.    0.    0.   94.78]]
2024-04-29 15:00:19,733 [trainer.py] => Forgetting (CNN): 9.708000000000002
Accuracy Matrix (NME):
[[90.57 88.8  87.54 86.7  86.2  85.52]
 [ 0.   88.6  89.91 89.47 89.04 89.47]
 [ 0.    0.   86.67 85.78 83.56 83.11]
 [ 0.    0.    0.   91.2  89.6  89.6 ]
 [ 0.    0.    0.    0.   89.03 89.45]
 [ 0.    0.    0.    0.    0.   88.26]]
2024-04-29 15:00:19,734 [trainer.py] => Forgetting (NME): 2.1300000000000012
2024-04-29 15:00:22,655 [trainer.py] => config: ./exps/foster_cub_B100_Inc5.json
2024-04-29 15:00:22,655 [trainer.py] => prefix: cil
2024-04-29 15:00:22,655 [trainer.py] => dataset: cub
2024-04-29 15:00:22,656 [trainer.py] => memory_size: 2000
2024-04-29 15:00:22,656 [trainer.py] => memory_per_class: 20
2024-04-29 15:00:22,656 [trainer.py] => fixed_memory: True
2024-04-29 15:00:22,656 [trainer.py] => shuffle: True
2024-04-29 15:00:22,656 [trainer.py] => init_cls: 100
2024-04-29 15:00:22,656 [trainer.py] => increment: 20
2024-04-29 15:00:22,656 [trainer.py] => model_name: foster
2024-04-29 15:00:22,656 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-29 15:00:22,656 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-29 15:00:22,656 [trainer.py] => seed: 1993
2024-04-29 15:00:22,656 [trainer.py] => beta1: 0.96
2024-04-29 15:00:22,656 [trainer.py] => beta2: 0.97
2024-04-29 15:00:22,656 [trainer.py] => oofc: ft
2024-04-29 15:00:22,656 [trainer.py] => is_teacher_wa: False
2024-04-29 15:00:22,656 [trainer.py] => is_student_wa: False
2024-04-29 15:00:22,656 [trainer.py] => lambda_okd: 1
2024-04-29 15:00:22,656 [trainer.py] => wa_value: 1
2024-04-29 15:00:22,656 [trainer.py] => init_epochs: 20
2024-04-29 15:00:22,656 [trainer.py] => init_lr: 0.001
2024-04-29 15:00:22,656 [trainer.py] => init_weight_decay: 0.0005
2024-04-29 15:00:22,656 [trainer.py] => boosting_epochs: 20
2024-04-29 15:00:22,656 [trainer.py] => compression_epochs: 20
2024-04-29 15:00:22,656 [trainer.py] => lr: 0.001
2024-04-29 15:00:22,656 [trainer.py] => batch_size: 48
2024-04-29 15:00:22,656 [trainer.py] => weight_decay: 0.0005
2024-04-29 15:00:22,656 [trainer.py] => num_workers: 8
2024-04-29 15:00:22,656 [trainer.py] => T: 2
2024-04-29 15:00:22,694 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-29 15:00:23,029 [trainer.py] => All params: 0
2024-04-29 15:00:23,029 [trainer.py] => Trainable params: 0
2024-04-29 15:00:26,577 [foster.py] => Learning on 0-100
2024-04-29 15:00:26,578 [foster.py] => All params: 85952456
2024-04-29 15:00:26,579 [foster.py] => Trainable params: 85952456
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 5.104, Train_accy 0.94, Test_accy 1.09:   0%|          | 0/20 [00:34<?, ?it/s]Task 0, Epoch 1/20 => Loss 5.104, Train_accy 0.94, Test_accy 1.09:   5%|▌         | 1/20 [00:34<11:02, 34.89s/it]Task 0, Epoch 2/20 => Loss 4.746, Train_accy 0.79:   5%|▌         | 1/20 [01:05<11:02, 34.89s/it]                Task 0, Epoch 2/20 => Loss 4.746, Train_accy 0.79:  10%|█         | 2/20 [01:05<09:43, 32.43s/it]Task 0, Epoch 3/20 => Loss 4.700, Train_accy 0.96:  10%|█         | 2/20 [01:36<09:43, 32.43s/it]Task 0, Epoch 3/20 => Loss 4.700, Train_accy 0.96:  15%|█▌        | 3/20 [01:36<08:57, 31.60s/it]Task 0, Epoch 4/20 => Loss 4.675, Train_accy 1.19:  15%|█▌        | 3/20 [02:06<08:57, 31.60s/it]Task 0, Epoch 4/20 => Loss 4.675, Train_accy 1.19:  20%|██        | 4/20 [02:06<08:19, 31.24s/it]Task 0, Epoch 5/20 => Loss 4.669, Train_accy 1.02:  20%|██        | 4/20 [02:37<08:19, 31.24s/it]Task 0, Epoch 5/20 => Loss 4.669, Train_accy 1.02:  25%|██▌       | 5/20 [02:37<07:45, 31.04s/it]Task 0, Epoch 6/20 => Loss 4.642, Train_accy 1.34, Test_accy 0.93:  25%|██▌       | 5/20 [03:11<07:45, 31.04s/it]Task 0, Epoch 6/20 => Loss 4.642, Train_accy 1.34, Test_accy 0.93:  30%|███       | 6/20 [03:11<07:29, 32.11s/it]Task 0, Epoch 7/20 => Loss 4.611, Train_accy 0.96:  30%|███       | 6/20 [03:42<07:29, 32.11s/it]                Task 0, Epoch 7/20 => Loss 4.611, Train_accy 0.96:  35%|███▌      | 7/20 [03:42<06:52, 31.70s/it]Task 0, Epoch 8/20 => Loss 4.582, Train_accy 1.51:  35%|███▌      | 7/20 [04:13<06:52, 31.70s/it]Task 0, Epoch 8/20 => Loss 4.582, Train_accy 1.51:  40%|████      | 8/20 [04:13<06:16, 31.41s/it]Task 0, Epoch 9/20 => Loss 4.560, Train_accy 1.41:  40%|████      | 8/20 [04:44<06:16, 31.41s/it]Task 0, Epoch 9/20 => Loss 4.560, Train_accy 1.41:  45%|████▌     | 9/20 [04:44<05:42, 31.18s/it]Task 0, Epoch 10/20 => Loss 4.552, Train_accy 1.60:  45%|████▌     | 9/20 [05:14<05:42, 31.18s/it]Task 0, Epoch 10/20 => Loss 4.552, Train_accy 1.60:  50%|█████     | 10/20 [05:14<05:10, 31.01s/it]Task 0, Epoch 11/20 => Loss 4.542, Train_accy 1.81, Test_accy 1.68:  50%|█████     | 10/20 [05:48<05:10, 31.01s/it]Task 0, Epoch 11/20 => Loss 4.542, Train_accy 1.81, Test_accy 1.68:  55%|█████▌    | 11/20 [05:48<04:47, 31.99s/it]Task 0, Epoch 12/20 => Loss 4.525, Train_accy 2.09:  55%|█████▌    | 11/20 [06:19<04:47, 31.99s/it]                Task 0, Epoch 12/20 => Loss 4.525, Train_accy 2.09:  60%|██████    | 12/20 [06:19<04:12, 31.57s/it]Task 0, Epoch 13/20 => Loss 4.508, Train_accy 2.02:  60%|██████    | 12/20 [06:50<04:12, 31.57s/it]Task 0, Epoch 13/20 => Loss 4.508, Train_accy 2.02:  65%|██████▌   | 13/20 [06:50<03:39, 31.31s/it]Task 0, Epoch 14/20 => Loss 4.493, Train_accy 2.39:  65%|██████▌   | 13/20 [07:20<03:39, 31.31s/it]Task 0, Epoch 14/20 => Loss 4.493, Train_accy 2.39:  70%|███████   | 14/20 [07:20<03:06, 31.09s/it]Task 0, Epoch 15/20 => Loss 4.483, Train_accy 2.34:  70%|███████   | 14/20 [07:51<03:06, 31.09s/it]Task 0, Epoch 15/20 => Loss 4.483, Train_accy 2.34:  75%|███████▌  | 15/20 [07:51<02:34, 30.95s/it]Task 0, Epoch 16/20 => Loss 4.471, Train_accy 2.83, Test_accy 1.60:  75%|███████▌  | 15/20 [08:25<02:34, 30.95s/it]Task 0, Epoch 16/20 => Loss 4.471, Train_accy 2.83, Test_accy 1.60:  80%|████████  | 16/20 [08:25<02:07, 31.89s/it]Task 0, Epoch 17/20 => Loss 4.469, Train_accy 2.75:  80%|████████  | 16/20 [08:56<02:07, 31.89s/it]                Task 0, Epoch 17/20 => Loss 4.469, Train_accy 2.75:  85%|████████▌ | 17/20 [08:56<01:34, 31.52s/it]Task 0, Epoch 18/20 => Loss 4.450, Train_accy 2.92:  85%|████████▌ | 17/20 [09:26<01:34, 31.52s/it]Task 0, Epoch 18/20 => Loss 4.450, Train_accy 2.92:  90%|█████████ | 18/20 [09:26<01:02, 31.26s/it]Task 0, Epoch 19/20 => Loss 4.445, Train_accy 3.34:  90%|█████████ | 18/20 [09:57<01:02, 31.26s/it]Task 0, Epoch 19/20 => Loss 4.445, Train_accy 3.34:  95%|█████████▌| 19/20 [09:57<00:31, 31.07s/it]Task 0, Epoch 20/20 => Loss 4.444, Train_accy 3.24:  95%|█████████▌| 19/20 [10:28<00:31, 31.07s/it]Task 0, Epoch 20/20 => Loss 4.444, Train_accy 3.24: 100%|██████████| 20/20 [10:28<00:00, 30.98s/it]Task 0, Epoch 20/20 => Loss 4.444, Train_accy 3.24: 100%|██████████| 20/20 [10:28<00:00, 31.41s/it]
2024-04-29 15:10:55,355 [foster.py] => Task 0, Epoch 20/20 => Loss 4.444, Train_accy 3.24
2024-04-29 15:10:55,356 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 15:12:28,974 [foster.py] => Exemplar size: 2000
2024-04-29 15:12:28,975 [trainer.py] => CNN: {'total': 1.35, '00-99': 1.35, 'old': 0, 'new': 1.35}
2024-04-29 15:12:28,975 [trainer.py] => NME: {'total': 1.77, '00-99': 1.77, 'old': 0, 'new': 1.77}
2024-04-29 15:12:28,975 [trainer.py] => CNN top1 curve: [1.35]
2024-04-29 15:12:28,975 [trainer.py] => CNN top5 curve: [8.84]
2024-04-29 15:12:28,975 [trainer.py] => NME top1 curve: [1.77]
2024-04-29 15:12:28,975 [trainer.py] => NME top5 curve: [11.53]

Average Accuracy (CNN): 1.35
Average Accuracy (NME): 1.77
2024-04-29 15:12:28,975 [trainer.py] => Average Accuracy (CNN): 1.35
2024-04-29 15:12:28,975 [trainer.py] => Average Accuracy (NME): 1.77
2024-04-29 15:12:28,975 [trainer.py] => Train Time: 628.77
2024-04-29 15:12:28,975 [trainer.py] => Test Time: 7.03 

2024-04-29 15:12:28,976 [trainer.py] => All params: 85952456
2024-04-29 15:12:28,977 [trainer.py] => Trainable params: 85952456
2024-04-29 15:12:33,276 [foster.py] => Learning on 100-120
2024-04-29 15:12:33,278 [foster.py] => All params: 171950932
2024-04-29 15:12:33,279 [foster.py] => Trainable params: 86075376
2024-04-29 15:12:33,330 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 14.081, Loss_clf 4.694, Loss_fe 4.806, Loss_kd 3.818, Train_accy 1.76, Test_accy 2.05:   0%|          | 0/20 [00:33<?, ?it/s]Task 1, Epoch 1/20 => Loss 14.081, Loss_clf 4.694, Loss_fe 4.806, Loss_kd 3.818, Train_accy 1.76, Test_accy 2.05:   5%|▌         | 1/20 [00:33<10:35, 33.46s/it]Task 1, Epoch 2/20 => Loss 13.938, Loss_clf 4.634, Loss_fe 4.726, Loss_kd 3.815, Train_accy 2.57:   5%|▌         | 1/20 [00:59<10:35, 33.46s/it]                Task 1, Epoch 2/20 => Loss 13.938, Loss_clf 4.634, Loss_fe 4.726, Loss_kd 3.815, Train_accy 2.57:  10%|█         | 2/20 [00:59<08:46, 29.26s/it]Task 1, Epoch 3/20 => Loss 13.904, Loss_clf 4.631, Loss_fe 4.695, Loss_kd 3.815, Train_accy 2.24:  10%|█         | 2/20 [01:26<08:46, 29.26s/it]Task 1, Epoch 3/20 => Loss 13.904, Loss_clf 4.631, Loss_fe 4.695, Loss_kd 3.815, Train_accy 2.24:  15%|█▌        | 3/20 [01:26<07:54, 27.92s/it]Task 1, Epoch 4/20 => Loss 13.821, Loss_clf 4.599, Loss_fe 4.642, Loss_kd 3.816, Train_accy 2.54:  15%|█▌        | 3/20 [01:52<07:54, 27.92s/it]Task 1, Epoch 4/20 => Loss 13.821, Loss_clf 4.599, Loss_fe 4.642, Loss_kd 3.816, Train_accy 2.54:  20%|██        | 4/20 [01:52<07:16, 27.30s/it]Task 1, Epoch 5/20 => Loss 13.813, Loss_clf 4.602, Loss_fe 4.631, Loss_kd 3.816, Train_accy 2.44:  20%|██        | 4/20 [02:18<07:16, 27.30s/it]Task 1, Epoch 5/20 => Loss 13.813, Loss_clf 4.602, Loss_fe 4.631, Loss_kd 3.816, Train_accy 2.44:  25%|██▌       | 5/20 [02:18<06:44, 26.98s/it]Task 1, Epoch 6/20 => Loss 13.732, Loss_clf 4.565, Loss_fe 4.586, Loss_kd 3.818, Train_accy 3.15, Test_accy 1.98:  25%|██▌       | 5/20 [02:52<06:44, 26.98s/it]Task 1, Epoch 6/20 => Loss 13.732, Loss_clf 4.565, Loss_fe 4.586, Loss_kd 3.818, Train_accy 3.15, Test_accy 1.98:  30%|███       | 6/20 [02:52<06:50, 29.34s/it]Task 1, Epoch 7/20 => Loss 13.713, Loss_clf 4.561, Loss_fe 4.570, Loss_kd 3.818, Train_accy 2.88:  30%|███       | 6/20 [03:19<06:50, 29.34s/it]                Task 1, Epoch 7/20 => Loss 13.713, Loss_clf 4.561, Loss_fe 4.570, Loss_kd 3.818, Train_accy 2.88:  35%|███▌      | 7/20 [03:19<06:08, 28.38s/it]Task 1, Epoch 8/20 => Loss 13.661, Loss_clf 4.532, Loss_fe 4.546, Loss_kd 3.819, Train_accy 3.05:  35%|███▌      | 7/20 [03:45<06:08, 28.38s/it]Task 1, Epoch 8/20 => Loss 13.661, Loss_clf 4.532, Loss_fe 4.546, Loss_kd 3.819, Train_accy 3.05:  40%|████      | 8/20 [03:45<05:33, 27.78s/it]Task 1, Epoch 9/20 => Loss 13.628, Loss_clf 4.522, Loss_fe 4.520, Loss_kd 3.821, Train_accy 3.05:  40%|████      | 8/20 [04:12<05:33, 27.78s/it]Task 1, Epoch 9/20 => Loss 13.628, Loss_clf 4.522, Loss_fe 4.520, Loss_kd 3.821, Train_accy 3.05:  45%|████▌     | 9/20 [04:12<05:01, 27.36s/it]Task 1, Epoch 10/20 => Loss 13.570, Loss_clf 4.486, Loss_fe 4.496, Loss_kd 3.823, Train_accy 3.05:  45%|████▌     | 9/20 [04:38<05:01, 27.36s/it]Task 1, Epoch 10/20 => Loss 13.570, Loss_clf 4.486, Loss_fe 4.496, Loss_kd 3.823, Train_accy 3.05:  50%|█████     | 10/20 [04:38<04:31, 27.10s/it]Task 1, Epoch 11/20 => Loss 13.537, Loss_clf 4.471, Loss_fe 4.476, Loss_kd 3.825, Train_accy 3.52, Test_accy 3.18:  50%|█████     | 10/20 [05:12<04:31, 27.10s/it]Task 1, Epoch 11/20 => Loss 13.537, Loss_clf 4.471, Loss_fe 4.476, Loss_kd 3.825, Train_accy 3.52, Test_accy 3.18:  55%|█████▌    | 11/20 [05:12<04:23, 29.24s/it]Task 1, Epoch 12/20 => Loss 13.475, Loss_clf 4.435, Loss_fe 4.447, Loss_kd 3.828, Train_accy 4.44:  55%|█████▌    | 11/20 [05:39<04:23, 29.24s/it]                Task 1, Epoch 12/20 => Loss 13.475, Loss_clf 4.435, Loss_fe 4.447, Loss_kd 3.828, Train_accy 4.44:  60%|██████    | 12/20 [05:39<03:47, 28.42s/it]Task 1, Epoch 13/20 => Loss 13.433, Loss_clf 4.415, Loss_fe 4.422, Loss_kd 3.829, Train_accy 4.34:  60%|██████    | 12/20 [06:05<03:47, 28.42s/it]Task 1, Epoch 13/20 => Loss 13.433, Loss_clf 4.415, Loss_fe 4.422, Loss_kd 3.829, Train_accy 4.34:  65%|██████▌   | 13/20 [06:05<03:15, 27.89s/it]Task 1, Epoch 14/20 => Loss 13.370, Loss_clf 4.388, Loss_fe 4.385, Loss_kd 3.831, Train_accy 4.40:  65%|██████▌   | 13/20 [06:32<03:15, 27.89s/it]Task 1, Epoch 14/20 => Loss 13.370, Loss_clf 4.388, Loss_fe 4.385, Loss_kd 3.831, Train_accy 4.40:  70%|███████   | 14/20 [06:32<02:45, 27.54s/it]Task 1, Epoch 15/20 => Loss 13.337, Loss_clf 4.370, Loss_fe 4.366, Loss_kd 3.834, Train_accy 4.78:  70%|███████   | 14/20 [06:59<02:45, 27.54s/it]Task 1, Epoch 15/20 => Loss 13.337, Loss_clf 4.370, Loss_fe 4.366, Loss_kd 3.834, Train_accy 4.78:  75%|███████▌  | 15/20 [06:59<02:16, 27.27s/it]Task 1, Epoch 16/20 => Loss 13.314, Loss_clf 4.355, Loss_fe 4.357, Loss_kd 3.834, Train_accy 5.28, Test_accy 4.45:  75%|███████▌  | 15/20 [07:33<02:16, 27.27s/it]Task 1, Epoch 16/20 => Loss 13.314, Loss_clf 4.355, Loss_fe 4.357, Loss_kd 3.834, Train_accy 5.28, Test_accy 4.45:  80%|████████  | 16/20 [07:33<01:57, 29.35s/it]Task 1, Epoch 17/20 => Loss 13.257, Loss_clf 4.325, Loss_fe 4.327, Loss_kd 3.838, Train_accy 6.23:  80%|████████  | 16/20 [08:00<01:57, 29.35s/it]                Task 1, Epoch 17/20 => Loss 13.257, Loss_clf 4.325, Loss_fe 4.327, Loss_kd 3.838, Train_accy 6.23:  85%|████████▌ | 17/20 [08:00<01:25, 28.52s/it]Task 1, Epoch 18/20 => Loss 13.237, Loss_clf 4.312, Loss_fe 4.318, Loss_kd 3.838, Train_accy 5.66:  85%|████████▌ | 17/20 [08:26<01:25, 28.52s/it]Task 1, Epoch 18/20 => Loss 13.237, Loss_clf 4.312, Loss_fe 4.318, Loss_kd 3.838, Train_accy 5.66:  90%|█████████ | 18/20 [08:26<00:55, 27.96s/it]Task 1, Epoch 19/20 => Loss 13.227, Loss_clf 4.314, Loss_fe 4.307, Loss_kd 3.838, Train_accy 5.76:  90%|█████████ | 18/20 [08:53<00:55, 27.96s/it]Task 1, Epoch 19/20 => Loss 13.227, Loss_clf 4.314, Loss_fe 4.307, Loss_kd 3.838, Train_accy 5.76:  95%|█████████▌| 19/20 [08:53<00:27, 27.53s/it]Task 1, Epoch 20/20 => Loss 13.182, Loss_clf 4.294, Loss_fe 4.282, Loss_kd 3.838, Train_accy 5.86:  95%|█████████▌| 19/20 [09:19<00:27, 27.53s/it]Task 1, Epoch 20/20 => Loss 13.182, Loss_clf 4.294, Loss_fe 4.282, Loss_kd 3.838, Train_accy 5.86: 100%|██████████| 20/20 [09:19<00:00, 27.23s/it]Task 1, Epoch 20/20 => Loss 13.182, Loss_clf 4.294, Loss_fe 4.282, Loss_kd 3.838, Train_accy 5.86: 100%|██████████| 20/20 [09:19<00:00, 27.99s/it]
2024-04-29 15:21:53,142 [foster.py] => Task 1, Epoch 20/20 => Loss 13.182, Loss_clf 4.294, Loss_fe 4.282, Loss_kd 3.838, Train_accy 5.86
2024-04-29 15:21:53,143 [foster.py] => do not weight align teacher!
2024-04-29 15:21:53,145 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 1, Epoch 1/20 => Loss 4.738,  Train_accy 2.47, Test_accy 1.34:   0%|          | 0/20 [00:37<?, ?it/s]SNet: Task 1, Epoch 1/20 => Loss 4.738,  Train_accy 2.47, Test_accy 1.34:   5%|▌         | 1/20 [00:37<11:53, 37.56s/it]SNet: Task 1, Epoch 2/20 => Loss 4.727,  Train_accy 2.10:   5%|▌         | 1/20 [01:10<11:53, 37.56s/it]                SNet: Task 1, Epoch 2/20 => Loss 4.727,  Train_accy 2.10:  10%|█         | 2/20 [01:10<10:31, 35.10s/it]SNet: Task 1, Epoch 3/20 => Loss 4.724,  Train_accy 2.51:  10%|█         | 2/20 [01:46<10:31, 35.10s/it]SNet: Task 1, Epoch 3/20 => Loss 4.724,  Train_accy 2.51:  15%|█▌        | 3/20 [01:46<09:57, 35.17s/it]SNet: Task 1, Epoch 4/20 => Loss 4.722,  Train_accy 2.17:  15%|█▌        | 3/20 [02:19<09:57, 35.17s/it]SNet: Task 1, Epoch 4/20 => Loss 4.722,  Train_accy 2.17:  20%|██        | 4/20 [02:19<09:11, 34.46s/it]SNet: Task 1, Epoch 5/20 => Loss 4.722,  Train_accy 2.37:  20%|██        | 4/20 [02:52<09:11, 34.46s/it]SNet: Task 1, Epoch 5/20 => Loss 4.722,  Train_accy 2.37:  25%|██▌       | 5/20 [02:52<08:30, 34.05s/it]SNet: Task 1, Epoch 6/20 => Loss 4.720,  Train_accy 2.81, Test_accy 1.77:  25%|██▌       | 5/20 [03:30<08:30, 34.05s/it]SNet: Task 1, Epoch 6/20 => Loss 4.720,  Train_accy 2.81, Test_accy 1.77:  30%|███       | 6/20 [03:30<08:13, 35.24s/it]SNet: Task 1, Epoch 7/20 => Loss 4.719,  Train_accy 2.24:  30%|███       | 6/20 [04:03<08:13, 35.24s/it]                SNet: Task 1, Epoch 7/20 => Loss 4.719,  Train_accy 2.24:  35%|███▌      | 7/20 [04:03<07:30, 34.62s/it]SNet: Task 1, Epoch 8/20 => Loss 4.720,  Train_accy 2.30:  35%|███▌      | 7/20 [04:36<07:30, 34.62s/it]SNet: Task 1, Epoch 8/20 => Loss 4.720,  Train_accy 2.30:  40%|████      | 8/20 [04:36<06:49, 34.14s/it]SNet: Task 1, Epoch 9/20 => Loss 4.718,  Train_accy 2.74:  40%|████      | 8/20 [05:10<06:49, 34.14s/it]SNet: Task 1, Epoch 9/20 => Loss 4.718,  Train_accy 2.74:  45%|████▌     | 9/20 [05:10<06:12, 33.84s/it]SNet: Task 1, Epoch 10/20 => Loss 4.717,  Train_accy 2.27:  45%|████▌     | 9/20 [05:43<06:12, 33.84s/it]SNet: Task 1, Epoch 10/20 => Loss 4.717,  Train_accy 2.27:  50%|█████     | 10/20 [05:43<05:36, 33.64s/it]SNet: Task 1, Epoch 11/20 => Loss 4.716,  Train_accy 2.24, Test_accy 2.19:  50%|█████     | 10/20 [06:20<05:36, 33.64s/it]SNet: Task 1, Epoch 11/20 => Loss 4.716,  Train_accy 2.24, Test_accy 2.19:  55%|█████▌    | 11/20 [06:20<05:12, 34.76s/it]SNet: Task 1, Epoch 12/20 => Loss 4.716,  Train_accy 2.27:  55%|█████▌    | 11/20 [06:53<05:12, 34.76s/it]                SNet: Task 1, Epoch 12/20 => Loss 4.716,  Train_accy 2.27:  60%|██████    | 12/20 [06:53<04:34, 34.28s/it]SNet: Task 1, Epoch 13/20 => Loss 4.716,  Train_accy 2.44:  60%|██████    | 12/20 [07:26<04:34, 34.28s/it]SNet: Task 1, Epoch 13/20 => Loss 4.716,  Train_accy 2.44:  65%|██████▌   | 13/20 [07:26<03:57, 33.95s/it]SNet: Task 1, Epoch 14/20 => Loss 4.716,  Train_accy 2.41:  65%|██████▌   | 13/20 [08:00<03:57, 33.95s/it]SNet: Task 1, Epoch 14/20 => Loss 4.716,  Train_accy 2.41:  70%|███████   | 14/20 [08:00<03:22, 33.73s/it]SNet: Task 1, Epoch 15/20 => Loss 4.715,  Train_accy 2.74:  70%|███████   | 14/20 [08:33<03:22, 33.73s/it]SNet: Task 1, Epoch 15/20 => Loss 4.715,  Train_accy 2.74:  75%|███████▌  | 15/20 [08:33<02:47, 33.55s/it]SNet: Task 1, Epoch 16/20 => Loss 4.715,  Train_accy 2.81, Test_accy 1.98:  75%|███████▌  | 15/20 [09:11<02:47, 33.55s/it]SNet: Task 1, Epoch 16/20 => Loss 4.715,  Train_accy 2.81, Test_accy 1.98:  80%|████████  | 16/20 [09:11<02:19, 34.84s/it]SNet: Task 1, Epoch 17/20 => Loss 4.717,  Train_accy 2.30:  80%|████████  | 16/20 [09:44<02:19, 34.84s/it]                SNet: Task 1, Epoch 17/20 => Loss 4.717,  Train_accy 2.30:  85%|████████▌ | 17/20 [09:44<01:43, 34.36s/it]SNet: Task 1, Epoch 18/20 => Loss 4.714,  Train_accy 2.64:  85%|████████▌ | 17/20 [10:17<01:43, 34.36s/it]SNet: Task 1, Epoch 18/20 => Loss 4.714,  Train_accy 2.64:  90%|█████████ | 18/20 [10:17<01:08, 34.10s/it]SNet: Task 1, Epoch 19/20 => Loss 4.715,  Train_accy 2.41:  90%|█████████ | 18/20 [10:50<01:08, 34.10s/it]SNet: Task 1, Epoch 19/20 => Loss 4.715,  Train_accy 2.41:  95%|█████████▌| 19/20 [10:50<00:33, 33.81s/it]SNet: Task 1, Epoch 20/20 => Loss 4.716,  Train_accy 2.78:  95%|█████████▌| 19/20 [11:24<00:33, 33.81s/it]SNet: Task 1, Epoch 20/20 => Loss 4.716,  Train_accy 2.78: 100%|██████████| 20/20 [11:24<00:00, 33.61s/it]SNet: Task 1, Epoch 20/20 => Loss 4.716,  Train_accy 2.78: 100%|██████████| 20/20 [11:24<00:00, 34.21s/it]
2024-04-29 15:33:19,973 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 4.716,  Train_accy 2.78
2024-04-29 15:33:19,973 [foster.py] => do not weight align student!
2024-04-29 15:33:24,081 [foster.py] => darknet eval: 
2024-04-29 15:33:24,081 [foster.py] => CNN top1 curve: 1.98
2024-04-29 15:33:24,082 [foster.py] => CNN top5 curve: 9.53
2024-04-29 15:33:24,085 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 15:34:44,852 [foster.py] => Exemplar size: 2400
2024-04-29 15:34:44,853 [trainer.py] => CNN: {'total': 4.31, '00-99': 2.86, '100-119': 11.84, 'old': 2.86, 'new': 11.84}
2024-04-29 15:34:44,853 [trainer.py] => NME: {'total': 4.31, '00-99': 3.87, '100-119': 6.58, 'old': 3.87, 'new': 6.58}
2024-04-29 15:34:44,853 [trainer.py] => CNN top1 curve: [1.35, 4.31]
2024-04-29 15:34:44,853 [trainer.py] => CNN top5 curve: [8.84, 14.19]
2024-04-29 15:34:44,853 [trainer.py] => NME top1 curve: [1.77, 4.31]
2024-04-29 15:34:44,853 [trainer.py] => NME top5 curve: [11.53, 14.48]

Average Accuracy (CNN): 2.83
Average Accuracy (NME): 3.04
2024-04-29 15:34:44,853 [trainer.py] => Average Accuracy (CNN): 2.83
2024-04-29 15:34:44,853 [trainer.py] => Average Accuracy (NME): 3.04
2024-04-29 15:34:44,853 [trainer.py] => Train Time: 1879.57
2024-04-29 15:34:44,853 [trainer.py] => Test Time: 22.18 

2024-04-29 15:34:44,854 [trainer.py] => All params: 171950932
2024-04-29 15:34:44,855 [trainer.py] => Trainable params: 86075376
2024-04-29 15:34:49,053 [foster.py] => Learning on 120-140
2024-04-29 15:34:49,056 [foster.py] => All params: 172012432
2024-04-29 15:34:49,058 [foster.py] => Trainable params: 86121496
2024-04-29 15:34:49,120 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604]
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 14.526, Loss_clf 4.838, Loss_fe 4.955, Loss_kd 4.056, Train_accy 1.79, Test_accy 1.95:   0%|          | 0/20 [00:38<?, ?it/s]Task 2, Epoch 1/20 => Loss 14.526, Loss_clf 4.838, Loss_fe 4.955, Loss_kd 4.056, Train_accy 1.79, Test_accy 1.95:   5%|▌         | 1/20 [00:38<12:06, 38.25s/it]Task 2, Epoch 2/20 => Loss 14.341, Loss_clf 4.760, Loss_fe 4.846, Loss_kd 4.059, Train_accy 2.09:   5%|▌         | 1/20 [01:08<12:06, 38.25s/it]                Task 2, Epoch 2/20 => Loss 14.341, Loss_clf 4.760, Loss_fe 4.846, Loss_kd 4.059, Train_accy 2.09:  10%|█         | 2/20 [01:08<09:59, 33.30s/it]Task 2, Epoch 3/20 => Loss 14.282, Loss_clf 4.740, Loss_fe 4.802, Loss_kd 4.063, Train_accy 2.42:  10%|█         | 2/20 [01:37<09:59, 33.30s/it]Task 2, Epoch 3/20 => Loss 14.282, Loss_clf 4.740, Loss_fe 4.802, Loss_kd 4.063, Train_accy 2.42:  15%|█▌        | 3/20 [01:37<08:58, 31.69s/it]Task 2, Epoch 4/20 => Loss 14.148, Loss_clf 4.680, Loss_fe 4.725, Loss_kd 4.065, Train_accy 2.47:  15%|█▌        | 3/20 [02:07<08:58, 31.69s/it]Task 2, Epoch 4/20 => Loss 14.148, Loss_clf 4.680, Loss_fe 4.725, Loss_kd 4.065, Train_accy 2.47:  20%|██        | 4/20 [02:07<08:15, 30.98s/it]Task 2, Epoch 5/20 => Loss 14.028, Loss_clf 4.611, Loss_fe 4.663, Loss_kd 4.075, Train_accy 3.01:  20%|██        | 4/20 [02:37<08:15, 30.98s/it]Task 2, Epoch 5/20 => Loss 14.028, Loss_clf 4.611, Loss_fe 4.663, Loss_kd 4.075, Train_accy 3.01:  25%|██▌       | 5/20 [02:37<07:40, 30.71s/it]Task 2, Epoch 6/20 => Loss 13.907, Loss_clf 4.548, Loss_fe 4.600, Loss_kd 4.079, Train_accy 2.95, Test_accy 2.74:  25%|██▌       | 5/20 [03:17<07:40, 30.71s/it]Task 2, Epoch 6/20 => Loss 13.907, Loss_clf 4.548, Loss_fe 4.600, Loss_kd 4.079, Train_accy 2.95, Test_accy 2.74:  30%|███       | 6/20 [03:17<07:50, 33.62s/it]Task 2, Epoch 7/20 => Loss 13.860, Loss_clf 4.523, Loss_fe 4.572, Loss_kd 4.084, Train_accy 3.52:  30%|███       | 6/20 [03:47<07:50, 33.62s/it]                Task 2, Epoch 7/20 => Loss 13.860, Loss_clf 4.523, Loss_fe 4.572, Loss_kd 4.084, Train_accy 3.52:  35%|███▌      | 7/20 [03:47<07:03, 32.55s/it]Task 2, Epoch 8/20 => Loss 13.823, Loss_clf 4.508, Loss_fe 4.548, Loss_kd 4.086, Train_accy 3.04:  35%|███▌      | 7/20 [04:17<07:03, 32.55s/it]Task 2, Epoch 8/20 => Loss 13.823, Loss_clf 4.508, Loss_fe 4.548, Loss_kd 4.086, Train_accy 3.04:  40%|████      | 8/20 [04:17<06:21, 31.81s/it]Task 2, Epoch 9/20 => Loss 13.759, Loss_clf 4.480, Loss_fe 4.511, Loss_kd 4.087, Train_accy 3.64:  40%|████      | 8/20 [04:48<06:21, 31.81s/it]Task 2, Epoch 9/20 => Loss 13.759, Loss_clf 4.480, Loss_fe 4.511, Loss_kd 4.087, Train_accy 3.64:  45%|████▌     | 9/20 [04:48<05:44, 31.31s/it]Task 2, Epoch 10/20 => Loss 13.733, Loss_clf 4.468, Loss_fe 4.497, Loss_kd 4.087, Train_accy 3.94:  45%|████▌     | 9/20 [05:18<05:44, 31.31s/it]Task 2, Epoch 10/20 => Loss 13.733, Loss_clf 4.468, Loss_fe 4.497, Loss_kd 4.087, Train_accy 3.94:  50%|█████     | 10/20 [05:18<05:09, 30.99s/it]Task 2, Epoch 11/20 => Loss 13.651, Loss_clf 4.431, Loss_fe 4.447, Loss_kd 4.091, Train_accy 3.91, Test_accy 3.90:  50%|█████     | 10/20 [05:57<05:09, 30.99s/it]Task 2, Epoch 11/20 => Loss 13.651, Loss_clf 4.431, Loss_fe 4.447, Loss_kd 4.091, Train_accy 3.91, Test_accy 3.90:  55%|█████▌    | 11/20 [05:57<05:01, 33.46s/it]Task 2, Epoch 12/20 => Loss 13.622, Loss_clf 4.422, Loss_fe 4.428, Loss_kd 4.091, Train_accy 3.91:  55%|█████▌    | 11/20 [06:27<05:01, 33.46s/it]                Task 2, Epoch 12/20 => Loss 13.622, Loss_clf 4.422, Loss_fe 4.428, Loss_kd 4.091, Train_accy 3.91:  60%|██████    | 12/20 [06:27<04:20, 32.52s/it]Task 2, Epoch 13/20 => Loss 13.584, Loss_clf 4.402, Loss_fe 4.407, Loss_kd 4.093, Train_accy 4.20:  60%|██████    | 12/20 [06:57<04:20, 32.52s/it]Task 2, Epoch 13/20 => Loss 13.584, Loss_clf 4.402, Loss_fe 4.407, Loss_kd 4.093, Train_accy 4.20:  65%|██████▌   | 13/20 [06:57<03:42, 31.80s/it]Task 2, Epoch 14/20 => Loss 13.590, Loss_clf 4.404, Loss_fe 4.412, Loss_kd 4.093, Train_accy 3.82:  65%|██████▌   | 13/20 [07:28<03:42, 31.80s/it]Task 2, Epoch 14/20 => Loss 13.590, Loss_clf 4.404, Loss_fe 4.412, Loss_kd 4.093, Train_accy 3.82:  70%|███████   | 14/20 [07:28<03:07, 31.33s/it]Task 2, Epoch 15/20 => Loss 13.537, Loss_clf 4.383, Loss_fe 4.379, Loss_kd 4.093, Train_accy 4.38:  70%|███████   | 14/20 [07:58<03:07, 31.33s/it]Task 2, Epoch 15/20 => Loss 13.537, Loss_clf 4.383, Loss_fe 4.379, Loss_kd 4.093, Train_accy 4.38:  75%|███████▌  | 15/20 [07:58<02:34, 30.98s/it]Task 2, Epoch 16/20 => Loss 13.473, Loss_clf 4.349, Loss_fe 4.345, Loss_kd 4.096, Train_accy 4.26, Test_accy 4.51:  75%|███████▌  | 15/20 [08:37<02:34, 30.98s/it]Task 2, Epoch 16/20 => Loss 13.473, Loss_clf 4.349, Loss_fe 4.345, Loss_kd 4.096, Train_accy 4.26, Test_accy 4.51:  80%|████████  | 16/20 [08:37<02:13, 33.40s/it]Task 2, Epoch 17/20 => Loss 13.405, Loss_clf 4.318, Loss_fe 4.308, Loss_kd 4.096, Train_accy 5.16:  80%|████████  | 16/20 [09:07<02:13, 33.40s/it]                Task 2, Epoch 17/20 => Loss 13.405, Loss_clf 4.318, Loss_fe 4.308, Loss_kd 4.096, Train_accy 5.16:  85%|████████▌ | 17/20 [09:07<01:37, 32.46s/it]Task 2, Epoch 18/20 => Loss 13.412, Loss_clf 4.318, Loss_fe 4.313, Loss_kd 4.098, Train_accy 4.86:  85%|████████▌ | 17/20 [09:37<01:37, 32.46s/it]Task 2, Epoch 18/20 => Loss 13.412, Loss_clf 4.318, Loss_fe 4.313, Loss_kd 4.098, Train_accy 4.86:  90%|█████████ | 18/20 [09:37<01:03, 31.75s/it]Task 2, Epoch 19/20 => Loss 13.381, Loss_clf 4.309, Loss_fe 4.291, Loss_kd 4.097, Train_accy 5.07:  90%|█████████ | 18/20 [10:07<01:03, 31.75s/it]Task 2, Epoch 19/20 => Loss 13.381, Loss_clf 4.309, Loss_fe 4.291, Loss_kd 4.097, Train_accy 5.07:  95%|█████████▌| 19/20 [10:07<00:31, 31.27s/it]Task 2, Epoch 20/20 => Loss 13.411, Loss_clf 4.318, Loss_fe 4.311, Loss_kd 4.098, Train_accy 4.77:  95%|█████████▌| 19/20 [10:37<00:31, 31.27s/it]Task 2, Epoch 20/20 => Loss 13.411, Loss_clf 4.318, Loss_fe 4.311, Loss_kd 4.098, Train_accy 4.77: 100%|██████████| 20/20 [10:37<00:00, 30.92s/it]Task 2, Epoch 20/20 => Loss 13.411, Loss_clf 4.318, Loss_fe 4.311, Loss_kd 4.098, Train_accy 4.77: 100%|██████████| 20/20 [10:37<00:00, 31.90s/it]
2024-04-29 15:45:27,065 [foster.py] => Task 2, Epoch 20/20 => Loss 13.411, Loss_clf 4.318, Loss_fe 4.311, Loss_kd 4.098, Train_accy 4.77
2024-04-29 15:45:27,066 [foster.py] => do not weight align teacher!
2024-04-29 15:45:27,068 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102]
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 2, Epoch 1/20 => Loss 4.877,  Train_accy 2.21, Test_accy 1.65:   0%|          | 0/20 [00:42<?, ?it/s]SNet: Task 2, Epoch 1/20 => Loss 4.877,  Train_accy 2.21, Test_accy 1.65:   5%|▌         | 1/20 [00:42<13:35, 42.94s/it]SNet: Task 2, Epoch 2/20 => Loss 4.861,  Train_accy 1.82:   5%|▌         | 1/20 [01:20<13:35, 42.94s/it]                SNet: Task 2, Epoch 2/20 => Loss 4.861,  Train_accy 1.82:  10%|█         | 2/20 [01:20<12:00, 40.03s/it]SNet: Task 2, Epoch 3/20 => Loss 4.858,  Train_accy 2.06:  10%|█         | 2/20 [01:58<12:00, 40.03s/it]SNet: Task 2, Epoch 3/20 => Loss 4.858,  Train_accy 2.06:  15%|█▌        | 3/20 [01:58<11:05, 39.13s/it]SNet: Task 2, Epoch 4/20 => Loss 4.857,  Train_accy 2.42:  15%|█▌        | 3/20 [02:36<11:05, 39.13s/it]SNet: Task 2, Epoch 4/20 => Loss 4.857,  Train_accy 2.42:  20%|██        | 4/20 [02:36<10:18, 38.67s/it]SNet: Task 2, Epoch 5/20 => Loss 4.856,  Train_accy 2.24:  20%|██        | 4/20 [03:14<10:18, 38.67s/it]SNet: Task 2, Epoch 5/20 => Loss 4.856,  Train_accy 2.24:  25%|██▌       | 5/20 [03:14<09:36, 38.41s/it]SNet: Task 2, Epoch 6/20 => Loss 4.856,  Train_accy 2.06, Test_accy 1.89:  25%|██▌       | 5/20 [03:57<09:36, 38.41s/it]SNet: Task 2, Epoch 6/20 => Loss 4.856,  Train_accy 2.06, Test_accy 1.89:  30%|███       | 6/20 [03:57<09:19, 39.93s/it]SNet: Task 2, Epoch 7/20 => Loss 4.855,  Train_accy 2.56:  30%|███       | 6/20 [04:35<09:19, 39.93s/it]                SNet: Task 2, Epoch 7/20 => Loss 4.855,  Train_accy 2.56:  35%|███▌      | 7/20 [04:35<08:30, 39.27s/it]SNet: Task 2, Epoch 8/20 => Loss 4.854,  Train_accy 2.44:  35%|███▌      | 7/20 [05:13<08:30, 39.27s/it]SNet: Task 2, Epoch 8/20 => Loss 4.854,  Train_accy 2.44:  40%|████      | 8/20 [05:13<07:45, 38.83s/it]SNet: Task 2, Epoch 9/20 => Loss 4.853,  Train_accy 2.39:  40%|████      | 8/20 [05:51<07:45, 38.83s/it]SNet: Task 2, Epoch 9/20 => Loss 4.853,  Train_accy 2.39:  45%|████▌     | 9/20 [05:51<07:04, 38.55s/it]SNet: Task 2, Epoch 10/20 => Loss 4.852,  Train_accy 2.21:  45%|████▌     | 9/20 [06:29<07:04, 38.55s/it]SNet: Task 2, Epoch 10/20 => Loss 4.852,  Train_accy 2.21:  50%|█████     | 10/20 [06:29<06:23, 38.36s/it]SNet: Task 2, Epoch 11/20 => Loss 4.854,  Train_accy 2.24, Test_accy 1.95:  50%|█████     | 10/20 [07:12<06:23, 38.36s/it]SNet: Task 2, Epoch 11/20 => Loss 4.854,  Train_accy 2.24, Test_accy 1.95:  55%|█████▌    | 11/20 [07:12<05:57, 39.72s/it]SNet: Task 2, Epoch 12/20 => Loss 4.853,  Train_accy 2.33:  55%|█████▌    | 11/20 [07:50<05:57, 39.72s/it]                SNet: Task 2, Epoch 12/20 => Loss 4.853,  Train_accy 2.33:  60%|██████    | 12/20 [07:50<05:13, 39.24s/it]SNet: Task 2, Epoch 13/20 => Loss 4.852,  Train_accy 2.00:  60%|██████    | 12/20 [08:28<05:13, 39.24s/it]SNet: Task 2, Epoch 13/20 => Loss 4.852,  Train_accy 2.00:  65%|██████▌   | 13/20 [08:28<04:31, 38.84s/it]SNet: Task 2, Epoch 14/20 => Loss 4.853,  Train_accy 2.39:  65%|██████▌   | 13/20 [09:06<04:31, 38.84s/it]SNet: Task 2, Epoch 14/20 => Loss 4.853,  Train_accy 2.39:  70%|███████   | 14/20 [09:06<03:51, 38.55s/it]SNet: Task 2, Epoch 15/20 => Loss 4.852,  Train_accy 2.15:  70%|███████   | 14/20 [09:44<03:51, 38.55s/it]SNet: Task 2, Epoch 15/20 => Loss 4.852,  Train_accy 2.15:  75%|███████▌  | 15/20 [09:44<03:12, 38.42s/it]SNet: Task 2, Epoch 16/20 => Loss 4.852,  Train_accy 2.09, Test_accy 2.01:  75%|███████▌  | 15/20 [10:27<03:12, 38.42s/it]SNet: Task 2, Epoch 16/20 => Loss 4.852,  Train_accy 2.09, Test_accy 2.01:  80%|████████  | 16/20 [10:27<02:39, 39.79s/it]SNet: Task 2, Epoch 17/20 => Loss 4.852,  Train_accy 2.30:  80%|████████  | 16/20 [11:05<02:39, 39.79s/it]                SNet: Task 2, Epoch 17/20 => Loss 4.852,  Train_accy 2.30:  85%|████████▌ | 17/20 [11:05<01:57, 39.27s/it]SNet: Task 2, Epoch 18/20 => Loss 4.852,  Train_accy 2.27:  85%|████████▌ | 17/20 [11:43<01:57, 39.27s/it]SNet: Task 2, Epoch 18/20 => Loss 4.852,  Train_accy 2.27:  90%|█████████ | 18/20 [11:43<01:17, 38.94s/it]SNet: Task 2, Epoch 19/20 => Loss 4.852,  Train_accy 2.00:  90%|█████████ | 18/20 [12:21<01:17, 38.94s/it]SNet: Task 2, Epoch 19/20 => Loss 4.852,  Train_accy 2.00:  95%|█████████▌| 19/20 [12:21<00:38, 38.67s/it]SNet: Task 2, Epoch 20/20 => Loss 4.852,  Train_accy 2.39:  95%|█████████▌| 19/20 [12:59<00:38, 38.67s/it]SNet: Task 2, Epoch 20/20 => Loss 4.852,  Train_accy 2.39: 100%|██████████| 20/20 [12:59<00:00, 38.48s/it]SNet: Task 2, Epoch 20/20 => Loss 4.852,  Train_accy 2.39: 100%|██████████| 20/20 [12:59<00:00, 38.98s/it]
2024-04-29 15:58:29,761 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 4.852,  Train_accy 2.39
2024-04-29 15:58:29,761 [foster.py] => do not weight align student!
2024-04-29 15:58:34,556 [foster.py] => darknet eval: 
2024-04-29 15:58:34,556 [foster.py] => CNN top1 curve: 2.01
2024-04-29 15:58:34,557 [foster.py] => CNN top5 curve: 8.78
2024-04-29 15:58:34,559 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 16:00:14,428 [foster.py] => Exemplar size: 2800
2024-04-29 16:00:14,429 [trainer.py] => CNN: {'total': 4.51, '00-99': 5.3, '100-119': 1.75, '120-139': 3.11, 'old': 4.73, 'new': 3.11}
2024-04-29 16:00:14,429 [trainer.py] => NME: {'total': 4.27, '00-99': 4.46, '100-119': 4.82, '120-139': 2.67, 'old': 4.52, 'new': 2.67}
2024-04-29 16:00:14,429 [trainer.py] => CNN top1 curve: [1.35, 4.31, 4.51]
2024-04-29 16:00:14,429 [trainer.py] => CNN top5 curve: [8.84, 14.19, 15.11]
2024-04-29 16:00:14,429 [trainer.py] => NME top1 curve: [1.77, 4.31, 4.27]
2024-04-29 16:00:14,429 [trainer.py] => NME top5 curve: [11.53, 14.48, 15.3]

Average Accuracy (CNN): 3.39
Average Accuracy (NME): 3.45
2024-04-29 16:00:14,429 [trainer.py] => Average Accuracy (CNN): 3.39
2024-04-29 16:00:14,429 [trainer.py] => Average Accuracy (NME): 3.45
2024-04-29 16:00:14,429 [trainer.py] => Train Time: 3305.06
2024-04-29 16:00:14,429 [trainer.py] => Test Time: 39.97 

2024-04-29 16:00:14,431 [trainer.py] => All params: 172012432
2024-04-29 16:00:14,432 [trainer.py] => Trainable params: 86121496
2024-04-29 16:00:19,705 [foster.py] => Learning on 140-160
2024-04-29 16:00:19,707 [foster.py] => All params: 172073932
2024-04-29 16:00:19,709 [foster.py] => Trainable params: 86167616
2024-04-29 16:00:19,767 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006]
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 14.901, Loss_clf 4.927, Loss_fe 5.105, Loss_kd 4.260, Train_accy 1.80, Test_accy 2.06:   0%|          | 0/20 [00:43<?, ?it/s]Task 3, Epoch 1/20 => Loss 14.901, Loss_clf 4.927, Loss_fe 5.105, Loss_kd 4.260, Train_accy 1.80, Test_accy 2.06:   5%|▌         | 1/20 [00:43<13:48, 43.60s/it]Task 3, Epoch 2/20 => Loss 14.774, Loss_clf 4.876, Loss_fe 5.025, Loss_kd 4.264, Train_accy 1.96:   5%|▌         | 1/20 [01:17<13:48, 43.60s/it]                Task 3, Epoch 2/20 => Loss 14.774, Loss_clf 4.876, Loss_fe 5.025, Loss_kd 4.264, Train_accy 1.96:  10%|█         | 2/20 [01:17<11:18, 37.72s/it]Task 3, Epoch 3/20 => Loss 14.706, Loss_clf 4.868, Loss_fe 4.966, Loss_kd 4.262, Train_accy 1.83:  10%|█         | 2/20 [01:51<11:18, 37.72s/it]Task 3, Epoch 3/20 => Loss 14.706, Loss_clf 4.868, Loss_fe 4.966, Loss_kd 4.262, Train_accy 1.83:  15%|█▌        | 3/20 [01:51<10:11, 35.95s/it]Task 3, Epoch 4/20 => Loss 14.601, Loss_clf 4.829, Loss_fe 4.899, Loss_kd 4.264, Train_accy 2.12:  15%|█▌        | 3/20 [02:24<10:11, 35.95s/it]Task 3, Epoch 4/20 => Loss 14.601, Loss_clf 4.829, Loss_fe 4.899, Loss_kd 4.264, Train_accy 2.12:  20%|██        | 4/20 [02:24<09:21, 35.07s/it]Task 3, Epoch 5/20 => Loss 14.600, Loss_clf 4.842, Loss_fe 4.884, Loss_kd 4.265, Train_accy 1.72:  20%|██        | 4/20 [02:58<09:21, 35.07s/it]Task 3, Epoch 5/20 => Loss 14.600, Loss_clf 4.842, Loss_fe 4.884, Loss_kd 4.265, Train_accy 1.72:  25%|██▌       | 5/20 [02:58<08:38, 34.55s/it]Task 3, Epoch 6/20 => Loss 14.528, Loss_clf 4.808, Loss_fe 4.847, Loss_kd 4.264, Train_accy 1.94, Test_accy 2.54:  25%|██▌       | 5/20 [03:42<08:38, 34.55s/it]Task 3, Epoch 6/20 => Loss 14.528, Loss_clf 4.808, Loss_fe 4.847, Loss_kd 4.264, Train_accy 1.94, Test_accy 2.54:  30%|███       | 6/20 [03:42<08:48, 37.74s/it]Task 3, Epoch 7/20 => Loss 14.459, Loss_clf 4.780, Loss_fe 4.802, Loss_kd 4.267, Train_accy 2.80:  30%|███       | 6/20 [04:15<08:48, 37.74s/it]                Task 3, Epoch 7/20 => Loss 14.459, Loss_clf 4.780, Loss_fe 4.802, Loss_kd 4.267, Train_accy 2.80:  35%|███▌      | 7/20 [04:15<07:52, 36.38s/it]Task 3, Epoch 8/20 => Loss 14.372, Loss_clf 4.737, Loss_fe 4.756, Loss_kd 4.270, Train_accy 2.53:  35%|███▌      | 7/20 [04:49<07:52, 36.38s/it]Task 3, Epoch 8/20 => Loss 14.372, Loss_clf 4.737, Loss_fe 4.756, Loss_kd 4.270, Train_accy 2.53:  40%|████      | 8/20 [04:49<07:05, 35.50s/it]Task 3, Epoch 9/20 => Loss 14.323, Loss_clf 4.709, Loss_fe 4.732, Loss_kd 4.272, Train_accy 2.77:  40%|████      | 8/20 [05:23<07:05, 35.50s/it]Task 3, Epoch 9/20 => Loss 14.323, Loss_clf 4.709, Loss_fe 4.732, Loss_kd 4.272, Train_accy 2.77:  45%|████▌     | 9/20 [05:23<06:24, 34.96s/it]Task 3, Epoch 10/20 => Loss 14.248, Loss_clf 4.675, Loss_fe 4.688, Loss_kd 4.274, Train_accy 2.85:  45%|████▌     | 9/20 [05:57<06:24, 34.96s/it]Task 3, Epoch 10/20 => Loss 14.248, Loss_clf 4.675, Loss_fe 4.688, Loss_kd 4.274, Train_accy 2.85:  50%|█████     | 10/20 [05:57<05:45, 34.60s/it]Task 3, Epoch 11/20 => Loss 14.164, Loss_clf 4.638, Loss_fe 4.639, Loss_kd 4.276, Train_accy 2.77, Test_accy 4.02:  50%|█████     | 10/20 [06:40<05:45, 34.60s/it]Task 3, Epoch 11/20 => Loss 14.164, Loss_clf 4.638, Loss_fe 4.639, Loss_kd 4.276, Train_accy 2.77, Test_accy 4.02:  55%|█████▌    | 11/20 [06:40<05:36, 37.41s/it]Task 3, Epoch 12/20 => Loss 14.103, Loss_clf 4.609, Loss_fe 4.601, Loss_kd 4.282, Train_accy 3.36:  55%|█████▌    | 11/20 [07:14<05:36, 37.41s/it]                Task 3, Epoch 12/20 => Loss 14.103, Loss_clf 4.609, Loss_fe 4.601, Loss_kd 4.282, Train_accy 3.36:  60%|██████    | 12/20 [07:14<04:49, 36.21s/it]Task 3, Epoch 13/20 => Loss 14.041, Loss_clf 4.574, Loss_fe 4.571, Loss_kd 4.284, Train_accy 3.68:  60%|██████    | 12/20 [07:47<04:49, 36.21s/it]Task 3, Epoch 13/20 => Loss 14.041, Loss_clf 4.574, Loss_fe 4.571, Loss_kd 4.284, Train_accy 3.68:  65%|██████▌   | 13/20 [07:47<04:07, 35.41s/it]Task 3, Epoch 14/20 => Loss 13.963, Loss_clf 4.540, Loss_fe 4.524, Loss_kd 4.287, Train_accy 4.35:  65%|██████▌   | 13/20 [08:21<04:07, 35.41s/it]Task 3, Epoch 14/20 => Loss 13.963, Loss_clf 4.540, Loss_fe 4.524, Loss_kd 4.287, Train_accy 4.35:  70%|███████   | 14/20 [08:21<03:29, 34.90s/it]Task 3, Epoch 15/20 => Loss 13.933, Loss_clf 4.520, Loss_fe 4.513, Loss_kd 4.287, Train_accy 4.54:  70%|███████   | 14/20 [08:55<03:29, 34.90s/it]Task 3, Epoch 15/20 => Loss 13.933, Loss_clf 4.520, Loss_fe 4.513, Loss_kd 4.287, Train_accy 4.54:  75%|███████▌  | 15/20 [08:55<02:52, 34.50s/it]Task 3, Epoch 16/20 => Loss 13.893, Loss_clf 4.506, Loss_fe 4.485, Loss_kd 4.289, Train_accy 4.30, Test_accy 4.18:  75%|███████▌  | 15/20 [09:39<02:52, 34.50s/it]Task 3, Epoch 16/20 => Loss 13.893, Loss_clf 4.506, Loss_fe 4.485, Loss_kd 4.289, Train_accy 4.30, Test_accy 4.18:  80%|████████  | 16/20 [09:39<02:29, 37.36s/it]Task 3, Epoch 17/20 => Loss 13.832, Loss_clf 4.472, Loss_fe 4.458, Loss_kd 4.290, Train_accy 4.54:  80%|████████  | 16/20 [10:12<02:29, 37.36s/it]                Task 3, Epoch 17/20 => Loss 13.832, Loss_clf 4.472, Loss_fe 4.458, Loss_kd 4.290, Train_accy 4.54:  85%|████████▌ | 17/20 [10:12<01:48, 36.22s/it]Task 3, Epoch 18/20 => Loss 13.821, Loss_clf 4.470, Loss_fe 4.444, Loss_kd 4.294, Train_accy 4.68:  85%|████████▌ | 17/20 [10:46<01:48, 36.22s/it]Task 3, Epoch 18/20 => Loss 13.821, Loss_clf 4.470, Loss_fe 4.444, Loss_kd 4.294, Train_accy 4.68:  90%|█████████ | 18/20 [10:46<01:10, 35.43s/it]Task 3, Epoch 19/20 => Loss 13.797, Loss_clf 4.460, Loss_fe 4.429, Loss_kd 4.295, Train_accy 4.54:  90%|█████████ | 18/20 [11:19<01:10, 35.43s/it]Task 3, Epoch 19/20 => Loss 13.797, Loss_clf 4.460, Loss_fe 4.429, Loss_kd 4.295, Train_accy 4.54:  95%|█████████▌| 19/20 [11:19<00:34, 34.87s/it]Task 3, Epoch 20/20 => Loss 13.763, Loss_clf 4.441, Loss_fe 4.414, Loss_kd 4.294, Train_accy 5.43:  95%|█████████▌| 19/20 [11:53<00:34, 34.87s/it]Task 3, Epoch 20/20 => Loss 13.763, Loss_clf 4.441, Loss_fe 4.414, Loss_kd 4.294, Train_accy 5.43: 100%|██████████| 20/20 [11:53<00:00, 34.52s/it]Task 3, Epoch 20/20 => Loss 13.763, Loss_clf 4.441, Loss_fe 4.414, Loss_kd 4.294, Train_accy 5.43: 100%|██████████| 20/20 [11:53<00:00, 35.68s/it]
2024-04-29 16:12:13,394 [foster.py] => Task 3, Epoch 20/20 => Loss 13.763, Loss_clf 4.441, Loss_fe 4.414, Loss_kd 4.294, Train_accy 5.43
2024-04-29 16:12:13,394 [foster.py] => do not weight align teacher!
2024-04-29 16:12:13,397 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755]
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 3, Epoch 1/20 => Loss 4.988,  Train_accy 2.18, Test_accy 1.37:   0%|          | 0/20 [00:48<?, ?it/s]SNet: Task 3, Epoch 1/20 => Loss 4.988,  Train_accy 2.18, Test_accy 1.37:   5%|▌         | 1/20 [00:48<15:12, 48.03s/it]SNet: Task 3, Epoch 2/20 => Loss 4.974,  Train_accy 2.28:   5%|▌         | 1/20 [01:30<15:12, 48.03s/it]                SNet: Task 3, Epoch 2/20 => Loss 4.974,  Train_accy 2.28:  10%|█         | 2/20 [01:30<13:24, 44.71s/it]SNet: Task 3, Epoch 3/20 => Loss 4.971,  Train_accy 2.31:  10%|█         | 2/20 [02:12<13:24, 44.71s/it]SNet: Task 3, Epoch 3/20 => Loss 4.971,  Train_accy 2.31:  15%|█▌        | 3/20 [02:12<12:21, 43.61s/it]SNet: Task 3, Epoch 4/20 => Loss 4.968,  Train_accy 2.07:  15%|█▌        | 3/20 [02:54<12:21, 43.61s/it]SNet: Task 3, Epoch 4/20 => Loss 4.968,  Train_accy 2.07:  20%|██        | 4/20 [02:54<11:28, 43.06s/it]SNet: Task 3, Epoch 5/20 => Loss 4.969,  Train_accy 1.99:  20%|██        | 4/20 [03:37<11:28, 43.06s/it]SNet: Task 3, Epoch 5/20 => Loss 4.969,  Train_accy 1.99:  25%|██▌       | 5/20 [03:37<10:41, 42.78s/it]SNet: Task 3, Epoch 6/20 => Loss 4.967,  Train_accy 2.04, Test_accy 1.69:  25%|██▌       | 5/20 [04:25<10:41, 42.78s/it]SNet: Task 3, Epoch 6/20 => Loss 4.967,  Train_accy 2.04, Test_accy 1.69:  30%|███       | 6/20 [04:25<10:24, 44.60s/it]SNet: Task 3, Epoch 7/20 => Loss 4.965,  Train_accy 2.53:  30%|███       | 6/20 [05:07<10:24, 44.60s/it]                SNet: Task 3, Epoch 7/20 => Loss 4.965,  Train_accy 2.53:  35%|███▌      | 7/20 [05:07<09:29, 43.82s/it]SNet: Task 3, Epoch 8/20 => Loss 4.965,  Train_accy 2.23:  35%|███▌      | 7/20 [05:49<09:29, 43.82s/it]SNet: Task 3, Epoch 8/20 => Loss 4.965,  Train_accy 2.23:  40%|████      | 8/20 [05:49<08:39, 43.30s/it]SNet: Task 3, Epoch 9/20 => Loss 4.964,  Train_accy 2.15:  40%|████      | 8/20 [06:32<08:39, 43.30s/it]SNet: Task 3, Epoch 9/20 => Loss 4.964,  Train_accy 2.15:  45%|████▌     | 9/20 [06:32<07:52, 42.99s/it]SNet: Task 3, Epoch 10/20 => Loss 4.964,  Train_accy 2.34:  45%|████▌     | 9/20 [07:14<07:52, 42.99s/it]SNet: Task 3, Epoch 10/20 => Loss 4.964,  Train_accy 2.34:  50%|█████     | 10/20 [07:14<07:07, 42.75s/it]SNet: Task 3, Epoch 11/20 => Loss 4.964,  Train_accy 2.15, Test_accy 2.12:  50%|█████     | 10/20 [08:02<07:07, 42.75s/it]SNet: Task 3, Epoch 11/20 => Loss 4.964,  Train_accy 2.15, Test_accy 2.12:  55%|█████▌    | 11/20 [08:02<06:39, 44.38s/it]SNet: Task 3, Epoch 12/20 => Loss 4.965,  Train_accy 2.18:  55%|█████▌    | 11/20 [08:44<06:39, 44.38s/it]                SNet: Task 3, Epoch 12/20 => Loss 4.965,  Train_accy 2.18:  60%|██████    | 12/20 [08:44<05:49, 43.73s/it]SNet: Task 3, Epoch 13/20 => Loss 4.964,  Train_accy 2.28:  60%|██████    | 12/20 [09:26<05:49, 43.73s/it]SNet: Task 3, Epoch 13/20 => Loss 4.964,  Train_accy 2.28:  65%|██████▌   | 13/20 [09:26<05:02, 43.29s/it]SNet: Task 3, Epoch 14/20 => Loss 4.963,  Train_accy 2.42:  65%|██████▌   | 13/20 [10:09<05:02, 43.29s/it]SNet: Task 3, Epoch 14/20 => Loss 4.963,  Train_accy 2.42:  70%|███████   | 14/20 [10:09<04:17, 42.99s/it]SNet: Task 3, Epoch 15/20 => Loss 4.963,  Train_accy 2.58:  70%|███████   | 14/20 [10:51<04:17, 42.99s/it]SNet: Task 3, Epoch 15/20 => Loss 4.963,  Train_accy 2.58:  75%|███████▌  | 15/20 [10:51<03:33, 42.79s/it]SNet: Task 3, Epoch 16/20 => Loss 4.963,  Train_accy 2.23, Test_accy 2.12:  75%|███████▌  | 15/20 [11:39<03:33, 42.79s/it]SNet: Task 3, Epoch 16/20 => Loss 4.963,  Train_accy 2.23, Test_accy 2.12:  80%|████████  | 16/20 [11:39<02:57, 44.36s/it]SNet: Task 3, Epoch 17/20 => Loss 4.963,  Train_accy 2.45:  80%|████████  | 16/20 [12:21<02:57, 44.36s/it]                SNet: Task 3, Epoch 17/20 => Loss 4.963,  Train_accy 2.45:  85%|████████▌ | 17/20 [12:21<02:11, 43.71s/it]SNet: Task 3, Epoch 18/20 => Loss 4.964,  Train_accy 2.42:  85%|████████▌ | 17/20 [13:03<02:11, 43.71s/it]SNet: Task 3, Epoch 18/20 => Loss 4.964,  Train_accy 2.42:  90%|█████████ | 18/20 [13:03<01:26, 43.26s/it]SNet: Task 3, Epoch 19/20 => Loss 4.962,  Train_accy 2.39:  90%|█████████ | 18/20 [13:46<01:26, 43.26s/it]SNet: Task 3, Epoch 19/20 => Loss 4.962,  Train_accy 2.39:  95%|█████████▌| 19/20 [13:46<00:42, 42.96s/it]SNet: Task 3, Epoch 20/20 => Loss 4.963,  Train_accy 2.45:  95%|█████████▌| 19/20 [14:28<00:42, 42.96s/it]SNet: Task 3, Epoch 20/20 => Loss 4.963,  Train_accy 2.45: 100%|██████████| 20/20 [14:28<00:00, 42.77s/it]SNet: Task 3, Epoch 20/20 => Loss 4.963,  Train_accy 2.45: 100%|██████████| 20/20 [14:28<00:00, 43.42s/it]
2024-04-29 16:26:49,374 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 4.963,  Train_accy 2.45
2024-04-29 16:26:49,374 [foster.py] => do not weight align student!
2024-04-29 16:26:55,229 [foster.py] => darknet eval: 
2024-04-29 16:26:55,230 [foster.py] => CNN top1 curve: 2.01
2024-04-29 16:26:55,230 [foster.py] => CNN top5 curve: 8.99
2024-04-29 16:26:55,233 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 16:29:00,287 [foster.py] => Exemplar size: 3200
2024-04-29 16:29:00,287 [trainer.py] => CNN: {'total': 4.34, '00-99': 5.39, '100-119': 3.95, '120-139': 0.44, '140-159': 3.2, 'old': 4.51, 'new': 3.2}
2024-04-29 16:29:00,287 [trainer.py] => NME: {'total': 4.02, '00-99': 4.21, '100-119': 4.82, '120-139': 4.0, '140-159': 2.4, 'old': 4.27, 'new': 2.4}
2024-04-29 16:29:00,287 [trainer.py] => CNN top1 curve: [1.35, 4.31, 4.51, 4.34]
2024-04-29 16:29:00,287 [trainer.py] => CNN top5 curve: [8.84, 14.19, 15.11, 16.39]
2024-04-29 16:29:00,287 [trainer.py] => NME top1 curve: [1.77, 4.31, 4.27, 4.02]
2024-04-29 16:29:00,287 [trainer.py] => NME top5 curve: [11.53, 14.48, 15.3, 15.23]

Average Accuracy (CNN): 3.63
Average Accuracy (NME): 3.59
2024-04-29 16:29:00,287 [trainer.py] => Average Accuracy (CNN): 3.63
2024-04-29 16:29:00,287 [trainer.py] => Average Accuracy (NME): 3.59
2024-04-29 16:29:00,287 [trainer.py] => Train Time: 4900.58
2024-04-29 16:29:00,287 [trainer.py] => Test Time: 60.8 

2024-04-29 16:29:00,289 [trainer.py] => All params: 172073932
2024-04-29 16:29:00,290 [trainer.py] => Trainable params: 86167616
2024-04-29 16:29:08,159 [foster.py] => Learning on 160-180
2024-04-29 16:29:08,162 [foster.py] => All params: 172135432
2024-04-29 16:29:08,164 [foster.py] => Trainable params: 86213736
2024-04-29 16:29:08,234 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 15.225, Loss_clf 5.018, Loss_fe 5.222, Loss_kd 4.431, Train_accy 1.64, Test_accy 1.69:   0%|          | 0/20 [00:49<?, ?it/s]Task 4, Epoch 1/20 => Loss 15.225, Loss_clf 5.018, Loss_fe 5.222, Loss_kd 4.431, Train_accy 1.64, Test_accy 1.69:   5%|▌         | 1/20 [00:49<15:32, 49.10s/it]Task 4, Epoch 2/20 => Loss 15.066, Loss_clf 4.925, Loss_fe 5.154, Loss_kd 4.433, Train_accy 1.83:   5%|▌         | 1/20 [01:26<15:32, 49.10s/it]                Task 4, Epoch 2/20 => Loss 15.066, Loss_clf 4.925, Loss_fe 5.154, Loss_kd 4.433, Train_accy 1.83:  10%|█         | 2/20 [01:26<12:42, 42.35s/it]Task 4, Epoch 3/20 => Loss 14.961, Loss_clf 4.898, Loss_fe 5.074, Loss_kd 4.435, Train_accy 2.00:  10%|█         | 2/20 [02:04<12:42, 42.35s/it]Task 4, Epoch 3/20 => Loss 14.961, Loss_clf 4.898, Loss_fe 5.074, Loss_kd 4.435, Train_accy 2.00:  15%|█▌        | 3/20 [02:04<11:22, 40.17s/it]Task 4, Epoch 4/20 => Loss 14.831, Loss_clf 4.857, Loss_fe 4.981, Loss_kd 4.438, Train_accy 2.24:  15%|█▌        | 3/20 [02:41<11:22, 40.17s/it]Task 4, Epoch 4/20 => Loss 14.831, Loss_clf 4.857, Loss_fe 4.981, Loss_kd 4.438, Train_accy 2.24:  20%|██        | 4/20 [02:41<10:25, 39.07s/it]Task 4, Epoch 5/20 => Loss 14.738, Loss_clf 4.812, Loss_fe 4.930, Loss_kd 4.441, Train_accy 2.41:  20%|██        | 4/20 [03:19<10:25, 39.07s/it]Task 4, Epoch 5/20 => Loss 14.738, Loss_clf 4.812, Loss_fe 4.930, Loss_kd 4.441, Train_accy 2.41:  25%|██▌       | 5/20 [03:19<09:37, 38.47s/it]Task 4, Epoch 6/20 => Loss 14.705, Loss_clf 4.803, Loss_fe 4.904, Loss_kd 4.442, Train_accy 2.24, Test_accy 2.77:  25%|██▌       | 5/20 [04:07<09:37, 38.47s/it]Task 4, Epoch 6/20 => Loss 14.705, Loss_clf 4.803, Loss_fe 4.904, Loss_kd 4.442, Train_accy 2.24, Test_accy 2.77:  30%|███       | 6/20 [04:07<09:47, 41.96s/it]Task 4, Epoch 7/20 => Loss 14.628, Loss_clf 4.773, Loss_fe 4.858, Loss_kd 4.442, Train_accy 2.53:  30%|███       | 6/20 [04:45<09:47, 41.96s/it]                Task 4, Epoch 7/20 => Loss 14.628, Loss_clf 4.773, Loss_fe 4.858, Loss_kd 4.442, Train_accy 2.53:  35%|███▌      | 7/20 [04:45<08:45, 40.41s/it]Task 4, Epoch 8/20 => Loss 14.599, Loss_clf 4.760, Loss_fe 4.840, Loss_kd 4.444, Train_accy 2.65:  35%|███▌      | 7/20 [05:22<08:45, 40.41s/it]Task 4, Epoch 8/20 => Loss 14.599, Loss_clf 4.760, Loss_fe 4.840, Loss_kd 4.444, Train_accy 2.65:  40%|████      | 8/20 [05:22<07:53, 39.48s/it]Task 4, Epoch 9/20 => Loss 14.580, Loss_clf 4.757, Loss_fe 4.823, Loss_kd 4.444, Train_accy 2.84:  40%|████      | 8/20 [05:59<07:53, 39.48s/it]Task 4, Epoch 9/20 => Loss 14.580, Loss_clf 4.757, Loss_fe 4.823, Loss_kd 4.444, Train_accy 2.84:  45%|████▌     | 9/20 [05:59<07:07, 38.83s/it]Task 4, Epoch 10/20 => Loss 14.502, Loss_clf 4.712, Loss_fe 4.787, Loss_kd 4.447, Train_accy 3.27:  45%|████▌     | 9/20 [06:37<07:07, 38.83s/it]Task 4, Epoch 10/20 => Loss 14.502, Loss_clf 4.712, Loss_fe 4.787, Loss_kd 4.447, Train_accy 3.27:  50%|█████     | 10/20 [06:37<06:24, 38.41s/it]Task 4, Epoch 11/20 => Loss 14.461, Loss_clf 4.697, Loss_fe 4.762, Loss_kd 4.447, Train_accy 3.08, Test_accy 3.29:  50%|█████     | 10/20 [07:26<06:24, 38.41s/it]Task 4, Epoch 11/20 => Loss 14.461, Loss_clf 4.697, Loss_fe 4.762, Loss_kd 4.447, Train_accy 3.08, Test_accy 3.29:  55%|█████▌    | 11/20 [07:26<06:15, 41.68s/it]Task 4, Epoch 12/20 => Loss 14.393, Loss_clf 4.670, Loss_fe 4.718, Loss_kd 4.448, Train_accy 3.51:  55%|█████▌    | 11/20 [08:03<06:15, 41.68s/it]                Task 4, Epoch 12/20 => Loss 14.393, Loss_clf 4.670, Loss_fe 4.718, Loss_kd 4.448, Train_accy 3.51:  60%|██████    | 12/20 [08:03<05:23, 40.38s/it]Task 4, Epoch 13/20 => Loss 14.365, Loss_clf 4.654, Loss_fe 4.705, Loss_kd 4.449, Train_accy 3.34:  60%|██████    | 12/20 [08:41<05:23, 40.38s/it]Task 4, Epoch 13/20 => Loss 14.365, Loss_clf 4.654, Loss_fe 4.705, Loss_kd 4.449, Train_accy 3.34:  65%|██████▌   | 13/20 [08:41<04:36, 39.49s/it]Task 4, Epoch 14/20 => Loss 14.296, Loss_clf 4.623, Loss_fe 4.667, Loss_kd 4.450, Train_accy 3.90:  65%|██████▌   | 13/20 [09:18<04:36, 39.49s/it]Task 4, Epoch 14/20 => Loss 14.296, Loss_clf 4.623, Loss_fe 4.667, Loss_kd 4.450, Train_accy 3.90:  70%|███████   | 14/20 [09:18<03:53, 38.88s/it]Task 4, Epoch 15/20 => Loss 14.281, Loss_clf 4.622, Loss_fe 4.652, Loss_kd 4.451, Train_accy 4.28:  70%|███████   | 14/20 [09:56<03:53, 38.88s/it]Task 4, Epoch 15/20 => Loss 14.281, Loss_clf 4.622, Loss_fe 4.652, Loss_kd 4.451, Train_accy 4.28:  75%|███████▌  | 15/20 [09:56<03:12, 38.42s/it]Task 4, Epoch 16/20 => Loss 14.212, Loss_clf 4.587, Loss_fe 4.616, Loss_kd 4.453, Train_accy 4.14, Test_accy 4.14:  75%|███████▌  | 15/20 [10:44<03:12, 38.42s/it]Task 4, Epoch 16/20 => Loss 14.212, Loss_clf 4.587, Loss_fe 4.616, Loss_kd 4.453, Train_accy 4.14, Test_accy 4.14:  80%|████████  | 16/20 [10:44<02:46, 41.54s/it]Task 4, Epoch 17/20 => Loss 14.166, Loss_clf 4.565, Loss_fe 4.589, Loss_kd 4.455, Train_accy 4.67:  80%|████████  | 16/20 [11:22<02:46, 41.54s/it]                Task 4, Epoch 17/20 => Loss 14.166, Loss_clf 4.565, Loss_fe 4.589, Loss_kd 4.455, Train_accy 4.67:  85%|████████▌ | 17/20 [11:22<02:00, 40.28s/it]Task 4, Epoch 18/20 => Loss 14.152, Loss_clf 4.559, Loss_fe 4.582, Loss_kd 4.454, Train_accy 4.43:  85%|████████▌ | 17/20 [11:59<02:00, 40.28s/it]Task 4, Epoch 18/20 => Loss 14.152, Loss_clf 4.559, Loss_fe 4.582, Loss_kd 4.454, Train_accy 4.43:  90%|█████████ | 18/20 [11:59<01:18, 39.39s/it]Task 4, Epoch 19/20 => Loss 14.127, Loss_clf 4.550, Loss_fe 4.564, Loss_kd 4.455, Train_accy 4.26:  90%|█████████ | 18/20 [12:37<01:18, 39.39s/it]Task 4, Epoch 19/20 => Loss 14.127, Loss_clf 4.550, Loss_fe 4.564, Loss_kd 4.455, Train_accy 4.26:  95%|█████████▌| 19/20 [12:37<00:38, 38.79s/it]Task 4, Epoch 20/20 => Loss 14.117, Loss_clf 4.541, Loss_fe 4.563, Loss_kd 4.456, Train_accy 4.98:  95%|█████████▌| 19/20 [13:14<00:38, 38.79s/it]Task 4, Epoch 20/20 => Loss 14.117, Loss_clf 4.541, Loss_fe 4.563, Loss_kd 4.456, Train_accy 4.98: 100%|██████████| 20/20 [13:14<00:00, 38.41s/it]Task 4, Epoch 20/20 => Loss 14.117, Loss_clf 4.541, Loss_fe 4.563, Loss_kd 4.456, Train_accy 4.98: 100%|██████████| 20/20 [13:14<00:00, 39.73s/it]
2024-04-29 16:42:22,779 [foster.py] => Task 4, Epoch 20/20 => Loss 14.117, Loss_clf 4.541, Loss_fe 4.563, Loss_kd 4.456, Train_accy 4.98
2024-04-29 16:42:22,780 [foster.py] => do not weight align teacher!
2024-04-29 16:42:22,783 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 4, Epoch 1/20 => Loss 5.091,  Train_accy 1.71, Test_accy 2.54:   0%|          | 0/20 [00:53<?, ?it/s]SNet: Task 4, Epoch 1/20 => Loss 5.091,  Train_accy 1.71, Test_accy 2.54:   5%|▌         | 1/20 [00:53<16:55, 53.45s/it]SNet: Task 4, Epoch 2/20 => Loss 5.079,  Train_accy 2.28:   5%|▌         | 1/20 [01:40<16:55, 53.45s/it]                SNet: Task 4, Epoch 2/20 => Loss 5.079,  Train_accy 2.28:  10%|█         | 2/20 [01:40<14:55, 49.77s/it]SNet: Task 4, Epoch 3/20 => Loss 5.075,  Train_accy 1.80:  10%|█         | 2/20 [02:27<14:55, 49.77s/it]SNet: Task 4, Epoch 3/20 => Loss 5.075,  Train_accy 1.80:  15%|█▌        | 3/20 [02:27<13:45, 48.57s/it]SNet: Task 4, Epoch 4/20 => Loss 5.078,  Train_accy 1.85:  15%|█▌        | 3/20 [03:14<13:45, 48.57s/it]SNet: Task 4, Epoch 4/20 => Loss 5.078,  Train_accy 1.85:  20%|██        | 4/20 [03:14<12:48, 48.02s/it]SNet: Task 4, Epoch 5/20 => Loss 5.075,  Train_accy 2.07:  20%|██        | 4/20 [04:02<12:48, 48.02s/it]SNet: Task 4, Epoch 5/20 => Loss 5.075,  Train_accy 2.07:  25%|██▌       | 5/20 [04:02<11:55, 47.72s/it]SNet: Task 4, Epoch 6/20 => Loss 5.072,  Train_accy 1.76, Test_accy 2.54:  25%|██▌       | 5/20 [04:55<11:55, 47.72s/it]SNet: Task 4, Epoch 6/20 => Loss 5.072,  Train_accy 1.76, Test_accy 2.54:  30%|███       | 6/20 [04:55<11:35, 49.71s/it]SNet: Task 4, Epoch 7/20 => Loss 5.073,  Train_accy 2.09:  30%|███       | 6/20 [05:42<11:35, 49.71s/it]                SNet: Task 4, Epoch 7/20 => Loss 5.073,  Train_accy 2.09:  35%|███▌      | 7/20 [05:42<10:34, 48.84s/it]SNet: Task 4, Epoch 8/20 => Loss 5.072,  Train_accy 2.09:  35%|███▌      | 7/20 [06:29<10:34, 48.84s/it]SNet: Task 4, Epoch 8/20 => Loss 5.072,  Train_accy 2.09:  40%|████      | 8/20 [06:29<09:39, 48.31s/it]SNet: Task 4, Epoch 9/20 => Loss 5.073,  Train_accy 2.41:  40%|████      | 8/20 [07:17<09:39, 48.31s/it]SNet: Task 4, Epoch 9/20 => Loss 5.073,  Train_accy 2.41:  45%|████▌     | 9/20 [07:17<08:47, 47.93s/it]SNet: Task 4, Epoch 10/20 => Loss 5.072,  Train_accy 2.14:  45%|████▌     | 9/20 [08:04<08:47, 47.93s/it]SNet: Task 4, Epoch 10/20 => Loss 5.072,  Train_accy 2.14:  50%|█████     | 10/20 [08:04<07:56, 47.66s/it]SNet: Task 4, Epoch 11/20 => Loss 5.071,  Train_accy 2.38, Test_accy 2.82:  50%|█████     | 10/20 [08:57<07:56, 47.66s/it]SNet: Task 4, Epoch 11/20 => Loss 5.071,  Train_accy 2.38, Test_accy 2.82:  55%|█████▌    | 11/20 [08:57<07:25, 49.45s/it]SNet: Task 4, Epoch 12/20 => Loss 5.069,  Train_accy 2.21:  55%|█████▌    | 11/20 [09:44<07:25, 49.45s/it]                SNet: Task 4, Epoch 12/20 => Loss 5.069,  Train_accy 2.21:  60%|██████    | 12/20 [09:44<06:29, 48.73s/it]SNet: Task 4, Epoch 13/20 => Loss 5.070,  Train_accy 2.14:  60%|██████    | 12/20 [10:31<06:29, 48.73s/it]SNet: Task 4, Epoch 13/20 => Loss 5.070,  Train_accy 2.14:  65%|██████▌   | 13/20 [10:31<05:37, 48.24s/it]SNet: Task 4, Epoch 14/20 => Loss 5.071,  Train_accy 2.50:  65%|██████▌   | 13/20 [11:18<05:37, 48.24s/it]SNet: Task 4, Epoch 14/20 => Loss 5.071,  Train_accy 2.50:  70%|███████   | 14/20 [11:18<04:47, 47.89s/it]SNet: Task 4, Epoch 15/20 => Loss 5.069,  Train_accy 2.26:  70%|███████   | 14/20 [12:05<04:47, 47.89s/it]SNet: Task 4, Epoch 15/20 => Loss 5.069,  Train_accy 2.26:  75%|███████▌  | 15/20 [12:05<03:58, 47.63s/it]SNet: Task 4, Epoch 16/20 => Loss 5.070,  Train_accy 2.19, Test_accy 2.96:  75%|███████▌  | 15/20 [12:59<03:58, 47.63s/it]SNet: Task 4, Epoch 16/20 => Loss 5.070,  Train_accy 2.19, Test_accy 2.96:  80%|████████  | 16/20 [12:59<03:17, 49.44s/it]SNet: Task 4, Epoch 17/20 => Loss 5.069,  Train_accy 2.31:  80%|████████  | 16/20 [13:46<03:17, 49.44s/it]                SNet: Task 4, Epoch 17/20 => Loss 5.069,  Train_accy 2.31:  85%|████████▌ | 17/20 [13:46<02:26, 48.73s/it]SNet: Task 4, Epoch 18/20 => Loss 5.069,  Train_accy 2.57:  85%|████████▌ | 17/20 [14:33<02:26, 48.73s/it]SNet: Task 4, Epoch 18/20 => Loss 5.069,  Train_accy 2.57:  90%|█████████ | 18/20 [14:33<01:36, 48.27s/it]SNet: Task 4, Epoch 19/20 => Loss 5.070,  Train_accy 2.02:  90%|█████████ | 18/20 [15:20<01:36, 48.27s/it]SNet: Task 4, Epoch 19/20 => Loss 5.070,  Train_accy 2.02:  95%|█████████▌| 19/20 [15:20<00:47, 47.92s/it]SNet: Task 4, Epoch 20/20 => Loss 5.070,  Train_accy 2.19:  95%|█████████▌| 19/20 [16:08<00:47, 47.92s/it]SNet: Task 4, Epoch 20/20 => Loss 5.070,  Train_accy 2.19: 100%|██████████| 20/20 [16:08<00:00, 47.69s/it]SNet: Task 4, Epoch 20/20 => Loss 5.070,  Train_accy 2.19: 100%|██████████| 20/20 [16:08<00:00, 48.40s/it]
2024-04-29 16:58:38,200 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 5.070,  Train_accy 2.19
2024-04-29 16:58:38,201 [foster.py] => do not weight align student!
2024-04-29 16:58:44,663 [foster.py] => darknet eval: 
2024-04-29 16:58:44,664 [foster.py] => CNN top1 curve: 2.91
2024-04-29 16:58:44,664 [foster.py] => CNN top5 curve: 9.87
2024-04-29 16:58:44,666 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 17:01:01,151 [foster.py] => Exemplar size: 3600
2024-04-29 17:01:01,152 [trainer.py] => CNN: {'total': 4.04, '00-99': 5.13, '100-119': 2.63, '120-139': 1.78, '140-159': 2.0, '160-179': 4.22, 'old': 4.02, 'new': 4.22}
2024-04-29 17:01:01,152 [trainer.py] => NME: {'total': 4.32, '00-99': 4.8, '100-119': 5.26, '120-139': 2.67, '140-159': 2.4, '160-179': 4.64, 'old': 4.28, 'new': 4.64}
2024-04-29 17:01:01,152 [trainer.py] => CNN top1 curve: [1.35, 4.31, 4.51, 4.34, 4.04]
2024-04-29 17:01:01,152 [trainer.py] => CNN top5 curve: [8.84, 14.19, 15.11, 16.39, 14.99]
2024-04-29 17:01:01,152 [trainer.py] => NME top1 curve: [1.77, 4.31, 4.27, 4.02, 4.32]
2024-04-29 17:01:01,152 [trainer.py] => NME top5 curve: [11.53, 14.48, 15.3, 15.23, 15.23]

Average Accuracy (CNN): 3.71
Average Accuracy (NME): 3.74
2024-04-29 17:01:01,152 [trainer.py] => Average Accuracy (CNN): 3.71
2024-04-29 17:01:01,152 [trainer.py] => Average Accuracy (NME): 3.74
2024-04-29 17:01:01,152 [trainer.py] => Train Time: 6677.07
2024-04-29 17:01:01,152 [trainer.py] => Test Time: 83.89 

2024-04-29 17:01:01,154 [trainer.py] => All params: 172135432
2024-04-29 17:01:01,155 [trainer.py] => Trainable params: 86213736
2024-04-29 17:01:07,801 [foster.py] => Learning on 180-200
2024-04-29 17:01:07,802 [foster.py] => All params: 172196932
2024-04-29 17:01:07,803 [foster.py] => Trainable params: 86259856
2024-04-29 17:01:07,860 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175]
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 15.517, Loss_clf 5.099, Loss_fe 5.334, Loss_kd 4.576, Train_accy 1.82, Test_accy 1.65:   0%|          | 0/20 [00:53<?, ?it/s]Task 5, Epoch 1/20 => Loss 15.517, Loss_clf 5.099, Loss_fe 5.334, Loss_kd 4.576, Train_accy 1.82, Test_accy 1.65:   5%|▌         | 1/20 [00:53<16:57, 53.56s/it]Task 5, Epoch 2/20 => Loss 15.333, Loss_clf 4.990, Loss_fe 5.258, Loss_kd 4.576, Train_accy 1.67:   5%|▌         | 1/20 [01:34<16:57, 53.56s/it]                Task 5, Epoch 2/20 => Loss 15.333, Loss_clf 4.990, Loss_fe 5.258, Loss_kd 4.576, Train_accy 1.67:  10%|█         | 2/20 [01:34<13:50, 46.14s/it]Task 5, Epoch 3/20 => Loss 15.244, Loss_clf 4.975, Loss_fe 5.183, Loss_kd 4.578, Train_accy 1.96:  10%|█         | 2/20 [02:15<13:50, 46.14s/it]Task 5, Epoch 3/20 => Loss 15.244, Loss_clf 4.975, Loss_fe 5.183, Loss_kd 4.578, Train_accy 1.96:  15%|█▌        | 3/20 [02:15<12:23, 43.73s/it]Task 5, Epoch 4/20 => Loss 15.168, Loss_clf 4.958, Loss_fe 5.123, Loss_kd 4.578, Train_accy 1.87:  15%|█▌        | 3/20 [02:56<12:23, 43.73s/it]Task 5, Epoch 4/20 => Loss 15.168, Loss_clf 4.958, Loss_fe 5.123, Loss_kd 4.578, Train_accy 1.87:  20%|██        | 4/20 [02:56<11:21, 42.61s/it]Task 5, Epoch 5/20 => Loss 15.105, Loss_clf 4.951, Loss_fe 5.066, Loss_kd 4.579, Train_accy 1.71:  20%|██        | 4/20 [03:37<11:21, 42.61s/it]Task 5, Epoch 5/20 => Loss 15.105, Loss_clf 4.951, Loss_fe 5.066, Loss_kd 4.579, Train_accy 1.71:  25%|██▌       | 5/20 [03:37<10:29, 41.96s/it]Task 5, Epoch 6/20 => Loss 15.013, Loss_clf 4.923, Loss_fe 5.002, Loss_kd 4.580, Train_accy 1.96, Test_accy 2.37:  25%|██▌       | 5/20 [04:30<10:29, 41.96s/it]Task 5, Epoch 6/20 => Loss 15.013, Loss_clf 4.923, Loss_fe 5.002, Loss_kd 4.580, Train_accy 1.96, Test_accy 2.37:  30%|███       | 6/20 [04:30<10:41, 45.81s/it]Task 5, Epoch 7/20 => Loss 14.961, Loss_clf 4.899, Loss_fe 4.971, Loss_kd 4.582, Train_accy 2.31:  30%|███       | 6/20 [05:11<10:41, 45.81s/it]                Task 5, Epoch 7/20 => Loss 14.961, Loss_clf 4.899, Loss_fe 4.971, Loss_kd 4.582, Train_accy 2.31:  35%|███▌      | 7/20 [05:11<09:34, 44.17s/it]Task 5, Epoch 8/20 => Loss 14.887, Loss_clf 4.878, Loss_fe 4.918, Loss_kd 4.581, Train_accy 1.98:  35%|███▌      | 7/20 [05:52<09:34, 44.17s/it]Task 5, Epoch 8/20 => Loss 14.887, Loss_clf 4.878, Loss_fe 4.918, Loss_kd 4.581, Train_accy 1.98:  40%|████      | 8/20 [05:52<08:37, 43.14s/it]Task 5, Epoch 9/20 => Loss 14.848, Loss_clf 4.860, Loss_fe 4.895, Loss_kd 4.584, Train_accy 2.50:  40%|████      | 8/20 [06:32<08:37, 43.14s/it]Task 5, Epoch 9/20 => Loss 14.848, Loss_clf 4.860, Loss_fe 4.895, Loss_kd 4.584, Train_accy 2.50:  45%|████▌     | 9/20 [06:32<07:46, 42.43s/it]Task 5, Epoch 10/20 => Loss 14.774, Loss_clf 4.824, Loss_fe 4.859, Loss_kd 4.582, Train_accy 2.44:  45%|████▌     | 9/20 [07:13<07:46, 42.43s/it]Task 5, Epoch 10/20 => Loss 14.774, Loss_clf 4.824, Loss_fe 4.859, Loss_kd 4.582, Train_accy 2.44:  50%|█████     | 10/20 [07:13<06:59, 41.94s/it]Task 5, Epoch 11/20 => Loss 14.701, Loss_clf 4.793, Loss_fe 4.814, Loss_kd 4.585, Train_accy 2.94, Test_accy 3.01:  50%|█████     | 10/20 [08:07<06:59, 41.94s/it]Task 5, Epoch 11/20 => Loss 14.701, Loss_clf 4.793, Loss_fe 4.814, Loss_kd 4.585, Train_accy 2.94, Test_accy 3.01:  55%|█████▌    | 11/20 [08:07<06:49, 45.47s/it]Task 5, Epoch 12/20 => Loss 14.664, Loss_clf 4.772, Loss_fe 4.794, Loss_kd 4.589, Train_accy 2.81:  55%|█████▌    | 11/20 [08:48<06:49, 45.47s/it]                Task 5, Epoch 12/20 => Loss 14.664, Loss_clf 4.772, Loss_fe 4.794, Loss_kd 4.589, Train_accy 2.81:  60%|██████    | 12/20 [08:48<05:52, 44.08s/it]Task 5, Epoch 13/20 => Loss 14.631, Loss_clf 4.759, Loss_fe 4.775, Loss_kd 4.588, Train_accy 3.01:  60%|██████    | 12/20 [09:28<05:52, 44.08s/it]Task 5, Epoch 13/20 => Loss 14.631, Loss_clf 4.759, Loss_fe 4.775, Loss_kd 4.588, Train_accy 3.01:  65%|██████▌   | 13/20 [09:28<05:01, 43.09s/it]Task 5, Epoch 14/20 => Loss 14.554, Loss_clf 4.732, Loss_fe 4.724, Loss_kd 4.589, Train_accy 3.51:  65%|██████▌   | 13/20 [10:09<05:01, 43.09s/it]Task 5, Epoch 14/20 => Loss 14.554, Loss_clf 4.732, Loss_fe 4.724, Loss_kd 4.589, Train_accy 3.51:  70%|███████   | 14/20 [10:09<04:14, 42.41s/it]Task 5, Epoch 15/20 => Loss 14.466, Loss_clf 4.685, Loss_fe 4.677, Loss_kd 4.593, Train_accy 3.78:  70%|███████   | 14/20 [10:50<04:14, 42.41s/it]Task 5, Epoch 15/20 => Loss 14.466, Loss_clf 4.685, Loss_fe 4.677, Loss_kd 4.593, Train_accy 3.78:  75%|███████▌  | 15/20 [10:50<03:29, 41.93s/it]Task 5, Epoch 16/20 => Loss 14.448, Loss_clf 4.678, Loss_fe 4.666, Loss_kd 4.593, Train_accy 3.62, Test_accy 3.18:  75%|███████▌  | 15/20 [11:43<03:29, 41.93s/it]Task 5, Epoch 16/20 => Loss 14.448, Loss_clf 4.678, Loss_fe 4.666, Loss_kd 4.593, Train_accy 3.62, Test_accy 3.18:  80%|████████  | 16/20 [11:43<03:01, 45.33s/it]Task 5, Epoch 17/20 => Loss 14.378, Loss_clf 4.641, Loss_fe 4.632, Loss_kd 4.594, Train_accy 3.84:  80%|████████  | 16/20 [12:24<03:01, 45.33s/it]                Task 5, Epoch 17/20 => Loss 14.378, Loss_clf 4.641, Loss_fe 4.632, Loss_kd 4.594, Train_accy 3.84:  85%|████████▌ | 17/20 [12:24<02:12, 44.01s/it]Task 5, Epoch 18/20 => Loss 14.320, Loss_clf 4.616, Loss_fe 4.598, Loss_kd 4.596, Train_accy 4.24:  85%|████████▌ | 17/20 [13:05<02:12, 44.01s/it]Task 5, Epoch 18/20 => Loss 14.320, Loss_clf 4.616, Loss_fe 4.598, Loss_kd 4.596, Train_accy 4.24:  90%|█████████ | 18/20 [13:05<01:26, 43.06s/it]Task 5, Epoch 19/20 => Loss 14.234, Loss_clf 4.574, Loss_fe 4.552, Loss_kd 4.597, Train_accy 4.72:  90%|█████████ | 18/20 [13:46<01:26, 43.06s/it]Task 5, Epoch 19/20 => Loss 14.234, Loss_clf 4.574, Loss_fe 4.552, Loss_kd 4.597, Train_accy 4.72:  95%|█████████▌| 19/20 [13:46<00:42, 42.44s/it]Task 5, Epoch 20/20 => Loss 14.276, Loss_clf 4.592, Loss_fe 4.575, Loss_kd 4.598, Train_accy 4.39:  95%|█████████▌| 19/20 [14:27<00:42, 42.44s/it]Task 5, Epoch 20/20 => Loss 14.276, Loss_clf 4.592, Loss_fe 4.575, Loss_kd 4.598, Train_accy 4.39: 100%|██████████| 20/20 [14:27<00:00, 42.01s/it]Task 5, Epoch 20/20 => Loss 14.276, Loss_clf 4.592, Loss_fe 4.575, Loss_kd 4.598, Train_accy 4.39: 100%|██████████| 20/20 [14:27<00:00, 43.38s/it]
2024-04-29 17:15:35,542 [foster.py] => Task 5, Epoch 20/20 => Loss 14.276, Loss_clf 4.592, Loss_fe 4.575, Loss_kd 4.598, Train_accy 4.39
2024-04-29 17:15:35,543 [foster.py] => do not weight align teacher!
2024-04-29 17:15:35,546 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405 ]
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 5, Epoch 1/20 => Loss 5.165,  Train_accy 2.20, Test_accy 2.84:   0%|          | 0/20 [00:58<?, ?it/s]SNet: Task 5, Epoch 1/20 => Loss 5.165,  Train_accy 2.20, Test_accy 2.84:   5%|▌         | 1/20 [00:58<18:28, 58.36s/it]SNet: Task 5, Epoch 2/20 => Loss 5.151,  Train_accy 2.33:   5%|▌         | 1/20 [01:49<18:28, 58.36s/it]                SNet: Task 5, Epoch 2/20 => Loss 5.151,  Train_accy 2.33:  10%|█         | 2/20 [01:49<16:18, 54.35s/it]SNet: Task 5, Epoch 3/20 => Loss 5.147,  Train_accy 2.22:  10%|█         | 2/20 [02:41<16:18, 54.35s/it]SNet: Task 5, Epoch 3/20 => Loss 5.147,  Train_accy 2.22:  15%|█▌        | 3/20 [02:41<15:01, 53.04s/it]SNet: Task 5, Epoch 4/20 => Loss 5.146,  Train_accy 2.61:  15%|█▌        | 3/20 [03:32<15:01, 53.04s/it]SNet: Task 5, Epoch 4/20 => Loss 5.146,  Train_accy 2.61:  20%|██        | 4/20 [03:32<13:58, 52.41s/it]SNet: Task 5, Epoch 5/20 => Loss 5.143,  Train_accy 2.39:  20%|██        | 4/20 [04:24<13:58, 52.41s/it]SNet: Task 5, Epoch 5/20 => Loss 5.143,  Train_accy 2.39:  25%|██▌       | 5/20 [04:24<13:02, 52.13s/it]SNet: Task 5, Epoch 6/20 => Loss 5.143,  Train_accy 2.50, Test_accy 2.59:  25%|██▌       | 5/20 [05:22<13:02, 52.13s/it]SNet: Task 5, Epoch 6/20 => Loss 5.143,  Train_accy 2.50, Test_accy 2.59:  30%|███       | 6/20 [05:22<12:39, 54.24s/it]SNet: Task 5, Epoch 7/20 => Loss 5.141,  Train_accy 2.35:  30%|███       | 6/20 [06:14<12:39, 54.24s/it]                SNet: Task 5, Epoch 7/20 => Loss 5.141,  Train_accy 2.35:  35%|███▌      | 7/20 [06:14<11:33, 53.35s/it]SNet: Task 5, Epoch 8/20 => Loss 5.140,  Train_accy 2.31:  35%|███▌      | 7/20 [07:05<11:33, 53.35s/it]SNet: Task 5, Epoch 8/20 => Loss 5.140,  Train_accy 2.31:  40%|████      | 8/20 [07:05<10:33, 52.77s/it]SNet: Task 5, Epoch 9/20 => Loss 5.142,  Train_accy 2.70:  40%|████      | 8/20 [07:57<10:33, 52.77s/it]SNet: Task 5, Epoch 9/20 => Loss 5.142,  Train_accy 2.70:  45%|████▌     | 9/20 [07:57<09:36, 52.40s/it]SNet: Task 5, Epoch 10/20 => Loss 5.139,  Train_accy 2.35:  45%|████▌     | 9/20 [08:49<09:36, 52.40s/it]SNet: Task 5, Epoch 10/20 => Loss 5.139,  Train_accy 2.35:  50%|█████     | 10/20 [08:49<08:41, 52.15s/it]SNet: Task 5, Epoch 11/20 => Loss 5.141,  Train_accy 2.55, Test_accy 2.93:  50%|█████     | 10/20 [09:47<08:41, 52.15s/it]SNet: Task 5, Epoch 11/20 => Loss 5.141,  Train_accy 2.55, Test_accy 2.93:  55%|█████▌    | 11/20 [09:47<08:06, 54.00s/it]SNet: Task 5, Epoch 12/20 => Loss 5.142,  Train_accy 2.24:  55%|█████▌    | 11/20 [10:38<08:06, 54.00s/it]                SNet: Task 5, Epoch 12/20 => Loss 5.142,  Train_accy 2.24:  60%|██████    | 12/20 [10:38<07:05, 53.21s/it]SNet: Task 5, Epoch 13/20 => Loss 5.140,  Train_accy 2.42:  60%|██████    | 12/20 [11:29<07:05, 53.21s/it]SNet: Task 5, Epoch 13/20 => Loss 5.140,  Train_accy 2.42:  65%|██████▌   | 13/20 [11:29<06:08, 52.65s/it]SNet: Task 5, Epoch 14/20 => Loss 5.139,  Train_accy 2.77:  65%|██████▌   | 13/20 [12:21<06:08, 52.65s/it]SNet: Task 5, Epoch 14/20 => Loss 5.139,  Train_accy 2.77:  70%|███████   | 14/20 [12:21<05:13, 52.30s/it]SNet: Task 5, Epoch 15/20 => Loss 5.139,  Train_accy 2.39:  70%|███████   | 14/20 [13:13<05:13, 52.30s/it]SNet: Task 5, Epoch 15/20 => Loss 5.139,  Train_accy 2.39:  75%|███████▌  | 15/20 [13:13<04:20, 52.09s/it]SNet: Task 5, Epoch 16/20 => Loss 5.139,  Train_accy 2.35, Test_accy 2.84:  75%|███████▌  | 15/20 [14:11<04:20, 52.09s/it]SNet: Task 5, Epoch 16/20 => Loss 5.139,  Train_accy 2.35, Test_accy 2.84:  80%|████████  | 16/20 [14:11<03:35, 53.98s/it]SNet: Task 5, Epoch 17/20 => Loss 5.138,  Train_accy 2.59:  80%|████████  | 16/20 [15:03<03:35, 53.98s/it]                SNet: Task 5, Epoch 17/20 => Loss 5.138,  Train_accy 2.59:  85%|████████▌ | 17/20 [15:03<02:39, 53.26s/it]SNet: Task 5, Epoch 18/20 => Loss 5.139,  Train_accy 2.64:  85%|████████▌ | 17/20 [15:54<02:39, 53.26s/it]SNet: Task 5, Epoch 18/20 => Loss 5.139,  Train_accy 2.64:  90%|█████████ | 18/20 [15:54<01:45, 52.70s/it]SNet: Task 5, Epoch 19/20 => Loss 5.139,  Train_accy 2.59:  90%|█████████ | 18/20 [16:45<01:45, 52.70s/it]SNet: Task 5, Epoch 19/20 => Loss 5.139,  Train_accy 2.59:  95%|█████████▌| 19/20 [16:45<00:52, 52.30s/it]SNet: Task 5, Epoch 20/20 => Loss 5.141,  Train_accy 2.72:  95%|█████████▌| 19/20 [17:37<00:52, 52.30s/it]SNet: Task 5, Epoch 20/20 => Loss 5.141,  Train_accy 2.72: 100%|██████████| 20/20 [17:37<00:00, 52.04s/it]SNet: Task 5, Epoch 20/20 => Loss 5.141,  Train_accy 2.72: 100%|██████████| 20/20 [17:37<00:00, 52.86s/it]
2024-04-29 17:33:19,901 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 5.141,  Train_accy 2.72
2024-04-29 17:33:19,901 [foster.py] => do not weight align student!
2024-04-29 17:33:26,765 [foster.py] => darknet eval: 
2024-04-29 17:33:26,766 [foster.py] => CNN top1 curve: 2.93
2024-04-29 17:33:26,766 [foster.py] => CNN top5 curve: 11.11
2024-04-29 17:33:26,769 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-29 17:35:49,337 [foster.py] => Exemplar size: 4000
2024-04-29 17:35:49,337 [trainer.py] => CNN: {'total': 3.56, '00-99': 4.63, '100-119': 4.39, '120-139': 3.11, '140-159': 2.8, '160-179': 1.27, '180-199': 0.87, 'old': 3.85, 'new': 0.87}
2024-04-29 17:35:49,337 [trainer.py] => NME: {'total': 3.94, '00-99': 3.37, '100-119': 4.82, '120-139': 4.0, '140-159': 1.6, '160-179': 2.53, '180-199': 10.0, 'old': 3.29, 'new': 10.0}
2024-04-29 17:35:49,337 [trainer.py] => CNN top1 curve: [1.35, 4.31, 4.51, 4.34, 4.04, 3.56]
2024-04-29 17:35:49,337 [trainer.py] => CNN top5 curve: [8.84, 14.19, 15.11, 16.39, 14.99, 14.12]
2024-04-29 17:35:49,337 [trainer.py] => NME top1 curve: [1.77, 4.31, 4.27, 4.02, 4.32, 3.94]
2024-04-29 17:35:49,337 [trainer.py] => NME top5 curve: [11.53, 14.48, 15.3, 15.23, 15.23, 13.83]

Average Accuracy (CNN): 3.68
Average Accuracy (NME): 3.77
2024-04-29 17:35:49,337 [trainer.py] => Average Accuracy (CNN): 3.68
2024-04-29 17:35:49,337 [trainer.py] => Average Accuracy (NME): 3.77
2024-04-29 17:35:49,337 [trainer.py] => Train Time: 8616.029999999999
2024-04-29 17:35:49,337 [trainer.py] => Test Time: 109.11 

Accuracy Matrix (CNN):
[[ 1.35  2.86  5.3   5.39  5.13  4.63]
 [ 0.   11.84  1.75  3.95  2.63  4.39]
 [ 0.    0.    3.11  0.44  1.78  3.11]
 [ 0.    0.    0.    3.2   2.    2.8 ]
 [ 0.    0.    0.    0.    4.22  1.27]
 [ 0.    0.    0.    0.    0.    0.87]]
2024-04-29 17:35:49,338 [trainer.py] => Forgetting (CNN): 2.3120000000000003
Accuracy Matrix (NME):
[[ 1.77  3.87  4.46  4.21  4.8   3.37]
 [ 0.    6.58  4.82  4.82  5.26  4.82]
 [ 0.    0.    2.67  4.    2.67  4.  ]
 [ 0.    0.    0.    2.4   2.4   1.6 ]
 [ 0.    0.    0.    0.    4.64  2.53]
 [ 0.    0.    0.    0.    0.   10.  ]]
2024-04-29 17:35:49,338 [trainer.py] => Forgetting (NME): 1.22
2024-04-29 17:35:53,638 [trainer.py] => config: ./exps/l2p_cub_B100_Inc5.json
2024-04-29 17:35:53,638 [trainer.py] => prefix:  
2024-04-29 17:35:53,638 [trainer.py] => dataset: cub
2024-04-29 17:35:53,638 [trainer.py] => memory_size: 0
2024-04-29 17:35:53,638 [trainer.py] => memory_per_class: 0
2024-04-29 17:35:53,638 [trainer.py] => fixed_memory: False
2024-04-29 17:35:53,638 [trainer.py] => shuffle: True
2024-04-29 17:35:53,638 [trainer.py] => init_cls: 100
2024-04-29 17:35:53,638 [trainer.py] => increment: 20
2024-04-29 17:35:53,638 [trainer.py] => model_name: l2p
2024-04-29 17:35:53,638 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-04-29 17:35:53,638 [trainer.py] => get_original_backbone: True
2024-04-29 17:35:53,638 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-29 17:35:53,638 [trainer.py] => seed: 1993
2024-04-29 17:35:53,638 [trainer.py] => tuned_epoch: 20
2024-04-29 17:35:53,638 [trainer.py] => init_lr: 0.001875
2024-04-29 17:35:53,638 [trainer.py] => batch_size: 48
2024-04-29 17:35:53,638 [trainer.py] => weight_decay: 0
2024-04-29 17:35:53,639 [trainer.py] => min_lr: 1e-05
2024-04-29 17:35:53,639 [trainer.py] => optimizer: adam
2024-04-29 17:35:53,639 [trainer.py] => scheduler: constant
2024-04-29 17:35:53,639 [trainer.py] => reinit_optimizer: True
2024-04-29 17:35:53,639 [trainer.py] => global_pool: token
2024-04-29 17:35:53,639 [trainer.py] => head_type: prompt
2024-04-29 17:35:53,639 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-29 17:35:53,639 [trainer.py] => pretrained: True
2024-04-29 17:35:53,639 [trainer.py] => drop: 0.0
2024-04-29 17:35:53,639 [trainer.py] => drop_path: 0.0
2024-04-29 17:35:53,639 [trainer.py] => prompt_pool: True
2024-04-29 17:35:53,639 [trainer.py] => size: 10
2024-04-29 17:35:53,639 [trainer.py] => length: 5
2024-04-29 17:35:53,639 [trainer.py] => top_k: 5
2024-04-29 17:35:53,639 [trainer.py] => initializer: uniform
2024-04-29 17:35:53,639 [trainer.py] => prompt_key: True
2024-04-29 17:35:53,639 [trainer.py] => prompt_key_init: uniform
2024-04-29 17:35:53,639 [trainer.py] => use_prompt_mask: False
2024-04-29 17:35:53,639 [trainer.py] => shared_prompt_pool: False
2024-04-29 17:35:53,639 [trainer.py] => shared_prompt_key: False
2024-04-29 17:35:53,639 [trainer.py] => batchwise_prompt: True
2024-04-29 17:35:53,639 [trainer.py] => embedding_key: cls
2024-04-29 17:35:53,639 [trainer.py] => predefined_key: 
2024-04-29 17:35:53,639 [trainer.py] => pull_constraint: True
2024-04-29 17:35:53,639 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-29 17:35:53,695 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-29 17:35:59,057 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-04-29 17:35:59,057 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-04-29 17:36:06,925 [l2p.py] => 86,017,736 model total parameters.
2024-04-29 17:36:06,926 [l2p.py] => 199,880 model training parameters.
2024-04-29 17:36:06,926 [l2p.py] => prompt.prompt: 38400
2024-04-29 17:36:06,926 [l2p.py] => prompt.prompt_key: 7680
2024-04-29 17:36:06,927 [l2p.py] => head.weight: 153600
2024-04-29 17:36:06,927 [l2p.py] => head.bias: 200
2024-04-29 17:36:06,928 [trainer.py] => All params: 171970192
2024-04-29 17:36:06,929 [trainer.py] => Trainable params: 199880
2024-04-29 17:36:06,929 [l2p.py] => Learning on 0-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.865, Train_accy 56.77:   0%|          | 0/20 [00:39<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.865, Train_accy 56.77:   5%|▌         | 1/20 [00:39<12:33, 39.64s/it]Task 0, Epoch 2/20 => Loss 0.771, Train_accy 77.78:   5%|▌         | 1/20 [01:18<12:33, 39.64s/it]Task 0, Epoch 2/20 => Loss 0.771, Train_accy 77.78:  10%|█         | 2/20 [01:18<11:46, 39.25s/it]Task 0, Epoch 3/20 => Loss 0.532, Train_accy 83.19:  10%|█         | 2/20 [01:57<11:46, 39.25s/it]Task 0, Epoch 3/20 => Loss 0.532, Train_accy 83.19:  15%|█▌        | 3/20 [01:57<11:04, 39.08s/it]Task 0, Epoch 4/20 => Loss 0.460, Train_accy 84.38:  15%|█▌        | 3/20 [02:36<11:04, 39.08s/it]Task 0, Epoch 4/20 => Loss 0.460, Train_accy 84.38:  20%|██        | 4/20 [02:36<10:23, 38.99s/it]Task 0, Epoch 5/20 => Loss 0.348, Train_accy 85.47, Test_accy 89.73:  20%|██        | 4/20 [03:22<10:23, 38.99s/it]Task 0, Epoch 5/20 => Loss 0.348, Train_accy 85.47, Test_accy 89.73:  25%|██▌       | 5/20 [03:22<10:21, 41.46s/it]Task 0, Epoch 6/20 => Loss 0.278, Train_accy 87.11:  25%|██▌       | 5/20 [04:01<10:21, 41.46s/it]                 Task 0, Epoch 6/20 => Loss 0.278, Train_accy 87.11:  30%|███       | 6/20 [04:01<09:28, 40.62s/it]Task 0, Epoch 7/20 => Loss 0.281, Train_accy 86.94:  30%|███       | 6/20 [04:39<09:28, 40.62s/it]Task 0, Epoch 7/20 => Loss 0.281, Train_accy 86.94:  35%|███▌      | 7/20 [04:39<08:40, 40.03s/it]Task 0, Epoch 8/20 => Loss 0.187, Train_accy 88.54:  35%|███▌      | 7/20 [05:18<08:40, 40.03s/it]Task 0, Epoch 8/20 => Loss 0.187, Train_accy 88.54:  40%|████      | 8/20 [05:18<07:55, 39.62s/it]Task 0, Epoch 9/20 => Loss 0.189, Train_accy 88.71:  40%|████      | 8/20 [05:57<07:55, 39.62s/it]Task 0, Epoch 9/20 => Loss 0.189, Train_accy 88.71:  45%|████▌     | 9/20 [05:57<07:13, 39.40s/it]Task 0, Epoch 10/20 => Loss 0.157, Train_accy 89.73, Test_accy 92.09:  45%|████▌     | 9/20 [06:43<07:13, 39.40s/it]Task 0, Epoch 10/20 => Loss 0.157, Train_accy 89.73, Test_accy 92.09:  50%|█████     | 10/20 [06:43<06:53, 41.36s/it]Task 0, Epoch 11/20 => Loss 0.155, Train_accy 89.63:  50%|█████     | 10/20 [07:22<06:53, 41.36s/it]                 Task 0, Epoch 11/20 => Loss 0.155, Train_accy 89.63:  55%|█████▌    | 11/20 [07:22<06:06, 40.69s/it]Task 0, Epoch 12/20 => Loss 0.144, Train_accy 89.48:  55%|█████▌    | 11/20 [08:01<06:06, 40.69s/it]Task 0, Epoch 12/20 => Loss 0.144, Train_accy 89.48:  60%|██████    | 12/20 [08:01<05:21, 40.19s/it]Task 0, Epoch 13/20 => Loss 0.130, Train_accy 90.14:  60%|██████    | 12/20 [08:40<05:21, 40.19s/it]Task 0, Epoch 13/20 => Loss 0.130, Train_accy 90.14:  65%|██████▌   | 13/20 [08:40<04:38, 39.78s/it]Task 0, Epoch 14/20 => Loss 0.142, Train_accy 89.71:  65%|██████▌   | 13/20 [09:19<04:38, 39.78s/it]Task 0, Epoch 14/20 => Loss 0.142, Train_accy 89.71:  70%|███████   | 14/20 [09:19<03:56, 39.44s/it]Task 0, Epoch 15/20 => Loss 0.119, Train_accy 90.35, Test_accy 91.25:  70%|███████   | 14/20 [10:04<03:56, 39.44s/it]Task 0, Epoch 15/20 => Loss 0.119, Train_accy 90.35, Test_accy 91.25:  75%|███████▌  | 15/20 [10:04<03:26, 41.33s/it]Task 0, Epoch 16/20 => Loss 0.115, Train_accy 91.20:  75%|███████▌  | 15/20 [10:43<03:26, 41.33s/it]                 Task 0, Epoch 16/20 => Loss 0.115, Train_accy 91.20:  80%|████████  | 16/20 [10:43<02:42, 40.59s/it]Task 0, Epoch 17/20 => Loss 0.086, Train_accy 91.29:  80%|████████  | 16/20 [11:22<02:42, 40.59s/it]Task 0, Epoch 17/20 => Loss 0.086, Train_accy 91.29:  85%|████████▌ | 17/20 [11:22<02:00, 40.04s/it]Task 0, Epoch 18/20 => Loss 0.074, Train_accy 91.50:  85%|████████▌ | 17/20 [12:01<02:00, 40.04s/it]Task 0, Epoch 18/20 => Loss 0.074, Train_accy 91.50:  90%|█████████ | 18/20 [12:01<01:19, 39.71s/it]Task 0, Epoch 19/20 => Loss 0.088, Train_accy 91.24:  90%|█████████ | 18/20 [12:40<01:19, 39.71s/it]Task 0, Epoch 19/20 => Loss 0.088, Train_accy 91.24:  95%|█████████▌| 19/20 [12:40<00:39, 39.46s/it]Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50:  95%|█████████▌| 19/20 [13:26<00:39, 39.46s/it]Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50: 100%|██████████| 20/20 [13:26<00:00, 41.38s/it]Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50: 100%|██████████| 20/20 [13:26<00:00, 40.31s/it]
2024-04-29 17:49:33,714 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.088, Train_accy 91.20, Test_accy 91.50
2024-04-29 17:49:40,814 [trainer.py] => No NME accuracy.
2024-04-29 17:49:40,815 [trainer.py] => CNN: {'total': 91.5, '00-99': 91.5, 'old': 0, 'new': 91.5}
2024-04-29 17:49:40,815 [trainer.py] => CNN top1 curve: [91.5]
2024-04-29 17:49:40,815 [trainer.py] => CNN top5 curve: [99.07]

Average Accuracy (CNN): 91.5
2024-04-29 17:49:40,815 [trainer.py] => Average Accuracy (CNN): 91.5 

2024-04-29 17:49:40,815 [trainer.py] => Train Time: 1612.92
2024-04-29 17:49:40,815 [trainer.py] => Test Time: 7.1 

2024-04-29 17:49:40,818 [trainer.py] => All params: 171970192
2024-04-29 17:49:40,820 [trainer.py] => Trainable params: 199880
2024-04-29 17:49:40,821 [l2p.py] => Learning on 100-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.647, Train_accy 77.94:   0%|          | 0/20 [00:08<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.647, Train_accy 77.94:   5%|▌         | 1/20 [00:08<02:39,  8.39s/it]Task 1, Epoch 2/20 => Loss -0.045, Train_accy 93.38:   5%|▌         | 1/20 [00:16<02:39,  8.39s/it]Task 1, Epoch 2/20 => Loss -0.045, Train_accy 93.38:  10%|█         | 2/20 [00:16<02:31,  8.41s/it]Task 1, Epoch 3/20 => Loss -0.096, Train_accy 95.69:  10%|█         | 2/20 [00:25<02:31,  8.41s/it]Task 1, Epoch 3/20 => Loss -0.096, Train_accy 95.69:  15%|█▌        | 3/20 [00:25<02:22,  8.41s/it]Task 1, Epoch 4/20 => Loss -0.112, Train_accy 95.48:  15%|█▌        | 3/20 [00:33<02:22,  8.41s/it]Task 1, Epoch 4/20 => Loss -0.112, Train_accy 95.48:  20%|██        | 4/20 [00:33<02:14,  8.43s/it]Task 1, Epoch 5/20 => Loss -0.113, Train_accy 95.90, Test_accy 82.27:  20%|██        | 4/20 [00:50<02:14,  8.43s/it]Task 1, Epoch 5/20 => Loss -0.113, Train_accy 95.90, Test_accy 82.27:  25%|██▌       | 5/20 [00:50<02:50, 11.39s/it]Task 1, Epoch 6/20 => Loss -0.111, Train_accy 96.11:  25%|██▌       | 5/20 [00:58<02:50, 11.39s/it]                 Task 1, Epoch 6/20 => Loss -0.111, Train_accy 96.11:  30%|███       | 6/20 [00:58<02:25, 10.37s/it]Task 1, Epoch 7/20 => Loss -0.160, Train_accy 96.85:  30%|███       | 6/20 [01:07<02:25, 10.37s/it]Task 1, Epoch 7/20 => Loss -0.160, Train_accy 96.85:  35%|███▌      | 7/20 [01:07<02:07,  9.78s/it]Task 1, Epoch 8/20 => Loss -0.085, Train_accy 95.17:  35%|███▌      | 7/20 [01:15<02:07,  9.78s/it]Task 1, Epoch 8/20 => Loss -0.085, Train_accy 95.17:  40%|████      | 8/20 [01:15<01:52,  9.37s/it]Task 1, Epoch 9/20 => Loss -0.104, Train_accy 95.17:  40%|████      | 8/20 [01:24<01:52,  9.37s/it]Task 1, Epoch 9/20 => Loss -0.104, Train_accy 95.17:  45%|████▌     | 9/20 [01:24<01:39,  9.08s/it]Task 1, Epoch 10/20 => Loss -0.085, Train_accy 94.96, Test_accy 82.91:  45%|████▌     | 9/20 [01:40<01:39,  9.08s/it]Task 1, Epoch 10/20 => Loss -0.085, Train_accy 94.96, Test_accy 82.91:  50%|█████     | 10/20 [01:40<01:53, 11.38s/it]Task 1, Epoch 11/20 => Loss -0.161, Train_accy 97.27:  50%|█████     | 10/20 [01:49<01:53, 11.38s/it]                 Task 1, Epoch 11/20 => Loss -0.161, Train_accy 97.27:  55%|█████▌    | 11/20 [01:49<01:34, 10.45s/it]Task 1, Epoch 12/20 => Loss -0.168, Train_accy 96.95:  55%|█████▌    | 11/20 [01:57<01:34, 10.45s/it]Task 1, Epoch 12/20 => Loss -0.168, Train_accy 96.95:  60%|██████    | 12/20 [01:57<01:18,  9.82s/it]Task 1, Epoch 13/20 => Loss -0.151, Train_accy 97.27:  60%|██████    | 12/20 [02:05<01:18,  9.82s/it]Task 1, Epoch 13/20 => Loss -0.151, Train_accy 97.27:  65%|██████▌   | 13/20 [02:05<01:05,  9.41s/it]Task 1, Epoch 14/20 => Loss -0.131, Train_accy 95.80:  65%|██████▌   | 13/20 [02:14<01:05,  9.41s/it]Task 1, Epoch 14/20 => Loss -0.131, Train_accy 95.80:  70%|███████   | 14/20 [02:14<00:54,  9.11s/it]Task 1, Epoch 15/20 => Loss -0.168, Train_accy 96.95, Test_accy 84.25:  70%|███████   | 14/20 [02:30<00:54,  9.11s/it]Task 1, Epoch 15/20 => Loss -0.168, Train_accy 96.95, Test_accy 84.25:  75%|███████▌  | 15/20 [02:30<00:56, 11.34s/it]Task 1, Epoch 16/20 => Loss -0.152, Train_accy 97.06:  75%|███████▌  | 15/20 [02:39<00:56, 11.34s/it]                 Task 1, Epoch 16/20 => Loss -0.152, Train_accy 97.06:  80%|████████  | 16/20 [02:39<00:41, 10.44s/it]Task 1, Epoch 17/20 => Loss -0.152, Train_accy 96.74:  80%|████████  | 16/20 [02:47<00:41, 10.44s/it]Task 1, Epoch 17/20 => Loss -0.152, Train_accy 96.74:  85%|████████▌ | 17/20 [02:47<00:29,  9.90s/it]Task 1, Epoch 18/20 => Loss -0.137, Train_accy 96.22:  85%|████████▌ | 17/20 [02:56<00:29,  9.90s/it]Task 1, Epoch 18/20 => Loss -0.137, Train_accy 96.22:  90%|█████████ | 18/20 [02:56<00:18,  9.43s/it]Task 1, Epoch 19/20 => Loss -0.129, Train_accy 96.32:  90%|█████████ | 18/20 [03:04<00:18,  9.43s/it]Task 1, Epoch 19/20 => Loss -0.129, Train_accy 96.32:  95%|█████████▌| 19/20 [03:04<00:09,  9.06s/it]Task 1, Epoch 20/20 => Loss -0.150, Train_accy 96.43, Test_accy 85.17:  95%|█████████▌| 19/20 [03:21<00:09,  9.06s/it]Task 1, Epoch 20/20 => Loss -0.150, Train_accy 96.43, Test_accy 85.17: 100%|██████████| 20/20 [03:21<00:00, 11.34s/it]Task 1, Epoch 20/20 => Loss -0.150, Train_accy 96.43, Test_accy 85.17: 100%|██████████| 20/20 [03:21<00:00, 10.05s/it]
2024-04-29 17:53:01,888 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.150, Train_accy 96.43, Test_accy 85.17
2024-04-29 17:53:10,031 [trainer.py] => No NME accuracy.
2024-04-29 17:53:10,032 [trainer.py] => CNN: {'total': 85.17, '00-99': 91.41, '100-119': 52.63, 'old': 91.41, 'new': 52.63}
2024-04-29 17:53:10,032 [trainer.py] => CNN top1 curve: [91.5, 85.17]
2024-04-29 17:53:10,032 [trainer.py] => CNN top5 curve: [99.07, 99.01]

Average Accuracy (CNN): 88.34
2024-04-29 17:53:10,032 [trainer.py] => Average Accuracy (CNN): 88.34 

2024-04-29 17:53:10,032 [trainer.py] => Train Time: 2015.03
2024-04-29 17:53:10,032 [trainer.py] => Test Time: 15.24 

2024-04-29 17:53:10,033 [trainer.py] => All params: 171970192
2024-04-29 17:53:10,034 [trainer.py] => Trainable params: 199880
2024-04-29 17:53:10,034 [l2p.py] => Learning on 120-140
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.824, Train_accy 65.72:   0%|          | 0/20 [00:08<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.824, Train_accy 65.72:   5%|▌         | 1/20 [00:08<02:39,  8.42s/it]Task 2, Epoch 2/20 => Loss 0.100, Train_accy 87.74:   5%|▌         | 1/20 [00:16<02:39,  8.42s/it]Task 2, Epoch 2/20 => Loss 0.100, Train_accy 87.74:  10%|█         | 2/20 [00:16<02:31,  8.43s/it]Task 2, Epoch 3/20 => Loss -0.003, Train_accy 91.51:  10%|█         | 2/20 [00:25<02:31,  8.43s/it]Task 2, Epoch 3/20 => Loss -0.003, Train_accy 91.51:  15%|█▌        | 3/20 [00:25<02:23,  8.44s/it]Task 2, Epoch 4/20 => Loss -0.025, Train_accy 90.99:  15%|█▌        | 3/20 [00:33<02:23,  8.44s/it]Task 2, Epoch 4/20 => Loss -0.025, Train_accy 90.99:  20%|██        | 4/20 [00:33<02:14,  8.41s/it]Task 2, Epoch 5/20 => Loss 0.014, Train_accy 90.04, Test_accy 78.98:  20%|██        | 4/20 [00:51<02:14,  8.41s/it]Task 2, Epoch 5/20 => Loss 0.014, Train_accy 90.04, Test_accy 78.98:  25%|██▌       | 5/20 [00:51<02:55, 11.72s/it]Task 2, Epoch 6/20 => Loss -0.004, Train_accy 90.57:  25%|██▌       | 5/20 [00:59<02:55, 11.72s/it]                Task 2, Epoch 6/20 => Loss -0.004, Train_accy 90.57:  30%|███       | 6/20 [00:59<02:28, 10.59s/it]Task 2, Epoch 7/20 => Loss -0.025, Train_accy 91.51:  30%|███       | 6/20 [01:08<02:28, 10.59s/it]Task 2, Epoch 7/20 => Loss -0.025, Train_accy 91.51:  35%|███▌      | 7/20 [01:08<02:08,  9.91s/it]Task 2, Epoch 8/20 => Loss -0.080, Train_accy 93.50:  35%|███▌      | 7/20 [01:16<02:08,  9.91s/it]Task 2, Epoch 8/20 => Loss -0.080, Train_accy 93.50:  40%|████      | 8/20 [01:16<01:53,  9.42s/it]Task 2, Epoch 9/20 => Loss -0.037, Train_accy 93.19:  40%|████      | 8/20 [01:24<01:53,  9.42s/it]Task 2, Epoch 9/20 => Loss -0.037, Train_accy 93.19:  45%|████▌     | 9/20 [01:24<01:39,  9.05s/it]Task 2, Epoch 10/20 => Loss -0.051, Train_accy 92.87, Test_accy 79.77:  45%|████▌     | 9/20 [01:42<01:39,  9.05s/it]Task 2, Epoch 10/20 => Loss -0.051, Train_accy 92.87, Test_accy 79.77:  50%|█████     | 10/20 [01:42<01:57, 11.76s/it]Task 2, Epoch 11/20 => Loss -0.060, Train_accy 92.98:  50%|█████     | 10/20 [01:51<01:57, 11.76s/it]                 Task 2, Epoch 11/20 => Loss -0.060, Train_accy 92.98:  55%|█████▌    | 11/20 [01:51<01:36, 10.76s/it]Task 2, Epoch 12/20 => Loss -0.035, Train_accy 92.14:  55%|█████▌    | 11/20 [01:59<01:36, 10.76s/it]Task 2, Epoch 12/20 => Loss -0.035, Train_accy 92.14:  60%|██████    | 12/20 [01:59<01:20, 10.03s/it]Task 2, Epoch 13/20 => Loss -0.025, Train_accy 91.61:  60%|██████    | 12/20 [02:07<01:20, 10.03s/it]Task 2, Epoch 13/20 => Loss -0.025, Train_accy 91.61:  65%|██████▌   | 13/20 [02:07<01:06,  9.56s/it]Task 2, Epoch 14/20 => Loss -0.078, Train_accy 93.71:  65%|██████▌   | 13/20 [02:16<01:06,  9.56s/it]Task 2, Epoch 14/20 => Loss -0.078, Train_accy 93.71:  70%|███████   | 14/20 [02:16<00:55,  9.19s/it]Task 2, Epoch 15/20 => Loss -0.094, Train_accy 94.44, Test_accy 80.26:  70%|███████   | 14/20 [02:33<00:55,  9.19s/it]Task 2, Epoch 15/20 => Loss -0.094, Train_accy 94.44, Test_accy 80.26:  75%|███████▌  | 15/20 [02:33<00:58, 11.73s/it]Task 2, Epoch 16/20 => Loss -0.126, Train_accy 95.07:  75%|███████▌  | 15/20 [02:42<00:58, 11.73s/it]                 Task 2, Epoch 16/20 => Loss -0.126, Train_accy 95.07:  80%|████████  | 16/20 [02:42<00:42, 10.67s/it]Task 2, Epoch 17/20 => Loss -0.094, Train_accy 94.76:  80%|████████  | 16/20 [02:50<00:42, 10.67s/it]Task 2, Epoch 17/20 => Loss -0.094, Train_accy 94.76:  85%|████████▌ | 17/20 [02:50<00:29,  9.97s/it]Task 2, Epoch 18/20 => Loss -0.108, Train_accy 94.76:  85%|████████▌ | 17/20 [02:58<00:29,  9.97s/it]Task 2, Epoch 18/20 => Loss -0.108, Train_accy 94.76:  90%|█████████ | 18/20 [02:58<00:19,  9.52s/it]Task 2, Epoch 19/20 => Loss -0.119, Train_accy 95.18:  90%|█████████ | 18/20 [03:07<00:19,  9.52s/it]Task 2, Epoch 19/20 => Loss -0.119, Train_accy 95.18:  95%|█████████▌| 19/20 [03:07<00:09,  9.16s/it]Task 2, Epoch 20/20 => Loss -0.082, Train_accy 94.34, Test_accy 81.29:  95%|█████████▌| 19/20 [03:25<00:09,  9.16s/it]Task 2, Epoch 20/20 => Loss -0.082, Train_accy 94.34, Test_accy 81.29: 100%|██████████| 20/20 [03:25<00:00, 11.79s/it]Task 2, Epoch 20/20 => Loss -0.082, Train_accy 94.34, Test_accy 81.29: 100%|██████████| 20/20 [03:25<00:00, 10.26s/it]
2024-04-29 17:56:35,230 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.082, Train_accy 94.34, Test_accy 81.29
2024-04-29 17:56:44,684 [trainer.py] => No NME accuracy.
2024-04-29 17:56:44,684 [trainer.py] => CNN: {'total': 81.29, '00-99': 91.25, '100-119': 54.82, '120-139': 55.56, 'old': 85.38, 'new': 55.56}
2024-04-29 17:56:44,684 [trainer.py] => CNN top1 curve: [91.5, 85.17, 81.29]
2024-04-29 17:56:44,684 [trainer.py] => CNN top5 curve: [99.07, 99.01, 98.66]

Average Accuracy (CNN): 85.99
2024-04-29 17:56:44,684 [trainer.py] => Average Accuracy (CNN): 85.99 

2024-04-29 17:56:44,685 [trainer.py] => Train Time: 2425.4
2024-04-29 17:56:44,685 [trainer.py] => Test Time: 24.689999999999998 

2024-04-29 17:56:44,686 [trainer.py] => All params: 171970192
2024-04-29 17:56:44,687 [trainer.py] => Trainable params: 199880
2024-04-29 17:56:44,687 [l2p.py] => Learning on 140-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.767, Train_accy 71.85:   0%|          | 0/20 [00:08<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.767, Train_accy 71.85:   5%|▌         | 1/20 [00:08<02:35,  8.16s/it]Task 3, Epoch 2/20 => Loss 0.019, Train_accy 92.17:   5%|▌         | 1/20 [00:16<02:35,  8.16s/it]Task 3, Epoch 2/20 => Loss 0.019, Train_accy 92.17:  10%|█         | 2/20 [00:16<02:27,  8.18s/it]Task 3, Epoch 3/20 => Loss -0.016, Train_accy 91.96:  10%|█         | 2/20 [00:24<02:27,  8.18s/it]Task 3, Epoch 3/20 => Loss -0.016, Train_accy 91.96:  15%|█▌        | 3/20 [00:24<02:18,  8.16s/it]Task 3, Epoch 4/20 => Loss -0.061, Train_accy 93.59:  15%|█▌        | 3/20 [00:32<02:18,  8.16s/it]Task 3, Epoch 4/20 => Loss -0.061, Train_accy 93.59:  20%|██        | 4/20 [00:32<02:10,  8.17s/it]Task 3, Epoch 5/20 => Loss -0.041, Train_accy 93.04, Test_accy 74.41:  20%|██        | 4/20 [00:51<02:10,  8.17s/it]Task 3, Epoch 5/20 => Loss -0.041, Train_accy 93.04, Test_accy 74.41:  25%|██▌       | 5/20 [00:51<03:00, 12.06s/it]Task 3, Epoch 6/20 => Loss -0.055, Train_accy 94.13:  25%|██▌       | 5/20 [00:59<03:00, 12.06s/it]                 Task 3, Epoch 6/20 => Loss -0.055, Train_accy 94.13:  30%|███       | 6/20 [00:59<02:30, 10.75s/it]Task 3, Epoch 7/20 => Loss -0.099, Train_accy 95.43:  30%|███       | 6/20 [01:08<02:30, 10.75s/it]Task 3, Epoch 7/20 => Loss -0.099, Train_accy 95.43:  35%|███▌      | 7/20 [01:08<02:09,  9.93s/it]Task 3, Epoch 8/20 => Loss -0.111, Train_accy 95.22:  35%|███▌      | 7/20 [01:16<02:09,  9.93s/it]Task 3, Epoch 8/20 => Loss -0.111, Train_accy 95.22:  40%|████      | 8/20 [01:16<01:52,  9.39s/it]Task 3, Epoch 9/20 => Loss -0.123, Train_accy 95.22:  40%|████      | 8/20 [01:24<01:52,  9.39s/it]Task 3, Epoch 9/20 => Loss -0.123, Train_accy 95.22:  45%|████▌     | 9/20 [01:24<01:38,  8.96s/it]Task 3, Epoch 10/20 => Loss -0.126, Train_accy 95.87, Test_accy 75.15:  45%|████▌     | 9/20 [01:43<01:38,  8.96s/it]Task 3, Epoch 10/20 => Loss -0.126, Train_accy 95.87, Test_accy 75.15:  50%|█████     | 10/20 [01:43<01:59, 12.00s/it]Task 3, Epoch 11/20 => Loss -0.109, Train_accy 96.41:  50%|█████     | 10/20 [01:51<01:59, 12.00s/it]                 Task 3, Epoch 11/20 => Loss -0.109, Train_accy 96.41:  55%|█████▌    | 11/20 [01:51<01:37, 10.81s/it]Task 3, Epoch 12/20 => Loss -0.126, Train_accy 95.76:  55%|█████▌    | 11/20 [01:59<01:37, 10.81s/it]Task 3, Epoch 12/20 => Loss -0.126, Train_accy 95.76:  60%|██████    | 12/20 [01:59<01:20, 10.01s/it]Task 3, Epoch 13/20 => Loss -0.139, Train_accy 96.41:  60%|██████    | 12/20 [02:07<01:20, 10.01s/it]Task 3, Epoch 13/20 => Loss -0.139, Train_accy 96.41:  65%|██████▌   | 13/20 [02:07<01:05,  9.40s/it]Task 3, Epoch 14/20 => Loss -0.138, Train_accy 95.87:  65%|██████▌   | 13/20 [02:15<01:05,  9.40s/it]Task 3, Epoch 14/20 => Loss -0.138, Train_accy 95.87:  70%|███████   | 14/20 [02:15<00:53,  8.99s/it]Task 3, Epoch 15/20 => Loss -0.119, Train_accy 95.54, Test_accy 76.15:  70%|███████   | 14/20 [02:34<00:53,  8.99s/it]Task 3, Epoch 15/20 => Loss -0.119, Train_accy 95.54, Test_accy 76.15:  75%|███████▌  | 15/20 [02:34<00:59, 11.96s/it]Task 3, Epoch 16/20 => Loss -0.116, Train_accy 95.11:  75%|███████▌  | 15/20 [02:42<00:59, 11.96s/it]                 Task 3, Epoch 16/20 => Loss -0.116, Train_accy 95.11:  80%|████████  | 16/20 [02:42<00:43, 10.78s/it]Task 3, Epoch 17/20 => Loss -0.110, Train_accy 95.54:  80%|████████  | 16/20 [02:50<00:43, 10.78s/it]Task 3, Epoch 17/20 => Loss -0.110, Train_accy 95.54:  85%|████████▌ | 17/20 [02:50<00:30, 10.00s/it]Task 3, Epoch 18/20 => Loss -0.083, Train_accy 95.33:  85%|████████▌ | 17/20 [02:58<00:30, 10.00s/it]Task 3, Epoch 18/20 => Loss -0.083, Train_accy 95.33:  90%|█████████ | 18/20 [02:58<00:18,  9.44s/it]Task 3, Epoch 19/20 => Loss -0.126, Train_accy 95.11:  90%|█████████ | 18/20 [03:06<00:18,  9.44s/it]Task 3, Epoch 19/20 => Loss -0.126, Train_accy 95.11:  95%|█████████▌| 19/20 [03:06<00:09,  9.05s/it]Task 3, Epoch 20/20 => Loss -0.138, Train_accy 96.41, Test_accy 76.36:  95%|█████████▌| 19/20 [03:25<00:09,  9.05s/it]Task 3, Epoch 20/20 => Loss -0.138, Train_accy 96.41, Test_accy 76.36: 100%|██████████| 20/20 [03:25<00:00, 11.95s/it]Task 3, Epoch 20/20 => Loss -0.138, Train_accy 96.41, Test_accy 76.36: 100%|██████████| 20/20 [03:25<00:00, 10.28s/it]
2024-04-29 18:00:10,228 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.138, Train_accy 96.41, Test_accy 76.36
2024-04-29 18:00:21,031 [trainer.py] => No NME accuracy.
2024-04-29 18:00:21,031 [trainer.py] => CNN: {'total': 76.36, '00-99': 90.99, '100-119': 55.26, '120-139': 55.11, '140-159': 45.2, 'old': 81.11, 'new': 45.2}
2024-04-29 18:00:21,031 [trainer.py] => CNN top1 curve: [91.5, 85.17, 81.29, 76.36]
2024-04-29 18:00:21,031 [trainer.py] => CNN top5 curve: [99.07, 99.01, 98.66, 98.63]

Average Accuracy (CNN): 83.58
2024-04-29 18:00:21,031 [trainer.py] => Average Accuracy (CNN): 83.58 

2024-04-29 18:00:21,031 [trainer.py] => Train Time: 2836.4700000000003
2024-04-29 18:00:21,032 [trainer.py] => Test Time: 35.489999999999995 

2024-04-29 18:00:21,033 [trainer.py] => All params: 171970192
2024-04-29 18:00:21,034 [trainer.py] => Trainable params: 199880
2024-04-29 18:00:21,034 [l2p.py] => Learning on 160-180
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.620, Train_accy 75.68:   0%|          | 0/20 [00:08<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.620, Train_accy 75.68:   5%|▌         | 1/20 [00:08<02:39,  8.41s/it]Task 4, Epoch 2/20 => Loss 0.008, Train_accy 92.07:   5%|▌         | 1/20 [00:16<02:39,  8.41s/it]Task 4, Epoch 2/20 => Loss 0.008, Train_accy 92.07:  10%|█         | 2/20 [00:16<02:30,  8.37s/it]Task 4, Epoch 3/20 => Loss -0.070, Train_accy 93.32:  10%|█         | 2/20 [00:25<02:30,  8.37s/it]Task 4, Epoch 3/20 => Loss -0.070, Train_accy 93.32:  15%|█▌        | 3/20 [00:25<02:23,  8.43s/it]Task 4, Epoch 4/20 => Loss -0.097, Train_accy 94.78:  15%|█▌        | 3/20 [00:33<02:23,  8.43s/it]Task 4, Epoch 4/20 => Loss -0.097, Train_accy 94.78:  20%|██        | 4/20 [00:33<02:14,  8.39s/it]Task 4, Epoch 5/20 => Loss -0.071, Train_accy 93.11, Test_accy 70.72:  20%|██        | 4/20 [00:53<02:14,  8.39s/it]Task 4, Epoch 5/20 => Loss -0.071, Train_accy 93.11, Test_accy 70.72:  25%|██▌       | 5/20 [00:53<03:10, 12.67s/it]Task 4, Epoch 6/20 => Loss -0.071, Train_accy 93.22:  25%|██▌       | 5/20 [01:02<03:10, 12.67s/it]                 Task 4, Epoch 6/20 => Loss -0.071, Train_accy 93.22:  30%|███       | 6/20 [01:02<02:36, 11.19s/it]Task 4, Epoch 7/20 => Loss -0.083, Train_accy 93.74:  30%|███       | 6/20 [01:10<02:36, 11.19s/it]Task 4, Epoch 7/20 => Loss -0.083, Train_accy 93.74:  35%|███▌      | 7/20 [01:10<02:14, 10.31s/it]Task 4, Epoch 8/20 => Loss -0.056, Train_accy 93.32:  35%|███▌      | 7/20 [01:19<02:14, 10.31s/it]Task 4, Epoch 8/20 => Loss -0.056, Train_accy 93.32:  40%|████      | 8/20 [01:19<01:56,  9.72s/it]Task 4, Epoch 9/20 => Loss -0.090, Train_accy 94.05:  40%|████      | 8/20 [01:27<01:56,  9.72s/it]Task 4, Epoch 9/20 => Loss -0.090, Train_accy 94.05:  45%|████▌     | 9/20 [01:27<01:42,  9.31s/it]Task 4, Epoch 10/20 => Loss -0.079, Train_accy 93.95, Test_accy 71.95:  45%|████▌     | 9/20 [01:47<01:42,  9.31s/it]Task 4, Epoch 10/20 => Loss -0.079, Train_accy 93.95, Test_accy 71.95:  50%|█████     | 10/20 [01:47<02:06, 12.68s/it]Task 4, Epoch 11/20 => Loss -0.097, Train_accy 94.57:  50%|█████     | 10/20 [01:56<02:06, 12.68s/it]                 Task 4, Epoch 11/20 => Loss -0.097, Train_accy 94.57:  55%|█████▌    | 11/20 [01:56<01:42, 11.37s/it]Task 4, Epoch 12/20 => Loss -0.088, Train_accy 94.26:  55%|█████▌    | 11/20 [02:04<01:42, 11.37s/it]Task 4, Epoch 12/20 => Loss -0.088, Train_accy 94.26:  60%|██████    | 12/20 [02:04<01:24, 10.51s/it]Task 4, Epoch 13/20 => Loss -0.137, Train_accy 95.93:  60%|██████    | 12/20 [02:13<01:24, 10.51s/it]Task 4, Epoch 13/20 => Loss -0.137, Train_accy 95.93:  65%|██████▌   | 13/20 [02:13<01:09,  9.88s/it]Task 4, Epoch 14/20 => Loss -0.142, Train_accy 96.24:  65%|██████▌   | 13/20 [02:21<01:09,  9.88s/it]Task 4, Epoch 14/20 => Loss -0.142, Train_accy 96.24:  70%|███████   | 14/20 [02:21<00:56,  9.49s/it]Task 4, Epoch 15/20 => Loss -0.075, Train_accy 94.15, Test_accy 72.51:  70%|███████   | 14/20 [02:42<00:56,  9.49s/it]Task 4, Epoch 15/20 => Loss -0.075, Train_accy 94.15, Test_accy 72.51:  75%|███████▌  | 15/20 [02:42<01:03, 12.75s/it]Task 4, Epoch 16/20 => Loss -0.093, Train_accy 94.36:  75%|███████▌  | 15/20 [02:50<01:03, 12.75s/it]                 Task 4, Epoch 16/20 => Loss -0.093, Train_accy 94.36:  80%|████████  | 16/20 [02:50<00:45, 11.44s/it]Task 4, Epoch 17/20 => Loss -0.136, Train_accy 95.93:  80%|████████  | 16/20 [02:58<00:45, 11.44s/it]Task 4, Epoch 17/20 => Loss -0.136, Train_accy 95.93:  85%|████████▌ | 17/20 [02:58<00:31, 10.54s/it]Task 4, Epoch 18/20 => Loss -0.131, Train_accy 95.72:  85%|████████▌ | 17/20 [03:07<00:31, 10.54s/it]Task 4, Epoch 18/20 => Loss -0.131, Train_accy 95.72:  90%|█████████ | 18/20 [03:07<00:19,  9.90s/it]Task 4, Epoch 19/20 => Loss -0.135, Train_accy 95.93:  90%|█████████ | 18/20 [03:15<00:19,  9.90s/it]Task 4, Epoch 19/20 => Loss -0.135, Train_accy 95.93:  95%|█████████▌| 19/20 [03:15<00:09,  9.47s/it]Task 4, Epoch 20/20 => Loss -0.124, Train_accy 95.09, Test_accy 73.03:  95%|█████████▌| 19/20 [03:36<00:09,  9.47s/it]Task 4, Epoch 20/20 => Loss -0.124, Train_accy 95.09, Test_accy 73.03: 100%|██████████| 20/20 [03:36<00:00, 12.75s/it]Task 4, Epoch 20/20 => Loss -0.124, Train_accy 95.09, Test_accy 73.03: 100%|██████████| 20/20 [03:36<00:00, 10.81s/it]
2024-04-29 18:03:57,184 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.124, Train_accy 95.09, Test_accy 73.03
2024-04-29 18:04:09,199 [trainer.py] => No NME accuracy.
2024-04-29 18:04:09,199 [trainer.py] => CNN: {'total': 73.03, '00-99': 90.99, '100-119': 56.14, '120-139': 54.22, '140-159': 45.2, '160-179': 46.41, 'old': 76.36, 'new': 46.41}
2024-04-29 18:04:09,199 [trainer.py] => CNN top1 curve: [91.5, 85.17, 81.29, 76.36, 73.03]
2024-04-29 18:04:09,200 [trainer.py] => CNN top5 curve: [99.07, 99.01, 98.66, 98.63, 98.17]

Average Accuracy (CNN): 81.47
2024-04-29 18:04:09,200 [trainer.py] => Average Accuracy (CNN): 81.47 

2024-04-29 18:04:09,200 [trainer.py] => Train Time: 3268.76
2024-04-29 18:04:09,200 [trainer.py] => Test Time: 47.49999999999999 

2024-04-29 18:04:09,202 [trainer.py] => All params: 171970192
2024-04-29 18:04:09,203 [trainer.py] => Trainable params: 199880
2024-04-29 18:04:09,203 [l2p.py] => Learning on 180-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.676, Train_accy 75.00:   0%|          | 0/20 [00:08<?, ?it/s]Task 5, Epoch 1/20 => Loss 0.676, Train_accy 75.00:   5%|▌         | 1/20 [00:08<02:37,  8.27s/it]Task 5, Epoch 2/20 => Loss -0.009, Train_accy 92.12:   5%|▌         | 1/20 [00:16<02:37,  8.27s/it]Task 5, Epoch 2/20 => Loss -0.009, Train_accy 92.12:  10%|█         | 2/20 [00:16<02:29,  8.31s/it]Task 5, Epoch 3/20 => Loss -0.045, Train_accy 92.12:  10%|█         | 2/20 [00:24<02:29,  8.31s/it]Task 5, Epoch 3/20 => Loss -0.045, Train_accy 92.12:  15%|█▌        | 3/20 [00:24<02:21,  8.34s/it]Task 5, Epoch 4/20 => Loss -0.073, Train_accy 94.01:  15%|█▌        | 3/20 [00:33<02:21,  8.34s/it]Task 5, Epoch 4/20 => Loss -0.073, Train_accy 94.01:  20%|██        | 4/20 [00:33<02:14,  8.40s/it]Task 5, Epoch 5/20 => Loss -0.109, Train_accy 94.54, Test_accy 67.18:  20%|██        | 4/20 [00:54<02:14,  8.40s/it]Task 5, Epoch 5/20 => Loss -0.109, Train_accy 94.54, Test_accy 67.18:  25%|██▌       | 5/20 [00:54<03:16, 13.09s/it]Task 5, Epoch 6/20 => Loss -0.072, Train_accy 93.70:  25%|██▌       | 5/20 [01:03<03:16, 13.09s/it]                 Task 5, Epoch 6/20 => Loss -0.072, Train_accy 93.70:  30%|███       | 6/20 [01:03<02:40, 11.50s/it]Task 5, Epoch 7/20 => Loss -0.091, Train_accy 94.01:  30%|███       | 6/20 [01:11<02:40, 11.50s/it]Task 5, Epoch 7/20 => Loss -0.091, Train_accy 94.01:  35%|███▌      | 7/20 [01:11<02:16, 10.50s/it]Task 5, Epoch 8/20 => Loss -0.098, Train_accy 94.54:  35%|███▌      | 7/20 [01:20<02:16, 10.50s/it]Task 5, Epoch 8/20 => Loss -0.098, Train_accy 94.54:  40%|████      | 8/20 [01:20<01:57,  9.82s/it]Task 5, Epoch 9/20 => Loss -0.083, Train_accy 94.12:  40%|████      | 8/20 [01:28<01:57,  9.82s/it]Task 5, Epoch 9/20 => Loss -0.083, Train_accy 94.12:  45%|████▌     | 9/20 [01:28<01:43,  9.37s/it]Task 5, Epoch 10/20 => Loss -0.104, Train_accy 94.64, Test_accy 68.02:  45%|████▌     | 9/20 [01:50<01:43,  9.37s/it]Task 5, Epoch 10/20 => Loss -0.104, Train_accy 94.64, Test_accy 68.02:  50%|█████     | 10/20 [01:50<02:11, 13.14s/it]Task 5, Epoch 11/20 => Loss -0.088, Train_accy 94.12:  50%|█████     | 10/20 [01:58<02:11, 13.14s/it]                 Task 5, Epoch 11/20 => Loss -0.088, Train_accy 94.12:  55%|█████▌    | 11/20 [01:58<01:44, 11.65s/it]Task 5, Epoch 12/20 => Loss -0.091, Train_accy 94.01:  55%|█████▌    | 11/20 [02:06<01:44, 11.65s/it]Task 5, Epoch 12/20 => Loss -0.091, Train_accy 94.01:  60%|██████    | 12/20 [02:06<01:24, 10.62s/it]Task 5, Epoch 13/20 => Loss -0.123, Train_accy 95.38:  60%|██████    | 12/20 [02:15<01:24, 10.62s/it]Task 5, Epoch 13/20 => Loss -0.123, Train_accy 95.38:  65%|██████▌   | 13/20 [02:15<01:09,  9.97s/it]Task 5, Epoch 14/20 => Loss -0.125, Train_accy 95.17:  65%|██████▌   | 13/20 [02:23<01:09,  9.97s/it]Task 5, Epoch 14/20 => Loss -0.125, Train_accy 95.17:  70%|███████   | 14/20 [02:23<00:56,  9.50s/it]Task 5, Epoch 15/20 => Loss -0.109, Train_accy 94.54, Test_accy 68.32:  70%|███████   | 14/20 [02:45<00:56,  9.50s/it]Task 5, Epoch 15/20 => Loss -0.109, Train_accy 94.54, Test_accy 68.32:  75%|███████▌  | 15/20 [02:45<01:05, 13.20s/it]Task 5, Epoch 16/20 => Loss -0.118, Train_accy 95.80:  75%|███████▌  | 15/20 [02:53<01:05, 13.20s/it]                 Task 5, Epoch 16/20 => Loss -0.118, Train_accy 95.80:  80%|████████  | 16/20 [02:53<00:46, 11.73s/it]Task 5, Epoch 17/20 => Loss -0.099, Train_accy 94.33:  80%|████████  | 16/20 [03:01<00:46, 11.73s/it]Task 5, Epoch 17/20 => Loss -0.099, Train_accy 94.33:  85%|████████▌ | 17/20 [03:01<00:32, 10.73s/it]Task 5, Epoch 18/20 => Loss -0.150, Train_accy 96.11:  85%|████████▌ | 17/20 [03:10<00:32, 10.73s/it]Task 5, Epoch 18/20 => Loss -0.150, Train_accy 96.11:  90%|█████████ | 18/20 [03:10<00:19, 10.00s/it]Task 5, Epoch 19/20 => Loss -0.148, Train_accy 96.85:  90%|█████████ | 18/20 [03:18<00:19, 10.00s/it]Task 5, Epoch 19/20 => Loss -0.148, Train_accy 96.85:  95%|█████████▌| 19/20 [03:18<00:09,  9.51s/it]Task 5, Epoch 20/20 => Loss -0.148, Train_accy 96.43, Test_accy 69.17:  95%|█████████▌| 19/20 [03:40<00:09,  9.51s/it]Task 5, Epoch 20/20 => Loss -0.148, Train_accy 96.43, Test_accy 69.17: 100%|██████████| 20/20 [03:40<00:00, 13.18s/it]Task 5, Epoch 20/20 => Loss -0.148, Train_accy 96.43, Test_accy 69.17: 100%|██████████| 20/20 [03:40<00:00, 11.02s/it]
2024-04-29 18:07:49,581 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.148, Train_accy 96.43, Test_accy 69.17
2024-04-29 18:08:02,587 [trainer.py] => No NME accuracy.
2024-04-29 18:08:02,587 [trainer.py] => CNN: {'total': 69.17, '00-99': 90.82, '100-119': 55.7, '120-139': 54.22, '140-159': 44.4, '160-179': 45.99, '180-199': 36.09, 'old': 72.74, 'new': 36.09}
2024-04-29 18:08:02,587 [trainer.py] => CNN top1 curve: [91.5, 85.17, 81.29, 76.36, 73.03, 69.17]
2024-04-29 18:08:02,587 [trainer.py] => CNN top5 curve: [99.07, 99.01, 98.66, 98.63, 98.17, 97.12]

Average Accuracy (CNN): 79.42
2024-04-29 18:08:02,587 [trainer.py] => Average Accuracy (CNN): 79.42 

2024-04-29 18:08:02,587 [trainer.py] => Train Time: 3709.4900000000002
2024-04-29 18:08:02,587 [trainer.py] => Test Time: 60.49999999999999 

Accuracy Matrix (CNN):
[[91.5  91.41 91.25 90.99 90.99 90.82]
 [ 0.   52.63 54.82 55.26 56.14 55.7 ]
 [ 0.    0.   55.56 55.11 54.22 54.22]
 [ 0.    0.    0.   45.2  45.2  44.4 ]
 [ 0.    0.    0.    0.   46.41 45.99]
 [ 0.    0.    0.    0.    0.   36.09]]
2024-04-29 18:08:02,588 [trainer.py] => Forgetting (CNN): 0.7360000000000013
2024-04-29 18:08:05,583 [trainer.py] => config: ./exps/dualprompt_cub_B100_Inc5.json
2024-04-29 18:08:05,583 [trainer.py] => prefix:  
2024-04-29 18:08:05,583 [trainer.py] => dataset: cub
2024-04-29 18:08:05,583 [trainer.py] => memory_size: 0
2024-04-29 18:08:05,583 [trainer.py] => memory_per_class: 0
2024-04-29 18:08:05,584 [trainer.py] => fixed_memory: False
2024-04-29 18:08:05,584 [trainer.py] => shuffle: True
2024-04-29 18:08:05,584 [trainer.py] => init_cls: 100
2024-04-29 18:08:05,584 [trainer.py] => increment: 20
2024-04-29 18:08:05,584 [trainer.py] => model_name: dualprompt
2024-04-29 18:08:05,584 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-04-29 18:08:05,584 [trainer.py] => get_original_backbone: True
2024-04-29 18:08:05,584 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-29 18:08:05,584 [trainer.py] => seed: 1993
2024-04-29 18:08:05,584 [trainer.py] => tuned_epoch: 20
2024-04-29 18:08:05,584 [trainer.py] => init_lr: 0.001
2024-04-29 18:08:05,584 [trainer.py] => batch_size: 48
2024-04-29 18:08:05,584 [trainer.py] => weight_decay: 0
2024-04-29 18:08:05,584 [trainer.py] => min_lr: 1e-05
2024-04-29 18:08:05,584 [trainer.py] => optimizer: adam
2024-04-29 18:08:05,584 [trainer.py] => scheduler: constant
2024-04-29 18:08:05,584 [trainer.py] => reinit_optimizer: True
2024-04-29 18:08:05,584 [trainer.py] => global_pool: token
2024-04-29 18:08:05,584 [trainer.py] => head_type: token
2024-04-29 18:08:05,584 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-29 18:08:05,584 [trainer.py] => pretrained: True
2024-04-29 18:08:05,584 [trainer.py] => drop: 0.0
2024-04-29 18:08:05,584 [trainer.py] => drop_path: 0.0
2024-04-29 18:08:05,584 [trainer.py] => use_g_prompt: True
2024-04-29 18:08:05,584 [trainer.py] => g_prompt_length: 5
2024-04-29 18:08:05,584 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-04-29 18:08:05,584 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-04-29 18:08:05,584 [trainer.py] => use_e_prompt: True
2024-04-29 18:08:05,584 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-04-29 18:08:05,584 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-04-29 18:08:05,584 [trainer.py] => prompt_pool: True
2024-04-29 18:08:05,584 [trainer.py] => size: 10
2024-04-29 18:08:05,584 [trainer.py] => length: 5
2024-04-29 18:08:05,585 [trainer.py] => top_k: 1
2024-04-29 18:08:05,585 [trainer.py] => initializer: uniform
2024-04-29 18:08:05,585 [trainer.py] => prompt_key: True
2024-04-29 18:08:05,585 [trainer.py] => prompt_key_init: uniform
2024-04-29 18:08:05,585 [trainer.py] => use_prompt_mask: True
2024-04-29 18:08:05,585 [trainer.py] => shared_prompt_pool: True
2024-04-29 18:08:05,585 [trainer.py] => shared_prompt_key: False
2024-04-29 18:08:05,585 [trainer.py] => batchwise_prompt: True
2024-04-29 18:08:05,585 [trainer.py] => embedding_key: cls
2024-04-29 18:08:05,585 [trainer.py] => predefined_key: 
2024-04-29 18:08:05,585 [trainer.py] => pull_constraint: True
2024-04-29 18:08:05,585 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-29 18:08:05,585 [trainer.py] => same_key_value: False
2024-04-29 18:08:05,622 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-29 18:08:19,225 [dualprompt.py] => 86,205,896 model total parameters.
2024-04-29 18:08:19,226 [dualprompt.py] => 407,240 model training parameters.
2024-04-29 18:08:19,226 [dualprompt.py] => g_prompt: 15360
2024-04-29 18:08:19,226 [dualprompt.py] => e_prompt.prompt: 230400
2024-04-29 18:08:19,226 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-04-29 18:08:19,227 [dualprompt.py] => head.weight: 153600
2024-04-29 18:08:19,227 [dualprompt.py] => head.bias: 200
2024-04-29 18:08:19,228 [trainer.py] => All params: 172158352
2024-04-29 18:08:19,230 [trainer.py] => Trainable params: 407240
2024-04-29 18:08:19,230 [dualprompt.py] => Learning on 0-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.524, Train_accy 65.13:   0%|          | 0/20 [00:35<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.524, Train_accy 65.13:   5%|▌         | 1/20 [00:35<11:20, 35.80s/it]Task 0, Epoch 2/20 => Loss 0.568, Train_accy 85.04:   5%|▌         | 1/20 [01:11<11:20, 35.80s/it]Task 0, Epoch 2/20 => Loss 0.568, Train_accy 85.04:  10%|█         | 2/20 [01:11<10:39, 35.54s/it]Task 0, Epoch 3/20 => Loss 0.441, Train_accy 88.35:  10%|█         | 2/20 [01:46<10:39, 35.54s/it]Task 0, Epoch 3/20 => Loss 0.441, Train_accy 88.35:  15%|█▌        | 3/20 [01:46<10:02, 35.44s/it]Task 0, Epoch 4/20 => Loss 0.411, Train_accy 88.94:  15%|█▌        | 3/20 [02:21<10:02, 35.44s/it]Task 0, Epoch 4/20 => Loss 0.411, Train_accy 88.94:  20%|██        | 4/20 [02:21<09:26, 35.42s/it]Task 0, Epoch 5/20 => Loss 0.354, Train_accy 90.03, Test_accy 90.15:  20%|██        | 4/20 [03:04<09:26, 35.42s/it]Task 0, Epoch 5/20 => Loss 0.354, Train_accy 90.03, Test_accy 90.15:  25%|██▌       | 5/20 [03:04<09:29, 37.96s/it]Task 0, Epoch 6/20 => Loss 0.339, Train_accy 90.65:  25%|██▌       | 5/20 [03:39<09:29, 37.96s/it]                 Task 0, Epoch 6/20 => Loss 0.339, Train_accy 90.65:  30%|███       | 6/20 [03:39<08:39, 37.12s/it]Task 0, Epoch 7/20 => Loss 0.330, Train_accy 90.73:  30%|███       | 6/20 [04:15<08:39, 37.12s/it]Task 0, Epoch 7/20 => Loss 0.330, Train_accy 90.73:  35%|███▌      | 7/20 [04:15<07:54, 36.52s/it]Task 0, Epoch 8/20 => Loss 0.304, Train_accy 91.46:  35%|███▌      | 7/20 [04:50<07:54, 36.52s/it]Task 0, Epoch 8/20 => Loss 0.304, Train_accy 91.46:  40%|████      | 8/20 [04:50<07:14, 36.19s/it]Task 0, Epoch 9/20 => Loss 0.297, Train_accy 91.39:  40%|████      | 8/20 [05:26<07:14, 36.19s/it]Task 0, Epoch 9/20 => Loss 0.297, Train_accy 91.39:  45%|████▌     | 9/20 [05:26<06:35, 35.98s/it]Task 0, Epoch 10/20 => Loss 0.273, Train_accy 92.05, Test_accy 90.91:  45%|████▌     | 9/20 [06:08<06:35, 35.98s/it]Task 0, Epoch 10/20 => Loss 0.273, Train_accy 92.05, Test_accy 90.91:  50%|█████     | 10/20 [06:08<06:18, 37.89s/it]Task 0, Epoch 11/20 => Loss 0.296, Train_accy 91.37:  50%|█████     | 10/20 [06:43<06:18, 37.89s/it]                 Task 0, Epoch 11/20 => Loss 0.296, Train_accy 91.37:  55%|█████▌    | 11/20 [06:43<05:33, 37.11s/it]Task 0, Epoch 12/20 => Loss 0.243, Train_accy 92.93:  55%|█████▌    | 11/20 [07:19<05:33, 37.11s/it]Task 0, Epoch 12/20 => Loss 0.243, Train_accy 92.93:  60%|██████    | 12/20 [07:19<04:52, 36.59s/it]Task 0, Epoch 13/20 => Loss 0.240, Train_accy 92.80:  60%|██████    | 12/20 [07:54<04:52, 36.59s/it]Task 0, Epoch 13/20 => Loss 0.240, Train_accy 92.80:  65%|██████▌   | 13/20 [07:54<04:13, 36.23s/it]Task 0, Epoch 14/20 => Loss 0.251, Train_accy 92.44:  65%|██████▌   | 13/20 [08:29<04:13, 36.23s/it]Task 0, Epoch 14/20 => Loss 0.251, Train_accy 92.44:  70%|███████   | 14/20 [08:29<03:35, 36.00s/it]Task 0, Epoch 15/20 => Loss 0.240, Train_accy 92.31, Test_accy 91.41:  70%|███████   | 14/20 [09:11<03:35, 36.00s/it]Task 0, Epoch 15/20 => Loss 0.240, Train_accy 92.31, Test_accy 91.41:  75%|███████▌  | 15/20 [09:11<03:09, 37.83s/it]Task 0, Epoch 16/20 => Loss 0.210, Train_accy 93.54:  75%|███████▌  | 15/20 [09:47<03:09, 37.83s/it]                 Task 0, Epoch 16/20 => Loss 0.210, Train_accy 93.54:  80%|████████  | 16/20 [09:47<02:28, 37.14s/it]Task 0, Epoch 17/20 => Loss 0.209, Train_accy 93.40:  80%|████████  | 16/20 [10:22<02:28, 37.14s/it]Task 0, Epoch 17/20 => Loss 0.209, Train_accy 93.40:  85%|████████▌ | 17/20 [10:22<01:49, 36.64s/it]Task 0, Epoch 18/20 => Loss 0.231, Train_accy 92.99:  85%|████████▌ | 17/20 [10:58<01:49, 36.64s/it]Task 0, Epoch 18/20 => Loss 0.231, Train_accy 92.99:  90%|█████████ | 18/20 [10:58<01:12, 36.25s/it]Task 0, Epoch 19/20 => Loss 0.220, Train_accy 93.10:  90%|█████████ | 18/20 [11:33<01:12, 36.25s/it]Task 0, Epoch 19/20 => Loss 0.220, Train_accy 93.10:  95%|█████████▌| 19/20 [11:33<00:35, 35.97s/it]Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.37, Test_accy 89.65:  95%|█████████▌| 19/20 [12:15<00:35, 35.97s/it]Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.37, Test_accy 89.65: 100%|██████████| 20/20 [12:15<00:00, 37.85s/it]Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.37, Test_accy 89.65: 100%|██████████| 20/20 [12:15<00:00, 36.79s/it]
2024-04-29 18:20:35,842 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.37, Test_accy 89.65
2024-04-29 18:20:42,372 [trainer.py] => No NME accuracy.
2024-04-29 18:20:42,372 [trainer.py] => CNN: {'total': 89.65, '00-99': 89.65, 'old': 0, 'new': 89.65}
2024-04-29 18:20:42,372 [trainer.py] => CNN top1 curve: [89.65]
2024-04-29 18:20:42,372 [trainer.py] => CNN top5 curve: [98.82]

Average Accuracy (CNN): 89.65
2024-04-29 18:20:42,372 [trainer.py] => Average Accuracy (CNN): 89.65 

2024-04-29 18:20:42,372 [trainer.py] => Train Time: 1472.46
2024-04-29 18:20:42,372 [trainer.py] => Test Time: 6.53 

2024-04-29 18:20:42,373 [trainer.py] => All params: 172158352
2024-04-29 18:20:42,374 [trainer.py] => Trainable params: 407240
2024-04-29 18:20:42,374 [dualprompt.py] => Learning on 100-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.183, Train_accy 69.54:   0%|          | 0/20 [00:07<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.183, Train_accy 69.54:   5%|▌         | 1/20 [00:07<02:26,  7.70s/it]Task 1, Epoch 2/20 => Loss 0.193, Train_accy 94.75:   5%|▌         | 1/20 [00:15<02:26,  7.70s/it]Task 1, Epoch 2/20 => Loss 0.193, Train_accy 94.75:  10%|█         | 2/20 [00:15<02:18,  7.72s/it]Task 1, Epoch 3/20 => Loss 0.178, Train_accy 95.38:  10%|█         | 2/20 [00:23<02:18,  7.72s/it]Task 1, Epoch 3/20 => Loss 0.178, Train_accy 95.38:  15%|█▌        | 3/20 [00:23<02:10,  7.67s/it]Task 1, Epoch 4/20 => Loss 0.122, Train_accy 95.80:  15%|█▌        | 3/20 [00:30<02:10,  7.67s/it]Task 1, Epoch 4/20 => Loss 0.122, Train_accy 95.80:  20%|██        | 4/20 [00:30<02:02,  7.66s/it]Task 1, Epoch 5/20 => Loss 0.119, Train_accy 97.06, Test_accy 81.71:  20%|██        | 4/20 [00:46<02:02,  7.66s/it]Task 1, Epoch 5/20 => Loss 0.119, Train_accy 97.06, Test_accy 81.71:  25%|██▌       | 5/20 [00:46<02:37, 10.50s/it]Task 1, Epoch 6/20 => Loss 0.160, Train_accy 95.06:  25%|██▌       | 5/20 [00:53<02:37, 10.50s/it]                 Task 1, Epoch 6/20 => Loss 0.160, Train_accy 95.06:  30%|███       | 6/20 [00:53<02:13,  9.55s/it]Task 1, Epoch 7/20 => Loss 0.129, Train_accy 95.69:  30%|███       | 6/20 [01:01<02:13,  9.55s/it]Task 1, Epoch 7/20 => Loss 0.129, Train_accy 95.69:  35%|███▌      | 7/20 [01:01<01:56,  8.96s/it]Task 1, Epoch 8/20 => Loss 0.106, Train_accy 96.53:  35%|███▌      | 7/20 [01:09<01:56,  8.96s/it]Task 1, Epoch 8/20 => Loss 0.106, Train_accy 96.53:  40%|████      | 8/20 [01:09<01:43,  8.59s/it]Task 1, Epoch 9/20 => Loss 0.095, Train_accy 97.06:  40%|████      | 8/20 [01:17<01:43,  8.59s/it]Task 1, Epoch 9/20 => Loss 0.095, Train_accy 97.06:  45%|████▌     | 9/20 [01:17<01:31,  8.32s/it]Task 1, Epoch 10/20 => Loss 0.125, Train_accy 95.69, Test_accy 81.99:  45%|████▌     | 9/20 [01:32<01:31,  8.32s/it]Task 1, Epoch 10/20 => Loss 0.125, Train_accy 95.69, Test_accy 81.99:  50%|█████     | 10/20 [01:32<01:45, 10.54s/it]Task 1, Epoch 11/20 => Loss 0.113, Train_accy 95.90:  50%|█████     | 10/20 [01:40<01:45, 10.54s/it]                 Task 1, Epoch 11/20 => Loss 0.113, Train_accy 95.90:  55%|█████▌    | 11/20 [01:40<01:26,  9.64s/it]Task 1, Epoch 12/20 => Loss 0.099, Train_accy 96.74:  55%|█████▌    | 11/20 [01:47<01:26,  9.64s/it]Task 1, Epoch 12/20 => Loss 0.099, Train_accy 96.74:  60%|██████    | 12/20 [01:47<01:12,  9.03s/it]Task 1, Epoch 13/20 => Loss 0.090, Train_accy 96.64:  60%|██████    | 12/20 [01:55<01:12,  9.03s/it]Task 1, Epoch 13/20 => Loss 0.090, Train_accy 96.64:  65%|██████▌   | 13/20 [01:55<01:00,  8.59s/it]Task 1, Epoch 14/20 => Loss 0.082, Train_accy 96.95:  65%|██████▌   | 13/20 [02:03<01:00,  8.59s/it]Task 1, Epoch 14/20 => Loss 0.082, Train_accy 96.95:  70%|███████   | 14/20 [02:03<00:49,  8.32s/it]Task 1, Epoch 15/20 => Loss 0.104, Train_accy 96.43, Test_accy 82.63:  70%|███████   | 14/20 [02:18<00:49,  8.32s/it]Task 1, Epoch 15/20 => Loss 0.104, Train_accy 96.43, Test_accy 82.63:  75%|███████▌  | 15/20 [02:18<00:52, 10.49s/it]Task 1, Epoch 16/20 => Loss 0.056, Train_accy 97.90:  75%|███████▌  | 15/20 [02:26<00:52, 10.49s/it]                 Task 1, Epoch 16/20 => Loss 0.056, Train_accy 97.90:  80%|████████  | 16/20 [02:26<00:38,  9.68s/it]Task 1, Epoch 17/20 => Loss 0.087, Train_accy 97.06:  80%|████████  | 16/20 [02:34<00:38,  9.68s/it]Task 1, Epoch 17/20 => Loss 0.087, Train_accy 97.06:  85%|████████▌ | 17/20 [02:34<00:27,  9.08s/it]Task 1, Epoch 18/20 => Loss 0.077, Train_accy 97.27:  85%|████████▌ | 17/20 [02:42<00:27,  9.08s/it]Task 1, Epoch 18/20 => Loss 0.077, Train_accy 97.27:  90%|█████████ | 18/20 [02:42<00:17,  8.70s/it]Task 1, Epoch 19/20 => Loss 0.081, Train_accy 97.16:  90%|█████████ | 18/20 [02:49<00:17,  8.70s/it]Task 1, Epoch 19/20 => Loss 0.081, Train_accy 97.16:  95%|█████████▌| 19/20 [02:49<00:08,  8.40s/it]Task 1, Epoch 20/20 => Loss 0.087, Train_accy 96.01, Test_accy 82.91:  95%|█████████▌| 19/20 [03:05<00:08,  8.40s/it]Task 1, Epoch 20/20 => Loss 0.087, Train_accy 96.01, Test_accy 82.91: 100%|██████████| 20/20 [03:05<00:00, 10.50s/it]Task 1, Epoch 20/20 => Loss 0.087, Train_accy 96.01, Test_accy 82.91: 100%|██████████| 20/20 [03:05<00:00,  9.26s/it]
2024-04-29 18:23:47,498 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.087, Train_accy 96.01, Test_accy 82.91
2024-04-29 18:23:55,278 [trainer.py] => No NME accuracy.
2024-04-29 18:23:55,278 [trainer.py] => CNN: {'total': 82.91, '00-99': 89.9, '100-119': 46.49, 'old': 89.9, 'new': 46.49}
2024-04-29 18:23:55,278 [trainer.py] => CNN top1 curve: [89.65, 82.91]
2024-04-29 18:23:55,278 [trainer.py] => CNN top5 curve: [98.82, 98.66]

Average Accuracy (CNN): 86.28
2024-04-29 18:23:55,278 [trainer.py] => Average Accuracy (CNN): 86.28 

2024-04-29 18:23:55,278 [trainer.py] => Train Time: 1842.6999999999998
2024-04-29 18:23:55,278 [trainer.py] => Test Time: 14.31 

2024-04-29 18:23:55,280 [trainer.py] => All params: 172158352
2024-04-29 18:23:55,281 [trainer.py] => Trainable params: 407240
2024-04-29 18:23:55,281 [dualprompt.py] => Learning on 120-140
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.460, Train_accy 56.29:   0%|          | 0/20 [00:07<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.460, Train_accy 56.29:   5%|▌         | 1/20 [00:07<02:24,  7.62s/it]Task 2, Epoch 2/20 => Loss 0.423, Train_accy 85.95:   5%|▌         | 1/20 [00:15<02:24,  7.62s/it]Task 2, Epoch 2/20 => Loss 0.423, Train_accy 85.95:  10%|█         | 2/20 [00:15<02:16,  7.61s/it]Task 2, Epoch 3/20 => Loss 0.312, Train_accy 89.73:  10%|█         | 2/20 [00:22<02:16,  7.61s/it]Task 2, Epoch 3/20 => Loss 0.312, Train_accy 89.73:  15%|█▌        | 3/20 [00:22<02:10,  7.67s/it]Task 2, Epoch 4/20 => Loss 0.237, Train_accy 92.24:  15%|█▌        | 3/20 [00:30<02:10,  7.67s/it]Task 2, Epoch 4/20 => Loss 0.237, Train_accy 92.24:  20%|██        | 4/20 [00:30<02:03,  7.71s/it]Task 2, Epoch 5/20 => Loss 0.248, Train_accy 92.56, Test_accy 75.87:  20%|██        | 4/20 [00:47<02:03,  7.71s/it]Task 2, Epoch 5/20 => Loss 0.248, Train_accy 92.56, Test_accy 75.87:  25%|██▌       | 5/20 [00:47<02:44, 10.96s/it]Task 2, Epoch 6/20 => Loss 0.220, Train_accy 93.29:  25%|██▌       | 5/20 [00:55<02:44, 10.96s/it]                 Task 2, Epoch 6/20 => Loss 0.220, Train_accy 93.29:  30%|███       | 6/20 [00:55<02:17,  9.84s/it]Task 2, Epoch 7/20 => Loss 0.199, Train_accy 93.71:  30%|███       | 6/20 [01:02<02:17,  9.84s/it]Task 2, Epoch 7/20 => Loss 0.199, Train_accy 93.71:  35%|███▌      | 7/20 [01:02<01:59,  9.18s/it]Task 2, Epoch 8/20 => Loss 0.178, Train_accy 93.19:  35%|███▌      | 7/20 [01:10<01:59,  9.18s/it]Task 2, Epoch 8/20 => Loss 0.178, Train_accy 93.19:  40%|████      | 8/20 [01:10<01:44,  8.73s/it]Task 2, Epoch 9/20 => Loss 0.178, Train_accy 93.61:  40%|████      | 8/20 [01:18<01:44,  8.73s/it]Task 2, Epoch 9/20 => Loss 0.178, Train_accy 93.61:  45%|████▌     | 9/20 [01:18<01:32,  8.38s/it]Task 2, Epoch 10/20 => Loss 0.197, Train_accy 93.61, Test_accy 76.84:  45%|████▌     | 9/20 [01:35<01:32,  8.38s/it]Task 2, Epoch 10/20 => Loss 0.197, Train_accy 93.61, Test_accy 76.84:  50%|█████     | 10/20 [01:35<01:50, 11.02s/it]Task 2, Epoch 11/20 => Loss 0.164, Train_accy 95.07:  50%|█████     | 10/20 [01:42<01:50, 11.02s/it]                 Task 2, Epoch 11/20 => Loss 0.164, Train_accy 95.07:  55%|█████▌    | 11/20 [01:42<01:30, 10.01s/it]Task 2, Epoch 12/20 => Loss 0.160, Train_accy 94.44:  55%|█████▌    | 11/20 [01:50<01:30, 10.01s/it]Task 2, Epoch 12/20 => Loss 0.160, Train_accy 94.44:  60%|██████    | 12/20 [01:50<01:14,  9.28s/it]Task 2, Epoch 13/20 => Loss 0.137, Train_accy 95.07:  60%|██████    | 12/20 [01:58<01:14,  9.28s/it]Task 2, Epoch 13/20 => Loss 0.137, Train_accy 95.07:  65%|██████▌   | 13/20 [01:58<01:01,  8.80s/it]Task 2, Epoch 14/20 => Loss 0.147, Train_accy 95.81:  65%|██████▌   | 13/20 [02:05<01:01,  8.80s/it]Task 2, Epoch 14/20 => Loss 0.147, Train_accy 95.81:  70%|███████   | 14/20 [02:05<00:50,  8.44s/it]Task 2, Epoch 15/20 => Loss 0.151, Train_accy 94.65, Test_accy 77.57:  70%|███████   | 14/20 [02:22<00:50,  8.44s/it]Task 2, Epoch 15/20 => Loss 0.151, Train_accy 94.65, Test_accy 77.57:  75%|███████▌  | 15/20 [02:22<00:54, 10.97s/it]Task 2, Epoch 16/20 => Loss 0.134, Train_accy 95.81:  75%|███████▌  | 15/20 [02:30<00:54, 10.97s/it]                 Task 2, Epoch 16/20 => Loss 0.134, Train_accy 95.81:  80%|████████  | 16/20 [02:30<00:39, 10.00s/it]Task 2, Epoch 17/20 => Loss 0.130, Train_accy 95.81:  80%|████████  | 16/20 [02:38<00:39, 10.00s/it]Task 2, Epoch 17/20 => Loss 0.130, Train_accy 95.81:  85%|████████▌ | 17/20 [02:38<00:27,  9.31s/it]Task 2, Epoch 18/20 => Loss 0.139, Train_accy 95.28:  85%|████████▌ | 17/20 [02:45<00:27,  9.31s/it]Task 2, Epoch 18/20 => Loss 0.139, Train_accy 95.28:  90%|█████████ | 18/20 [02:45<00:17,  8.81s/it]Task 2, Epoch 19/20 => Loss 0.146, Train_accy 94.86:  90%|█████████ | 18/20 [02:53<00:17,  8.81s/it]Task 2, Epoch 19/20 => Loss 0.146, Train_accy 94.86:  95%|█████████▌| 19/20 [02:53<00:08,  8.46s/it]Task 2, Epoch 20/20 => Loss 0.131, Train_accy 95.49, Test_accy 77.70:  95%|█████████▌| 19/20 [03:10<00:08,  8.46s/it]Task 2, Epoch 20/20 => Loss 0.131, Train_accy 95.49, Test_accy 77.70: 100%|██████████| 20/20 [03:10<00:00, 10.95s/it]Task 2, Epoch 20/20 => Loss 0.131, Train_accy 95.49, Test_accy 77.70: 100%|██████████| 20/20 [03:10<00:00,  9.51s/it]
2024-04-29 18:27:05,498 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.131, Train_accy 95.49, Test_accy 77.70
2024-04-29 18:27:14,452 [trainer.py] => No NME accuracy.
2024-04-29 18:27:14,452 [trainer.py] => CNN: {'total': 77.7, '00-99': 89.98, '100-119': 46.05, '120-139': 44.89, 'old': 82.91, 'new': 44.89}
2024-04-29 18:27:14,452 [trainer.py] => CNN top1 curve: [89.65, 82.91, 77.7]
2024-04-29 18:27:14,452 [trainer.py] => CNN top5 curve: [98.82, 98.66, 98.35]

Average Accuracy (CNN): 83.42
2024-04-29 18:27:14,453 [trainer.py] => Average Accuracy (CNN): 83.42 

2024-04-29 18:27:14,453 [trainer.py] => Train Time: 2223.12
2024-04-29 18:27:14,453 [trainer.py] => Test Time: 23.259999999999998 

2024-04-29 18:27:14,454 [trainer.py] => All params: 172158352
2024-04-29 18:27:14,455 [trainer.py] => Trainable params: 407240
2024-04-29 18:27:14,455 [dualprompt.py] => Learning on 140-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.381, Train_accy 61.74:   0%|          | 0/20 [00:07<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.381, Train_accy 61.74:   5%|▌         | 1/20 [00:07<02:21,  7.45s/it]Task 3, Epoch 2/20 => Loss 0.346, Train_accy 90.43:   5%|▌         | 1/20 [00:14<02:21,  7.45s/it]Task 3, Epoch 2/20 => Loss 0.346, Train_accy 90.43:  10%|█         | 2/20 [00:14<02:13,  7.41s/it]Task 3, Epoch 3/20 => Loss 0.270, Train_accy 91.09:  10%|█         | 2/20 [00:22<02:13,  7.41s/it]Task 3, Epoch 3/20 => Loss 0.270, Train_accy 91.09:  15%|█▌        | 3/20 [00:22<02:07,  7.48s/it]Task 3, Epoch 4/20 => Loss 0.195, Train_accy 94.24:  15%|█▌        | 3/20 [00:29<02:07,  7.48s/it]Task 3, Epoch 4/20 => Loss 0.195, Train_accy 94.24:  20%|██        | 4/20 [00:29<01:59,  7.44s/it]Task 3, Epoch 5/20 => Loss 0.211, Train_accy 93.48, Test_accy 70.91:  20%|██        | 4/20 [00:47<01:59,  7.44s/it]Task 3, Epoch 5/20 => Loss 0.211, Train_accy 93.48, Test_accy 70.91:  25%|██▌       | 5/20 [00:47<02:46, 11.08s/it]Task 3, Epoch 6/20 => Loss 0.168, Train_accy 95.33:  25%|██▌       | 5/20 [00:54<02:46, 11.08s/it]                 Task 3, Epoch 6/20 => Loss 0.168, Train_accy 95.33:  30%|███       | 6/20 [00:54<02:17,  9.85s/it]Task 3, Epoch 7/20 => Loss 0.163, Train_accy 94.67:  30%|███       | 6/20 [01:02<02:17,  9.85s/it]Task 3, Epoch 7/20 => Loss 0.163, Train_accy 94.67:  35%|███▌      | 7/20 [01:02<01:57,  9.06s/it]Task 3, Epoch 8/20 => Loss 0.159, Train_accy 94.67:  35%|███▌      | 7/20 [01:09<01:57,  9.06s/it]Task 3, Epoch 8/20 => Loss 0.159, Train_accy 94.67:  40%|████      | 8/20 [01:09<01:42,  8.53s/it]Task 3, Epoch 9/20 => Loss 0.124, Train_accy 96.09:  40%|████      | 8/20 [01:17<01:42,  8.53s/it]Task 3, Epoch 9/20 => Loss 0.124, Train_accy 96.09:  45%|████▌     | 9/20 [01:17<01:30,  8.23s/it]Task 3, Epoch 10/20 => Loss 0.142, Train_accy 95.00, Test_accy 71.55:  45%|████▌     | 9/20 [01:35<01:30,  8.23s/it]Task 3, Epoch 10/20 => Loss 0.142, Train_accy 95.00, Test_accy 71.55:  50%|█████     | 10/20 [01:35<01:52, 11.21s/it]Task 3, Epoch 11/20 => Loss 0.149, Train_accy 95.00:  50%|█████     | 10/20 [01:42<01:52, 11.21s/it]                 Task 3, Epoch 11/20 => Loss 0.149, Train_accy 95.00:  55%|█████▌    | 11/20 [01:42<01:30, 10.04s/it]Task 3, Epoch 12/20 => Loss 0.105, Train_accy 96.30:  55%|█████▌    | 11/20 [01:49<01:30, 10.04s/it]Task 3, Epoch 12/20 => Loss 0.105, Train_accy 96.30:  60%|██████    | 12/20 [01:49<01:13,  9.21s/it]Task 3, Epoch 13/20 => Loss 0.132, Train_accy 95.54:  60%|██████    | 12/20 [01:57<01:13,  9.21s/it]Task 3, Epoch 13/20 => Loss 0.132, Train_accy 95.54:  65%|██████▌   | 13/20 [01:57<01:00,  8.67s/it]Task 3, Epoch 14/20 => Loss 0.112, Train_accy 96.20:  65%|██████▌   | 13/20 [02:04<01:00,  8.67s/it]Task 3, Epoch 14/20 => Loss 0.112, Train_accy 96.20:  70%|███████   | 14/20 [02:04<00:49,  8.32s/it]Task 3, Epoch 15/20 => Loss 0.118, Train_accy 95.98, Test_accy 72.40:  70%|███████   | 14/20 [02:22<00:49,  8.32s/it]Task 3, Epoch 15/20 => Loss 0.118, Train_accy 95.98, Test_accy 72.40:  75%|███████▌  | 15/20 [02:22<00:55, 11.19s/it]Task 3, Epoch 16/20 => Loss 0.096, Train_accy 96.09:  75%|███████▌  | 15/20 [02:29<00:55, 11.19s/it]                 Task 3, Epoch 16/20 => Loss 0.096, Train_accy 96.09:  80%|████████  | 16/20 [02:29<00:40, 10.05s/it]Task 3, Epoch 17/20 => Loss 0.130, Train_accy 95.43:  80%|████████  | 16/20 [02:37<00:40, 10.05s/it]Task 3, Epoch 17/20 => Loss 0.130, Train_accy 95.43:  85%|████████▌ | 17/20 [02:37<00:27,  9.27s/it]Task 3, Epoch 18/20 => Loss 0.126, Train_accy 95.11:  85%|████████▌ | 17/20 [02:44<00:27,  9.27s/it]Task 3, Epoch 18/20 => Loss 0.126, Train_accy 95.11:  90%|█████████ | 18/20 [02:44<00:17,  8.75s/it]Task 3, Epoch 19/20 => Loss 0.114, Train_accy 96.09:  90%|█████████ | 18/20 [02:52<00:17,  8.75s/it]Task 3, Epoch 19/20 => Loss 0.114, Train_accy 96.09:  95%|█████████▌| 19/20 [02:52<00:08,  8.35s/it]Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.20, Test_accy 72.71:  95%|█████████▌| 19/20 [03:09<00:08,  8.35s/it]Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.20, Test_accy 72.71: 100%|██████████| 20/20 [03:09<00:00, 11.11s/it]Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.20, Test_accy 72.71: 100%|██████████| 20/20 [03:09<00:00,  9.49s/it]
2024-04-29 18:30:24,357 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.106, Train_accy 96.20, Test_accy 72.71
2024-04-29 18:30:34,616 [trainer.py] => No NME accuracy.
2024-04-29 18:30:34,617 [trainer.py] => CNN: {'total': 72.71, '00-99': 89.9, '100-119': 45.18, '120-139': 44.44, '140-159': 41.6, 'old': 77.45, 'new': 41.6}
2024-04-29 18:30:34,617 [trainer.py] => CNN top1 curve: [89.65, 82.91, 77.7, 72.71]
2024-04-29 18:30:34,617 [trainer.py] => CNN top5 curve: [98.82, 98.66, 98.35, 98.2]

Average Accuracy (CNN): 80.74
2024-04-29 18:30:34,617 [trainer.py] => Average Accuracy (CNN): 80.74 

2024-04-29 18:30:34,617 [trainer.py] => Train Time: 2602.91
2024-04-29 18:30:34,617 [trainer.py] => Test Time: 33.519999999999996 

2024-04-29 18:30:34,618 [trainer.py] => All params: 172158352
2024-04-29 18:30:34,619 [trainer.py] => Trainable params: 407240
2024-04-29 18:30:34,619 [dualprompt.py] => Learning on 160-180
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.163, Train_accy 68.27:   0%|          | 0/20 [00:07<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.163, Train_accy 68.27:   5%|▌         | 1/20 [00:07<02:26,  7.70s/it]Task 4, Epoch 2/20 => Loss 0.257, Train_accy 92.59:   5%|▌         | 1/20 [00:15<02:26,  7.70s/it]Task 4, Epoch 2/20 => Loss 0.257, Train_accy 92.59:  10%|█         | 2/20 [00:15<02:17,  7.66s/it]Task 4, Epoch 3/20 => Loss 0.189, Train_accy 93.63:  10%|█         | 2/20 [00:23<02:17,  7.66s/it]Task 4, Epoch 3/20 => Loss 0.189, Train_accy 93.63:  15%|█▌        | 3/20 [00:23<02:11,  7.71s/it]Task 4, Epoch 4/20 => Loss 0.193, Train_accy 93.63:  15%|█▌        | 3/20 [00:30<02:11,  7.71s/it]Task 4, Epoch 4/20 => Loss 0.193, Train_accy 93.63:  20%|██        | 4/20 [00:30<02:04,  7.75s/it]Task 4, Epoch 5/20 => Loss 0.139, Train_accy 95.41, Test_accy 68.33:  20%|██        | 4/20 [00:50<02:04,  7.75s/it]Task 4, Epoch 5/20 => Loss 0.139, Train_accy 95.41, Test_accy 68.33:  25%|██▌       | 5/20 [00:50<02:58, 11.87s/it]Task 4, Epoch 6/20 => Loss 0.166, Train_accy 94.15:  25%|██▌       | 5/20 [00:57<02:58, 11.87s/it]                 Task 4, Epoch 6/20 => Loss 0.166, Train_accy 94.15:  30%|███       | 6/20 [00:57<02:26, 10.46s/it]Task 4, Epoch 7/20 => Loss 0.165, Train_accy 94.47:  30%|███       | 6/20 [01:05<02:26, 10.46s/it]Task 4, Epoch 7/20 => Loss 0.165, Train_accy 94.47:  35%|███▌      | 7/20 [01:05<02:03,  9.53s/it]Task 4, Epoch 8/20 => Loss 0.184, Train_accy 94.15:  35%|███▌      | 7/20 [01:13<02:03,  9.53s/it]Task 4, Epoch 8/20 => Loss 0.184, Train_accy 94.15:  40%|████      | 8/20 [01:13<01:47,  8.94s/it]Task 4, Epoch 9/20 => Loss 0.135, Train_accy 95.62:  40%|████      | 8/20 [01:20<01:47,  8.94s/it]Task 4, Epoch 9/20 => Loss 0.135, Train_accy 95.62:  45%|████▌     | 9/20 [01:20<01:34,  8.56s/it]Task 4, Epoch 10/20 => Loss 0.110, Train_accy 96.35, Test_accy 69.17:  45%|████▌     | 9/20 [01:39<01:34,  8.56s/it]Task 4, Epoch 10/20 => Loss 0.110, Train_accy 96.35, Test_accy 69.17:  50%|█████     | 10/20 [01:39<01:58, 11.82s/it]Task 4, Epoch 11/20 => Loss 0.119, Train_accy 96.14:  50%|█████     | 10/20 [01:47<01:58, 11.82s/it]                 Task 4, Epoch 11/20 => Loss 0.119, Train_accy 96.14:  55%|█████▌    | 11/20 [01:47<01:35, 10.57s/it]Task 4, Epoch 12/20 => Loss 0.148, Train_accy 95.09:  55%|█████▌    | 11/20 [01:55<01:35, 10.57s/it]Task 4, Epoch 12/20 => Loss 0.148, Train_accy 95.09:  60%|██████    | 12/20 [01:55<01:17,  9.73s/it]Task 4, Epoch 13/20 => Loss 0.100, Train_accy 96.45:  60%|██████    | 12/20 [02:03<01:17,  9.73s/it]Task 4, Epoch 13/20 => Loss 0.100, Train_accy 96.45:  65%|██████▌   | 13/20 [02:03<01:03,  9.10s/it]Task 4, Epoch 14/20 => Loss 0.154, Train_accy 94.36:  65%|██████▌   | 13/20 [02:10<01:03,  9.10s/it]Task 4, Epoch 14/20 => Loss 0.154, Train_accy 94.36:  70%|███████   | 14/20 [02:10<00:52,  8.71s/it]Task 4, Epoch 15/20 => Loss 0.099, Train_accy 95.93, Test_accy 69.64:  70%|███████   | 14/20 [02:29<00:52,  8.71s/it]Task 4, Epoch 15/20 => Loss 0.099, Train_accy 95.93, Test_accy 69.64:  75%|███████▌  | 15/20 [02:29<00:58, 11.76s/it]Task 4, Epoch 16/20 => Loss 0.123, Train_accy 95.93:  75%|███████▌  | 15/20 [02:37<00:58, 11.76s/it]                 Task 4, Epoch 16/20 => Loss 0.123, Train_accy 95.93:  80%|████████  | 16/20 [02:37<00:42, 10.55s/it]Task 4, Epoch 17/20 => Loss 0.109, Train_accy 95.93:  80%|████████  | 16/20 [02:45<00:42, 10.55s/it]Task 4, Epoch 17/20 => Loss 0.109, Train_accy 95.93:  85%|████████▌ | 17/20 [02:45<00:29,  9.73s/it]Task 4, Epoch 18/20 => Loss 0.085, Train_accy 96.97:  85%|████████▌ | 17/20 [02:52<00:29,  9.73s/it]Task 4, Epoch 18/20 => Loss 0.085, Train_accy 96.97:  90%|█████████ | 18/20 [02:52<00:18,  9.10s/it]Task 4, Epoch 19/20 => Loss 0.105, Train_accy 96.03:  90%|█████████ | 18/20 [03:00<00:18,  9.10s/it]Task 4, Epoch 19/20 => Loss 0.105, Train_accy 96.03:  95%|█████████▌| 19/20 [03:00<00:08,  8.68s/it]Task 4, Epoch 20/20 => Loss 0.080, Train_accy 96.66, Test_accy 70.30:  95%|█████████▌| 19/20 [03:19<00:08,  8.68s/it]Task 4, Epoch 20/20 => Loss 0.080, Train_accy 96.66, Test_accy 70.30: 100%|██████████| 20/20 [03:19<00:00, 11.77s/it]Task 4, Epoch 20/20 => Loss 0.080, Train_accy 96.66, Test_accy 70.30: 100%|██████████| 20/20 [03:19<00:00,  9.98s/it]
2024-04-29 18:33:54,293 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.080, Train_accy 96.66, Test_accy 70.30
2024-04-29 18:34:05,493 [trainer.py] => No NME accuracy.
2024-04-29 18:34:05,494 [trainer.py] => CNN: {'total': 70.3, '00-99': 89.9, '100-119': 45.61, '120-139': 43.56, '140-159': 41.2, '160-179': 51.9, 'old': 72.61, 'new': 51.9}
2024-04-29 18:34:05,494 [trainer.py] => CNN top1 curve: [89.65, 82.91, 77.7, 72.71, 70.3]
2024-04-29 18:34:05,494 [trainer.py] => CNN top5 curve: [98.82, 98.66, 98.35, 98.2, 97.51]

Average Accuracy (CNN): 78.65
2024-04-29 18:34:05,494 [trainer.py] => Average Accuracy (CNN): 78.65 

2024-04-29 18:34:05,494 [trainer.py] => Train Time: 3002.25
2024-04-29 18:34:05,494 [trainer.py] => Test Time: 44.72 

2024-04-29 18:34:05,495 [trainer.py] => All params: 172158352
2024-04-29 18:34:05,496 [trainer.py] => Trainable params: 407240
2024-04-29 18:34:05,496 [dualprompt.py] => Learning on 180-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.259, Train_accy 65.02:   0%|          | 0/20 [00:07<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.259, Train_accy 65.02:   5%|▌         | 1/20 [00:07<02:25,  7.68s/it]Task 5, Epoch 2/20 => Loss 0.293, Train_accy 91.81:   5%|▌         | 1/20 [00:15<02:25,  7.68s/it]Task 5, Epoch 2/20 => Loss 0.293, Train_accy 91.81:  10%|█         | 2/20 [00:15<02:18,  7.71s/it]Task 5, Epoch 3/20 => Loss 0.224, Train_accy 93.17:  10%|█         | 2/20 [00:23<02:18,  7.71s/it]Task 5, Epoch 3/20 => Loss 0.224, Train_accy 93.17:  15%|█▌        | 3/20 [00:23<02:10,  7.68s/it]Task 5, Epoch 4/20 => Loss 0.205, Train_accy 93.91:  15%|█▌        | 3/20 [00:30<02:10,  7.68s/it]Task 5, Epoch 4/20 => Loss 0.205, Train_accy 93.91:  20%|██        | 4/20 [00:30<02:02,  7.68s/it]Task 5, Epoch 5/20 => Loss 0.163, Train_accy 94.54, Test_accy 65.35:  20%|██        | 4/20 [00:51<02:02,  7.68s/it]Task 5, Epoch 5/20 => Loss 0.163, Train_accy 94.54, Test_accy 65.35:  25%|██▌       | 5/20 [00:51<03:03, 12.25s/it]Task 5, Epoch 6/20 => Loss 0.194, Train_accy 94.43:  25%|██▌       | 5/20 [00:58<03:03, 12.25s/it]                 Task 5, Epoch 6/20 => Loss 0.194, Train_accy 94.43:  30%|███       | 6/20 [00:58<02:29, 10.68s/it]Task 5, Epoch 7/20 => Loss 0.173, Train_accy 94.43:  30%|███       | 6/20 [01:06<02:29, 10.68s/it]Task 5, Epoch 7/20 => Loss 0.173, Train_accy 94.43:  35%|███▌      | 7/20 [01:06<02:05,  9.68s/it]Task 5, Epoch 8/20 => Loss 0.182, Train_accy 93.91:  35%|███▌      | 7/20 [01:14<02:05,  9.68s/it]Task 5, Epoch 8/20 => Loss 0.182, Train_accy 93.91:  40%|████      | 8/20 [01:14<01:48,  9.04s/it]Task 5, Epoch 9/20 => Loss 0.139, Train_accy 95.38:  40%|████      | 8/20 [01:21<01:48,  9.04s/it]Task 5, Epoch 9/20 => Loss 0.139, Train_accy 95.38:  45%|████▌     | 9/20 [01:21<01:34,  8.61s/it]Task 5, Epoch 10/20 => Loss 0.149, Train_accy 94.96, Test_accy 66.50:  45%|████▌     | 9/20 [01:41<01:34,  8.61s/it]Task 5, Epoch 10/20 => Loss 0.149, Train_accy 94.96, Test_accy 66.50:  50%|█████     | 10/20 [01:41<02:01, 12.14s/it]Task 5, Epoch 11/20 => Loss 0.146, Train_accy 95.38:  50%|█████     | 10/20 [01:49<02:01, 12.14s/it]                 Task 5, Epoch 11/20 => Loss 0.146, Train_accy 95.38:  55%|█████▌    | 11/20 [01:49<01:37, 10.79s/it]Task 5, Epoch 12/20 => Loss 0.145, Train_accy 95.38:  55%|█████▌    | 11/20 [01:57<01:37, 10.79s/it]Task 5, Epoch 12/20 => Loss 0.145, Train_accy 95.38:  60%|██████    | 12/20 [01:57<01:18,  9.82s/it]Task 5, Epoch 13/20 => Loss 0.139, Train_accy 95.38:  60%|██████    | 12/20 [02:04<01:18,  9.82s/it]Task 5, Epoch 13/20 => Loss 0.139, Train_accy 95.38:  65%|██████▌   | 13/20 [02:04<01:04,  9.17s/it]Task 5, Epoch 14/20 => Loss 0.140, Train_accy 95.59:  65%|██████▌   | 13/20 [02:12<01:04,  9.17s/it]Task 5, Epoch 14/20 => Loss 0.140, Train_accy 95.59:  70%|███████   | 14/20 [02:12<00:52,  8.70s/it]Task 5, Epoch 15/20 => Loss 0.128, Train_accy 96.32, Test_accy 66.84:  70%|███████   | 14/20 [02:32<00:52,  8.70s/it]Task 5, Epoch 15/20 => Loss 0.128, Train_accy 96.32, Test_accy 66.84:  75%|███████▌  | 15/20 [02:32<01:00, 12.15s/it]Task 5, Epoch 16/20 => Loss 0.107, Train_accy 96.64:  75%|███████▌  | 15/20 [02:40<01:00, 12.15s/it]                 Task 5, Epoch 16/20 => Loss 0.107, Train_accy 96.64:  80%|████████  | 16/20 [02:40<00:43, 10.81s/it]Task 5, Epoch 17/20 => Loss 0.148, Train_accy 94.75:  80%|████████  | 16/20 [02:47<00:43, 10.81s/it]Task 5, Epoch 17/20 => Loss 0.148, Train_accy 94.75:  85%|████████▌ | 17/20 [02:47<00:29,  9.84s/it]Task 5, Epoch 18/20 => Loss 0.088, Train_accy 96.43:  85%|████████▌ | 17/20 [02:55<00:29,  9.84s/it]Task 5, Epoch 18/20 => Loss 0.088, Train_accy 96.43:  90%|█████████ | 18/20 [02:55<00:18,  9.18s/it]Task 5, Epoch 19/20 => Loss 0.122, Train_accy 96.11:  90%|█████████ | 18/20 [03:03<00:18,  9.18s/it]Task 5, Epoch 19/20 => Loss 0.122, Train_accy 96.11:  95%|█████████▌| 19/20 [03:03<00:08,  8.71s/it]Task 5, Epoch 20/20 => Loss 0.115, Train_accy 95.27, Test_accy 66.88:  95%|█████████▌| 19/20 [03:23<00:08,  8.71s/it]Task 5, Epoch 20/20 => Loss 0.115, Train_accy 95.27, Test_accy 66.88: 100%|██████████| 20/20 [03:23<00:00, 12.24s/it]Task 5, Epoch 20/20 => Loss 0.115, Train_accy 95.27, Test_accy 66.88: 100%|██████████| 20/20 [03:23<00:00, 10.17s/it]
2024-04-29 18:37:28,981 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.115, Train_accy 95.27, Test_accy 66.88
2024-04-29 18:37:41,576 [trainer.py] => No NME accuracy.
2024-04-29 18:37:41,577 [trainer.py] => CNN: {'total': 66.88, '00-99': 89.81, '100-119': 44.74, '120-139': 44.0, '140-159': 40.8, '160-179': 51.48, '180-199': 36.96, 'old': 70.11, 'new': 36.96}
2024-04-29 18:37:41,577 [trainer.py] => CNN top1 curve: [89.65, 82.91, 77.7, 72.71, 70.3, 66.88]
2024-04-29 18:37:41,577 [trainer.py] => CNN top5 curve: [98.82, 98.66, 98.35, 98.2, 97.51, 96.86]

Average Accuracy (CNN): 76.69
2024-04-29 18:37:41,577 [trainer.py] => Average Accuracy (CNN): 76.69 

2024-04-29 18:37:41,577 [trainer.py] => Train Time: 3409.21
2024-04-29 18:37:41,577 [trainer.py] => Test Time: 57.31 

Accuracy Matrix (CNN):
[[89.65 89.9  89.98 89.9  89.9  89.81]
 [ 0.   46.49 46.05 45.18 45.61 44.74]
 [ 0.    0.   44.89 44.44 43.56 44.  ]
 [ 0.    0.    0.   41.6  41.2  40.8 ]
 [ 0.    0.    0.    0.   51.9  51.48]
 [ 0.    0.    0.    0.    0.   36.96]]
2024-04-29 18:37:41,578 [trainer.py] => Forgetting (CNN): 0.8060000000000016
2024-04-29 18:37:44,565 [trainer.py] => config: ./exps/coda_prompt_cub_B100_Inc5.json
2024-04-29 18:37:44,565 [trainer.py] => prefix:  
2024-04-29 18:37:44,565 [trainer.py] => dataset: cub
2024-04-29 18:37:44,565 [trainer.py] => memory_size: 0
2024-04-29 18:37:44,565 [trainer.py] => memory_per_class: 0
2024-04-29 18:37:44,565 [trainer.py] => fixed_memory: False
2024-04-29 18:37:44,565 [trainer.py] => shuffle: False
2024-04-29 18:37:44,565 [trainer.py] => init_cls: 100
2024-04-29 18:37:44,565 [trainer.py] => increment: 20
2024-04-29 18:37:44,565 [trainer.py] => model_name: coda_prompt
2024-04-29 18:37:44,565 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-04-29 18:37:44,565 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-29 18:37:44,566 [trainer.py] => seed: 1993
2024-04-29 18:37:44,566 [trainer.py] => tuned_epoch: 20
2024-04-29 18:37:44,566 [trainer.py] => init_lr: 0.001
2024-04-29 18:37:44,566 [trainer.py] => batch_size: 48
2024-04-29 18:37:44,566 [trainer.py] => weight_decay: 0
2024-04-29 18:37:44,566 [trainer.py] => min_lr: 1e-05
2024-04-29 18:37:44,566 [trainer.py] => optimizer: adam
2024-04-29 18:37:44,566 [trainer.py] => scheduler: cosine
2024-04-29 18:37:44,566 [trainer.py] => reinit_optimizer: True
2024-04-29 18:37:44,566 [trainer.py] => pretrained: True
2024-04-29 18:37:44,566 [trainer.py] => drop: 0.0
2024-04-29 18:37:44,566 [trainer.py] => drop_path: 0.0
2024-04-29 18:37:44,566 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-04-29 18:37:44,607 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2024-04-29 18:37:52,142 [coda_prompt.py] => 89,792,456 total parameters.
2024-04-29 18:37:52,142 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-04-29 18:37:52,143 [trainer.py] => All params: 89792456
2024-04-29 18:37:52,143 [trainer.py] => Trainable params: 89792456
2024-04-29 18:37:52,143 [coda_prompt.py] => Learning on 0-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.538, Train_accy 63.19:   0%|          | 0/20 [00:44<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.538, Train_accy 63.19:   5%|▌         | 1/20 [00:44<14:08, 44.67s/it]Task 0, Epoch 2/20 => Loss 0.612, Train_accy 82.30:   5%|▌         | 1/20 [01:28<14:08, 44.67s/it]Task 0, Epoch 2/20 => Loss 0.612, Train_accy 82.30:  10%|█         | 2/20 [01:28<13:20, 44.45s/it]Task 0, Epoch 3/20 => Loss 0.507, Train_accy 85.27:  10%|█         | 2/20 [02:13<13:20, 44.45s/it]Task 0, Epoch 3/20 => Loss 0.507, Train_accy 85.27:  15%|█▌        | 3/20 [02:13<12:33, 44.32s/it]Task 0, Epoch 4/20 => Loss 0.433, Train_accy 87.54:  15%|█▌        | 3/20 [02:57<12:33, 44.32s/it]Task 0, Epoch 4/20 => Loss 0.433, Train_accy 87.54:  20%|██        | 4/20 [02:57<11:48, 44.31s/it]Task 0, Epoch 5/20 => Loss 0.365, Train_accy 89.43, Test_accy 87.87:  20%|██        | 4/20 [03:47<11:48, 44.31s/it]Task 0, Epoch 5/20 => Loss 0.365, Train_accy 89.43, Test_accy 87.87:  25%|██▌       | 5/20 [03:47<11:37, 46.48s/it]Task 0, Epoch 6/20 => Loss 0.353, Train_accy 90.31:  25%|██▌       | 5/20 [04:31<11:37, 46.48s/it]                 Task 0, Epoch 6/20 => Loss 0.353, Train_accy 90.31:  30%|███       | 6/20 [04:31<10:39, 45.65s/it]Task 0, Epoch 7/20 => Loss 0.304, Train_accy 91.34:  30%|███       | 6/20 [05:15<10:39, 45.65s/it]Task 0, Epoch 7/20 => Loss 0.304, Train_accy 91.34:  35%|███▌      | 7/20 [05:15<09:46, 45.13s/it]Task 0, Epoch 8/20 => Loss 0.315, Train_accy 91.11:  35%|███▌      | 7/20 [05:59<09:46, 45.13s/it]Task 0, Epoch 8/20 => Loss 0.315, Train_accy 91.11:  40%|████      | 8/20 [05:59<08:57, 44.78s/it]Task 0, Epoch 9/20 => Loss 0.298, Train_accy 91.60:  40%|████      | 8/20 [06:43<08:57, 44.78s/it]Task 0, Epoch 9/20 => Loss 0.298, Train_accy 91.60:  45%|████▌     | 9/20 [06:43<08:10, 44.55s/it]Task 0, Epoch 10/20 => Loss 0.301, Train_accy 91.39, Test_accy 88.04:  45%|████▌     | 9/20 [07:34<08:10, 44.55s/it]Task 0, Epoch 10/20 => Loss 0.301, Train_accy 91.39, Test_accy 88.04:  50%|█████     | 10/20 [07:34<07:44, 46.40s/it]Task 0, Epoch 11/20 => Loss 0.267, Train_accy 92.46:  50%|█████     | 10/20 [08:18<07:44, 46.40s/it]                 Task 0, Epoch 11/20 => Loss 0.267, Train_accy 92.46:  55%|█████▌    | 11/20 [08:18<06:51, 45.70s/it]Task 0, Epoch 12/20 => Loss 0.273, Train_accy 92.55:  55%|█████▌    | 11/20 [09:02<06:51, 45.70s/it]Task 0, Epoch 12/20 => Loss 0.273, Train_accy 92.55:  60%|██████    | 12/20 [09:02<06:01, 45.18s/it]Task 0, Epoch 13/20 => Loss 0.221, Train_accy 93.66:  60%|██████    | 12/20 [09:46<06:01, 45.18s/it]Task 0, Epoch 13/20 => Loss 0.221, Train_accy 93.66:  65%|██████▌   | 13/20 [09:46<05:13, 44.83s/it]Task 0, Epoch 14/20 => Loss 0.236, Train_accy 93.49:  65%|██████▌   | 13/20 [10:30<05:13, 44.83s/it]Task 0, Epoch 14/20 => Loss 0.236, Train_accy 93.49:  70%|███████   | 14/20 [10:30<04:28, 44.69s/it]Task 0, Epoch 15/20 => Loss 0.243, Train_accy 92.89, Test_accy 88.56:  70%|███████   | 14/20 [11:21<04:28, 44.69s/it]Task 0, Epoch 15/20 => Loss 0.243, Train_accy 92.89, Test_accy 88.56:  75%|███████▌  | 15/20 [11:21<03:52, 46.49s/it]Task 0, Epoch 16/20 => Loss 0.220, Train_accy 94.33:  75%|███████▌  | 15/20 [12:05<03:52, 46.49s/it]                 Task 0, Epoch 16/20 => Loss 0.220, Train_accy 94.33:  80%|████████  | 16/20 [12:05<03:03, 45.81s/it]Task 0, Epoch 17/20 => Loss 0.216, Train_accy 94.12:  80%|████████  | 16/20 [12:50<03:03, 45.81s/it]Task 0, Epoch 17/20 => Loss 0.216, Train_accy 94.12:  85%|████████▌ | 17/20 [12:50<02:15, 45.33s/it]Task 0, Epoch 18/20 => Loss 0.233, Train_accy 93.66:  85%|████████▌ | 17/20 [13:34<02:15, 45.33s/it]Task 0, Epoch 18/20 => Loss 0.233, Train_accy 93.66:  90%|█████████ | 18/20 [13:34<01:29, 44.95s/it]Task 0, Epoch 19/20 => Loss 0.185, Train_accy 95.15:  90%|█████████ | 18/20 [14:18<01:29, 44.95s/it]Task 0, Epoch 19/20 => Loss 0.185, Train_accy 95.15:  95%|█████████▌| 19/20 [14:18<00:44, 44.74s/it]Task 0, Epoch 20/20 => Loss 0.206, Train_accy 94.46, Test_accy 89.24:  95%|█████████▌| 19/20 [15:08<00:44, 44.74s/it]Task 0, Epoch 20/20 => Loss 0.206, Train_accy 94.46, Test_accy 89.24: 100%|██████████| 20/20 [15:08<00:00, 46.48s/it]Task 0, Epoch 20/20 => Loss 0.206, Train_accy 94.46, Test_accy 89.24: 100%|██████████| 20/20 [15:08<00:00, 45.45s/it]
2024-04-29 18:53:01,575 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.206, Train_accy 94.46, Test_accy 89.24
2024-04-29 18:53:08,002 [trainer.py] => No NME accuracy.
2024-04-29 18:53:08,002 [trainer.py] => CNN: {'total': 89.24, '00-99': 89.24, 'old': 0, 'new': 89.24}
2024-04-29 18:53:08,002 [trainer.py] => CNN top1 curve: [89.24]
2024-04-29 18:53:08,002 [trainer.py] => CNN top5 curve: [99.23]

Average Accuracy (CNN): 89.24
2024-04-29 18:53:08,002 [trainer.py] => Average Accuracy (CNN): 89.24 

2024-04-29 18:53:08,002 [trainer.py] => Train Time: 1818.33
2024-04-29 18:53:08,002 [trainer.py] => Test Time: 6.43 

2024-04-29 18:53:08,003 [trainer.py] => All params: 89792456
2024-04-29 18:53:08,004 [trainer.py] => Trainable params: 89792456
2024-04-29 18:53:08,828 [coda_prompt.py] => Learning on 100-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.465, Train_accy 57.46:   0%|          | 0/20 [00:09<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.465, Train_accy 57.46:   5%|▌         | 1/20 [00:09<02:53,  9.16s/it]Task 1, Epoch 2/20 => Loss 0.486, Train_accy 83.66:   5%|▌         | 1/20 [00:18<02:53,  9.16s/it]Task 1, Epoch 2/20 => Loss 0.486, Train_accy 83.66:  10%|█         | 2/20 [00:18<02:44,  9.13s/it]Task 1, Epoch 3/20 => Loss 0.351, Train_accy 87.83:  10%|█         | 2/20 [00:27<02:44,  9.13s/it]Task 1, Epoch 3/20 => Loss 0.351, Train_accy 87.83:  15%|█▌        | 3/20 [00:27<02:35,  9.15s/it]Task 1, Epoch 4/20 => Loss 0.283, Train_accy 89.58:  15%|█▌        | 3/20 [00:36<02:35,  9.15s/it]Task 1, Epoch 4/20 => Loss 0.283, Train_accy 89.58:  20%|██        | 4/20 [00:36<02:26,  9.17s/it]Task 1, Epoch 5/20 => Loss 0.249, Train_accy 92.43, Test_accy 82.05:  20%|██        | 4/20 [00:53<02:26,  9.17s/it]Task 1, Epoch 5/20 => Loss 0.249, Train_accy 92.43, Test_accy 82.05:  25%|██▌       | 5/20 [00:53<02:58, 11.88s/it]Task 1, Epoch 6/20 => Loss 0.255, Train_accy 92.21:  25%|██▌       | 5/20 [01:02<02:58, 11.88s/it]                 Task 1, Epoch 6/20 => Loss 0.255, Train_accy 92.21:  30%|███       | 6/20 [01:02<02:32, 10.92s/it]Task 1, Epoch 7/20 => Loss 0.218, Train_accy 94.08:  30%|███       | 6/20 [01:11<02:32, 10.92s/it]Task 1, Epoch 7/20 => Loss 0.218, Train_accy 94.08:  35%|███▌      | 7/20 [01:11<02:14, 10.34s/it]Task 1, Epoch 8/20 => Loss 0.192, Train_accy 93.97:  35%|███▌      | 7/20 [01:20<02:14, 10.34s/it]Task 1, Epoch 8/20 => Loss 0.192, Train_accy 93.97:  40%|████      | 8/20 [01:20<01:59,  9.95s/it]Task 1, Epoch 9/20 => Loss 0.224, Train_accy 93.20:  40%|████      | 8/20 [01:29<01:59,  9.95s/it]Task 1, Epoch 9/20 => Loss 0.224, Train_accy 93.20:  45%|████▌     | 9/20 [01:29<01:46,  9.68s/it]Task 1, Epoch 10/20 => Loss 0.163, Train_accy 94.96, Test_accy 83.06:  45%|████▌     | 9/20 [01:46<01:46,  9.68s/it]Task 1, Epoch 10/20 => Loss 0.163, Train_accy 94.96, Test_accy 83.06:  50%|█████     | 10/20 [01:46<01:58, 11.87s/it]Task 1, Epoch 11/20 => Loss 0.199, Train_accy 94.08:  50%|█████     | 10/20 [01:55<01:58, 11.87s/it]                 Task 1, Epoch 11/20 => Loss 0.199, Train_accy 94.08:  55%|█████▌    | 11/20 [01:55<01:39, 11.04s/it]Task 1, Epoch 12/20 => Loss 0.176, Train_accy 94.52:  55%|█████▌    | 11/20 [02:04<01:39, 11.04s/it]Task 1, Epoch 12/20 => Loss 0.176, Train_accy 94.52:  60%|██████    | 12/20 [02:04<01:23, 10.43s/it]Task 1, Epoch 13/20 => Loss 0.184, Train_accy 93.86:  60%|██████    | 12/20 [02:13<01:23, 10.43s/it]Task 1, Epoch 13/20 => Loss 0.184, Train_accy 93.86:  65%|██████▌   | 13/20 [02:13<01:09, 10.00s/it]Task 1, Epoch 14/20 => Loss 0.181, Train_accy 94.74:  65%|██████▌   | 13/20 [02:22<01:09, 10.00s/it]Task 1, Epoch 14/20 => Loss 0.181, Train_accy 94.74:  70%|███████   | 14/20 [02:22<00:58,  9.73s/it]Task 1, Epoch 15/20 => Loss 0.164, Train_accy 95.18, Test_accy 82.91:  70%|███████   | 14/20 [02:39<00:58,  9.73s/it]Task 1, Epoch 15/20 => Loss 0.164, Train_accy 95.18, Test_accy 82.91:  75%|███████▌  | 15/20 [02:39<00:59, 11.84s/it]Task 1, Epoch 16/20 => Loss 0.149, Train_accy 95.39:  75%|███████▌  | 15/20 [02:48<00:59, 11.84s/it]                 Task 1, Epoch 16/20 => Loss 0.149, Train_accy 95.39:  80%|████████  | 16/20 [02:48<00:44, 11.04s/it]Task 1, Epoch 17/20 => Loss 0.168, Train_accy 94.52:  80%|████████  | 16/20 [02:57<00:44, 11.04s/it]Task 1, Epoch 17/20 => Loss 0.168, Train_accy 94.52:  85%|████████▌ | 17/20 [02:57<00:31, 10.45s/it]Task 1, Epoch 18/20 => Loss 0.146, Train_accy 95.18:  85%|████████▌ | 17/20 [03:06<00:31, 10.45s/it]Task 1, Epoch 18/20 => Loss 0.146, Train_accy 95.18:  90%|█████████ | 18/20 [03:06<00:20, 10.03s/it]Task 1, Epoch 19/20 => Loss 0.138, Train_accy 95.39:  90%|█████████ | 18/20 [03:16<00:20, 10.03s/it]Task 1, Epoch 19/20 => Loss 0.138, Train_accy 95.39:  95%|█████████▌| 19/20 [03:16<00:09,  9.77s/it]Task 1, Epoch 20/20 => Loss 0.157, Train_accy 95.61, Test_accy 83.06:  95%|█████████▌| 19/20 [03:32<00:09,  9.77s/it]Task 1, Epoch 20/20 => Loss 0.157, Train_accy 95.61, Test_accy 83.06: 100%|██████████| 20/20 [03:32<00:00, 11.81s/it]Task 1, Epoch 20/20 => Loss 0.157, Train_accy 95.61, Test_accy 83.06: 100%|██████████| 20/20 [03:32<00:00, 10.63s/it]
2024-04-29 18:56:41,435 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.157, Train_accy 95.61, Test_accy 83.06
2024-04-29 18:56:49,023 [trainer.py] => No NME accuracy.
2024-04-29 18:56:49,024 [trainer.py] => CNN: {'total': 83.06, '00-99': 89.41, '100-119': 49.55, 'old': 89.41, 'new': 49.55}
2024-04-29 18:56:49,024 [trainer.py] => CNN top1 curve: [89.24, 83.06]
2024-04-29 18:56:49,024 [trainer.py] => CNN top5 curve: [99.23, 98.35]

Average Accuracy (CNN): 86.15
2024-04-29 18:56:49,024 [trainer.py] => Average Accuracy (CNN): 86.15 

2024-04-29 18:56:49,024 [trainer.py] => Train Time: 2243.5299999999997
2024-04-29 18:56:49,024 [trainer.py] => Test Time: 14.02 

2024-04-29 18:56:49,025 [trainer.py] => All params: 89792456
2024-04-29 18:56:49,025 [trainer.py] => Trainable params: 89792456
2024-04-29 18:56:50,408 [coda_prompt.py] => Learning on 120-140
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.970, Train_accy 44.85:   0%|          | 0/20 [00:09<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.970, Train_accy 44.85:   5%|▌         | 1/20 [00:09<02:55,  9.21s/it]Task 2, Epoch 2/20 => Loss 0.609, Train_accy 81.69:   5%|▌         | 1/20 [00:18<02:55,  9.21s/it]Task 2, Epoch 2/20 => Loss 0.609, Train_accy 81.69:  10%|█         | 2/20 [00:18<02:44,  9.15s/it]Task 2, Epoch 3/20 => Loss 0.488, Train_accy 86.18:  10%|█         | 2/20 [00:27<02:44,  9.15s/it]Task 2, Epoch 3/20 => Loss 0.488, Train_accy 86.18:  15%|█▌        | 3/20 [00:27<02:35,  9.17s/it]Task 2, Epoch 4/20 => Loss 0.392, Train_accy 88.49:  15%|█▌        | 3/20 [00:36<02:35,  9.17s/it]Task 2, Epoch 4/20 => Loss 0.392, Train_accy 88.49:  20%|██        | 4/20 [00:36<02:26,  9.19s/it]Task 2, Epoch 5/20 => Loss 0.333, Train_accy 90.57, Test_accy 76.02:  20%|██        | 4/20 [00:54<02:26,  9.19s/it]Task 2, Epoch 5/20 => Loss 0.333, Train_accy 90.57, Test_accy 76.02:  25%|██▌       | 5/20 [00:54<03:04, 12.29s/it]Task 2, Epoch 6/20 => Loss 0.319, Train_accy 90.46:  25%|██▌       | 5/20 [01:03<03:04, 12.29s/it]                 Task 2, Epoch 6/20 => Loss 0.319, Train_accy 90.46:  30%|███       | 6/20 [01:03<02:37, 11.22s/it]Task 2, Epoch 7/20 => Loss 0.265, Train_accy 92.00:  30%|███       | 6/20 [01:12<02:37, 11.22s/it]Task 2, Epoch 7/20 => Loss 0.265, Train_accy 92.00:  35%|███▌      | 7/20 [01:12<02:17, 10.54s/it]Task 2, Epoch 8/20 => Loss 0.252, Train_accy 92.32:  35%|███▌      | 7/20 [01:21<02:17, 10.54s/it]Task 2, Epoch 8/20 => Loss 0.252, Train_accy 92.32:  40%|████      | 8/20 [01:21<02:00, 10.07s/it]Task 2, Epoch 9/20 => Loss 0.256, Train_accy 92.76:  40%|████      | 8/20 [01:31<02:00, 10.07s/it]Task 2, Epoch 9/20 => Loss 0.256, Train_accy 92.76:  45%|████▌     | 9/20 [01:31<01:47,  9.79s/it]Task 2, Epoch 10/20 => Loss 0.244, Train_accy 92.65, Test_accy 77.13:  45%|████▌     | 9/20 [01:48<01:47,  9.79s/it]Task 2, Epoch 10/20 => Loss 0.244, Train_accy 92.65, Test_accy 77.13:  50%|█████     | 10/20 [01:48<02:02, 12.26s/it]Task 2, Epoch 11/20 => Loss 0.234, Train_accy 93.20:  50%|█████     | 10/20 [01:57<02:02, 12.26s/it]                 Task 2, Epoch 11/20 => Loss 0.234, Train_accy 93.20:  55%|█████▌    | 11/20 [01:57<01:41, 11.28s/it]Task 2, Epoch 12/20 => Loss 0.264, Train_accy 91.34:  55%|█████▌    | 11/20 [02:06<01:41, 11.28s/it]Task 2, Epoch 12/20 => Loss 0.264, Train_accy 91.34:  60%|██████    | 12/20 [02:06<01:24, 10.60s/it]Task 2, Epoch 13/20 => Loss 0.246, Train_accy 92.87:  60%|██████    | 12/20 [02:15<01:24, 10.60s/it]Task 2, Epoch 13/20 => Loss 0.246, Train_accy 92.87:  65%|██████▌   | 13/20 [02:15<01:10, 10.13s/it]Task 2, Epoch 14/20 => Loss 0.227, Train_accy 93.53:  65%|██████▌   | 13/20 [02:25<01:10, 10.13s/it]Task 2, Epoch 14/20 => Loss 0.227, Train_accy 93.53:  70%|███████   | 14/20 [02:25<00:59,  9.84s/it]Task 2, Epoch 15/20 => Loss 0.233, Train_accy 93.53, Test_accy 77.43:  70%|███████   | 14/20 [02:43<00:59,  9.84s/it]Task 2, Epoch 15/20 => Loss 0.233, Train_accy 93.53, Test_accy 77.43:  75%|███████▌  | 15/20 [02:43<01:01, 12.27s/it]Task 2, Epoch 16/20 => Loss 0.193, Train_accy 94.52:  75%|███████▌  | 15/20 [02:52<01:01, 12.27s/it]                 Task 2, Epoch 16/20 => Loss 0.193, Train_accy 94.52:  80%|████████  | 16/20 [02:52<00:45, 11.35s/it]Task 2, Epoch 17/20 => Loss 0.185, Train_accy 94.41:  80%|████████  | 16/20 [03:01<00:45, 11.35s/it]Task 2, Epoch 17/20 => Loss 0.185, Train_accy 94.41:  85%|████████▌ | 17/20 [03:01<00:32, 10.72s/it]Task 2, Epoch 18/20 => Loss 0.191, Train_accy 94.30:  85%|████████▌ | 17/20 [03:10<00:32, 10.72s/it]Task 2, Epoch 18/20 => Loss 0.191, Train_accy 94.30:  90%|█████████ | 18/20 [03:10<00:20, 10.26s/it]Task 2, Epoch 19/20 => Loss 0.229, Train_accy 92.76:  90%|█████████ | 18/20 [03:19<00:20, 10.26s/it]Task 2, Epoch 19/20 => Loss 0.229, Train_accy 92.76:  95%|█████████▌| 19/20 [03:19<00:09,  9.93s/it]Task 2, Epoch 20/20 => Loss 0.185, Train_accy 94.74, Test_accy 77.55:  95%|█████████▌| 19/20 [03:37<00:09,  9.93s/it]Task 2, Epoch 20/20 => Loss 0.185, Train_accy 94.74, Test_accy 77.55: 100%|██████████| 20/20 [03:37<00:00, 12.27s/it]Task 2, Epoch 20/20 => Loss 0.185, Train_accy 94.74, Test_accy 77.55: 100%|██████████| 20/20 [03:37<00:00, 10.88s/it]
2024-04-29 19:00:28,013 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.185, Train_accy 94.74, Test_accy 77.55
2024-04-29 19:00:36,755 [trainer.py] => No NME accuracy.
2024-04-29 19:00:36,755 [trainer.py] => CNN: {'total': 77.55, '00-99': 89.33, '100-119': 50.45, '120-139': 45.45, 'old': 83.13, 'new': 45.45}
2024-04-29 19:00:36,755 [trainer.py] => CNN top1 curve: [89.24, 83.06, 77.55]
2024-04-29 19:00:36,755 [trainer.py] => CNN top5 curve: [99.23, 98.35, 97.06]

Average Accuracy (CNN): 83.28
2024-04-29 19:00:36,756 [trainer.py] => Average Accuracy (CNN): 83.28 

2024-04-29 19:00:36,756 [trainer.py] => Train Time: 2678.72
2024-04-29 19:00:36,756 [trainer.py] => Test Time: 22.759999999999998 

2024-04-29 19:00:36,756 [trainer.py] => All params: 89792456
2024-04-29 19:00:36,757 [trainer.py] => Trainable params: 89792456
2024-04-29 19:00:38,901 [coda_prompt.py] => Learning on 140-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.009, Train_accy 43.75:   0%|          | 0/20 [00:09<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.009, Train_accy 43.75:   5%|▌         | 1/20 [00:09<03:02,  9.60s/it]Task 3, Epoch 2/20 => Loss 0.770, Train_accy 74.17:   5%|▌         | 1/20 [00:19<03:02,  9.60s/it]Task 3, Epoch 2/20 => Loss 0.770, Train_accy 74.17:  10%|█         | 2/20 [00:19<02:53,  9.61s/it]Task 3, Epoch 3/20 => Loss 0.580, Train_accy 80.94:  10%|█         | 2/20 [00:28<02:53,  9.61s/it]Task 3, Epoch 3/20 => Loss 0.580, Train_accy 80.94:  15%|█▌        | 3/20 [00:28<02:42,  9.58s/it]Task 3, Epoch 4/20 => Loss 0.509, Train_accy 82.60:  15%|█▌        | 3/20 [00:38<02:42,  9.58s/it]Task 3, Epoch 4/20 => Loss 0.509, Train_accy 82.60:  20%|██        | 4/20 [00:38<02:34,  9.64s/it]Task 3, Epoch 5/20 => Loss 0.437, Train_accy 86.77, Test_accy 72.67:  20%|██        | 4/20 [00:57<02:34,  9.64s/it]Task 3, Epoch 5/20 => Loss 0.437, Train_accy 86.77, Test_accy 72.67:  25%|██▌       | 5/20 [00:57<03:16, 13.11s/it]Task 3, Epoch 6/20 => Loss 0.425, Train_accy 87.40:  25%|██▌       | 5/20 [01:07<03:16, 13.11s/it]                 Task 3, Epoch 6/20 => Loss 0.425, Train_accy 87.40:  30%|███       | 6/20 [01:07<02:46, 11.92s/it]Task 3, Epoch 7/20 => Loss 0.388, Train_accy 87.60:  30%|███       | 6/20 [01:16<02:46, 11.92s/it]Task 3, Epoch 7/20 => Loss 0.388, Train_accy 87.60:  35%|███▌      | 7/20 [01:16<02:24, 11.15s/it]Task 3, Epoch 8/20 => Loss 0.371, Train_accy 88.44:  35%|███▌      | 7/20 [01:26<02:24, 11.15s/it]Task 3, Epoch 8/20 => Loss 0.371, Train_accy 88.44:  40%|████      | 8/20 [01:26<02:07, 10.65s/it]Task 3, Epoch 9/20 => Loss 0.351, Train_accy 89.27:  40%|████      | 8/20 [01:36<02:07, 10.65s/it]Task 3, Epoch 9/20 => Loss 0.351, Train_accy 89.27:  45%|████▌     | 9/20 [01:36<01:53, 10.33s/it]Task 3, Epoch 10/20 => Loss 0.278, Train_accy 91.46, Test_accy 73.05:  45%|████▌     | 9/20 [01:55<01:53, 10.33s/it]Task 3, Epoch 10/20 => Loss 0.278, Train_accy 91.46, Test_accy 73.05:  50%|█████     | 10/20 [01:55<02:11, 13.14s/it]Task 3, Epoch 11/20 => Loss 0.341, Train_accy 89.90:  50%|█████     | 10/20 [02:05<02:11, 13.14s/it]                 Task 3, Epoch 11/20 => Loss 0.341, Train_accy 89.90:  55%|█████▌    | 11/20 [02:05<01:48, 12.09s/it]Task 3, Epoch 12/20 => Loss 0.284, Train_accy 91.46:  55%|█████▌    | 11/20 [02:14<01:48, 12.09s/it]Task 3, Epoch 12/20 => Loss 0.284, Train_accy 91.46:  60%|██████    | 12/20 [02:14<01:30, 11.33s/it]Task 3, Epoch 13/20 => Loss 0.281, Train_accy 91.67:  60%|██████    | 12/20 [02:24<01:30, 11.33s/it]Task 3, Epoch 13/20 => Loss 0.281, Train_accy 91.67:  65%|██████▌   | 13/20 [02:24<01:15, 10.79s/it]Task 3, Epoch 14/20 => Loss 0.203, Train_accy 94.69:  65%|██████▌   | 13/20 [02:34<01:15, 10.79s/it]Task 3, Epoch 14/20 => Loss 0.203, Train_accy 94.69:  70%|███████   | 14/20 [02:34<01:02, 10.44s/it]Task 3, Epoch 15/20 => Loss 0.245, Train_accy 92.60, Test_accy 73.70:  70%|███████   | 14/20 [02:53<01:02, 10.44s/it]Task 3, Epoch 15/20 => Loss 0.245, Train_accy 92.60, Test_accy 73.70:  75%|███████▌  | 15/20 [02:53<01:05, 13.16s/it]Task 3, Epoch 16/20 => Loss 0.252, Train_accy 92.19:  75%|███████▌  | 15/20 [03:03<01:05, 13.16s/it]                 Task 3, Epoch 16/20 => Loss 0.252, Train_accy 92.19:  80%|████████  | 16/20 [03:03<00:48, 12.07s/it]Task 3, Epoch 17/20 => Loss 0.224, Train_accy 93.65:  80%|████████  | 16/20 [03:12<00:48, 12.07s/it]Task 3, Epoch 17/20 => Loss 0.224, Train_accy 93.65:  85%|████████▌ | 17/20 [03:12<00:33, 11.29s/it]Task 3, Epoch 18/20 => Loss 0.225, Train_accy 93.65:  85%|████████▌ | 17/20 [03:22<00:33, 11.29s/it]Task 3, Epoch 18/20 => Loss 0.225, Train_accy 93.65:  90%|█████████ | 18/20 [03:22<00:21, 10.79s/it]Task 3, Epoch 19/20 => Loss 0.202, Train_accy 93.96:  90%|█████████ | 18/20 [03:31<00:21, 10.79s/it]Task 3, Epoch 19/20 => Loss 0.202, Train_accy 93.96:  95%|█████████▌| 19/20 [03:31<00:10, 10.40s/it]Task 3, Epoch 20/20 => Loss 0.201, Train_accy 94.06, Test_accy 73.48:  95%|█████████▌| 19/20 [03:51<00:10, 10.40s/it]Task 3, Epoch 20/20 => Loss 0.201, Train_accy 94.06, Test_accy 73.48: 100%|██████████| 20/20 [03:51<00:00, 13.12s/it]Task 3, Epoch 20/20 => Loss 0.201, Train_accy 94.06, Test_accy 73.48: 100%|██████████| 20/20 [03:51<00:00, 11.56s/it]
2024-04-29 19:04:30,017 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.201, Train_accy 94.06, Test_accy 73.48
2024-04-29 19:04:40,053 [trainer.py] => No NME accuracy.
2024-04-29 19:04:40,053 [trainer.py] => CNN: {'total': 73.48, '00-99': 88.73, '100-119': 49.55, '120-139': 45.04, '140-159': 48.21, 'old': 76.94, 'new': 48.21}
2024-04-29 19:04:40,053 [trainer.py] => CNN top1 curve: [89.24, 83.06, 77.55, 73.48]
2024-04-29 19:04:40,054 [trainer.py] => CNN top5 curve: [99.23, 98.35, 97.06, 95.8]

Average Accuracy (CNN): 80.83
2024-04-29 19:04:40,054 [trainer.py] => Average Accuracy (CNN): 80.83 

2024-04-29 19:04:40,054 [trainer.py] => Train Time: 3140.94
2024-04-29 19:04:40,054 [trainer.py] => Test Time: 32.79 

2024-04-29 19:04:40,054 [trainer.py] => All params: 89792456
2024-04-29 19:04:40,055 [trainer.py] => Trainable params: 89792456
2024-04-29 19:04:42,706 [coda_prompt.py] => Learning on 160-180
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.215, Train_accy 41.56:   0%|          | 0/20 [00:09<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.215, Train_accy 41.56:   5%|▌         | 1/20 [00:09<02:53,  9.15s/it]Task 4, Epoch 2/20 => Loss 0.713, Train_accy 80.15:   5%|▌         | 1/20 [00:18<02:53,  9.15s/it]Task 4, Epoch 2/20 => Loss 0.713, Train_accy 80.15:  10%|█         | 2/20 [00:18<02:43,  9.09s/it]Task 4, Epoch 3/20 => Loss 0.598, Train_accy 82.79:  10%|█         | 2/20 [00:27<02:43,  9.09s/it]Task 4, Epoch 3/20 => Loss 0.598, Train_accy 82.79:  15%|█▌        | 3/20 [00:27<02:35,  9.13s/it]Task 4, Epoch 4/20 => Loss 0.467, Train_accy 86.51:  15%|█▌        | 3/20 [00:36<02:35,  9.13s/it]Task 4, Epoch 4/20 => Loss 0.467, Train_accy 86.51:  20%|██        | 4/20 [00:36<02:25,  9.12s/it]Task 4, Epoch 5/20 => Loss 0.424, Train_accy 88.38, Test_accy 68.95:  20%|██        | 4/20 [00:56<02:25,  9.12s/it]Task 4, Epoch 5/20 => Loss 0.424, Train_accy 88.38, Test_accy 68.95:  25%|██▌       | 5/20 [00:56<03:17, 13.17s/it]Task 4, Epoch 6/20 => Loss 0.334, Train_accy 90.35:  25%|██▌       | 5/20 [01:05<03:17, 13.17s/it]                 Task 4, Epoch 6/20 => Loss 0.334, Train_accy 90.35:  30%|███       | 6/20 [01:05<02:44, 11.76s/it]Task 4, Epoch 7/20 => Loss 0.322, Train_accy 90.68:  30%|███       | 6/20 [01:14<02:44, 11.76s/it]Task 4, Epoch 7/20 => Loss 0.322, Train_accy 90.68:  35%|███▌      | 7/20 [01:14<02:21, 10.87s/it]Task 4, Epoch 8/20 => Loss 0.372, Train_accy 88.16:  35%|███▌      | 7/20 [01:23<02:21, 10.87s/it]Task 4, Epoch 8/20 => Loss 0.372, Train_accy 88.16:  40%|████      | 8/20 [01:23<02:03, 10.31s/it]Task 4, Epoch 9/20 => Loss 0.381, Train_accy 88.05:  40%|████      | 8/20 [01:33<02:03, 10.31s/it]Task 4, Epoch 9/20 => Loss 0.381, Train_accy 88.05:  45%|████▌     | 9/20 [01:33<01:49,  9.96s/it]Task 4, Epoch 10/20 => Loss 0.289, Train_accy 91.34, Test_accy 70.04:  45%|████▌     | 9/20 [01:53<01:49,  9.96s/it]Task 4, Epoch 10/20 => Loss 0.289, Train_accy 91.34, Test_accy 70.04:  50%|█████     | 10/20 [01:53<02:12, 13.23s/it]Task 4, Epoch 11/20 => Loss 0.307, Train_accy 91.34:  50%|█████     | 10/20 [02:02<02:12, 13.23s/it]                 Task 4, Epoch 11/20 => Loss 0.307, Train_accy 91.34:  55%|█████▌    | 11/20 [02:02<01:48, 12.01s/it]Task 4, Epoch 12/20 => Loss 0.286, Train_accy 91.67:  55%|█████▌    | 11/20 [02:12<01:48, 12.01s/it]Task 4, Epoch 12/20 => Loss 0.286, Train_accy 91.67:  60%|██████    | 12/20 [02:12<01:28, 11.11s/it]Task 4, Epoch 13/20 => Loss 0.256, Train_accy 92.54:  60%|██████    | 12/20 [02:21<01:28, 11.11s/it]Task 4, Epoch 13/20 => Loss 0.256, Train_accy 92.54:  65%|██████▌   | 13/20 [02:21<01:13, 10.50s/it]Task 4, Epoch 14/20 => Loss 0.267, Train_accy 91.78:  65%|██████▌   | 13/20 [02:30<01:13, 10.50s/it]Task 4, Epoch 14/20 => Loss 0.267, Train_accy 91.78:  70%|███████   | 14/20 [02:30<01:00, 10.10s/it]Task 4, Epoch 15/20 => Loss 0.242, Train_accy 93.31, Test_accy 70.42:  70%|███████   | 14/20 [02:50<01:00, 10.10s/it]Task 4, Epoch 15/20 => Loss 0.242, Train_accy 93.31, Test_accy 70.42:  75%|███████▌  | 15/20 [02:50<01:06, 13.24s/it]Task 4, Epoch 16/20 => Loss 0.298, Train_accy 91.67:  75%|███████▌  | 15/20 [03:00<01:06, 13.24s/it]                 Task 4, Epoch 16/20 => Loss 0.298, Train_accy 91.67:  80%|████████  | 16/20 [03:00<00:48, 12.04s/it]Task 4, Epoch 17/20 => Loss 0.286, Train_accy 91.56:  80%|████████  | 16/20 [03:09<00:48, 12.04s/it]Task 4, Epoch 17/20 => Loss 0.286, Train_accy 91.56:  85%|████████▌ | 17/20 [03:09<00:33, 11.17s/it]Task 4, Epoch 18/20 => Loss 0.224, Train_accy 93.53:  85%|████████▌ | 17/20 [03:18<00:33, 11.17s/it]Task 4, Epoch 18/20 => Loss 0.224, Train_accy 93.53:  90%|█████████ | 18/20 [03:18<00:21, 10.57s/it]Task 4, Epoch 19/20 => Loss 0.245, Train_accy 93.53:  90%|█████████ | 18/20 [03:27<00:21, 10.57s/it]Task 4, Epoch 19/20 => Loss 0.245, Train_accy 93.53:  95%|█████████▌| 19/20 [03:27<00:10, 10.14s/it]Task 4, Epoch 20/20 => Loss 0.294, Train_accy 91.67, Test_accy 70.66:  95%|█████████▌| 19/20 [03:47<00:10, 10.14s/it]Task 4, Epoch 20/20 => Loss 0.294, Train_accy 91.67, Test_accy 70.66: 100%|██████████| 20/20 [03:47<00:00, 13.21s/it]Task 4, Epoch 20/20 => Loss 0.294, Train_accy 91.67, Test_accy 70.66: 100%|██████████| 20/20 [03:47<00:00, 11.39s/it]
2024-04-29 19:08:30,614 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.294, Train_accy 91.67, Test_accy 70.66
2024-04-29 19:08:41,668 [trainer.py] => No NME accuracy.
2024-04-29 19:08:41,668 [trainer.py] => CNN: {'total': 70.66, '00-99': 89.15, '100-119': 48.2, '120-139': 45.45, '140-159': 50.89, '160-179': 46.46, 'old': 73.96, 'new': 46.46}
2024-04-29 19:08:41,669 [trainer.py] => CNN top1 curve: [89.24, 83.06, 77.55, 73.48, 70.66]
2024-04-29 19:08:41,669 [trainer.py] => CNN top5 curve: [99.23, 98.35, 97.06, 95.8, 94.56]

Average Accuracy (CNN): 78.8
2024-04-29 19:08:41,669 [trainer.py] => Average Accuracy (CNN): 78.8 

2024-04-29 19:08:41,669 [trainer.py] => Train Time: 3596.7400000000002
2024-04-29 19:08:41,669 [trainer.py] => Test Time: 43.84 

2024-04-29 19:08:41,671 [trainer.py] => All params: 89792456
2024-04-29 19:08:41,672 [trainer.py] => Trainable params: 89792456
2024-04-29 19:08:44,951 [coda_prompt.py] => Learning on 180-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.541, Train_accy 56.03:   0%|          | 0/20 [00:09<?, ?it/s]Task 5, Epoch 1/20 => Loss 1.541, Train_accy 56.03:   5%|▌         | 1/20 [00:09<02:54,  9.17s/it]Task 5, Epoch 2/20 => Loss 0.499, Train_accy 83.55:   5%|▌         | 1/20 [00:18<02:54,  9.17s/it]Task 5, Epoch 2/20 => Loss 0.499, Train_accy 83.55:  10%|█         | 2/20 [00:18<02:45,  9.20s/it]Task 5, Epoch 3/20 => Loss 0.377, Train_accy 88.38:  10%|█         | 2/20 [00:27<02:45,  9.20s/it]Task 5, Epoch 3/20 => Loss 0.377, Train_accy 88.38:  15%|█▌        | 3/20 [00:27<02:36,  9.23s/it]Task 5, Epoch 4/20 => Loss 0.278, Train_accy 91.01:  15%|█▌        | 3/20 [00:36<02:36,  9.23s/it]Task 5, Epoch 4/20 => Loss 0.278, Train_accy 91.01:  20%|██        | 4/20 [00:36<02:27,  9.20s/it]Task 5, Epoch 5/20 => Loss 0.281, Train_accy 91.01, Test_accy 71.80:  20%|██        | 4/20 [00:58<02:27,  9.20s/it]Task 5, Epoch 5/20 => Loss 0.281, Train_accy 91.01, Test_accy 71.80:  25%|██▌       | 5/20 [00:58<03:25, 13.70s/it]Task 5, Epoch 6/20 => Loss 0.283, Train_accy 90.68:  25%|██▌       | 5/20 [01:07<03:25, 13.70s/it]                 Task 5, Epoch 6/20 => Loss 0.283, Train_accy 90.68:  30%|███       | 6/20 [01:07<02:50, 12.18s/it]Task 5, Epoch 7/20 => Loss 0.241, Train_accy 92.32:  30%|███       | 6/20 [01:16<02:50, 12.18s/it]Task 5, Epoch 7/20 => Loss 0.241, Train_accy 92.32:  35%|███▌      | 7/20 [01:16<02:25, 11.16s/it]Task 5, Epoch 8/20 => Loss 0.229, Train_accy 92.32:  35%|███▌      | 7/20 [01:26<02:25, 11.16s/it]Task 5, Epoch 8/20 => Loss 0.229, Train_accy 92.32:  40%|████      | 8/20 [01:26<02:06, 10.57s/it]Task 5, Epoch 9/20 => Loss 0.217, Train_accy 93.42:  40%|████      | 8/20 [01:35<02:06, 10.57s/it]Task 5, Epoch 9/20 => Loss 0.217, Train_accy 93.42:  45%|████▌     | 9/20 [01:35<01:51, 10.15s/it]Task 5, Epoch 10/20 => Loss 0.172, Train_accy 95.07, Test_accy 71.97:  45%|████▌     | 9/20 [01:56<01:51, 10.15s/it]Task 5, Epoch 10/20 => Loss 0.172, Train_accy 95.07, Test_accy 71.97:  50%|█████     | 10/20 [01:56<02:16, 13.66s/it]Task 5, Epoch 11/20 => Loss 0.182, Train_accy 93.97:  50%|█████     | 10/20 [02:06<02:16, 13.66s/it]                 Task 5, Epoch 11/20 => Loss 0.182, Train_accy 93.97:  55%|█████▌    | 11/20 [02:06<01:50, 12.30s/it]Task 5, Epoch 12/20 => Loss 0.185, Train_accy 94.41:  55%|█████▌    | 11/20 [02:15<01:50, 12.30s/it]Task 5, Epoch 12/20 => Loss 0.185, Train_accy 94.41:  60%|██████    | 12/20 [02:15<01:30, 11.36s/it]Task 5, Epoch 13/20 => Loss 0.200, Train_accy 93.86:  60%|██████    | 12/20 [02:24<01:30, 11.36s/it]Task 5, Epoch 13/20 => Loss 0.200, Train_accy 93.86:  65%|██████▌   | 13/20 [02:24<01:14, 10.69s/it]Task 5, Epoch 14/20 => Loss 0.166, Train_accy 94.52:  65%|██████▌   | 13/20 [02:33<01:14, 10.69s/it]Task 5, Epoch 14/20 => Loss 0.166, Train_accy 94.52:  70%|███████   | 14/20 [02:33<01:01, 10.23s/it]Task 5, Epoch 15/20 => Loss 0.183, Train_accy 93.97, Test_accy 72.22:  70%|███████   | 14/20 [02:55<01:01, 10.23s/it]Task 5, Epoch 15/20 => Loss 0.183, Train_accy 93.97, Test_accy 72.22:  75%|███████▌  | 15/20 [02:55<01:08, 13.64s/it]Task 5, Epoch 16/20 => Loss 0.155, Train_accy 94.85:  75%|███████▌  | 15/20 [03:04<01:08, 13.64s/it]                 Task 5, Epoch 16/20 => Loss 0.155, Train_accy 94.85:  80%|████████  | 16/20 [03:04<00:49, 12.33s/it]Task 5, Epoch 17/20 => Loss 0.164, Train_accy 94.74:  80%|████████  | 16/20 [03:13<00:49, 12.33s/it]Task 5, Epoch 17/20 => Loss 0.164, Train_accy 94.74:  85%|████████▌ | 17/20 [03:13<00:34, 11.40s/it]Task 5, Epoch 18/20 => Loss 0.147, Train_accy 95.94:  85%|████████▌ | 17/20 [03:22<00:34, 11.40s/it]Task 5, Epoch 18/20 => Loss 0.147, Train_accy 95.94:  90%|█████████ | 18/20 [03:22<00:21, 10.72s/it]Task 5, Epoch 19/20 => Loss 0.154, Train_accy 94.96:  90%|█████████ | 18/20 [03:31<00:21, 10.72s/it]Task 5, Epoch 19/20 => Loss 0.154, Train_accy 94.96:  95%|█████████▌| 19/20 [03:31<00:10, 10.24s/it]Task 5, Epoch 20/20 => Loss 0.120, Train_accy 96.93, Test_accy 71.93:  95%|█████████▌| 19/20 [03:53<00:10, 10.24s/it]Task 5, Epoch 20/20 => Loss 0.120, Train_accy 96.93, Test_accy 71.93: 100%|██████████| 20/20 [03:53<00:00, 13.59s/it]Task 5, Epoch 20/20 => Loss 0.120, Train_accy 96.93, Test_accy 71.93: 100%|██████████| 20/20 [03:53<00:00, 11.66s/it]
2024-04-29 19:12:38,253 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.120, Train_accy 96.93, Test_accy 71.93
2024-04-29 19:12:50,802 [trainer.py] => No NME accuracy.
2024-04-29 19:12:50,802 [trainer.py] => CNN: {'total': 71.93, '00-99': 88.9, '100-119': 51.8, '120-139': 45.04, '140-159': 51.79, '160-179': 42.91, '180-199': 84.08, 'old': 70.52, 'new': 84.08}
2024-04-29 19:12:50,802 [trainer.py] => CNN top1 curve: [89.24, 83.06, 77.55, 73.48, 70.66, 71.93]
2024-04-29 19:12:50,802 [trainer.py] => CNN top5 curve: [99.23, 98.35, 97.06, 95.8, 94.56, 94.4]

Average Accuracy (CNN): 77.65
2024-04-29 19:12:50,802 [trainer.py] => Average Accuracy (CNN): 77.65 

2024-04-29 19:12:50,802 [trainer.py] => Train Time: 4063.3300000000004
2024-04-29 19:12:50,803 [trainer.py] => Test Time: 56.39 

Accuracy Matrix (CNN):
[[89.24 89.41 89.33 88.73 89.15 88.9 ]
 [ 0.   49.55 50.45 49.55 48.2  51.8 ]
 [ 0.    0.   45.45 45.04 45.45 45.04]
 [ 0.    0.    0.   48.21 50.89 51.79]
 [ 0.    0.    0.    0.   46.46 42.91]
 [ 0.    0.    0.    0.    0.   84.08]]
2024-04-29 19:12:50,803 [trainer.py] => Forgetting (CNN): 0.8939999999999998
2024-04-29 19:12:54,001 [trainer.py] => config: ./exps/simplecil_cub_B100_Inc5.json
2024-04-29 19:12:54,003 [trainer.py] => prefix:  
2024-04-29 19:12:54,003 [trainer.py] => dataset: cub
2024-04-29 19:12:54,003 [trainer.py] => memory_size: 0
2024-04-29 19:12:54,003 [trainer.py] => memory_per_class: 0
2024-04-29 19:12:54,004 [trainer.py] => fixed_memory: False
2024-04-29 19:12:54,004 [trainer.py] => shuffle: True
2024-04-29 19:12:54,004 [trainer.py] => init_cls: 100
2024-04-29 19:12:54,004 [trainer.py] => increment: 20
2024-04-29 19:12:54,004 [trainer.py] => model_name: simplecil
2024-04-29 19:12:54,004 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-04-29 19:12:54,004 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-29 19:12:54,004 [trainer.py] => seed: 1993
2024-04-29 19:12:54,004 [trainer.py] => tuned_epoch: 20
2024-04-29 19:12:54,004 [trainer.py] => init_lr: 0.01
2024-04-29 19:12:54,004 [trainer.py] => batch_size: 256
2024-04-29 19:12:54,004 [trainer.py] => weight_decay: 0.05
2024-04-29 19:12:54,004 [trainer.py] => min_lr: 1e-08
2024-04-29 19:12:54,004 [trainer.py] => optimizer: sgd
2024-04-29 19:12:54,004 [trainer.py] => vpt_type: shallow
2024-04-29 19:12:54,004 [trainer.py] => prompt_token_num: 3
2024-04-29 19:12:54,058 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-29 19:13:01,646 [trainer.py] => All params: 85798656
2024-04-29 19:13:01,647 [trainer.py] => Trainable params: 85798656
2024-04-29 19:13:02,051 [simplecil.py] => Learning on 0-100
2024-04-29 19:13:23,791 [trainer.py] => No NME accuracy.
2024-04-29 19:13:23,792 [trainer.py] => CNN: {'total': 91.16, '00-99': 91.16, 'old': 0, 'new': 91.16}
2024-04-29 19:13:23,792 [trainer.py] => CNN top1 curve: [91.16]
2024-04-29 19:13:23,792 [trainer.py] => CNN top5 curve: [98.99]

Average Accuracy (CNN): 91.16
2024-04-29 19:13:23,792 [trainer.py] => Average Accuracy (CNN): 91.16 

2024-04-29 19:13:23,792 [trainer.py] => Train Time: 17.4
2024-04-29 19:13:23,792 [trainer.py] => Test Time: 4.33 

2024-04-29 19:13:23,794 [trainer.py] => All params: 85875457
2024-04-29 19:13:23,795 [trainer.py] => Trainable params: 85875457
2024-04-29 19:13:23,798 [simplecil.py] => Learning on 100-120
2024-04-29 19:13:33,365 [trainer.py] => No NME accuracy.
2024-04-29 19:13:33,365 [trainer.py] => CNN: {'total': 88.91, '00-99': 89.56, '100-119': 85.53, 'old': 89.56, 'new': 85.53}
2024-04-29 19:13:33,365 [trainer.py] => CNN top1 curve: [91.16, 88.91]
2024-04-29 19:13:33,365 [trainer.py] => CNN top5 curve: [98.99, 98.73]

Average Accuracy (CNN): 90.04
2024-04-29 19:13:33,365 [trainer.py] => Average Accuracy (CNN): 90.04 

2024-04-29 19:13:33,365 [trainer.py] => Train Time: 22.25
2024-04-29 19:13:33,365 [trainer.py] => Test Time: 9.030000000000001 

2024-04-29 19:13:33,366 [trainer.py] => All params: 85890817
2024-04-29 19:13:33,367 [trainer.py] => Trainable params: 85890817
2024-04-29 19:13:33,369 [simplecil.py] => Learning on 120-140
2024-04-29 19:13:43,840 [trainer.py] => No NME accuracy.
2024-04-29 19:13:43,840 [trainer.py] => CNN: {'total': 87.2, '00-99': 88.64, '100-119': 84.65, '120-139': 82.22, 'old': 87.99, 'new': 82.22}
2024-04-29 19:13:43,840 [trainer.py] => CNN top1 curve: [91.16, 88.91, 87.2]
2024-04-29 19:13:43,840 [trainer.py] => CNN top5 curve: [98.99, 98.73, 98.6]

Average Accuracy (CNN): 89.09
2024-04-29 19:13:43,840 [trainer.py] => Average Accuracy (CNN): 89.09 

2024-04-29 19:13:43,840 [trainer.py] => Train Time: 27.29
2024-04-29 19:13:43,840 [trainer.py] => Test Time: 14.450000000000001 

2024-04-29 19:13:43,841 [trainer.py] => All params: 85906177
2024-04-29 19:13:43,842 [trainer.py] => Trainable params: 85906177
2024-04-29 19:13:43,845 [simplecil.py] => Learning on 140-160
2024-04-29 19:13:54,656 [trainer.py] => No NME accuracy.
2024-04-29 19:13:54,656 [trainer.py] => CNN: {'total': 86.62, '00-99': 87.29, '100-119': 83.77, '120-139': 82.22, '140-159': 90.0, 'old': 86.11, 'new': 90.0}
2024-04-29 19:13:54,656 [trainer.py] => CNN top1 curve: [91.16, 88.91, 87.2, 86.62]
2024-04-29 19:13:54,656 [trainer.py] => CNN top5 curve: [98.99, 98.73, 98.6, 98.41]

Average Accuracy (CNN): 88.47
2024-04-29 19:13:54,656 [trainer.py] => Average Accuracy (CNN): 88.47 

2024-04-29 19:13:54,656 [trainer.py] => Train Time: 31.939999999999998
2024-04-29 19:13:54,656 [trainer.py] => Test Time: 20.6 

2024-04-29 19:13:54,657 [trainer.py] => All params: 85921537
2024-04-29 19:13:54,658 [trainer.py] => Trainable params: 85921537
2024-04-29 19:13:54,660 [simplecil.py] => Learning on 160-180
2024-04-29 19:14:05,564 [trainer.py] => No NME accuracy.
2024-04-29 19:14:05,565 [trainer.py] => CNN: {'total': 86.23, '00-99': 86.53, '100-119': 83.33, '120-139': 82.22, '140-159': 88.8, '160-179': 88.61, 'old': 85.93, 'new': 88.61}
2024-04-29 19:14:05,565 [trainer.py] => CNN top1 curve: [91.16, 88.91, 87.2, 86.62, 86.23]
2024-04-29 19:14:05,565 [trainer.py] => CNN top5 curve: [98.99, 98.73, 98.6, 98.41, 98.17]

Average Accuracy (CNN): 88.02
2024-04-29 19:14:05,565 [trainer.py] => Average Accuracy (CNN): 88.02 

2024-04-29 19:14:05,565 [trainer.py] => Train Time: 36.379999999999995
2024-04-29 19:14:05,565 [trainer.py] => Test Time: 27.060000000000002 

2024-04-29 19:14:05,566 [trainer.py] => All params: 85936897
2024-04-29 19:14:05,567 [trainer.py] => Trainable params: 85936897
2024-04-29 19:14:05,570 [simplecil.py] => Learning on 180-200
2024-04-29 19:14:17,155 [trainer.py] => No NME accuracy.
2024-04-29 19:14:17,155 [trainer.py] => CNN: {'total': 85.24, '00-99': 85.61, '100-119': 83.33, '120-139': 81.78, '140-159': 88.8, '160-179': 86.92, '180-199': 83.04, 'old': 85.48, 'new': 83.04}
2024-04-29 19:14:17,155 [trainer.py] => CNN top1 curve: [91.16, 88.91, 87.2, 86.62, 86.23, 85.24]
2024-04-29 19:14:17,155 [trainer.py] => CNN top5 curve: [98.99, 98.73, 98.6, 98.41, 98.17, 97.79]

Average Accuracy (CNN): 87.56
2024-04-29 19:14:17,155 [trainer.py] => Average Accuracy (CNN): 87.56 

2024-04-29 19:14:17,155 [trainer.py] => Train Time: 40.74999999999999
2024-04-29 19:14:17,155 [trainer.py] => Test Time: 34.27 

Accuracy Matrix (CNN):
[[91.16 89.56 88.64 87.29 86.53 85.61]
 [ 0.   85.53 84.65 83.77 83.33 83.33]
 [ 0.    0.   82.22 82.22 82.22 81.78]
 [ 0.    0.    0.   90.   88.8  88.8 ]
 [ 0.    0.    0.    0.   88.61 86.92]
 [ 0.    0.    0.    0.    0.   83.04]]
2024-04-29 19:14:17,156 [trainer.py] => Forgetting (CNN): 2.2159999999999997
2024-04-29 19:14:20,257 [trainer.py] => config: ./exps/ease_cub_B100_Inc5.json
2024-04-29 19:14:20,257 [trainer.py] => prefix:  
2024-04-29 19:14:20,257 [trainer.py] => dataset: cub
2024-04-29 19:14:20,257 [trainer.py] => memory_size: 0
2024-04-29 19:14:20,257 [trainer.py] => memory_per_class: 0
2024-04-29 19:14:20,257 [trainer.py] => fixed_memory: False
2024-04-29 19:14:20,257 [trainer.py] => shuffle: True
2024-04-29 19:14:20,257 [trainer.py] => init_cls: 100
2024-04-29 19:14:20,257 [trainer.py] => increment: 20
2024-04-29 19:14:20,257 [trainer.py] => model_name: ease
2024-04-29 19:14:20,258 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-04-29 19:14:20,258 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-29 19:14:20,258 [trainer.py] => seed: 1993
2024-04-29 19:14:20,258 [trainer.py] => init_epochs: 20
2024-04-29 19:14:20,258 [trainer.py] => init_lr: 0.025
2024-04-29 19:14:20,258 [trainer.py] => later_epochs: 20
2024-04-29 19:14:20,258 [trainer.py] => later_lr: 0.025
2024-04-29 19:14:20,258 [trainer.py] => batch_size: 48
2024-04-29 19:14:20,258 [trainer.py] => weight_decay: 0.0005
2024-04-29 19:14:20,258 [trainer.py] => min_lr: 0
2024-04-29 19:14:20,258 [trainer.py] => optimizer: sgd
2024-04-29 19:14:20,258 [trainer.py] => scheduler: cosine
2024-04-29 19:14:20,258 [trainer.py] => pretrained: True
2024-04-29 19:14:20,258 [trainer.py] => vpt_type: Deep
2024-04-29 19:14:20,258 [trainer.py] => prompt_token_num: 5
2024-04-29 19:14:20,258 [trainer.py] => ffn_num: 64
2024-04-29 19:14:20,258 [trainer.py] => use_diagonal: False
2024-04-29 19:14:20,258 [trainer.py] => recalc_sim: True
2024-04-29 19:14:20,258 [trainer.py] => alpha: 0.1
2024-04-29 19:14:20,258 [trainer.py] => use_init_ptm: False
2024-04-29 19:14:20,258 [trainer.py] => beta: 0
2024-04-29 19:14:20,258 [trainer.py] => use_old_data: False
2024-04-29 19:14:20,258 [trainer.py] => use_reweight: True
2024-04-29 19:14:20,258 [trainer.py] => moni_adam: False
2024-04-29 19:14:20,258 [trainer.py] => adapter_num: -1
2024-04-29 19:14:20,298 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
_IncompatibleKeys(missing_keys=['cur_adapter.0.down_proj.weight', 'cur_adapter.0.down_proj.bias', 'cur_adapter.0.up_proj.weight', 'cur_adapter.0.up_proj.bias', 'cur_adapter.1.down_proj.weight', 'cur_adapter.1.down_proj.bias', 'cur_adapter.1.up_proj.weight', 'cur_adapter.1.up_proj.bias', 'cur_adapter.2.down_proj.weight', 'cur_adapter.2.down_proj.bias', 'cur_adapter.2.up_proj.weight', 'cur_adapter.2.up_proj.bias', 'cur_adapter.3.down_proj.weight', 'cur_adapter.3.down_proj.bias', 'cur_adapter.3.up_proj.weight', 'cur_adapter.3.up_proj.bias', 'cur_adapter.4.down_proj.weight', 'cur_adapter.4.down_proj.bias', 'cur_adapter.4.up_proj.weight', 'cur_adapter.4.up_proj.bias', 'cur_adapter.5.down_proj.weight', 'cur_adapter.5.down_proj.bias', 'cur_adapter.5.up_proj.weight', 'cur_adapter.5.up_proj.bias', 'cur_adapter.6.down_proj.weight', 'cur_adapter.6.down_proj.bias', 'cur_adapter.6.up_proj.weight', 'cur_adapter.6.up_proj.bias', 'cur_adapter.7.down_proj.weight', 'cur_adapter.7.down_proj.bias', 'cur_adapter.7.up_proj.weight', 'cur_adapter.7.up_proj.bias', 'cur_adapter.8.down_proj.weight', 'cur_adapter.8.down_proj.bias', 'cur_adapter.8.up_proj.weight', 'cur_adapter.8.up_proj.bias', 'cur_adapter.9.down_proj.weight', 'cur_adapter.9.down_proj.bias', 'cur_adapter.9.up_proj.weight', 'cur_adapter.9.up_proj.bias', 'cur_adapter.10.down_proj.weight', 'cur_adapter.10.down_proj.bias', 'cur_adapter.10.up_proj.weight', 'cur_adapter.10.up_proj.bias', 'cur_adapter.11.down_proj.weight', 'cur_adapter.11.down_proj.bias', 'cur_adapter.11.up_proj.weight', 'cur_adapter.11.up_proj.bias'], unexpected_keys=[])
After BaseNet initialization.
2024-04-29 19:14:30,194 [trainer.py] => All params: 86988288
2024-04-29 19:14:30,195 [trainer.py] => Trainable params: 1189632
2024-04-29 19:14:30,211 [ease.py] => Learning on 0-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 4.402, Train_accy 34.11:   0%|          | 0/20 [00:25<?, ?it/s]Task 0, Epoch 1/20 => Loss 4.402, Train_accy 34.11:   5%|▌         | 1/20 [00:25<07:58, 25.18s/it]Task 0, Epoch 2/20 => Loss 1.935, Train_accy 75.14:   5%|▌         | 1/20 [00:50<07:58, 25.18s/it]Task 0, Epoch 2/20 => Loss 1.935, Train_accy 75.14:  10%|█         | 2/20 [00:50<07:29, 24.97s/it]Task 0, Epoch 3/20 => Loss 0.708, Train_accy 85.51:  10%|█         | 2/20 [01:15<07:29, 24.97s/it]Task 0, Epoch 3/20 => Loss 0.708, Train_accy 85.51:  15%|█▌        | 3/20 [01:15<07:04, 25.00s/it]Task 0, Epoch 4/20 => Loss 0.598, Train_accy 86.88:  15%|█▌        | 3/20 [01:39<07:04, 25.00s/it]Task 0, Epoch 4/20 => Loss 0.598, Train_accy 86.88:  20%|██        | 4/20 [01:39<06:38, 24.91s/it]Task 0, Epoch 5/20 => Loss 0.541, Train_accy 87.81:  20%|██        | 4/20 [02:04<06:38, 24.91s/it]Task 0, Epoch 5/20 => Loss 0.541, Train_accy 87.81:  25%|██▌       | 5/20 [02:04<06:13, 24.87s/it]Task 0, Epoch 6/20 => Loss 0.487, Train_accy 88.22:  25%|██▌       | 5/20 [02:29<06:13, 24.87s/it]Task 0, Epoch 6/20 => Loss 0.487, Train_accy 88.22:  30%|███       | 6/20 [02:29<05:47, 24.85s/it]Task 0, Epoch 7/20 => Loss 0.485, Train_accy 88.71:  30%|███       | 6/20 [02:54<05:47, 24.85s/it]Task 0, Epoch 7/20 => Loss 0.485, Train_accy 88.71:  35%|███▌      | 7/20 [02:54<05:22, 24.84s/it]Task 0, Epoch 8/20 => Loss 0.433, Train_accy 89.99:  35%|███▌      | 7/20 [03:19<05:22, 24.84s/it]Task 0, Epoch 8/20 => Loss 0.433, Train_accy 89.99:  40%|████      | 8/20 [03:19<04:58, 24.86s/it]Task 0, Epoch 9/20 => Loss 0.450, Train_accy 89.75:  40%|████      | 8/20 [03:43<04:58, 24.86s/it]Task 0, Epoch 9/20 => Loss 0.450, Train_accy 89.75:  45%|████▌     | 9/20 [03:43<04:33, 24.84s/it]Task 0, Epoch 10/20 => Loss 0.432, Train_accy 89.92:  45%|████▌     | 9/20 [04:08<04:33, 24.84s/it]Task 0, Epoch 10/20 => Loss 0.432, Train_accy 89.92:  50%|█████     | 10/20 [04:08<04:08, 24.84s/it]Task 0, Epoch 11/20 => Loss 0.396, Train_accy 91.24:  50%|█████     | 10/20 [04:33<04:08, 24.84s/it]Task 0, Epoch 11/20 => Loss 0.396, Train_accy 91.24:  55%|█████▌    | 11/20 [04:33<03:43, 24.80s/it]Task 0, Epoch 12/20 => Loss 0.402, Train_accy 90.52:  55%|█████▌    | 11/20 [04:58<03:43, 24.80s/it]Task 0, Epoch 12/20 => Loss 0.402, Train_accy 90.52:  60%|██████    | 12/20 [04:58<03:18, 24.83s/it]Task 0, Epoch 13/20 => Loss 0.387, Train_accy 91.03:  60%|██████    | 12/20 [05:23<03:18, 24.83s/it]Task 0, Epoch 13/20 => Loss 0.387, Train_accy 91.03:  65%|██████▌   | 13/20 [05:23<02:53, 24.82s/it]Task 0, Epoch 14/20 => Loss 0.385, Train_accy 90.95:  65%|██████▌   | 13/20 [05:48<02:53, 24.82s/it]Task 0, Epoch 14/20 => Loss 0.385, Train_accy 90.95:  70%|███████   | 14/20 [05:48<02:29, 24.87s/it]Task 0, Epoch 15/20 => Loss 0.376, Train_accy 91.56:  70%|███████   | 14/20 [06:13<02:29, 24.87s/it]Task 0, Epoch 15/20 => Loss 0.376, Train_accy 91.56:  75%|███████▌  | 15/20 [06:13<02:04, 24.88s/it]Task 0, Epoch 16/20 => Loss 0.364, Train_accy 91.48:  75%|███████▌  | 15/20 [06:37<02:04, 24.88s/it]Task 0, Epoch 16/20 => Loss 0.364, Train_accy 91.48:  80%|████████  | 16/20 [06:37<01:39, 24.83s/it]Task 0, Epoch 17/20 => Loss 0.372, Train_accy 91.80:  80%|████████  | 16/20 [07:02<01:39, 24.83s/it]Task 0, Epoch 17/20 => Loss 0.372, Train_accy 91.80:  85%|████████▌ | 17/20 [07:02<01:14, 24.79s/it]Task 0, Epoch 18/20 => Loss 0.364, Train_accy 91.50:  85%|████████▌ | 17/20 [07:27<01:14, 24.79s/it]Task 0, Epoch 18/20 => Loss 0.364, Train_accy 91.50:  90%|█████████ | 18/20 [07:27<00:49, 24.83s/it]Task 0, Epoch 19/20 => Loss 0.382, Train_accy 91.33:  90%|█████████ | 18/20 [07:52<00:49, 24.83s/it]Task 0, Epoch 19/20 => Loss 0.382, Train_accy 91.33:  95%|█████████▌| 19/20 [07:52<00:24, 24.77s/it]Task 0, Epoch 20/20 => Loss 0.355, Train_accy 92.10:  95%|█████████▌| 19/20 [08:16<00:24, 24.77s/it]Task 0, Epoch 20/20 => Loss 0.355, Train_accy 92.10: 100%|██████████| 20/20 [08:16<00:00, 24.78s/it]Task 0, Epoch 20/20 => Loss 0.355, Train_accy 92.10: 100%|██████████| 20/20 [08:16<00:00, 24.84s/it]
2024-04-29 19:22:47,140 [ease.py] => Task 0, Epoch 20/20 => Loss 0.355, Train_accy 92.10
2024-04-29 19:23:10,136 [ease.py] => Task correct: 94.02356902356902
2024-04-29 19:23:10,136 [ease.py] => Task acc: 97.39057239057239
2024-04-29 19:23:10,360 [trainer.py] => No NME accuracy.
2024-04-29 19:23:10,360 [trainer.py] => CNN: {'total': 93.27, '00-99': 93.27, 'old': 0, 'new': 93.27}
2024-04-29 19:23:10,360 [trainer.py] => CNN top1 curve: [93.27]
2024-04-29 19:23:10,360 [trainer.py] => CNN top5 curve: [98.91]

Average Accuracy (CNN): 93.27
2024-04-29 19:23:10,360 [trainer.py] => Average Accuracy (CNN): 93.27 

2024-04-29 19:23:10,360 [trainer.py] => Train Time: 993.75
2024-04-29 19:23:10,360 [trainer.py] => Test Time: 4.15 

2024-04-29 19:23:10,361 [trainer.py] => All params: 87141890
2024-04-29 19:23:10,362 [trainer.py] => Trainable params: 1189632
2024-04-29 19:23:10,365 [ease.py] => Learning on 100-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.956, Train_accy 26.89:   0%|          | 0/20 [00:05<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.956, Train_accy 26.89:   5%|▌         | 1/20 [00:05<01:41,  5.36s/it]Task 1, Epoch 2/20 => Loss 2.717, Train_accy 83.82:   5%|▌         | 1/20 [00:10<01:41,  5.36s/it]Task 1, Epoch 2/20 => Loss 2.717, Train_accy 83.82:  10%|█         | 2/20 [00:10<01:37,  5.44s/it]Task 1, Epoch 3/20 => Loss 2.125, Train_accy 91.70:  10%|█         | 2/20 [00:16<01:37,  5.44s/it]Task 1, Epoch 3/20 => Loss 2.125, Train_accy 91.70:  15%|█▌        | 3/20 [00:16<01:32,  5.45s/it]Task 1, Epoch 4/20 => Loss 1.279, Train_accy 94.22:  15%|█▌        | 3/20 [00:21<01:32,  5.45s/it]Task 1, Epoch 4/20 => Loss 1.279, Train_accy 94.22:  20%|██        | 4/20 [00:21<01:26,  5.43s/it]Task 1, Epoch 5/20 => Loss 0.677, Train_accy 95.27:  20%|██        | 4/20 [00:27<01:26,  5.43s/it]Task 1, Epoch 5/20 => Loss 0.677, Train_accy 95.27:  25%|██▌       | 5/20 [00:27<01:21,  5.45s/it]Task 1, Epoch 6/20 => Loss 0.454, Train_accy 95.48:  25%|██▌       | 5/20 [00:32<01:21,  5.45s/it]Task 1, Epoch 6/20 => Loss 0.454, Train_accy 95.48:  30%|███       | 6/20 [00:32<01:16,  5.44s/it]Task 1, Epoch 7/20 => Loss 0.363, Train_accy 94.64:  30%|███       | 6/20 [00:38<01:16,  5.44s/it]Task 1, Epoch 7/20 => Loss 0.363, Train_accy 94.64:  35%|███▌      | 7/20 [00:38<01:10,  5.44s/it]Task 1, Epoch 8/20 => Loss 0.335, Train_accy 94.75:  35%|███▌      | 7/20 [00:43<01:10,  5.44s/it]Task 1, Epoch 8/20 => Loss 0.335, Train_accy 94.75:  40%|████      | 8/20 [00:43<01:05,  5.44s/it]Task 1, Epoch 9/20 => Loss 0.294, Train_accy 95.06:  40%|████      | 8/20 [00:48<01:05,  5.44s/it]Task 1, Epoch 9/20 => Loss 0.294, Train_accy 95.06:  45%|████▌     | 9/20 [00:48<00:59,  5.42s/it]Task 1, Epoch 10/20 => Loss 0.262, Train_accy 95.90:  45%|████▌     | 9/20 [00:54<00:59,  5.42s/it]Task 1, Epoch 10/20 => Loss 0.262, Train_accy 95.90:  50%|█████     | 10/20 [00:54<00:54,  5.46s/it]Task 1, Epoch 11/20 => Loss 0.250, Train_accy 95.80:  50%|█████     | 10/20 [00:59<00:54,  5.46s/it]Task 1, Epoch 11/20 => Loss 0.250, Train_accy 95.80:  55%|█████▌    | 11/20 [00:59<00:49,  5.49s/it]Task 1, Epoch 12/20 => Loss 0.235, Train_accy 95.59:  55%|█████▌    | 11/20 [01:05<00:49,  5.49s/it]Task 1, Epoch 12/20 => Loss 0.235, Train_accy 95.59:  60%|██████    | 12/20 [01:05<00:44,  5.50s/it]Task 1, Epoch 13/20 => Loss 0.264, Train_accy 94.43:  60%|██████    | 12/20 [01:11<00:44,  5.50s/it]Task 1, Epoch 13/20 => Loss 0.264, Train_accy 94.43:  65%|██████▌   | 13/20 [01:11<00:38,  5.51s/it]Task 1, Epoch 14/20 => Loss 0.215, Train_accy 95.90:  65%|██████▌   | 13/20 [01:16<00:38,  5.51s/it]Task 1, Epoch 14/20 => Loss 0.215, Train_accy 95.90:  70%|███████   | 14/20 [01:16<00:33,  5.51s/it]Task 1, Epoch 15/20 => Loss 0.261, Train_accy 94.96:  70%|███████   | 14/20 [01:21<00:33,  5.51s/it]Task 1, Epoch 15/20 => Loss 0.261, Train_accy 94.96:  75%|███████▌  | 15/20 [01:21<00:27,  5.47s/it]Task 1, Epoch 16/20 => Loss 0.206, Train_accy 96.43:  75%|███████▌  | 15/20 [01:27<00:27,  5.47s/it]Task 1, Epoch 16/20 => Loss 0.206, Train_accy 96.43:  80%|████████  | 16/20 [01:27<00:21,  5.43s/it]Task 1, Epoch 17/20 => Loss 0.219, Train_accy 96.22:  80%|████████  | 16/20 [01:32<00:21,  5.43s/it]Task 1, Epoch 17/20 => Loss 0.219, Train_accy 96.22:  85%|████████▌ | 17/20 [01:32<00:16,  5.45s/it]Task 1, Epoch 18/20 => Loss 0.217, Train_accy 96.01:  85%|████████▌ | 17/20 [01:38<00:16,  5.45s/it]Task 1, Epoch 18/20 => Loss 0.217, Train_accy 96.01:  90%|█████████ | 18/20 [01:38<00:10,  5.47s/it]Task 1, Epoch 19/20 => Loss 0.223, Train_accy 95.80:  90%|█████████ | 18/20 [01:43<00:10,  5.47s/it]Task 1, Epoch 19/20 => Loss 0.223, Train_accy 95.80:  95%|█████████▌| 19/20 [01:43<00:05,  5.48s/it]Task 1, Epoch 20/20 => Loss 0.215, Train_accy 95.69:  95%|█████████▌| 19/20 [01:49<00:05,  5.48s/it]Task 1, Epoch 20/20 => Loss 0.215, Train_accy 95.69: 100%|██████████| 20/20 [01:49<00:00,  5.43s/it]Task 1, Epoch 20/20 => Loss 0.215, Train_accy 95.69: 100%|██████████| 20/20 [01:49<00:00,  5.45s/it]
2024-04-29 19:24:59,483 [ease.py] => Task 1, Epoch 20/20 => Loss 0.215, Train_accy 95.69
2024-04-29 19:25:16,670 [ease.py] => Task correct: 86.79378531073446
2024-04-29 19:25:16,670 [ease.py] => Task acc: 97.45762711864407
2024-04-29 19:25:16,964 [trainer.py] => No NME accuracy.
2024-04-29 19:25:16,964 [trainer.py] => CNN: {'total': 86.09, '00-99': 84.26, '100-119': 95.61, 'old': 84.26, 'new': 95.61}
2024-04-29 19:25:16,965 [trainer.py] => CNN top1 curve: [93.27, 86.09]
2024-04-29 19:25:16,965 [trainer.py] => CNN top5 curve: [98.91, 98.94]

Average Accuracy (CNN): 89.68
2024-04-29 19:25:16,965 [trainer.py] => Average Accuracy (CNN): 89.68 

2024-04-29 19:25:16,965 [trainer.py] => Train Time: 1211.9599999999998
2024-04-29 19:25:16,965 [trainer.py] => Test Time: 12.18 

2024-04-29 19:25:16,966 [trainer.py] => All params: 87187970
2024-04-29 19:25:16,966 [trainer.py] => Trainable params: 1189632
2024-04-29 19:25:16,971 [ease.py] => Learning on 120-140
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.961, Train_accy 21.91:   0%|          | 0/20 [00:05<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.961, Train_accy 21.91:   5%|▌         | 1/20 [00:05<01:44,  5.51s/it]Task 2, Epoch 2/20 => Loss 2.747, Train_accy 62.68:   5%|▌         | 1/20 [00:11<01:44,  5.51s/it]Task 2, Epoch 2/20 => Loss 2.747, Train_accy 62.68:  10%|█         | 2/20 [00:11<01:39,  5.52s/it]Task 2, Epoch 3/20 => Loss 2.253, Train_accy 78.41:  10%|█         | 2/20 [00:16<01:39,  5.52s/it]Task 2, Epoch 3/20 => Loss 2.253, Train_accy 78.41:  15%|█▌        | 3/20 [00:16<01:33,  5.50s/it]Task 2, Epoch 4/20 => Loss 1.531, Train_accy 85.22:  15%|█▌        | 3/20 [00:21<01:33,  5.50s/it]Task 2, Epoch 4/20 => Loss 1.531, Train_accy 85.22:  20%|██        | 4/20 [00:21<01:27,  5.45s/it]Task 2, Epoch 5/20 => Loss 0.989, Train_accy 85.74:  20%|██        | 4/20 [00:27<01:27,  5.45s/it]Task 2, Epoch 5/20 => Loss 0.989, Train_accy 85.74:  25%|██▌       | 5/20 [00:27<01:21,  5.45s/it]Task 2, Epoch 6/20 => Loss 0.748, Train_accy 87.32:  25%|██▌       | 5/20 [00:32<01:21,  5.45s/it]Task 2, Epoch 6/20 => Loss 0.748, Train_accy 87.32:  30%|███       | 6/20 [00:32<01:17,  5.50s/it]Task 2, Epoch 7/20 => Loss 0.608, Train_accy 88.47:  30%|███       | 6/20 [00:38<01:17,  5.50s/it]Task 2, Epoch 7/20 => Loss 0.608, Train_accy 88.47:  35%|███▌      | 7/20 [00:38<01:11,  5.51s/it]Task 2, Epoch 8/20 => Loss 0.522, Train_accy 90.15:  35%|███▌      | 7/20 [00:44<01:11,  5.51s/it]Task 2, Epoch 8/20 => Loss 0.522, Train_accy 90.15:  40%|████      | 8/20 [00:44<01:06,  5.54s/it]Task 2, Epoch 9/20 => Loss 0.463, Train_accy 90.67:  40%|████      | 8/20 [00:49<01:06,  5.54s/it]Task 2, Epoch 9/20 => Loss 0.463, Train_accy 90.67:  45%|████▌     | 9/20 [00:49<01:00,  5.53s/it]Task 2, Epoch 10/20 => Loss 0.460, Train_accy 91.72:  45%|████▌     | 9/20 [00:54<01:00,  5.53s/it]Task 2, Epoch 10/20 => Loss 0.460, Train_accy 91.72:  50%|█████     | 10/20 [00:54<00:54,  5.48s/it]Task 2, Epoch 11/20 => Loss 0.451, Train_accy 91.19:  50%|█████     | 10/20 [01:00<00:54,  5.48s/it]Task 2, Epoch 11/20 => Loss 0.451, Train_accy 91.19:  55%|█████▌    | 11/20 [01:00<00:49,  5.46s/it]Task 2, Epoch 12/20 => Loss 0.437, Train_accy 89.62:  55%|█████▌    | 11/20 [01:05<00:49,  5.46s/it]Task 2, Epoch 12/20 => Loss 0.437, Train_accy 89.62:  60%|██████    | 12/20 [01:05<00:43,  5.47s/it]Task 2, Epoch 13/20 => Loss 0.402, Train_accy 92.03:  60%|██████    | 12/20 [01:11<00:43,  5.47s/it]Task 2, Epoch 13/20 => Loss 0.402, Train_accy 92.03:  65%|██████▌   | 13/20 [01:11<00:38,  5.45s/it]Task 2, Epoch 14/20 => Loss 0.392, Train_accy 92.03:  65%|██████▌   | 13/20 [01:16<00:38,  5.45s/it]Task 2, Epoch 14/20 => Loss 0.392, Train_accy 92.03:  70%|███████   | 14/20 [01:16<00:32,  5.47s/it]Task 2, Epoch 15/20 => Loss 0.430, Train_accy 90.36:  70%|███████   | 14/20 [01:22<00:32,  5.47s/it]Task 2, Epoch 15/20 => Loss 0.430, Train_accy 90.36:  75%|███████▌  | 15/20 [01:22<00:27,  5.44s/it]Task 2, Epoch 16/20 => Loss 0.388, Train_accy 92.24:  75%|███████▌  | 15/20 [01:27<00:27,  5.44s/it]Task 2, Epoch 16/20 => Loss 0.388, Train_accy 92.24:  80%|████████  | 16/20 [01:27<00:21,  5.46s/it]Task 2, Epoch 17/20 => Loss 0.393, Train_accy 91.72:  80%|████████  | 16/20 [01:33<00:21,  5.46s/it]Task 2, Epoch 17/20 => Loss 0.393, Train_accy 91.72:  85%|████████▌ | 17/20 [01:33<00:16,  5.48s/it]Task 2, Epoch 18/20 => Loss 0.392, Train_accy 92.24:  85%|████████▌ | 17/20 [01:38<00:16,  5.48s/it]Task 2, Epoch 18/20 => Loss 0.392, Train_accy 92.24:  90%|█████████ | 18/20 [01:38<00:10,  5.50s/it]Task 2, Epoch 19/20 => Loss 0.369, Train_accy 92.77:  90%|█████████ | 18/20 [01:44<00:10,  5.50s/it]Task 2, Epoch 19/20 => Loss 0.369, Train_accy 92.77:  95%|█████████▌| 19/20 [01:44<00:05,  5.48s/it]Task 2, Epoch 20/20 => Loss 0.388, Train_accy 91.09:  95%|█████████▌| 19/20 [01:49<00:05,  5.48s/it]Task 2, Epoch 20/20 => Loss 0.388, Train_accy 91.09: 100%|██████████| 20/20 [01:49<00:00,  5.50s/it]Task 2, Epoch 20/20 => Loss 0.388, Train_accy 91.09: 100%|██████████| 20/20 [01:49<00:00,  5.48s/it]
2024-04-29 19:27:06,667 [ease.py] => Task 2, Epoch 20/20 => Loss 0.388, Train_accy 91.09
2024-04-29 19:27:33,040 [ease.py] => Task correct: 85.07007921998782
2024-04-29 19:27:33,040 [ease.py] => Task acc: 96.7702620353443
2024-04-29 19:27:33,248 [trainer.py] => No NME accuracy.
2024-04-29 19:27:33,248 [trainer.py] => CNN: {'total': 83.79, '00-99': 80.64, '100-119': 95.18, '120-139': 88.89, 'old': 82.98, 'new': 88.89}
2024-04-29 19:27:33,248 [trainer.py] => CNN top1 curve: [93.27, 86.09, 83.79]
2024-04-29 19:27:33,248 [trainer.py] => CNN top5 curve: [98.91, 98.94, 98.72]

Average Accuracy (CNN): 87.72
2024-04-29 19:27:33,248 [trainer.py] => Average Accuracy (CNN): 87.72 

2024-04-29 19:27:33,248 [trainer.py] => Train Time: 1431.34
2024-04-29 19:27:33,248 [trainer.py] => Test Time: 25.48 

2024-04-29 19:27:33,249 [trainer.py] => All params: 87326210
2024-04-29 19:27:33,250 [trainer.py] => Trainable params: 1189632
2024-04-29 19:27:33,258 [ease.py] => Learning on 140-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.956, Train_accy 27.83:   0%|          | 0/20 [00:05<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.956, Train_accy 27.83:   5%|▌         | 1/20 [00:05<01:39,  5.26s/it]Task 3, Epoch 2/20 => Loss 2.727, Train_accy 81.20:   5%|▌         | 1/20 [00:10<01:39,  5.26s/it]Task 3, Epoch 2/20 => Loss 2.727, Train_accy 81.20:  10%|█         | 2/20 [00:10<01:34,  5.28s/it]Task 3, Epoch 3/20 => Loss 2.193, Train_accy 89.24:  10%|█         | 2/20 [00:15<01:34,  5.28s/it]Task 3, Epoch 3/20 => Loss 2.193, Train_accy 89.24:  15%|█▌        | 3/20 [00:15<01:30,  5.31s/it]Task 3, Epoch 4/20 => Loss 1.378, Train_accy 93.26:  15%|█▌        | 3/20 [00:21<01:30,  5.31s/it]Task 3, Epoch 4/20 => Loss 1.378, Train_accy 93.26:  20%|██        | 4/20 [00:21<01:25,  5.31s/it]Task 3, Epoch 5/20 => Loss 0.823, Train_accy 93.15:  20%|██        | 4/20 [00:26<01:25,  5.31s/it]Task 3, Epoch 5/20 => Loss 0.823, Train_accy 93.15:  25%|██▌       | 5/20 [00:26<01:20,  5.33s/it]Task 3, Epoch 6/20 => Loss 0.606, Train_accy 91.96:  25%|██▌       | 5/20 [00:31<01:20,  5.33s/it]Task 3, Epoch 6/20 => Loss 0.606, Train_accy 91.96:  30%|███       | 6/20 [00:31<01:14,  5.32s/it]Task 3, Epoch 7/20 => Loss 0.459, Train_accy 93.80:  30%|███       | 6/20 [00:37<01:14,  5.32s/it]Task 3, Epoch 7/20 => Loss 0.459, Train_accy 93.80:  35%|███▌      | 7/20 [00:37<01:09,  5.34s/it]Task 3, Epoch 8/20 => Loss 0.422, Train_accy 93.70:  35%|███▌      | 7/20 [00:42<01:09,  5.34s/it]Task 3, Epoch 8/20 => Loss 0.422, Train_accy 93.70:  40%|████      | 8/20 [00:42<01:04,  5.38s/it]Task 3, Epoch 9/20 => Loss 0.379, Train_accy 93.15:  40%|████      | 8/20 [00:48<01:04,  5.38s/it]Task 3, Epoch 9/20 => Loss 0.379, Train_accy 93.15:  45%|████▌     | 9/20 [00:48<00:59,  5.39s/it]Task 3, Epoch 10/20 => Loss 0.362, Train_accy 93.70:  45%|████▌     | 9/20 [00:53<00:59,  5.39s/it]Task 3, Epoch 10/20 => Loss 0.362, Train_accy 93.70:  50%|█████     | 10/20 [00:53<00:53,  5.36s/it]Task 3, Epoch 11/20 => Loss 0.317, Train_accy 93.91:  50%|█████     | 10/20 [00:58<00:53,  5.36s/it]Task 3, Epoch 11/20 => Loss 0.317, Train_accy 93.91:  55%|█████▌    | 11/20 [00:58<00:47,  5.31s/it]Task 3, Epoch 12/20 => Loss 0.332, Train_accy 94.67:  55%|█████▌    | 11/20 [01:04<00:47,  5.31s/it]Task 3, Epoch 12/20 => Loss 0.332, Train_accy 94.67:  60%|██████    | 12/20 [01:04<00:42,  5.33s/it]Task 3, Epoch 13/20 => Loss 0.335, Train_accy 92.61:  60%|██████    | 12/20 [01:09<00:42,  5.33s/it]Task 3, Epoch 13/20 => Loss 0.335, Train_accy 92.61:  65%|██████▌   | 13/20 [01:09<00:37,  5.30s/it]Task 3, Epoch 14/20 => Loss 0.330, Train_accy 94.02:  65%|██████▌   | 13/20 [01:14<00:37,  5.30s/it]Task 3, Epoch 14/20 => Loss 0.330, Train_accy 94.02:  70%|███████   | 14/20 [01:14<00:31,  5.31s/it]Task 3, Epoch 15/20 => Loss 0.335, Train_accy 93.15:  70%|███████   | 14/20 [01:19<00:31,  5.31s/it]Task 3, Epoch 15/20 => Loss 0.335, Train_accy 93.15:  75%|███████▌  | 15/20 [01:19<00:26,  5.31s/it]Task 3, Epoch 16/20 => Loss 0.319, Train_accy 93.91:  75%|███████▌  | 15/20 [01:25<00:26,  5.31s/it]Task 3, Epoch 16/20 => Loss 0.319, Train_accy 93.91:  80%|████████  | 16/20 [01:25<00:21,  5.33s/it]Task 3, Epoch 17/20 => Loss 0.273, Train_accy 95.11:  80%|████████  | 16/20 [01:30<00:21,  5.33s/it]Task 3, Epoch 17/20 => Loss 0.273, Train_accy 95.11:  85%|████████▌ | 17/20 [01:30<00:15,  5.32s/it]Task 3, Epoch 18/20 => Loss 0.303, Train_accy 94.24:  85%|████████▌ | 17/20 [01:35<00:15,  5.32s/it]Task 3, Epoch 18/20 => Loss 0.303, Train_accy 94.24:  90%|█████████ | 18/20 [01:35<00:10,  5.32s/it]Task 3, Epoch 19/20 => Loss 0.316, Train_accy 94.24:  90%|█████████ | 18/20 [01:41<00:10,  5.32s/it]Task 3, Epoch 19/20 => Loss 0.316, Train_accy 94.24:  95%|█████████▌| 19/20 [01:41<00:05,  5.33s/it]Task 3, Epoch 20/20 => Loss 0.303, Train_accy 94.02:  95%|█████████▌| 19/20 [01:46<00:05,  5.33s/it]Task 3, Epoch 20/20 => Loss 0.303, Train_accy 94.02: 100%|██████████| 20/20 [01:46<00:00,  5.35s/it]Task 3, Epoch 20/20 => Loss 0.303, Train_accy 94.02: 100%|██████████| 20/20 [01:46<00:00,  5.33s/it]
2024-04-29 19:29:19,889 [ease.py] => Task 3, Epoch 20/20 => Loss 0.303, Train_accy 94.02
2024-04-29 19:29:56,393 [ease.py] => Task correct: 83.55367530407192
2024-04-29 19:29:56,393 [ease.py] => Task acc: 97.14436805922792
2024-04-29 19:29:56,660 [trainer.py] => No NME accuracy.
2024-04-29 19:29:56,660 [trainer.py] => CNN: {'total': 82.55, '00-99': 76.6, '100-119': 90.79, '120-139': 88.89, '140-159': 97.6, 'old': 80.26, 'new': 97.6}
2024-04-29 19:29:56,660 [trainer.py] => CNN top1 curve: [93.27, 86.09, 83.79, 82.55]
2024-04-29 19:29:56,660 [trainer.py] => CNN top5 curve: [98.91, 98.94, 98.72, 98.52]

Average Accuracy (CNN): 86.43
2024-04-29 19:29:56,660 [trainer.py] => Average Accuracy (CNN): 86.43 

2024-04-29 19:29:56,660 [trainer.py] => Train Time: 1644.5699999999997
2024-04-29 19:29:56,660 [trainer.py] => Test Time: 45.230000000000004 

2024-04-29 19:29:56,661 [trainer.py] => All params: 87495170
2024-04-29 19:29:56,662 [trainer.py] => Trainable params: 1189632
2024-04-29 19:29:56,672 [ease.py] => Learning on 160-180
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.949, Train_accy 32.67:   0%|          | 0/20 [00:05<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.949, Train_accy 32.67:   5%|▌         | 1/20 [00:05<01:45,  5.53s/it]Task 4, Epoch 2/20 => Loss 2.715, Train_accy 80.38:   5%|▌         | 1/20 [00:11<01:45,  5.53s/it]Task 4, Epoch 2/20 => Loss 2.715, Train_accy 80.38:  10%|█         | 2/20 [00:11<01:39,  5.50s/it]Task 4, Epoch 3/20 => Loss 2.166, Train_accy 90.19:  10%|█         | 2/20 [00:16<01:39,  5.50s/it]Task 4, Epoch 3/20 => Loss 2.166, Train_accy 90.19:  15%|█▌        | 3/20 [00:16<01:33,  5.52s/it]Task 4, Epoch 4/20 => Loss 1.395, Train_accy 90.81:  15%|█▌        | 3/20 [00:21<01:33,  5.52s/it]Task 4, Epoch 4/20 => Loss 1.395, Train_accy 90.81:  20%|██        | 4/20 [00:21<01:27,  5.46s/it]Task 4, Epoch 5/20 => Loss 0.817, Train_accy 92.48:  20%|██        | 4/20 [00:27<01:27,  5.46s/it]Task 4, Epoch 5/20 => Loss 0.817, Train_accy 92.48:  25%|██▌       | 5/20 [00:27<01:21,  5.45s/it]Task 4, Epoch 6/20 => Loss 0.566, Train_accy 93.01:  25%|██▌       | 5/20 [00:32<01:21,  5.45s/it]Task 4, Epoch 6/20 => Loss 0.566, Train_accy 93.01:  30%|███       | 6/20 [00:32<01:16,  5.49s/it]Task 4, Epoch 7/20 => Loss 0.438, Train_accy 94.05:  30%|███       | 6/20 [00:38<01:16,  5.49s/it]Task 4, Epoch 7/20 => Loss 0.438, Train_accy 94.05:  35%|███▌      | 7/20 [00:38<01:11,  5.49s/it]Task 4, Epoch 8/20 => Loss 0.406, Train_accy 92.69:  35%|███▌      | 7/20 [00:43<01:11,  5.49s/it]Task 4, Epoch 8/20 => Loss 0.406, Train_accy 92.69:  40%|████      | 8/20 [00:43<01:05,  5.49s/it]Task 4, Epoch 9/20 => Loss 0.334, Train_accy 95.41:  40%|████      | 8/20 [00:49<01:05,  5.49s/it]Task 4, Epoch 9/20 => Loss 0.334, Train_accy 95.41:  45%|████▌     | 9/20 [00:49<01:01,  5.55s/it]Task 4, Epoch 10/20 => Loss 0.348, Train_accy 94.15:  45%|████▌     | 9/20 [00:55<01:01,  5.55s/it]Task 4, Epoch 10/20 => Loss 0.348, Train_accy 94.15:  50%|█████     | 10/20 [00:55<00:55,  5.55s/it]Task 4, Epoch 11/20 => Loss 0.315, Train_accy 94.47:  50%|█████     | 10/20 [01:00<00:55,  5.55s/it]Task 4, Epoch 11/20 => Loss 0.315, Train_accy 94.47:  55%|█████▌    | 11/20 [01:00<00:50,  5.56s/it]Task 4, Epoch 12/20 => Loss 0.352, Train_accy 93.01:  55%|█████▌    | 11/20 [01:06<00:50,  5.56s/it]Task 4, Epoch 12/20 => Loss 0.352, Train_accy 93.01:  60%|██████    | 12/20 [01:06<00:44,  5.56s/it]Task 4, Epoch 13/20 => Loss 0.309, Train_accy 93.63:  60%|██████    | 12/20 [01:11<00:44,  5.56s/it]Task 4, Epoch 13/20 => Loss 0.309, Train_accy 93.63:  65%|██████▌   | 13/20 [01:11<00:38,  5.55s/it]Task 4, Epoch 14/20 => Loss 0.334, Train_accy 93.11:  65%|██████▌   | 13/20 [01:17<00:38,  5.55s/it]Task 4, Epoch 14/20 => Loss 0.334, Train_accy 93.11:  70%|███████   | 14/20 [01:17<00:33,  5.54s/it]Task 4, Epoch 15/20 => Loss 0.274, Train_accy 94.99:  70%|███████   | 14/20 [01:22<00:33,  5.54s/it]Task 4, Epoch 15/20 => Loss 0.274, Train_accy 94.99:  75%|███████▌  | 15/20 [01:22<00:27,  5.51s/it]Task 4, Epoch 16/20 => Loss 0.292, Train_accy 94.15:  75%|███████▌  | 15/20 [01:28<00:27,  5.51s/it]Task 4, Epoch 16/20 => Loss 0.292, Train_accy 94.15:  80%|████████  | 16/20 [01:28<00:22,  5.54s/it]Task 4, Epoch 17/20 => Loss 0.267, Train_accy 95.09:  80%|████████  | 16/20 [01:33<00:22,  5.54s/it]Task 4, Epoch 17/20 => Loss 0.267, Train_accy 95.09:  85%|████████▌ | 17/20 [01:33<00:16,  5.55s/it]Task 4, Epoch 18/20 => Loss 0.283, Train_accy 94.68:  85%|████████▌ | 17/20 [01:39<00:16,  5.55s/it]Task 4, Epoch 18/20 => Loss 0.283, Train_accy 94.68:  90%|█████████ | 18/20 [01:39<00:11,  5.58s/it]Task 4, Epoch 19/20 => Loss 0.310, Train_accy 94.15:  90%|█████████ | 18/20 [01:45<00:11,  5.58s/it]Task 4, Epoch 19/20 => Loss 0.310, Train_accy 94.15:  95%|█████████▌| 19/20 [01:45<00:05,  5.61s/it]Task 4, Epoch 20/20 => Loss 0.284, Train_accy 94.05:  95%|█████████▌| 19/20 [01:50<00:05,  5.61s/it]Task 4, Epoch 20/20 => Loss 0.284, Train_accy 94.05: 100%|██████████| 20/20 [01:50<00:00,  5.61s/it]Task 4, Epoch 20/20 => Loss 0.284, Train_accy 94.05: 100%|██████████| 20/20 [01:50<00:00,  5.54s/it]
2024-04-29 19:31:47,570 [ease.py] => Task 4, Epoch 20/20 => Loss 0.284, Train_accy 94.05
2024-04-29 19:32:38,429 [ease.py] => Task correct: 83.27067669172932
2024-04-29 19:32:38,429 [ease.py] => Task acc: 97.18045112781955
2024-04-29 19:32:38,796 [trainer.py] => No NME accuracy.
2024-04-29 19:32:38,796 [trainer.py] => CNN: {'total': 82.24, '00-99': 75.08, '100-119': 91.67, '120-139': 87.11, '140-159': 93.6, '160-179': 92.41, 'old': 80.96, 'new': 92.41}
2024-04-29 19:32:38,796 [trainer.py] => CNN top1 curve: [93.27, 86.09, 83.79, 82.55, 82.24]
2024-04-29 19:32:38,796 [trainer.py] => CNN top5 curve: [98.91, 98.94, 98.72, 98.52, 98.31]

Average Accuracy (CNN): 85.59
2024-04-29 19:32:38,796 [trainer.py] => Average Accuracy (CNN): 85.59 

2024-04-29 19:32:38,796 [trainer.py] => Train Time: 1866.35
2024-04-29 19:32:38,796 [trainer.py] => Test Time: 72.63 

2024-04-29 19:32:38,797 [trainer.py] => All params: 87694850
2024-04-29 19:32:38,798 [trainer.py] => Trainable params: 1189632
2024-04-29 19:32:38,817 [ease.py] => Learning on 180-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.946, Train_accy 26.58:   0%|          | 0/20 [00:05<?, ?it/s]Task 5, Epoch 1/20 => Loss 2.946, Train_accy 26.58:   5%|▌         | 1/20 [00:05<01:45,  5.58s/it]Task 5, Epoch 2/20 => Loss 2.696, Train_accy 81.41:   5%|▌         | 1/20 [00:11<01:45,  5.58s/it]Task 5, Epoch 2/20 => Loss 2.696, Train_accy 81.41:  10%|█         | 2/20 [00:11<01:40,  5.57s/it]Task 5, Epoch 3/20 => Loss 2.103, Train_accy 87.71:  10%|█         | 2/20 [00:16<01:40,  5.57s/it]Task 5, Epoch 3/20 => Loss 2.103, Train_accy 87.71:  15%|█▌        | 3/20 [00:16<01:34,  5.56s/it]Task 5, Epoch 4/20 => Loss 1.299, Train_accy 90.76:  15%|█▌        | 3/20 [00:22<01:34,  5.56s/it]Task 5, Epoch 4/20 => Loss 1.299, Train_accy 90.76:  20%|██        | 4/20 [00:22<01:29,  5.58s/it]Task 5, Epoch 5/20 => Loss 0.740, Train_accy 92.44:  20%|██        | 4/20 [00:27<01:29,  5.58s/it]Task 5, Epoch 5/20 => Loss 0.740, Train_accy 92.44:  25%|██▌       | 5/20 [00:27<01:22,  5.51s/it]Task 5, Epoch 6/20 => Loss 0.541, Train_accy 92.23:  25%|██▌       | 5/20 [00:33<01:22,  5.51s/it]Task 5, Epoch 6/20 => Loss 0.541, Train_accy 92.23:  30%|███       | 6/20 [00:33<01:16,  5.48s/it]Task 5, Epoch 7/20 => Loss 0.424, Train_accy 93.38:  30%|███       | 6/20 [00:38<01:16,  5.48s/it]Task 5, Epoch 7/20 => Loss 0.424, Train_accy 93.38:  35%|███▌      | 7/20 [00:38<01:11,  5.46s/it]Task 5, Epoch 8/20 => Loss 0.411, Train_accy 92.65:  35%|███▌      | 7/20 [00:44<01:11,  5.46s/it]Task 5, Epoch 8/20 => Loss 0.411, Train_accy 92.65:  40%|████      | 8/20 [00:44<01:06,  5.51s/it]Task 5, Epoch 9/20 => Loss 0.365, Train_accy 92.86:  40%|████      | 8/20 [00:49<01:06,  5.51s/it]Task 5, Epoch 9/20 => Loss 0.365, Train_accy 92.86:  45%|████▌     | 9/20 [00:49<01:00,  5.51s/it]Task 5, Epoch 10/20 => Loss 0.339, Train_accy 93.28:  45%|████▌     | 9/20 [00:55<01:00,  5.51s/it]Task 5, Epoch 10/20 => Loss 0.339, Train_accy 93.28:  50%|█████     | 10/20 [00:55<00:54,  5.48s/it]Task 5, Epoch 11/20 => Loss 0.347, Train_accy 92.75:  50%|█████     | 10/20 [01:00<00:54,  5.48s/it]Task 5, Epoch 11/20 => Loss 0.347, Train_accy 92.75:  55%|█████▌    | 11/20 [01:00<00:49,  5.52s/it]Task 5, Epoch 12/20 => Loss 0.309, Train_accy 93.91:  55%|█████▌    | 11/20 [01:06<00:49,  5.52s/it]Task 5, Epoch 12/20 => Loss 0.309, Train_accy 93.91:  60%|██████    | 12/20 [01:06<00:44,  5.53s/it]Task 5, Epoch 13/20 => Loss 0.329, Train_accy 93.28:  60%|██████    | 12/20 [01:11<00:44,  5.53s/it]Task 5, Epoch 13/20 => Loss 0.329, Train_accy 93.28:  65%|██████▌   | 13/20 [01:11<00:38,  5.54s/it]Task 5, Epoch 14/20 => Loss 0.296, Train_accy 93.70:  65%|██████▌   | 13/20 [01:17<00:38,  5.54s/it]Task 5, Epoch 14/20 => Loss 0.296, Train_accy 93.70:  70%|███████   | 14/20 [01:17<00:33,  5.53s/it]Task 5, Epoch 15/20 => Loss 0.296, Train_accy 94.33:  70%|███████   | 14/20 [01:22<00:33,  5.53s/it]Task 5, Epoch 15/20 => Loss 0.296, Train_accy 94.33:  75%|███████▌  | 15/20 [01:22<00:27,  5.51s/it]Task 5, Epoch 16/20 => Loss 0.288, Train_accy 94.01:  75%|███████▌  | 15/20 [01:28<00:27,  5.51s/it]Task 5, Epoch 16/20 => Loss 0.288, Train_accy 94.01:  80%|████████  | 16/20 [01:28<00:22,  5.55s/it]Task 5, Epoch 17/20 => Loss 0.276, Train_accy 94.12:  80%|████████  | 16/20 [01:33<00:22,  5.55s/it]Task 5, Epoch 17/20 => Loss 0.276, Train_accy 94.12:  85%|████████▌ | 17/20 [01:33<00:16,  5.53s/it]Task 5, Epoch 18/20 => Loss 0.325, Train_accy 92.86:  85%|████████▌ | 17/20 [01:39<00:16,  5.53s/it]Task 5, Epoch 18/20 => Loss 0.325, Train_accy 92.86:  90%|█████████ | 18/20 [01:39<00:11,  5.53s/it]Task 5, Epoch 19/20 => Loss 0.275, Train_accy 94.33:  90%|█████████ | 18/20 [01:44<00:11,  5.53s/it]Task 5, Epoch 19/20 => Loss 0.275, Train_accy 94.33:  95%|█████████▌| 19/20 [01:44<00:05,  5.52s/it]Task 5, Epoch 20/20 => Loss 0.285, Train_accy 94.43:  95%|█████████▌| 19/20 [01:50<00:05,  5.52s/it]Task 5, Epoch 20/20 => Loss 0.285, Train_accy 94.43: 100%|██████████| 20/20 [01:50<00:00,  5.50s/it]Task 5, Epoch 20/20 => Loss 0.285, Train_accy 94.43: 100%|██████████| 20/20 [01:50<00:00,  5.52s/it]
2024-04-29 19:34:29,181 [ease.py] => Task 5, Epoch 20/20 => Loss 0.285, Train_accy 94.43
2024-04-29 19:35:34,328 [ease.py] => Task correct: 79.98303647158609
2024-04-29 19:35:34,328 [ease.py] => Task acc: 97.15860899067006
2024-04-29 19:35:34,496 [trainer.py] => No NME accuracy.
2024-04-29 19:35:34,496 [trainer.py] => CNN: {'total': 79.18, '00-99': 69.78, '100-119': 91.67, '120-139': 77.78, '140-159': 90.8, '160-179': 89.87, '180-199': 93.04, 'old': 77.68, 'new': 93.04}
2024-04-29 19:35:34,496 [trainer.py] => CNN top1 curve: [93.27, 86.09, 83.79, 82.55, 82.24, 79.18]
2024-04-29 19:35:34,496 [trainer.py] => CNN top5 curve: [98.91, 98.94, 98.72, 98.52, 98.31, 98.05]

Average Accuracy (CNN): 84.52
2024-04-29 19:35:34,496 [trainer.py] => Average Accuracy (CNN): 84.52 

2024-04-29 19:35:34,496 [trainer.py] => Train Time: 2087.0699999999997
2024-04-29 19:35:34,496 [trainer.py] => Test Time: 108.82 

Accuracy Matrix (CNN):
[[93.27 84.26 80.64 76.6  75.08 69.78]
 [ 0.   95.61 95.18 90.79 91.67 91.67]
 [ 0.    0.   88.89 88.89 87.11 77.78]
 [ 0.    0.    0.   97.6  93.6  90.8 ]
 [ 0.    0.    0.    0.   92.41 89.87]
 [ 0.    0.    0.    0.    0.   93.04]]
2024-04-29 19:35:34,497 [trainer.py] => Forgetting (CNN): 9.575999999999997

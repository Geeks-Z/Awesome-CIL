nohup: 忽略输入
2024-04-19 08:27:06,197 [trainer.py] => config: ./exps/finetune_ina_B100.json
2024-04-19 08:27:06,197 [trainer.py] => prefix: reproduce
2024-04-19 08:27:06,197 [trainer.py] => dataset: imageneta
2024-04-19 08:27:06,197 [trainer.py] => memory_size: 0
2024-04-19 08:27:06,197 [trainer.py] => memory_per_class: 0
2024-04-19 08:27:06,197 [trainer.py] => fixed_memory: False
2024-04-19 08:27:06,197 [trainer.py] => shuffle: True
2024-04-19 08:27:06,197 [trainer.py] => init_cls: 100
2024-04-19 08:27:06,197 [trainer.py] => increment: 20
2024-04-19 08:27:06,197 [trainer.py] => model_name: finetune
2024-04-19 08:27:06,197 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-19 08:27:06,197 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-19 08:27:06,197 [trainer.py] => seed: 1993
2024-04-19 08:27:06,197 [trainer.py] => init_epoch: 20
2024-04-19 08:27:06,197 [trainer.py] => init_lr: 0.001
2024-04-19 08:27:06,197 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-19 08:27:06,197 [trainer.py] => init_lr_decay: 0.1
2024-04-19 08:27:06,197 [trainer.py] => init_weight_decay: 0.0005
2024-04-19 08:27:06,197 [trainer.py] => epochs: 20
2024-04-19 08:27:06,198 [trainer.py] => lrate: 0.001
2024-04-19 08:27:06,198 [trainer.py] => milestones: [40, 70]
2024-04-19 08:27:06,198 [trainer.py] => lrate_decay: 0.1
2024-04-19 08:27:06,198 [trainer.py] => batch_size: 48
2024-04-19 08:27:06,198 [trainer.py] => weight_decay: 0.0002
2024-04-19 08:27:06,899 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-19 08:27:09,701 [trainer.py] => All params: 85798656
2024-04-19 08:27:09,701 [trainer.py] => Trainable params: 85798656
2024-04-19 08:27:09,702 [finetune.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.629, Train_accy 2.43, Test_accy 2.26:   0%|          | 0/20 [00:27<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.629, Train_accy 2.43, Test_accy 2.26:   5%|▌         | 1/20 [00:27<08:48, 27.83s/it]
Task 0, Epoch 2/20 => Loss 4.358, Train_accy 3.01:   5%|▌         | 1/20 [00:49<08:48, 27.83s/it]                
Task 0, Epoch 2/20 => Loss 4.358, Train_accy 3.01:  10%|█         | 2/20 [00:49<07:19, 24.40s/it]
Task 0, Epoch 3/20 => Loss 4.318, Train_accy 3.71:  10%|█         | 2/20 [01:11<07:19, 24.40s/it]
Task 0, Epoch 3/20 => Loss 4.318, Train_accy 3.71:  15%|█▌        | 3/20 [01:11<06:35, 23.29s/it]
Task 0, Epoch 4/20 => Loss 4.292, Train_accy 3.56:  15%|█▌        | 3/20 [01:33<06:35, 23.29s/it]
Task 0, Epoch 4/20 => Loss 4.292, Train_accy 3.56:  20%|██        | 4/20 [01:33<06:04, 22.78s/it]
Task 0, Epoch 5/20 => Loss 4.248, Train_accy 4.10:  20%|██        | 4/20 [01:55<06:04, 22.78s/it]
Task 0, Epoch 5/20 => Loss 4.248, Train_accy 4.10:  25%|██▌       | 5/20 [01:55<05:37, 22.53s/it]
Task 0, Epoch 6/20 => Loss 4.164, Train_accy 5.44, Test_accy 5.11:  25%|██▌       | 5/20 [02:20<05:37, 22.53s/it]
Task 0, Epoch 6/20 => Loss 4.164, Train_accy 5.44, Test_accy 5.11:  30%|███       | 6/20 [02:20<05:26, 23.32s/it]
Task 0, Epoch 7/20 => Loss 4.123, Train_accy 5.84:  30%|███       | 6/20 [02:42<05:26, 23.32s/it]                
Task 0, Epoch 7/20 => Loss 4.123, Train_accy 5.84:  35%|███▌      | 7/20 [02:42<04:58, 22.97s/it]
Task 0, Epoch 8/20 => Loss 3.918, Train_accy 9.03:  35%|███▌      | 7/20 [03:05<04:58, 22.97s/it]
Task 0, Epoch 8/20 => Loss 3.918, Train_accy 9.03:  40%|████      | 8/20 [03:05<04:32, 22.73s/it]
Task 0, Epoch 9/20 => Loss 3.285, Train_accy 19.85:  40%|████      | 8/20 [03:27<04:32, 22.73s/it]
Task 0, Epoch 9/20 => Loss 3.285, Train_accy 19.85:  45%|████▌     | 9/20 [03:27<04:09, 22.67s/it]
Task 0, Epoch 10/20 => Loss 2.462, Train_accy 36.47:  45%|████▌     | 9/20 [03:50<04:09, 22.67s/it]
Task 0, Epoch 10/20 => Loss 2.462, Train_accy 36.47:  50%|█████     | 10/20 [03:50<03:45, 22.55s/it]
Task 0, Epoch 11/20 => Loss 1.822, Train_accy 51.25, Test_accy 42.93:  50%|█████     | 10/20 [04:14<03:45, 22.55s/it]
Task 0, Epoch 11/20 => Loss 1.822, Train_accy 51.25, Test_accy 42.93:  55%|█████▌    | 11/20 [04:14<03:29, 23.25s/it]
Task 0, Epoch 12/20 => Loss 1.559, Train_accy 58.81:  55%|█████▌    | 11/20 [04:37<03:29, 23.25s/it]                 
Task 0, Epoch 12/20 => Loss 1.559, Train_accy 58.81:  60%|██████    | 12/20 [04:37<03:03, 22.95s/it]
Task 0, Epoch 13/20 => Loss 1.155, Train_accy 68.84:  60%|██████    | 12/20 [04:59<03:03, 22.95s/it]
Task 0, Epoch 13/20 => Loss 1.155, Train_accy 68.84:  65%|██████▌   | 13/20 [04:59<02:39, 22.76s/it]
Task 0, Epoch 14/20 => Loss 0.932, Train_accy 74.10:  65%|██████▌   | 13/20 [05:21<02:39, 22.76s/it]
Task 0, Epoch 14/20 => Loss 0.932, Train_accy 74.10:  70%|███████   | 14/20 [05:21<02:15, 22.57s/it]
Task 0, Epoch 15/20 => Loss 0.799, Train_accy 77.84:  70%|███████   | 14/20 [05:43<02:15, 22.57s/it]
Task 0, Epoch 15/20 => Loss 0.799, Train_accy 77.84:  75%|███████▌  | 15/20 [05:43<01:52, 22.49s/it]
Task 0, Epoch 16/20 => Loss 0.691, Train_accy 80.61, Test_accy 48.39:  75%|███████▌  | 15/20 [06:09<01:52, 22.49s/it]
Task 0, Epoch 16/20 => Loss 0.691, Train_accy 80.61, Test_accy 48.39:  80%|████████  | 16/20 [06:09<01:33, 23.29s/it]
Task 0, Epoch 17/20 => Loss 0.631, Train_accy 83.07:  80%|████████  | 16/20 [06:31<01:33, 23.29s/it]                 
Task 0, Epoch 17/20 => Loss 0.631, Train_accy 83.07:  85%|████████▌ | 17/20 [06:31<01:09, 23.05s/it]
Task 0, Epoch 18/20 => Loss 0.578, Train_accy 84.77:  85%|████████▌ | 17/20 [06:53<01:09, 23.05s/it]
Task 0, Epoch 18/20 => Loss 0.578, Train_accy 84.77:  90%|█████████ | 18/20 [06:53<00:45, 22.83s/it]
Task 0, Epoch 19/20 => Loss 0.529, Train_accy 85.81:  90%|█████████ | 18/20 [07:16<00:45, 22.83s/it]
Task 0, Epoch 19/20 => Loss 0.529, Train_accy 85.81:  95%|█████████▌| 19/20 [07:16<00:22, 22.71s/it]
Task 0, Epoch 20/20 => Loss 0.482, Train_accy 86.66:  95%|█████████▌| 19/20 [07:38<00:22, 22.71s/it]
Task 0, Epoch 20/20 => Loss 0.482, Train_accy 86.66: 100%|██████████| 20/20 [07:38<00:00, 22.55s/it]
Task 0, Epoch 20/20 => Loss 0.482, Train_accy 86.66: 100%|██████████| 20/20 [07:38<00:00, 22.92s/it]
2024-04-19 08:34:48,607 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.482, Train_accy 86.66
2024-04-19 08:34:51,159 [trainer.py] => No NME accuracy.
2024-04-19 08:34:51,160 [trainer.py] => CNN: {'total': 52.08, '00-99': 52.08, 'old': 0, 'new': 52.08}
2024-04-19 08:34:51,160 [trainer.py] => CNN top1 curve: [52.08]
2024-04-19 08:34:51,160 [trainer.py] => CNN top5 curve: [77.29]

Average Accuracy (CNN): 52.08
2024-04-19 08:34:51,160 [trainer.py] => Average Accuracy (CNN): 52.08 

2024-04-19 08:34:51,160 [trainer.py] => Train Time: 917.3399999999999
2024-04-19 08:34:51,160 [trainer.py] => Test Time: 2.55 

2024-04-19 08:34:51,161 [trainer.py] => All params: 85875556
2024-04-19 08:34:51,162 [trainer.py] => Trainable params: 85875556
2024-04-19 08:34:51,165 [finetune.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.029, Train_accy 9.75, Test_accy 37.54:   0%|          | 0/20 [00:07<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.029, Train_accy 9.75, Test_accy 37.54:   5%|▌         | 1/20 [00:07<02:28,  7.82s/it]
Task 1, Epoch 2/20 => Loss 1.220, Train_accy 40.34:   5%|▌         | 1/20 [00:11<02:28,  7.82s/it]                
Task 1, Epoch 2/20 => Loss 1.220, Train_accy 40.34:  10%|█         | 2/20 [00:11<01:39,  5.51s/it]
Task 1, Epoch 3/20 => Loss 0.771, Train_accy 60.80:  10%|█         | 2/20 [00:15<01:39,  5.51s/it]
Task 1, Epoch 3/20 => Loss 0.771, Train_accy 60.80:  15%|█▌        | 3/20 [00:15<01:21,  4.80s/it]
Task 1, Epoch 4/20 => Loss 0.522, Train_accy 73.23:  15%|█▌        | 3/20 [00:19<01:21,  4.80s/it]
Task 1, Epoch 4/20 => Loss 0.522, Train_accy 73.23:  20%|██        | 4/20 [00:19<01:11,  4.48s/it]
Task 1, Epoch 5/20 => Loss 0.355, Train_accy 78.39:  20%|██        | 4/20 [00:23<01:11,  4.48s/it]
Task 1, Epoch 5/20 => Loss 0.355, Train_accy 78.39:  25%|██▌       | 5/20 [00:23<01:04,  4.27s/it]
Task 1, Epoch 6/20 => Loss 0.291, Train_accy 82.41, Test_accy 37.64:  25%|██▌       | 5/20 [00:30<01:04,  4.27s/it]
Task 1, Epoch 6/20 => Loss 0.291, Train_accy 82.41, Test_accy 37.64:  30%|███       | 6/20 [00:30<01:11,  5.14s/it]
Task 1, Epoch 7/20 => Loss 0.220, Train_accy 86.23:  30%|███       | 6/20 [00:34<01:11,  5.14s/it]                 
Task 1, Epoch 7/20 => Loss 0.220, Train_accy 86.23:  35%|███▌      | 7/20 [00:34<01:01,  4.72s/it]
Task 1, Epoch 8/20 => Loss 0.196, Train_accy 85.28:  35%|███▌      | 7/20 [00:38<01:01,  4.72s/it]
Task 1, Epoch 8/20 => Loss 0.196, Train_accy 85.28:  40%|████      | 8/20 [00:38<00:53,  4.44s/it]
Task 1, Epoch 9/20 => Loss 0.174, Train_accy 88.15:  40%|████      | 8/20 [00:42<00:53,  4.44s/it]
Task 1, Epoch 9/20 => Loss 0.174, Train_accy 88.15:  45%|████▌     | 9/20 [00:42<00:47,  4.30s/it]
Task 1, Epoch 10/20 => Loss 0.142, Train_accy 88.91:  45%|████▌     | 9/20 [00:45<00:47,  4.30s/it]
Task 1, Epoch 10/20 => Loss 0.142, Train_accy 88.91:  50%|█████     | 10/20 [00:45<00:41,  4.15s/it]
Task 1, Epoch 11/20 => Loss 0.129, Train_accy 89.48, Test_accy 36.10:  50%|█████     | 10/20 [00:52<00:41,  4.15s/it]
Task 1, Epoch 11/20 => Loss 0.129, Train_accy 89.48, Test_accy 36.10:  55%|█████▌    | 11/20 [00:52<00:44,  4.96s/it]
Task 1, Epoch 12/20 => Loss 0.123, Train_accy 91.20:  55%|█████▌    | 11/20 [00:56<00:44,  4.96s/it]                 
Task 1, Epoch 12/20 => Loss 0.123, Train_accy 91.20:  60%|██████    | 12/20 [00:56<00:37,  4.68s/it]
Task 1, Epoch 13/20 => Loss 0.197, Train_accy 90.44:  60%|██████    | 12/20 [01:00<00:37,  4.68s/it]
Task 1, Epoch 13/20 => Loss 0.197, Train_accy 90.44:  65%|██████▌   | 13/20 [01:00<00:30,  4.42s/it]
Task 1, Epoch 14/20 => Loss 0.144, Train_accy 89.29:  65%|██████▌   | 13/20 [01:04<00:30,  4.42s/it]
Task 1, Epoch 14/20 => Loss 0.144, Train_accy 89.29:  70%|███████   | 14/20 [01:04<00:25,  4.23s/it]
Task 1, Epoch 15/20 => Loss 0.101, Train_accy 92.35:  70%|███████   | 14/20 [01:08<00:25,  4.23s/it]
Task 1, Epoch 15/20 => Loss 0.101, Train_accy 92.35:  75%|███████▌  | 15/20 [01:08<00:20,  4.09s/it]
Task 1, Epoch 16/20 => Loss 0.124, Train_accy 91.78, Test_accy 35.90:  75%|███████▌  | 15/20 [01:15<00:20,  4.09s/it]
Task 1, Epoch 16/20 => Loss 0.124, Train_accy 91.78, Test_accy 35.90:  80%|████████  | 16/20 [01:15<00:19,  4.99s/it]
Task 1, Epoch 17/20 => Loss 0.126, Train_accy 91.59:  80%|████████  | 16/20 [01:18<00:19,  4.99s/it]                 
Task 1, Epoch 17/20 => Loss 0.126, Train_accy 91.59:  85%|████████▌ | 17/20 [01:18<00:13,  4.63s/it]
Task 1, Epoch 18/20 => Loss 0.139, Train_accy 92.16:  85%|████████▌ | 17/20 [01:22<00:13,  4.63s/it]
Task 1, Epoch 18/20 => Loss 0.139, Train_accy 92.16:  90%|█████████ | 18/20 [01:22<00:08,  4.39s/it]
Task 1, Epoch 19/20 => Loss 0.147, Train_accy 90.44:  90%|█████████ | 18/20 [01:26<00:08,  4.39s/it]
Task 1, Epoch 19/20 => Loss 0.147, Train_accy 90.44:  95%|█████████▌| 19/20 [01:26<00:04,  4.28s/it]
Task 1, Epoch 20/20 => Loss 0.140, Train_accy 90.82:  95%|█████████▌| 19/20 [01:30<00:04,  4.28s/it]
Task 1, Epoch 20/20 => Loss 0.140, Train_accy 90.82: 100%|██████████| 20/20 [01:30<00:00,  4.14s/it]
Task 1, Epoch 20/20 => Loss 0.140, Train_accy 90.82: 100%|██████████| 20/20 [01:30<00:00,  4.53s/it]
2024-04-19 08:36:21,833 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.140, Train_accy 90.82
2024-04-19 08:36:24,806 [trainer.py] => No NME accuracy.
2024-04-19 08:36:24,807 [trainer.py] => CNN: {'total': 36.92, '00-99': 33.29, '100-119': 59.7, 'old': 33.29, 'new': 59.7}
2024-04-19 08:36:24,807 [trainer.py] => CNN top1 curve: [52.08, 36.92]
2024-04-19 08:36:24,807 [trainer.py] => CNN top5 curve: [77.29, 65.23]

Average Accuracy (CNN): 44.5
2024-04-19 08:36:24,807 [trainer.py] => Average Accuracy (CNN): 44.5 

2024-04-19 08:36:24,807 [trainer.py] => Train Time: 1008.0099999999999
2024-04-19 08:36:24,807 [trainer.py] => Test Time: 5.52 

2024-04-19 08:36:24,808 [trainer.py] => All params: 85890936
2024-04-19 08:36:24,809 [trainer.py] => Trainable params: 85890936
2024-04-19 08:36:24,811 [finetune.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.942, Train_accy 1.48, Test_accy 29.71:   0%|          | 0/20 [00:08<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.942, Train_accy 1.48, Test_accy 29.71:   5%|▌         | 1/20 [00:08<02:32,  8.01s/it]
Task 2, Epoch 2/20 => Loss 1.370, Train_accy 21.71:   5%|▌         | 1/20 [00:11<02:32,  8.01s/it]                
Task 2, Epoch 2/20 => Loss 1.370, Train_accy 21.71:  10%|█         | 2/20 [00:11<01:41,  5.61s/it]
Task 2, Epoch 3/20 => Loss 0.926, Train_accy 39.33:  10%|█         | 2/20 [00:15<01:41,  5.61s/it]
Task 2, Epoch 3/20 => Loss 0.926, Train_accy 39.33:  15%|█▌        | 3/20 [00:15<01:23,  4.88s/it]
Task 2, Epoch 4/20 => Loss 0.536, Train_accy 56.96:  15%|█▌        | 3/20 [00:19<01:23,  4.88s/it]
Task 2, Epoch 4/20 => Loss 0.536, Train_accy 56.96:  20%|██        | 4/20 [00:19<01:12,  4.54s/it]
Task 2, Epoch 5/20 => Loss 0.409, Train_accy 67.35:  20%|██        | 4/20 [00:24<01:12,  4.54s/it]
Task 2, Epoch 5/20 => Loss 0.409, Train_accy 67.35:  25%|██▌       | 5/20 [00:24<01:05,  4.36s/it]
Task 2, Epoch 6/20 => Loss 0.322, Train_accy 74.40, Test_accy 31.13:  25%|██▌       | 5/20 [00:31<01:05,  4.36s/it]
Task 2, Epoch 6/20 => Loss 0.322, Train_accy 74.40, Test_accy 31.13:  30%|███       | 6/20 [00:31<01:15,  5.39s/it]
Task 2, Epoch 7/20 => Loss 0.297, Train_accy 73.10:  30%|███       | 6/20 [00:35<01:15,  5.39s/it]                 
Task 2, Epoch 7/20 => Loss 0.297, Train_accy 73.10:  35%|███▌      | 7/20 [00:35<01:04,  4.96s/it]
Task 2, Epoch 8/20 => Loss 0.292, Train_accy 74.95:  35%|███▌      | 7/20 [00:39<01:04,  4.96s/it]
Task 2, Epoch 8/20 => Loss 0.292, Train_accy 74.95:  40%|████      | 8/20 [00:39<00:56,  4.68s/it]
Task 2, Epoch 9/20 => Loss 0.288, Train_accy 79.96:  40%|████      | 8/20 [00:43<00:56,  4.68s/it]
Task 2, Epoch 9/20 => Loss 0.288, Train_accy 79.96:  45%|████▌     | 9/20 [00:43<00:48,  4.45s/it]
Task 2, Epoch 10/20 => Loss 0.198, Train_accy 80.52:  45%|████▌     | 9/20 [00:47<00:48,  4.45s/it]
Task 2, Epoch 10/20 => Loss 0.198, Train_accy 80.52:  50%|█████     | 10/20 [00:47<00:43,  4.31s/it]
Task 2, Epoch 11/20 => Loss 0.148, Train_accy 84.97, Test_accy 30.60:  50%|█████     | 10/20 [00:54<00:43,  4.31s/it]
Task 2, Epoch 11/20 => Loss 0.148, Train_accy 84.97, Test_accy 30.60:  55%|█████▌    | 11/20 [00:54<00:46,  5.20s/it]
Task 2, Epoch 12/20 => Loss 0.191, Train_accy 83.86:  55%|█████▌    | 11/20 [00:58<00:46,  5.20s/it]                 
Task 2, Epoch 12/20 => Loss 0.191, Train_accy 83.86:  60%|██████    | 12/20 [00:58<00:38,  4.83s/it]
Task 2, Epoch 13/20 => Loss 0.189, Train_accy 85.71:  60%|██████    | 12/20 [01:02<00:38,  4.83s/it]
Task 2, Epoch 13/20 => Loss 0.189, Train_accy 85.71:  65%|██████▌   | 13/20 [01:02<00:32,  4.59s/it]
Task 2, Epoch 14/20 => Loss 0.178, Train_accy 82.37:  65%|██████▌   | 13/20 [01:06<00:32,  4.59s/it]
Task 2, Epoch 14/20 => Loss 0.178, Train_accy 82.37:  70%|███████   | 14/20 [01:06<00:26,  4.39s/it]
Task 2, Epoch 15/20 => Loss 0.202, Train_accy 81.63:  70%|███████   | 14/20 [01:10<00:26,  4.39s/it]
Task 2, Epoch 15/20 => Loss 0.202, Train_accy 81.63:  75%|███████▌  | 15/20 [01:10<00:21,  4.25s/it]
Task 2, Epoch 16/20 => Loss 0.219, Train_accy 80.33, Test_accy 29.71:  75%|███████▌  | 15/20 [01:17<00:21,  4.25s/it]
Task 2, Epoch 16/20 => Loss 0.219, Train_accy 80.33, Test_accy 29.71:  80%|████████  | 16/20 [01:17<00:20,  5.15s/it]
Task 2, Epoch 17/20 => Loss 0.230, Train_accy 80.52:  80%|████████  | 16/20 [01:21<00:20,  5.15s/it]                 
Task 2, Epoch 17/20 => Loss 0.230, Train_accy 80.52:  85%|████████▌ | 17/20 [01:21<00:14,  4.85s/it]
Task 2, Epoch 18/20 => Loss 0.176, Train_accy 84.97:  85%|████████▌ | 17/20 [01:26<00:14,  4.85s/it]
Task 2, Epoch 18/20 => Loss 0.176, Train_accy 84.97:  90%|█████████ | 18/20 [01:26<00:09,  4.62s/it]
Task 2, Epoch 19/20 => Loss 0.185, Train_accy 84.97:  90%|█████████ | 18/20 [01:30<00:09,  4.62s/it]
Task 2, Epoch 19/20 => Loss 0.185, Train_accy 84.97:  95%|█████████▌| 19/20 [01:30<00:04,  4.43s/it]
Task 2, Epoch 20/20 => Loss 0.115, Train_accy 89.42:  95%|█████████▌| 19/20 [01:34<00:04,  4.43s/it]
Task 2, Epoch 20/20 => Loss 0.115, Train_accy 89.42: 100%|██████████| 20/20 [01:34<00:00,  4.29s/it]
Task 2, Epoch 20/20 => Loss 0.115, Train_accy 89.42: 100%|██████████| 20/20 [01:34<00:00,  4.70s/it]
2024-04-19 08:37:58,844 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.115, Train_accy 89.42
2024-04-19 08:38:02,276 [trainer.py] => No NME accuracy.
2024-04-19 08:38:02,276 [trainer.py] => CNN: {'total': 28.37, '00-99': 23.07, '100-119': 44.03, '120-139': 44.52, 'old': 25.95, 'new': 44.52}
2024-04-19 08:38:02,276 [trainer.py] => CNN top1 curve: [52.08, 36.92, 28.37]
2024-04-19 08:38:02,277 [trainer.py] => CNN top5 curve: [77.29, 65.23, 57.81]

Average Accuracy (CNN): 39.123333333333335
2024-04-19 08:38:02,277 [trainer.py] => Average Accuracy (CNN): 39.123333333333335 

2024-04-19 08:38:02,277 [trainer.py] => Train Time: 1102.04
2024-04-19 08:38:02,277 [trainer.py] => Test Time: 8.95 

2024-04-19 08:38:02,279 [trainer.py] => All params: 85906316
2024-04-19 08:38:02,280 [trainer.py] => Trainable params: 85906316
2024-04-19 08:38:02,285 [finetune.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.998, Train_accy 0.75, Test_accy 15.95:   0%|          | 0/20 [00:07<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.998, Train_accy 0.75, Test_accy 15.95:   5%|▌         | 1/20 [00:07<02:31,  7.99s/it]
Task 3, Epoch 2/20 => Loss 1.610, Train_accy 12.24:   5%|▌         | 1/20 [00:11<02:31,  7.99s/it]                
Task 3, Epoch 2/20 => Loss 1.610, Train_accy 12.24:  10%|█         | 2/20 [00:11<01:41,  5.63s/it]
Task 3, Epoch 3/20 => Loss 1.122, Train_accy 30.51:  10%|█         | 2/20 [00:15<01:41,  5.63s/it]
Task 3, Epoch 3/20 => Loss 1.122, Train_accy 30.51:  15%|█▌        | 3/20 [00:15<01:23,  4.88s/it]
Task 3, Epoch 4/20 => Loss 0.866, Train_accy 45.20:  15%|█▌        | 3/20 [00:19<01:23,  4.88s/it]
Task 3, Epoch 4/20 => Loss 0.866, Train_accy 45.20:  20%|██        | 4/20 [00:19<01:12,  4.52s/it]
Task 3, Epoch 5/20 => Loss 0.733, Train_accy 53.86:  20%|██        | 4/20 [00:23<01:12,  4.52s/it]
Task 3, Epoch 5/20 => Loss 0.733, Train_accy 53.86:  25%|██▌       | 5/20 [00:23<01:04,  4.29s/it]
Task 3, Epoch 6/20 => Loss 0.567, Train_accy 62.71, Test_accy 22.84:  25%|██▌       | 5/20 [00:31<01:04,  4.29s/it]
Task 3, Epoch 6/20 => Loss 0.567, Train_accy 62.71, Test_accy 22.84:  30%|███       | 6/20 [00:31<01:16,  5.44s/it]
Task 3, Epoch 7/20 => Loss 0.501, Train_accy 61.96:  30%|███       | 6/20 [00:35<01:16,  5.44s/it]                 
Task 3, Epoch 7/20 => Loss 0.501, Train_accy 61.96:  35%|███▌      | 7/20 [00:35<01:04,  4.92s/it]
Task 3, Epoch 8/20 => Loss 0.437, Train_accy 64.60:  35%|███▌      | 7/20 [00:39<01:04,  4.92s/it]
Task 3, Epoch 8/20 => Loss 0.437, Train_accy 64.60:  40%|████      | 8/20 [00:39<00:55,  4.62s/it]
Task 3, Epoch 9/20 => Loss 0.290, Train_accy 72.88:  40%|████      | 8/20 [00:43<00:55,  4.62s/it]
Task 3, Epoch 9/20 => Loss 0.290, Train_accy 72.88:  45%|████▌     | 9/20 [00:43<00:48,  4.42s/it]
Task 3, Epoch 10/20 => Loss 0.193, Train_accy 78.34:  45%|████▌     | 9/20 [00:47<00:48,  4.42s/it]
Task 3, Epoch 10/20 => Loss 0.193, Train_accy 78.34:  50%|█████     | 10/20 [00:47<00:43,  4.30s/it]
Task 3, Epoch 11/20 => Loss 0.193, Train_accy 77.78, Test_accy 22.68:  50%|█████     | 10/20 [00:55<00:43,  4.30s/it]
Task 3, Epoch 11/20 => Loss 0.193, Train_accy 77.78, Test_accy 22.68:  55%|█████▌    | 11/20 [00:55<00:48,  5.34s/it]
Task 3, Epoch 12/20 => Loss 0.181, Train_accy 80.98:  55%|█████▌    | 11/20 [00:58<00:48,  5.34s/it]                 
Task 3, Epoch 12/20 => Loss 0.181, Train_accy 80.98:  60%|██████    | 12/20 [00:58<00:39,  4.92s/it]
Task 3, Epoch 13/20 => Loss 0.179, Train_accy 85.31:  60%|██████    | 12/20 [01:02<00:39,  4.92s/it]
Task 3, Epoch 13/20 => Loss 0.179, Train_accy 85.31:  65%|██████▌   | 13/20 [01:02<00:32,  4.61s/it]
Task 3, Epoch 14/20 => Loss 0.239, Train_accy 82.67:  65%|██████▌   | 13/20 [01:06<00:32,  4.61s/it]
Task 3, Epoch 14/20 => Loss 0.239, Train_accy 82.67:  70%|███████   | 14/20 [01:06<00:26,  4.39s/it]
Task 3, Epoch 15/20 => Loss 0.185, Train_accy 81.36:  70%|███████   | 14/20 [01:10<00:26,  4.39s/it]
Task 3, Epoch 15/20 => Loss 0.185, Train_accy 81.36:  75%|███████▌  | 15/20 [01:10<00:21,  4.25s/it]
Task 3, Epoch 16/20 => Loss 0.146, Train_accy 84.56, Test_accy 23.72:  75%|███████▌  | 15/20 [01:18<00:21,  4.25s/it]
Task 3, Epoch 16/20 => Loss 0.146, Train_accy 84.56, Test_accy 23.72:  80%|████████  | 16/20 [01:18<00:20,  5.24s/it]
Task 3, Epoch 17/20 => Loss 0.130, Train_accy 83.99:  80%|████████  | 16/20 [01:22<00:20,  5.24s/it]                 
Task 3, Epoch 17/20 => Loss 0.130, Train_accy 83.99:  85%|████████▌ | 17/20 [01:22<00:14,  4.82s/it]
Task 3, Epoch 18/20 => Loss 0.122, Train_accy 86.63:  85%|████████▌ | 17/20 [01:26<00:14,  4.82s/it]
Task 3, Epoch 18/20 => Loss 0.122, Train_accy 86.63:  90%|█████████ | 18/20 [01:26<00:09,  4.57s/it]
Task 3, Epoch 19/20 => Loss 0.135, Train_accy 87.38:  90%|█████████ | 18/20 [01:30<00:09,  4.57s/it]
Task 3, Epoch 19/20 => Loss 0.135, Train_accy 87.38:  95%|█████████▌| 19/20 [01:30<00:04,  4.40s/it]
Task 3, Epoch 20/20 => Loss 0.108, Train_accy 88.70:  95%|█████████▌| 19/20 [01:34<00:04,  4.40s/it]
Task 3, Epoch 20/20 => Loss 0.108, Train_accy 88.70: 100%|██████████| 20/20 [01:34<00:00,  4.28s/it]
Task 3, Epoch 20/20 => Loss 0.108, Train_accy 88.70: 100%|██████████| 20/20 [01:34<00:00,  4.70s/it]
2024-04-19 08:39:36,347 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.108, Train_accy 88.70
2024-04-19 08:39:39,931 [trainer.py] => No NME accuracy.
2024-04-19 08:39:39,935 [trainer.py] => CNN: {'total': 22.36, '00-99': 15.22, '100-119': 38.06, '120-139': 35.62, '140-159': 37.8, 'old': 20.61, 'new': 37.8}
2024-04-19 08:39:39,935 [trainer.py] => CNN top1 curve: [52.08, 36.92, 28.37, 22.36]
2024-04-19 08:39:39,935 [trainer.py] => CNN top5 curve: [77.29, 65.23, 57.81, 49.12]

Average Accuracy (CNN): 34.932500000000005
2024-04-19 08:39:39,935 [trainer.py] => Average Accuracy (CNN): 34.932500000000005 

2024-04-19 08:39:39,935 [trainer.py] => Train Time: 1196.1
2024-04-19 08:39:39,935 [trainer.py] => Test Time: 12.53 

2024-04-19 08:39:39,936 [trainer.py] => All params: 85921696
2024-04-19 08:39:39,937 [trainer.py] => Trainable params: 85921696
2024-04-19 08:39:39,939 [finetune.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.124, Train_accy 0.18, Test_accy 14.70:   0%|          | 0/20 [00:14<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.124, Train_accy 0.18, Test_accy 14.70:   5%|▌         | 1/20 [00:14<04:39, 14.69s/it]
Task 4, Epoch 2/20 => Loss 1.638, Train_accy 8.41:   5%|▌         | 1/20 [00:18<04:39, 14.69s/it]                 
Task 4, Epoch 2/20 => Loss 1.638, Train_accy 8.41:  10%|█         | 2/20 [00:18<02:33,  8.52s/it]
Task 4, Epoch 3/20 => Loss 1.081, Train_accy 23.12:  10%|█         | 2/20 [00:23<02:33,  8.52s/it]
Task 4, Epoch 3/20 => Loss 1.081, Train_accy 23.12:  15%|█▌        | 3/20 [00:23<01:50,  6.52s/it]
Task 4, Epoch 4/20 => Loss 0.795, Train_accy 34.33:  15%|█▌        | 3/20 [00:27<01:50,  6.52s/it]
Task 4, Epoch 4/20 => Loss 0.795, Train_accy 34.33:  20%|██        | 4/20 [00:27<01:29,  5.59s/it]
Task 4, Epoch 5/20 => Loss 0.559, Train_accy 47.99:  20%|██        | 4/20 [00:31<01:29,  5.59s/it]
Task 4, Epoch 5/20 => Loss 0.559, Train_accy 47.99:  25%|██▌       | 5/20 [00:31<01:16,  5.09s/it]
Task 4, Epoch 6/20 => Loss 0.452, Train_accy 52.89, Test_accy 21.65:  25%|██▌       | 5/20 [00:39<01:16,  5.09s/it]
Task 4, Epoch 6/20 => Loss 0.452, Train_accy 52.89, Test_accy 21.65:  30%|███       | 6/20 [00:39<01:26,  6.17s/it]
Task 4, Epoch 7/20 => Loss 0.392, Train_accy 56.39:  30%|███       | 6/20 [00:43<01:26,  6.17s/it]                 
Task 4, Epoch 7/20 => Loss 0.392, Train_accy 56.39:  35%|███▌      | 7/20 [00:43<01:11,  5.50s/it]
Task 4, Epoch 8/20 => Loss 0.231, Train_accy 64.62:  35%|███▌      | 7/20 [00:47<01:11,  5.50s/it]
Task 4, Epoch 8/20 => Loss 0.231, Train_accy 64.62:  40%|████      | 8/20 [00:47<01:00,  5.08s/it]
Task 4, Epoch 9/20 => Loss 0.244, Train_accy 64.27:  40%|████      | 8/20 [00:52<01:00,  5.08s/it]
Task 4, Epoch 9/20 => Loss 0.244, Train_accy 64.27:  45%|████▌     | 9/20 [00:52<00:52,  4.77s/it]
Task 4, Epoch 10/20 => Loss 0.267, Train_accy 68.83:  45%|████▌     | 9/20 [00:56<00:52,  4.77s/it]
Task 4, Epoch 10/20 => Loss 0.267, Train_accy 68.83:  50%|█████     | 10/20 [00:56<00:45,  4.60s/it]
Task 4, Epoch 11/20 => Loss 0.218, Train_accy 69.18, Test_accy 22.44:  50%|█████     | 10/20 [01:04<00:45,  4.60s/it]
Task 4, Epoch 11/20 => Loss 0.218, Train_accy 69.18, Test_accy 22.44:  55%|█████▌    | 11/20 [01:04<00:51,  5.68s/it]
Task 4, Epoch 12/20 => Loss 0.255, Train_accy 67.78:  55%|█████▌    | 11/20 [01:08<00:51,  5.68s/it]                 
Task 4, Epoch 12/20 => Loss 0.255, Train_accy 67.78:  60%|██████    | 12/20 [01:08<00:41,  5.22s/it]
Task 4, Epoch 13/20 => Loss 0.178, Train_accy 73.03:  60%|██████    | 12/20 [01:12<00:41,  5.22s/it]
Task 4, Epoch 13/20 => Loss 0.178, Train_accy 73.03:  65%|██████▌   | 13/20 [01:12<00:34,  4.93s/it]
Task 4, Epoch 14/20 => Loss 0.190, Train_accy 73.91:  65%|██████▌   | 13/20 [01:17<00:34,  4.93s/it]
Task 4, Epoch 14/20 => Loss 0.190, Train_accy 73.91:  70%|███████   | 14/20 [01:17<00:28,  4.74s/it]
Task 4, Epoch 15/20 => Loss 0.214, Train_accy 71.63:  70%|███████   | 14/20 [01:21<00:28,  4.74s/it]
Task 4, Epoch 15/20 => Loss 0.214, Train_accy 71.63:  75%|███████▌  | 15/20 [01:21<00:22,  4.57s/it]
Task 4, Epoch 16/20 => Loss 0.177, Train_accy 73.56, Test_accy 22.80:  75%|███████▌  | 15/20 [01:29<00:22,  4.57s/it]
Task 4, Epoch 16/20 => Loss 0.177, Train_accy 73.56, Test_accy 22.80:  80%|████████  | 16/20 [01:29<00:22,  5.72s/it]
Task 4, Epoch 17/20 => Loss 0.187, Train_accy 74.78:  80%|████████  | 16/20 [01:33<00:22,  5.72s/it]                 
Task 4, Epoch 17/20 => Loss 0.187, Train_accy 74.78:  85%|████████▌ | 17/20 [01:33<00:15,  5.26s/it]
Task 4, Epoch 18/20 => Loss 0.160, Train_accy 76.01:  85%|████████▌ | 17/20 [01:38<00:15,  5.26s/it]
Task 4, Epoch 18/20 => Loss 0.160, Train_accy 76.01:  90%|█████████ | 18/20 [01:38<00:09,  4.95s/it]
Task 4, Epoch 19/20 => Loss 0.131, Train_accy 77.76:  90%|█████████ | 18/20 [01:42<00:09,  4.95s/it]
Task 4, Epoch 19/20 => Loss 0.131, Train_accy 77.76:  95%|█████████▌| 19/20 [01:42<00:04,  4.75s/it]
Task 4, Epoch 20/20 => Loss 0.125, Train_accy 78.81:  95%|█████████▌| 19/20 [01:46<00:04,  4.75s/it]
Task 4, Epoch 20/20 => Loss 0.125, Train_accy 78.81: 100%|██████████| 20/20 [01:46<00:00,  4.61s/it]
Task 4, Epoch 20/20 => Loss 0.125, Train_accy 78.81: 100%|██████████| 20/20 [01:46<00:00,  5.33s/it]
2024-04-19 08:41:26,646 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.125, Train_accy 78.81
2024-04-19 08:41:30,673 [trainer.py] => No NME accuracy.
2024-04-19 08:41:30,674 [trainer.py] => CNN: {'total': 22.22, '00-99': 15.58, '100-119': 32.09, '120-139': 27.4, '140-159': 36.22, '160-179': 34.01, 'old': 20.83, 'new': 34.01}
2024-04-19 08:41:30,674 [trainer.py] => CNN top1 curve: [52.08, 36.92, 28.37, 22.36, 22.22]
2024-04-19 08:41:30,674 [trainer.py] => CNN top5 curve: [77.29, 65.23, 57.81, 49.12, 46.88]

Average Accuracy (CNN): 32.39
2024-04-19 08:41:30,674 [trainer.py] => Average Accuracy (CNN): 32.39 

2024-04-19 08:41:30,675 [trainer.py] => Train Time: 1302.8
2024-04-19 08:41:30,675 [trainer.py] => Test Time: 16.549999999999997 

2024-04-19 08:41:30,676 [trainer.py] => All params: 85937076
2024-04-19 08:41:30,678 [trainer.py] => Trainable params: 85937076
2024-04-19 08:41:30,684 [finetune.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.071, Train_accy 1.90, Test_accy 15.80:   0%|          | 0/20 [00:08<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.071, Train_accy 1.90, Test_accy 15.80:   5%|▌         | 1/20 [00:08<02:44,  8.66s/it]
Task 5, Epoch 2/20 => Loss 1.421, Train_accy 20.87:   5%|▌         | 1/20 [00:12<02:44,  8.66s/it]                
Task 5, Epoch 2/20 => Loss 1.421, Train_accy 20.87:  10%|█         | 2/20 [00:12<01:45,  5.84s/it]
Task 5, Epoch 3/20 => Loss 0.870, Train_accy 37.76:  10%|█         | 2/20 [00:16<01:45,  5.84s/it]
Task 5, Epoch 3/20 => Loss 0.870, Train_accy 37.76:  15%|█▌        | 3/20 [00:16<01:23,  4.93s/it]
Task 5, Epoch 4/20 => Loss 0.624, Train_accy 49.15:  15%|█▌        | 3/20 [00:20<01:23,  4.93s/it]
Task 5, Epoch 4/20 => Loss 0.624, Train_accy 49.15:  20%|██        | 4/20 [00:20<01:12,  4.54s/it]
Task 5, Epoch 5/20 => Loss 0.411, Train_accy 63.00:  20%|██        | 4/20 [00:24<01:12,  4.54s/it]
Task 5, Epoch 5/20 => Loss 0.411, Train_accy 63.00:  25%|██▌       | 5/20 [00:24<01:04,  4.30s/it]
Task 5, Epoch 6/20 => Loss 0.341, Train_accy 69.26, Test_accy 18.83:  25%|██▌       | 5/20 [00:32<01:04,  4.30s/it]
Task 5, Epoch 6/20 => Loss 0.341, Train_accy 69.26, Test_accy 18.83:  30%|███       | 6/20 [00:32<01:18,  5.62s/it]
Task 5, Epoch 7/20 => Loss 0.295, Train_accy 74.95:  30%|███       | 6/20 [00:36<01:18,  5.62s/it]                 
Task 5, Epoch 7/20 => Loss 0.295, Train_accy 74.95:  35%|███▌      | 7/20 [00:36<01:05,  5.07s/it]
Task 5, Epoch 8/20 => Loss 0.257, Train_accy 75.90:  35%|███▌      | 7/20 [00:40<01:05,  5.07s/it]
Task 5, Epoch 8/20 => Loss 0.257, Train_accy 75.90:  40%|████      | 8/20 [00:40<00:56,  4.68s/it]
Task 5, Epoch 9/20 => Loss 0.222, Train_accy 77.61:  40%|████      | 8/20 [00:44<00:56,  4.68s/it]
Task 5, Epoch 9/20 => Loss 0.222, Train_accy 77.61:  45%|████▌     | 9/20 [00:44<00:48,  4.44s/it]
Task 5, Epoch 10/20 => Loss 0.167, Train_accy 77.42:  45%|████▌     | 9/20 [00:47<00:48,  4.44s/it]
Task 5, Epoch 10/20 => Loss 0.167, Train_accy 77.42:  50%|█████     | 10/20 [00:47<00:42,  4.25s/it]
Task 5, Epoch 11/20 => Loss 0.191, Train_accy 81.40, Test_accy 19.88:  50%|█████     | 10/20 [00:56<00:42,  4.25s/it]
Task 5, Epoch 11/20 => Loss 0.191, Train_accy 81.40, Test_accy 19.88:  55%|█████▌    | 11/20 [00:56<00:49,  5.52s/it]
Task 5, Epoch 12/20 => Loss 0.189, Train_accy 81.02:  55%|█████▌    | 11/20 [01:00<00:49,  5.52s/it]                 
Task 5, Epoch 12/20 => Loss 0.189, Train_accy 81.02:  60%|██████    | 12/20 [01:00<00:39,  5.00s/it]
Task 5, Epoch 13/20 => Loss 0.168, Train_accy 81.59:  60%|██████    | 12/20 [01:04<00:39,  5.00s/it]
Task 5, Epoch 13/20 => Loss 0.168, Train_accy 81.59:  65%|██████▌   | 13/20 [01:04<00:32,  4.67s/it]
Task 5, Epoch 14/20 => Loss 0.170, Train_accy 80.46:  65%|██████▌   | 13/20 [01:07<00:32,  4.67s/it]
Task 5, Epoch 14/20 => Loss 0.170, Train_accy 80.46:  70%|███████   | 14/20 [01:07<00:26,  4.44s/it]
Task 5, Epoch 15/20 => Loss 0.153, Train_accy 82.16:  70%|███████   | 14/20 [01:11<00:26,  4.44s/it]
Task 5, Epoch 15/20 => Loss 0.153, Train_accy 82.16:  75%|███████▌  | 15/20 [01:11<00:21,  4.27s/it]
Task 5, Epoch 16/20 => Loss 0.149, Train_accy 82.54, Test_accy 20.47:  75%|███████▌  | 15/20 [01:20<00:21,  4.27s/it]
Task 5, Epoch 16/20 => Loss 0.149, Train_accy 82.54, Test_accy 20.47:  80%|████████  | 16/20 [01:20<00:21,  5.45s/it]
Task 5, Epoch 17/20 => Loss 0.142, Train_accy 85.39:  80%|████████  | 16/20 [01:23<00:21,  5.45s/it]                 
Task 5, Epoch 17/20 => Loss 0.142, Train_accy 85.39:  85%|████████▌ | 17/20 [01:23<00:14,  4.98s/it]
Task 5, Epoch 18/20 => Loss 0.094, Train_accy 85.96:  85%|████████▌ | 17/20 [01:27<00:14,  4.98s/it]
Task 5, Epoch 18/20 => Loss 0.094, Train_accy 85.96:  90%|█████████ | 18/20 [01:27<00:09,  4.64s/it]
Task 5, Epoch 19/20 => Loss 0.100, Train_accy 89.75:  90%|█████████ | 18/20 [01:31<00:09,  4.64s/it]
Task 5, Epoch 19/20 => Loss 0.100, Train_accy 89.75:  95%|█████████▌| 19/20 [01:31<00:04,  4.44s/it]
Task 5, Epoch 20/20 => Loss 0.106, Train_accy 86.91:  95%|█████████▌| 19/20 [01:35<00:04,  4.44s/it]
Task 5, Epoch 20/20 => Loss 0.106, Train_accy 86.91: 100%|██████████| 20/20 [01:35<00:00,  4.28s/it]
Task 5, Epoch 20/20 => Loss 0.106, Train_accy 86.91: 100%|██████████| 20/20 [01:35<00:00,  4.78s/it]
2024-04-19 08:43:06,292 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.106, Train_accy 86.91
2024-04-19 08:43:10,589 [trainer.py] => No NME accuracy.
2024-04-19 08:43:10,590 [trainer.py] => CNN: {'total': 19.49, '00-99': 12.96, '100-119': 29.85, '120-139': 20.55, '140-159': 27.56, '160-179': 19.73, '180-199': 42.74, 'old': 17.42, 'new': 42.74}
2024-04-19 08:43:10,590 [trainer.py] => CNN top1 curve: [52.08, 36.92, 28.37, 22.36, 22.22, 19.49]
2024-04-19 08:43:10,590 [trainer.py] => CNN top5 curve: [77.29, 65.23, 57.81, 49.12, 46.88, 41.94]

Average Accuracy (CNN): 30.240000000000006
2024-04-19 08:43:10,590 [trainer.py] => Average Accuracy (CNN): 30.240000000000006 

2024-04-19 08:43:10,590 [trainer.py] => Train Time: 1398.3999999999999
2024-04-19 08:43:10,590 [trainer.py] => Test Time: 20.849999999999998 

Accuracy Matrix (CNN):
[[52.08 33.29 23.07 15.22 15.58 12.96]
 [ 0.   59.7  44.03 38.06 32.09 29.85]
 [ 0.    0.   44.52 35.62 27.4  20.55]
 [ 0.    0.    0.   37.8  36.22 27.56]
 [ 0.    0.    0.    0.   34.01 19.73]
 [ 0.    0.    0.    0.    0.   42.74]]
2024-04-19 08:58:26,659 [trainer.py] => config: ./exps/l2p_ina_B100.json
2024-04-19 08:58:26,659 [trainer.py] => prefix:  
2024-04-19 08:58:26,659 [trainer.py] => dataset: imageneta
2024-04-19 08:58:26,659 [trainer.py] => memory_size: 0
2024-04-19 08:58:26,659 [trainer.py] => memory_per_class: 0
2024-04-19 08:58:26,659 [trainer.py] => fixed_memory: False
2024-04-19 08:58:26,659 [trainer.py] => shuffle: True
2024-04-19 08:58:26,659 [trainer.py] => init_cls: 100
2024-04-19 08:58:26,659 [trainer.py] => increment: 20
2024-04-19 08:58:26,659 [trainer.py] => model_name: l2p
2024-04-19 08:58:26,659 [trainer.py] => backbone_type: vit_base_patch16_224_l2p
2024-04-19 08:58:26,659 [trainer.py] => get_original_backbone: True
2024-04-19 08:58:26,659 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-19 08:58:26,660 [trainer.py] => seed: 1993
2024-04-19 08:58:26,660 [trainer.py] => tuned_epoch: 20
2024-04-19 08:58:26,660 [trainer.py] => init_lr: 0.001875
2024-04-19 08:58:26,660 [trainer.py] => batch_size: 48
2024-04-19 08:58:26,660 [trainer.py] => weight_decay: 0
2024-04-19 08:58:26,660 [trainer.py] => min_lr: 1e-05
2024-04-19 08:58:26,660 [trainer.py] => optimizer: adam
2024-04-19 08:58:26,660 [trainer.py] => scheduler: constant
2024-04-19 08:58:26,660 [trainer.py] => reinit_optimizer: True
2024-04-19 08:58:26,660 [trainer.py] => global_pool: token
2024-04-19 08:58:26,660 [trainer.py] => head_type: prompt
2024-04-19 08:58:26,660 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-19 08:58:26,660 [trainer.py] => pretrained: True
2024-04-19 08:58:26,660 [trainer.py] => drop: 0.0
2024-04-19 08:58:26,660 [trainer.py] => drop_path: 0.0
2024-04-19 08:58:26,660 [trainer.py] => prompt_pool: True
2024-04-19 08:58:26,660 [trainer.py] => size: 10
2024-04-19 08:58:26,660 [trainer.py] => length: 5
2024-04-19 08:58:26,660 [trainer.py] => top_k: 5
2024-04-19 08:58:26,660 [trainer.py] => initializer: uniform
2024-04-19 08:58:26,660 [trainer.py] => prompt_key: True
2024-04-19 08:58:26,660 [trainer.py] => prompt_key_init: uniform
2024-04-19 08:58:26,660 [trainer.py] => use_prompt_mask: False
2024-04-19 08:58:26,660 [trainer.py] => shared_prompt_pool: False
2024-04-19 08:58:26,660 [trainer.py] => shared_prompt_key: False
2024-04-19 08:58:26,660 [trainer.py] => batchwise_prompt: True
2024-04-19 08:58:26,660 [trainer.py] => embedding_key: cls
2024-04-19 08:58:26,660 [trainer.py] => predefined_key: 
2024-04-19 08:58:26,660 [trainer.py] => pull_constraint: True
2024-04-19 08:58:26,660 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-19 08:58:26,687 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-19 08:58:28,338 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-04-19 08:58:28,339 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-04-19 08:58:31,742 [l2p.py] => 86,017,736 model total parameters.
2024-04-19 08:58:31,742 [l2p.py] => 199,880 model training parameters.
2024-04-19 08:58:31,742 [l2p.py] => prompt.prompt: 38400
2024-04-19 08:58:31,742 [l2p.py] => prompt.prompt_key: 7680
2024-04-19 08:58:31,743 [l2p.py] => head.weight: 153600
2024-04-19 08:58:31,743 [l2p.py] => head.bias: 200
2024-04-19 08:58:31,744 [trainer.py] => All params: 171970192
2024-04-19 08:58:31,744 [trainer.py] => Trainable params: 199880
2024-04-19 08:58:31,744 [l2p.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.536, Train_accy 24.65:   0%|          | 0/20 [00:27<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.536, Train_accy 24.65:   5%|▌         | 1/20 [00:27<08:36, 27.17s/it]
Task 0, Epoch 2/20 => Loss 1.733, Train_accy 52.92:   5%|▌         | 1/20 [00:53<08:36, 27.17s/it]
Task 0, Epoch 2/20 => Loss 1.733, Train_accy 52.92:  10%|█         | 2/20 [00:53<08:04, 26.90s/it]
Task 0, Epoch 3/20 => Loss 1.284, Train_accy 64.32:  10%|█         | 2/20 [01:20<08:04, 26.90s/it]
Task 0, Epoch 3/20 => Loss 1.284, Train_accy 64.32:  15%|█▌        | 3/20 [01:20<07:36, 26.87s/it]
Task 0, Epoch 4/20 => Loss 1.070, Train_accy 69.48:  15%|█▌        | 3/20 [01:47<07:36, 26.87s/it]
Task 0, Epoch 4/20 => Loss 1.070, Train_accy 69.48:  20%|██        | 4/20 [01:47<07:09, 26.85s/it]
Task 0, Epoch 5/20 => Loss 0.938, Train_accy 71.58, Test_accy 55.17:  20%|██        | 4/20 [02:19<07:09, 26.85s/it]
Task 0, Epoch 5/20 => Loss 0.938, Train_accy 71.58, Test_accy 55.17:  25%|██▌       | 5/20 [02:19<07:09, 28.61s/it]
Task 0, Epoch 6/20 => Loss 0.795, Train_accy 75.71:  25%|██▌       | 5/20 [02:46<07:09, 28.61s/it]                 
Task 0, Epoch 6/20 => Loss 0.795, Train_accy 75.71:  30%|███       | 6/20 [02:46<06:31, 27.98s/it]
Task 0, Epoch 7/20 => Loss 0.690, Train_accy 77.96:  30%|███       | 6/20 [03:12<06:31, 27.98s/it]
Task 0, Epoch 7/20 => Loss 0.690, Train_accy 77.96:  35%|███▌      | 7/20 [03:12<05:58, 27.60s/it]
Task 0, Epoch 8/20 => Loss 0.710, Train_accy 77.93:  35%|███▌      | 7/20 [03:39<05:58, 27.60s/it]
Task 0, Epoch 8/20 => Loss 0.710, Train_accy 77.93:  40%|████      | 8/20 [03:39<05:28, 27.35s/it]
Task 0, Epoch 9/20 => Loss 0.569, Train_accy 81.37:  40%|████      | 8/20 [04:06<05:28, 27.35s/it]
Task 0, Epoch 9/20 => Loss 0.569, Train_accy 81.37:  45%|████▌     | 9/20 [04:06<04:59, 27.24s/it]
Task 0, Epoch 10/20 => Loss 0.539, Train_accy 81.70, Test_accy 58.15:  45%|████▌     | 9/20 [04:38<04:59, 27.24s/it]
Task 0, Epoch 10/20 => Loss 0.539, Train_accy 81.70, Test_accy 58.15:  50%|█████     | 10/20 [04:38<04:46, 28.61s/it]
Task 0, Epoch 11/20 => Loss 0.527, Train_accy 82.07:  50%|█████     | 10/20 [05:05<04:46, 28.61s/it]                 
Task 0, Epoch 11/20 => Loss 0.527, Train_accy 82.07:  55%|█████▌    | 11/20 [05:05<04:12, 28.07s/it]
Task 0, Epoch 12/20 => Loss 0.445, Train_accy 83.53:  55%|█████▌    | 11/20 [05:32<04:12, 28.07s/it]
Task 0, Epoch 12/20 => Loss 0.445, Train_accy 83.53:  60%|██████    | 12/20 [05:32<03:41, 27.70s/it]
Task 0, Epoch 13/20 => Loss 0.463, Train_accy 83.47:  60%|██████    | 12/20 [05:58<03:41, 27.70s/it]
Task 0, Epoch 13/20 => Loss 0.463, Train_accy 83.47:  65%|██████▌   | 13/20 [05:58<03:11, 27.43s/it]
Task 0, Epoch 14/20 => Loss 0.447, Train_accy 84.65:  65%|██████▌   | 13/20 [06:25<03:11, 27.43s/it]
Task 0, Epoch 14/20 => Loss 0.447, Train_accy 84.65:  70%|███████   | 14/20 [06:25<02:43, 27.28s/it]
Task 0, Epoch 15/20 => Loss 0.419, Train_accy 85.05, Test_accy 57.43:  70%|███████   | 14/20 [06:57<02:43, 27.28s/it]
Task 0, Epoch 15/20 => Loss 0.419, Train_accy 85.05, Test_accy 57.43:  75%|███████▌  | 15/20 [06:57<02:23, 28.66s/it]
Task 0, Epoch 16/20 => Loss 0.371, Train_accy 86.66:  75%|███████▌  | 15/20 [07:24<02:23, 28.66s/it]                 
Task 0, Epoch 16/20 => Loss 0.371, Train_accy 86.66:  80%|████████  | 16/20 [07:24<01:52, 28.10s/it]
Task 0, Epoch 17/20 => Loss 0.410, Train_accy 85.35:  80%|████████  | 16/20 [07:51<01:52, 28.10s/it]
Task 0, Epoch 17/20 => Loss 0.410, Train_accy 85.35:  85%|████████▌ | 17/20 [07:51<01:23, 27.72s/it]
Task 0, Epoch 18/20 => Loss 0.386, Train_accy 85.50:  85%|████████▌ | 17/20 [08:18<01:23, 27.72s/it]
Task 0, Epoch 18/20 => Loss 0.386, Train_accy 85.50:  90%|█████████ | 18/20 [08:18<00:54, 27.49s/it]
Task 0, Epoch 19/20 => Loss 0.370, Train_accy 86.50:  90%|█████████ | 18/20 [08:45<00:54, 27.49s/it]
Task 0, Epoch 19/20 => Loss 0.370, Train_accy 86.50:  95%|█████████▌| 19/20 [08:45<00:27, 27.34s/it]
Task 0, Epoch 20/20 => Loss 0.380, Train_accy 86.17, Test_accy 58.03:  95%|█████████▌| 19/20 [09:16<00:27, 27.34s/it]
Task 0, Epoch 20/20 => Loss 0.380, Train_accy 86.17, Test_accy 58.03: 100%|██████████| 20/20 [09:16<00:00, 28.61s/it]
Task 0, Epoch 20/20 => Loss 0.380, Train_accy 86.17, Test_accy 58.03: 100%|██████████| 20/20 [09:16<00:00, 27.84s/it]
2024-04-19 09:07:49,254 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.380, Train_accy 86.17, Test_accy 58.03
2024-04-19 09:07:54,134 [trainer.py] => No NME accuracy.
2024-04-19 09:07:54,135 [trainer.py] => CNN: {'total': 58.03, '00-99': 58.03, 'old': 0, 'new': 58.03}
2024-04-19 09:07:54,135 [trainer.py] => CNN top1 curve: [58.03]
2024-04-19 09:07:54,135 [trainer.py] => CNN top5 curve: [83.0]

Average Accuracy (CNN): 58.03
2024-04-19 09:07:54,135 [trainer.py] => Average Accuracy (CNN): 58.03 

2024-04-19 09:07:54,135 [trainer.py] => Train Time: 1114.3
2024-04-19 09:07:54,135 [trainer.py] => Test Time: 4.88 

2024-04-19 09:07:54,136 [trainer.py] => All params: 171970192
2024-04-19 09:07:54,137 [trainer.py] => Trainable params: 199880
2024-04-19 09:07:54,137 [l2p.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.899, Train_accy 45.51:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.899, Train_accy 45.51:   5%|▌         | 1/20 [00:04<01:28,  4.64s/it]
Task 1, Epoch 2/20 => Loss 0.548, Train_accy 79.92:   5%|▌         | 1/20 [00:09<01:28,  4.64s/it]
Task 1, Epoch 2/20 => Loss 0.548, Train_accy 79.92:  10%|█         | 2/20 [00:09<01:23,  4.65s/it]
Task 1, Epoch 3/20 => Loss 0.289, Train_accy 87.76:  10%|█         | 2/20 [00:13<01:23,  4.65s/it]
Task 1, Epoch 3/20 => Loss 0.289, Train_accy 87.76:  15%|█▌        | 3/20 [00:13<01:18,  4.64s/it]
Task 1, Epoch 4/20 => Loss 0.127, Train_accy 93.12:  15%|█▌        | 3/20 [00:18<01:18,  4.64s/it]
Task 1, Epoch 4/20 => Loss 0.127, Train_accy 93.12:  20%|██        | 4/20 [00:18<01:14,  4.63s/it]
Task 1, Epoch 5/20 => Loss 0.132, Train_accy 91.97, Test_accy 53.64:  20%|██        | 4/20 [00:28<01:14,  4.63s/it]
Task 1, Epoch 5/20 => Loss 0.132, Train_accy 91.97, Test_accy 53.64:  25%|██▌       | 5/20 [00:28<01:40,  6.68s/it]
Task 1, Epoch 6/20 => Loss 0.110, Train_accy 93.50:  25%|██▌       | 5/20 [00:33<01:40,  6.68s/it]                 
Task 1, Epoch 6/20 => Loss 0.110, Train_accy 93.50:  30%|███       | 6/20 [00:33<01:23,  5.97s/it]
Task 1, Epoch 7/20 => Loss 0.054, Train_accy 95.03:  30%|███       | 6/20 [00:38<01:23,  5.97s/it]
Task 1, Epoch 7/20 => Loss 0.054, Train_accy 95.03:  35%|███▌      | 7/20 [00:38<01:12,  5.54s/it]
Task 1, Epoch 8/20 => Loss 0.075, Train_accy 93.88:  35%|███▌      | 7/20 [00:42<01:12,  5.54s/it]
Task 1, Epoch 8/20 => Loss 0.075, Train_accy 93.88:  40%|████      | 8/20 [00:42<01:02,  5.24s/it]
Task 1, Epoch 9/20 => Loss 0.042, Train_accy 94.07:  40%|████      | 8/20 [00:47<01:02,  5.24s/it]
Task 1, Epoch 9/20 => Loss 0.042, Train_accy 94.07:  45%|████▌     | 9/20 [00:47<00:55,  5.04s/it]
Task 1, Epoch 10/20 => Loss 0.013, Train_accy 96.94, Test_accy 54.05:  45%|████▌     | 9/20 [00:57<00:55,  5.04s/it]
Task 1, Epoch 10/20 => Loss 0.013, Train_accy 96.94, Test_accy 54.05:  50%|█████     | 10/20 [00:57<01:06,  6.61s/it]
Task 1, Epoch 11/20 => Loss -0.007, Train_accy 96.37:  50%|█████     | 10/20 [01:02<01:06,  6.61s/it]                
Task 1, Epoch 11/20 => Loss -0.007, Train_accy 96.37:  55%|█████▌    | 11/20 [01:02<00:54,  6.03s/it]
Task 1, Epoch 12/20 => Loss 0.015, Train_accy 96.18:  55%|█████▌    | 11/20 [01:06<00:54,  6.03s/it] 
Task 1, Epoch 12/20 => Loss 0.015, Train_accy 96.18:  60%|██████    | 12/20 [01:06<00:44,  5.60s/it]
Task 1, Epoch 13/20 => Loss 0.031, Train_accy 95.60:  60%|██████    | 12/20 [01:11<00:44,  5.60s/it]
Task 1, Epoch 13/20 => Loss 0.031, Train_accy 95.60:  65%|██████▌   | 13/20 [01:11<00:37,  5.32s/it]
Task 1, Epoch 14/20 => Loss 0.032, Train_accy 95.60:  65%|██████▌   | 13/20 [01:15<00:37,  5.32s/it]
Task 1, Epoch 14/20 => Loss 0.032, Train_accy 95.60:  70%|███████   | 14/20 [01:15<00:30,  5.09s/it]
Task 1, Epoch 15/20 => Loss 0.008, Train_accy 94.84, Test_accy 54.46:  70%|███████   | 14/20 [01:26<00:30,  5.09s/it]
Task 1, Epoch 15/20 => Loss 0.008, Train_accy 94.84, Test_accy 54.46:  75%|███████▌  | 15/20 [01:26<00:33,  6.67s/it]
Task 1, Epoch 16/20 => Loss -0.017, Train_accy 96.75:  75%|███████▌  | 15/20 [01:30<00:33,  6.67s/it]                
Task 1, Epoch 16/20 => Loss -0.017, Train_accy 96.75:  80%|████████  | 16/20 [01:30<00:24,  6.06s/it]
Task 1, Epoch 17/20 => Loss 0.017, Train_accy 95.60:  80%|████████  | 16/20 [01:35<00:24,  6.06s/it] 
Task 1, Epoch 17/20 => Loss 0.017, Train_accy 95.60:  85%|████████▌ | 17/20 [01:35<00:16,  5.63s/it]
Task 1, Epoch 18/20 => Loss -0.042, Train_accy 97.13:  85%|████████▌ | 17/20 [01:40<00:16,  5.63s/it]
Task 1, Epoch 18/20 => Loss -0.042, Train_accy 97.13:  90%|█████████ | 18/20 [01:40<00:10,  5.32s/it]
Task 1, Epoch 19/20 => Loss -0.032, Train_accy 97.13:  90%|█████████ | 18/20 [01:44<00:10,  5.32s/it]
Task 1, Epoch 19/20 => Loss -0.032, Train_accy 97.13:  95%|█████████▌| 19/20 [01:44<00:05,  5.12s/it]
Task 1, Epoch 20/20 => Loss 0.018, Train_accy 95.98, Test_accy 55.08:  95%|█████████▌| 19/20 [01:55<00:05,  5.12s/it]
Task 1, Epoch 20/20 => Loss 0.018, Train_accy 95.98, Test_accy 55.08: 100%|██████████| 20/20 [01:55<00:00,  6.64s/it]
Task 1, Epoch 20/20 => Loss 0.018, Train_accy 95.98, Test_accy 55.08: 100%|██████████| 20/20 [01:55<00:00,  5.75s/it]
2024-04-19 09:09:49,163 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.018, Train_accy 95.98, Test_accy 55.08
2024-04-19 09:09:54,701 [trainer.py] => No NME accuracy.
2024-04-19 09:09:54,702 [trainer.py] => CNN: {'total': 55.08, '00-99': 57.91, '100-119': 37.31, 'old': 57.91, 'new': 37.31}
2024-04-19 09:09:54,702 [trainer.py] => CNN top1 curve: [58.03, 55.08]
2024-04-19 09:09:54,702 [trainer.py] => CNN top5 curve: [83.0, 81.13]

Average Accuracy (CNN): 56.555
2024-04-19 09:09:54,702 [trainer.py] => Average Accuracy (CNN): 56.555 

2024-04-19 09:09:54,702 [trainer.py] => Train Time: 1344.34
2024-04-19 09:09:54,702 [trainer.py] => Test Time: 10.42 

2024-04-19 09:09:54,705 [trainer.py] => All params: 171970192
2024-04-19 09:09:54,706 [trainer.py] => Trainable params: 199880
2024-04-19 09:09:54,706 [l2p.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.201, Train_accy 35.06:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.201, Train_accy 35.06:   5%|▌         | 1/20 [00:04<01:32,  4.87s/it]
Task 2, Epoch 2/20 => Loss 0.712, Train_accy 74.77:   5%|▌         | 1/20 [00:09<01:32,  4.87s/it]
Task 2, Epoch 2/20 => Loss 0.712, Train_accy 74.77:  10%|█         | 2/20 [00:09<01:26,  4.80s/it]
Task 2, Epoch 3/20 => Loss 0.434, Train_accy 82.19:  10%|█         | 2/20 [00:14<01:26,  4.80s/it]
Task 2, Epoch 3/20 => Loss 0.434, Train_accy 82.19:  15%|█▌        | 3/20 [00:14<01:21,  4.80s/it]
Task 2, Epoch 4/20 => Loss 0.294, Train_accy 88.87:  15%|█▌        | 3/20 [00:19<01:21,  4.80s/it]
Task 2, Epoch 4/20 => Loss 0.294, Train_accy 88.87:  20%|██        | 4/20 [00:19<01:17,  4.86s/it]
Task 2, Epoch 5/20 => Loss 0.252, Train_accy 90.17, Test_accy 50.85:  20%|██        | 4/20 [00:30<01:17,  4.86s/it]
Task 2, Epoch 5/20 => Loss 0.252, Train_accy 90.17, Test_accy 50.85:  25%|██▌       | 5/20 [00:30<01:46,  7.11s/it]
Task 2, Epoch 6/20 => Loss 0.306, Train_accy 88.31:  25%|██▌       | 5/20 [00:35<01:46,  7.11s/it]                 
Task 2, Epoch 6/20 => Loss 0.306, Train_accy 88.31:  30%|███       | 6/20 [00:35<01:28,  6.30s/it]
Task 2, Epoch 7/20 => Loss 0.219, Train_accy 89.80:  30%|███       | 6/20 [00:40<01:28,  6.30s/it]
Task 2, Epoch 7/20 => Loss 0.219, Train_accy 89.80:  35%|███▌      | 7/20 [00:40<01:15,  5.82s/it]
Task 2, Epoch 8/20 => Loss 0.127, Train_accy 92.39:  35%|███▌      | 7/20 [00:44<01:15,  5.82s/it]
Task 2, Epoch 8/20 => Loss 0.127, Train_accy 92.39:  40%|████      | 8/20 [00:44<01:05,  5.47s/it]
Task 2, Epoch 9/20 => Loss 0.155, Train_accy 92.58:  40%|████      | 8/20 [00:49<01:05,  5.47s/it]
Task 2, Epoch 9/20 => Loss 0.155, Train_accy 92.58:  45%|████▌     | 9/20 [00:49<00:57,  5.25s/it]
Task 2, Epoch 10/20 => Loss 0.020, Train_accy 96.47, Test_accy 51.12:  45%|████▌     | 9/20 [01:00<00:57,  5.25s/it]
Task 2, Epoch 10/20 => Loss 0.020, Train_accy 96.47, Test_accy 51.12:  50%|█████     | 10/20 [01:00<01:10,  7.01s/it]
Task 2, Epoch 11/20 => Loss 0.092, Train_accy 93.32:  50%|█████     | 10/20 [01:05<01:10,  7.01s/it]                 
Task 2, Epoch 11/20 => Loss 0.092, Train_accy 93.32:  55%|█████▌    | 11/20 [01:05<00:57,  6.34s/it]
Task 2, Epoch 12/20 => Loss 0.103, Train_accy 92.76:  55%|█████▌    | 11/20 [01:10<00:57,  6.34s/it]
Task 2, Epoch 12/20 => Loss 0.103, Train_accy 92.76:  60%|██████    | 12/20 [01:10<00:46,  5.85s/it]
Task 2, Epoch 13/20 => Loss 0.042, Train_accy 94.99:  60%|██████    | 12/20 [01:14<00:46,  5.85s/it]
Task 2, Epoch 13/20 => Loss 0.042, Train_accy 94.99:  65%|██████▌   | 13/20 [01:14<00:38,  5.52s/it]
Task 2, Epoch 14/20 => Loss 0.073, Train_accy 93.69:  65%|██████▌   | 13/20 [01:19<00:38,  5.52s/it]
Task 2, Epoch 14/20 => Loss 0.073, Train_accy 93.69:  70%|███████   | 14/20 [01:19<00:31,  5.31s/it]
Task 2, Epoch 15/20 => Loss 0.027, Train_accy 95.36, Test_accy 52.10:  70%|███████   | 14/20 [01:30<00:31,  5.31s/it]
Task 2, Epoch 15/20 => Loss 0.027, Train_accy 95.36, Test_accy 52.10:  75%|███████▌  | 15/20 [01:30<00:35,  7.06s/it]
Task 2, Epoch 16/20 => Loss 0.078, Train_accy 93.88:  75%|███████▌  | 15/20 [01:35<00:35,  7.06s/it]                 
Task 2, Epoch 16/20 => Loss 0.078, Train_accy 93.88:  80%|████████  | 16/20 [01:35<00:25,  6.43s/it]
Task 2, Epoch 17/20 => Loss 0.057, Train_accy 95.36:  80%|████████  | 16/20 [01:40<00:25,  6.43s/it]
Task 2, Epoch 17/20 => Loss 0.057, Train_accy 95.36:  85%|████████▌ | 17/20 [01:40<00:17,  5.94s/it]
Task 2, Epoch 18/20 => Loss 0.098, Train_accy 94.25:  85%|████████▌ | 17/20 [01:45<00:17,  5.94s/it]
Task 2, Epoch 18/20 => Loss 0.098, Train_accy 94.25:  90%|█████████ | 18/20 [01:45<00:11,  5.62s/it]
Task 2, Epoch 19/20 => Loss 0.015, Train_accy 96.47:  90%|█████████ | 18/20 [01:50<00:11,  5.62s/it]
Task 2, Epoch 19/20 => Loss 0.015, Train_accy 96.47:  95%|█████████▌| 19/20 [01:50<00:05,  5.38s/it]
Task 2, Epoch 20/20 => Loss 0.002, Train_accy 96.29, Test_accy 52.36:  95%|█████████▌| 19/20 [02:01<00:05,  5.38s/it]
Task 2, Epoch 20/20 => Loss 0.002, Train_accy 96.29, Test_accy 52.36: 100%|██████████| 20/20 [02:01<00:00,  7.09s/it]
Task 2, Epoch 20/20 => Loss 0.002, Train_accy 96.29, Test_accy 52.36: 100%|██████████| 20/20 [02:01<00:00,  6.06s/it]
2024-04-19 09:11:55,982 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.002, Train_accy 96.29, Test_accy 52.36
2024-04-19 09:12:02,260 [trainer.py] => No NME accuracy.
2024-04-19 09:12:02,260 [trainer.py] => CNN: {'total': 52.36, '00-99': 58.62, '100-119': 36.57, '120-139': 30.82, 'old': 55.59, 'new': 30.82}
2024-04-19 09:12:02,260 [trainer.py] => CNN top1 curve: [58.03, 55.08, 52.36]
2024-04-19 09:12:02,260 [trainer.py] => CNN top5 curve: [83.0, 81.13, 79.04]

Average Accuracy (CNN): 55.156666666666666
2024-04-19 09:12:02,260 [trainer.py] => Average Accuracy (CNN): 55.156666666666666 

2024-04-19 09:12:02,260 [trainer.py] => Train Time: 1586.87
2024-04-19 09:12:02,260 [trainer.py] => Test Time: 16.7 

2024-04-19 09:12:02,262 [trainer.py] => All params: 171970192
2024-04-19 09:12:02,263 [trainer.py] => Trainable params: 199880
2024-04-19 09:12:02,263 [l2p.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.126, Train_accy 36.53:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.126, Train_accy 36.53:   5%|▌         | 1/20 [00:04<01:30,  4.74s/it]
Task 3, Epoch 2/20 => Loss 0.614, Train_accy 78.72:   5%|▌         | 1/20 [00:09<01:30,  4.74s/it]
Task 3, Epoch 2/20 => Loss 0.614, Train_accy 78.72:  10%|█         | 2/20 [00:09<01:24,  4.71s/it]
Task 3, Epoch 3/20 => Loss 0.423, Train_accy 85.50:  10%|█         | 2/20 [00:14<01:24,  4.71s/it]
Task 3, Epoch 3/20 => Loss 0.423, Train_accy 85.50:  15%|█▌        | 3/20 [00:14<01:20,  4.74s/it]
Task 3, Epoch 4/20 => Loss 0.269, Train_accy 87.95:  15%|█▌        | 3/20 [00:18<01:20,  4.74s/it]
Task 3, Epoch 4/20 => Loss 0.269, Train_accy 87.95:  20%|██        | 4/20 [00:18<01:15,  4.71s/it]
Task 3, Epoch 5/20 => Loss 0.240, Train_accy 88.32, Test_accy 49.36:  20%|██        | 4/20 [00:30<01:15,  4.71s/it]
Task 3, Epoch 5/20 => Loss 0.240, Train_accy 88.32, Test_accy 49.36:  25%|██▌       | 5/20 [00:30<01:48,  7.24s/it]
Task 3, Epoch 6/20 => Loss 0.174, Train_accy 89.83:  25%|██▌       | 5/20 [00:35<01:48,  7.24s/it]                 
Task 3, Epoch 6/20 => Loss 0.174, Train_accy 89.83:  30%|███       | 6/20 [00:35<01:29,  6.40s/it]
Task 3, Epoch 7/20 => Loss 0.203, Train_accy 92.09:  30%|███       | 6/20 [00:40<01:29,  6.40s/it]
Task 3, Epoch 7/20 => Loss 0.203, Train_accy 92.09:  35%|███▌      | 7/20 [00:40<01:16,  5.87s/it]
Task 3, Epoch 8/20 => Loss 0.093, Train_accy 93.41:  35%|███▌      | 7/20 [00:44<01:16,  5.87s/it]
Task 3, Epoch 8/20 => Loss 0.093, Train_accy 93.41:  40%|████      | 8/20 [00:44<01:06,  5.53s/it]
Task 3, Epoch 9/20 => Loss 0.071, Train_accy 93.97:  40%|████      | 8/20 [00:49<01:06,  5.53s/it]
Task 3, Epoch 9/20 => Loss 0.071, Train_accy 93.97:  45%|████▌     | 9/20 [00:49<00:57,  5.27s/it]
Task 3, Epoch 10/20 => Loss 0.056, Train_accy 93.41, Test_accy 49.44:  45%|████▌     | 9/20 [01:01<00:57,  5.27s/it]
Task 3, Epoch 10/20 => Loss 0.056, Train_accy 93.41, Test_accy 49.44:  50%|█████     | 10/20 [01:01<01:12,  7.30s/it]
Task 3, Epoch 11/20 => Loss 0.043, Train_accy 95.67:  50%|█████     | 10/20 [01:06<01:12,  7.30s/it]                 
Task 3, Epoch 11/20 => Loss 0.043, Train_accy 95.67:  55%|█████▌    | 11/20 [01:06<00:58,  6.51s/it]
Task 3, Epoch 12/20 => Loss 0.068, Train_accy 93.79:  55%|█████▌    | 11/20 [01:10<00:58,  6.51s/it]
Task 3, Epoch 12/20 => Loss 0.068, Train_accy 93.79:  60%|██████    | 12/20 [01:10<00:47,  5.99s/it]
Task 3, Epoch 13/20 => Loss 0.030, Train_accy 95.86:  60%|██████    | 12/20 [01:15<00:47,  5.99s/it]
Task 3, Epoch 13/20 => Loss 0.030, Train_accy 95.86:  65%|██████▌   | 13/20 [01:15<00:39,  5.60s/it]
Task 3, Epoch 14/20 => Loss 0.034, Train_accy 95.67:  65%|██████▌   | 13/20 [01:20<00:39,  5.60s/it]
Task 3, Epoch 14/20 => Loss 0.034, Train_accy 95.67:  70%|███████   | 14/20 [01:20<00:32,  5.35s/it]
Task 3, Epoch 15/20 => Loss 0.025, Train_accy 95.86, Test_accy 49.60:  70%|███████   | 14/20 [01:32<00:32,  5.35s/it]
Task 3, Epoch 15/20 => Loss 0.025, Train_accy 95.86, Test_accy 49.60:  75%|███████▌  | 15/20 [01:32<00:36,  7.25s/it]
Task 3, Epoch 16/20 => Loss 0.005, Train_accy 96.23:  75%|███████▌  | 15/20 [01:36<00:36,  7.25s/it]                 
Task 3, Epoch 16/20 => Loss 0.005, Train_accy 96.23:  80%|████████  | 16/20 [01:36<00:26,  6.51s/it]
Task 3, Epoch 17/20 => Loss 0.035, Train_accy 95.10:  80%|████████  | 16/20 [01:41<00:26,  6.51s/it]
Task 3, Epoch 17/20 => Loss 0.035, Train_accy 95.10:  85%|████████▌ | 17/20 [01:41<00:17,  5.96s/it]
Task 3, Epoch 18/20 => Loss 0.024, Train_accy 95.48:  85%|████████▌ | 17/20 [01:46<00:17,  5.96s/it]
Task 3, Epoch 18/20 => Loss 0.024, Train_accy 95.48:  90%|█████████ | 18/20 [01:46<00:11,  5.58s/it]
Task 3, Epoch 19/20 => Loss 0.158, Train_accy 93.60:  90%|█████████ | 18/20 [01:51<00:11,  5.58s/it]
Task 3, Epoch 19/20 => Loss 0.158, Train_accy 93.60:  95%|█████████▌| 19/20 [01:51<00:05,  5.33s/it]
Task 3, Epoch 20/20 => Loss 0.044, Train_accy 94.35, Test_accy 49.68:  95%|█████████▌| 19/20 [02:02<00:05,  5.33s/it]
Task 3, Epoch 20/20 => Loss 0.044, Train_accy 94.35, Test_accy 49.68: 100%|██████████| 20/20 [02:02<00:00,  7.20s/it]
Task 3, Epoch 20/20 => Loss 0.044, Train_accy 94.35, Test_accy 49.68: 100%|██████████| 20/20 [02:02<00:00,  6.13s/it]
2024-04-19 09:14:04,904 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.044, Train_accy 94.35, Test_accy 49.68
2024-04-19 09:14:11,868 [trainer.py] => No NME accuracy.
2024-04-19 09:14:11,869 [trainer.py] => CNN: {'total': 49.68, '00-99': 58.5, '100-119': 35.82, '120-139': 28.77, '140-159': 29.92, 'old': 51.92, 'new': 29.92}
2024-04-19 09:14:11,869 [trainer.py] => CNN top1 curve: [58.03, 55.08, 52.36, 49.68]
2024-04-19 09:14:11,869 [trainer.py] => CNN top5 curve: [83.0, 81.13, 79.04, 77.16]

Average Accuracy (CNN): 53.7875
2024-04-19 09:14:11,869 [trainer.py] => Average Accuracy (CNN): 53.7875 

2024-04-19 09:14:11,869 [trainer.py] => Train Time: 1832.14
2024-04-19 09:14:11,869 [trainer.py] => Test Time: 23.66 

2024-04-19 09:14:11,870 [trainer.py] => All params: 171970192
2024-04-19 09:14:11,871 [trainer.py] => Trainable params: 199880
2024-04-19 09:14:11,871 [l2p.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.629, Train_accy 27.32:   0%|          | 0/20 [00:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.629, Train_accy 27.32:   5%|▌         | 1/20 [00:05<01:36,  5.07s/it]
Task 4, Epoch 2/20 => Loss 0.903, Train_accy 67.25:   5%|▌         | 1/20 [00:10<01:36,  5.07s/it]
Task 4, Epoch 2/20 => Loss 0.903, Train_accy 67.25:  10%|█         | 2/20 [00:10<01:30,  5.04s/it]
Task 4, Epoch 3/20 => Loss 0.535, Train_accy 80.21:  10%|█         | 2/20 [00:15<01:30,  5.04s/it]
Task 4, Epoch 3/20 => Loss 0.535, Train_accy 80.21:  15%|█▌        | 3/20 [00:15<01:25,  5.05s/it]
Task 4, Epoch 4/20 => Loss 0.366, Train_accy 82.31:  15%|█▌        | 3/20 [00:20<01:25,  5.05s/it]
Task 4, Epoch 4/20 => Loss 0.366, Train_accy 82.31:  20%|██        | 4/20 [00:20<01:21,  5.08s/it]
Task 4, Epoch 5/20 => Loss 0.299, Train_accy 87.22, Test_accy 45.88:  20%|██        | 4/20 [01:06<01:21,  5.08s/it]
Task 4, Epoch 5/20 => Loss 0.299, Train_accy 87.22, Test_accy 45.88:  25%|██▌       | 5/20 [01:06<05:00, 20.01s/it]
Task 4, Epoch 6/20 => Loss 0.225, Train_accy 89.49:  25%|██▌       | 5/20 [01:11<05:00, 20.01s/it]                 
Task 4, Epoch 6/20 => Loss 0.225, Train_accy 89.49:  30%|███       | 6/20 [01:11<03:29, 14.99s/it]
Task 4, Epoch 7/20 => Loss 0.174, Train_accy 90.72:  30%|███       | 6/20 [01:16<03:29, 14.99s/it]
Task 4, Epoch 7/20 => Loss 0.174, Train_accy 90.72:  35%|███▌      | 7/20 [01:16<02:32, 11.72s/it]
Task 4, Epoch 8/20 => Loss 0.174, Train_accy 90.54:  35%|███▌      | 7/20 [01:21<02:32, 11.72s/it]
Task 4, Epoch 8/20 => Loss 0.174, Train_accy 90.54:  40%|████      | 8/20 [01:21<01:54,  9.57s/it]
Task 4, Epoch 9/20 => Loss 0.128, Train_accy 92.64:  40%|████      | 8/20 [01:27<01:54,  9.57s/it]
Task 4, Epoch 9/20 => Loss 0.128, Train_accy 92.64:  45%|████▌     | 9/20 [01:27<01:29,  8.15s/it]
Task 4, Epoch 10/20 => Loss 0.103, Train_accy 93.52, Test_accy 46.95:  45%|████▌     | 9/20 [01:39<01:29,  8.15s/it]
Task 4, Epoch 10/20 => Loss 0.103, Train_accy 93.52, Test_accy 46.95:  50%|█████     | 10/20 [01:39<01:36,  9.64s/it]
Task 4, Epoch 11/20 => Loss 0.109, Train_accy 93.87:  50%|█████     | 10/20 [01:44<01:36,  9.64s/it]                 
Task 4, Epoch 11/20 => Loss 0.109, Train_accy 93.87:  55%|█████▌    | 11/20 [01:44<01:14,  8.22s/it]
Task 4, Epoch 12/20 => Loss 0.115, Train_accy 93.52:  55%|█████▌    | 11/20 [01:50<01:14,  8.22s/it]
Task 4, Epoch 12/20 => Loss 0.115, Train_accy 93.52:  60%|██████    | 12/20 [01:50<00:58,  7.26s/it]
Task 4, Epoch 13/20 => Loss 0.092, Train_accy 92.12:  60%|██████    | 12/20 [01:55<00:58,  7.26s/it]
Task 4, Epoch 13/20 => Loss 0.092, Train_accy 92.12:  65%|██████▌   | 13/20 [01:55<00:46,  6.62s/it]
Task 4, Epoch 14/20 => Loss 0.102, Train_accy 92.64:  65%|██████▌   | 13/20 [02:00<00:46,  6.62s/it]
Task 4, Epoch 14/20 => Loss 0.102, Train_accy 92.64:  70%|███████   | 14/20 [02:00<00:36,  6.12s/it]
Task 4, Epoch 15/20 => Loss 0.085, Train_accy 93.52, Test_accy 47.31:  70%|███████   | 14/20 [02:12<00:36,  6.12s/it]
Task 4, Epoch 15/20 => Loss 0.085, Train_accy 93.52, Test_accy 47.31:  75%|███████▌  | 15/20 [02:12<00:40,  8.12s/it]
Task 4, Epoch 16/20 => Loss 0.084, Train_accy 94.22:  75%|███████▌  | 15/20 [02:18<00:40,  8.12s/it]                 
Task 4, Epoch 16/20 => Loss 0.084, Train_accy 94.22:  80%|████████  | 16/20 [02:18<00:28,  7.21s/it]
Task 4, Epoch 17/20 => Loss 0.059, Train_accy 94.05:  80%|████████  | 16/20 [02:23<00:28,  7.21s/it]
Task 4, Epoch 17/20 => Loss 0.059, Train_accy 94.05:  85%|████████▌ | 17/20 [02:23<00:19,  6.56s/it]
Task 4, Epoch 18/20 => Loss 0.043, Train_accy 93.87:  85%|████████▌ | 17/20 [02:28<00:19,  6.56s/it]
Task 4, Epoch 18/20 => Loss 0.043, Train_accy 93.87:  90%|█████████ | 18/20 [02:28<00:12,  6.09s/it]
Task 4, Epoch 19/20 => Loss 0.066, Train_accy 94.05:  90%|█████████ | 18/20 [02:32<00:12,  6.09s/it]
Task 4, Epoch 19/20 => Loss 0.066, Train_accy 94.05:  95%|█████████▌| 19/20 [02:32<00:05,  5.74s/it]
Task 4, Epoch 20/20 => Loss 0.032, Train_accy 94.92, Test_accy 47.67:  95%|█████████▌| 19/20 [02:45<00:05,  5.74s/it]
Task 4, Epoch 20/20 => Loss 0.032, Train_accy 94.92, Test_accy 47.67: 100%|██████████| 20/20 [02:45<00:00,  7.84s/it]
Task 4, Epoch 20/20 => Loss 0.032, Train_accy 94.92, Test_accy 47.67: 100%|██████████| 20/20 [02:45<00:00,  8.29s/it]
2024-04-19 09:16:57,592 [l2p.py] => Task 4, Epoch 20/20 => Loss 0.032, Train_accy 94.92, Test_accy 47.67
2024-04-19 09:17:05,371 [trainer.py] => No NME accuracy.
2024-04-19 09:17:05,371 [trainer.py] => CNN: {'total': 47.67, '00-99': 59.93, '100-119': 36.57, '120-139': 28.08, '140-159': 30.71, '160-179': 21.77, 'old': 50.72, 'new': 21.77}
2024-04-19 09:17:05,371 [trainer.py] => CNN top1 curve: [58.03, 55.08, 52.36, 49.68, 47.67]
2024-04-19 09:17:05,371 [trainer.py] => CNN top5 curve: [83.0, 81.13, 79.04, 77.16, 74.62]

Average Accuracy (CNN): 52.564
2024-04-19 09:17:05,371 [trainer.py] => Average Accuracy (CNN): 52.564 

2024-04-19 09:17:05,371 [trainer.py] => Train Time: 2163.57
2024-04-19 09:17:05,371 [trainer.py] => Test Time: 31.44 

2024-04-19 09:17:05,372 [trainer.py] => All params: 171970192
2024-04-19 09:17:05,374 [trainer.py] => Trainable params: 199880
2024-04-19 09:17:05,374 [l2p.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.028, Train_accy 41.56:   0%|          | 0/20 [00:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.028, Train_accy 41.56:   5%|▌         | 1/20 [00:04<01:28,  4.67s/it]
Task 5, Epoch 2/20 => Loss 0.553, Train_accy 78.94:   5%|▌         | 1/20 [00:09<01:28,  4.67s/it]
Task 5, Epoch 2/20 => Loss 0.553, Train_accy 78.94:  10%|█         | 2/20 [00:09<01:24,  4.72s/it]
Task 5, Epoch 3/20 => Loss 0.343, Train_accy 86.34:  10%|█         | 2/20 [00:14<01:24,  4.72s/it]
Task 5, Epoch 3/20 => Loss 0.343, Train_accy 86.34:  15%|█▌        | 3/20 [00:14<01:20,  4.71s/it]
Task 5, Epoch 4/20 => Loss 0.205, Train_accy 90.51:  15%|█▌        | 3/20 [00:18<01:20,  4.71s/it]
Task 5, Epoch 4/20 => Loss 0.205, Train_accy 90.51:  20%|██        | 4/20 [00:18<01:15,  4.69s/it]
Task 5, Epoch 5/20 => Loss 0.121, Train_accy 92.41, Test_accy 45.03:  20%|██        | 4/20 [00:31<01:15,  4.69s/it]
Task 5, Epoch 5/20 => Loss 0.121, Train_accy 92.41, Test_accy 45.03:  25%|██▌       | 5/20 [00:31<01:55,  7.73s/it]
Task 5, Epoch 6/20 => Loss 0.141, Train_accy 92.98:  25%|██▌       | 5/20 [00:36<01:55,  7.73s/it]                 
Task 5, Epoch 6/20 => Loss 0.141, Train_accy 92.98:  30%|███       | 6/20 [00:36<01:33,  6.71s/it]
Task 5, Epoch 7/20 => Loss 0.074, Train_accy 93.74:  30%|███       | 6/20 [00:41<01:33,  6.71s/it]
Task 5, Epoch 7/20 => Loss 0.074, Train_accy 93.74:  35%|███▌      | 7/20 [00:41<01:18,  6.04s/it]
Task 5, Epoch 8/20 => Loss 0.121, Train_accy 93.74:  35%|███▌      | 7/20 [00:46<01:18,  6.04s/it]
Task 5, Epoch 8/20 => Loss 0.121, Train_accy 93.74:  40%|████      | 8/20 [00:46<01:07,  5.65s/it]
Task 5, Epoch 9/20 => Loss 0.093, Train_accy 93.55:  40%|████      | 8/20 [00:50<01:07,  5.65s/it]
Task 5, Epoch 9/20 => Loss 0.093, Train_accy 93.55:  45%|████▌     | 9/20 [00:50<00:58,  5.35s/it]
Task 5, Epoch 10/20 => Loss 0.044, Train_accy 95.45, Test_accy 45.56:  45%|████▌     | 9/20 [01:04<00:58,  5.35s/it]
Task 5, Epoch 10/20 => Loss 0.044, Train_accy 95.45, Test_accy 45.56:  50%|█████     | 10/20 [01:04<01:17,  7.79s/it]
Task 5, Epoch 11/20 => Loss 0.080, Train_accy 94.12:  50%|█████     | 10/20 [01:08<01:17,  7.79s/it]                 
Task 5, Epoch 11/20 => Loss 0.080, Train_accy 94.12:  55%|█████▌    | 11/20 [01:08<01:01,  6.84s/it]
Task 5, Epoch 12/20 => Loss 0.039, Train_accy 96.20:  55%|█████▌    | 11/20 [01:13<01:01,  6.84s/it]
Task 5, Epoch 12/20 => Loss 0.039, Train_accy 96.20:  60%|██████    | 12/20 [01:13<00:49,  6.19s/it]
Task 5, Epoch 13/20 => Loss 0.044, Train_accy 95.26:  60%|██████    | 12/20 [01:18<00:49,  6.19s/it]
Task 5, Epoch 13/20 => Loss 0.044, Train_accy 95.26:  65%|██████▌   | 13/20 [01:18<00:40,  5.73s/it]
Task 5, Epoch 14/20 => Loss 0.056, Train_accy 94.50:  65%|██████▌   | 13/20 [01:22<00:40,  5.73s/it]
Task 5, Epoch 14/20 => Loss 0.056, Train_accy 94.50:  70%|███████   | 14/20 [01:22<00:32,  5.44s/it]
Task 5, Epoch 15/20 => Loss -0.013, Train_accy 97.34, Test_accy 45.69:  70%|███████   | 14/20 [01:35<00:32,  5.44s/it]
Task 5, Epoch 15/20 => Loss -0.013, Train_accy 97.34, Test_accy 45.69:  75%|███████▌  | 15/20 [01:35<00:38,  7.74s/it]
Task 5, Epoch 16/20 => Loss -0.001, Train_accy 96.77:  75%|███████▌  | 15/20 [01:40<00:38,  7.74s/it]                 
Task 5, Epoch 16/20 => Loss -0.001, Train_accy 96.77:  80%|████████  | 16/20 [01:40<00:27,  6.83s/it]
Task 5, Epoch 17/20 => Loss 0.052, Train_accy 93.74:  80%|████████  | 16/20 [01:45<00:27,  6.83s/it] 
Task 5, Epoch 17/20 => Loss 0.052, Train_accy 93.74:  85%|████████▌ | 17/20 [01:45<00:18,  6.19s/it]
Task 5, Epoch 18/20 => Loss 0.042, Train_accy 93.93:  85%|████████▌ | 17/20 [01:50<00:18,  6.19s/it]
Task 5, Epoch 18/20 => Loss 0.042, Train_accy 93.93:  90%|█████████ | 18/20 [01:50<00:11,  5.74s/it]
Task 5, Epoch 19/20 => Loss 0.046, Train_accy 95.64:  90%|█████████ | 18/20 [01:54<00:11,  5.74s/it]
Task 5, Epoch 19/20 => Loss 0.046, Train_accy 95.64:  95%|█████████▌| 19/20 [01:54<00:05,  5.41s/it]
Task 5, Epoch 20/20 => Loss 0.009, Train_accy 95.45, Test_accy 45.16:  95%|█████████▌| 19/20 [02:07<00:05,  5.41s/it]
Task 5, Epoch 20/20 => Loss 0.009, Train_accy 95.45, Test_accy 45.16: 100%|██████████| 20/20 [02:07<00:00,  7.71s/it]
Task 5, Epoch 20/20 => Loss 0.009, Train_accy 95.45, Test_accy 45.16: 100%|██████████| 20/20 [02:07<00:00,  6.39s/it]
2024-04-19 09:19:13,176 [l2p.py] => Task 5, Epoch 20/20 => Loss 0.009, Train_accy 95.45, Test_accy 45.16
2024-04-19 09:19:21,411 [trainer.py] => No NME accuracy.
2024-04-19 09:19:21,411 [trainer.py] => CNN: {'total': 45.16, '00-99': 59.45, '100-119': 35.07, '120-139': 23.97, '140-159': 32.28, '160-179': 22.45, '180-199': 24.19, 'old': 47.03, 'new': 24.19}
2024-04-19 09:19:21,411 [trainer.py] => CNN top1 curve: [58.03, 55.08, 52.36, 49.68, 47.67, 45.16]
2024-04-19 09:19:21,411 [trainer.py] => CNN top5 curve: [83.0, 81.13, 79.04, 77.16, 74.62, 73.01]

Average Accuracy (CNN): 51.330000000000005
2024-04-19 09:19:21,411 [trainer.py] => Average Accuracy (CNN): 51.330000000000005 

2024-04-19 09:19:21,411 [trainer.py] => Train Time: 2419.1600000000003
2024-04-19 09:19:21,412 [trainer.py] => Test Time: 39.67 

Accuracy Matrix (CNN):
[[58.03 57.91 58.62 58.5  59.93 59.45]
 [ 0.   37.31 36.57 35.82 36.57 35.07]
 [ 0.    0.   30.82 28.77 28.08 23.97]
 [ 0.    0.    0.   29.92 30.71 32.28]
 [ 0.    0.    0.    0.   21.77 22.45]
 [ 0.    0.    0.    0.    0.   24.19]]
2024-04-19 09:19:21,413 [trainer.py] => Forgetting (CNN): 1.9140000000000001
2024-04-19 09:19:24,935 [trainer.py] => config: ./exps/dualprompt_ina_B100.json
2024-04-19 09:19:24,936 [trainer.py] => prefix:  
2024-04-19 09:19:24,936 [trainer.py] => dataset: imageneta
2024-04-19 09:19:24,936 [trainer.py] => memory_size: 0
2024-04-19 09:19:24,936 [trainer.py] => memory_per_class: 0
2024-04-19 09:19:24,936 [trainer.py] => fixed_memory: False
2024-04-19 09:19:24,936 [trainer.py] => shuffle: True
2024-04-19 09:19:24,936 [trainer.py] => init_cls: 100
2024-04-19 09:19:24,936 [trainer.py] => increment: 20
2024-04-19 09:19:24,936 [trainer.py] => model_name: dualprompt
2024-04-19 09:19:24,936 [trainer.py] => backbone_type: vit_base_patch16_224_dualprompt
2024-04-19 09:19:24,936 [trainer.py] => get_original_backbone: True
2024-04-19 09:19:24,936 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-19 09:19:24,936 [trainer.py] => seed: 1993
2024-04-19 09:19:24,936 [trainer.py] => tuned_epoch: 20
2024-04-19 09:19:24,936 [trainer.py] => init_lr: 0.001
2024-04-19 09:19:24,936 [trainer.py] => batch_size: 48
2024-04-19 09:19:24,936 [trainer.py] => weight_decay: 0
2024-04-19 09:19:24,936 [trainer.py] => min_lr: 1e-05
2024-04-19 09:19:24,936 [trainer.py] => optimizer: adam
2024-04-19 09:19:24,936 [trainer.py] => scheduler: constant
2024-04-19 09:19:24,937 [trainer.py] => reinit_optimizer: True
2024-04-19 09:19:24,937 [trainer.py] => global_pool: token
2024-04-19 09:19:24,937 [trainer.py] => head_type: token
2024-04-19 09:19:24,937 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-19 09:19:24,937 [trainer.py] => pretrained: True
2024-04-19 09:19:24,937 [trainer.py] => drop: 0.0
2024-04-19 09:19:24,937 [trainer.py] => drop_path: 0.0
2024-04-19 09:19:24,937 [trainer.py] => use_g_prompt: True
2024-04-19 09:19:24,937 [trainer.py] => g_prompt_length: 5
2024-04-19 09:19:24,937 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-04-19 09:19:24,937 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-04-19 09:19:24,937 [trainer.py] => use_e_prompt: True
2024-04-19 09:19:24,937 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-04-19 09:19:24,937 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-04-19 09:19:24,937 [trainer.py] => prompt_pool: True
2024-04-19 09:19:24,937 [trainer.py] => size: 10
2024-04-19 09:19:24,937 [trainer.py] => length: 5
2024-04-19 09:19:24,937 [trainer.py] => top_k: 1
2024-04-19 09:19:24,937 [trainer.py] => initializer: uniform
2024-04-19 09:19:24,937 [trainer.py] => prompt_key: True
2024-04-19 09:19:24,937 [trainer.py] => prompt_key_init: uniform
2024-04-19 09:19:24,938 [trainer.py] => use_prompt_mask: True
2024-04-19 09:19:24,938 [trainer.py] => shared_prompt_pool: True
2024-04-19 09:19:24,938 [trainer.py] => shared_prompt_key: False
2024-04-19 09:19:24,938 [trainer.py] => batchwise_prompt: True
2024-04-19 09:19:24,938 [trainer.py] => embedding_key: cls
2024-04-19 09:19:24,938 [trainer.py] => predefined_key: 
2024-04-19 09:19:24,938 [trainer.py] => pull_constraint: True
2024-04-19 09:19:24,938 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-19 09:19:24,938 [trainer.py] => same_key_value: False
2024-04-19 09:19:24,983 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-19 09:19:30,434 [dualprompt.py] => 86,205,896 model total parameters.
2024-04-19 09:19:30,435 [dualprompt.py] => 407,240 model training parameters.
2024-04-19 09:19:30,435 [dualprompt.py] => g_prompt: 15360
2024-04-19 09:19:30,435 [dualprompt.py] => e_prompt.prompt: 230400
2024-04-19 09:19:30,435 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-04-19 09:19:30,435 [dualprompt.py] => head.weight: 153600
2024-04-19 09:19:30,435 [dualprompt.py] => head.bias: 200
2024-04-19 09:19:30,436 [trainer.py] => All params: 172158352
2024-04-19 09:19:30,437 [trainer.py] => Trainable params: 407240
2024-04-19 09:19:30,437 [dualprompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.187, Train_accy 31.22:   0%|          | 0/20 [00:25<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.187, Train_accy 31.22:   5%|▌         | 1/20 [00:25<07:55, 25.01s/it]
Task 0, Epoch 2/20 => Loss 1.338, Train_accy 65.02:   5%|▌         | 1/20 [00:49<07:55, 25.01s/it]
Task 0, Epoch 2/20 => Loss 1.338, Train_accy 65.02:  10%|█         | 2/20 [00:49<07:23, 24.64s/it]
Task 0, Epoch 3/20 => Loss 0.976, Train_accy 73.98:  10%|█         | 2/20 [01:13<07:23, 24.64s/it]
Task 0, Epoch 3/20 => Loss 0.976, Train_accy 73.98:  15%|█▌        | 3/20 [01:13<06:57, 24.58s/it]
Task 0, Epoch 4/20 => Loss 0.798, Train_accy 78.30:  15%|█▌        | 3/20 [01:38<06:57, 24.58s/it]
Task 0, Epoch 4/20 => Loss 0.798, Train_accy 78.30:  20%|██        | 4/20 [01:38<06:33, 24.57s/it]
Task 0, Epoch 5/20 => Loss 0.693, Train_accy 81.22, Test_accy 61.83:  20%|██        | 4/20 [02:07<06:33, 24.57s/it]
Task 0, Epoch 5/20 => Loss 0.693, Train_accy 81.22, Test_accy 61.83:  25%|██▌       | 5/20 [02:07<06:33, 26.22s/it]
Task 0, Epoch 6/20 => Loss 0.640, Train_accy 82.07:  25%|██▌       | 5/20 [02:32<06:33, 26.22s/it]                 
Task 0, Epoch 6/20 => Loss 0.640, Train_accy 82.07:  30%|███       | 6/20 [02:32<05:58, 25.63s/it]
Task 0, Epoch 7/20 => Loss 0.553, Train_accy 85.44:  30%|███       | 6/20 [02:56<05:58, 25.63s/it]
Task 0, Epoch 7/20 => Loss 0.553, Train_accy 85.44:  35%|███▌      | 7/20 [02:56<05:28, 25.26s/it]
Task 0, Epoch 8/20 => Loss 0.523, Train_accy 85.11:  35%|███▌      | 7/20 [03:21<05:28, 25.26s/it]
Task 0, Epoch 8/20 => Loss 0.523, Train_accy 85.11:  40%|████      | 8/20 [03:21<05:00, 25.02s/it]
Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.57:  40%|████      | 8/20 [03:45<05:00, 25.02s/it]
Task 0, Epoch 9/20 => Loss 0.472, Train_accy 86.57:  45%|████▌     | 9/20 [03:45<04:33, 24.82s/it]
Task 0, Epoch 10/20 => Loss 0.479, Train_accy 86.63, Test_accy 63.38:  45%|████▌     | 9/20 [04:14<04:33, 24.82s/it]
Task 0, Epoch 10/20 => Loss 0.479, Train_accy 86.63, Test_accy 63.38:  50%|█████     | 10/20 [04:14<04:22, 26.21s/it]
Task 0, Epoch 11/20 => Loss 0.437, Train_accy 87.81:  50%|█████     | 10/20 [04:39<04:22, 26.21s/it]                 
Task 0, Epoch 11/20 => Loss 0.437, Train_accy 87.81:  55%|█████▌    | 11/20 [04:39<03:50, 25.65s/it]
Task 0, Epoch 12/20 => Loss 0.437, Train_accy 88.05:  55%|█████▌    | 11/20 [05:03<03:50, 25.65s/it]
Task 0, Epoch 12/20 => Loss 0.437, Train_accy 88.05:  60%|██████    | 12/20 [05:03<03:22, 25.31s/it]
Task 0, Epoch 13/20 => Loss 0.428, Train_accy 87.60:  60%|██████    | 12/20 [05:28<03:22, 25.31s/it]
Task 0, Epoch 13/20 => Loss 0.428, Train_accy 87.60:  65%|██████▌   | 13/20 [05:28<02:55, 25.07s/it]
Task 0, Epoch 14/20 => Loss 0.407, Train_accy 88.48:  65%|██████▌   | 13/20 [05:52<02:55, 25.07s/it]
Task 0, Epoch 14/20 => Loss 0.407, Train_accy 88.48:  70%|███████   | 14/20 [05:52<02:29, 24.88s/it]
Task 0, Epoch 15/20 => Loss 0.392, Train_accy 89.18, Test_accy 62.90:  70%|███████   | 14/20 [06:21<02:29, 24.88s/it]
Task 0, Epoch 15/20 => Loss 0.392, Train_accy 89.18, Test_accy 62.90:  75%|███████▌  | 15/20 [06:21<02:10, 26.16s/it]
Task 0, Epoch 16/20 => Loss 0.351, Train_accy 89.73:  75%|███████▌  | 15/20 [06:46<02:10, 26.16s/it]                 
Task 0, Epoch 16/20 => Loss 0.351, Train_accy 89.73:  80%|████████  | 16/20 [06:46<01:42, 25.64s/it]
Task 0, Epoch 17/20 => Loss 0.368, Train_accy 89.42:  80%|████████  | 16/20 [07:10<01:42, 25.64s/it]
Task 0, Epoch 17/20 => Loss 0.368, Train_accy 89.42:  85%|████████▌ | 17/20 [07:10<01:15, 25.30s/it]
Task 0, Epoch 18/20 => Loss 0.338, Train_accy 89.27:  85%|████████▌ | 17/20 [07:35<01:15, 25.30s/it]
Task 0, Epoch 18/20 => Loss 0.338, Train_accy 89.27:  90%|█████████ | 18/20 [07:35<00:50, 25.06s/it]
Task 0, Epoch 19/20 => Loss 0.328, Train_accy 90.27:  90%|█████████ | 18/20 [07:59<00:50, 25.06s/it]
Task 0, Epoch 19/20 => Loss 0.328, Train_accy 90.27:  95%|█████████▌| 19/20 [07:59<00:24, 24.88s/it]
Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.55, Test_accy 60.05:  95%|█████████▌| 19/20 [08:28<00:24, 24.88s/it]
Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.55, Test_accy 60.05: 100%|██████████| 20/20 [08:28<00:00, 26.16s/it]
Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.55, Test_accy 60.05: 100%|██████████| 20/20 [08:28<00:00, 25.44s/it]
2024-04-19 09:28:00,121 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.55, Test_accy 60.05
2024-04-19 09:28:04,847 [trainer.py] => No NME accuracy.
2024-04-19 09:28:04,847 [trainer.py] => CNN: {'total': 60.05, '00-99': 60.05, 'old': 0, 'new': 60.05}
2024-04-19 09:28:04,848 [trainer.py] => CNN top1 curve: [60.05]
2024-04-19 09:28:04,848 [trainer.py] => CNN top5 curve: [84.42]

Average Accuracy (CNN): 60.05
2024-04-19 09:28:04,848 [trainer.py] => Average Accuracy (CNN): 60.05 

2024-04-19 09:28:04,848 [trainer.py] => Train Time: 1018.5
2024-04-19 09:28:04,848 [trainer.py] => Test Time: 4.72 

2024-04-19 09:28:04,851 [trainer.py] => All params: 172158352
2024-04-19 09:28:04,854 [trainer.py] => Trainable params: 407240
2024-04-19 09:28:04,854 [dualprompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.588, Train_accy 34.80:   0%|          | 0/20 [00:04<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.588, Train_accy 34.80:   5%|▌         | 1/20 [00:04<01:23,  4.40s/it]
Task 1, Epoch 2/20 => Loss 0.897, Train_accy 74.95:   5%|▌         | 1/20 [00:08<01:23,  4.40s/it]
Task 1, Epoch 2/20 => Loss 0.897, Train_accy 74.95:  10%|█         | 2/20 [00:08<01:18,  4.38s/it]
Task 1, Epoch 3/20 => Loss 0.505, Train_accy 84.70:  10%|█         | 2/20 [00:12<01:18,  4.38s/it]
Task 1, Epoch 3/20 => Loss 0.505, Train_accy 84.70:  15%|█▌        | 3/20 [00:12<01:13,  4.31s/it]
Task 1, Epoch 4/20 => Loss 0.419, Train_accy 87.95:  15%|█▌        | 3/20 [00:17<01:13,  4.31s/it]
Task 1, Epoch 4/20 => Loss 0.419, Train_accy 87.95:  20%|██        | 4/20 [00:17<01:08,  4.31s/it]
Task 1, Epoch 5/20 => Loss 0.264, Train_accy 92.16, Test_accy 56.10:  20%|██        | 4/20 [00:26<01:08,  4.31s/it]
Task 1, Epoch 5/20 => Loss 0.264, Train_accy 92.16, Test_accy 56.10:  25%|██▌       | 5/20 [00:26<01:32,  6.19s/it]
Task 1, Epoch 6/20 => Loss 0.211, Train_accy 93.50:  25%|██▌       | 5/20 [00:31<01:32,  6.19s/it]                 
Task 1, Epoch 6/20 => Loss 0.211, Train_accy 93.50:  30%|███       | 6/20 [00:31<01:17,  5.56s/it]
Task 1, Epoch 7/20 => Loss 0.247, Train_accy 93.69:  30%|███       | 6/20 [00:35<01:17,  5.56s/it]
Task 1, Epoch 7/20 => Loss 0.247, Train_accy 93.69:  35%|███▌      | 7/20 [00:35<01:06,  5.15s/it]
Task 1, Epoch 8/20 => Loss 0.196, Train_accy 95.03:  35%|███▌      | 7/20 [00:39<01:06,  5.15s/it]
Task 1, Epoch 8/20 => Loss 0.196, Train_accy 95.03:  40%|████      | 8/20 [00:39<00:58,  4.88s/it]
Task 1, Epoch 9/20 => Loss 0.250, Train_accy 93.50:  40%|████      | 8/20 [00:44<00:58,  4.88s/it]
Task 1, Epoch 9/20 => Loss 0.250, Train_accy 93.50:  45%|████▌     | 9/20 [00:44<00:51,  4.68s/it]
Task 1, Epoch 10/20 => Loss 0.172, Train_accy 95.22, Test_accy 56.62:  45%|████▌     | 9/20 [00:53<00:51,  4.68s/it]
Task 1, Epoch 10/20 => Loss 0.172, Train_accy 95.22, Test_accy 56.62:  50%|█████     | 10/20 [00:53<01:02,  6.23s/it]
Task 1, Epoch 11/20 => Loss 0.150, Train_accy 95.60:  50%|█████     | 10/20 [00:58<01:02,  6.23s/it]                 
Task 1, Epoch 11/20 => Loss 0.150, Train_accy 95.60:  55%|█████▌    | 11/20 [00:58<00:50,  5.65s/it]
Task 1, Epoch 12/20 => Loss 0.137, Train_accy 96.18:  55%|█████▌    | 11/20 [01:02<00:50,  5.65s/it]
Task 1, Epoch 12/20 => Loss 0.137, Train_accy 96.18:  60%|██████    | 12/20 [01:02<00:41,  5.21s/it]
Task 1, Epoch 13/20 => Loss 0.091, Train_accy 96.75:  60%|██████    | 12/20 [01:06<00:41,  5.21s/it]
Task 1, Epoch 13/20 => Loss 0.091, Train_accy 96.75:  65%|██████▌   | 13/20 [01:06<00:34,  4.93s/it]
Task 1, Epoch 14/20 => Loss 0.116, Train_accy 96.56:  65%|██████▌   | 13/20 [01:10<00:34,  4.93s/it]
Task 1, Epoch 14/20 => Loss 0.116, Train_accy 96.56:  70%|███████   | 14/20 [01:10<00:28,  4.74s/it]
Task 1, Epoch 15/20 => Loss 0.122, Train_accy 96.56, Test_accy 56.62:  70%|███████   | 14/20 [01:20<00:28,  4.74s/it]
Task 1, Epoch 15/20 => Loss 0.122, Train_accy 96.56, Test_accy 56.62:  75%|███████▌  | 15/20 [01:20<00:31,  6.21s/it]
Task 1, Epoch 16/20 => Loss 0.182, Train_accy 94.26:  75%|███████▌  | 15/20 [01:24<00:31,  6.21s/it]                 
Task 1, Epoch 16/20 => Loss 0.182, Train_accy 94.26:  80%|████████  | 16/20 [01:24<00:22,  5.66s/it]
Task 1, Epoch 17/20 => Loss 0.133, Train_accy 95.60:  80%|████████  | 16/20 [01:29<00:22,  5.66s/it]
Task 1, Epoch 17/20 => Loss 0.133, Train_accy 95.60:  85%|████████▌ | 17/20 [01:29<00:15,  5.29s/it]
Task 1, Epoch 18/20 => Loss 0.117, Train_accy 96.75:  85%|████████▌ | 17/20 [01:33<00:15,  5.29s/it]
Task 1, Epoch 18/20 => Loss 0.117, Train_accy 96.75:  90%|█████████ | 18/20 [01:33<00:09,  4.99s/it]
Task 1, Epoch 19/20 => Loss 0.119, Train_accy 96.56:  90%|█████████ | 18/20 [01:37<00:09,  4.99s/it]
Task 1, Epoch 19/20 => Loss 0.119, Train_accy 96.56:  95%|█████████▌| 19/20 [01:37<00:04,  4.76s/it]
Task 1, Epoch 20/20 => Loss 0.115, Train_accy 95.79, Test_accy 56.51:  95%|█████████▌| 19/20 [01:47<00:04,  4.76s/it]
Task 1, Epoch 20/20 => Loss 0.115, Train_accy 95.79, Test_accy 56.51: 100%|██████████| 20/20 [01:47<00:00,  6.22s/it]
Task 1, Epoch 20/20 => Loss 0.115, Train_accy 95.79, Test_accy 56.51: 100%|██████████| 20/20 [01:47<00:00,  5.37s/it]
2024-04-19 09:29:52,264 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.115, Train_accy 95.79, Test_accy 56.51
2024-04-19 09:29:57,663 [trainer.py] => No NME accuracy.
2024-04-19 09:29:57,663 [trainer.py] => CNN: {'total': 56.51, '00-99': 59.69, '100-119': 36.57, 'old': 59.69, 'new': 36.57}
2024-04-19 09:29:57,663 [trainer.py] => CNN top1 curve: [60.05, 56.51]
2024-04-19 09:29:57,663 [trainer.py] => CNN top5 curve: [84.42, 82.05]

Average Accuracy (CNN): 58.28
2024-04-19 09:29:57,663 [trainer.py] => Average Accuracy (CNN): 58.28 

2024-04-19 09:29:57,663 [trainer.py] => Train Time: 1233.3000000000002
2024-04-19 09:29:57,663 [trainer.py] => Test Time: 10.120000000000001 

2024-04-19 09:29:57,665 [trainer.py] => All params: 172158352
2024-04-19 09:29:57,667 [trainer.py] => Trainable params: 407240
2024-04-19 09:29:57,667 [dualprompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.140, Train_accy 22.08:   0%|          | 0/20 [00:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.140, Train_accy 22.08:   5%|▌         | 1/20 [00:04<01:24,  4.44s/it]
Task 2, Epoch 2/20 => Loss 1.210, Train_accy 65.31:   5%|▌         | 1/20 [00:08<01:24,  4.44s/it]
Task 2, Epoch 2/20 => Loss 1.210, Train_accy 65.31:  10%|█         | 2/20 [00:08<01:19,  4.40s/it]
Task 2, Epoch 3/20 => Loss 0.724, Train_accy 79.96:  10%|█         | 2/20 [00:13<01:19,  4.40s/it]
Task 2, Epoch 3/20 => Loss 0.724, Train_accy 79.96:  15%|█▌        | 3/20 [00:13<01:15,  4.46s/it]
Task 2, Epoch 4/20 => Loss 0.480, Train_accy 84.97:  15%|█▌        | 3/20 [00:17<01:15,  4.46s/it]
Task 2, Epoch 4/20 => Loss 0.480, Train_accy 84.97:  20%|██        | 4/20 [00:17<01:11,  4.44s/it]
Task 2, Epoch 5/20 => Loss 0.360, Train_accy 89.80, Test_accy 52.36:  20%|██        | 4/20 [00:28<01:11,  4.44s/it]
Task 2, Epoch 5/20 => Loss 0.360, Train_accy 89.80, Test_accy 52.36:  25%|██▌       | 5/20 [00:28<01:38,  6.60s/it]
Task 2, Epoch 6/20 => Loss 0.399, Train_accy 89.24:  25%|██▌       | 5/20 [00:32<01:38,  6.60s/it]                 
Task 2, Epoch 6/20 => Loss 0.399, Train_accy 89.24:  30%|███       | 6/20 [00:32<01:22,  5.86s/it]
Task 2, Epoch 7/20 => Loss 0.272, Train_accy 93.14:  30%|███       | 6/20 [00:37<01:22,  5.86s/it]
Task 2, Epoch 7/20 => Loss 0.272, Train_accy 93.14:  35%|███▌      | 7/20 [00:37<01:10,  5.41s/it]
Task 2, Epoch 8/20 => Loss 0.330, Train_accy 92.02:  35%|███▌      | 7/20 [00:41<01:10,  5.41s/it]
Task 2, Epoch 8/20 => Loss 0.330, Train_accy 92.02:  40%|████      | 8/20 [00:41<01:00,  5.08s/it]
Task 2, Epoch 9/20 => Loss 0.187, Train_accy 94.99:  40%|████      | 8/20 [00:45<01:00,  5.08s/it]
Task 2, Epoch 9/20 => Loss 0.187, Train_accy 94.99:  45%|████▌     | 9/20 [00:45<00:53,  4.87s/it]
Task 2, Epoch 10/20 => Loss 0.227, Train_accy 93.32, Test_accy 52.90:  45%|████▌     | 9/20 [00:56<00:53,  4.87s/it]
Task 2, Epoch 10/20 => Loss 0.227, Train_accy 93.32, Test_accy 52.90:  50%|█████     | 10/20 [00:56<01:06,  6.66s/it]
Task 2, Epoch 11/20 => Loss 0.212, Train_accy 94.25:  50%|█████     | 10/20 [01:00<01:06,  6.66s/it]                 
Task 2, Epoch 11/20 => Loss 0.212, Train_accy 94.25:  55%|█████▌    | 11/20 [01:00<00:53,  5.96s/it]
Task 2, Epoch 12/20 => Loss 0.194, Train_accy 94.62:  55%|█████▌    | 11/20 [01:05<00:53,  5.96s/it]
Task 2, Epoch 12/20 => Loss 0.194, Train_accy 94.62:  60%|██████    | 12/20 [01:05<00:44,  5.50s/it]
Task 2, Epoch 13/20 => Loss 0.205, Train_accy 94.06:  60%|██████    | 12/20 [01:09<00:44,  5.50s/it]
Task 2, Epoch 13/20 => Loss 0.205, Train_accy 94.06:  65%|██████▌   | 13/20 [01:09<00:36,  5.16s/it]
Task 2, Epoch 14/20 => Loss 0.160, Train_accy 95.36:  65%|██████▌   | 13/20 [01:14<00:36,  5.16s/it]
Task 2, Epoch 14/20 => Loss 0.160, Train_accy 95.36:  70%|███████   | 14/20 [01:14<00:29,  4.94s/it]
Task 2, Epoch 15/20 => Loss 0.154, Train_accy 95.55, Test_accy 52.63:  70%|███████   | 14/20 [01:24<00:29,  4.94s/it]
Task 2, Epoch 15/20 => Loss 0.154, Train_accy 95.55, Test_accy 52.63:  75%|███████▌  | 15/20 [01:24<00:33,  6.61s/it]
Task 2, Epoch 16/20 => Loss 0.099, Train_accy 96.85:  75%|███████▌  | 15/20 [01:29<00:33,  6.61s/it]                 
Task 2, Epoch 16/20 => Loss 0.099, Train_accy 96.85:  80%|████████  | 16/20 [01:29<00:23,  5.94s/it]
Task 2, Epoch 17/20 => Loss 0.156, Train_accy 94.06:  80%|████████  | 16/20 [01:33<00:23,  5.94s/it]
Task 2, Epoch 17/20 => Loss 0.156, Train_accy 94.06:  85%|████████▌ | 17/20 [01:33<00:16,  5.47s/it]
Task 2, Epoch 18/20 => Loss 0.151, Train_accy 94.43:  85%|████████▌ | 17/20 [01:37<00:16,  5.47s/it]
Task 2, Epoch 18/20 => Loss 0.151, Train_accy 94.43:  90%|█████████ | 18/20 [01:37<00:10,  5.16s/it]
Task 2, Epoch 19/20 => Loss 0.088, Train_accy 97.40:  90%|█████████ | 18/20 [01:42<00:10,  5.16s/it]
Task 2, Epoch 19/20 => Loss 0.088, Train_accy 97.40:  95%|█████████▌| 19/20 [01:42<00:04,  4.95s/it]
Task 2, Epoch 20/20 => Loss 0.133, Train_accy 96.10, Test_accy 52.63:  95%|█████████▌| 19/20 [01:52<00:04,  4.95s/it]
Task 2, Epoch 20/20 => Loss 0.133, Train_accy 96.10, Test_accy 52.63: 100%|██████████| 20/20 [01:52<00:00,  6.59s/it]
Task 2, Epoch 20/20 => Loss 0.133, Train_accy 96.10, Test_accy 52.63: 100%|██████████| 20/20 [01:52<00:00,  5.64s/it]
2024-04-19 09:31:50,403 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.133, Train_accy 96.10, Test_accy 52.63
2024-04-19 09:31:56,450 [trainer.py] => No NME accuracy.
2024-04-19 09:31:56,451 [trainer.py] => CNN: {'total': 52.63, '00-99': 58.98, '100-119': 35.82, '120-139': 31.51, 'old': 55.79, 'new': 31.51}
2024-04-19 09:31:56,451 [trainer.py] => CNN top1 curve: [60.05, 56.51, 52.63]
2024-04-19 09:31:56,451 [trainer.py] => CNN top5 curve: [84.42, 82.05, 79.84]

Average Accuracy (CNN): 56.39666666666667
2024-04-19 09:31:56,451 [trainer.py] => Average Accuracy (CNN): 56.39666666666667 

2024-04-19 09:31:56,451 [trainer.py] => Train Time: 1458.7500000000002
2024-04-19 09:31:56,451 [trainer.py] => Test Time: 16.17 

2024-04-19 09:31:56,453 [trainer.py] => All params: 172158352
2024-04-19 09:31:56,455 [trainer.py] => Trainable params: 407240
2024-04-19 09:31:56,455 [dualprompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.707, Train_accy 25.61:   0%|          | 0/20 [00:04<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.707, Train_accy 25.61:   5%|▌         | 1/20 [00:04<01:24,  4.47s/it]
Task 3, Epoch 2/20 => Loss 1.034, Train_accy 69.30:   5%|▌         | 1/20 [00:08<01:24,  4.47s/it]
Task 3, Epoch 2/20 => Loss 1.034, Train_accy 69.30:  10%|█         | 2/20 [00:08<01:18,  4.35s/it]
Task 3, Epoch 3/20 => Loss 0.620, Train_accy 81.92:  10%|█         | 2/20 [00:13<01:18,  4.35s/it]
Task 3, Epoch 3/20 => Loss 0.620, Train_accy 81.92:  15%|█▌        | 3/20 [00:13<01:14,  4.36s/it]
Task 3, Epoch 4/20 => Loss 0.372, Train_accy 88.32:  15%|█▌        | 3/20 [00:17<01:14,  4.36s/it]
Task 3, Epoch 4/20 => Loss 0.372, Train_accy 88.32:  20%|██        | 4/20 [00:17<01:09,  4.37s/it]
Task 3, Epoch 5/20 => Loss 0.336, Train_accy 89.27, Test_accy 50.08:  20%|██        | 4/20 [00:28<01:09,  4.37s/it]
Task 3, Epoch 5/20 => Loss 0.336, Train_accy 89.27, Test_accy 50.08:  25%|██▌       | 5/20 [00:28<01:41,  6.75s/it]
Task 3, Epoch 6/20 => Loss 0.332, Train_accy 89.83:  25%|██▌       | 5/20 [00:32<01:41,  6.75s/it]                 
Task 3, Epoch 6/20 => Loss 0.332, Train_accy 89.83:  30%|███       | 6/20 [00:32<01:23,  5.94s/it]
Task 3, Epoch 7/20 => Loss 0.279, Train_accy 92.47:  30%|███       | 6/20 [00:37<01:23,  5.94s/it]
Task 3, Epoch 7/20 => Loss 0.279, Train_accy 92.47:  35%|███▌      | 7/20 [00:37<01:10,  5.40s/it]
Task 3, Epoch 8/20 => Loss 0.277, Train_accy 93.22:  35%|███▌      | 7/20 [00:41<01:10,  5.40s/it]
Task 3, Epoch 8/20 => Loss 0.277, Train_accy 93.22:  40%|████      | 8/20 [00:41<01:00,  5.08s/it]
Task 3, Epoch 9/20 => Loss 0.223, Train_accy 92.84:  40%|████      | 8/20 [00:45<01:00,  5.08s/it]
Task 3, Epoch 9/20 => Loss 0.223, Train_accy 92.84:  45%|████▌     | 9/20 [00:45<00:53,  4.84s/it]
Task 3, Epoch 10/20 => Loss 0.178, Train_accy 93.79, Test_accy 50.32:  45%|████▌     | 9/20 [00:56<00:53,  4.84s/it]
Task 3, Epoch 10/20 => Loss 0.178, Train_accy 93.79, Test_accy 50.32:  50%|█████     | 10/20 [00:56<01:07,  6.76s/it]
Task 3, Epoch 11/20 => Loss 0.189, Train_accy 94.35:  50%|█████     | 10/20 [01:01<01:07,  6.76s/it]                 
Task 3, Epoch 11/20 => Loss 0.189, Train_accy 94.35:  55%|█████▌    | 11/20 [01:01<00:54,  6.02s/it]
Task 3, Epoch 12/20 => Loss 0.186, Train_accy 95.10:  55%|█████▌    | 11/20 [01:05<00:54,  6.02s/it]
Task 3, Epoch 12/20 => Loss 0.186, Train_accy 95.10:  60%|██████    | 12/20 [01:05<00:44,  5.54s/it]
Task 3, Epoch 13/20 => Loss 0.138, Train_accy 96.61:  60%|██████    | 12/20 [01:10<00:44,  5.54s/it]
Task 3, Epoch 13/20 => Loss 0.138, Train_accy 96.61:  65%|██████▌   | 13/20 [01:10<00:36,  5.21s/it]
Task 3, Epoch 14/20 => Loss 0.194, Train_accy 93.79:  65%|██████▌   | 13/20 [01:14<00:36,  5.21s/it]
Task 3, Epoch 14/20 => Loss 0.194, Train_accy 93.79:  70%|███████   | 14/20 [01:14<00:29,  4.94s/it]
Task 3, Epoch 15/20 => Loss 0.108, Train_accy 97.18, Test_accy 51.04:  70%|███████   | 14/20 [01:25<00:29,  4.94s/it]
Task 3, Epoch 15/20 => Loss 0.108, Train_accy 97.18, Test_accy 51.04:  75%|███████▌  | 15/20 [01:25<00:33,  6.79s/it]
Task 3, Epoch 16/20 => Loss 0.120, Train_accy 97.18:  75%|███████▌  | 15/20 [01:29<00:33,  6.79s/it]                 
Task 3, Epoch 16/20 => Loss 0.120, Train_accy 97.18:  80%|████████  | 16/20 [01:29<00:24,  6.07s/it]
Task 3, Epoch 17/20 => Loss 0.102, Train_accy 96.80:  80%|████████  | 16/20 [01:34<00:24,  6.07s/it]
Task 3, Epoch 17/20 => Loss 0.102, Train_accy 96.80:  85%|████████▌ | 17/20 [01:34<00:16,  5.55s/it]
Task 3, Epoch 18/20 => Loss 0.115, Train_accy 96.61:  85%|████████▌ | 17/20 [01:38<00:16,  5.55s/it]
Task 3, Epoch 18/20 => Loss 0.115, Train_accy 96.61:  90%|█████████ | 18/20 [01:38<00:10,  5.18s/it]
Task 3, Epoch 19/20 => Loss 0.111, Train_accy 96.99:  90%|█████████ | 18/20 [01:43<00:10,  5.18s/it]
Task 3, Epoch 19/20 => Loss 0.111, Train_accy 96.99:  95%|█████████▌| 19/20 [01:43<00:04,  4.96s/it]
Task 3, Epoch 20/20 => Loss 0.198, Train_accy 94.92, Test_accy 50.88:  95%|█████████▌| 19/20 [01:54<00:04,  4.96s/it]
Task 3, Epoch 20/20 => Loss 0.198, Train_accy 94.92, Test_accy 50.88: 100%|██████████| 20/20 [01:54<00:00,  6.85s/it]
Task 3, Epoch 20/20 => Loss 0.198, Train_accy 94.92, Test_accy 50.88: 100%|██████████| 20/20 [01:54<00:00,  5.71s/it]
2024-04-19 09:33:50,743 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.198, Train_accy 94.92, Test_accy 50.88
2024-04-19 09:33:57,360 [trainer.py] => No NME accuracy.
2024-04-19 09:33:57,360 [trainer.py] => CNN: {'total': 50.88, '00-99': 58.86, '100-119': 35.07, '120-139': 31.51, '140-159': 37.01, 'old': 52.45, 'new': 37.01}
2024-04-19 09:33:57,360 [trainer.py] => CNN top1 curve: [60.05, 56.51, 52.63, 50.88]
2024-04-19 09:33:57,361 [trainer.py] => CNN top5 curve: [84.42, 82.05, 79.84, 77.64]

Average Accuracy (CNN): 55.0175
2024-04-19 09:33:57,361 [trainer.py] => Average Accuracy (CNN): 55.0175 

2024-04-19 09:33:57,361 [trainer.py] => Train Time: 1687.3200000000002
2024-04-19 09:33:57,361 [trainer.py] => Test Time: 22.78 

2024-04-19 09:33:57,364 [trainer.py] => All params: 172158352
2024-04-19 09:33:57,366 [trainer.py] => Trainable params: 407240
2024-04-19 09:33:57,366 [dualprompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.988, Train_accy 22.42:   0%|          | 0/20 [00:04<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.988, Train_accy 22.42:   5%|▌         | 1/20 [00:04<01:29,  4.71s/it]
Task 4, Epoch 2/20 => Loss 1.274, Train_accy 62.87:   5%|▌         | 1/20 [00:09<01:29,  4.71s/it]
Task 4, Epoch 2/20 => Loss 1.274, Train_accy 62.87:  10%|█         | 2/20 [00:09<01:23,  4.63s/it]
Task 4, Epoch 3/20 => Loss 0.721, Train_accy 77.76:  10%|█         | 2/20 [00:13<01:23,  4.63s/it]
Task 4, Epoch 3/20 => Loss 0.721, Train_accy 77.76:  15%|█▌        | 3/20 [00:13<01:18,  4.63s/it]
Task 4, Epoch 4/20 => Loss 0.546, Train_accy 84.76:  15%|█▌        | 3/20 [00:18<01:18,  4.63s/it]
Task 4, Epoch 4/20 => Loss 0.546, Train_accy 84.76:  20%|██        | 4/20 [00:18<01:14,  4.69s/it]
Task 4, Epoch 5/20 => Loss 0.443, Train_accy 85.29, Test_accy 47.10:  20%|██        | 4/20 [00:30<01:14,  4.69s/it]
Task 4, Epoch 5/20 => Loss 0.443, Train_accy 85.29, Test_accy 47.10:  25%|██▌       | 5/20 [00:30<01:49,  7.33s/it]
Task 4, Epoch 6/20 => Loss 0.407, Train_accy 88.44:  25%|██▌       | 5/20 [00:35<01:49,  7.33s/it]                 
Task 4, Epoch 6/20 => Loss 0.407, Train_accy 88.44:  30%|███       | 6/20 [00:35<01:30,  6.43s/it]
Task 4, Epoch 7/20 => Loss 0.383, Train_accy 89.49:  30%|███       | 6/20 [00:40<01:30,  6.43s/it]
Task 4, Epoch 7/20 => Loss 0.383, Train_accy 89.49:  35%|███▌      | 7/20 [00:40<01:16,  5.85s/it]
Task 4, Epoch 8/20 => Loss 0.308, Train_accy 90.72:  35%|███▌      | 7/20 [00:44<01:16,  5.85s/it]
Task 4, Epoch 8/20 => Loss 0.308, Train_accy 90.72:  40%|████      | 8/20 [00:44<01:05,  5.49s/it]
Task 4, Epoch 9/20 => Loss 0.245, Train_accy 92.64:  40%|████      | 8/20 [00:49<01:05,  5.49s/it]
Task 4, Epoch 9/20 => Loss 0.245, Train_accy 92.64:  45%|████▌     | 9/20 [00:49<00:57,  5.26s/it]
Task 4, Epoch 10/20 => Loss 0.276, Train_accy 92.12, Test_accy 47.31:  45%|████▌     | 9/20 [01:01<00:57,  5.26s/it]
Task 4, Epoch 10/20 => Loss 0.276, Train_accy 92.12, Test_accy 47.31:  50%|█████     | 10/20 [01:01<01:13,  7.31s/it]
Task 4, Epoch 11/20 => Loss 0.231, Train_accy 92.47:  50%|█████     | 10/20 [01:06<01:13,  7.31s/it]                 
Task 4, Epoch 11/20 => Loss 0.231, Train_accy 92.47:  55%|█████▌    | 11/20 [01:06<00:58,  6.50s/it]
Task 4, Epoch 12/20 => Loss 0.215, Train_accy 93.52:  55%|█████▌    | 11/20 [01:10<00:58,  6.50s/it]
Task 4, Epoch 12/20 => Loss 0.215, Train_accy 93.52:  60%|██████    | 12/20 [01:10<00:47,  5.98s/it]
Task 4, Epoch 13/20 => Loss 0.182, Train_accy 95.45:  60%|██████    | 12/20 [01:15<00:47,  5.98s/it]
Task 4, Epoch 13/20 => Loss 0.182, Train_accy 95.45:  65%|██████▌   | 13/20 [01:15<00:38,  5.56s/it]
Task 4, Epoch 14/20 => Loss 0.198, Train_accy 94.75:  65%|██████▌   | 13/20 [01:20<00:38,  5.56s/it]
Task 4, Epoch 14/20 => Loss 0.198, Train_accy 94.75:  70%|███████   | 14/20 [01:20<00:31,  5.29s/it]
Task 4, Epoch 15/20 => Loss 0.221, Train_accy 93.17, Test_accy 48.17:  70%|███████   | 14/20 [01:32<00:31,  5.29s/it]
Task 4, Epoch 15/20 => Loss 0.221, Train_accy 93.17, Test_accy 48.17:  75%|███████▌  | 15/20 [01:32<00:36,  7.31s/it]
Task 4, Epoch 16/20 => Loss 0.205, Train_accy 93.52:  75%|███████▌  | 15/20 [01:36<00:36,  7.31s/it]                 
Task 4, Epoch 16/20 => Loss 0.205, Train_accy 93.52:  80%|████████  | 16/20 [01:36<00:25,  6.50s/it]
Task 4, Epoch 17/20 => Loss 0.185, Train_accy 94.57:  80%|████████  | 16/20 [01:41<00:25,  6.50s/it]
Task 4, Epoch 17/20 => Loss 0.185, Train_accy 94.57:  85%|████████▌ | 17/20 [01:41<00:17,  5.93s/it]
Task 4, Epoch 18/20 => Loss 0.173, Train_accy 94.57:  85%|████████▌ | 17/20 [01:45<00:17,  5.93s/it]
Task 4, Epoch 18/20 => Loss 0.173, Train_accy 94.57:  90%|█████████ | 18/20 [01:45<00:11,  5.54s/it]
Task 4, Epoch 19/20 => Loss 0.161, Train_accy 96.15:  90%|█████████ | 18/20 [01:50<00:11,  5.54s/it]
Task 4, Epoch 19/20 => Loss 0.161, Train_accy 96.15:  95%|█████████▌| 19/20 [01:50<00:05,  5.25s/it]
Task 4, Epoch 20/20 => Loss 0.172, Train_accy 94.40, Test_accy 47.96:  95%|█████████▌| 19/20 [02:02<00:05,  5.25s/it]
Task 4, Epoch 20/20 => Loss 0.172, Train_accy 94.40, Test_accy 47.96: 100%|██████████| 20/20 [02:02<00:00,  7.26s/it]
Task 4, Epoch 20/20 => Loss 0.172, Train_accy 94.40, Test_accy 47.96: 100%|██████████| 20/20 [02:02<00:00,  6.13s/it]
2024-04-19 09:35:59,893 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.172, Train_accy 94.40, Test_accy 47.96
2024-04-19 09:36:07,192 [trainer.py] => No NME accuracy.
2024-04-19 09:36:07,193 [trainer.py] => CNN: {'total': 47.96, '00-99': 58.15, '100-119': 35.82, '120-139': 31.51, '140-159': 37.01, '160-179': 26.53, 'old': 50.48, 'new': 26.53}
2024-04-19 09:36:07,193 [trainer.py] => CNN top1 curve: [60.05, 56.51, 52.63, 50.88, 47.96]
2024-04-19 09:36:07,193 [trainer.py] => CNN top5 curve: [84.42, 82.05, 79.84, 77.64, 75.91]

Average Accuracy (CNN): 53.605999999999995
2024-04-19 09:36:07,194 [trainer.py] => Average Accuracy (CNN): 53.605999999999995 

2024-04-19 09:36:07,194 [trainer.py] => Train Time: 1932.3500000000001
2024-04-19 09:36:07,194 [trainer.py] => Test Time: 30.080000000000002 

2024-04-19 09:36:07,197 [trainer.py] => All params: 172158352
2024-04-19 09:36:07,200 [trainer.py] => Trainable params: 407240
2024-04-19 09:36:07,200 [dualprompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.820, Train_accy 27.32:   0%|          | 0/20 [00:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.820, Train_accy 27.32:   5%|▌         | 1/20 [00:04<01:22,  4.32s/it]
Task 5, Epoch 2/20 => Loss 1.061, Train_accy 68.50:   5%|▌         | 1/20 [00:08<01:22,  4.32s/it]
Task 5, Epoch 2/20 => Loss 1.061, Train_accy 68.50:  10%|█         | 2/20 [00:08<01:18,  4.33s/it]
Task 5, Epoch 3/20 => Loss 0.619, Train_accy 81.21:  10%|█         | 2/20 [00:12<01:18,  4.33s/it]
Task 5, Epoch 3/20 => Loss 0.619, Train_accy 81.21:  15%|█▌        | 3/20 [00:12<01:13,  4.33s/it]
Task 5, Epoch 4/20 => Loss 0.453, Train_accy 86.34:  15%|█▌        | 3/20 [00:17<01:13,  4.33s/it]
Task 5, Epoch 4/20 => Loss 0.453, Train_accy 86.34:  20%|██        | 4/20 [00:17<01:09,  4.32s/it]
Task 5, Epoch 5/20 => Loss 0.291, Train_accy 91.08, Test_accy 46.54:  20%|██        | 4/20 [00:29<01:09,  4.32s/it]
Task 5, Epoch 5/20 => Loss 0.291, Train_accy 91.08, Test_accy 46.54:  25%|██▌       | 5/20 [00:29<01:47,  7.17s/it]
Task 5, Epoch 6/20 => Loss 0.290, Train_accy 92.60:  25%|██▌       | 5/20 [00:33<01:47,  7.17s/it]                 
Task 5, Epoch 6/20 => Loss 0.290, Train_accy 92.60:  30%|███       | 6/20 [00:33<01:27,  6.24s/it]
Task 5, Epoch 7/20 => Loss 0.223, Train_accy 93.55:  30%|███       | 6/20 [00:38<01:27,  6.24s/it]
Task 5, Epoch 7/20 => Loss 0.223, Train_accy 93.55:  35%|███▌      | 7/20 [00:38<01:13,  5.63s/it]
Task 5, Epoch 8/20 => Loss 0.215, Train_accy 93.93:  35%|███▌      | 7/20 [00:42<01:13,  5.63s/it]
Task 5, Epoch 8/20 => Loss 0.215, Train_accy 93.93:  40%|████      | 8/20 [00:42<01:03,  5.27s/it]
Task 5, Epoch 9/20 => Loss 0.199, Train_accy 94.31:  40%|████      | 8/20 [00:47<01:03,  5.27s/it]
Task 5, Epoch 9/20 => Loss 0.199, Train_accy 94.31:  45%|████▌     | 9/20 [00:47<00:55,  5.01s/it]
Task 5, Epoch 10/20 => Loss 0.194, Train_accy 94.88, Test_accy 46.68:  45%|████▌     | 9/20 [01:00<00:55,  5.01s/it]
Task 5, Epoch 10/20 => Loss 0.194, Train_accy 94.88, Test_accy 46.68:  50%|█████     | 10/20 [01:00<01:14,  7.43s/it]
Task 5, Epoch 11/20 => Loss 0.183, Train_accy 93.74:  50%|█████     | 10/20 [01:04<01:14,  7.43s/it]                 
Task 5, Epoch 11/20 => Loss 0.183, Train_accy 93.74:  55%|█████▌    | 11/20 [01:04<00:58,  6.49s/it]
Task 5, Epoch 12/20 => Loss 0.197, Train_accy 94.69:  55%|█████▌    | 11/20 [01:08<00:58,  6.49s/it]
Task 5, Epoch 12/20 => Loss 0.197, Train_accy 94.69:  60%|██████    | 12/20 [01:08<00:46,  5.87s/it]
Task 5, Epoch 13/20 => Loss 0.167, Train_accy 94.88:  60%|██████    | 12/20 [01:13<00:46,  5.87s/it]
Task 5, Epoch 13/20 => Loss 0.167, Train_accy 94.88:  65%|██████▌   | 13/20 [01:13<00:37,  5.43s/it]
Task 5, Epoch 14/20 => Loss 0.121, Train_accy 96.02:  65%|██████▌   | 13/20 [01:17<00:37,  5.43s/it]
Task 5, Epoch 14/20 => Loss 0.121, Train_accy 96.02:  70%|███████   | 14/20 [01:17<00:30,  5.13s/it]
Task 5, Epoch 15/20 => Loss 0.122, Train_accy 96.20, Test_accy 46.81:  70%|███████   | 14/20 [01:30<00:30,  5.13s/it]
Task 5, Epoch 15/20 => Loss 0.122, Train_accy 96.20, Test_accy 46.81:  75%|███████▌  | 15/20 [01:30<00:36,  7.39s/it]
Task 5, Epoch 16/20 => Loss 0.118, Train_accy 96.20:  75%|███████▌  | 15/20 [01:34<00:36,  7.39s/it]                 
Task 5, Epoch 16/20 => Loss 0.118, Train_accy 96.20:  80%|████████  | 16/20 [01:34<00:26,  6.50s/it]
Task 5, Epoch 17/20 => Loss 0.130, Train_accy 95.45:  80%|████████  | 16/20 [01:39<00:26,  6.50s/it]
Task 5, Epoch 17/20 => Loss 0.130, Train_accy 95.45:  85%|████████▌ | 17/20 [01:39<00:17,  5.88s/it]
Task 5, Epoch 18/20 => Loss 0.097, Train_accy 97.34:  85%|████████▌ | 17/20 [01:43<00:17,  5.88s/it]
Task 5, Epoch 18/20 => Loss 0.097, Train_accy 97.34:  90%|█████████ | 18/20 [01:43<00:10,  5.44s/it]
Task 5, Epoch 19/20 => Loss 0.132, Train_accy 95.26:  90%|█████████ | 18/20 [01:48<00:10,  5.44s/it]
Task 5, Epoch 19/20 => Loss 0.132, Train_accy 95.26:  95%|█████████▌| 19/20 [01:48<00:05,  5.15s/it]
Task 5, Epoch 20/20 => Loss 0.128, Train_accy 96.96, Test_accy 47.00:  95%|█████████▌| 19/20 [02:00<00:05,  5.15s/it]
Task 5, Epoch 20/20 => Loss 0.128, Train_accy 96.96, Test_accy 47.00: 100%|██████████| 20/20 [02:00<00:00,  7.41s/it]
Task 5, Epoch 20/20 => Loss 0.128, Train_accy 96.96, Test_accy 47.00: 100%|██████████| 20/20 [02:00<00:00,  6.04s/it]
2024-04-19 09:38:08,052 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.128, Train_accy 96.96, Test_accy 47.00
2024-04-19 09:38:16,062 [trainer.py] => No NME accuracy.
2024-04-19 09:38:16,062 [trainer.py] => CNN: {'total': 47.0, '00-99': 57.91, '100-119': 35.82, '120-139': 30.82, '140-159': 37.8, '160-179': 26.53, '180-199': 37.9, 'old': 47.81, 'new': 37.9}
2024-04-19 09:38:16,062 [trainer.py] => CNN top1 curve: [60.05, 56.51, 52.63, 50.88, 47.96, 47.0]
2024-04-19 09:38:16,062 [trainer.py] => CNN top5 curve: [84.42, 82.05, 79.84, 77.64, 75.91, 74.72]

Average Accuracy (CNN): 52.504999999999995
2024-04-19 09:38:16,062 [trainer.py] => Average Accuracy (CNN): 52.504999999999995 

2024-04-19 09:38:16,062 [trainer.py] => Train Time: 2174.0200000000004
2024-04-19 09:38:16,062 [trainer.py] => Test Time: 38.09 

Accuracy Matrix (CNN):
[[60.05 59.69 58.98 58.86 58.15 57.91]
 [ 0.   36.57 35.82 35.07 35.82 35.82]
 [ 0.    0.   31.51 31.51 31.51 30.82]
 [ 0.    0.    0.   37.01 37.01 37.8 ]
 [ 0.    0.    0.    0.   26.53 26.53]
 [ 0.    0.    0.    0.    0.   37.9 ]]
2024-04-19 09:38:16,063 [trainer.py] => Forgetting (CNN): 0.7160000000000004
2024-04-19 09:38:18,944 [trainer.py] => config: ./exps/coda_prompt_ina_B100.json
2024-04-19 09:38:18,944 [trainer.py] => prefix:  
2024-04-19 09:38:18,944 [trainer.py] => dataset: imageneta
2024-04-19 09:38:18,944 [trainer.py] => memory_size: 0
2024-04-19 09:38:18,944 [trainer.py] => memory_per_class: 0
2024-04-19 09:38:18,944 [trainer.py] => fixed_memory: False
2024-04-19 09:38:18,944 [trainer.py] => shuffle: False
2024-04-19 09:38:18,944 [trainer.py] => init_cls: 100
2024-04-19 09:38:18,944 [trainer.py] => increment: 20
2024-04-19 09:38:18,944 [trainer.py] => model_name: coda_prompt
2024-04-19 09:38:18,944 [trainer.py] => backbone_type: vit_base_patch16_224_coda_prompt
2024-04-19 09:38:18,944 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-19 09:38:18,944 [trainer.py] => seed: 1993
2024-04-19 09:38:18,944 [trainer.py] => tuned_epoch: 20
2024-04-19 09:38:18,944 [trainer.py] => init_lr: 0.001
2024-04-19 09:38:18,944 [trainer.py] => batch_size: 48
2024-04-19 09:38:18,945 [trainer.py] => weight_decay: 0
2024-04-19 09:38:18,945 [trainer.py] => min_lr: 1e-05
2024-04-19 09:38:18,945 [trainer.py] => optimizer: adam
2024-04-19 09:38:18,945 [trainer.py] => scheduler: cosine
2024-04-19 09:38:18,945 [trainer.py] => reinit_optimizer: True
2024-04-19 09:38:18,945 [trainer.py] => pretrained: True
2024-04-19 09:38:18,945 [trainer.py] => drop: 0.0
2024-04-19 09:38:18,945 [trainer.py] => drop_path: 0.0
2024-04-19 09:38:18,945 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-04-19 09:38:18,976 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2024-04-19 09:38:22,063 [coda_prompt.py] => 89,792,456 total parameters.
2024-04-19 09:38:22,063 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-04-19 09:38:22,064 [trainer.py] => All params: 89792456
2024-04-19 09:38:22,065 [trainer.py] => Trainable params: 89792456
2024-04-19 09:38:22,065 [coda_prompt.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.112, Train_accy 33.43:   0%|          | 0/20 [00:39<?, ?it/s]
Task 0, Epoch 1/20 => Loss 3.112, Train_accy 33.43:   5%|▌         | 1/20 [00:39<12:39, 39.95s/it]
Task 0, Epoch 2/20 => Loss 1.353, Train_accy 66.03:   5%|▌         | 1/20 [01:19<12:39, 39.95s/it]
Task 0, Epoch 2/20 => Loss 1.353, Train_accy 66.03:  10%|█         | 2/20 [01:19<11:54, 39.67s/it]
Task 0, Epoch 3/20 => Loss 1.069, Train_accy 71.99:  10%|█         | 2/20 [01:59<11:54, 39.67s/it]
Task 0, Epoch 3/20 => Loss 1.069, Train_accy 71.99:  15%|█▌        | 3/20 [01:59<11:14, 39.67s/it]
Task 0, Epoch 4/20 => Loss 0.897, Train_accy 76.73:  15%|█▌        | 3/20 [02:38<11:14, 39.67s/it]
Task 0, Epoch 4/20 => Loss 0.897, Train_accy 76.73:  20%|██        | 4/20 [02:38<10:35, 39.70s/it]
Task 0, Epoch 5/20 => Loss 0.769, Train_accy 79.81, Test_accy 67.86:  20%|██        | 4/20 [03:24<10:35, 39.70s/it]
Task 0, Epoch 5/20 => Loss 0.769, Train_accy 79.81, Test_accy 67.86:  25%|██▌       | 5/20 [03:24<10:26, 41.75s/it]
Task 0, Epoch 6/20 => Loss 0.712, Train_accy 81.63:  25%|██▌       | 5/20 [04:03<10:26, 41.75s/it]                 
Task 0, Epoch 6/20 => Loss 0.712, Train_accy 81.63:  30%|███       | 6/20 [04:03<09:34, 41.06s/it]
Task 0, Epoch 7/20 => Loss 0.652, Train_accy 83.36:  30%|███       | 6/20 [04:43<09:34, 41.06s/it]
Task 0, Epoch 7/20 => Loss 0.652, Train_accy 83.36:  35%|███▌      | 7/20 [04:43<08:47, 40.60s/it]
Task 0, Epoch 8/20 => Loss 0.615, Train_accy 84.07:  35%|███▌      | 7/20 [05:23<08:47, 40.60s/it]
Task 0, Epoch 8/20 => Loss 0.615, Train_accy 84.07:  40%|████      | 8/20 [05:23<08:03, 40.28s/it]
Task 0, Epoch 9/20 => Loss 0.574, Train_accy 84.68:  40%|████      | 8/20 [06:03<08:03, 40.28s/it]
Task 0, Epoch 9/20 => Loss 0.574, Train_accy 84.68:  45%|████▌     | 9/20 [06:03<07:21, 40.14s/it]
Task 0, Epoch 10/20 => Loss 0.535, Train_accy 85.63, Test_accy 69.61:  45%|████▌     | 9/20 [06:48<07:21, 40.14s/it]
Task 0, Epoch 10/20 => Loss 0.535, Train_accy 85.63, Test_accy 69.61:  50%|█████     | 10/20 [06:48<06:57, 41.80s/it]
Task 0, Epoch 11/20 => Loss 0.482, Train_accy 87.17:  50%|█████     | 10/20 [07:28<06:57, 41.80s/it]                 
Task 0, Epoch 11/20 => Loss 0.482, Train_accy 87.17:  55%|█████▌    | 11/20 [07:28<06:10, 41.13s/it]
Task 0, Epoch 12/20 => Loss 0.492, Train_accy 87.26:  55%|█████▌    | 11/20 [08:07<06:10, 41.13s/it]
Task 0, Epoch 12/20 => Loss 0.492, Train_accy 87.26:  60%|██████    | 12/20 [08:07<05:25, 40.72s/it]
Task 0, Epoch 13/20 => Loss 0.463, Train_accy 88.02:  60%|██████    | 12/20 [08:47<05:25, 40.72s/it]
Task 0, Epoch 13/20 => Loss 0.463, Train_accy 88.02:  65%|██████▌   | 13/20 [08:47<04:42, 40.38s/it]
Task 0, Epoch 14/20 => Loss 0.474, Train_accy 87.22:  65%|██████▌   | 13/20 [09:27<04:42, 40.38s/it]
Task 0, Epoch 14/20 => Loss 0.474, Train_accy 87.22:  70%|███████   | 14/20 [09:27<04:00, 40.10s/it]
Task 0, Epoch 15/20 => Loss 0.462, Train_accy 87.83, Test_accy 67.31:  70%|███████   | 14/20 [10:12<04:00, 40.10s/it]
Task 0, Epoch 15/20 => Loss 0.462, Train_accy 87.83, Test_accy 67.31:  75%|███████▌  | 15/20 [10:12<03:28, 41.71s/it]
Task 0, Epoch 16/20 => Loss 0.418, Train_accy 88.99:  75%|███████▌  | 15/20 [10:52<03:28, 41.71s/it]                 
Task 0, Epoch 16/20 => Loss 0.418, Train_accy 88.99:  80%|████████  | 16/20 [10:52<02:44, 41.12s/it]
Task 0, Epoch 17/20 => Loss 0.421, Train_accy 89.06:  80%|████████  | 16/20 [11:31<02:44, 41.12s/it]
Task 0, Epoch 17/20 => Loss 0.421, Train_accy 89.06:  85%|████████▌ | 17/20 [11:31<02:02, 40.68s/it]
Task 0, Epoch 18/20 => Loss 0.374, Train_accy 90.36:  85%|████████▌ | 17/20 [12:11<02:02, 40.68s/it]
Task 0, Epoch 18/20 => Loss 0.374, Train_accy 90.36:  90%|█████████ | 18/20 [12:11<01:20, 40.44s/it]
Task 0, Epoch 19/20 => Loss 0.407, Train_accy 89.16:  90%|█████████ | 18/20 [12:51<01:20, 40.44s/it]
Task 0, Epoch 19/20 => Loss 0.407, Train_accy 89.16:  95%|█████████▌| 19/20 [12:51<00:40, 40.22s/it]
Task 0, Epoch 20/20 => Loss 0.368, Train_accy 90.01, Test_accy 69.52:  95%|█████████▌| 19/20 [13:37<00:40, 40.22s/it]
Task 0, Epoch 20/20 => Loss 0.368, Train_accy 90.01, Test_accy 69.52: 100%|██████████| 20/20 [13:37<00:00, 41.83s/it]
Task 0, Epoch 20/20 => Loss 0.368, Train_accy 90.01, Test_accy 69.52: 100%|██████████| 20/20 [13:37<00:00, 40.85s/it]
2024-04-19 09:51:59,740 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.368, Train_accy 90.01, Test_accy 69.52
2024-04-19 09:52:05,542 [trainer.py] => No NME accuracy.
2024-04-19 09:52:05,542 [trainer.py] => CNN: {'total': 69.52, '00-99': 69.52, 'old': 0, 'new': 69.52}
2024-04-19 09:52:05,542 [trainer.py] => CNN top1 curve: [69.52]
2024-04-19 09:52:05,542 [trainer.py] => CNN top5 curve: [88.77]

Average Accuracy (CNN): 69.52
2024-04-19 09:52:05,542 [trainer.py] => Average Accuracy (CNN): 69.52 

2024-04-19 09:52:05,542 [trainer.py] => Train Time: 1634.69
2024-04-19 09:52:05,542 [trainer.py] => Test Time: 5.8 

2024-04-19 09:52:05,543 [trainer.py] => All params: 89792456
2024-04-19 09:52:05,544 [trainer.py] => Trainable params: 89792456
2024-04-19 09:52:06,488 [coda_prompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.874, Train_accy 7.50:   0%|          | 0/20 [00:02<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.874, Train_accy 7.50:   5%|▌         | 1/20 [00:02<00:52,  2.74s/it]
Task 1, Epoch 2/20 => Loss 2.411, Train_accy 32.50:   5%|▌         | 1/20 [00:05<00:52,  2.74s/it]
Task 1, Epoch 2/20 => Loss 2.411, Train_accy 32.50:  10%|█         | 2/20 [00:05<00:48,  2.72s/it]
Task 1, Epoch 3/20 => Loss 1.567, Train_accy 53.75:  10%|█         | 2/20 [00:08<00:48,  2.72s/it]
Task 1, Epoch 3/20 => Loss 1.567, Train_accy 53.75:  15%|█▌        | 3/20 [00:08<00:45,  2.70s/it]
Task 1, Epoch 4/20 => Loss 1.010, Train_accy 72.50:  15%|█▌        | 3/20 [00:10<00:45,  2.70s/it]
Task 1, Epoch 4/20 => Loss 1.010, Train_accy 72.50:  20%|██        | 4/20 [00:10<00:43,  2.69s/it]
Task 1, Epoch 5/20 => Loss 0.801, Train_accy 76.67, Test_accy 65.86:  20%|██        | 4/20 [00:19<00:43,  2.69s/it]
Task 1, Epoch 5/20 => Loss 0.801, Train_accy 76.67, Test_accy 65.86:  25%|██▌       | 5/20 [00:19<01:14,  4.99s/it]
Task 1, Epoch 6/20 => Loss 0.538, Train_accy 85.42:  25%|██▌       | 5/20 [00:22<01:14,  4.99s/it]                 
Task 1, Epoch 6/20 => Loss 0.538, Train_accy 85.42:  30%|███       | 6/20 [00:22<00:58,  4.18s/it]
Task 1, Epoch 7/20 => Loss 0.427, Train_accy 88.75:  30%|███       | 6/20 [00:25<00:58,  4.18s/it]
Task 1, Epoch 7/20 => Loss 0.427, Train_accy 88.75:  35%|███▌      | 7/20 [00:25<00:48,  3.70s/it]
Task 1, Epoch 8/20 => Loss 0.341, Train_accy 90.83:  35%|███▌      | 7/20 [00:27<00:48,  3.70s/it]
Task 1, Epoch 8/20 => Loss 0.341, Train_accy 90.83:  40%|████      | 8/20 [00:27<00:40,  3.36s/it]
Task 1, Epoch 9/20 => Loss 0.305, Train_accy 91.25:  40%|████      | 8/20 [00:30<00:40,  3.36s/it]
Task 1, Epoch 9/20 => Loss 0.305, Train_accy 91.25:  45%|████▌     | 9/20 [00:30<00:34,  3.15s/it]
Task 1, Epoch 10/20 => Loss 0.259, Train_accy 93.33, Test_accy 65.69:  45%|████▌     | 9/20 [00:39<00:34,  3.15s/it]
Task 1, Epoch 10/20 => Loss 0.259, Train_accy 93.33, Test_accy 65.69:  50%|█████     | 10/20 [00:39<00:48,  4.88s/it]
Task 1, Epoch 11/20 => Loss 0.197, Train_accy 95.83:  50%|█████     | 10/20 [00:41<00:48,  4.88s/it]                 
Task 1, Epoch 11/20 => Loss 0.197, Train_accy 95.83:  55%|█████▌    | 11/20 [00:41<00:37,  4.21s/it]
Task 1, Epoch 12/20 => Loss 0.330, Train_accy 92.08:  55%|█████▌    | 11/20 [00:44<00:37,  4.21s/it]
Task 1, Epoch 12/20 => Loss 0.330, Train_accy 92.08:  60%|██████    | 12/20 [00:44<00:30,  3.77s/it]
Task 1, Epoch 13/20 => Loss 0.181, Train_accy 95.00:  60%|██████    | 12/20 [00:47<00:30,  3.77s/it]
Task 1, Epoch 13/20 => Loss 0.181, Train_accy 95.00:  65%|██████▌   | 13/20 [00:47<00:24,  3.47s/it]
Task 1, Epoch 14/20 => Loss 0.225, Train_accy 93.75:  65%|██████▌   | 13/20 [00:50<00:24,  3.47s/it]
Task 1, Epoch 14/20 => Loss 0.225, Train_accy 93.75:  70%|███████   | 14/20 [00:50<00:19,  3.22s/it]
Task 1, Epoch 15/20 => Loss 0.229, Train_accy 93.75, Test_accy 65.77:  70%|███████   | 14/20 [00:58<00:19,  3.22s/it]
Task 1, Epoch 15/20 => Loss 0.229, Train_accy 93.75, Test_accy 65.77:  75%|███████▌  | 15/20 [00:58<00:24,  4.92s/it]
Task 1, Epoch 16/20 => Loss 0.197, Train_accy 96.25:  75%|███████▌  | 15/20 [01:01<00:24,  4.92s/it]                 
Task 1, Epoch 16/20 => Loss 0.197, Train_accy 96.25:  80%|████████  | 16/20 [01:01<00:16,  4.22s/it]
Task 1, Epoch 17/20 => Loss 0.242, Train_accy 93.75:  80%|████████  | 16/20 [01:04<00:16,  4.22s/it]
Task 1, Epoch 17/20 => Loss 0.242, Train_accy 93.75:  85%|████████▌ | 17/20 [01:04<00:11,  3.75s/it]
Task 1, Epoch 18/20 => Loss 0.150, Train_accy 96.67:  85%|████████▌ | 17/20 [01:06<00:11,  3.75s/it]
Task 1, Epoch 18/20 => Loss 0.150, Train_accy 96.67:  90%|█████████ | 18/20 [01:06<00:06,  3.41s/it]
Task 1, Epoch 19/20 => Loss 0.219, Train_accy 95.00:  90%|█████████ | 18/20 [01:09<00:06,  3.41s/it]
Task 1, Epoch 19/20 => Loss 0.219, Train_accy 95.00:  95%|█████████▌| 19/20 [01:09<00:03,  3.17s/it]
Task 1, Epoch 20/20 => Loss 0.163, Train_accy 96.67, Test_accy 65.86:  95%|█████████▌| 19/20 [01:18<00:03,  3.17s/it]
Task 1, Epoch 20/20 => Loss 0.163, Train_accy 96.67, Test_accy 65.86: 100%|██████████| 20/20 [01:18<00:00,  4.84s/it]
Task 1, Epoch 20/20 => Loss 0.163, Train_accy 96.67, Test_accy 65.86: 100%|██████████| 20/20 [01:18<00:00,  3.91s/it]
2024-04-19 09:53:24,713 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.163, Train_accy 96.67, Test_accy 65.86
2024-04-19 09:53:30,856 [trainer.py] => No NME accuracy.
2024-04-19 09:53:30,856 [trainer.py] => CNN: {'total': 65.86, '00-99': 68.88, '100-119': 19.72, 'old': 68.88, 'new': 19.72}
2024-04-19 09:53:30,856 [trainer.py] => CNN top1 curve: [69.52, 65.86]
2024-04-19 09:53:30,856 [trainer.py] => CNN top5 curve: [88.77, 86.0]

Average Accuracy (CNN): 67.69
2024-04-19 09:53:30,857 [trainer.py] => Average Accuracy (CNN): 67.69 

2024-04-19 09:53:30,857 [trainer.py] => Train Time: 1791.13
2024-04-19 09:53:30,857 [trainer.py] => Test Time: 11.94 

2024-04-19 09:53:30,858 [trainer.py] => All params: 89792456
2024-04-19 09:53:30,859 [trainer.py] => Trainable params: 89792456
2024-04-19 09:53:32,213 [coda_prompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.594, Train_accy 13.99:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.594, Train_accy 13.99:   5%|▌         | 1/20 [00:03<01:05,  3.47s/it]
Task 2, Epoch 2/20 => Loss 1.873, Train_accy 46.73:   5%|▌         | 1/20 [00:07<01:05,  3.47s/it]
Task 2, Epoch 2/20 => Loss 1.873, Train_accy 46.73:  10%|█         | 2/20 [00:07<01:05,  3.62s/it]
Task 2, Epoch 3/20 => Loss 1.001, Train_accy 72.62:  10%|█         | 2/20 [00:10<01:05,  3.62s/it]
Task 2, Epoch 3/20 => Loss 1.001, Train_accy 72.62:  15%|█▌        | 3/20 [00:10<01:01,  3.64s/it]
Task 2, Epoch 4/20 => Loss 0.844, Train_accy 76.79:  15%|█▌        | 3/20 [00:14<01:01,  3.64s/it]
Task 2, Epoch 4/20 => Loss 0.844, Train_accy 76.79:  20%|██        | 4/20 [00:14<00:58,  3.65s/it]
Task 2, Epoch 5/20 => Loss 0.587, Train_accy 82.14, Test_accy 62.50:  20%|██        | 4/20 [00:24<00:58,  3.65s/it]
Task 2, Epoch 5/20 => Loss 0.587, Train_accy 82.14, Test_accy 62.50:  25%|██▌       | 5/20 [00:24<01:29,  5.99s/it]
Task 2, Epoch 6/20 => Loss 0.475, Train_accy 86.90:  25%|██▌       | 5/20 [00:28<01:29,  5.99s/it]                 
Task 2, Epoch 6/20 => Loss 0.475, Train_accy 86.90:  30%|███       | 6/20 [00:28<01:12,  5.20s/it]
Task 2, Epoch 7/20 => Loss 0.318, Train_accy 91.37:  30%|███       | 6/20 [00:31<01:12,  5.20s/it]
Task 2, Epoch 7/20 => Loss 0.318, Train_accy 91.37:  35%|███▌      | 7/20 [00:31<01:00,  4.68s/it]
Task 2, Epoch 8/20 => Loss 0.283, Train_accy 92.26:  35%|███▌      | 7/20 [00:35<01:00,  4.68s/it]
Task 2, Epoch 8/20 => Loss 0.283, Train_accy 92.26:  40%|████      | 8/20 [00:35<00:52,  4.38s/it]
Task 2, Epoch 9/20 => Loss 0.316, Train_accy 89.88:  40%|████      | 8/20 [00:39<00:52,  4.38s/it]
Task 2, Epoch 9/20 => Loss 0.316, Train_accy 89.88:  45%|████▌     | 9/20 [00:39<00:45,  4.16s/it]
Task 2, Epoch 10/20 => Loss 0.278, Train_accy 91.07, Test_accy 62.58:  45%|████▌     | 9/20 [00:49<00:45,  4.16s/it]
Task 2, Epoch 10/20 => Loss 0.278, Train_accy 91.07, Test_accy 62.58:  50%|█████     | 10/20 [00:49<01:00,  6.06s/it]
Task 2, Epoch 11/20 => Loss 0.241, Train_accy 94.35:  50%|█████     | 10/20 [00:53<01:00,  6.06s/it]                 
Task 2, Epoch 11/20 => Loss 0.241, Train_accy 94.35:  55%|█████▌    | 11/20 [00:53<00:47,  5.30s/it]
Task 2, Epoch 12/20 => Loss 0.163, Train_accy 95.24:  55%|█████▌    | 11/20 [00:56<00:47,  5.30s/it]
Task 2, Epoch 12/20 => Loss 0.163, Train_accy 95.24:  60%|██████    | 12/20 [00:56<00:38,  4.80s/it]
Task 2, Epoch 13/20 => Loss 0.217, Train_accy 94.94:  60%|██████    | 12/20 [01:00<00:38,  4.80s/it]
Task 2, Epoch 13/20 => Loss 0.217, Train_accy 94.94:  65%|██████▌   | 13/20 [01:00<00:31,  4.48s/it]
Task 2, Epoch 14/20 => Loss 0.182, Train_accy 95.24:  65%|██████▌   | 13/20 [01:04<00:31,  4.48s/it]
Task 2, Epoch 14/20 => Loss 0.182, Train_accy 95.24:  70%|███████   | 14/20 [01:04<00:25,  4.20s/it]
Task 2, Epoch 15/20 => Loss 0.226, Train_accy 94.94, Test_accy 62.74:  70%|███████   | 14/20 [01:14<00:25,  4.20s/it]
Task 2, Epoch 15/20 => Loss 0.226, Train_accy 94.94, Test_accy 62.74:  75%|███████▌  | 15/20 [01:14<00:30,  6.10s/it]
Task 2, Epoch 16/20 => Loss 0.218, Train_accy 92.86:  75%|███████▌  | 15/20 [01:18<00:30,  6.10s/it]                 
Task 2, Epoch 16/20 => Loss 0.218, Train_accy 92.86:  80%|████████  | 16/20 [01:18<00:21,  5.38s/it]
Task 2, Epoch 17/20 => Loss 0.237, Train_accy 93.75:  80%|████████  | 16/20 [01:22<00:21,  5.38s/it]
Task 2, Epoch 17/20 => Loss 0.237, Train_accy 93.75:  85%|████████▌ | 17/20 [01:22<00:14,  4.86s/it]
Task 2, Epoch 18/20 => Loss 0.200, Train_accy 95.24:  85%|████████▌ | 17/20 [01:25<00:14,  4.86s/it]
Task 2, Epoch 18/20 => Loss 0.200, Train_accy 95.24:  90%|█████████ | 18/20 [01:25<00:08,  4.48s/it]
Task 2, Epoch 19/20 => Loss 0.160, Train_accy 95.54:  90%|█████████ | 18/20 [01:29<00:08,  4.48s/it]
Task 2, Epoch 19/20 => Loss 0.160, Train_accy 95.54:  95%|█████████▌| 19/20 [01:29<00:04,  4.24s/it]
Task 2, Epoch 20/20 => Loss 0.236, Train_accy 91.67, Test_accy 62.66:  95%|█████████▌| 19/20 [01:39<00:04,  4.24s/it]
Task 2, Epoch 20/20 => Loss 0.236, Train_accy 91.67, Test_accy 62.66: 100%|██████████| 20/20 [01:39<00:00,  6.14s/it]
Task 2, Epoch 20/20 => Loss 0.236, Train_accy 91.67, Test_accy 62.66: 100%|██████████| 20/20 [01:39<00:00,  4.99s/it]
2024-04-19 09:55:12,104 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.236, Train_accy 91.67, Test_accy 62.66
2024-04-19 09:55:18,807 [trainer.py] => No NME accuracy.
2024-04-19 09:55:18,808 [trainer.py] => CNN: {'total': 62.66, '00-99': 68.6, '100-119': 18.31, '120-139': 22.89, 'old': 65.51, 'new': 22.89}
2024-04-19 09:55:18,808 [trainer.py] => CNN top1 curve: [69.52, 65.86, 62.66]
2024-04-19 09:55:18,808 [trainer.py] => CNN top5 curve: [88.77, 86.0, 83.15]

Average Accuracy (CNN): 66.01333333333334
2024-04-19 09:55:18,808 [trainer.py] => Average Accuracy (CNN): 66.01333333333334 

2024-04-19 09:55:18,808 [trainer.py] => Train Time: 1990.9000000000003
2024-04-19 09:55:18,808 [trainer.py] => Test Time: 18.64 

2024-04-19 09:55:18,809 [trainer.py] => All params: 89792456
2024-04-19 09:55:18,810 [trainer.py] => Trainable params: 89792456
2024-04-19 09:55:21,003 [coda_prompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.962, Train_accy 10.07:   0%|          | 0/20 [00:03<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.962, Train_accy 10.07:   5%|▌         | 1/20 [00:03<01:01,  3.22s/it]
Task 3, Epoch 2/20 => Loss 2.199, Train_accy 38.89:   5%|▌         | 1/20 [00:06<01:01,  3.22s/it]
Task 3, Epoch 2/20 => Loss 2.199, Train_accy 38.89:  10%|█         | 2/20 [00:06<00:57,  3.20s/it]
Task 3, Epoch 3/20 => Loss 1.402, Train_accy 59.72:  10%|█         | 2/20 [00:09<00:57,  3.20s/it]
Task 3, Epoch 3/20 => Loss 1.402, Train_accy 59.72:  15%|█▌        | 3/20 [00:09<00:54,  3.22s/it]
Task 3, Epoch 4/20 => Loss 0.946, Train_accy 72.57:  15%|█▌        | 3/20 [00:12<00:54,  3.22s/it]
Task 3, Epoch 4/20 => Loss 0.946, Train_accy 72.57:  20%|██        | 4/20 [00:12<00:51,  3.19s/it]
Task 3, Epoch 5/20 => Loss 0.637, Train_accy 82.29, Test_accy 59.32:  20%|██        | 4/20 [00:23<00:51,  3.19s/it]
Task 3, Epoch 5/20 => Loss 0.637, Train_accy 82.29, Test_accy 59.32:  25%|██▌       | 5/20 [00:23<01:26,  5.78s/it]
Task 3, Epoch 6/20 => Loss 0.496, Train_accy 87.85:  25%|██▌       | 5/20 [00:26<01:26,  5.78s/it]                 
Task 3, Epoch 6/20 => Loss 0.496, Train_accy 87.85:  30%|███       | 6/20 [00:26<01:08,  4.91s/it]
Task 3, Epoch 7/20 => Loss 0.342, Train_accy 90.62:  30%|███       | 6/20 [00:29<01:08,  4.91s/it]
Task 3, Epoch 7/20 => Loss 0.342, Train_accy 90.62:  35%|███▌      | 7/20 [00:29<00:56,  4.35s/it]
Task 3, Epoch 8/20 => Loss 0.330, Train_accy 92.01:  35%|███▌      | 7/20 [00:32<00:56,  4.35s/it]
Task 3, Epoch 8/20 => Loss 0.330, Train_accy 92.01:  40%|████      | 8/20 [00:32<00:47,  3.97s/it]
Task 3, Epoch 9/20 => Loss 0.297, Train_accy 92.36:  40%|████      | 8/20 [00:35<00:47,  3.97s/it]
Task 3, Epoch 9/20 => Loss 0.297, Train_accy 92.36:  45%|████▌     | 9/20 [00:35<00:40,  3.71s/it]
Task 3, Epoch 10/20 => Loss 0.235, Train_accy 92.71, Test_accy 59.62:  45%|████▌     | 9/20 [00:46<00:40,  3.71s/it]
Task 3, Epoch 10/20 => Loss 0.235, Train_accy 92.71, Test_accy 59.62:  50%|█████     | 10/20 [00:46<00:57,  5.72s/it]
Task 3, Epoch 11/20 => Loss 0.271, Train_accy 92.36:  50%|█████     | 10/20 [00:49<00:57,  5.72s/it]                 
Task 3, Epoch 11/20 => Loss 0.271, Train_accy 92.36:  55%|█████▌    | 11/20 [00:49<00:44,  4.95s/it]
Task 3, Epoch 12/20 => Loss 0.246, Train_accy 93.06:  55%|█████▌    | 11/20 [00:52<00:44,  4.95s/it]
Task 3, Epoch 12/20 => Loss 0.246, Train_accy 93.06:  60%|██████    | 12/20 [00:52<00:35,  4.40s/it]
Task 3, Epoch 13/20 => Loss 0.189, Train_accy 95.83:  60%|██████    | 12/20 [00:55<00:35,  4.40s/it]
Task 3, Epoch 13/20 => Loss 0.189, Train_accy 95.83:  65%|██████▌   | 13/20 [00:55<00:28,  4.03s/it]
Task 3, Epoch 14/20 => Loss 0.198, Train_accy 94.44:  65%|██████▌   | 13/20 [00:58<00:28,  4.03s/it]
Task 3, Epoch 14/20 => Loss 0.198, Train_accy 94.44:  70%|███████   | 14/20 [00:58<00:22,  3.78s/it]
Task 3, Epoch 15/20 => Loss 0.136, Train_accy 96.53, Test_accy 59.77:  70%|███████   | 14/20 [01:09<00:22,  3.78s/it]
Task 3, Epoch 15/20 => Loss 0.136, Train_accy 96.53, Test_accy 59.77:  75%|███████▌  | 15/20 [01:09<00:28,  5.70s/it]
Task 3, Epoch 16/20 => Loss 0.186, Train_accy 95.83:  75%|███████▌  | 15/20 [01:12<00:28,  5.70s/it]                 
Task 3, Epoch 16/20 => Loss 0.186, Train_accy 95.83:  80%|████████  | 16/20 [01:12<00:19,  4.94s/it]
Task 3, Epoch 17/20 => Loss 0.203, Train_accy 94.79:  80%|████████  | 16/20 [01:15<00:19,  4.94s/it]
Task 3, Epoch 17/20 => Loss 0.203, Train_accy 94.79:  85%|████████▌ | 17/20 [01:15<00:13,  4.43s/it]
Task 3, Epoch 18/20 => Loss 0.177, Train_accy 96.88:  85%|████████▌ | 17/20 [01:18<00:13,  4.43s/it]
Task 3, Epoch 18/20 => Loss 0.177, Train_accy 96.88:  90%|█████████ | 18/20 [01:18<00:08,  4.06s/it]
Task 3, Epoch 19/20 => Loss 0.185, Train_accy 94.79:  90%|█████████ | 18/20 [01:21<00:08,  4.06s/it]
Task 3, Epoch 19/20 => Loss 0.185, Train_accy 94.79:  95%|█████████▌| 19/20 [01:21<00:03,  3.76s/it]
Task 3, Epoch 20/20 => Loss 0.213, Train_accy 94.10, Test_accy 59.77:  95%|█████████▌| 19/20 [01:31<00:03,  3.76s/it]
Task 3, Epoch 20/20 => Loss 0.213, Train_accy 94.10, Test_accy 59.77: 100%|██████████| 20/20 [01:31<00:00,  5.65s/it]
Task 3, Epoch 20/20 => Loss 0.213, Train_accy 94.10, Test_accy 59.77: 100%|██████████| 20/20 [01:31<00:00,  4.59s/it]
2024-04-19 09:56:52,735 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.213, Train_accy 94.10, Test_accy 59.77
2024-04-19 09:56:59,811 [trainer.py] => No NME accuracy.
2024-04-19 09:56:59,811 [trainer.py] => CNN: {'total': 59.77, '00-99': 68.51, '100-119': 16.9, '120-139': 22.89, '140-159': 20.0, 'old': 62.5, 'new': 20.0}
2024-04-19 09:56:59,811 [trainer.py] => CNN top1 curve: [69.52, 65.86, 62.66, 59.77]
2024-04-19 09:56:59,811 [trainer.py] => CNN top5 curve: [88.77, 86.0, 83.15, 80.0]

Average Accuracy (CNN): 64.4525
2024-04-19 09:56:59,811 [trainer.py] => Average Accuracy (CNN): 64.4525 

2024-04-19 09:56:59,811 [trainer.py] => Train Time: 2174.3500000000004
2024-04-19 09:56:59,811 [trainer.py] => Test Time: 25.71 

2024-04-19 09:56:59,812 [trainer.py] => All params: 89792456
2024-04-19 09:56:59,813 [trainer.py] => Trainable params: 89792456
2024-04-19 09:57:02,552 [coda_prompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.728, Train_accy 11.46:   0%|          | 0/20 [00:04<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.728, Train_accy 11.46:   5%|▌         | 1/20 [00:04<01:18,  4.13s/it]
Task 4, Epoch 2/20 => Loss 1.897, Train_accy 45.05:   5%|▌         | 1/20 [00:08<01:18,  4.13s/it]
Task 4, Epoch 2/20 => Loss 1.897, Train_accy 45.05:  10%|█         | 2/20 [00:08<01:12,  4.05s/it]
Task 4, Epoch 3/20 => Loss 1.188, Train_accy 64.58:  10%|█         | 2/20 [00:12<01:12,  4.05s/it]
Task 4, Epoch 3/20 => Loss 1.188, Train_accy 64.58:  15%|█▌        | 3/20 [00:12<01:08,  4.00s/it]
Task 4, Epoch 4/20 => Loss 0.840, Train_accy 73.44:  15%|█▌        | 3/20 [00:16<01:08,  4.00s/it]
Task 4, Epoch 4/20 => Loss 0.840, Train_accy 73.44:  20%|██        | 4/20 [00:16<01:04,  4.04s/it]
Task 4, Epoch 5/20 => Loss 0.654, Train_accy 81.25, Test_accy 56.47:  20%|██        | 4/20 [00:27<01:04,  4.04s/it]
Task 4, Epoch 5/20 => Loss 0.654, Train_accy 81.25, Test_accy 56.47:  25%|██▌       | 5/20 [00:27<01:40,  6.71s/it]
Task 4, Epoch 6/20 => Loss 0.470, Train_accy 86.72:  25%|██▌       | 5/20 [00:31<01:40,  6.71s/it]                 
Task 4, Epoch 6/20 => Loss 0.470, Train_accy 86.72:  30%|███       | 6/20 [00:31<01:21,  5.83s/it]
Task 4, Epoch 7/20 => Loss 0.410, Train_accy 88.80:  30%|███       | 6/20 [00:35<01:21,  5.83s/it]
Task 4, Epoch 7/20 => Loss 0.410, Train_accy 88.80:  35%|███▌      | 7/20 [00:35<01:08,  5.29s/it]
Task 4, Epoch 8/20 => Loss 0.379, Train_accy 90.36:  35%|███▌      | 7/20 [00:40<01:08,  5.29s/it]
Task 4, Epoch 8/20 => Loss 0.379, Train_accy 90.36:  40%|████      | 8/20 [00:40<00:59,  4.96s/it]
Task 4, Epoch 9/20 => Loss 0.392, Train_accy 89.32:  40%|████      | 8/20 [00:44<00:59,  4.96s/it]
Task 4, Epoch 9/20 => Loss 0.392, Train_accy 89.32:  45%|████▌     | 9/20 [00:44<00:51,  4.67s/it]
Task 4, Epoch 10/20 => Loss 0.225, Train_accy 95.05, Test_accy 56.68:  45%|████▌     | 9/20 [00:55<00:51,  4.67s/it]
Task 4, Epoch 10/20 => Loss 0.225, Train_accy 95.05, Test_accy 56.68:  50%|█████     | 10/20 [00:55<01:07,  6.78s/it]
Task 4, Epoch 11/20 => Loss 0.211, Train_accy 95.05:  50%|█████     | 10/20 [00:59<01:07,  6.78s/it]                 
Task 4, Epoch 11/20 => Loss 0.211, Train_accy 95.05:  55%|█████▌    | 11/20 [00:59<00:53,  5.99s/it]
Task 4, Epoch 12/20 => Loss 0.277, Train_accy 94.01:  55%|█████▌    | 11/20 [01:04<00:53,  5.99s/it]
Task 4, Epoch 12/20 => Loss 0.277, Train_accy 94.01:  60%|██████    | 12/20 [01:04<00:43,  5.47s/it]
Task 4, Epoch 13/20 => Loss 0.207, Train_accy 93.75:  60%|██████    | 12/20 [01:08<00:43,  5.47s/it]
Task 4, Epoch 13/20 => Loss 0.207, Train_accy 93.75:  65%|██████▌   | 13/20 [01:08<00:35,  5.07s/it]
Task 4, Epoch 14/20 => Loss 0.192, Train_accy 94.79:  65%|██████▌   | 13/20 [01:12<00:35,  5.07s/it]
Task 4, Epoch 14/20 => Loss 0.192, Train_accy 94.79:  70%|███████   | 14/20 [01:12<00:28,  4.78s/it]
Task 4, Epoch 15/20 => Loss 0.216, Train_accy 94.79, Test_accy 56.47:  70%|███████   | 14/20 [01:24<00:28,  4.78s/it]
Task 4, Epoch 15/20 => Loss 0.216, Train_accy 94.79, Test_accy 56.47:  75%|███████▌  | 15/20 [01:24<00:34,  6.88s/it]
Task 4, Epoch 16/20 => Loss 0.227, Train_accy 95.31:  75%|███████▌  | 15/20 [01:28<00:34,  6.88s/it]                 
Task 4, Epoch 16/20 => Loss 0.227, Train_accy 95.31:  80%|████████  | 16/20 [01:28<00:24,  6.07s/it]
Task 4, Epoch 17/20 => Loss 0.220, Train_accy 94.27:  80%|████████  | 16/20 [01:32<00:24,  6.07s/it]
Task 4, Epoch 17/20 => Loss 0.220, Train_accy 94.27:  85%|████████▌ | 17/20 [01:32<00:16,  5.47s/it]
Task 4, Epoch 18/20 => Loss 0.212, Train_accy 94.79:  85%|████████▌ | 17/20 [01:36<00:16,  5.47s/it]
Task 4, Epoch 18/20 => Loss 0.212, Train_accy 94.79:  90%|█████████ | 18/20 [01:36<00:10,  5.04s/it]
Task 4, Epoch 19/20 => Loss 0.192, Train_accy 93.75:  90%|█████████ | 18/20 [01:40<00:10,  5.04s/it]
Task 4, Epoch 19/20 => Loss 0.192, Train_accy 93.75:  95%|█████████▌| 19/20 [01:40<00:04,  4.75s/it]
Task 4, Epoch 20/20 => Loss 0.186, Train_accy 95.57, Test_accy 56.68:  95%|█████████▌| 19/20 [01:52<00:04,  4.75s/it]
Task 4, Epoch 20/20 => Loss 0.186, Train_accy 95.57, Test_accy 56.68: 100%|██████████| 20/20 [01:52<00:00,  6.82s/it]
Task 4, Epoch 20/20 => Loss 0.186, Train_accy 95.57, Test_accy 56.68: 100%|██████████| 20/20 [01:52<00:00,  5.61s/it]
2024-04-19 09:58:54,774 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.186, Train_accy 95.57, Test_accy 56.68
2024-04-19 09:59:02,234 [trainer.py] => No NME accuracy.
2024-04-19 09:59:02,235 [trainer.py] => CNN: {'total': 56.68, '00-99': 68.42, '100-119': 16.9, '120-139': 22.89, '140-159': 20.0, '160-179': 12.22, 'old': 59.7, 'new': 12.22}
2024-04-19 09:59:02,235 [trainer.py] => CNN top1 curve: [69.52, 65.86, 62.66, 59.77, 56.68]
2024-04-19 09:59:02,235 [trainer.py] => CNN top5 curve: [88.77, 86.0, 83.15, 80.0, 77.17]

Average Accuracy (CNN): 62.898
2024-04-19 09:59:02,235 [trainer.py] => Average Accuracy (CNN): 62.898 

2024-04-19 09:59:02,235 [trainer.py] => Train Time: 2398.78
2024-04-19 09:59:02,235 [trainer.py] => Test Time: 33.17 

2024-04-19 09:59:02,236 [trainer.py] => All params: 89792456
2024-04-19 09:59:02,236 [trainer.py] => Trainable params: 89792456
2024-04-19 09:59:05,724 [coda_prompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.331, Train_accy 18.45:   0%|          | 0/20 [00:04<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.331, Train_accy 18.45:   5%|▌         | 1/20 [00:04<01:16,  4.01s/it]
Task 5, Epoch 2/20 => Loss 1.688, Train_accy 51.49:   5%|▌         | 1/20 [00:07<01:16,  4.01s/it]
Task 5, Epoch 2/20 => Loss 1.688, Train_accy 51.49:  10%|█         | 2/20 [00:07<01:08,  3.82s/it]
Task 5, Epoch 3/20 => Loss 1.025, Train_accy 69.35:  10%|█         | 2/20 [00:11<01:08,  3.82s/it]
Task 5, Epoch 3/20 => Loss 1.025, Train_accy 69.35:  15%|█▌        | 3/20 [00:11<01:03,  3.75s/it]
Task 5, Epoch 4/20 => Loss 0.646, Train_accy 79.46:  15%|█▌        | 3/20 [00:15<01:03,  3.75s/it]
Task 5, Epoch 4/20 => Loss 0.646, Train_accy 79.46:  20%|██        | 4/20 [00:15<00:59,  3.72s/it]
Task 5, Epoch 5/20 => Loss 0.453, Train_accy 85.12, Test_accy 54.38:  20%|██        | 4/20 [00:26<00:59,  3.72s/it]
Task 5, Epoch 5/20 => Loss 0.453, Train_accy 85.12, Test_accy 54.38:  25%|██▌       | 5/20 [00:26<01:39,  6.62s/it]
Task 5, Epoch 6/20 => Loss 0.281, Train_accy 90.48:  25%|██▌       | 5/20 [00:30<01:39,  6.62s/it]                 
Task 5, Epoch 6/20 => Loss 0.281, Train_accy 90.48:  30%|███       | 6/20 [00:30<01:19,  5.64s/it]
Task 5, Epoch 7/20 => Loss 0.300, Train_accy 92.26:  30%|███       | 6/20 [00:34<01:19,  5.64s/it]
Task 5, Epoch 7/20 => Loss 0.300, Train_accy 92.26:  35%|███▌      | 7/20 [00:34<01:05,  5.01s/it]
Task 5, Epoch 8/20 => Loss 0.310, Train_accy 90.77:  35%|███▌      | 7/20 [00:37<01:05,  5.01s/it]
Task 5, Epoch 8/20 => Loss 0.310, Train_accy 90.77:  40%|████      | 8/20 [00:37<00:55,  4.60s/it]
Task 5, Epoch 9/20 => Loss 0.211, Train_accy 94.94:  40%|████      | 8/20 [00:41<00:55,  4.60s/it]
Task 5, Epoch 9/20 => Loss 0.211, Train_accy 94.94:  45%|████▌     | 9/20 [00:41<00:47,  4.32s/it]
Task 5, Epoch 10/20 => Loss 0.243, Train_accy 92.56, Test_accy 55.17:  45%|████▌     | 9/20 [00:53<00:47,  4.32s/it]
Task 5, Epoch 10/20 => Loss 0.243, Train_accy 92.56, Test_accy 55.17:  50%|█████     | 10/20 [00:53<01:05,  6.58s/it]
Task 5, Epoch 11/20 => Loss 0.236, Train_accy 93.45:  50%|█████     | 10/20 [00:57<01:05,  6.58s/it]                 
Task 5, Epoch 11/20 => Loss 0.236, Train_accy 93.45:  55%|█████▌    | 11/20 [00:57<00:51,  5.74s/it]
Task 5, Epoch 12/20 => Loss 0.196, Train_accy 94.94:  55%|█████▌    | 11/20 [01:00<00:51,  5.74s/it]
Task 5, Epoch 12/20 => Loss 0.196, Train_accy 94.94:  60%|██████    | 12/20 [01:00<00:40,  5.11s/it]
Task 5, Epoch 13/20 => Loss 0.146, Train_accy 95.24:  60%|██████    | 12/20 [01:04<00:40,  5.11s/it]
Task 5, Epoch 13/20 => Loss 0.146, Train_accy 95.24:  65%|██████▌   | 13/20 [01:04<00:32,  4.67s/it]
Task 5, Epoch 14/20 => Loss 0.200, Train_accy 95.83:  65%|██████▌   | 13/20 [01:08<00:32,  4.67s/it]
Task 5, Epoch 14/20 => Loss 0.200, Train_accy 95.83:  70%|███████   | 14/20 [01:08<00:26,  4.34s/it]
Task 5, Epoch 15/20 => Loss 0.167, Train_accy 95.54, Test_accy 55.17:  70%|███████   | 14/20 [01:19<00:26,  4.34s/it]
Task 5, Epoch 15/20 => Loss 0.167, Train_accy 95.54, Test_accy 55.17:  75%|███████▌  | 15/20 [01:19<00:32,  6.58s/it]
Task 5, Epoch 16/20 => Loss 0.121, Train_accy 96.73:  75%|███████▌  | 15/20 [01:23<00:32,  6.58s/it]                 
Task 5, Epoch 16/20 => Loss 0.121, Train_accy 96.73:  80%|████████  | 16/20 [01:23<00:22,  5.70s/it]
Task 5, Epoch 17/20 => Loss 0.111, Train_accy 98.21:  80%|████████  | 16/20 [01:27<00:22,  5.70s/it]
Task 5, Epoch 17/20 => Loss 0.111, Train_accy 98.21:  85%|████████▌ | 17/20 [01:27<00:15,  5.09s/it]
Task 5, Epoch 18/20 => Loss 0.178, Train_accy 95.24:  85%|████████▌ | 17/20 [01:30<00:15,  5.09s/it]
Task 5, Epoch 18/20 => Loss 0.178, Train_accy 95.24:  90%|█████████ | 18/20 [01:30<00:09,  4.66s/it]
Task 5, Epoch 19/20 => Loss 0.105, Train_accy 96.73:  90%|█████████ | 18/20 [01:34<00:09,  4.66s/it]
Task 5, Epoch 19/20 => Loss 0.105, Train_accy 96.73:  95%|█████████▌| 19/20 [01:34<00:04,  4.37s/it]
Task 5, Epoch 20/20 => Loss 0.153, Train_accy 96.13, Test_accy 55.10:  95%|█████████▌| 19/20 [01:46<00:04,  4.37s/it]
Task 5, Epoch 20/20 => Loss 0.153, Train_accy 96.13, Test_accy 55.10: 100%|██████████| 20/20 [01:46<00:00,  6.58s/it]
Task 5, Epoch 20/20 => Loss 0.153, Train_accy 96.13, Test_accy 55.10: 100%|██████████| 20/20 [01:46<00:00,  5.31s/it]
2024-04-19 10:00:51,970 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.153, Train_accy 96.13, Test_accy 55.10
2024-04-19 10:01:00,150 [trainer.py] => No NME accuracy.
2024-04-19 10:01:00,150 [trainer.py] => CNN: {'total': 55.1, '00-99': 68.32, '100-119': 16.9, '120-139': 22.89, '140-159': 20.0, '160-179': 13.33, '180-199': 33.65, 'old': 56.68, 'new': 33.65}
2024-04-19 10:01:00,150 [trainer.py] => CNN top1 curve: [69.52, 65.86, 62.66, 59.77, 56.68, 55.1]
2024-04-19 10:01:00,151 [trainer.py] => CNN top5 curve: [88.77, 86.0, 83.15, 80.0, 77.17, 75.84]

Average Accuracy (CNN): 61.598333333333336
2024-04-19 10:01:00,151 [trainer.py] => Average Accuracy (CNN): 61.598333333333336 

2024-04-19 10:01:00,151 [trainer.py] => Train Time: 2611.2599999999998
2024-04-19 10:01:00,151 [trainer.py] => Test Time: 41.35 

Accuracy Matrix (CNN):
[[69.52 68.88 68.6  68.51 68.42 68.32]
 [ 0.   19.72 18.31 16.9  16.9  16.9 ]
 [ 0.    0.   22.89 22.89 22.89 22.89]
 [ 0.    0.    0.   20.   20.   20.  ]
 [ 0.    0.    0.    0.   12.22 13.33]
 [ 0.    0.    0.    0.    0.   33.65]]
2024-04-19 10:01:00,151 [trainer.py] => Forgetting (CNN): 0.8040000000000006
2024-04-19 10:01:03,195 [trainer.py] => config: ./exps/ease_ina_B100.json
2024-04-19 10:01:03,196 [trainer.py] => prefix:  
2024-04-19 10:01:03,196 [trainer.py] => dataset: imageneta
2024-04-19 10:01:03,196 [trainer.py] => memory_size: 0
2024-04-19 10:01:03,196 [trainer.py] => memory_per_class: 0
2024-04-19 10:01:03,196 [trainer.py] => fixed_memory: False
2024-04-19 10:01:03,196 [trainer.py] => shuffle: True
2024-04-19 10:01:03,196 [trainer.py] => init_cls: 100
2024-04-19 10:01:03,196 [trainer.py] => increment: 20
2024-04-19 10:01:03,196 [trainer.py] => model_name: ease
2024-04-19 10:01:03,196 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2024-04-19 10:01:03,196 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-19 10:01:03,196 [trainer.py] => seed: 1993
2024-04-19 10:01:03,196 [trainer.py] => init_epochs: 20
2024-04-19 10:01:03,196 [trainer.py] => init_lr: 0.05
2024-04-19 10:01:03,196 [trainer.py] => later_epochs: 20
2024-04-19 10:01:03,196 [trainer.py] => later_lr: 0.05
2024-04-19 10:01:03,196 [trainer.py] => batch_size: 48
2024-04-19 10:01:03,196 [trainer.py] => weight_decay: 0.005
2024-04-19 10:01:03,196 [trainer.py] => min_lr: 0
2024-04-19 10:01:03,196 [trainer.py] => optimizer: sgd
2024-04-19 10:01:03,197 [trainer.py] => scheduler: cosine
2024-04-19 10:01:03,197 [trainer.py] => pretrained: True
2024-04-19 10:01:03,197 [trainer.py] => vpt_type: Deep
2024-04-19 10:01:03,197 [trainer.py] => prompt_token_num: 5
2024-04-19 10:01:03,197 [trainer.py] => ffn_num: 64
2024-04-19 10:01:03,197 [trainer.py] => use_diagonal: False
2024-04-19 10:01:03,197 [trainer.py] => recalc_sim: True
2024-04-19 10:01:03,197 [trainer.py] => alpha: 0.1
2024-04-19 10:01:03,197 [trainer.py] => use_init_ptm: False
2024-04-19 10:01:03,197 [trainer.py] => beta: 0
2024-04-19 10:01:03,197 [trainer.py] => use_old_data: False
2024-04-19 10:01:03,197 [trainer.py] => use_reweight: True
2024-04-19 10:01:03,197 [trainer.py] => moni_adam: False
2024-04-19 10:01:03,197 [trainer.py] => adapter_num: -1
2024-04-19 10:01:03,234 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
_IncompatibleKeys(missing_keys=['cur_adapter.0.down_proj.weight', 'cur_adapter.0.down_proj.bias', 'cur_adapter.0.up_proj.weight', 'cur_adapter.0.up_proj.bias', 'cur_adapter.1.down_proj.weight', 'cur_adapter.1.down_proj.bias', 'cur_adapter.1.up_proj.weight', 'cur_adapter.1.up_proj.bias', 'cur_adapter.2.down_proj.weight', 'cur_adapter.2.down_proj.bias', 'cur_adapter.2.up_proj.weight', 'cur_adapter.2.up_proj.bias', 'cur_adapter.3.down_proj.weight', 'cur_adapter.3.down_proj.bias', 'cur_adapter.3.up_proj.weight', 'cur_adapter.3.up_proj.bias', 'cur_adapter.4.down_proj.weight', 'cur_adapter.4.down_proj.bias', 'cur_adapter.4.up_proj.weight', 'cur_adapter.4.up_proj.bias', 'cur_adapter.5.down_proj.weight', 'cur_adapter.5.down_proj.bias', 'cur_adapter.5.up_proj.weight', 'cur_adapter.5.up_proj.bias', 'cur_adapter.6.down_proj.weight', 'cur_adapter.6.down_proj.bias', 'cur_adapter.6.up_proj.weight', 'cur_adapter.6.up_proj.bias', 'cur_adapter.7.down_proj.weight', 'cur_adapter.7.down_proj.bias', 'cur_adapter.7.up_proj.weight', 'cur_adapter.7.up_proj.bias', 'cur_adapter.8.down_proj.weight', 'cur_adapter.8.down_proj.bias', 'cur_adapter.8.up_proj.weight', 'cur_adapter.8.up_proj.bias', 'cur_adapter.9.down_proj.weight', 'cur_adapter.9.down_proj.bias', 'cur_adapter.9.up_proj.weight', 'cur_adapter.9.up_proj.bias', 'cur_adapter.10.down_proj.weight', 'cur_adapter.10.down_proj.bias', 'cur_adapter.10.up_proj.weight', 'cur_adapter.10.up_proj.bias', 'cur_adapter.11.down_proj.weight', 'cur_adapter.11.down_proj.bias', 'cur_adapter.11.up_proj.weight', 'cur_adapter.11.up_proj.bias'], unexpected_keys=[])
After BaseNet initialization.
2024-04-19 10:01:12,722 [trainer.py] => All params: 86988288
2024-04-19 10:01:12,723 [trainer.py] => Trainable params: 1189632
2024-04-19 10:01:12,734 [ease.py] => Learning on 0-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.291, Train_accy 23.56:   0%|          | 0/20 [00:17<?, ?it/s]
Task 0, Epoch 1/20 => Loss 4.291, Train_accy 23.56:   5%|▌         | 1/20 [00:17<05:34, 17.59s/it]
Task 0, Epoch 2/20 => Loss 2.408, Train_accy 51.88:   5%|▌         | 1/20 [00:34<05:34, 17.59s/it]
Task 0, Epoch 2/20 => Loss 2.408, Train_accy 51.88:  10%|█         | 2/20 [00:34<05:12, 17.34s/it]
Task 0, Epoch 3/20 => Loss 1.527, Train_accy 65.14:  10%|█         | 2/20 [00:51<05:12, 17.34s/it]
Task 0, Epoch 3/20 => Loss 1.527, Train_accy 65.14:  15%|█▌        | 3/20 [00:51<04:53, 17.25s/it]
Task 0, Epoch 4/20 => Loss 1.318, Train_accy 69.88:  15%|█▌        | 3/20 [01:08<04:53, 17.25s/it]
Task 0, Epoch 4/20 => Loss 1.318, Train_accy 69.88:  20%|██        | 4/20 [01:08<04:34, 17.18s/it]
Task 0, Epoch 5/20 => Loss 1.235, Train_accy 71.46:  20%|██        | 4/20 [01:25<04:34, 17.18s/it]
Task 0, Epoch 5/20 => Loss 1.235, Train_accy 71.46:  25%|██▌       | 5/20 [01:25<04:16, 17.10s/it]
Task 0, Epoch 6/20 => Loss 1.189, Train_accy 72.77:  25%|██▌       | 5/20 [01:42<04:16, 17.10s/it]
Task 0, Epoch 6/20 => Loss 1.189, Train_accy 72.77:  30%|███       | 6/20 [01:42<03:58, 17.06s/it]
Task 0, Epoch 7/20 => Loss 1.151, Train_accy 73.28:  30%|███       | 6/20 [02:00<03:58, 17.06s/it]
Task 0, Epoch 7/20 => Loss 1.151, Train_accy 73.28:  35%|███▌      | 7/20 [02:00<03:42, 17.11s/it]
Task 0, Epoch 8/20 => Loss 1.095, Train_accy 73.77:  35%|███▌      | 7/20 [02:17<03:42, 17.11s/it]
Task 0, Epoch 8/20 => Loss 1.095, Train_accy 73.77:  40%|████      | 8/20 [02:17<03:25, 17.10s/it]
Task 0, Epoch 9/20 => Loss 1.098, Train_accy 75.32:  40%|████      | 8/20 [02:34<03:25, 17.10s/it]
Task 0, Epoch 9/20 => Loss 1.098, Train_accy 75.32:  45%|████▌     | 9/20 [02:34<03:08, 17.10s/it]
Task 0, Epoch 10/20 => Loss 1.006, Train_accy 77.42:  45%|████▌     | 9/20 [02:51<03:08, 17.10s/it]
Task 0, Epoch 10/20 => Loss 1.006, Train_accy 77.42:  50%|█████     | 10/20 [02:51<02:51, 17.10s/it]
Task 0, Epoch 11/20 => Loss 1.047, Train_accy 75.96:  50%|█████     | 10/20 [03:08<02:51, 17.10s/it]
Task 0, Epoch 11/20 => Loss 1.047, Train_accy 75.96:  55%|█████▌    | 11/20 [03:08<02:33, 17.09s/it]
Task 0, Epoch 12/20 => Loss 1.058, Train_accy 77.11:  55%|█████▌    | 11/20 [03:25<02:33, 17.09s/it]
Task 0, Epoch 12/20 => Loss 1.058, Train_accy 77.11:  60%|██████    | 12/20 [03:25<02:17, 17.17s/it]
Task 0, Epoch 13/20 => Loss 0.971, Train_accy 77.99:  60%|██████    | 12/20 [03:43<02:17, 17.17s/it]
Task 0, Epoch 13/20 => Loss 0.971, Train_accy 77.99:  65%|██████▌   | 13/20 [03:43<02:00, 17.23s/it]
Task 0, Epoch 14/20 => Loss 0.974, Train_accy 78.81:  65%|██████▌   | 13/20 [04:00<02:00, 17.23s/it]
Task 0, Epoch 14/20 => Loss 0.974, Train_accy 78.81:  70%|███████   | 14/20 [04:00<01:43, 17.28s/it]
Task 0, Epoch 15/20 => Loss 0.982, Train_accy 78.21:  70%|███████   | 14/20 [04:18<01:43, 17.28s/it]
Task 0, Epoch 15/20 => Loss 0.982, Train_accy 78.21:  75%|███████▌  | 15/20 [04:18<01:26, 17.33s/it]
Task 0, Epoch 16/20 => Loss 0.926, Train_accy 79.51:  75%|███████▌  | 15/20 [04:35<01:26, 17.33s/it]
Task 0, Epoch 16/20 => Loss 0.926, Train_accy 79.51:  80%|████████  | 16/20 [04:35<01:09, 17.37s/it]
Task 0, Epoch 17/20 => Loss 0.918, Train_accy 79.79:  80%|████████  | 16/20 [04:52<01:09, 17.37s/it]
Task 0, Epoch 17/20 => Loss 0.918, Train_accy 79.79:  85%|████████▌ | 17/20 [04:52<00:51, 17.32s/it]
Task 0, Epoch 18/20 => Loss 0.914, Train_accy 80.36:  85%|████████▌ | 17/20 [05:09<00:51, 17.32s/it]
Task 0, Epoch 18/20 => Loss 0.914, Train_accy 80.36:  90%|█████████ | 18/20 [05:09<00:34, 17.31s/it]
Task 0, Epoch 19/20 => Loss 0.912, Train_accy 80.12:  90%|█████████ | 18/20 [05:27<00:34, 17.31s/it]
Task 0, Epoch 19/20 => Loss 0.912, Train_accy 80.12:  95%|█████████▌| 19/20 [05:27<00:17, 17.27s/it]
Task 0, Epoch 20/20 => Loss 0.884, Train_accy 81.06:  95%|█████████▌| 19/20 [05:44<00:17, 17.27s/it]
Task 0, Epoch 20/20 => Loss 0.884, Train_accy 81.06: 100%|██████████| 20/20 [05:44<00:00, 17.28s/it]
Task 0, Epoch 20/20 => Loss 0.884, Train_accy 81.06: 100%|██████████| 20/20 [05:44<00:00, 17.22s/it]
2024-04-19 10:06:57,259 [ease.py] => Task 0, Epoch 20/20 => Loss 0.884, Train_accy 81.06
2024-04-19 10:07:09,751 [ease.py] => Task correct: 79.19143876337694
2024-04-19 10:07:09,751 [ease.py] => Task acc: 84.0665873959572
2024-04-19 10:07:09,921 [trainer.py] => No NME accuracy.
2024-04-19 10:07:09,921 [trainer.py] => CNN: {'total': 73.48, '00-99': 73.48, 'old': 0, 'new': 73.48}
2024-04-19 10:07:09,921 [trainer.py] => CNN top1 curve: [73.48]
2024-04-19 10:07:09,921 [trainer.py] => CNN top5 curve: [92.27]

Average Accuracy (CNN): 73.48
2024-04-19 10:07:09,921 [trainer.py] => Average Accuracy (CNN): 73.48 

2024-04-19 10:07:09,921 [trainer.py] => Train Time: 688.96
2024-04-19 10:07:09,921 [trainer.py] => Test Time: 3.17 

2024-04-19 10:07:09,922 [trainer.py] => All params: 87141890
2024-04-19 10:07:09,923 [trainer.py] => Trainable params: 1189632
2024-04-19 10:07:09,925 [ease.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.945, Train_accy 29.25:   0%|          | 0/20 [00:03<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.945, Train_accy 29.25:   5%|▌         | 1/20 [00:03<00:57,  3.03s/it]
Task 1, Epoch 2/20 => Loss 2.712, Train_accy 55.64:   5%|▌         | 1/20 [00:06<00:57,  3.03s/it]
Task 1, Epoch 2/20 => Loss 2.712, Train_accy 55.64:  10%|█         | 2/20 [00:06<00:55,  3.06s/it]
Task 1, Epoch 3/20 => Loss 2.269, Train_accy 65.01:  10%|█         | 2/20 [00:09<00:55,  3.06s/it]
Task 1, Epoch 3/20 => Loss 2.269, Train_accy 65.01:  15%|█▌        | 3/20 [00:09<00:52,  3.11s/it]
Task 1, Epoch 4/20 => Loss 1.676, Train_accy 75.33:  15%|█▌        | 3/20 [00:12<00:52,  3.11s/it]
Task 1, Epoch 4/20 => Loss 1.676, Train_accy 75.33:  20%|██        | 4/20 [00:12<00:50,  3.14s/it]
Task 1, Epoch 5/20 => Loss 1.274, Train_accy 77.63:  20%|██        | 4/20 [00:15<00:50,  3.14s/it]
Task 1, Epoch 5/20 => Loss 1.274, Train_accy 77.63:  25%|██▌       | 5/20 [00:15<00:46,  3.12s/it]
Task 1, Epoch 6/20 => Loss 1.032, Train_accy 81.64:  25%|██▌       | 5/20 [00:18<00:46,  3.12s/it]
Task 1, Epoch 6/20 => Loss 1.032, Train_accy 81.64:  30%|███       | 6/20 [00:18<00:43,  3.10s/it]
Task 1, Epoch 7/20 => Loss 0.855, Train_accy 85.47:  30%|███       | 6/20 [00:21<00:43,  3.10s/it]
Task 1, Epoch 7/20 => Loss 0.855, Train_accy 85.47:  35%|███▌      | 7/20 [00:21<00:40,  3.08s/it]
Task 1, Epoch 8/20 => Loss 0.768, Train_accy 87.00:  35%|███▌      | 7/20 [00:24<00:40,  3.08s/it]
Task 1, Epoch 8/20 => Loss 0.768, Train_accy 87.00:  40%|████      | 8/20 [00:24<00:37,  3.09s/it]
Task 1, Epoch 9/20 => Loss 0.699, Train_accy 87.76:  40%|████      | 8/20 [00:27<00:37,  3.09s/it]
Task 1, Epoch 9/20 => Loss 0.699, Train_accy 87.76:  45%|████▌     | 9/20 [00:27<00:33,  3.09s/it]
Task 1, Epoch 10/20 => Loss 0.628, Train_accy 90.25:  45%|████▌     | 9/20 [00:31<00:33,  3.09s/it]
Task 1, Epoch 10/20 => Loss 0.628, Train_accy 90.25:  50%|█████     | 10/20 [00:31<00:31,  3.13s/it]
Task 1, Epoch 11/20 => Loss 0.592, Train_accy 92.16:  50%|█████     | 10/20 [00:34<00:31,  3.13s/it]
Task 1, Epoch 11/20 => Loss 0.592, Train_accy 92.16:  55%|█████▌    | 11/20 [00:34<00:28,  3.13s/it]
Task 1, Epoch 12/20 => Loss 0.559, Train_accy 89.48:  55%|█████▌    | 11/20 [00:37<00:28,  3.13s/it]
Task 1, Epoch 12/20 => Loss 0.559, Train_accy 89.48:  60%|██████    | 12/20 [00:37<00:24,  3.10s/it]
Task 1, Epoch 13/20 => Loss 0.560, Train_accy 90.25:  60%|██████    | 12/20 [00:40<00:24,  3.10s/it]
Task 1, Epoch 13/20 => Loss 0.560, Train_accy 90.25:  65%|██████▌   | 13/20 [00:40<00:21,  3.10s/it]
Task 1, Epoch 14/20 => Loss 0.529, Train_accy 90.63:  65%|██████▌   | 13/20 [00:43<00:21,  3.10s/it]
Task 1, Epoch 14/20 => Loss 0.529, Train_accy 90.63:  70%|███████   | 14/20 [00:43<00:18,  3.10s/it]
Task 1, Epoch 15/20 => Loss 0.497, Train_accy 92.54:  70%|███████   | 14/20 [00:46<00:18,  3.10s/it]
Task 1, Epoch 15/20 => Loss 0.497, Train_accy 92.54:  75%|███████▌  | 15/20 [00:46<00:15,  3.10s/it]
Task 1, Epoch 16/20 => Loss 0.499, Train_accy 91.40:  75%|███████▌  | 15/20 [00:49<00:15,  3.10s/it]
Task 1, Epoch 16/20 => Loss 0.499, Train_accy 91.40:  80%|████████  | 16/20 [00:49<00:12,  3.12s/it]
Task 1, Epoch 17/20 => Loss 0.542, Train_accy 89.87:  80%|████████  | 16/20 [00:52<00:12,  3.12s/it]
Task 1, Epoch 17/20 => Loss 0.542, Train_accy 89.87:  85%|████████▌ | 17/20 [00:52<00:09,  3.10s/it]
Task 1, Epoch 18/20 => Loss 0.535, Train_accy 90.25:  85%|████████▌ | 17/20 [00:55<00:09,  3.10s/it]
Task 1, Epoch 18/20 => Loss 0.535, Train_accy 90.25:  90%|█████████ | 18/20 [00:55<00:06,  3.12s/it]
Task 1, Epoch 19/20 => Loss 0.505, Train_accy 89.10:  90%|█████████ | 18/20 [00:58<00:06,  3.12s/it]
Task 1, Epoch 19/20 => Loss 0.505, Train_accy 89.10:  95%|█████████▌| 19/20 [00:58<00:03,  3.10s/it]
Task 1, Epoch 20/20 => Loss 0.496, Train_accy 91.20:  95%|█████████▌| 19/20 [01:02<00:03,  3.10s/it]
Task 1, Epoch 20/20 => Loss 0.496, Train_accy 91.20: 100%|██████████| 20/20 [01:02<00:00,  3.11s/it]
Task 1, Epoch 20/20 => Loss 0.496, Train_accy 91.20: 100%|██████████| 20/20 [01:02<00:00,  3.11s/it]
2024-04-19 10:08:12,039 [ease.py] => Task 1, Epoch 20/20 => Loss 0.496, Train_accy 91.20
2024-04-19 10:08:21,892 [ease.py] => Task correct: 74.76923076923077
2024-04-19 10:08:21,893 [ease.py] => Task acc: 84.71794871794872
2024-04-19 10:08:21,958 [trainer.py] => No NME accuracy.
2024-04-19 10:08:21,958 [trainer.py] => CNN: {'total': 69.64, '00-99': 67.66, '100-119': 82.09, 'old': 67.66, 'new': 82.09}
2024-04-19 10:08:21,958 [trainer.py] => CNN top1 curve: [73.48, 69.64]
2024-04-19 10:08:21,959 [trainer.py] => CNN top5 curve: [92.27, 90.15]

Average Accuracy (CNN): 71.56
2024-04-19 10:08:21,959 [trainer.py] => Average Accuracy (CNN): 71.56 

2024-04-19 10:08:21,959 [trainer.py] => Train Time: 813.1800000000001
2024-04-19 10:08:21,959 [trainer.py] => Test Time: 8.68 

2024-04-19 10:08:21,959 [trainer.py] => All params: 87187970
2024-04-19 10:08:21,960 [trainer.py] => Trainable params: 1189632
2024-04-19 10:08:21,963 [ease.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.968, Train_accy 18.92:   0%|          | 0/20 [00:03<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.968, Train_accy 18.92:   5%|▌         | 1/20 [00:03<01:01,  3.22s/it]
Task 2, Epoch 2/20 => Loss 2.803, Train_accy 56.96:   5%|▌         | 1/20 [00:06<01:01,  3.22s/it]
Task 2, Epoch 2/20 => Loss 2.803, Train_accy 56.96:  10%|█         | 2/20 [00:06<00:57,  3.17s/it]
Task 2, Epoch 3/20 => Loss 2.449, Train_accy 64.38:  10%|█         | 2/20 [00:09<00:57,  3.17s/it]
Task 2, Epoch 3/20 => Loss 2.449, Train_accy 64.38:  15%|█▌        | 3/20 [00:09<00:53,  3.17s/it]
Task 2, Epoch 4/20 => Loss 1.992, Train_accy 66.60:  15%|█▌        | 3/20 [00:12<00:53,  3.17s/it]
Task 2, Epoch 4/20 => Loss 1.992, Train_accy 66.60:  20%|██        | 4/20 [00:12<00:50,  3.16s/it]
Task 2, Epoch 5/20 => Loss 1.549, Train_accy 71.43:  20%|██        | 4/20 [00:15<00:50,  3.16s/it]
Task 2, Epoch 5/20 => Loss 1.549, Train_accy 71.43:  25%|██▌       | 5/20 [00:15<00:47,  3.17s/it]
Task 2, Epoch 6/20 => Loss 1.263, Train_accy 76.62:  25%|██▌       | 5/20 [00:19<00:47,  3.17s/it]
Task 2, Epoch 6/20 => Loss 1.263, Train_accy 76.62:  30%|███       | 6/20 [00:19<00:44,  3.21s/it]
Task 2, Epoch 7/20 => Loss 1.057, Train_accy 81.63:  30%|███       | 6/20 [00:22<00:44,  3.21s/it]
Task 2, Epoch 7/20 => Loss 1.057, Train_accy 81.63:  35%|███▌      | 7/20 [00:22<00:41,  3.21s/it]
Task 2, Epoch 8/20 => Loss 0.930, Train_accy 81.63:  35%|███▌      | 7/20 [00:25<00:41,  3.21s/it]
Task 2, Epoch 8/20 => Loss 0.930, Train_accy 81.63:  40%|████      | 8/20 [00:25<00:38,  3.22s/it]
Task 2, Epoch 9/20 => Loss 0.854, Train_accy 83.12:  40%|████      | 8/20 [00:28<00:38,  3.22s/it]
Task 2, Epoch 9/20 => Loss 0.854, Train_accy 83.12:  45%|████▌     | 9/20 [00:28<00:35,  3.20s/it]
Task 2, Epoch 10/20 => Loss 0.770, Train_accy 85.34:  45%|████▌     | 9/20 [00:31<00:35,  3.20s/it]
Task 2, Epoch 10/20 => Loss 0.770, Train_accy 85.34:  50%|█████     | 10/20 [00:31<00:32,  3.20s/it]
Task 2, Epoch 11/20 => Loss 0.756, Train_accy 84.97:  50%|█████     | 10/20 [00:35<00:32,  3.20s/it]
Task 2, Epoch 11/20 => Loss 0.756, Train_accy 84.97:  55%|█████▌    | 11/20 [00:35<00:28,  3.18s/it]
Task 2, Epoch 12/20 => Loss 0.724, Train_accy 84.42:  55%|█████▌    | 11/20 [00:38<00:28,  3.18s/it]
Task 2, Epoch 12/20 => Loss 0.724, Train_accy 84.42:  60%|██████    | 12/20 [00:38<00:25,  3.19s/it]
Task 2, Epoch 13/20 => Loss 0.732, Train_accy 84.79:  60%|██████    | 12/20 [00:41<00:25,  3.19s/it]
Task 2, Epoch 13/20 => Loss 0.732, Train_accy 84.79:  65%|██████▌   | 13/20 [00:41<00:22,  3.22s/it]
Task 2, Epoch 14/20 => Loss 0.682, Train_accy 87.20:  65%|██████▌   | 13/20 [00:44<00:22,  3.22s/it]
Task 2, Epoch 14/20 => Loss 0.682, Train_accy 87.20:  70%|███████   | 14/20 [00:44<00:19,  3.21s/it]
Task 2, Epoch 15/20 => Loss 0.689, Train_accy 85.71:  70%|███████   | 14/20 [00:47<00:19,  3.21s/it]
Task 2, Epoch 15/20 => Loss 0.689, Train_accy 85.71:  75%|███████▌  | 15/20 [00:47<00:15,  3.20s/it]
Task 2, Epoch 16/20 => Loss 0.640, Train_accy 86.83:  75%|███████▌  | 15/20 [00:51<00:15,  3.20s/it]
Task 2, Epoch 16/20 => Loss 0.640, Train_accy 86.83:  80%|████████  | 16/20 [00:51<00:12,  3.23s/it]
Task 2, Epoch 17/20 => Loss 0.610, Train_accy 87.94:  80%|████████  | 16/20 [00:54<00:12,  3.23s/it]
Task 2, Epoch 17/20 => Loss 0.610, Train_accy 87.94:  85%|████████▌ | 17/20 [00:54<00:09,  3.21s/it]
Task 2, Epoch 18/20 => Loss 0.681, Train_accy 86.64:  85%|████████▌ | 17/20 [00:57<00:09,  3.21s/it]
Task 2, Epoch 18/20 => Loss 0.681, Train_accy 86.64:  90%|█████████ | 18/20 [00:57<00:06,  3.19s/it]
Task 2, Epoch 19/20 => Loss 0.590, Train_accy 89.80:  90%|█████████ | 18/20 [01:00<00:06,  3.19s/it]
Task 2, Epoch 19/20 => Loss 0.590, Train_accy 89.80:  95%|█████████▌| 19/20 [01:00<00:03,  3.19s/it]
Task 2, Epoch 20/20 => Loss 0.648, Train_accy 87.38:  95%|█████████▌| 19/20 [01:04<00:03,  3.19s/it]
Task 2, Epoch 20/20 => Loss 0.648, Train_accy 87.38: 100%|██████████| 20/20 [01:04<00:00,  3.23s/it]
Task 2, Epoch 20/20 => Loss 0.648, Train_accy 87.38: 100%|██████████| 20/20 [01:04<00:00,  3.20s/it]
2024-04-19 10:09:26,016 [ease.py] => Task 2, Epoch 20/20 => Loss 0.648, Train_accy 87.38
2024-04-19 10:09:41,411 [ease.py] => Task correct: 69.13470115967885
2024-04-19 10:09:41,412 [ease.py] => Task acc: 84.38893844781445
2024-04-19 10:09:41,454 [trainer.py] => No NME accuracy.
2024-04-19 10:09:41,454 [trainer.py] => CNN: {'total': 64.5, '00-99': 61.47, '100-119': 73.13, '120-139': 73.97, 'old': 63.08, 'new': 73.97}
2024-04-19 10:09:41,454 [trainer.py] => CNN top1 curve: [73.48, 69.64, 64.5]
2024-04-19 10:09:41,454 [trainer.py] => CNN top5 curve: [92.27, 90.15, 86.89]

Average Accuracy (CNN): 69.20666666666666
2024-04-19 10:09:41,454 [trainer.py] => Average Accuracy (CNN): 69.20666666666666 

2024-04-19 10:09:41,454 [trainer.py] => Train Time: 941.28
2024-04-19 10:09:41,454 [trainer.py] => Test Time: 17.63 

2024-04-19 10:09:41,455 [trainer.py] => All params: 87326210
2024-04-19 10:09:41,456 [trainer.py] => Trainable params: 1189632
2024-04-19 10:09:41,461 [ease.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.958, Train_accy 20.53:   0%|          | 0/20 [00:03<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.958, Train_accy 20.53:   5%|▌         | 1/20 [00:03<01:02,  3.28s/it]
Task 3, Epoch 2/20 => Loss 2.771, Train_accy 46.70:   5%|▌         | 1/20 [00:06<01:02,  3.28s/it]
Task 3, Epoch 2/20 => Loss 2.771, Train_accy 46.70:  10%|█         | 2/20 [00:06<00:58,  3.24s/it]
Task 3, Epoch 3/20 => Loss 2.406, Train_accy 61.21:  10%|█         | 2/20 [00:09<00:58,  3.24s/it]
Task 3, Epoch 3/20 => Loss 2.406, Train_accy 61.21:  15%|█▌        | 3/20 [00:09<00:54,  3.20s/it]
Task 3, Epoch 4/20 => Loss 1.881, Train_accy 71.37:  15%|█▌        | 3/20 [00:12<00:54,  3.20s/it]
Task 3, Epoch 4/20 => Loss 1.881, Train_accy 71.37:  20%|██        | 4/20 [00:12<00:50,  3.16s/it]
Task 3, Epoch 5/20 => Loss 1.460, Train_accy 76.27:  20%|██        | 4/20 [00:15<00:50,  3.16s/it]
Task 3, Epoch 5/20 => Loss 1.460, Train_accy 76.27:  25%|██▌       | 5/20 [00:15<00:47,  3.14s/it]
Task 3, Epoch 6/20 => Loss 1.229, Train_accy 80.60:  25%|██▌       | 5/20 [00:19<00:47,  3.14s/it]
Task 3, Epoch 6/20 => Loss 1.229, Train_accy 80.60:  30%|███       | 6/20 [00:19<00:44,  3.15s/it]
Task 3, Epoch 7/20 => Loss 1.028, Train_accy 83.62:  30%|███       | 6/20 [00:22<00:44,  3.15s/it]
Task 3, Epoch 7/20 => Loss 1.028, Train_accy 83.62:  35%|███▌      | 7/20 [00:22<00:40,  3.14s/it]
Task 3, Epoch 8/20 => Loss 0.958, Train_accy 81.73:  35%|███▌      | 7/20 [00:25<00:40,  3.14s/it]
Task 3, Epoch 8/20 => Loss 0.958, Train_accy 81.73:  40%|████      | 8/20 [00:25<00:37,  3.14s/it]
Task 3, Epoch 9/20 => Loss 0.891, Train_accy 83.43:  40%|████      | 8/20 [00:28<00:37,  3.14s/it]
Task 3, Epoch 9/20 => Loss 0.891, Train_accy 83.43:  45%|████▌     | 9/20 [00:28<00:34,  3.13s/it]
Task 3, Epoch 10/20 => Loss 0.817, Train_accy 85.31:  45%|████▌     | 9/20 [00:31<00:34,  3.13s/it]
Task 3, Epoch 10/20 => Loss 0.817, Train_accy 85.31:  50%|█████     | 10/20 [00:31<00:31,  3.12s/it]
Task 3, Epoch 11/20 => Loss 0.746, Train_accy 87.01:  50%|█████     | 10/20 [00:34<00:31,  3.12s/it]
Task 3, Epoch 11/20 => Loss 0.746, Train_accy 87.01:  55%|█████▌    | 11/20 [00:34<00:28,  3.11s/it]
Task 3, Epoch 12/20 => Loss 0.686, Train_accy 88.32:  55%|█████▌    | 11/20 [00:37<00:28,  3.11s/it]
Task 3, Epoch 12/20 => Loss 0.686, Train_accy 88.32:  60%|██████    | 12/20 [00:37<00:25,  3.14s/it]
Task 3, Epoch 13/20 => Loss 0.669, Train_accy 86.25:  60%|██████    | 12/20 [00:40<00:25,  3.14s/it]
Task 3, Epoch 13/20 => Loss 0.669, Train_accy 86.25:  65%|██████▌   | 13/20 [00:40<00:21,  3.13s/it]
Task 3, Epoch 14/20 => Loss 0.705, Train_accy 87.76:  65%|██████▌   | 13/20 [00:44<00:21,  3.13s/it]
Task 3, Epoch 14/20 => Loss 0.705, Train_accy 87.76:  70%|███████   | 14/20 [00:44<00:18,  3.13s/it]
Task 3, Epoch 15/20 => Loss 0.644, Train_accy 86.82:  70%|███████   | 14/20 [00:47<00:18,  3.13s/it]
Task 3, Epoch 15/20 => Loss 0.644, Train_accy 86.82:  75%|███████▌  | 15/20 [00:47<00:15,  3.14s/it]
Task 3, Epoch 16/20 => Loss 0.607, Train_accy 88.32:  75%|███████▌  | 15/20 [00:50<00:15,  3.14s/it]
Task 3, Epoch 16/20 => Loss 0.607, Train_accy 88.32:  80%|████████  | 16/20 [00:50<00:12,  3.16s/it]
Task 3, Epoch 17/20 => Loss 0.725, Train_accy 88.32:  80%|████████  | 16/20 [00:53<00:12,  3.16s/it]
Task 3, Epoch 17/20 => Loss 0.725, Train_accy 88.32:  85%|████████▌ | 17/20 [00:53<00:09,  3.15s/it]
Task 3, Epoch 18/20 => Loss 0.663, Train_accy 87.19:  85%|████████▌ | 17/20 [00:56<00:09,  3.15s/it]
Task 3, Epoch 18/20 => Loss 0.663, Train_accy 87.19:  90%|█████████ | 18/20 [00:56<00:06,  3.16s/it]
Task 3, Epoch 19/20 => Loss 0.639, Train_accy 88.51:  90%|█████████ | 18/20 [00:59<00:06,  3.16s/it]
Task 3, Epoch 19/20 => Loss 0.639, Train_accy 88.51:  95%|█████████▌| 19/20 [00:59<00:03,  3.16s/it]
Task 3, Epoch 20/20 => Loss 0.679, Train_accy 88.51:  95%|█████████▌| 19/20 [01:02<00:03,  3.16s/it]
Task 3, Epoch 20/20 => Loss 0.679, Train_accy 88.51: 100%|██████████| 20/20 [01:02<00:00,  3.14s/it]
Task 3, Epoch 20/20 => Loss 0.679, Train_accy 88.51: 100%|██████████| 20/20 [01:02<00:00,  3.15s/it]
2024-04-19 10:10:44,431 [ease.py] => Task 3, Epoch 20/20 => Loss 0.679, Train_accy 88.51
2024-04-19 10:11:06,173 [ease.py] => Task correct: 65.94551282051282
2024-04-19 10:11:06,174 [ease.py] => Task acc: 83.57371794871794
2024-04-19 10:11:06,291 [trainer.py] => No NME accuracy.
2024-04-19 10:11:06,291 [trainer.py] => CNN: {'total': 61.06, '00-99': 58.98, '100-119': 70.15, '120-139': 69.86, '140-159': 55.12, 'old': 61.73, 'new': 55.12}
2024-04-19 10:11:06,291 [trainer.py] => CNN top1 curve: [73.48, 69.64, 64.5, 61.06]
2024-04-19 10:11:06,291 [trainer.py] => CNN top5 curve: [92.27, 90.15, 86.89, 85.02]

Average Accuracy (CNN): 67.17
2024-04-19 10:11:06,291 [trainer.py] => Average Accuracy (CNN): 67.17 

2024-04-19 10:11:06,291 [trainer.py] => Train Time: 1067.21
2024-04-19 10:11:06,291 [trainer.py] => Test Time: 30.479999999999997 

2024-04-19 10:11:06,292 [trainer.py] => All params: 87495170
2024-04-19 10:11:06,292 [trainer.py] => Trainable params: 1189632
2024-04-19 10:11:06,298 [ease.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.965, Train_accy 14.54:   0%|          | 0/20 [00:03<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.965, Train_accy 14.54:   5%|▌         | 1/20 [00:03<01:03,  3.34s/it]
Task 4, Epoch 2/20 => Loss 2.811, Train_accy 45.36:   5%|▌         | 1/20 [00:06<01:03,  3.34s/it]
Task 4, Epoch 2/20 => Loss 2.811, Train_accy 45.36:  10%|█         | 2/20 [00:06<01:01,  3.39s/it]
Task 4, Epoch 3/20 => Loss 2.506, Train_accy 54.47:  10%|█         | 2/20 [00:10<01:01,  3.39s/it]
Task 4, Epoch 3/20 => Loss 2.506, Train_accy 54.47:  15%|█▌        | 3/20 [00:10<00:57,  3.40s/it]
Task 4, Epoch 4/20 => Loss 2.085, Train_accy 61.65:  15%|█▌        | 3/20 [00:13<00:57,  3.40s/it]
Task 4, Epoch 4/20 => Loss 2.085, Train_accy 61.65:  20%|██        | 4/20 [00:13<00:53,  3.35s/it]
Task 4, Epoch 5/20 => Loss 1.717, Train_accy 65.32:  20%|██        | 4/20 [00:16<00:53,  3.35s/it]
Task 4, Epoch 5/20 => Loss 1.717, Train_accy 65.32:  25%|██▌       | 5/20 [00:16<00:51,  3.41s/it]
Task 4, Epoch 6/20 => Loss 1.436, Train_accy 70.05:  25%|██▌       | 5/20 [00:20<00:51,  3.41s/it]
Task 4, Epoch 6/20 => Loss 1.436, Train_accy 70.05:  30%|███       | 6/20 [00:20<00:47,  3.39s/it]
Task 4, Epoch 7/20 => Loss 1.282, Train_accy 74.08:  30%|███       | 6/20 [00:23<00:47,  3.39s/it]
Task 4, Epoch 7/20 => Loss 1.282, Train_accy 74.08:  35%|███▌      | 7/20 [00:23<00:43,  3.35s/it]
Task 4, Epoch 8/20 => Loss 1.151, Train_accy 77.76:  35%|███▌      | 7/20 [00:26<00:43,  3.35s/it]
Task 4, Epoch 8/20 => Loss 1.151, Train_accy 77.76:  40%|████      | 8/20 [00:26<00:39,  3.32s/it]
Task 4, Epoch 9/20 => Loss 1.044, Train_accy 77.41:  40%|████      | 8/20 [00:30<00:39,  3.32s/it]
Task 4, Epoch 9/20 => Loss 1.044, Train_accy 77.41:  45%|████▌     | 9/20 [00:30<00:36,  3.31s/it]
Task 4, Epoch 10/20 => Loss 0.995, Train_accy 80.21:  45%|████▌     | 9/20 [00:33<00:36,  3.31s/it]
Task 4, Epoch 10/20 => Loss 0.995, Train_accy 80.21:  50%|█████     | 10/20 [00:33<00:34,  3.45s/it]
Task 4, Epoch 11/20 => Loss 0.927, Train_accy 80.56:  50%|█████     | 10/20 [00:37<00:34,  3.45s/it]
Task 4, Epoch 11/20 => Loss 0.927, Train_accy 80.56:  55%|█████▌    | 11/20 [00:37<00:31,  3.49s/it]
Task 4, Epoch 12/20 => Loss 0.885, Train_accy 80.56:  55%|█████▌    | 11/20 [00:40<00:31,  3.49s/it]
Task 4, Epoch 12/20 => Loss 0.885, Train_accy 80.56:  60%|██████    | 12/20 [00:40<00:27,  3.46s/it]
Task 4, Epoch 13/20 => Loss 0.858, Train_accy 82.14:  60%|██████    | 12/20 [00:44<00:27,  3.46s/it]
Task 4, Epoch 13/20 => Loss 0.858, Train_accy 82.14:  65%|██████▌   | 13/20 [00:44<00:23,  3.41s/it]
Task 4, Epoch 14/20 => Loss 0.843, Train_accy 82.49:  65%|██████▌   | 13/20 [00:47<00:23,  3.41s/it]
Task 4, Epoch 14/20 => Loss 0.843, Train_accy 82.49:  70%|███████   | 14/20 [00:47<00:20,  3.40s/it]
Task 4, Epoch 15/20 => Loss 0.816, Train_accy 84.24:  70%|███████   | 14/20 [00:50<00:20,  3.40s/it]
Task 4, Epoch 15/20 => Loss 0.816, Train_accy 84.24:  75%|███████▌  | 15/20 [00:50<00:16,  3.39s/it]
Task 4, Epoch 16/20 => Loss 0.811, Train_accy 81.96:  75%|███████▌  | 15/20 [00:54<00:16,  3.39s/it]
Task 4, Epoch 16/20 => Loss 0.811, Train_accy 81.96:  80%|████████  | 16/20 [00:54<00:13,  3.37s/it]
Task 4, Epoch 17/20 => Loss 0.775, Train_accy 84.94:  80%|████████  | 16/20 [00:57<00:13,  3.37s/it]
Task 4, Epoch 17/20 => Loss 0.775, Train_accy 84.94:  85%|████████▌ | 17/20 [00:57<00:10,  3.37s/it]
Task 4, Epoch 18/20 => Loss 0.784, Train_accy 83.89:  85%|████████▌ | 17/20 [01:00<00:10,  3.37s/it]
Task 4, Epoch 18/20 => Loss 0.784, Train_accy 83.89:  90%|█████████ | 18/20 [01:00<00:06,  3.35s/it]
Task 4, Epoch 19/20 => Loss 0.802, Train_accy 83.19:  90%|█████████ | 18/20 [01:04<00:06,  3.35s/it]
Task 4, Epoch 19/20 => Loss 0.802, Train_accy 83.19:  95%|█████████▌| 19/20 [01:04<00:03,  3.35s/it]
Task 4, Epoch 20/20 => Loss 0.775, Train_accy 84.76:  95%|█████████▌| 19/20 [01:07<00:03,  3.35s/it]
Task 4, Epoch 20/20 => Loss 0.775, Train_accy 84.76: 100%|██████████| 20/20 [01:07<00:00,  3.36s/it]
Task 4, Epoch 20/20 => Loss 0.775, Train_accy 84.76: 100%|██████████| 20/20 [01:07<00:00,  3.38s/it]
2024-04-19 10:12:13,936 [ease.py] => Task 4, Epoch 20/20 => Loss 0.775, Train_accy 84.76
2024-04-19 10:12:43,797 [ease.py] => Task correct: 61.935483870967744
2024-04-19 10:12:43,797 [ease.py] => Task acc: 82.79569892473118
2024-04-19 10:12:43,835 [trainer.py] => No NME accuracy.
2024-04-19 10:12:43,835 [trainer.py] => CNN: {'total': 57.78, '00-99': 55.41, '100-119': 66.42, '120-139': 66.44, '140-159': 53.54, '160-179': 58.5, 'old': 57.69, 'new': 58.5}
2024-04-19 10:12:43,835 [trainer.py] => CNN top1 curve: [73.48, 69.64, 64.5, 61.06, 57.78]
2024-04-19 10:12:43,835 [trainer.py] => CNN top5 curve: [92.27, 90.15, 86.89, 85.02, 83.08]

Average Accuracy (CNN): 65.292
2024-04-19 10:12:43,835 [trainer.py] => Average Accuracy (CNN): 65.292 

2024-04-19 10:12:43,835 [trainer.py] => Train Time: 1202.4800000000002
2024-04-19 10:12:43,835 [trainer.py] => Test Time: 48.199999999999996 

2024-04-19 10:12:43,836 [trainer.py] => All params: 87694850
2024-04-19 10:12:43,837 [trainer.py] => Trainable params: 1189632
2024-04-19 10:12:43,846 [ease.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.965, Train_accy 21.82:   0%|          | 0/20 [00:03<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.965, Train_accy 21.82:   5%|▌         | 1/20 [00:03<00:59,  3.11s/it]
Task 5, Epoch 2/20 => Loss 2.802, Train_accy 50.66:   5%|▌         | 1/20 [00:06<00:59,  3.11s/it]
Task 5, Epoch 2/20 => Loss 2.802, Train_accy 50.66:  10%|█         | 2/20 [00:06<00:55,  3.08s/it]
Task 5, Epoch 3/20 => Loss 2.479, Train_accy 63.76:  10%|█         | 2/20 [00:09<00:55,  3.08s/it]
Task 5, Epoch 3/20 => Loss 2.479, Train_accy 63.76:  15%|█▌        | 3/20 [00:09<00:53,  3.17s/it]
Task 5, Epoch 4/20 => Loss 1.996, Train_accy 70.97:  15%|█▌        | 3/20 [00:12<00:53,  3.17s/it]
Task 5, Epoch 4/20 => Loss 1.996, Train_accy 70.97:  20%|██        | 4/20 [00:12<00:50,  3.13s/it]
Task 5, Epoch 5/20 => Loss 1.541, Train_accy 74.95:  20%|██        | 4/20 [00:15<00:50,  3.13s/it]
Task 5, Epoch 5/20 => Loss 1.541, Train_accy 74.95:  25%|██▌       | 5/20 [00:15<00:47,  3.14s/it]
Task 5, Epoch 6/20 => Loss 1.289, Train_accy 76.85:  25%|██▌       | 5/20 [00:18<00:47,  3.14s/it]
Task 5, Epoch 6/20 => Loss 1.289, Train_accy 76.85:  30%|███       | 6/20 [00:18<00:44,  3.15s/it]
Task 5, Epoch 7/20 => Loss 1.056, Train_accy 82.16:  30%|███       | 6/20 [00:21<00:44,  3.15s/it]
Task 5, Epoch 7/20 => Loss 1.056, Train_accy 82.16:  35%|███▌      | 7/20 [00:21<00:40,  3.13s/it]
Task 5, Epoch 8/20 => Loss 0.964, Train_accy 83.87:  35%|███▌      | 7/20 [00:25<00:40,  3.13s/it]
Task 5, Epoch 8/20 => Loss 0.964, Train_accy 83.87:  40%|████      | 8/20 [00:25<00:37,  3.14s/it]
Task 5, Epoch 9/20 => Loss 0.852, Train_accy 84.82:  40%|████      | 8/20 [00:28<00:37,  3.14s/it]
Task 5, Epoch 9/20 => Loss 0.852, Train_accy 84.82:  45%|████▌     | 9/20 [00:28<00:34,  3.15s/it]
Task 5, Epoch 10/20 => Loss 0.783, Train_accy 85.20:  45%|████▌     | 9/20 [00:31<00:34,  3.15s/it]
Task 5, Epoch 10/20 => Loss 0.783, Train_accy 85.20:  50%|█████     | 10/20 [00:31<00:31,  3.16s/it]
Task 5, Epoch 11/20 => Loss 0.735, Train_accy 86.15:  50%|█████     | 10/20 [00:34<00:31,  3.16s/it]
Task 5, Epoch 11/20 => Loss 0.735, Train_accy 86.15:  55%|█████▌    | 11/20 [00:34<00:28,  3.14s/it]
Task 5, Epoch 12/20 => Loss 0.714, Train_accy 87.29:  55%|█████▌    | 11/20 [00:37<00:28,  3.14s/it]
Task 5, Epoch 12/20 => Loss 0.714, Train_accy 87.29:  60%|██████    | 12/20 [00:37<00:25,  3.14s/it]
Task 5, Epoch 13/20 => Loss 0.662, Train_accy 88.61:  60%|██████    | 12/20 [00:40<00:25,  3.14s/it]
Task 5, Epoch 13/20 => Loss 0.662, Train_accy 88.61:  65%|██████▌   | 13/20 [00:40<00:22,  3.17s/it]
Task 5, Epoch 14/20 => Loss 0.675, Train_accy 86.91:  65%|██████▌   | 13/20 [00:44<00:22,  3.17s/it]
Task 5, Epoch 14/20 => Loss 0.675, Train_accy 86.91:  70%|███████   | 14/20 [00:44<00:18,  3.17s/it]
Task 5, Epoch 15/20 => Loss 0.656, Train_accy 88.43:  70%|███████   | 14/20 [00:47<00:18,  3.17s/it]
Task 5, Epoch 15/20 => Loss 0.656, Train_accy 88.43:  75%|███████▌  | 15/20 [00:47<00:15,  3.14s/it]
Task 5, Epoch 16/20 => Loss 0.633, Train_accy 87.86:  75%|███████▌  | 15/20 [00:50<00:15,  3.14s/it]
Task 5, Epoch 16/20 => Loss 0.633, Train_accy 87.86:  80%|████████  | 16/20 [00:50<00:12,  3.17s/it]
Task 5, Epoch 17/20 => Loss 0.610, Train_accy 91.46:  80%|████████  | 16/20 [00:53<00:12,  3.17s/it]
Task 5, Epoch 17/20 => Loss 0.610, Train_accy 91.46:  85%|████████▌ | 17/20 [00:53<00:09,  3.20s/it]
Task 5, Epoch 18/20 => Loss 0.608, Train_accy 89.18:  85%|████████▌ | 17/20 [00:56<00:09,  3.20s/it]
Task 5, Epoch 18/20 => Loss 0.608, Train_accy 89.18:  90%|█████████ | 18/20 [00:56<00:06,  3.17s/it]
Task 5, Epoch 19/20 => Loss 0.624, Train_accy 88.61:  90%|█████████ | 18/20 [00:59<00:06,  3.17s/it]
Task 5, Epoch 19/20 => Loss 0.624, Train_accy 88.61:  95%|█████████▌| 19/20 [00:59<00:03,  3.16s/it]
Task 5, Epoch 20/20 => Loss 0.617, Train_accy 87.67:  95%|█████████▌| 19/20 [01:02<00:03,  3.16s/it]
Task 5, Epoch 20/20 => Loss 0.617, Train_accy 87.67: 100%|██████████| 20/20 [01:03<00:00,  3.14s/it]
Task 5, Epoch 20/20 => Loss 0.617, Train_accy 87.67: 100%|██████████| 20/20 [01:03<00:00,  3.15s/it]
2024-04-19 10:13:46,877 [ease.py] => Task 5, Epoch 20/20 => Loss 0.617, Train_accy 87.67
2024-04-19 10:14:24,577 [ease.py] => Task correct: 60.30283080974325
2024-04-19 10:14:24,577 [ease.py] => Task acc: 82.75181040157999
2024-04-19 10:14:24,751 [trainer.py] => No NME accuracy.
2024-04-19 10:14:24,751 [trainer.py] => CNN: {'total': 56.35, '00-99': 53.98, '100-119': 63.43, '120-139': 63.01, '140-159': 51.97, '160-179': 54.42, '180-199': 63.71, 'old': 55.7, 'new': 63.71}
2024-04-19 10:14:24,751 [trainer.py] => CNN top1 curve: [73.48, 69.64, 64.5, 61.06, 57.78, 56.35]
2024-04-19 10:14:24,751 [trainer.py] => CNN top5 curve: [92.27, 90.15, 86.89, 85.02, 83.08, 81.76]

Average Accuracy (CNN): 63.80166666666668
2024-04-19 10:14:24,751 [trainer.py] => Average Accuracy (CNN): 63.80166666666668 

2024-04-19 10:14:24,751 [trainer.py] => Train Time: 1328.5100000000002
2024-04-19 10:14:24,751 [trainer.py] => Test Time: 70.96 

Accuracy Matrix (CNN):
[[73.48 67.66 61.47 58.98 55.41 53.98]
 [ 0.   82.09 73.13 70.15 66.42 63.43]
 [ 0.    0.   73.97 69.86 66.44 63.01]
 [ 0.    0.    0.   55.12 53.54 51.97]
 [ 0.    0.    0.    0.   58.5  54.42]
 [ 0.    0.    0.    0.    0.   63.71]]
2024-04-19 10:14:24,752 [trainer.py] => Forgetting (CNN): 11.270000000000001
2024-04-19 10:14:28,070 [trainer.py] => config: ./exps/simplecil_ina_B100.json
2024-04-19 10:14:28,070 [trainer.py] => prefix:  
2024-04-19 10:14:28,070 [trainer.py] => dataset: imageneta
2024-04-19 10:14:28,070 [trainer.py] => memory_size: 0
2024-04-19 10:14:28,070 [trainer.py] => memory_per_class: 0
2024-04-19 10:14:28,070 [trainer.py] => fixed_memory: False
2024-04-19 10:14:28,070 [trainer.py] => shuffle: True
2024-04-19 10:14:28,071 [trainer.py] => init_cls: 100
2024-04-19 10:14:28,071 [trainer.py] => increment: 20
2024-04-19 10:14:28,071 [trainer.py] => model_name: simplecil
2024-04-19 10:14:28,071 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-04-19 10:14:28,071 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-19 10:14:28,071 [trainer.py] => seed: 1993
2024-04-19 10:14:28,071 [trainer.py] => tuned_epoch: 0
2024-04-19 10:14:28,071 [trainer.py] => init_lr: 0.01
2024-04-19 10:14:28,071 [trainer.py] => batch_size: 48
2024-04-19 10:14:28,071 [trainer.py] => weight_decay: 0.05
2024-04-19 10:14:28,071 [trainer.py] => min_lr: 1e-08
2024-04-19 10:14:28,071 [trainer.py] => optimizer: sgd
2024-04-19 10:14:28,071 [trainer.py] => vpt_type: shallow
2024-04-19 10:14:28,071 [trainer.py] => prompt_token_num: 3
2024-04-19 10:14:28,101 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-19 10:14:30,816 [trainer.py] => All params: 85798656
2024-04-19 10:14:30,817 [trainer.py] => Trainable params: 85798656
2024-04-19 10:14:31,257 [simplecil.py] => Learning on 0-100
2024-04-19 10:14:43,967 [trainer.py] => No NME accuracy.
2024-04-19 10:14:43,967 [trainer.py] => CNN: {'total': 58.03, '00-99': 58.03, 'old': 0, 'new': 58.03}
2024-04-19 10:14:43,967 [trainer.py] => CNN top1 curve: [58.03]
2024-04-19 10:14:43,967 [trainer.py] => CNN top5 curve: [83.35]

Average Accuracy (CNN): 58.03
2024-04-19 10:14:43,967 [trainer.py] => Average Accuracy (CNN): 58.03 

2024-04-19 10:14:43,967 [trainer.py] => Train Time: 0.08
2024-04-19 10:14:43,967 [trainer.py] => Test Time: 2.98 

2024-04-19 10:14:43,968 [trainer.py] => All params: 85875457
2024-04-19 10:14:43,969 [trainer.py] => Trainable params: 85875457
2024-04-19 10:14:43,972 [simplecil.py] => Learning on 100-120
2024-04-19 10:14:49,831 [trainer.py] => No NME accuracy.
2024-04-19 10:14:49,832 [trainer.py] => CNN: {'total': 56.92, '00-99': 55.65, '100-119': 64.93, 'old': 55.65, 'new': 64.93}
2024-04-19 10:14:49,832 [trainer.py] => CNN top1 curve: [58.03, 56.92]
2024-04-19 10:14:49,832 [trainer.py] => CNN top5 curve: [83.35, 81.74]

Average Accuracy (CNN): 57.475
2024-04-19 10:14:49,832 [trainer.py] => Average Accuracy (CNN): 57.475 

2024-04-19 10:14:49,832 [trainer.py] => Train Time: 0.08
2024-04-19 10:14:49,832 [trainer.py] => Test Time: 6.41 

2024-04-19 10:14:49,833 [trainer.py] => All params: 85890817
2024-04-19 10:14:49,834 [trainer.py] => Trainable params: 85890817
2024-04-19 10:14:49,837 [simplecil.py] => Learning on 120-140
2024-04-19 10:14:55,832 [trainer.py] => No NME accuracy.
2024-04-19 10:14:55,832 [trainer.py] => CNN: {'total': 54.06, '00-99': 53.27, '100-119': 63.43, '120-139': 50.0, 'old': 54.67, 'new': 50.0}
2024-04-19 10:14:55,832 [trainer.py] => CNN top1 curve: [58.03, 56.92, 54.06]
2024-04-19 10:14:55,832 [trainer.py] => CNN top5 curve: [83.35, 81.74, 79.66]

Average Accuracy (CNN): 56.336666666666666
2024-04-19 10:14:55,832 [trainer.py] => Average Accuracy (CNN): 56.336666666666666 

2024-04-19 10:14:55,832 [trainer.py] => Train Time: 0.08
2024-04-19 10:14:55,832 [trainer.py] => Test Time: 10.05 

2024-04-19 10:14:55,833 [trainer.py] => All params: 85906177
2024-04-19 10:14:55,834 [trainer.py] => Trainable params: 85906177
2024-04-19 10:14:55,837 [simplecil.py] => Learning on 140-160
2024-04-19 10:15:02,279 [trainer.py] => No NME accuracy.
2024-04-19 10:15:02,280 [trainer.py] => CNN: {'total': 51.84, '00-99': 51.84, '100-119': 62.69, '120-139': 48.63, '140-159': 44.09, 'old': 52.72, 'new': 44.09}
2024-04-19 10:15:02,280 [trainer.py] => CNN top1 curve: [58.03, 56.92, 54.06, 51.84]
2024-04-19 10:15:02,280 [trainer.py] => CNN top5 curve: [83.35, 81.74, 79.66, 78.37]

Average Accuracy (CNN): 55.2125
2024-04-19 10:15:02,280 [trainer.py] => Average Accuracy (CNN): 55.2125 

2024-04-19 10:15:02,280 [trainer.py] => Train Time: 0.08
2024-04-19 10:15:02,280 [trainer.py] => Test Time: 14.120000000000001 

2024-04-19 10:15:02,281 [trainer.py] => All params: 85921537
2024-04-19 10:15:02,282 [trainer.py] => Trainable params: 85921537
2024-04-19 10:15:02,284 [simplecil.py] => Learning on 160-180
2024-04-19 10:15:09,235 [trainer.py] => No NME accuracy.
2024-04-19 10:15:09,235 [trainer.py] => CNN: {'total': 49.68, '00-99': 50.65, '100-119': 61.19, '120-139': 47.95, '140-159': 44.09, '160-179': 40.14, 'old': 50.8, 'new': 40.14}
2024-04-19 10:15:09,235 [trainer.py] => CNN top1 curve: [58.03, 56.92, 54.06, 51.84, 49.68]
2024-04-19 10:15:09,235 [trainer.py] => CNN top5 curve: [83.35, 81.74, 79.66, 78.37, 76.49]

Average Accuracy (CNN): 54.105999999999995
2024-04-19 10:15:09,235 [trainer.py] => Average Accuracy (CNN): 54.105999999999995 

2024-04-19 10:15:09,235 [trainer.py] => Train Time: 0.08
2024-04-19 10:15:09,235 [trainer.py] => Test Time: 18.6 

2024-04-19 10:15:09,236 [trainer.py] => All params: 85936897
2024-04-19 10:15:09,237 [trainer.py] => Trainable params: 85936897
2024-04-19 10:15:09,239 [simplecil.py] => Learning on 180-200
2024-04-19 10:15:16,193 [trainer.py] => No NME accuracy.
2024-04-19 10:15:16,193 [trainer.py] => CNN: {'total': 49.24, '00-99': 50.06, '100-119': 59.7, '120-139': 47.95, '140-159': 43.31, '160-179': 40.14, '180-199': 50.81, 'old': 49.1, 'new': 50.81}
2024-04-19 10:15:16,193 [trainer.py] => CNN top1 curve: [58.03, 56.92, 54.06, 51.84, 49.68, 49.24]
2024-04-19 10:15:16,193 [trainer.py] => CNN top5 curve: [83.35, 81.74, 79.66, 78.37, 76.49, 74.79]

Average Accuracy (CNN): 53.294999999999995
2024-04-19 10:15:16,193 [trainer.py] => Average Accuracy (CNN): 53.294999999999995 

2024-04-19 10:15:16,194 [trainer.py] => Train Time: 0.08
2024-04-19 10:15:16,194 [trainer.py] => Test Time: 23.150000000000002 

Accuracy Matrix (CNN):
[[58.03 55.65 53.27 51.84 50.65 50.06]
 [ 0.   64.93 63.43 62.69 61.19 59.7 ]
 [ 0.    0.   50.   48.63 47.95 47.95]
 [ 0.    0.    0.   44.09 44.09 43.31]
 [ 0.    0.    0.    0.   40.14 40.14]
 [ 0.    0.    0.    0.    0.   50.81]]
2024-04-19 10:15:16,194 [trainer.py] => Forgetting (CNN): 3.2060000000000004

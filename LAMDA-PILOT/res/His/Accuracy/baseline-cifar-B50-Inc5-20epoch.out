nohup: 忽略输入
2024-04-20 14:35:33,891 [trainer.py] => config: ./exps/finetune_B50.json
2024-04-20 14:35:33,891 [trainer.py] => prefix: reproduce
2024-04-20 14:35:33,891 [trainer.py] => dataset: cifar224
2024-04-20 14:35:33,891 [trainer.py] => memory_size: 0
2024-04-20 14:35:33,891 [trainer.py] => memory_per_class: 0
2024-04-20 14:35:33,891 [trainer.py] => fixed_memory: False
2024-04-20 14:35:33,891 [trainer.py] => shuffle: True
2024-04-20 14:35:33,891 [trainer.py] => init_cls: 50
2024-04-20 14:35:33,891 [trainer.py] => increment: 10
2024-04-20 14:35:33,891 [trainer.py] => model_name: finetune
2024-04-20 14:35:33,891 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-20 14:35:33,892 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-20 14:35:33,892 [trainer.py] => seed: 1993
2024-04-20 14:35:33,892 [trainer.py] => init_epoch: 20
2024-04-20 14:35:33,892 [trainer.py] => init_lr: 0.001
2024-04-20 14:35:33,892 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-20 14:35:33,892 [trainer.py] => init_lr_decay: 0.1
2024-04-20 14:35:33,892 [trainer.py] => init_weight_decay: 0.0005
2024-04-20 14:35:33,892 [trainer.py] => epochs: 20
2024-04-20 14:35:33,892 [trainer.py] => lrate: 0.001
2024-04-20 14:35:33,892 [trainer.py] => milestones: [40, 70]
2024-04-20 14:35:33,892 [trainer.py] => lrate_decay: 0.1
2024-04-20 14:35:33,892 [trainer.py] => batch_size: 48
2024-04-20 14:35:33,892 [trainer.py] => weight_decay: 0.0002
Files already downloaded and verified
Files already downloaded and verified
2024-04-20 14:35:35,996 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-20 14:35:43,691 [trainer.py] => All params: 85798656
2024-04-20 14:35:43,692 [trainer.py] => Trainable params: 85798656
2024-04-20 14:35:43,693 [finetune.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.442, Train_accy 62.29, Test_accy 90.48:   0%|          | 0/20 [03:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.442, Train_accy 62.29, Test_accy 90.48:   5%|▌         | 1/20 [03:00<57:00, 180.01s/it]
Task 0, Epoch 2/20 => Loss 0.759, Train_accy 78.83:   5%|▌         | 1/20 [05:47<57:00, 180.01s/it]                 
Task 0, Epoch 2/20 => Loss 0.759, Train_accy 78.83:  10%|█         | 2/20 [05:47<51:42, 172.38s/it]
Task 0, Epoch 3/20 => Loss 0.666, Train_accy 81.10:  10%|█         | 2/20 [08:33<51:42, 172.38s/it]
Task 0, Epoch 3/20 => Loss 0.666, Train_accy 81.10:  15%|█▌        | 3/20 [08:33<48:06, 169.80s/it]
Task 0, Epoch 4/20 => Loss 0.609, Train_accy 82.96:  15%|█▌        | 3/20 [11:20<48:06, 169.80s/it]
Task 0, Epoch 4/20 => Loss 0.609, Train_accy 82.96:  20%|██        | 4/20 [11:20<45:00, 168.76s/it]
Task 0, Epoch 5/20 => Loss 0.563, Train_accy 84.06:  20%|██        | 4/20 [14:08<45:00, 168.76s/it]
Task 0, Epoch 5/20 => Loss 0.563, Train_accy 84.06:  25%|██▌       | 5/20 [14:08<42:03, 168.25s/it]
Task 0, Epoch 6/20 => Loss 0.533, Train_accy 84.62, Test_accy 92.92:  25%|██▌       | 5/20 [17:08<42:03, 168.25s/it]
Task 0, Epoch 6/20 => Loss 0.533, Train_accy 84.62, Test_accy 92.92:  30%|███       | 6/20 [17:08<40:13, 172.40s/it]
Task 0, Epoch 7/20 => Loss 0.492, Train_accy 85.86:  30%|███       | 6/20 [19:55<40:13, 172.40s/it]                 
Task 0, Epoch 7/20 => Loss 0.492, Train_accy 85.86:  35%|███▌      | 7/20 [19:55<36:58, 170.69s/it]
Task 0, Epoch 8/20 => Loss 0.488, Train_accy 86.08:  35%|███▌      | 7/20 [22:43<36:58, 170.69s/it]
Task 0, Epoch 8/20 => Loss 0.488, Train_accy 86.08:  40%|████      | 8/20 [22:43<33:54, 169.56s/it]
Task 0, Epoch 9/20 => Loss 0.462, Train_accy 86.86:  40%|████      | 8/20 [25:29<33:54, 169.56s/it]
Task 0, Epoch 9/20 => Loss 0.462, Train_accy 86.86:  45%|████▌     | 9/20 [25:29<30:56, 168.74s/it]
Task 0, Epoch 10/20 => Loss 0.452, Train_accy 87.42:  45%|████▌     | 9/20 [28:17<30:56, 168.74s/it]
Task 0, Epoch 10/20 => Loss 0.452, Train_accy 87.42:  50%|█████     | 10/20 [28:17<28:02, 168.24s/it]
Task 0, Epoch 11/20 => Loss 0.439, Train_accy 87.26, Test_accy 92.82:  50%|█████     | 10/20 [31:18<28:02, 168.24s/it]
Task 0, Epoch 11/20 => Loss 0.439, Train_accy 87.26, Test_accy 92.82:  55%|█████▌    | 11/20 [31:18<25:51, 172.36s/it]
Task 0, Epoch 12/20 => Loss 0.427, Train_accy 87.83:  55%|█████▌    | 11/20 [34:06<25:51, 172.36s/it]                 
Task 0, Epoch 12/20 => Loss 0.427, Train_accy 87.83:  60%|██████    | 12/20 [34:06<22:47, 170.99s/it]
Task 0, Epoch 13/20 => Loss 0.412, Train_accy 88.17:  60%|██████    | 12/20 [36:55<22:47, 170.99s/it]
Task 0, Epoch 13/20 => Loss 0.412, Train_accy 88.17:  65%|██████▌   | 13/20 [36:55<19:51, 170.23s/it]
Task 0, Epoch 14/20 => Loss 0.413, Train_accy 88.27:  65%|██████▌   | 13/20 [39:43<19:51, 170.23s/it]
Task 0, Epoch 14/20 => Loss 0.413, Train_accy 88.27:  70%|███████   | 14/20 [39:43<16:58, 169.70s/it]
Task 0, Epoch 15/20 => Loss 0.400, Train_accy 88.62:  70%|███████   | 14/20 [42:31<16:58, 169.70s/it]
Task 0, Epoch 15/20 => Loss 0.400, Train_accy 88.62:  75%|███████▌  | 15/20 [42:31<14:06, 169.26s/it]
Task 0, Epoch 16/20 => Loss 0.386, Train_accy 89.04, Test_accy 93.54:  75%|███████▌  | 15/20 [45:33<14:06, 169.26s/it]
Task 0, Epoch 16/20 => Loss 0.386, Train_accy 89.04, Test_accy 93.54:  80%|████████  | 16/20 [45:33<11:31, 172.96s/it]
Task 0, Epoch 17/20 => Loss 0.382, Train_accy 89.20:  80%|████████  | 16/20 [48:20<11:31, 172.96s/it]                 
Task 0, Epoch 17/20 => Loss 0.382, Train_accy 89.20:  85%|████████▌ | 17/20 [48:20<08:33, 171.23s/it]
Task 0, Epoch 18/20 => Loss 0.372, Train_accy 89.26:  85%|████████▌ | 17/20 [51:07<08:33, 171.23s/it]
Task 0, Epoch 18/20 => Loss 0.372, Train_accy 89.26:  90%|█████████ | 18/20 [51:07<05:39, 169.97s/it]
Task 0, Epoch 19/20 => Loss 0.374, Train_accy 89.30:  90%|█████████ | 18/20 [53:54<05:39, 169.97s/it]
Task 0, Epoch 19/20 => Loss 0.374, Train_accy 89.30:  95%|█████████▌| 19/20 [53:54<02:49, 169.10s/it]
Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.85:  95%|█████████▌| 19/20 [56:41<02:49, 169.10s/it]
Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.85: 100%|██████████| 20/20 [56:41<00:00, 168.45s/it]
Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.85: 100%|██████████| 20/20 [56:41<00:00, 170.08s/it]
2024-04-20 15:32:26,121 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.85
2024-04-20 15:32:39,575 [trainer.py] => No NME accuracy.
2024-04-20 15:32:39,575 [trainer.py] => CNN: {'total': 93.36, '00-49': 93.36, 'old': 0, 'new': 93.36}
2024-04-20 15:32:39,575 [trainer.py] => CNN top1 curve: [93.36]
2024-04-20 15:32:39,575 [trainer.py] => CNN top5 curve: [99.1]

Average Accuracy (CNN): 93.36
2024-04-20 15:32:39,575 [trainer.py] => Average Accuracy (CNN): 93.36 

2024-04-20 15:32:39,575 [trainer.py] => Train Time: 6803.85
2024-04-20 15:32:39,575 [trainer.py] => Test Time: 13.45 

2024-04-20 15:32:39,576 [trainer.py] => All params: 85837106
2024-04-20 15:32:39,576 [trainer.py] => Trainable params: 85837106
2024-04-20 15:32:39,577 [finetune.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.554, Train_accy 51.46, Test_accy 89.72:   0%|          | 0/20 [00:49<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.554, Train_accy 51.46, Test_accy 89.72:   5%|▌         | 1/20 [00:49<15:44, 49.71s/it]
Task 1, Epoch 2/20 => Loss 0.238, Train_accy 72.04:   5%|▌         | 1/20 [01:23<15:44, 49.71s/it]                 
Task 1, Epoch 2/20 => Loss 0.238, Train_accy 72.04:  10%|█         | 2/20 [01:23<12:05, 40.32s/it]
Task 1, Epoch 3/20 => Loss 0.218, Train_accy 74.46:  10%|█         | 2/20 [01:57<12:05, 40.32s/it]
Task 1, Epoch 3/20 => Loss 0.218, Train_accy 74.46:  15%|█▌        | 3/20 [01:57<10:33, 37.28s/it]
Task 1, Epoch 4/20 => Loss 0.200, Train_accy 78.20:  15%|█▌        | 3/20 [02:31<10:33, 37.28s/it]
Task 1, Epoch 4/20 => Loss 0.200, Train_accy 78.20:  20%|██        | 4/20 [02:31<09:35, 35.94s/it]
Task 1, Epoch 5/20 => Loss 0.208, Train_accy 78.90:  20%|██        | 4/20 [03:04<09:35, 35.94s/it]
Task 1, Epoch 5/20 => Loss 0.208, Train_accy 78.90:  25%|██▌       | 5/20 [03:04<08:47, 35.15s/it]
Task 1, Epoch 6/20 => Loss 0.178, Train_accy 81.40, Test_accy 90.00:  25%|██▌       | 5/20 [03:54<08:47, 35.15s/it]
Task 1, Epoch 6/20 => Loss 0.178, Train_accy 81.40, Test_accy 90.00:  30%|███       | 6/20 [03:54<09:19, 39.99s/it]
Task 1, Epoch 7/20 => Loss 0.173, Train_accy 83.02:  30%|███       | 6/20 [04:27<09:19, 39.99s/it]                 
Task 1, Epoch 7/20 => Loss 0.173, Train_accy 83.02:  35%|███▌      | 7/20 [04:27<08:13, 37.99s/it]
Task 1, Epoch 8/20 => Loss 0.166, Train_accy 82.42:  35%|███▌      | 7/20 [05:01<08:13, 37.99s/it]
Task 1, Epoch 8/20 => Loss 0.166, Train_accy 82.42:  40%|████      | 8/20 [05:01<07:19, 36.65s/it]
Task 1, Epoch 9/20 => Loss 0.162, Train_accy 85.02:  40%|████      | 8/20 [05:35<07:19, 36.65s/it]
Task 1, Epoch 9/20 => Loss 0.162, Train_accy 85.02:  45%|████▌     | 9/20 [05:35<06:33, 35.76s/it]
Task 1, Epoch 10/20 => Loss 0.179, Train_accy 84.30:  45%|████▌     | 9/20 [06:09<06:33, 35.76s/it]
Task 1, Epoch 10/20 => Loss 0.179, Train_accy 84.30:  50%|█████     | 10/20 [06:09<05:51, 35.14s/it]
Task 1, Epoch 11/20 => Loss 0.151, Train_accy 85.40, Test_accy 89.95:  50%|█████     | 10/20 [06:58<05:51, 35.14s/it]
Task 1, Epoch 11/20 => Loss 0.151, Train_accy 85.40, Test_accy 89.95:  55%|█████▌    | 11/20 [06:58<05:55, 39.55s/it]
Task 1, Epoch 12/20 => Loss 0.154, Train_accy 85.86:  55%|█████▌    | 11/20 [07:32<05:55, 39.55s/it]                 
Task 1, Epoch 12/20 => Loss 0.154, Train_accy 85.86:  60%|██████    | 12/20 [07:32<05:02, 37.84s/it]
Task 1, Epoch 13/20 => Loss 0.150, Train_accy 86.60:  60%|██████    | 12/20 [08:06<05:02, 37.84s/it]
Task 1, Epoch 13/20 => Loss 0.150, Train_accy 86.60:  65%|██████▌   | 13/20 [08:06<04:16, 36.63s/it]
Task 1, Epoch 14/20 => Loss 0.146, Train_accy 86.08:  65%|██████▌   | 13/20 [08:40<04:16, 36.63s/it]
Task 1, Epoch 14/20 => Loss 0.146, Train_accy 86.08:  70%|███████   | 14/20 [08:40<03:34, 35.75s/it]
Task 1, Epoch 15/20 => Loss 0.142, Train_accy 86.98:  70%|███████   | 14/20 [09:13<03:34, 35.75s/it]
Task 1, Epoch 15/20 => Loss 0.142, Train_accy 86.98:  75%|███████▌  | 15/20 [09:13<02:55, 35.10s/it]
Task 1, Epoch 16/20 => Loss 0.153, Train_accy 87.28, Test_accy 89.37:  75%|███████▌  | 15/20 [10:03<02:55, 35.10s/it]
Task 1, Epoch 16/20 => Loss 0.153, Train_accy 87.28, Test_accy 89.37:  80%|████████  | 16/20 [10:03<02:37, 39.49s/it]
Task 1, Epoch 17/20 => Loss 0.137, Train_accy 87.60:  80%|████████  | 16/20 [10:37<02:37, 39.49s/it]                 
Task 1, Epoch 17/20 => Loss 0.137, Train_accy 87.60:  85%|████████▌ | 17/20 [10:37<01:53, 37.76s/it]
Task 1, Epoch 18/20 => Loss 0.146, Train_accy 87.94:  85%|████████▌ | 17/20 [11:11<01:53, 37.76s/it]
Task 1, Epoch 18/20 => Loss 0.146, Train_accy 87.94:  90%|█████████ | 18/20 [11:11<01:13, 36.62s/it]
Task 1, Epoch 19/20 => Loss 0.140, Train_accy 88.10:  90%|█████████ | 18/20 [11:45<01:13, 36.62s/it]
Task 1, Epoch 19/20 => Loss 0.140, Train_accy 88.10:  95%|█████████▌| 19/20 [11:45<00:35, 35.76s/it]
Task 1, Epoch 20/20 => Loss 0.145, Train_accy 87.72:  95%|█████████▌| 19/20 [12:18<00:35, 35.76s/it]
Task 1, Epoch 20/20 => Loss 0.145, Train_accy 87.72: 100%|██████████| 20/20 [12:18<00:00, 35.13s/it]
Task 1, Epoch 20/20 => Loss 0.145, Train_accy 87.72: 100%|██████████| 20/20 [12:18<00:00, 36.94s/it]
2024-04-20 15:44:58,441 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.145, Train_accy 87.72
2024-04-20 15:45:14,181 [trainer.py] => No NME accuracy.
2024-04-20 15:45:14,182 [trainer.py] => CNN: {'total': 89.45, '00-49': 88.82, '50-59': 92.6, 'old': 88.82, 'new': 92.6}
2024-04-20 15:45:14,182 [trainer.py] => CNN top1 curve: [93.36, 89.45]
2024-04-20 15:45:14,182 [trainer.py] => CNN top5 curve: [99.1, 98.48]

Average Accuracy (CNN): 91.4
2024-04-20 15:45:14,182 [trainer.py] => Average Accuracy (CNN): 91.4 

2024-04-20 15:45:14,182 [trainer.py] => Train Time: 7542.650000000001
2024-04-20 15:45:14,182 [trainer.py] => Test Time: 29.189999999999998 

2024-04-20 15:45:14,183 [trainer.py] => All params: 85844796
2024-04-20 15:45:14,184 [trainer.py] => Trainable params: 85844796
2024-04-20 15:45:14,185 [finetune.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.463, Train_accy 50.90, Test_accy 86.81:   0%|          | 0/20 [00:52<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.463, Train_accy 50.90, Test_accy 86.81:   5%|▌         | 1/20 [00:52<16:30, 52.16s/it]
Task 2, Epoch 2/20 => Loss 0.199, Train_accy 71.26:   5%|▌         | 1/20 [01:26<16:30, 52.16s/it]                 
Task 2, Epoch 2/20 => Loss 0.199, Train_accy 71.26:  10%|█         | 2/20 [01:26<12:25, 41.41s/it]
Task 2, Epoch 3/20 => Loss 0.168, Train_accy 77.70:  10%|█         | 2/20 [01:59<12:25, 41.41s/it]
Task 2, Epoch 3/20 => Loss 0.168, Train_accy 77.70:  15%|█▌        | 3/20 [01:59<10:45, 37.94s/it]
Task 2, Epoch 4/20 => Loss 0.150, Train_accy 80.30:  15%|█▌        | 3/20 [02:33<10:45, 37.94s/it]
Task 2, Epoch 4/20 => Loss 0.150, Train_accy 80.30:  20%|██        | 4/20 [02:33<09:42, 36.40s/it]
Task 2, Epoch 5/20 => Loss 0.149, Train_accy 82.32:  20%|██        | 4/20 [03:07<09:42, 36.40s/it]
Task 2, Epoch 5/20 => Loss 0.149, Train_accy 82.32:  25%|██▌       | 5/20 [03:07<08:51, 35.42s/it]
Task 2, Epoch 6/20 => Loss 0.146, Train_accy 82.76, Test_accy 86.66:  25%|██▌       | 5/20 [03:59<08:51, 35.42s/it]
Task 2, Epoch 6/20 => Loss 0.146, Train_accy 82.76, Test_accy 86.66:  30%|███       | 6/20 [03:59<09:35, 41.14s/it]
Task 2, Epoch 7/20 => Loss 0.143, Train_accy 84.34:  30%|███       | 6/20 [04:33<09:35, 41.14s/it]                 
Task 2, Epoch 7/20 => Loss 0.143, Train_accy 84.34:  35%|███▌      | 7/20 [04:33<08:23, 38.74s/it]
Task 2, Epoch 8/20 => Loss 0.121, Train_accy 85.68:  35%|███▌      | 7/20 [05:07<08:23, 38.74s/it]
Task 2, Epoch 8/20 => Loss 0.121, Train_accy 85.68:  40%|████      | 8/20 [05:07<07:26, 37.23s/it]
Task 2, Epoch 9/20 => Loss 0.131, Train_accy 85.50:  40%|████      | 8/20 [05:41<07:26, 37.23s/it]
Task 2, Epoch 9/20 => Loss 0.131, Train_accy 85.50:  45%|████▌     | 9/20 [05:41<06:38, 36.23s/it]
Task 2, Epoch 10/20 => Loss 0.136, Train_accy 84.84:  45%|████▌     | 9/20 [06:15<06:38, 36.23s/it]
Task 2, Epoch 10/20 => Loss 0.136, Train_accy 84.84:  50%|█████     | 10/20 [06:15<05:55, 35.53s/it]
Task 2, Epoch 11/20 => Loss 0.119, Train_accy 86.82, Test_accy 86.37:  50%|█████     | 10/20 [07:08<05:55, 35.53s/it]
Task 2, Epoch 11/20 => Loss 0.119, Train_accy 86.82, Test_accy 86.37:  55%|█████▌    | 11/20 [07:08<06:06, 40.74s/it]
Task 2, Epoch 12/20 => Loss 0.140, Train_accy 87.16:  55%|█████▌    | 11/20 [07:42<06:06, 40.74s/it]                 
Task 2, Epoch 12/20 => Loss 0.140, Train_accy 87.16:  60%|██████    | 12/20 [07:42<05:09, 38.70s/it]
Task 2, Epoch 13/20 => Loss 0.135, Train_accy 87.66:  60%|██████    | 12/20 [08:16<05:09, 38.70s/it]
Task 2, Epoch 13/20 => Loss 0.135, Train_accy 87.66:  65%|██████▌   | 13/20 [08:16<04:20, 37.28s/it]
Task 2, Epoch 14/20 => Loss 0.125, Train_accy 88.04:  65%|██████▌   | 13/20 [08:50<04:20, 37.28s/it]
Task 2, Epoch 14/20 => Loss 0.125, Train_accy 88.04:  70%|███████   | 14/20 [08:50<03:37, 36.27s/it]
Task 2, Epoch 15/20 => Loss 0.120, Train_accy 87.92:  70%|███████   | 14/20 [09:24<03:37, 36.27s/it]
Task 2, Epoch 15/20 => Loss 0.120, Train_accy 87.92:  75%|███████▌  | 15/20 [09:24<02:58, 35.62s/it]
Task 2, Epoch 16/20 => Loss 0.118, Train_accy 88.56, Test_accy 86.69:  75%|███████▌  | 15/20 [10:16<02:58, 35.62s/it]
Task 2, Epoch 16/20 => Loss 0.118, Train_accy 88.56, Test_accy 86.69:  80%|████████  | 16/20 [10:16<02:42, 40.69s/it]
Task 2, Epoch 17/20 => Loss 0.113, Train_accy 89.62:  80%|████████  | 16/20 [10:50<02:42, 40.69s/it]                 
Task 2, Epoch 17/20 => Loss 0.113, Train_accy 89.62:  85%|████████▌ | 17/20 [10:50<01:56, 38.67s/it]
Task 2, Epoch 18/20 => Loss 0.140, Train_accy 88.52:  85%|████████▌ | 17/20 [11:24<01:56, 38.67s/it]
Task 2, Epoch 18/20 => Loss 0.140, Train_accy 88.52:  90%|█████████ | 18/20 [11:24<01:14, 37.30s/it]
Task 2, Epoch 19/20 => Loss 0.125, Train_accy 88.70:  90%|█████████ | 18/20 [11:58<01:14, 37.30s/it]
Task 2, Epoch 19/20 => Loss 0.125, Train_accy 88.70:  95%|█████████▌| 19/20 [11:58<00:36, 36.29s/it]
Task 2, Epoch 20/20 => Loss 0.124, Train_accy 89.36:  95%|█████████▌| 19/20 [12:32<00:36, 36.29s/it]
Task 2, Epoch 20/20 => Loss 0.124, Train_accy 89.36: 100%|██████████| 20/20 [12:32<00:00, 35.60s/it]
Task 2, Epoch 20/20 => Loss 0.124, Train_accy 89.36: 100%|██████████| 20/20 [12:32<00:00, 37.64s/it]
2024-04-20 15:57:46,973 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.124, Train_accy 89.36
2024-04-20 15:58:05,681 [trainer.py] => No NME accuracy.
2024-04-20 15:58:05,681 [trainer.py] => CNN: {'total': 85.97, '00-49': 84.56, '50-59': 83.4, '60-69': 95.6, 'old': 84.37, 'new': 95.6}
2024-04-20 15:58:05,681 [trainer.py] => CNN top1 curve: [93.36, 89.45, 85.97]
2024-04-20 15:58:05,681 [trainer.py] => CNN top5 curve: [99.1, 98.48, 98.01]

Average Accuracy (CNN): 89.59
2024-04-20 15:58:05,682 [trainer.py] => Average Accuracy (CNN): 89.59 

2024-04-20 15:58:05,682 [trainer.py] => Train Time: 8295.400000000001
2024-04-20 15:58:05,682 [trainer.py] => Test Time: 47.9 

2024-04-20 15:58:05,682 [trainer.py] => All params: 85852486
2024-04-20 15:58:05,683 [trainer.py] => Trainable params: 85852486
2024-04-20 15:58:05,685 [finetune.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.547, Train_accy 48.86, Test_accy 80.04:   0%|          | 0/20 [00:55<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.547, Train_accy 48.86, Test_accy 80.04:   5%|▌         | 1/20 [00:55<17:34, 55.49s/it]
Task 3, Epoch 2/20 => Loss 0.241, Train_accy 72.00:   5%|▌         | 1/20 [01:29<17:34, 55.49s/it]                 
Task 3, Epoch 2/20 => Loss 0.241, Train_accy 72.00:  10%|█         | 2/20 [01:29<12:50, 42.79s/it]
Task 3, Epoch 3/20 => Loss 0.214, Train_accy 75.62:  10%|█         | 2/20 [02:03<12:50, 42.79s/it]
Task 3, Epoch 3/20 => Loss 0.214, Train_accy 75.62:  15%|█▌        | 3/20 [02:03<10:59, 38.81s/it]
Task 3, Epoch 4/20 => Loss 0.178, Train_accy 76.76:  15%|█▌        | 3/20 [02:37<10:59, 38.81s/it]
Task 3, Epoch 4/20 => Loss 0.178, Train_accy 76.76:  20%|██        | 4/20 [02:37<09:50, 36.91s/it]
Task 3, Epoch 5/20 => Loss 0.168, Train_accy 79.94:  20%|██        | 4/20 [03:11<09:50, 36.91s/it]
Task 3, Epoch 5/20 => Loss 0.168, Train_accy 79.94:  25%|██▌       | 5/20 [03:11<08:56, 35.79s/it]
Task 3, Epoch 6/20 => Loss 0.170, Train_accy 81.48, Test_accy 79.24:  25%|██▌       | 5/20 [04:05<08:56, 35.79s/it]
Task 3, Epoch 6/20 => Loss 0.170, Train_accy 81.48, Test_accy 79.24:  30%|███       | 6/20 [04:05<09:51, 42.23s/it]
Task 3, Epoch 7/20 => Loss 0.177, Train_accy 82.04:  30%|███       | 6/20 [04:39<09:51, 42.23s/it]                 
Task 3, Epoch 7/20 => Loss 0.177, Train_accy 82.04:  35%|███▌      | 7/20 [04:39<08:33, 39.47s/it]
Task 3, Epoch 8/20 => Loss 0.164, Train_accy 81.62:  35%|███▌      | 7/20 [05:13<08:33, 39.47s/it]
Task 3, Epoch 8/20 => Loss 0.164, Train_accy 81.62:  40%|████      | 8/20 [05:13<07:32, 37.69s/it]
Task 3, Epoch 9/20 => Loss 0.164, Train_accy 82.54:  40%|████      | 8/20 [05:47<07:32, 37.69s/it]
Task 3, Epoch 9/20 => Loss 0.164, Train_accy 82.54:  45%|████▌     | 9/20 [05:47<06:41, 36.49s/it]
Task 3, Epoch 10/20 => Loss 0.144, Train_accy 81.86:  45%|████▌     | 9/20 [06:21<06:41, 36.49s/it]
Task 3, Epoch 10/20 => Loss 0.144, Train_accy 81.86:  50%|█████     | 10/20 [06:21<05:57, 35.72s/it]
Task 3, Epoch 11/20 => Loss 0.141, Train_accy 83.60, Test_accy 79.82:  50%|█████     | 10/20 [07:16<05:57, 35.72s/it]
Task 3, Epoch 11/20 => Loss 0.141, Train_accy 83.60, Test_accy 79.82:  55%|█████▌    | 11/20 [07:16<06:15, 41.70s/it]
Task 3, Epoch 12/20 => Loss 0.143, Train_accy 84.02:  55%|█████▌    | 11/20 [07:50<06:15, 41.70s/it]                 
Task 3, Epoch 12/20 => Loss 0.143, Train_accy 84.02:  60%|██████    | 12/20 [07:50<05:14, 39.32s/it]
Task 3, Epoch 13/20 => Loss 0.148, Train_accy 84.72:  60%|██████    | 12/20 [08:24<05:14, 39.32s/it]
Task 3, Epoch 13/20 => Loss 0.148, Train_accy 84.72:  65%|██████▌   | 13/20 [08:24<04:23, 37.71s/it]
Task 3, Epoch 14/20 => Loss 0.136, Train_accy 85.68:  65%|██████▌   | 13/20 [08:58<04:23, 37.71s/it]
Task 3, Epoch 14/20 => Loss 0.136, Train_accy 85.68:  70%|███████   | 14/20 [08:58<03:39, 36.57s/it]
Task 3, Epoch 15/20 => Loss 0.138, Train_accy 86.70:  70%|███████   | 14/20 [09:32<03:39, 36.57s/it]
Task 3, Epoch 15/20 => Loss 0.138, Train_accy 86.70:  75%|███████▌  | 15/20 [09:32<02:58, 35.77s/it]
Task 3, Epoch 16/20 => Loss 0.144, Train_accy 85.92, Test_accy 77.11:  75%|███████▌  | 15/20 [10:27<02:58, 35.77s/it]
Task 3, Epoch 16/20 => Loss 0.144, Train_accy 85.92, Test_accy 77.11:  80%|████████  | 16/20 [10:27<02:46, 41.59s/it]
Task 3, Epoch 17/20 => Loss 0.135, Train_accy 87.36:  80%|████████  | 16/20 [11:01<02:46, 41.59s/it]                 
Task 3, Epoch 17/20 => Loss 0.135, Train_accy 87.36:  85%|████████▌ | 17/20 [11:01<01:58, 39.36s/it]
Task 3, Epoch 18/20 => Loss 0.122, Train_accy 87.62:  85%|████████▌ | 17/20 [11:36<01:58, 39.36s/it]
Task 3, Epoch 18/20 => Loss 0.122, Train_accy 87.62:  90%|█████████ | 18/20 [11:36<01:15, 37.83s/it]
Task 3, Epoch 19/20 => Loss 0.135, Train_accy 86.40:  90%|█████████ | 18/20 [12:10<01:15, 37.83s/it]
Task 3, Epoch 19/20 => Loss 0.135, Train_accy 86.40:  95%|█████████▌| 19/20 [12:10<00:36, 36.82s/it]
Task 3, Epoch 20/20 => Loss 0.114, Train_accy 88.16:  95%|█████████▌| 19/20 [12:44<00:36, 36.82s/it]
Task 3, Epoch 20/20 => Loss 0.114, Train_accy 88.16: 100%|██████████| 20/20 [12:44<00:00, 36.10s/it]
Task 3, Epoch 20/20 => Loss 0.114, Train_accy 88.16: 100%|██████████| 20/20 [12:44<00:00, 38.25s/it]
2024-04-20 16:10:50,670 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.114, Train_accy 88.16
2024-04-20 16:11:11,844 [trainer.py] => No NME accuracy.
2024-04-20 16:11:11,844 [trainer.py] => CNN: {'total': 77.25, '00-49': 77.64, '50-59': 60.4, '60-69': 77.7, '70-79': 91.7, 'old': 75.19, 'new': 91.7}
2024-04-20 16:11:11,844 [trainer.py] => CNN top1 curve: [93.36, 89.45, 85.97, 77.25]
2024-04-20 16:11:11,844 [trainer.py] => CNN top5 curve: [99.1, 98.48, 98.01, 96.56]

Average Accuracy (CNN): 86.51
2024-04-20 16:11:11,845 [trainer.py] => Average Accuracy (CNN): 86.51 

2024-04-20 16:11:11,845 [trainer.py] => Train Time: 9060.330000000002
2024-04-20 16:11:11,845 [trainer.py] => Test Time: 69.07 

2024-04-20 16:11:11,846 [trainer.py] => All params: 85860176
2024-04-20 16:11:11,846 [trainer.py] => Trainable params: 85860176
2024-04-20 16:11:11,848 [finetune.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.558, Train_accy 41.46, Test_accy 75.82:   0%|          | 0/20 [00:57<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.558, Train_accy 41.46, Test_accy 75.82:   5%|▌         | 1/20 [00:57<18:17, 57.79s/it]
Task 4, Epoch 2/20 => Loss 0.240, Train_accy 68.94:   5%|▌         | 1/20 [01:31<18:17, 57.79s/it]                 
Task 4, Epoch 2/20 => Loss 0.240, Train_accy 68.94:  10%|█         | 2/20 [01:31<13:09, 43.89s/it]
Task 4, Epoch 3/20 => Loss 0.206, Train_accy 73.82:  10%|█         | 2/20 [02:06<13:09, 43.89s/it]
Task 4, Epoch 3/20 => Loss 0.206, Train_accy 73.82:  15%|█▌        | 3/20 [02:06<11:10, 39.46s/it]
Task 4, Epoch 4/20 => Loss 0.196, Train_accy 76.68:  15%|█▌        | 3/20 [02:40<11:10, 39.46s/it]
Task 4, Epoch 4/20 => Loss 0.196, Train_accy 76.68:  20%|██        | 4/20 [02:40<09:57, 37.35s/it]
Task 4, Epoch 5/20 => Loss 0.177, Train_accy 78.40:  20%|██        | 4/20 [03:14<09:57, 37.35s/it]
Task 4, Epoch 5/20 => Loss 0.177, Train_accy 78.40:  25%|██▌       | 5/20 [03:14<09:03, 36.21s/it]
Task 4, Epoch 6/20 => Loss 0.165, Train_accy 80.30, Test_accy 77.80:  25%|██▌       | 5/20 [04:12<09:03, 36.21s/it]
Task 4, Epoch 6/20 => Loss 0.165, Train_accy 80.30, Test_accy 77.80:  30%|███       | 6/20 [04:12<10:09, 43.56s/it]
Task 4, Epoch 7/20 => Loss 0.175, Train_accy 80.88:  30%|███       | 6/20 [04:46<10:09, 43.56s/it]                 
Task 4, Epoch 7/20 => Loss 0.175, Train_accy 80.88:  35%|███▌      | 7/20 [04:46<08:46, 40.49s/it]
Task 4, Epoch 8/20 => Loss 0.161, Train_accy 82.18:  35%|███▌      | 7/20 [05:20<08:46, 40.49s/it]
Task 4, Epoch 8/20 => Loss 0.161, Train_accy 82.18:  40%|████      | 8/20 [05:20<07:42, 38.53s/it]
Task 4, Epoch 9/20 => Loss 0.157, Train_accy 84.24:  40%|████      | 8/20 [05:54<07:42, 38.53s/it]
Task 4, Epoch 9/20 => Loss 0.157, Train_accy 84.24:  45%|████▌     | 9/20 [05:54<06:48, 37.14s/it]
Task 4, Epoch 10/20 => Loss 0.163, Train_accy 84.50:  45%|████▌     | 9/20 [06:28<06:48, 37.14s/it]
Task 4, Epoch 10/20 => Loss 0.163, Train_accy 84.50:  50%|█████     | 10/20 [06:28<06:01, 36.17s/it]
Task 4, Epoch 11/20 => Loss 0.156, Train_accy 85.46, Test_accy 75.96:  50%|█████     | 10/20 [07:26<06:01, 36.17s/it]
Task 4, Epoch 11/20 => Loss 0.156, Train_accy 85.46, Test_accy 75.96:  55%|█████▌    | 11/20 [07:26<06:24, 42.77s/it]
Task 4, Epoch 12/20 => Loss 0.143, Train_accy 87.22:  55%|█████▌    | 11/20 [08:00<06:24, 42.77s/it]                 
Task 4, Epoch 12/20 => Loss 0.143, Train_accy 87.22:  60%|██████    | 12/20 [08:00<05:21, 40.14s/it]
Task 4, Epoch 13/20 => Loss 0.150, Train_accy 85.62:  60%|██████    | 12/20 [08:34<05:21, 40.14s/it]
Task 4, Epoch 13/20 => Loss 0.150, Train_accy 85.62:  65%|██████▌   | 13/20 [08:34<04:28, 38.32s/it]
Task 4, Epoch 14/20 => Loss 0.137, Train_accy 87.18:  65%|██████▌   | 13/20 [09:08<04:28, 38.32s/it]
Task 4, Epoch 14/20 => Loss 0.137, Train_accy 87.18:  70%|███████   | 14/20 [09:08<03:42, 37.06s/it]
Task 4, Epoch 15/20 => Loss 0.147, Train_accy 86.66:  70%|███████   | 14/20 [09:43<03:42, 37.06s/it]
Task 4, Epoch 15/20 => Loss 0.147, Train_accy 86.66:  75%|███████▌  | 15/20 [09:43<03:00, 36.18s/it]
Task 4, Epoch 16/20 => Loss 0.135, Train_accy 89.16, Test_accy 75.62:  75%|███████▌  | 15/20 [10:40<03:00, 36.18s/it]
Task 4, Epoch 16/20 => Loss 0.135, Train_accy 89.16, Test_accy 75.62:  80%|████████  | 16/20 [10:40<02:50, 42.67s/it]
Task 4, Epoch 17/20 => Loss 0.135, Train_accy 88.82:  80%|████████  | 16/20 [11:15<02:50, 42.67s/it]                 
Task 4, Epoch 17/20 => Loss 0.135, Train_accy 88.82:  85%|████████▌ | 17/20 [11:15<02:00, 40.15s/it]
Task 4, Epoch 18/20 => Loss 0.138, Train_accy 89.08:  85%|████████▌ | 17/20 [11:49<02:00, 40.15s/it]
Task 4, Epoch 18/20 => Loss 0.138, Train_accy 89.08:  90%|█████████ | 18/20 [11:49<01:16, 38.35s/it]
Task 4, Epoch 19/20 => Loss 0.142, Train_accy 88.88:  90%|█████████ | 18/20 [12:23<01:16, 38.35s/it]
Task 4, Epoch 19/20 => Loss 0.142, Train_accy 88.88:  95%|█████████▌| 19/20 [12:23<00:37, 37.08s/it]
Task 4, Epoch 20/20 => Loss 0.138, Train_accy 89.00:  95%|█████████▌| 19/20 [12:57<00:37, 37.08s/it]
Task 4, Epoch 20/20 => Loss 0.138, Train_accy 89.00: 100%|██████████| 20/20 [12:57<00:00, 36.16s/it]
Task 4, Epoch 20/20 => Loss 0.138, Train_accy 89.00: 100%|██████████| 20/20 [12:57<00:00, 38.87s/it]
2024-04-20 16:24:09,374 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.138, Train_accy 89.00
2024-04-20 16:24:33,174 [trainer.py] => No NME accuracy.
2024-04-20 16:24:33,175 [trainer.py] => CNN: {'total': 75.43, '00-49': 74.84, '50-59': 61.3, '60-69': 70.6, '70-79': 78.6, '80-89': 94.2, 'old': 73.09, 'new': 94.2}
2024-04-20 16:24:33,175 [trainer.py] => CNN top1 curve: [93.36, 89.45, 85.97, 77.25, 75.43]
2024-04-20 16:24:33,175 [trainer.py] => CNN top5 curve: [99.1, 98.48, 98.01, 96.56, 96.01]

Average Accuracy (CNN): 84.29
2024-04-20 16:24:33,175 [trainer.py] => Average Accuracy (CNN): 84.29 

2024-04-20 16:24:33,175 [trainer.py] => Train Time: 9837.810000000001
2024-04-20 16:24:33,175 [trainer.py] => Test Time: 92.86999999999999 

2024-04-20 16:24:33,176 [trainer.py] => All params: 85867866
2024-04-20 16:24:33,176 [trainer.py] => Trainable params: 85867866
2024-04-20 16:24:33,178 [finetune.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.549, Train_accy 43.82, Test_accy 75.71:   0%|          | 0/20 [01:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.549, Train_accy 43.82, Test_accy 75.71:   5%|▌         | 1/20 [01:00<19:13, 60.74s/it]
Task 5, Epoch 2/20 => Loss 0.265, Train_accy 67.78:   5%|▌         | 1/20 [01:34<19:13, 60.74s/it]                 
Task 5, Epoch 2/20 => Loss 0.265, Train_accy 67.78:  10%|█         | 2/20 [01:34<13:31, 45.09s/it]
Task 5, Epoch 3/20 => Loss 0.245, Train_accy 72.84:  10%|█         | 2/20 [02:08<13:31, 45.09s/it]
Task 5, Epoch 3/20 => Loss 0.245, Train_accy 72.84:  15%|█▌        | 3/20 [02:08<11:20, 40.02s/it]
Task 5, Epoch 4/20 => Loss 0.199, Train_accy 79.08:  15%|█▌        | 3/20 [02:43<11:20, 40.02s/it]
Task 5, Epoch 4/20 => Loss 0.199, Train_accy 79.08:  20%|██        | 4/20 [02:43<10:03, 37.71s/it]
Task 5, Epoch 5/20 => Loss 0.196, Train_accy 80.84:  20%|██        | 4/20 [03:17<10:03, 37.71s/it]
Task 5, Epoch 5/20 => Loss 0.196, Train_accy 80.84:  25%|██▌       | 5/20 [03:17<09:06, 36.41s/it]
Task 5, Epoch 6/20 => Loss 0.192, Train_accy 82.06, Test_accy 76.56:  25%|██▌       | 5/20 [04:17<09:06, 36.41s/it]
Task 5, Epoch 6/20 => Loss 0.192, Train_accy 82.06, Test_accy 76.56:  30%|███       | 6/20 [04:17<10:25, 44.65s/it]
Task 5, Epoch 7/20 => Loss 0.178, Train_accy 83.44:  30%|███       | 6/20 [04:51<10:25, 44.65s/it]                 
Task 5, Epoch 7/20 => Loss 0.178, Train_accy 83.44:  35%|███▌      | 7/20 [04:51<08:55, 41.22s/it]
Task 5, Epoch 8/20 => Loss 0.169, Train_accy 84.50:  35%|███▌      | 7/20 [05:26<08:55, 41.22s/it]
Task 5, Epoch 8/20 => Loss 0.169, Train_accy 84.50:  40%|████      | 8/20 [05:26<07:47, 38.98s/it]
Task 5, Epoch 9/20 => Loss 0.162, Train_accy 86.50:  40%|████      | 8/20 [06:00<07:47, 38.98s/it]
Task 5, Epoch 9/20 => Loss 0.162, Train_accy 86.50:  45%|████▌     | 9/20 [06:00<06:52, 37.46s/it]
Task 5, Epoch 10/20 => Loss 0.156, Train_accy 86.80:  45%|████▌     | 9/20 [06:34<06:52, 37.46s/it]
Task 5, Epoch 10/20 => Loss 0.156, Train_accy 86.80:  50%|█████     | 10/20 [06:34<06:04, 36.42s/it]
Task 5, Epoch 11/20 => Loss 0.168, Train_accy 86.64, Test_accy 76.69:  50%|█████     | 10/20 [07:34<06:04, 36.42s/it]
Task 5, Epoch 11/20 => Loss 0.168, Train_accy 86.64, Test_accy 76.69:  55%|█████▌    | 11/20 [07:34<06:34, 43.82s/it]
Task 5, Epoch 12/20 => Loss 0.160, Train_accy 86.88:  55%|█████▌    | 11/20 [08:09<06:34, 43.82s/it]                 
Task 5, Epoch 12/20 => Loss 0.160, Train_accy 86.88:  60%|██████    | 12/20 [08:09<05:26, 40.86s/it]
Task 5, Epoch 13/20 => Loss 0.140, Train_accy 88.62:  60%|██████    | 12/20 [08:43<05:26, 40.86s/it]
Task 5, Epoch 13/20 => Loss 0.140, Train_accy 88.62:  65%|██████▌   | 13/20 [08:43<04:31, 38.82s/it]
Task 5, Epoch 14/20 => Loss 0.143, Train_accy 88.54:  65%|██████▌   | 13/20 [09:17<04:31, 38.82s/it]
Task 5, Epoch 14/20 => Loss 0.143, Train_accy 88.54:  70%|███████   | 14/20 [09:17<03:44, 37.39s/it]
Task 5, Epoch 15/20 => Loss 0.153, Train_accy 88.72:  70%|███████   | 14/20 [09:51<03:44, 37.39s/it]
Task 5, Epoch 15/20 => Loss 0.153, Train_accy 88.72:  75%|███████▌  | 15/20 [09:51<03:02, 36.47s/it]
Task 5, Epoch 16/20 => Loss 0.150, Train_accy 88.62, Test_accy 75.29:  75%|███████▌  | 15/20 [10:52<03:02, 36.47s/it]
Task 5, Epoch 16/20 => Loss 0.150, Train_accy 88.62, Test_accy 75.29:  80%|████████  | 16/20 [10:52<02:54, 43.72s/it]
Task 5, Epoch 17/20 => Loss 0.142, Train_accy 90.12:  80%|████████  | 16/20 [11:26<02:54, 43.72s/it]                 
Task 5, Epoch 17/20 => Loss 0.142, Train_accy 90.12:  85%|████████▌ | 17/20 [11:26<02:02, 40.90s/it]
Task 5, Epoch 18/20 => Loss 0.134, Train_accy 90.92:  85%|████████▌ | 17/20 [12:00<02:02, 40.90s/it]
Task 5, Epoch 18/20 => Loss 0.134, Train_accy 90.92:  90%|█████████ | 18/20 [12:00<01:17, 38.98s/it]
Task 5, Epoch 19/20 => Loss 0.140, Train_accy 89.36:  90%|█████████ | 18/20 [12:35<01:17, 38.98s/it]
Task 5, Epoch 19/20 => Loss 0.140, Train_accy 89.36:  95%|█████████▌| 19/20 [12:35<00:37, 37.58s/it]
Task 5, Epoch 20/20 => Loss 0.136, Train_accy 90.32:  95%|█████████▌| 19/20 [13:09<00:37, 37.58s/it]
Task 5, Epoch 20/20 => Loss 0.136, Train_accy 90.32: 100%|██████████| 20/20 [13:09<00:00, 36.63s/it]
Task 5, Epoch 20/20 => Loss 0.136, Train_accy 90.32: 100%|██████████| 20/20 [13:09<00:00, 39.49s/it]
2024-04-20 16:37:42,952 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.136, Train_accy 90.32
2024-04-20 16:38:09,590 [trainer.py] => No NME accuracy.
2024-04-20 16:38:09,590 [trainer.py] => CNN: {'total': 75.68, '00-49': 74.78, '50-59': 58.0, '60-69': 70.1, '70-79': 74.0, '80-89': 85.8, '90-99': 95.0, 'old': 73.53, 'new': 95.0}
2024-04-20 16:38:09,590 [trainer.py] => CNN top1 curve: [93.36, 89.45, 85.97, 77.25, 75.43, 75.68]
2024-04-20 16:38:09,590 [trainer.py] => CNN top5 curve: [99.1, 98.48, 98.01, 96.56, 96.01, 95.85]

Average Accuracy (CNN): 82.86
2024-04-20 16:38:09,590 [trainer.py] => Average Accuracy (CNN): 82.86 

2024-04-20 16:38:09,590 [trainer.py] => Train Time: 10627.52
2024-04-20 16:38:09,590 [trainer.py] => Test Time: 119.50999999999999 

Accuracy Matrix (CNN):
[[93.36 88.82 84.56 77.64 74.84 74.78]
 [ 0.   92.6  83.4  60.4  61.3  58.  ]
 [ 0.    0.   95.6  77.7  70.6  70.1 ]
 [ 0.    0.    0.   91.7  78.6  74.  ]
 [ 0.    0.    0.    0.   94.2  85.8 ]
 [ 0.    0.    0.    0.    0.   95.  ]]
2024-04-20 16:38:09,591 [trainer.py] => Forgetting (CNN): 20.956

nohup: 忽略输入
2024-04-24 21:35:28,303 [trainer.py] => config: ./exps/icarl_cifar_B50_Inc5.json
2024-04-24 21:35:28,304 [trainer.py] => prefix: reproduce
2024-04-24 21:35:28,304 [trainer.py] => dataset: cifar224
2024-04-24 21:35:28,304 [trainer.py] => memory_size: 2000
2024-04-24 21:35:28,304 [trainer.py] => memory_per_class: 20
2024-04-24 21:35:28,304 [trainer.py] => fixed_memory: True
2024-04-24 21:35:28,304 [trainer.py] => shuffle: True
2024-04-24 21:35:28,304 [trainer.py] => init_cls: 50
2024-04-24 21:35:28,304 [trainer.py] => increment: 10
2024-04-24 21:35:28,304 [trainer.py] => model_name: icarl
2024-04-24 21:35:28,304 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-24 21:35:28,304 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-24 21:35:28,304 [trainer.py] => seed: 1993
2024-04-24 21:35:28,304 [trainer.py] => init_epoch: 20
2024-04-24 21:35:28,304 [trainer.py] => init_lr: 0.001
2024-04-24 21:35:28,304 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-24 21:35:28,304 [trainer.py] => init_lr_decay: 0.1
2024-04-24 21:35:28,304 [trainer.py] => init_weight_decay: 0.0005
2024-04-24 21:35:28,304 [trainer.py] => epochs: 20
2024-04-24 21:35:28,304 [trainer.py] => lrate: 0.001
2024-04-24 21:35:28,304 [trainer.py] => milestones: [80, 120]
2024-04-24 21:35:28,304 [trainer.py] => lrate_decay: 0.1
2024-04-24 21:35:28,304 [trainer.py] => batch_size: 48
2024-04-24 21:35:28,304 [trainer.py] => weight_decay: 0.0002
2024-04-24 21:35:28,304 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-04-24 21:35:30,085 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-24 21:35:32,072 [trainer.py] => All params: 85798656
2024-04-24 21:35:32,073 [trainer.py] => Trainable params: 85798656
2024-04-24 21:35:32,073 [icarl.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.442, Train_accy 62.29, Test_accy 90.48:   0%|          | 0/20 [02:53<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.442, Train_accy 62.29, Test_accy 90.48:   5%|▌         | 1/20 [02:53<55:02, 173.82s/it]
Task 0, Epoch 2/20 => Loss 0.759, Train_accy 78.83:   5%|▌         | 1/20 [05:36<55:02, 173.82s/it]                 
Task 0, Epoch 2/20 => Loss 0.759, Train_accy 78.83:  10%|█         | 2/20 [05:36<50:08, 167.15s/it]
Task 0, Epoch 3/20 => Loss 0.666, Train_accy 81.10:  10%|█         | 2/20 [08:19<50:08, 167.15s/it]
Task 0, Epoch 3/20 => Loss 0.666, Train_accy 81.10:  15%|█▌        | 3/20 [08:19<46:47, 165.12s/it]
Task 0, Epoch 4/20 => Loss 0.609, Train_accy 82.96:  15%|█▌        | 3/20 [11:01<46:47, 165.12s/it]
Task 0, Epoch 4/20 => Loss 0.609, Train_accy 82.96:  20%|██        | 4/20 [11:01<43:43, 163.96s/it]
Task 0, Epoch 5/20 => Loss 0.563, Train_accy 84.06:  20%|██        | 4/20 [13:43<43:43, 163.96s/it]
Task 0, Epoch 5/20 => Loss 0.563, Train_accy 84.06:  25%|██▌       | 5/20 [13:43<40:49, 163.33s/it]
Task 0, Epoch 6/20 => Loss 0.533, Train_accy 84.62, Test_accy 92.92:  25%|██▌       | 5/20 [16:38<40:49, 163.33s/it]
Task 0, Epoch 6/20 => Loss 0.533, Train_accy 84.62, Test_accy 92.92:  30%|███       | 6/20 [16:38<39:01, 167.24s/it]
Task 0, Epoch 7/20 => Loss 0.492, Train_accy 85.86:  30%|███       | 6/20 [19:19<39:01, 167.24s/it]                 
Task 0, Epoch 7/20 => Loss 0.492, Train_accy 85.86:  35%|███▌      | 7/20 [19:19<35:50, 165.43s/it]
Task 0, Epoch 8/20 => Loss 0.488, Train_accy 86.08:  35%|███▌      | 7/20 [22:01<35:50, 165.43s/it]
Task 0, Epoch 8/20 => Loss 0.488, Train_accy 86.08:  40%|████      | 8/20 [22:01<32:51, 164.26s/it]
Task 0, Epoch 9/20 => Loss 0.462, Train_accy 86.86:  40%|████      | 8/20 [24:43<32:51, 164.26s/it]
Task 0, Epoch 9/20 => Loss 0.462, Train_accy 86.86:  45%|████▌     | 9/20 [24:43<29:58, 163.52s/it]
Task 0, Epoch 10/20 => Loss 0.452, Train_accy 87.42:  45%|████▌     | 9/20 [27:25<29:58, 163.52s/it]
Task 0, Epoch 10/20 => Loss 0.452, Train_accy 87.42:  50%|█████     | 10/20 [27:25<27:10, 163.08s/it]
Task 0, Epoch 11/20 => Loss 0.439, Train_accy 87.26, Test_accy 92.82:  50%|█████     | 10/20 [30:21<27:10, 163.08s/it]
Task 0, Epoch 11/20 => Loss 0.439, Train_accy 87.26, Test_accy 92.82:  55%|█████▌    | 11/20 [30:21<25:02, 166.94s/it]
Task 0, Epoch 12/20 => Loss 0.427, Train_accy 87.83:  55%|█████▌    | 11/20 [33:04<25:02, 166.94s/it]                 
Task 0, Epoch 12/20 => Loss 0.427, Train_accy 87.83:  60%|██████    | 12/20 [33:04<22:05, 165.64s/it]
Task 0, Epoch 13/20 => Loss 0.412, Train_accy 88.17:  60%|██████    | 12/20 [35:47<22:05, 165.64s/it]
Task 0, Epoch 13/20 => Loss 0.412, Train_accy 88.17:  65%|██████▌   | 13/20 [35:47<19:15, 165.00s/it]
Task 0, Epoch 14/20 => Loss 0.413, Train_accy 88.27:  65%|██████▌   | 13/20 [38:30<19:15, 165.00s/it]
Task 0, Epoch 14/20 => Loss 0.413, Train_accy 88.27:  70%|███████   | 14/20 [38:30<16:26, 164.48s/it]
Task 0, Epoch 15/20 => Loss 0.400, Train_accy 88.62:  70%|███████   | 14/20 [41:14<16:26, 164.48s/it]
Task 0, Epoch 15/20 => Loss 0.400, Train_accy 88.62:  75%|███████▌  | 15/20 [41:14<13:40, 164.13s/it]
Task 0, Epoch 16/20 => Loss 0.386, Train_accy 89.04, Test_accy 93.54:  75%|███████▌  | 15/20 [44:10<13:40, 164.13s/it]
Task 0, Epoch 16/20 => Loss 0.386, Train_accy 89.04, Test_accy 93.54:  80%|████████  | 16/20 [44:10<11:11, 167.76s/it]
Task 0, Epoch 17/20 => Loss 0.382, Train_accy 89.20:  80%|████████  | 16/20 [46:53<11:11, 167.76s/it]                 
Task 0, Epoch 17/20 => Loss 0.382, Train_accy 89.20:  85%|████████▌ | 17/20 [46:53<08:19, 166.37s/it]
Task 0, Epoch 18/20 => Loss 0.372, Train_accy 89.26:  85%|████████▌ | 17/20 [49:36<08:19, 166.37s/it]
Task 0, Epoch 18/20 => Loss 0.372, Train_accy 89.26:  90%|█████████ | 18/20 [49:36<05:30, 165.26s/it]
Task 0, Epoch 19/20 => Loss 0.374, Train_accy 89.30:  90%|█████████ | 18/20 [52:18<05:30, 165.26s/it]
Task 0, Epoch 19/20 => Loss 0.374, Train_accy 89.30:  95%|█████████▌| 19/20 [52:18<02:44, 164.40s/it]
Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.85:  95%|█████████▌| 19/20 [55:00<02:44, 164.40s/it]
Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.85: 100%|██████████| 20/20 [55:00<00:00, 163.77s/it]
Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.85: 100%|██████████| 20/20 [55:00<00:00, 165.04s/it]
2024-04-24 22:30:33,423 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.85
2024-04-24 22:30:33,424 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 22:32:29,954 [icarl.py] => Exemplar size: 1000
2024-04-24 22:32:29,954 [trainer.py] => CNN: {'total': 93.36, '00-49': 93.36, 'old': 0, 'new': 93.36}
2024-04-24 22:32:29,954 [trainer.py] => NME: {'total': 93.78, '00-49': 93.78, 'old': 0, 'new': 93.78}
2024-04-24 22:32:29,954 [trainer.py] => CNN top1 curve: [93.36]
2024-04-24 22:32:29,954 [trainer.py] => CNN top5 curve: [99.1]
2024-04-24 22:32:29,954 [trainer.py] => NME top1 curve: [93.78]
2024-04-24 22:32:29,955 [trainer.py] => NME top5 curve: [99.36]

Average Accuracy (CNN): 93.36
Average Accuracy (NME): 93.78
2024-04-24 22:32:29,955 [trainer.py] => Average Accuracy (CNN): 93.36
2024-04-24 22:32:29,955 [trainer.py] => Average Accuracy (NME): 93.78
2024-04-24 22:32:29,955 [trainer.py] => Train Time: 0
2024-04-24 22:32:29,955 [trainer.py] => Test Time: 25.5 

2024-04-24 22:32:29,955 [trainer.py] => All params: 85837106
2024-04-24 22:32:29,956 [trainer.py] => Trainable params: 85837106
2024-04-24 22:32:29,957 [icarl.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.218, Train_accy 77.05, Test_accy 85.60:   0%|          | 0/20 [01:08<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.218, Train_accy 77.05, Test_accy 85.60:   5%|▌         | 1/20 [01:08<21:33, 68.09s/it]
Task 1, Epoch 2/20 => Loss 2.502, Train_accy 88.85:   5%|▌         | 1/20 [02:00<21:33, 68.09s/it]                 
Task 1, Epoch 2/20 => Loss 2.502, Train_accy 88.85:  10%|█         | 2/20 [02:00<17:44, 59.14s/it]
Task 1, Epoch 3/20 => Loss 2.482, Train_accy 90.12:  10%|█         | 2/20 [02:53<17:44, 59.14s/it]
Task 1, Epoch 3/20 => Loss 2.482, Train_accy 90.12:  15%|█▌        | 3/20 [02:53<15:55, 56.22s/it]
Task 1, Epoch 4/20 => Loss 2.424, Train_accy 90.97:  15%|█▌        | 3/20 [03:46<15:55, 56.22s/it]
Task 1, Epoch 4/20 => Loss 2.424, Train_accy 90.97:  20%|██        | 4/20 [03:46<14:36, 54.78s/it]
Task 1, Epoch 5/20 => Loss 2.433, Train_accy 91.75:  20%|██        | 4/20 [04:39<14:36, 54.78s/it]
Task 1, Epoch 5/20 => Loss 2.433, Train_accy 91.75:  25%|██▌       | 5/20 [04:39<13:30, 54.04s/it]
Task 1, Epoch 6/20 => Loss 2.401, Train_accy 92.42, Test_accy 86.78:  25%|██▌       | 5/20 [05:47<13:30, 54.04s/it]
Task 1, Epoch 6/20 => Loss 2.401, Train_accy 92.42, Test_accy 86.78:  30%|███       | 6/20 [05:47<13:43, 58.81s/it]
Task 1, Epoch 7/20 => Loss 2.408, Train_accy 92.42:  30%|███       | 6/20 [06:39<13:43, 58.81s/it]                 
Task 1, Epoch 7/20 => Loss 2.408, Train_accy 92.42:  35%|███▌      | 7/20 [06:39<12:19, 56.85s/it]
Task 1, Epoch 8/20 => Loss 2.380, Train_accy 91.93:  35%|███▌      | 7/20 [07:32<12:19, 56.85s/it]
Task 1, Epoch 8/20 => Loss 2.380, Train_accy 91.93:  40%|████      | 8/20 [07:32<11:06, 55.50s/it]
Task 1, Epoch 9/20 => Loss 2.354, Train_accy 92.67:  40%|████      | 8/20 [08:25<11:06, 55.50s/it]
Task 1, Epoch 9/20 => Loss 2.354, Train_accy 92.67:  45%|████▌     | 9/20 [08:25<10:00, 54.63s/it]
Task 1, Epoch 10/20 => Loss 2.370, Train_accy 92.83:  45%|████▌     | 9/20 [09:17<10:00, 54.63s/it]
Task 1, Epoch 10/20 => Loss 2.370, Train_accy 92.83:  50%|█████     | 10/20 [09:17<08:59, 54.00s/it]
Task 1, Epoch 11/20 => Loss 2.349, Train_accy 93.23, Test_accy 88.07:  50%|█████     | 10/20 [10:25<08:59, 54.00s/it]
Task 1, Epoch 11/20 => Loss 2.349, Train_accy 93.23, Test_accy 88.07:  55%|█████▌    | 11/20 [10:25<08:44, 58.25s/it]
Task 1, Epoch 12/20 => Loss 2.344, Train_accy 93.28:  55%|█████▌    | 11/20 [11:18<08:44, 58.25s/it]                 
Task 1, Epoch 12/20 => Loss 2.344, Train_accy 93.28:  60%|██████    | 12/20 [11:18<07:33, 56.63s/it]
Task 1, Epoch 13/20 => Loss 2.344, Train_accy 93.43:  60%|██████    | 12/20 [12:11<07:33, 56.63s/it]
Task 1, Epoch 13/20 => Loss 2.344, Train_accy 93.43:  65%|██████▌   | 13/20 [12:11<06:27, 55.41s/it]
Task 1, Epoch 14/20 => Loss 2.340, Train_accy 93.60:  65%|██████▌   | 13/20 [13:03<06:27, 55.41s/it]
Task 1, Epoch 14/20 => Loss 2.340, Train_accy 93.60:  70%|███████   | 14/20 [13:03<05:27, 54.57s/it]
Task 1, Epoch 15/20 => Loss 2.353, Train_accy 93.23:  70%|███████   | 14/20 [13:56<05:27, 54.57s/it]
Task 1, Epoch 15/20 => Loss 2.353, Train_accy 93.23:  75%|███████▌  | 15/20 [13:56<04:30, 54.00s/it]
Task 1, Epoch 16/20 => Loss 2.313, Train_accy 93.85, Test_accy 86.80:  75%|███████▌  | 15/20 [15:04<04:30, 54.00s/it]
Task 1, Epoch 16/20 => Loss 2.313, Train_accy 93.85, Test_accy 86.80:  80%|████████  | 16/20 [15:04<03:52, 58.23s/it]
Task 1, Epoch 17/20 => Loss 2.359, Train_accy 93.27:  80%|████████  | 16/20 [15:57<03:52, 58.23s/it]                 
Task 1, Epoch 17/20 => Loss 2.359, Train_accy 93.27:  85%|████████▌ | 17/20 [15:57<02:49, 56.57s/it]
Task 1, Epoch 18/20 => Loss 2.320, Train_accy 94.27:  85%|████████▌ | 17/20 [16:50<02:49, 56.57s/it]
Task 1, Epoch 18/20 => Loss 2.320, Train_accy 94.27:  90%|█████████ | 18/20 [16:50<01:50, 55.41s/it]
Task 1, Epoch 19/20 => Loss 2.318, Train_accy 94.07:  90%|█████████ | 18/20 [17:42<01:50, 55.41s/it]
Task 1, Epoch 19/20 => Loss 2.318, Train_accy 94.07:  95%|█████████▌| 19/20 [17:42<00:54, 54.60s/it]
Task 1, Epoch 20/20 => Loss 2.329, Train_accy 93.80:  95%|█████████▌| 19/20 [18:35<00:54, 54.60s/it]
Task 1, Epoch 20/20 => Loss 2.329, Train_accy 93.80: 100%|██████████| 20/20 [18:35<00:00, 54.01s/it]
Task 1, Epoch 20/20 => Loss 2.329, Train_accy 93.80: 100%|██████████| 20/20 [18:35<00:00, 55.77s/it]
2024-04-24 22:51:05,380 [icarl.py] => Task 1, Epoch 20/20 => Loss 2.329, Train_accy 93.80
2024-04-24 22:51:05,382 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 22:52:05,385 [icarl.py] => Exemplar size: 1200
2024-04-24 22:52:05,385 [trainer.py] => CNN: {'total': 86.18, '00-49': 83.94, '50-59': 97.4, 'old': 83.94, 'new': 97.4}
2024-04-24 22:52:05,385 [trainer.py] => NME: {'total': 92.1, '00-49': 91.88, '50-59': 93.2, 'old': 91.88, 'new': 93.2}
2024-04-24 22:52:05,385 [trainer.py] => CNN top1 curve: [93.36, 86.18]
2024-04-24 22:52:05,385 [trainer.py] => CNN top5 curve: [99.1, 98.0]
2024-04-24 22:52:05,385 [trainer.py] => NME top1 curve: [93.78, 92.1]
2024-04-24 22:52:05,385 [trainer.py] => NME top5 curve: [99.36, 99.15]

Average Accuracy (CNN): 89.77
Average Accuracy (NME): 92.94
2024-04-24 22:52:05,385 [trainer.py] => Average Accuracy (CNN): 89.77
2024-04-24 22:52:05,385 [trainer.py] => Average Accuracy (NME): 92.94
2024-04-24 22:52:05,385 [trainer.py] => Train Time: 0
2024-04-24 22:52:05,385 [trainer.py] => Test Time: 55.72 

2024-04-24 22:52:05,386 [trainer.py] => All params: 85844796
2024-04-24 22:52:05,386 [trainer.py] => Trainable params: 85844796
2024-04-24 22:52:05,387 [icarl.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.968, Train_accy 80.29, Test_accy 83.87:   0%|          | 0/20 [01:11<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.968, Train_accy 80.29, Test_accy 83.87:   5%|▌         | 1/20 [01:11<22:45, 71.85s/it]
Task 2, Epoch 2/20 => Loss 2.166, Train_accy 90.48:   5%|▌         | 1/20 [02:06<22:45, 71.85s/it]                 
Task 2, Epoch 2/20 => Loss 2.166, Train_accy 90.48:  10%|█         | 2/20 [02:06<18:30, 61.67s/it]
Task 2, Epoch 3/20 => Loss 2.113, Train_accy 92.06:  10%|█         | 2/20 [03:01<18:30, 61.67s/it]
Task 2, Epoch 3/20 => Loss 2.113, Train_accy 92.06:  15%|█▌        | 3/20 [03:01<16:33, 58.47s/it]
Task 2, Epoch 4/20 => Loss 2.064, Train_accy 93.06:  15%|█▌        | 3/20 [03:55<16:33, 58.47s/it]
Task 2, Epoch 4/20 => Loss 2.064, Train_accy 93.06:  20%|██        | 4/20 [03:55<15:10, 56.89s/it]
Task 2, Epoch 5/20 => Loss 2.050, Train_accy 93.24:  20%|██        | 4/20 [04:50<15:10, 56.89s/it]
Task 2, Epoch 5/20 => Loss 2.050, Train_accy 93.24:  25%|██▌       | 5/20 [04:50<14:01, 56.08s/it]
Task 2, Epoch 6/20 => Loss 2.026, Train_accy 93.37, Test_accy 84.66:  25%|██▌       | 5/20 [06:02<14:01, 56.08s/it]
Task 2, Epoch 6/20 => Loss 2.026, Train_accy 93.37, Test_accy 84.66:  30%|███       | 6/20 [06:02<14:21, 61.56s/it]
Task 2, Epoch 7/20 => Loss 2.043, Train_accy 93.71:  30%|███       | 6/20 [06:56<14:21, 61.56s/it]                 
Task 2, Epoch 7/20 => Loss 2.043, Train_accy 93.71:  35%|███▌      | 7/20 [06:56<12:50, 59.24s/it]
Task 2, Epoch 8/20 => Loss 2.060, Train_accy 93.84:  35%|███▌      | 7/20 [07:51<12:50, 59.24s/it]
Task 2, Epoch 8/20 => Loss 2.060, Train_accy 93.84:  40%|████      | 8/20 [07:51<11:32, 57.73s/it]
Task 2, Epoch 9/20 => Loss 1.995, Train_accy 94.32:  40%|████      | 8/20 [08:45<11:32, 57.73s/it]
Task 2, Epoch 9/20 => Loss 1.995, Train_accy 94.32:  45%|████▌     | 9/20 [08:45<10:23, 56.68s/it]
Task 2, Epoch 10/20 => Loss 2.038, Train_accy 93.84:  45%|████▌     | 9/20 [09:39<10:23, 56.68s/it]
Task 2, Epoch 10/20 => Loss 2.038, Train_accy 93.84:  50%|█████     | 10/20 [09:39<09:19, 55.94s/it]
Task 2, Epoch 11/20 => Loss 2.017, Train_accy 94.98, Test_accy 83.34:  50%|█████     | 10/20 [10:52<09:19, 55.94s/it]
Task 2, Epoch 11/20 => Loss 2.017, Train_accy 94.98, Test_accy 83.34:  55%|█████▌    | 11/20 [10:52<09:07, 60.88s/it]
Task 2, Epoch 12/20 => Loss 2.018, Train_accy 94.24:  55%|█████▌    | 11/20 [11:46<09:07, 60.88s/it]                 
Task 2, Epoch 12/20 => Loss 2.018, Train_accy 94.24:  60%|██████    | 12/20 [11:46<07:51, 58.90s/it]
Task 2, Epoch 13/20 => Loss 2.037, Train_accy 93.77:  60%|██████    | 12/20 [12:40<07:51, 58.90s/it]
Task 2, Epoch 13/20 => Loss 2.037, Train_accy 93.77:  65%|██████▌   | 13/20 [12:40<06:42, 57.50s/it]
Task 2, Epoch 14/20 => Loss 1.979, Train_accy 94.58:  65%|██████▌   | 13/20 [13:34<06:42, 57.50s/it]
Task 2, Epoch 14/20 => Loss 1.979, Train_accy 94.58:  70%|███████   | 14/20 [13:34<05:39, 56.53s/it]
Task 2, Epoch 15/20 => Loss 2.000, Train_accy 94.71:  70%|███████   | 14/20 [14:29<05:39, 56.53s/it]
Task 2, Epoch 15/20 => Loss 2.000, Train_accy 94.71:  75%|███████▌  | 15/20 [14:29<04:39, 55.86s/it]
Task 2, Epoch 16/20 => Loss 1.993, Train_accy 94.47, Test_accy 82.66:  75%|███████▌  | 15/20 [15:41<04:39, 55.86s/it]
Task 2, Epoch 16/20 => Loss 1.993, Train_accy 94.47, Test_accy 82.66:  80%|████████  | 16/20 [15:41<04:02, 60.65s/it]
Task 2, Epoch 17/20 => Loss 1.978, Train_accy 95.03:  80%|████████  | 16/20 [16:35<04:02, 60.65s/it]                 
Task 2, Epoch 17/20 => Loss 1.978, Train_accy 95.03:  85%|████████▌ | 17/20 [16:35<02:56, 58.76s/it]
Task 2, Epoch 18/20 => Loss 1.994, Train_accy 94.81:  85%|████████▌ | 17/20 [17:29<02:56, 58.76s/it]
Task 2, Epoch 18/20 => Loss 1.994, Train_accy 94.81:  90%|█████████ | 18/20 [17:29<01:54, 57.41s/it]
Task 2, Epoch 19/20 => Loss 1.977, Train_accy 95.03:  90%|█████████ | 18/20 [18:24<01:54, 57.41s/it]
Task 2, Epoch 19/20 => Loss 1.977, Train_accy 95.03:  95%|█████████▌| 19/20 [18:24<00:56, 56.49s/it]
Task 2, Epoch 20/20 => Loss 1.974, Train_accy 94.85:  95%|█████████▌| 19/20 [19:18<00:56, 56.49s/it]
Task 2, Epoch 20/20 => Loss 1.974, Train_accy 94.85: 100%|██████████| 20/20 [19:18<00:00, 55.84s/it]
Task 2, Epoch 20/20 => Loss 1.974, Train_accy 94.85: 100%|██████████| 20/20 [19:18<00:00, 57.92s/it]
2024-04-24 23:11:23,837 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.974, Train_accy 94.85
2024-04-24 23:11:23,839 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 23:12:30,737 [icarl.py] => Exemplar size: 1400
2024-04-24 23:12:30,737 [trainer.py] => CNN: {'total': 84.11, '00-49': 81.52, '50-59': 82.7, '60-69': 98.5, 'old': 81.72, 'new': 98.5}
2024-04-24 23:12:30,738 [trainer.py] => NME: {'total': 90.81, '00-49': 90.78, '50-59': 87.1, '60-69': 94.7, 'old': 90.17, 'new': 94.7}
2024-04-24 23:12:30,738 [trainer.py] => CNN top1 curve: [93.36, 86.18, 84.11]
2024-04-24 23:12:30,738 [trainer.py] => CNN top5 curve: [99.1, 98.0, 96.81]
2024-04-24 23:12:30,738 [trainer.py] => NME top1 curve: [93.78, 92.1, 90.81]
2024-04-24 23:12:30,738 [trainer.py] => NME top5 curve: [99.36, 99.15, 98.93]

Average Accuracy (CNN): 87.88
Average Accuracy (NME): 92.23
2024-04-24 23:12:30,738 [trainer.py] => Average Accuracy (CNN): 87.88
2024-04-24 23:12:30,738 [trainer.py] => Average Accuracy (NME): 92.23
2024-04-24 23:12:30,738 [trainer.py] => Train Time: 0
2024-04-24 23:12:30,738 [trainer.py] => Test Time: 91.3 

2024-04-24 23:12:30,738 [trainer.py] => All params: 85852486
2024-04-24 23:12:30,739 [trainer.py] => Trainable params: 85852486
2024-04-24 23:12:30,740 [icarl.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.947, Train_accy 76.67, Test_accy 76.18:   0%|          | 0/20 [01:16<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.947, Train_accy 76.67, Test_accy 76.18:   5%|▌         | 1/20 [01:16<24:04, 76.04s/it]
Task 3, Epoch 2/20 => Loss 2.061, Train_accy 87.47:   5%|▌         | 1/20 [02:12<24:04, 76.04s/it]                 
Task 3, Epoch 2/20 => Loss 2.061, Train_accy 87.47:  10%|█         | 2/20 [02:12<19:17, 64.29s/it]
Task 3, Epoch 3/20 => Loss 1.998, Train_accy 89.45:  10%|█         | 2/20 [03:08<19:17, 64.29s/it]
Task 3, Epoch 3/20 => Loss 1.998, Train_accy 89.45:  15%|█▌        | 3/20 [03:08<17:09, 60.54s/it]
Task 3, Epoch 4/20 => Loss 1.957, Train_accy 90.52:  15%|█▌        | 3/20 [04:04<17:09, 60.54s/it]
Task 3, Epoch 4/20 => Loss 1.957, Train_accy 90.52:  20%|██        | 4/20 [04:04<15:40, 58.78s/it]
Task 3, Epoch 5/20 => Loss 1.924, Train_accy 91.94:  20%|██        | 4/20 [05:00<15:40, 58.78s/it]
Task 3, Epoch 5/20 => Loss 1.924, Train_accy 91.94:  25%|██▌       | 5/20 [05:00<14:26, 57.80s/it]
Task 3, Epoch 6/20 => Loss 1.896, Train_accy 91.91, Test_accy 78.41:  25%|██▌       | 5/20 [06:16<14:26, 57.80s/it]
Task 3, Epoch 6/20 => Loss 1.896, Train_accy 91.91, Test_accy 78.41:  30%|███       | 6/20 [06:16<14:55, 64.00s/it]
Task 3, Epoch 7/20 => Loss 1.921, Train_accy 92.00:  30%|███       | 6/20 [07:12<14:55, 64.00s/it]                 
Task 3, Epoch 7/20 => Loss 1.921, Train_accy 92.00:  35%|███▌      | 7/20 [07:12<13:17, 61.36s/it]
Task 3, Epoch 8/20 => Loss 1.872, Train_accy 92.72:  35%|███▌      | 7/20 [08:08<13:17, 61.36s/it]
Task 3, Epoch 8/20 => Loss 1.872, Train_accy 92.72:  40%|████      | 8/20 [08:08<11:55, 59.65s/it]
Task 3, Epoch 9/20 => Loss 1.875, Train_accy 92.94:  40%|████      | 8/20 [09:04<11:55, 59.65s/it]
Task 3, Epoch 9/20 => Loss 1.875, Train_accy 92.94:  45%|████▌     | 9/20 [09:04<10:43, 58.51s/it]
Task 3, Epoch 10/20 => Loss 1.860, Train_accy 92.84:  45%|████▌     | 9/20 [10:00<10:43, 58.51s/it]
Task 3, Epoch 10/20 => Loss 1.860, Train_accy 92.84:  50%|█████     | 10/20 [10:00<09:37, 57.71s/it]
Task 3, Epoch 11/20 => Loss 1.851, Train_accy 93.19, Test_accy 78.28:  50%|█████     | 10/20 [11:16<09:37, 57.71s/it]
Task 3, Epoch 11/20 => Loss 1.851, Train_accy 93.19, Test_accy 78.28:  55%|█████▌    | 11/20 [11:16<09:29, 63.30s/it]
Task 3, Epoch 12/20 => Loss 1.836, Train_accy 93.62:  55%|█████▌    | 11/20 [12:12<09:29, 63.30s/it]                 
Task 3, Epoch 12/20 => Loss 1.836, Train_accy 93.62:  60%|██████    | 12/20 [12:12<08:08, 61.06s/it]
Task 3, Epoch 13/20 => Loss 1.825, Train_accy 93.78:  60%|██████    | 12/20 [13:08<08:08, 61.06s/it]
Task 3, Epoch 13/20 => Loss 1.825, Train_accy 93.78:  65%|██████▌   | 13/20 [13:08<06:56, 59.51s/it]
Task 3, Epoch 14/20 => Loss 1.853, Train_accy 93.62:  65%|██████▌   | 13/20 [14:04<06:56, 59.51s/it]
Task 3, Epoch 14/20 => Loss 1.853, Train_accy 93.62:  70%|███████   | 14/20 [14:04<05:50, 58.44s/it]
Task 3, Epoch 15/20 => Loss 1.859, Train_accy 93.72:  70%|███████   | 14/20 [14:59<05:50, 58.44s/it]
Task 3, Epoch 15/20 => Loss 1.859, Train_accy 93.72:  75%|███████▌  | 15/20 [14:59<04:48, 57.70s/it]
Task 3, Epoch 16/20 => Loss 1.807, Train_accy 94.38, Test_accy 77.62:  75%|███████▌  | 15/20 [16:15<04:48, 57.70s/it]
Task 3, Epoch 16/20 => Loss 1.807, Train_accy 94.38, Test_accy 77.62:  80%|████████  | 16/20 [16:15<04:12, 63.09s/it]
Task 3, Epoch 17/20 => Loss 1.851, Train_accy 94.14:  80%|████████  | 16/20 [17:11<04:12, 63.09s/it]                 
Task 3, Epoch 17/20 => Loss 1.851, Train_accy 94.14:  85%|████████▌ | 17/20 [17:11<03:02, 60.98s/it]
Task 3, Epoch 18/20 => Loss 1.804, Train_accy 94.16:  85%|████████▌ | 17/20 [18:07<03:02, 60.98s/it]
Task 3, Epoch 18/20 => Loss 1.804, Train_accy 94.16:  90%|█████████ | 18/20 [18:07<01:58, 59.46s/it]
Task 3, Epoch 19/20 => Loss 1.825, Train_accy 94.27:  90%|█████████ | 18/20 [19:03<01:58, 59.46s/it]
Task 3, Epoch 19/20 => Loss 1.825, Train_accy 94.27:  95%|█████████▌| 19/20 [19:03<00:58, 58.46s/it]
Task 3, Epoch 20/20 => Loss 1.808, Train_accy 94.33:  95%|█████████▌| 19/20 [19:59<00:58, 58.46s/it]
Task 3, Epoch 20/20 => Loss 1.808, Train_accy 94.33: 100%|██████████| 20/20 [19:59<00:00, 57.74s/it]
Task 3, Epoch 20/20 => Loss 1.808, Train_accy 94.33: 100%|██████████| 20/20 [19:59<00:00, 59.99s/it]
2024-04-24 23:32:30,611 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.808, Train_accy 94.33
2024-04-24 23:32:30,613 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 23:33:43,961 [icarl.py] => Exemplar size: 1600
2024-04-24 23:33:43,961 [trainer.py] => CNN: {'total': 77.22, '00-49': 74.58, '50-59': 63.6, '60-69': 85.4, '70-79': 95.9, 'old': 74.56, 'new': 95.9}
2024-04-24 23:33:43,961 [trainer.py] => NME: {'total': 87.48, '00-49': 88.36, '50-59': 78.7, '60-69': 88.5, '70-79': 90.8, 'old': 87.0, 'new': 90.8}
2024-04-24 23:33:43,961 [trainer.py] => CNN top1 curve: [93.36, 86.18, 84.11, 77.22]
2024-04-24 23:33:43,961 [trainer.py] => CNN top5 curve: [99.1, 98.0, 96.81, 95.09]
2024-04-24 23:33:43,961 [trainer.py] => NME top1 curve: [93.78, 92.1, 90.81, 87.48]
2024-04-24 23:33:43,961 [trainer.py] => NME top5 curve: [99.36, 99.15, 98.93, 98.44]

Average Accuracy (CNN): 85.22
Average Accuracy (NME): 91.04
2024-04-24 23:33:43,961 [trainer.py] => Average Accuracy (CNN): 85.22
2024-04-24 23:33:43,961 [trainer.py] => Average Accuracy (NME): 91.04
2024-04-24 23:33:43,961 [trainer.py] => Train Time: 0
2024-04-24 23:33:43,961 [trainer.py] => Test Time: 131.51999999999998 

2024-04-24 23:33:43,962 [trainer.py] => All params: 85860176
2024-04-24 23:33:43,962 [trainer.py] => Trainable params: 85860176
2024-04-24 23:33:43,964 [icarl.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.206, Train_accy 78.32, Test_accy 73.84:   0%|          | 0/20 [01:20<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.206, Train_accy 78.32, Test_accy 73.84:   5%|▌         | 1/20 [01:20<25:21, 80.08s/it]
Task 4, Epoch 2/20 => Loss 2.409, Train_accy 89.12:   5%|▌         | 1/20 [02:17<25:21, 80.08s/it]                 
Task 4, Epoch 2/20 => Loss 2.409, Train_accy 89.12:  10%|█         | 2/20 [02:17<20:04, 66.93s/it]
Task 4, Epoch 3/20 => Loss 2.291, Train_accy 91.29:  10%|█         | 2/20 [03:15<20:04, 66.93s/it]
Task 4, Epoch 3/20 => Loss 2.291, Train_accy 91.29:  15%|█▌        | 3/20 [03:15<17:48, 62.83s/it]
Task 4, Epoch 4/20 => Loss 2.323, Train_accy 91.74:  15%|█▌        | 3/20 [04:13<17:48, 62.83s/it]
Task 4, Epoch 4/20 => Loss 2.323, Train_accy 91.74:  20%|██        | 4/20 [04:13<16:14, 60.89s/it]
Task 4, Epoch 5/20 => Loss 2.278, Train_accy 92.41:  20%|██        | 4/20 [05:11<16:14, 60.89s/it]
Task 4, Epoch 5/20 => Loss 2.278, Train_accy 92.41:  25%|██▌       | 5/20 [05:11<14:58, 59.90s/it]
Task 4, Epoch 6/20 => Loss 2.267, Train_accy 92.65, Test_accy 74.62:  25%|██▌       | 5/20 [06:32<14:58, 59.90s/it]
Task 4, Epoch 6/20 => Loss 2.267, Train_accy 92.65, Test_accy 74.62:  30%|███       | 6/20 [06:32<15:38, 67.05s/it]
Task 4, Epoch 7/20 => Loss 2.248, Train_accy 93.15:  30%|███       | 6/20 [07:30<15:38, 67.05s/it]                 
Task 4, Epoch 7/20 => Loss 2.248, Train_accy 93.15:  35%|███▌      | 7/20 [07:30<13:53, 64.11s/it]
Task 4, Epoch 8/20 => Loss 2.225, Train_accy 93.36:  35%|███▌      | 7/20 [08:28<13:53, 64.11s/it]
Task 4, Epoch 8/20 => Loss 2.225, Train_accy 93.36:  40%|████      | 8/20 [08:28<12:26, 62.18s/it]
Task 4, Epoch 9/20 => Loss 2.251, Train_accy 93.80:  40%|████      | 8/20 [09:26<12:26, 62.18s/it]
Task 4, Epoch 9/20 => Loss 2.251, Train_accy 93.80:  45%|████▌     | 9/20 [09:26<11:09, 60.86s/it]
Task 4, Epoch 10/20 => Loss 2.234, Train_accy 93.42:  45%|████▌     | 9/20 [10:24<11:09, 60.86s/it]
Task 4, Epoch 10/20 => Loss 2.234, Train_accy 93.42:  50%|█████     | 10/20 [10:24<09:59, 60.00s/it]
Task 4, Epoch 11/20 => Loss 2.224, Train_accy 93.77, Test_accy 74.70:  50%|█████     | 10/20 [11:45<09:59, 60.00s/it]
Task 4, Epoch 11/20 => Loss 2.224, Train_accy 93.77, Test_accy 74.70:  55%|█████▌    | 11/20 [11:45<09:57, 66.37s/it]
Task 4, Epoch 12/20 => Loss 2.238, Train_accy 93.36:  55%|█████▌    | 11/20 [12:43<09:57, 66.37s/it]                 
Task 4, Epoch 12/20 => Loss 2.238, Train_accy 93.36:  60%|██████    | 12/20 [12:43<08:30, 63.83s/it]
Task 4, Epoch 13/20 => Loss 2.241, Train_accy 93.94:  60%|██████    | 12/20 [13:41<08:30, 63.83s/it]
Task 4, Epoch 13/20 => Loss 2.241, Train_accy 93.94:  65%|██████▌   | 13/20 [13:41<07:14, 62.12s/it]
Task 4, Epoch 14/20 => Loss 2.202, Train_accy 94.53:  65%|██████▌   | 13/20 [14:39<07:14, 62.12s/it]
Task 4, Epoch 14/20 => Loss 2.202, Train_accy 94.53:  70%|███████   | 14/20 [14:39<06:05, 60.87s/it]
Task 4, Epoch 15/20 => Loss 2.231, Train_accy 94.11:  70%|███████   | 14/20 [15:37<06:05, 60.87s/it]
Task 4, Epoch 15/20 => Loss 2.231, Train_accy 94.11:  75%|███████▌  | 15/20 [15:37<04:59, 59.99s/it]
Task 4, Epoch 16/20 => Loss 2.221, Train_accy 94.03, Test_accy 75.13:  75%|███████▌  | 15/20 [16:58<04:59, 59.99s/it]
Task 4, Epoch 16/20 => Loss 2.221, Train_accy 94.03, Test_accy 75.13:  80%|████████  | 16/20 [16:58<04:24, 66.23s/it]
Task 4, Epoch 17/20 => Loss 2.210, Train_accy 94.41:  80%|████████  | 16/20 [17:56<04:24, 66.23s/it]                 
Task 4, Epoch 17/20 => Loss 2.210, Train_accy 94.41:  85%|████████▌ | 17/20 [17:56<03:11, 63.81s/it]
Task 4, Epoch 18/20 => Loss 2.201, Train_accy 94.29:  85%|████████▌ | 17/20 [18:55<03:11, 63.81s/it]
Task 4, Epoch 18/20 => Loss 2.201, Train_accy 94.29:  90%|█████████ | 18/20 [18:55<02:04, 62.14s/it]
Task 4, Epoch 19/20 => Loss 2.190, Train_accy 94.44:  90%|█████████ | 18/20 [19:53<02:04, 62.14s/it]
Task 4, Epoch 19/20 => Loss 2.190, Train_accy 94.44:  95%|█████████▌| 19/20 [19:53<01:00, 60.91s/it]
Task 4, Epoch 20/20 => Loss 2.207, Train_accy 94.41:  95%|█████████▌| 19/20 [20:50<01:00, 60.91s/it]
Task 4, Epoch 20/20 => Loss 2.207, Train_accy 94.41: 100%|██████████| 20/20 [20:50<00:00, 60.02s/it]
Task 4, Epoch 20/20 => Loss 2.207, Train_accy 94.41: 100%|██████████| 20/20 [20:50<00:00, 62.55s/it]
2024-04-24 23:54:35,017 [icarl.py] => Task 4, Epoch 20/20 => Loss 2.207, Train_accy 94.41
2024-04-24 23:54:35,018 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 23:55:58,331 [icarl.py] => Exemplar size: 1800
2024-04-24 23:55:58,332 [trainer.py] => CNN: {'total': 75.22, '00-49': 69.48, '50-59': 61.5, '60-69': 81.6, '70-79': 89.8, '80-89': 96.7, 'old': 72.54, 'new': 96.7}
2024-04-24 23:55:58,332 [trainer.py] => NME: {'total': 85.51, '00-49': 85.46, '50-59': 77.3, '60-69': 85.9, '70-79': 87.3, '80-89': 91.8, 'old': 84.72, 'new': 91.8}
2024-04-24 23:55:58,332 [trainer.py] => CNN top1 curve: [93.36, 86.18, 84.11, 77.22, 75.22]
2024-04-24 23:55:58,332 [trainer.py] => CNN top5 curve: [99.1, 98.0, 96.81, 95.09, 93.47]
2024-04-24 23:55:58,332 [trainer.py] => NME top1 curve: [93.78, 92.1, 90.81, 87.48, 85.51]
2024-04-24 23:55:58,332 [trainer.py] => NME top5 curve: [99.36, 99.15, 98.93, 98.44, 97.73]

Average Accuracy (CNN): 83.22
Average Accuracy (NME): 89.94
2024-04-24 23:55:58,332 [trainer.py] => Average Accuracy (CNN): 83.22
2024-04-24 23:55:58,332 [trainer.py] => Average Accuracy (NME): 89.94
2024-04-24 23:55:58,332 [trainer.py] => Train Time: 0
2024-04-24 23:55:58,332 [trainer.py] => Test Time: 177.05999999999997 

2024-04-24 23:55:58,333 [trainer.py] => All params: 85867866
2024-04-24 23:55:58,333 [trainer.py] => Trainable params: 85867866
2024-04-24 23:55:58,334 [icarl.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.196, Train_accy 78.21, Test_accy 71.71:   0%|          | 0/20 [01:23<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.196, Train_accy 78.21, Test_accy 71.71:   5%|▌         | 1/20 [01:23<26:35, 83.99s/it]
Task 5, Epoch 2/20 => Loss 2.427, Train_accy 89.01:   5%|▌         | 1/20 [02:23<26:35, 83.99s/it]                 
Task 5, Epoch 2/20 => Loss 2.427, Train_accy 89.01:  10%|█         | 2/20 [02:23<20:51, 69.54s/it]
Task 5, Epoch 3/20 => Loss 2.364, Train_accy 89.88:  10%|█         | 2/20 [03:22<20:51, 69.54s/it]
Task 5, Epoch 3/20 => Loss 2.364, Train_accy 89.88:  15%|█▌        | 3/20 [03:22<18:24, 64.94s/it]
Task 5, Epoch 4/20 => Loss 2.337, Train_accy 90.94:  15%|█▌        | 3/20 [04:22<18:24, 64.94s/it]
Task 5, Epoch 4/20 => Loss 2.337, Train_accy 90.94:  20%|██        | 4/20 [04:22<16:44, 62.76s/it]
Task 5, Epoch 5/20 => Loss 2.304, Train_accy 91.81:  20%|██        | 4/20 [05:21<16:44, 62.76s/it]
Task 5, Epoch 5/20 => Loss 2.304, Train_accy 91.81:  25%|██▌       | 5/20 [05:21<15:22, 61.52s/it]
Task 5, Epoch 6/20 => Loss 2.311, Train_accy 92.12, Test_accy 72.78:  25%|██▌       | 5/20 [06:45<15:22, 61.52s/it]
Task 5, Epoch 6/20 => Loss 2.311, Train_accy 92.12, Test_accy 72.78:  30%|███       | 6/20 [06:45<16:08, 69.16s/it]
Task 5, Epoch 7/20 => Loss 2.243, Train_accy 92.51:  30%|███       | 6/20 [07:45<16:08, 69.16s/it]                 
Task 5, Epoch 7/20 => Loss 2.243, Train_accy 92.51:  35%|███▌      | 7/20 [07:45<14:18, 66.01s/it]
Task 5, Epoch 8/20 => Loss 2.290, Train_accy 92.51:  35%|███▌      | 7/20 [08:44<14:18, 66.01s/it]
Task 5, Epoch 8/20 => Loss 2.290, Train_accy 92.51:  40%|████      | 8/20 [08:44<12:47, 63.96s/it]
Task 5, Epoch 9/20 => Loss 2.271, Train_accy 92.81:  40%|████      | 8/20 [09:44<12:47, 63.96s/it]
Task 5, Epoch 9/20 => Loss 2.271, Train_accy 92.81:  45%|████▌     | 9/20 [09:44<11:28, 62.55s/it]
Task 5, Epoch 10/20 => Loss 2.304, Train_accy 92.56:  45%|████▌     | 9/20 [10:43<11:28, 62.55s/it]
Task 5, Epoch 10/20 => Loss 2.304, Train_accy 92.56:  50%|█████     | 10/20 [10:43<10:15, 61.58s/it]
Task 5, Epoch 11/20 => Loss 2.255, Train_accy 93.09, Test_accy 74.62:  50%|█████     | 10/20 [12:07<10:15, 61.58s/it]
Task 5, Epoch 11/20 => Loss 2.255, Train_accy 93.09, Test_accy 74.62:  55%|█████▌    | 11/20 [12:07<10:16, 68.49s/it]
Task 5, Epoch 12/20 => Loss 2.234, Train_accy 93.85:  55%|█████▌    | 11/20 [13:07<10:16, 68.49s/it]                 
Task 5, Epoch 12/20 => Loss 2.234, Train_accy 93.85:  60%|██████    | 12/20 [13:07<08:45, 65.72s/it]
Task 5, Epoch 13/20 => Loss 2.261, Train_accy 93.13:  60%|██████    | 12/20 [14:06<08:45, 65.72s/it]
Task 5, Epoch 13/20 => Loss 2.261, Train_accy 93.13:  65%|██████▌   | 13/20 [14:06<07:26, 63.82s/it]
Task 5, Epoch 14/20 => Loss 2.195, Train_accy 94.06:  65%|██████▌   | 13/20 [15:05<07:26, 63.82s/it]
Task 5, Epoch 14/20 => Loss 2.195, Train_accy 94.06:  70%|███████   | 14/20 [15:05<06:14, 62.49s/it]
Task 5, Epoch 15/20 => Loss 2.228, Train_accy 93.71:  70%|███████   | 14/20 [16:05<06:14, 62.49s/it]
Task 5, Epoch 15/20 => Loss 2.228, Train_accy 93.71:  75%|███████▌  | 15/20 [16:05<05:07, 61.57s/it]
Task 5, Epoch 16/20 => Loss 2.242, Train_accy 93.43, Test_accy 71.93:  75%|███████▌  | 15/20 [17:29<05:07, 61.57s/it]
Task 5, Epoch 16/20 => Loss 2.242, Train_accy 93.43, Test_accy 71.93:  80%|████████  | 16/20 [17:29<04:33, 68.39s/it]
Task 5, Epoch 17/20 => Loss 2.223, Train_accy 94.01:  80%|████████  | 16/20 [18:28<04:33, 68.39s/it]                 
Task 5, Epoch 17/20 => Loss 2.223, Train_accy 94.01:  85%|████████▌ | 17/20 [18:28<03:16, 65.66s/it]
Task 5, Epoch 18/20 => Loss 2.238, Train_accy 93.93:  85%|████████▌ | 17/20 [19:28<03:16, 65.66s/it]
Task 5, Epoch 18/20 => Loss 2.238, Train_accy 93.93:  90%|█████████ | 18/20 [19:28<02:07, 63.77s/it]
Task 5, Epoch 19/20 => Loss 2.246, Train_accy 93.63:  90%|█████████ | 18/20 [20:27<02:07, 63.77s/it]
Task 5, Epoch 19/20 => Loss 2.246, Train_accy 93.63:  95%|█████████▌| 19/20 [20:27<01:02, 62.46s/it]
Task 5, Epoch 20/20 => Loss 2.224, Train_accy 94.22:  95%|█████████▌| 19/20 [21:27<01:02, 62.46s/it]
Task 5, Epoch 20/20 => Loss 2.224, Train_accy 94.22: 100%|██████████| 20/20 [21:27<00:00, 61.58s/it]
Task 5, Epoch 20/20 => Loss 2.224, Train_accy 94.22: 100%|██████████| 20/20 [21:27<00:00, 64.36s/it]
2024-04-25 00:17:25,657 [icarl.py] => Task 5, Epoch 20/20 => Loss 2.224, Train_accy 94.22
2024-04-25 00:17:25,659 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-25 00:18:54,965 [icarl.py] => Exemplar size: 2000
2024-04-25 00:18:54,965 [trainer.py] => CNN: {'total': 72.91, '00-49': 65.2, '50-59': 58.8, '60-69': 77.1, '70-79': 80.2, '80-89': 91.0, '90-99': 96.0, 'old': 70.34, 'new': 96.0}
2024-04-25 00:18:54,965 [trainer.py] => NME: {'total': 84.5, '00-49': 84.54, '50-59': 73.8, '60-69': 86.1, '70-79': 82.1, '80-89': 89.8, '90-99': 90.5, 'old': 83.83, 'new': 90.5}
2024-04-25 00:18:54,965 [trainer.py] => CNN top1 curve: [93.36, 86.18, 84.11, 77.22, 75.22, 72.91]
2024-04-25 00:18:54,965 [trainer.py] => CNN top5 curve: [99.1, 98.0, 96.81, 95.09, 93.47, 91.68]
2024-04-25 00:18:54,965 [trainer.py] => NME top1 curve: [93.78, 92.1, 90.81, 87.48, 85.51, 84.5]
2024-04-25 00:18:54,966 [trainer.py] => NME top5 curve: [99.36, 99.15, 98.93, 98.44, 97.73, 97.41]

Average Accuracy (CNN): 81.5
Average Accuracy (NME): 89.03
2024-04-25 00:18:54,966 [trainer.py] => Average Accuracy (CNN): 81.5
2024-04-25 00:18:54,966 [trainer.py] => Average Accuracy (NME): 89.03
2024-04-25 00:18:54,966 [trainer.py] => Train Time: 0
2024-04-25 00:18:54,966 [trainer.py] => Test Time: 227.09999999999997 

Accuracy Matrix (CNN):
[[93.36 83.94 81.52 74.58 69.48 65.2 ]
 [ 0.   97.4  82.7  63.6  61.5  58.8 ]
 [ 0.    0.   98.5  85.4  81.6  77.1 ]
 [ 0.    0.    0.   95.9  89.8  80.2 ]
 [ 0.    0.    0.    0.   96.7  91.  ]
 [ 0.    0.    0.    0.    0.   96.  ]]
2024-04-25 00:18:54,966 [trainer.py] => Forgetting (CNN): 21.912000000000003
Accuracy Matrix (NME):
[[93.78 91.88 90.78 88.36 85.46 84.54]
 [ 0.   93.2  87.1  78.7  77.3  73.8 ]
 [ 0.    0.   94.7  88.5  85.9  86.1 ]
 [ 0.    0.    0.   90.8  87.3  82.1 ]
 [ 0.    0.    0.    0.   91.8  89.8 ]
 [ 0.    0.    0.    0.    0.   90.5 ]]
2024-04-25 00:18:54,967 [trainer.py] => Forgetting (NME): 9.588000000000003

2024-04-20 16:38:15,365 [trainer.py] => config: ./exps/simplecil_B50.json
2024-04-20 16:38:15,388 [trainer.py] => prefix:  
2024-04-20 16:38:15,388 [trainer.py] => dataset: cifar224
2024-04-20 16:38:15,388 [trainer.py] => memory_size: 0
2024-04-20 16:38:15,388 [trainer.py] => memory_per_class: 0
2024-04-20 16:38:15,388 [trainer.py] => fixed_memory: False
2024-04-20 16:38:15,388 [trainer.py] => shuffle: True
2024-04-20 16:38:15,388 [trainer.py] => init_cls: 50
2024-04-20 16:38:15,388 [trainer.py] => increment: 10
2024-04-20 16:38:15,388 [trainer.py] => model_name: simplecil
2024-04-20 16:38:15,388 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-04-20 16:38:15,388 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-20 16:38:15,388 [trainer.py] => seed: 1993
2024-04-20 16:38:15,388 [trainer.py] => tuned_epoch: 0
2024-04-20 16:38:15,388 [trainer.py] => init_lr: 0.01
2024-04-20 16:38:15,388 [trainer.py] => batch_size: 48
2024-04-20 16:38:15,388 [trainer.py] => weight_decay: 0.05
2024-04-20 16:38:15,388 [trainer.py] => min_lr: 1e-08
2024-04-20 16:38:15,389 [trainer.py] => optimizer: sgd
2024-04-20 16:38:15,389 [trainer.py] => vpt_type: shallow
2024-04-20 16:38:15,389 [trainer.py] => prompt_token_num: 3
Files already downloaded and verified
Files already downloaded and verified
2024-04-20 16:38:17,456 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-20 16:38:27,955 [trainer.py] => All params: 85798656
2024-04-20 16:38:27,955 [trainer.py] => Trainable params: 85798656
2024-04-20 16:38:28,327 [simplecil.py] => Learning on 0-50
2024-04-20 16:39:53,683 [trainer.py] => No NME accuracy.
2024-04-20 16:39:53,683 [trainer.py] => CNN: {'total': 81.82, '00-49': 81.82, 'old': 0, 'new': 81.82}
2024-04-20 16:39:53,683 [trainer.py] => CNN top1 curve: [81.82]
2024-04-20 16:39:53,683 [trainer.py] => CNN top5 curve: [95.52]

Average Accuracy (CNN): 81.82
2024-04-20 16:39:53,683 [trainer.py] => Average Accuracy (CNN): 81.82 

2024-04-20 16:39:53,683 [trainer.py] => Train Time: 0.18
2024-04-20 16:39:53,683 [trainer.py] => Test Time: 13.2 

2024-04-20 16:39:53,684 [trainer.py] => All params: 85837057
2024-04-20 16:39:53,685 [trainer.py] => Trainable params: 85837057
2024-04-20 16:39:53,687 [simplecil.py] => Learning on 50-60
2024-04-20 16:40:23,831 [trainer.py] => No NME accuracy.
2024-04-20 16:40:23,832 [trainer.py] => CNN: {'total': 80.07, '00-49': 80.22, '50-59': 79.3, 'old': 80.22, 'new': 79.3}
2024-04-20 16:40:23,832 [trainer.py] => CNN top1 curve: [81.82, 80.07]
2024-04-20 16:40:23,832 [trainer.py] => CNN top5 curve: [95.52, 94.47]

Average Accuracy (CNN): 80.94
2024-04-20 16:40:23,832 [trainer.py] => Average Accuracy (CNN): 80.94 

2024-04-20 16:40:23,832 [trainer.py] => Train Time: 0.18
2024-04-20 16:40:23,832 [trainer.py] => Test Time: 29.04 

2024-04-20 16:40:23,833 [trainer.py] => All params: 85844737
2024-04-20 16:40:23,834 [trainer.py] => Trainable params: 85844737
2024-04-20 16:40:23,835 [simplecil.py] => Learning on 60-70
2024-04-20 16:40:57,060 [trainer.py] => No NME accuracy.
2024-04-20 16:40:57,060 [trainer.py] => CNN: {'total': 79.99, '00-49': 79.58, '50-59': 76.3, '60-69': 85.7, 'old': 79.03, 'new': 85.7}
2024-04-20 16:40:57,060 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99]
2024-04-20 16:40:57,060 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36]

Average Accuracy (CNN): 80.63
2024-04-20 16:40:57,060 [trainer.py] => Average Accuracy (CNN): 80.63 

2024-04-20 16:40:57,060 [trainer.py] => Train Time: 0.18
2024-04-20 16:40:57,060 [trainer.py] => Test Time: 47.47 

2024-04-20 16:40:57,061 [trainer.py] => All params: 85852417
2024-04-20 16:40:57,062 [trainer.py] => Trainable params: 85852417
2024-04-20 16:40:57,063 [simplecil.py] => Learning on 70-80
2024-04-20 16:41:32,499 [trainer.py] => No NME accuracy.
2024-04-20 16:41:32,500 [trainer.py] => CNN: {'total': 77.31, '00-49': 78.28, '50-59': 72.7, '60-69': 83.7, '70-79': 70.7, 'old': 78.26, 'new': 70.7}
2024-04-20 16:41:32,500 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99, 77.31]
2024-04-20 16:41:32,500 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36, 93.54]

Average Accuracy (CNN): 79.8
2024-04-20 16:41:32,500 [trainer.py] => Average Accuracy (CNN): 79.8 

2024-04-20 16:41:32,500 [trainer.py] => Train Time: 0.18
2024-04-20 16:41:32,500 [trainer.py] => Test Time: 68.36 

2024-04-20 16:41:32,501 [trainer.py] => All params: 85860097
2024-04-20 16:41:32,501 [trainer.py] => Trainable params: 85860097
2024-04-20 16:41:32,503 [simplecil.py] => Learning on 80-90
2024-04-20 16:42:09,465 [trainer.py] => No NME accuracy.
2024-04-20 16:42:09,465 [trainer.py] => CNN: {'total': 76.59, '00-49': 77.1, '50-59': 72.2, '60-69': 83.4, '70-79': 70.1, '80-89': 78.1, 'old': 76.4, 'new': 78.1}
2024-04-20 16:42:09,465 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99, 77.31, 76.59]
2024-04-20 16:42:09,465 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36, 93.54, 92.92]

Average Accuracy (CNN): 79.16
2024-04-20 16:42:09,465 [trainer.py] => Average Accuracy (CNN): 79.16 

2024-04-20 16:42:09,465 [trainer.py] => Train Time: 0.18
2024-04-20 16:42:09,465 [trainer.py] => Test Time: 91.66 

2024-04-20 16:42:09,466 [trainer.py] => All params: 85867777
2024-04-20 16:42:09,467 [trainer.py] => Trainable params: 85867777
2024-04-20 16:42:09,468 [simplecil.py] => Learning on 90-100
2024-04-20 16:42:49,982 [trainer.py] => No NME accuracy.
2024-04-20 16:42:49,982 [trainer.py] => CNN: {'total': 76.21, '00-49': 76.4, '50-59': 70.3, '60-69': 83.3, '70-79': 69.1, '80-89': 77.2, '90-99': 80.2, 'old': 75.77, 'new': 80.2}
2024-04-20 16:42:49,982 [trainer.py] => CNN top1 curve: [81.82, 80.07, 79.99, 77.31, 76.59, 76.21]
2024-04-20 16:42:49,982 [trainer.py] => CNN top5 curve: [95.52, 94.47, 94.36, 93.54, 92.92, 92.54]

Average Accuracy (CNN): 78.66
2024-04-20 16:42:49,982 [trainer.py] => Average Accuracy (CNN): 78.66 

2024-04-20 16:42:49,982 [trainer.py] => Train Time: 0.18
2024-04-20 16:42:49,982 [trainer.py] => Test Time: 117.8 

Accuracy Matrix (CNN):
[[81.82 80.22 79.58 78.28 77.1  76.4 ]
 [ 0.   79.3  76.3  72.7  72.2  70.3 ]
 [ 0.    0.   85.7  83.7  83.4  83.3 ]
 [ 0.    0.    0.   70.7  70.1  69.1 ]
 [ 0.    0.    0.    0.   78.1  77.2 ]
 [ 0.    0.    0.    0.    0.   80.2 ]]
2024-04-20 16:42:49,983 [trainer.py] => Forgetting (CNN): 3.8639999999999985
2024-04-20 16:42:53,165 [trainer.py] => config: ./exps/der_B50.json
2024-04-20 16:42:53,165 [trainer.py] => prefix: reproduce
2024-04-20 16:42:53,165 [trainer.py] => dataset: cifar224
2024-04-20 16:42:53,165 [trainer.py] => memory_size: 2000
2024-04-20 16:42:53,165 [trainer.py] => memory_per_class: 20
2024-04-20 16:42:53,165 [trainer.py] => fixed_memory: False
2024-04-20 16:42:53,165 [trainer.py] => shuffle: True
2024-04-20 16:42:53,165 [trainer.py] => init_cls: 50
2024-04-20 16:42:53,165 [trainer.py] => increment: 10
2024-04-20 16:42:53,165 [trainer.py] => model_name: der
2024-04-20 16:42:53,165 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-20 16:42:53,165 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-20 16:42:53,165 [trainer.py] => seed: 1993
2024-04-20 16:42:53,165 [trainer.py] => init_epoch: 20
2024-04-20 16:42:53,165 [trainer.py] => init_lr: 0.001
2024-04-20 16:42:53,165 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-20 16:42:53,165 [trainer.py] => init_lr_decay: 0.1
2024-04-20 16:42:53,165 [trainer.py] => init_weight_decay: 0.0005
2024-04-20 16:42:53,165 [trainer.py] => epochs: 20
2024-04-20 16:42:53,165 [trainer.py] => lrate: 0.001
2024-04-20 16:42:53,166 [trainer.py] => milestones: [80, 120, 150]
2024-04-20 16:42:53,166 [trainer.py] => lrate_decay: 0.1
2024-04-20 16:42:53,166 [trainer.py] => batch_size: 48
2024-04-20 16:42:53,166 [trainer.py] => weight_decay: 0.0002
2024-04-20 16:42:53,166 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-04-20 16:42:55,057 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-20 16:42:55,480 [trainer.py] => All params: 0
2024-04-20 16:42:55,481 [trainer.py] => Trainable params: 0
2024-04-20 16:43:02,059 [der.py] => Learning on 0-50
2024-04-20 16:43:02,060 [der.py] => All params: 85876325
2024-04-20 16:43:02,061 [der.py] => Trainable params: 85876325

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.065, Train_accy 47.62, Test_accy 90.34:   0%|          | 0/20 [03:02<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.065, Train_accy 47.62, Test_accy 90.34:   5%|▌         | 1/20 [03:02<57:47, 182.49s/it]
Task 0, Epoch 2/20 => Loss 0.792, Train_accy 77.76:   5%|▌         | 1/20 [05:51<57:47, 182.49s/it]                 
Task 0, Epoch 2/20 => Loss 0.792, Train_accy 77.76:  10%|█         | 2/20 [05:51<52:19, 174.42s/it]
Task 0, Epoch 3/20 => Loss 0.678, Train_accy 80.84:  10%|█         | 2/20 [08:39<52:19, 174.42s/it]
Task 0, Epoch 3/20 => Loss 0.678, Train_accy 80.84:  15%|█▌        | 3/20 [08:39<48:41, 171.82s/it]
Task 0, Epoch 4/20 => Loss 0.611, Train_accy 82.68:  15%|█▌        | 3/20 [11:28<48:41, 171.82s/it]
Task 0, Epoch 4/20 => Loss 0.611, Train_accy 82.68:  20%|██        | 4/20 [11:28<45:28, 170.56s/it]
Task 0, Epoch 5/20 => Loss 0.568, Train_accy 83.75:  20%|██        | 4/20 [14:17<45:28, 170.56s/it]
Task 0, Epoch 5/20 => Loss 0.568, Train_accy 83.75:  25%|██▌       | 5/20 [14:17<42:26, 169.79s/it]
Task 0, Epoch 6/20 => Loss 0.537, Train_accy 84.59, Test_accy 94.00:  25%|██▌       | 5/20 [17:18<42:26, 169.79s/it]
Task 0, Epoch 6/20 => Loss 0.537, Train_accy 84.59, Test_accy 94.00:  30%|███       | 6/20 [17:18<40:34, 173.88s/it]
Task 0, Epoch 7/20 => Loss 0.505, Train_accy 85.71:  30%|███       | 6/20 [20:07<40:34, 173.88s/it]                 
Task 0, Epoch 7/20 => Loss 0.505, Train_accy 85.71:  35%|███▌      | 7/20 [20:07<37:17, 172.14s/it]
Task 0, Epoch 8/20 => Loss 0.486, Train_accy 86.31:  35%|███▌      | 7/20 [22:55<37:17, 172.14s/it]
Task 0, Epoch 8/20 => Loss 0.486, Train_accy 86.31:  40%|████      | 8/20 [22:55<34:11, 170.97s/it]
Task 0, Epoch 9/20 => Loss 0.473, Train_accy 86.35:  40%|████      | 8/20 [25:44<34:11, 170.97s/it]
Task 0, Epoch 9/20 => Loss 0.473, Train_accy 86.35:  45%|████▌     | 9/20 [25:44<31:11, 170.17s/it]
Task 0, Epoch 10/20 => Loss 0.450, Train_accy 87.22:  45%|████▌     | 9/20 [28:32<31:11, 170.17s/it]
Task 0, Epoch 10/20 => Loss 0.450, Train_accy 87.22:  50%|█████     | 10/20 [28:32<28:16, 169.60s/it]
Task 0, Epoch 11/20 => Loss 0.445, Train_accy 87.37, Test_accy 93.40:  50%|█████     | 10/20 [31:34<28:16, 169.60s/it]
Task 0, Epoch 11/20 => Loss 0.445, Train_accy 87.37, Test_accy 93.40:  55%|█████▌    | 11/20 [31:34<26:00, 173.43s/it]
Task 0, Epoch 12/20 => Loss 0.420, Train_accy 88.11:  55%|█████▌    | 11/20 [34:24<26:00, 173.43s/it]                 
Task 0, Epoch 12/20 => Loss 0.420, Train_accy 88.11:  60%|██████    | 12/20 [34:24<22:59, 172.44s/it]
Task 0, Epoch 13/20 => Loss 0.423, Train_accy 88.04:  60%|██████    | 12/20 [37:15<22:59, 172.44s/it]
Task 0, Epoch 13/20 => Loss 0.423, Train_accy 88.04:  65%|██████▌   | 13/20 [37:15<20:02, 171.81s/it]
Task 0, Epoch 14/20 => Loss 0.409, Train_accy 88.34:  65%|██████▌   | 13/20 [40:05<20:02, 171.81s/it]
Task 0, Epoch 14/20 => Loss 0.409, Train_accy 88.34:  70%|███████   | 14/20 [40:05<17:08, 171.37s/it]
Task 0, Epoch 15/20 => Loss 0.406, Train_accy 88.40:  70%|███████   | 14/20 [42:54<17:08, 171.37s/it]
Task 0, Epoch 15/20 => Loss 0.406, Train_accy 88.40:  75%|███████▌  | 15/20 [42:54<14:13, 170.69s/it]
Task 0, Epoch 16/20 => Loss 0.385, Train_accy 89.10, Test_accy 92.62:  75%|███████▌  | 15/20 [45:57<14:13, 170.69s/it]
Task 0, Epoch 16/20 => Loss 0.385, Train_accy 89.10, Test_accy 92.62:  80%|████████  | 16/20 [45:57<11:36, 174.24s/it]
Task 0, Epoch 17/20 => Loss 0.371, Train_accy 89.42:  80%|████████  | 16/20 [48:45<11:36, 174.24s/it]                 
Task 0, Epoch 17/20 => Loss 0.371, Train_accy 89.42:  85%|████████▌ | 17/20 [48:45<08:37, 172.52s/it]
Task 0, Epoch 18/20 => Loss 0.373, Train_accy 89.46:  85%|████████▌ | 17/20 [51:34<08:37, 172.52s/it]
Task 0, Epoch 18/20 => Loss 0.373, Train_accy 89.46:  90%|█████████ | 18/20 [51:34<05:42, 171.42s/it]
Task 0, Epoch 19/20 => Loss 0.375, Train_accy 89.49:  90%|█████████ | 18/20 [54:23<05:42, 171.42s/it]
Task 0, Epoch 19/20 => Loss 0.375, Train_accy 89.49:  95%|█████████▌| 19/20 [54:23<02:50, 170.62s/it]
Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.86:  95%|█████████▌| 19/20 [57:12<02:50, 170.62s/it]
Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.86: 100%|██████████| 20/20 [57:12<00:00, 170.08s/it]
Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.86: 100%|██████████| 20/20 [57:12<00:00, 171.61s/it]
2024-04-20 17:40:14,753 [der.py] => Task 0, Epoch 20/20 => Loss 0.361, Train_accy 89.86
2024-04-20 17:40:14,754 [base.py] => Reducing exemplars...(40 per classes)
2024-04-20 17:40:14,754 [base.py] => Constructing exemplars...(40 per classes)
2024-04-20 17:42:28,935 [der.py] => Exemplar size: 2000
2024-04-20 17:42:28,935 [trainer.py] => CNN: {'total': 93.6, '00-49': 93.6, 'old': 0, 'new': 93.6}
2024-04-20 17:42:28,936 [trainer.py] => NME: {'total': 93.3, '00-49': 93.3, 'old': 0, 'new': 93.3}
2024-04-20 17:42:28,936 [trainer.py] => CNN top1 curve: [93.6]
2024-04-20 17:42:28,936 [trainer.py] => CNN top5 curve: [99.36]
2024-04-20 17:42:28,936 [trainer.py] => NME top1 curve: [93.3]
2024-04-20 17:42:28,936 [trainer.py] => NME top5 curve: [99.5]

Average Accuracy (CNN): 93.6
Average Accuracy (NME): 93.3
2024-04-20 17:42:28,936 [trainer.py] => Average Accuracy (CNN): 93.6
2024-04-20 17:42:28,936 [trainer.py] => Average Accuracy (NME): 93.3
2024-04-20 17:42:28,936 [trainer.py] => Train Time: 3432.62
2024-04-20 17:42:28,936 [trainer.py] => Test Time: 27.14 

2024-04-20 17:42:28,937 [trainer.py] => All params: 85876325
2024-04-20 17:42:28,938 [trainer.py] => Trainable params: 85876325
2024-04-20 17:42:35,592 [der.py] => Learning on 50-60
2024-04-20 17:42:35,594 [der.py] => All params: 171697991
2024-04-20 17:42:35,595 [der.py] => Trainable params: 85899335

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.602, Loss_clf 0.957, Loss_aux 0.645, Train_accy 78.11, Test_accy 90.23:   0%|          | 0/20 [01:34<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.602, Loss_clf 0.957, Loss_aux 0.645, Train_accy 78.11, Test_accy 90.23:   5%|▌         | 1/20 [01:34<29:56, 94.55s/it]
Task 1, Epoch 2/20 => Loss 0.754, Loss_clf 0.406, Loss_aux 0.348, Train_accy 88.09:   5%|▌         | 1/20 [02:38<29:56, 94.55s/it]                 
Task 1, Epoch 2/20 => Loss 0.754, Loss_clf 0.406, Loss_aux 0.348, Train_accy 88.09:  10%|█         | 2/20 [02:38<23:01, 76.74s/it]
Task 1, Epoch 3/20 => Loss 0.707, Loss_clf 0.381, Loss_aux 0.326, Train_accy 88.73:  10%|█         | 2/20 [03:42<23:01, 76.74s/it]
Task 1, Epoch 3/20 => Loss 0.707, Loss_clf 0.381, Loss_aux 0.326, Train_accy 88.73:  15%|█▌        | 3/20 [03:42<20:05, 70.92s/it]
Task 1, Epoch 4/20 => Loss 0.712, Loss_clf 0.382, Loss_aux 0.330, Train_accy 88.86:  15%|█▌        | 3/20 [04:46<20:05, 70.92s/it]
Task 1, Epoch 4/20 => Loss 0.712, Loss_clf 0.382, Loss_aux 0.330, Train_accy 88.86:  20%|██        | 4/20 [04:46<18:10, 68.15s/it]
Task 1, Epoch 5/20 => Loss 0.656, Loss_clf 0.362, Loss_aux 0.294, Train_accy 89.41:  20%|██        | 4/20 [05:50<18:10, 68.15s/it]
Task 1, Epoch 5/20 => Loss 0.656, Loss_clf 0.362, Loss_aux 0.294, Train_accy 89.41:  25%|██▌       | 5/20 [05:50<16:39, 66.64s/it]
Task 1, Epoch 6/20 => Loss 0.613, Loss_clf 0.336, Loss_aux 0.278, Train_accy 90.20, Test_accy 89.98:  25%|██▌       | 5/20 [07:24<16:39, 66.64s/it]
Task 1, Epoch 6/20 => Loss 0.613, Loss_clf 0.336, Loss_aux 0.278, Train_accy 90.20, Test_accy 89.98:  30%|███       | 6/20 [07:24<17:44, 76.01s/it]
Task 1, Epoch 7/20 => Loss 0.604, Loss_clf 0.333, Loss_aux 0.271, Train_accy 90.27:  30%|███       | 6/20 [08:29<17:44, 76.01s/it]                 
Task 1, Epoch 7/20 => Loss 0.604, Loss_clf 0.333, Loss_aux 0.271, Train_accy 90.27:  35%|███▌      | 7/20 [08:29<15:38, 72.20s/it]
Task 1, Epoch 8/20 => Loss 0.574, Loss_clf 0.315, Loss_aux 0.259, Train_accy 90.36:  35%|███▌      | 7/20 [09:33<15:38, 72.20s/it]
Task 1, Epoch 8/20 => Loss 0.574, Loss_clf 0.315, Loss_aux 0.259, Train_accy 90.36:  40%|████      | 8/20 [09:33<13:56, 69.69s/it]
Task 1, Epoch 9/20 => Loss 0.578, Loss_clf 0.324, Loss_aux 0.254, Train_accy 90.57:  40%|████      | 8/20 [10:37<13:56, 69.69s/it]
Task 1, Epoch 9/20 => Loss 0.578, Loss_clf 0.324, Loss_aux 0.254, Train_accy 90.57:  45%|████▌     | 9/20 [10:37<12:27, 67.95s/it]
Task 1, Epoch 10/20 => Loss 0.562, Loss_clf 0.314, Loss_aux 0.249, Train_accy 90.80:  45%|████▌     | 9/20 [11:41<12:27, 67.95s/it]
Task 1, Epoch 10/20 => Loss 0.562, Loss_clf 0.314, Loss_aux 0.249, Train_accy 90.80:  50%|█████     | 10/20 [11:41<11:08, 66.82s/it]
Task 1, Epoch 11/20 => Loss 0.528, Loss_clf 0.293, Loss_aux 0.235, Train_accy 91.20, Test_accy 90.35:  50%|█████     | 10/20 [13:16<11:08, 66.82s/it]
Task 1, Epoch 11/20 => Loss 0.528, Loss_clf 0.293, Loss_aux 0.235, Train_accy 91.20, Test_accy 90.35:  55%|█████▌    | 11/20 [13:16<11:17, 75.28s/it]
Task 1, Epoch 12/20 => Loss 0.532, Loss_clf 0.294, Loss_aux 0.238, Train_accy 91.66:  55%|█████▌    | 11/20 [14:20<11:17, 75.28s/it]                 
Task 1, Epoch 12/20 => Loss 0.532, Loss_clf 0.294, Loss_aux 0.238, Train_accy 91.66:  60%|██████    | 12/20 [14:20<09:35, 71.97s/it]
Task 1, Epoch 13/20 => Loss 0.507, Loss_clf 0.279, Loss_aux 0.228, Train_accy 91.63:  60%|██████    | 12/20 [15:25<09:35, 71.97s/it]
Task 1, Epoch 13/20 => Loss 0.507, Loss_clf 0.279, Loss_aux 0.228, Train_accy 91.63:  65%|██████▌   | 13/20 [15:25<08:08, 69.72s/it]
Task 1, Epoch 14/20 => Loss 0.528, Loss_clf 0.297, Loss_aux 0.231, Train_accy 91.54:  65%|██████▌   | 13/20 [16:29<08:08, 69.72s/it]
Task 1, Epoch 14/20 => Loss 0.528, Loss_clf 0.297, Loss_aux 0.231, Train_accy 91.54:  70%|███████   | 14/20 [16:29<06:47, 68.00s/it]
Task 1, Epoch 15/20 => Loss 0.470, Loss_clf 0.266, Loss_aux 0.204, Train_accy 92.13:  70%|███████   | 14/20 [17:33<06:47, 68.00s/it]
Task 1, Epoch 15/20 => Loss 0.470, Loss_clf 0.266, Loss_aux 0.204, Train_accy 92.13:  75%|███████▌  | 15/20 [17:33<05:34, 66.82s/it]
Task 1, Epoch 16/20 => Loss 0.498, Loss_clf 0.281, Loss_aux 0.217, Train_accy 92.04, Test_accy 89.45:  75%|███████▌  | 15/20 [19:08<05:34, 66.82s/it]
Task 1, Epoch 16/20 => Loss 0.498, Loss_clf 0.281, Loss_aux 0.217, Train_accy 92.04, Test_accy 89.45:  80%|████████  | 16/20 [19:08<05:00, 75.19s/it]
Task 1, Epoch 17/20 => Loss 0.489, Loss_clf 0.276, Loss_aux 0.214, Train_accy 91.91:  80%|████████  | 16/20 [20:12<05:00, 75.19s/it]                 
Task 1, Epoch 17/20 => Loss 0.489, Loss_clf 0.276, Loss_aux 0.214, Train_accy 91.91:  85%|████████▌ | 17/20 [20:12<03:35, 71.88s/it]
Task 1, Epoch 18/20 => Loss 0.461, Loss_clf 0.258, Loss_aux 0.202, Train_accy 92.46:  85%|████████▌ | 17/20 [21:16<03:35, 71.88s/it]
Task 1, Epoch 18/20 => Loss 0.461, Loss_clf 0.258, Loss_aux 0.202, Train_accy 92.46:  90%|█████████ | 18/20 [21:16<02:19, 69.61s/it]
Task 1, Epoch 19/20 => Loss 0.499, Loss_clf 0.287, Loss_aux 0.212, Train_accy 91.70:  90%|█████████ | 18/20 [22:20<02:19, 69.61s/it]
Task 1, Epoch 19/20 => Loss 0.499, Loss_clf 0.287, Loss_aux 0.212, Train_accy 91.70:  95%|█████████▌| 19/20 [22:20<01:08, 68.01s/it]
Task 1, Epoch 20/20 => Loss 0.467, Loss_clf 0.265, Loss_aux 0.202, Train_accy 92.49:  95%|█████████▌| 19/20 [23:25<01:08, 68.01s/it]
Task 1, Epoch 20/20 => Loss 0.467, Loss_clf 0.265, Loss_aux 0.202, Train_accy 92.49: 100%|██████████| 20/20 [23:25<00:00, 66.88s/it]
Task 1, Epoch 20/20 => Loss 0.467, Loss_clf 0.265, Loss_aux 0.202, Train_accy 92.49: 100%|██████████| 20/20 [23:25<00:00, 70.26s/it]
2024-04-20 18:06:00,926 [der.py] => Task 1, Epoch 20/20 => Loss 0.467, Loss_clf 0.265, Loss_aux 0.202, Train_accy 92.49
2024-04-20 18:06:00,927 [base.py] => Reducing exemplars...(33 per classes)
2024-04-20 18:06:25,690 [base.py] => Constructing exemplars...(33 per classes)
2024-04-20 18:08:00,980 [der.py] => Exemplar size: 1980
2024-04-20 18:08:00,980 [trainer.py] => CNN: {'total': 90.82, '00-49': 89.6, '50-59': 96.9, 'old': 89.6, 'new': 96.9}
2024-04-20 18:08:00,981 [trainer.py] => NME: {'total': 92.35, '00-49': 92.0, '50-59': 94.1, 'old': 92.0, 'new': 94.1}
2024-04-20 18:08:00,981 [trainer.py] => CNN top1 curve: [93.6, 90.82]
2024-04-20 18:08:00,981 [trainer.py] => CNN top5 curve: [99.36, 98.92]
2024-04-20 18:08:00,981 [trainer.py] => NME top1 curve: [93.3, 92.35]
2024-04-20 18:08:00,981 [trainer.py] => NME top5 curve: [99.5, 99.4]

Average Accuracy (CNN): 92.21
Average Accuracy (NME): 92.82
2024-04-20 18:08:00,981 [trainer.py] => Average Accuracy (CNN): 92.21
2024-04-20 18:08:00,981 [trainer.py] => Average Accuracy (NME): 92.82
2024-04-20 18:08:00,981 [trainer.py] => Train Time: 4837.85
2024-04-20 18:08:00,981 [trainer.py] => Test Time: 88.14 

2024-04-20 18:08:00,982 [trainer.py] => All params: 171697991
2024-04-20 18:08:00,984 [trainer.py] => Trainable params: 85899335
2024-04-20 18:08:07,894 [der.py] => Learning on 60-70
2024-04-20 18:08:07,900 [der.py] => All params: 257565777
2024-04-20 18:08:07,903 [der.py] => Trainable params: 85968465

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.516, Loss_clf 0.944, Loss_aux 0.572, Train_accy 80.74, Test_accy 88.10:   0%|          | 0/20 [02:11<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.516, Loss_clf 0.944, Loss_aux 0.572, Train_accy 80.74, Test_accy 88.10:   5%|▌         | 1/20 [02:11<41:46, 131.90s/it]
Task 2, Epoch 2/20 => Loss 0.666, Loss_clf 0.369, Loss_aux 0.297, Train_accy 89.57:   5%|▌         | 1/20 [03:32<41:46, 131.90s/it]                 
Task 2, Epoch 2/20 => Loss 0.666, Loss_clf 0.369, Loss_aux 0.297, Train_accy 89.57:  10%|█         | 2/20 [03:32<30:29, 101.65s/it]
Task 2, Epoch 3/20 => Loss 0.600, Loss_clf 0.335, Loss_aux 0.265, Train_accy 90.26:  10%|█         | 2/20 [04:52<30:29, 101.65s/it]
Task 2, Epoch 3/20 => Loss 0.600, Loss_clf 0.335, Loss_aux 0.265, Train_accy 90.26:  15%|█▌        | 3/20 [04:52<26:03, 91.98s/it] 
Task 2, Epoch 4/20 => Loss 0.552, Loss_clf 0.310, Loss_aux 0.242, Train_accy 91.15:  15%|█▌        | 3/20 [06:13<26:03, 91.98s/it]
Task 2, Epoch 4/20 => Loss 0.552, Loss_clf 0.310, Loss_aux 0.242, Train_accy 91.15:  20%|██        | 4/20 [06:13<23:18, 87.43s/it]
Task 2, Epoch 5/20 => Loss 0.532, Loss_clf 0.305, Loss_aux 0.228, Train_accy 91.40:  20%|██        | 4/20 [07:33<23:18, 87.43s/it]
Task 2, Epoch 5/20 => Loss 0.532, Loss_clf 0.305, Loss_aux 0.228, Train_accy 91.40:  25%|██▌       | 5/20 [07:33<21:13, 84.90s/it]
Task 2, Epoch 6/20 => Loss 0.511, Loss_clf 0.294, Loss_aux 0.216, Train_accy 91.78, Test_accy 89.37:  25%|██▌       | 5/20 [09:45<21:13, 84.90s/it]
Task 2, Epoch 6/20 => Loss 0.511, Loss_clf 0.294, Loss_aux 0.216, Train_accy 91.78, Test_accy 89.37:  30%|███       | 6/20 [09:45<23:29, 100.68s/it]
Task 2, Epoch 7/20 => Loss 0.517, Loss_clf 0.286, Loss_aux 0.231, Train_accy 91.79:  30%|███       | 6/20 [11:05<23:29, 100.68s/it]                 
Task 2, Epoch 7/20 => Loss 0.517, Loss_clf 0.286, Loss_aux 0.231, Train_accy 91.79:  35%|███▌      | 7/20 [11:05<20:22, 94.01s/it] 
Task 2, Epoch 8/20 => Loss 0.480, Loss_clf 0.276, Loss_aux 0.204, Train_accy 92.39:  35%|███▌      | 7/20 [12:25<20:22, 94.01s/it]
Task 2, Epoch 8/20 => Loss 0.480, Loss_clf 0.276, Loss_aux 0.204, Train_accy 92.39:  40%|████      | 8/20 [12:25<17:55, 89.66s/it]
Task 2, Epoch 9/20 => Loss 0.486, Loss_clf 0.279, Loss_aux 0.207, Train_accy 92.29:  40%|████      | 8/20 [13:46<17:55, 89.66s/it]
Task 2, Epoch 9/20 => Loss 0.486, Loss_clf 0.279, Loss_aux 0.207, Train_accy 92.29:  45%|████▌     | 9/20 [13:46<15:55, 86.82s/it]
Task 2, Epoch 10/20 => Loss 0.495, Loss_clf 0.284, Loss_aux 0.211, Train_accy 92.12:  45%|████▌     | 9/20 [15:06<15:55, 86.82s/it]
Task 2, Epoch 10/20 => Loss 0.495, Loss_clf 0.284, Loss_aux 0.211, Train_accy 92.12:  50%|█████     | 10/20 [15:06<14:09, 84.93s/it]
Task 2, Epoch 11/20 => Loss 0.453, Loss_clf 0.255, Loss_aux 0.198, Train_accy 93.04, Test_accy 88.31:  50%|█████     | 10/20 [17:19<14:09, 84.93s/it]
Task 2, Epoch 11/20 => Loss 0.453, Loss_clf 0.255, Loss_aux 0.198, Train_accy 93.04, Test_accy 88.31:  55%|█████▌    | 11/20 [17:19<14:54, 99.43s/it]
Task 2, Epoch 12/20 => Loss 0.461, Loss_clf 0.266, Loss_aux 0.195, Train_accy 92.66:  55%|█████▌    | 11/20 [18:39<14:54, 99.43s/it]                 
Task 2, Epoch 12/20 => Loss 0.461, Loss_clf 0.266, Loss_aux 0.195, Train_accy 92.66:  60%|██████    | 12/20 [18:39<12:29, 93.70s/it]
Task 2, Epoch 13/20 => Loss 0.422, Loss_clf 0.242, Loss_aux 0.179, Train_accy 93.27:  60%|██████    | 12/20 [20:00<12:29, 93.70s/it]
Task 2, Epoch 13/20 => Loss 0.422, Loss_clf 0.242, Loss_aux 0.179, Train_accy 93.27:  65%|██████▌   | 13/20 [20:00<10:28, 89.72s/it]
Task 2, Epoch 14/20 => Loss 0.426, Loss_clf 0.236, Loss_aux 0.190, Train_accy 93.12:  65%|██████▌   | 13/20 [21:20<10:28, 89.72s/it]
Task 2, Epoch 14/20 => Loss 0.426, Loss_clf 0.236, Loss_aux 0.190, Train_accy 93.12:  70%|███████   | 14/20 [21:20<08:41, 86.94s/it]
Task 2, Epoch 15/20 => Loss 0.450, Loss_clf 0.261, Loss_aux 0.189, Train_accy 92.89:  70%|███████   | 14/20 [22:41<08:41, 86.94s/it]
Task 2, Epoch 15/20 => Loss 0.450, Loss_clf 0.261, Loss_aux 0.189, Train_accy 92.89:  75%|███████▌  | 15/20 [22:41<07:04, 84.96s/it]
Task 2, Epoch 16/20 => Loss 0.426, Loss_clf 0.244, Loss_aux 0.182, Train_accy 92.99, Test_accy 89.41:  75%|███████▌  | 15/20 [24:53<07:04, 84.96s/it]
Task 2, Epoch 16/20 => Loss 0.426, Loss_clf 0.244, Loss_aux 0.182, Train_accy 92.99, Test_accy 89.41:  80%|████████  | 16/20 [24:53<06:36, 99.15s/it]
Task 2, Epoch 17/20 => Loss 0.430, Loss_clf 0.248, Loss_aux 0.182, Train_accy 93.09:  80%|████████  | 16/20 [26:14<06:36, 99.15s/it]                 
Task 2, Epoch 17/20 => Loss 0.430, Loss_clf 0.248, Loss_aux 0.182, Train_accy 93.09:  85%|████████▌ | 17/20 [26:14<04:40, 93.58s/it]
Task 2, Epoch 18/20 => Loss 0.408, Loss_clf 0.243, Loss_aux 0.165, Train_accy 93.37:  85%|████████▌ | 17/20 [27:34<04:40, 93.58s/it]
Task 2, Epoch 18/20 => Loss 0.408, Loss_clf 0.243, Loss_aux 0.165, Train_accy 93.37:  90%|█████████ | 18/20 [27:34<02:59, 89.67s/it]
Task 2, Epoch 19/20 => Loss 0.385, Loss_clf 0.217, Loss_aux 0.168, Train_accy 93.97:  90%|█████████ | 18/20 [28:55<02:59, 89.67s/it]
Task 2, Epoch 19/20 => Loss 0.385, Loss_clf 0.217, Loss_aux 0.168, Train_accy 93.97:  95%|█████████▌| 19/20 [28:55<01:26, 86.92s/it]
Task 2, Epoch 20/20 => Loss 0.425, Loss_clf 0.245, Loss_aux 0.180, Train_accy 93.15:  95%|█████████▌| 19/20 [30:15<01:26, 86.92s/it]
Task 2, Epoch 20/20 => Loss 0.425, Loss_clf 0.245, Loss_aux 0.180, Train_accy 93.15: 100%|██████████| 20/20 [30:15<00:00, 85.04s/it]
Task 2, Epoch 20/20 => Loss 0.425, Loss_clf 0.245, Loss_aux 0.180, Train_accy 93.15: 100%|██████████| 20/20 [30:15<00:00, 90.79s/it]
2024-04-20 18:38:23,806 [der.py] => Task 2, Epoch 20/20 => Loss 0.425, Loss_clf 0.245, Loss_aux 0.180, Train_accy 93.15
2024-04-20 18:38:23,807 [base.py] => Reducing exemplars...(28 per classes)
2024-04-20 18:38:57,146 [base.py] => Constructing exemplars...(28 per classes)
2024-04-20 18:41:29,514 [der.py] => Exemplar size: 1960
2024-04-20 18:41:29,514 [trainer.py] => CNN: {'total': 89.89, '00-49': 89.28, '50-59': 84.8, '60-69': 98.0, 'old': 88.53, 'new': 98.0}
2024-04-20 18:41:29,514 [trainer.py] => NME: {'total': 91.49, '00-49': 91.16, '50-59': 90.1, '60-69': 94.5, 'old': 90.98, 'new': 94.5}
2024-04-20 18:41:29,514 [trainer.py] => CNN top1 curve: [93.6, 90.82, 89.89]
2024-04-20 18:41:29,514 [trainer.py] => CNN top5 curve: [99.36, 98.92, 98.73]
2024-04-20 18:41:29,514 [trainer.py] => NME top1 curve: [93.3, 92.35, 91.49]
2024-04-20 18:41:29,514 [trainer.py] => NME top5 curve: [99.5, 99.4, 99.26]

Average Accuracy (CNN): 91.44
Average Accuracy (NME): 92.38
2024-04-20 18:41:29,515 [trainer.py] => Average Accuracy (CNN): 91.44
2024-04-20 18:41:29,515 [trainer.py] => Average Accuracy (NME): 92.38
2024-04-20 18:41:29,515 [trainer.py] => Train Time: 6653.64
2024-04-20 18:41:29,515 [trainer.py] => Test Time: 192.85 

2024-04-20 18:41:29,517 [trainer.py] => All params: 257565777
2024-04-20 18:41:29,519 [trainer.py] => Trainable params: 85968465
2024-04-20 18:41:40,310 [der.py] => Learning on 70-80
2024-04-20 18:41:40,317 [der.py] => All params: 343448923
2024-04-20 18:41:40,319 [der.py] => Trainable params: 86052955

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.849, Loss_clf 1.163, Loss_aux 0.687, Train_accy 77.92, Test_accy 83.60:   0%|          | 0/20 [02:54<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.849, Loss_clf 1.163, Loss_aux 0.687, Train_accy 77.92, Test_accy 83.60:   5%|▌         | 1/20 [02:54<55:18, 174.64s/it]
Task 3, Epoch 2/20 => Loss 0.840, Loss_clf 0.461, Loss_aux 0.379, Train_accy 86.18:   5%|▌         | 1/20 [04:31<55:18, 174.64s/it]                 
Task 3, Epoch 2/20 => Loss 0.840, Loss_clf 0.461, Loss_aux 0.379, Train_accy 86.18:  10%|█         | 2/20 [04:31<38:37, 128.75s/it]
Task 3, Epoch 3/20 => Loss 0.748, Loss_clf 0.416, Loss_aux 0.333, Train_accy 87.74:  10%|█         | 2/20 [06:07<38:37, 128.75s/it]
Task 3, Epoch 3/20 => Loss 0.748, Loss_clf 0.416, Loss_aux 0.333, Train_accy 87.74:  15%|█▌        | 3/20 [06:07<32:19, 114.07s/it]
Task 3, Epoch 4/20 => Loss 0.643, Loss_clf 0.356, Loss_aux 0.287, Train_accy 89.09:  15%|█▌        | 3/20 [07:44<32:19, 114.07s/it]
Task 3, Epoch 4/20 => Loss 0.643, Loss_clf 0.356, Loss_aux 0.287, Train_accy 89.09:  20%|██        | 4/20 [07:44<28:35, 107.20s/it]
Task 3, Epoch 5/20 => Loss 0.607, Loss_clf 0.337, Loss_aux 0.270, Train_accy 90.34:  20%|██        | 4/20 [09:20<28:35, 107.20s/it]
Task 3, Epoch 5/20 => Loss 0.607, Loss_clf 0.337, Loss_aux 0.270, Train_accy 90.34:  25%|██▌       | 5/20 [09:20<25:49, 103.32s/it]
Task 3, Epoch 6/20 => Loss 0.597, Loss_clf 0.322, Loss_aux 0.275, Train_accy 90.91, Test_accy 85.38:  25%|██▌       | 5/20 [12:14<25:49, 103.32s/it]
Task 3, Epoch 6/20 => Loss 0.597, Loss_clf 0.322, Loss_aux 0.275, Train_accy 90.91, Test_accy 85.38:  30%|███       | 6/20 [12:14<29:40, 127.20s/it]
Task 3, Epoch 7/20 => Loss 0.578, Loss_clf 0.325, Loss_aux 0.253, Train_accy 90.69:  30%|███       | 6/20 [13:50<29:40, 127.20s/it]                 
Task 3, Epoch 7/20 => Loss 0.578, Loss_clf 0.325, Loss_aux 0.253, Train_accy 90.69:  35%|███▌      | 7/20 [13:50<25:21, 117.01s/it]
Task 3, Epoch 8/20 => Loss 0.565, Loss_clf 0.317, Loss_aux 0.248, Train_accy 90.75:  35%|███▌      | 7/20 [15:26<25:21, 117.01s/it]
Task 3, Epoch 8/20 => Loss 0.565, Loss_clf 0.317, Loss_aux 0.248, Train_accy 90.75:  40%|████      | 8/20 [15:26<22:03, 110.30s/it]
Task 3, Epoch 9/20 => Loss 0.534, Loss_clf 0.293, Loss_aux 0.241, Train_accy 91.45:  40%|████      | 8/20 [17:02<22:03, 110.30s/it]
Task 3, Epoch 9/20 => Loss 0.534, Loss_clf 0.293, Loss_aux 0.241, Train_accy 91.45:  45%|████▌     | 9/20 [17:02<19:23, 105.78s/it]
Task 3, Epoch 10/20 => Loss 0.538, Loss_clf 0.301, Loss_aux 0.236, Train_accy 91.36:  45%|████▌     | 9/20 [18:38<19:23, 105.78s/it]
Task 3, Epoch 10/20 => Loss 0.538, Loss_clf 0.301, Loss_aux 0.236, Train_accy 91.36:  50%|█████     | 10/20 [18:38<17:07, 102.73s/it]
Task 3, Epoch 11/20 => Loss 0.532, Loss_clf 0.294, Loss_aux 0.238, Train_accy 91.42, Test_accy 84.24:  50%|█████     | 10/20 [21:31<17:07, 102.73s/it]
Task 3, Epoch 11/20 => Loss 0.532, Loss_clf 0.294, Loss_aux 0.238, Train_accy 91.42, Test_accy 84.24:  55%|█████▌    | 11/20 [21:31<18:37, 124.22s/it]
Task 3, Epoch 12/20 => Loss 0.508, Loss_clf 0.284, Loss_aux 0.224, Train_accy 92.05:  55%|█████▌    | 11/20 [23:06<18:37, 124.22s/it]                 
Task 3, Epoch 12/20 => Loss 0.508, Loss_clf 0.284, Loss_aux 0.224, Train_accy 92.05:  60%|██████    | 12/20 [23:06<15:24, 115.54s/it]
Task 3, Epoch 13/20 => Loss 0.497, Loss_clf 0.286, Loss_aux 0.211, Train_accy 92.26:  60%|██████    | 12/20 [24:42<15:24, 115.54s/it]
Task 3, Epoch 13/20 => Loss 0.497, Loss_clf 0.286, Loss_aux 0.211, Train_accy 92.26:  65%|██████▌   | 13/20 [24:42<12:46, 109.49s/it]
Task 3, Epoch 14/20 => Loss 0.499, Loss_clf 0.276, Loss_aux 0.223, Train_accy 92.13:  65%|██████▌   | 13/20 [26:17<12:46, 109.49s/it]
Task 3, Epoch 14/20 => Loss 0.499, Loss_clf 0.276, Loss_aux 0.223, Train_accy 92.13:  70%|███████   | 14/20 [26:17<10:31, 105.28s/it]
Task 3, Epoch 15/20 => Loss 0.475, Loss_clf 0.260, Loss_aux 0.215, Train_accy 92.61:  70%|███████   | 14/20 [27:54<10:31, 105.28s/it]
Task 3, Epoch 15/20 => Loss 0.475, Loss_clf 0.260, Loss_aux 0.215, Train_accy 92.61:  75%|███████▌  | 15/20 [27:54<08:33, 102.77s/it]
Task 3, Epoch 16/20 => Loss 0.504, Loss_clf 0.288, Loss_aux 0.215, Train_accy 91.87, Test_accy 84.61:  75%|███████▌  | 15/20 [30:48<08:33, 102.77s/it]
Task 3, Epoch 16/20 => Loss 0.504, Loss_clf 0.288, Loss_aux 0.215, Train_accy 91.87, Test_accy 84.61:  80%|████████  | 16/20 [30:48<08:16, 124.12s/it]
Task 3, Epoch 17/20 => Loss 0.462, Loss_clf 0.263, Loss_aux 0.199, Train_accy 92.84:  80%|████████  | 16/20 [32:25<08:16, 124.12s/it]                 
Task 3, Epoch 17/20 => Loss 0.462, Loss_clf 0.263, Loss_aux 0.199, Train_accy 92.84:  85%|████████▌ | 17/20 [32:25<05:47, 115.81s/it]
Task 3, Epoch 18/20 => Loss 0.473, Loss_clf 0.265, Loss_aux 0.208, Train_accy 92.69:  85%|████████▌ | 17/20 [34:01<05:47, 115.81s/it]
Task 3, Epoch 18/20 => Loss 0.473, Loss_clf 0.265, Loss_aux 0.208, Train_accy 92.69:  90%|█████████ | 18/20 [34:01<03:39, 109.92s/it]
Task 3, Epoch 19/20 => Loss 0.486, Loss_clf 0.271, Loss_aux 0.215, Train_accy 92.04:  90%|█████████ | 18/20 [35:37<03:39, 109.92s/it]
Task 3, Epoch 19/20 => Loss 0.486, Loss_clf 0.271, Loss_aux 0.215, Train_accy 92.04:  95%|█████████▌| 19/20 [35:37<01:45, 105.76s/it]
Task 3, Epoch 20/20 => Loss 0.453, Loss_clf 0.255, Loss_aux 0.198, Train_accy 92.64:  95%|█████████▌| 19/20 [37:13<01:45, 105.76s/it]
Task 3, Epoch 20/20 => Loss 0.453, Loss_clf 0.255, Loss_aux 0.198, Train_accy 92.64: 100%|██████████| 20/20 [37:13<00:00, 102.87s/it]
Task 3, Epoch 20/20 => Loss 0.453, Loss_clf 0.255, Loss_aux 0.198, Train_accy 92.64: 100%|██████████| 20/20 [37:13<00:00, 111.68s/it]
2024-04-20 19:18:54,040 [der.py] => Task 3, Epoch 20/20 => Loss 0.453, Loss_clf 0.255, Loss_aux 0.198, Train_accy 92.64
2024-04-20 19:18:54,041 [base.py] => Reducing exemplars...(25 per classes)
2024-04-20 19:19:33,195 [base.py] => Constructing exemplars...(25 per classes)
2024-04-20 19:23:06,702 [der.py] => Exemplar size: 2000
2024-04-20 19:23:06,702 [trainer.py] => CNN: {'total': 84.42, '00-49': 84.8, '50-59': 70.1, '60-69': 86.1, '70-79': 95.2, 'old': 82.89, 'new': 95.2}
2024-04-20 19:23:06,702 [trainer.py] => NME: {'total': 88.34, '00-49': 89.34, '50-59': 81.5, '60-69': 89.3, '70-79': 89.2, 'old': 88.21, 'new': 89.2}
2024-04-20 19:23:06,702 [trainer.py] => CNN top1 curve: [93.6, 90.82, 89.89, 84.42]
2024-04-20 19:23:06,702 [trainer.py] => CNN top5 curve: [99.36, 98.92, 98.73, 97.79]
2024-04-20 19:23:06,702 [trainer.py] => NME top1 curve: [93.3, 92.35, 91.49, 88.34]
2024-04-20 19:23:06,702 [trainer.py] => NME top5 curve: [99.5, 99.4, 99.26, 98.88]

Average Accuracy (CNN): 89.68
Average Accuracy (NME): 91.37
2024-04-20 19:23:06,702 [trainer.py] => Average Accuracy (CNN): 89.68
2024-04-20 19:23:06,703 [trainer.py] => Average Accuracy (NME): 91.37
2024-04-20 19:23:06,703 [trainer.py] => Train Time: 8887.25
2024-04-20 19:23:06,703 [trainer.py] => Test Time: 348.43 

2024-04-20 19:23:06,706 [trainer.py] => All params: 343448923
2024-04-20 19:23:06,708 [trainer.py] => Trainable params: 86052955
2024-04-20 19:23:09,560 [der.py] => Learning on 80-90
2024-04-20 19:23:09,566 [der.py] => All params: 429347429
2024-04-20 19:23:09,569 [der.py] => Trainable params: 86152805

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.662, Loss_clf 1.026, Loss_aux 0.636, Train_accy 79.91, Test_accy 80.93:   0%|          | 0/20 [03:40<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.662, Loss_clf 1.026, Loss_aux 0.636, Train_accy 79.91, Test_accy 80.93:   5%|▌         | 1/20 [03:40<1:09:50, 220.56s/it]
Task 4, Epoch 2/20 => Loss 0.740, Loss_clf 0.398, Loss_aux 0.342, Train_accy 88.63:   5%|▌         | 1/20 [05:34<1:09:50, 220.56s/it]                 
Task 4, Epoch 2/20 => Loss 0.740, Loss_clf 0.398, Loss_aux 0.342, Train_accy 88.63:  10%|█         | 2/20 [05:34<47:17, 157.62s/it]  
Task 4, Epoch 3/20 => Loss 0.686, Loss_clf 0.374, Loss_aux 0.311, Train_accy 89.47:  10%|█         | 2/20 [07:27<47:17, 157.62s/it]
Task 4, Epoch 3/20 => Loss 0.686, Loss_clf 0.374, Loss_aux 0.311, Train_accy 89.47:  15%|█▌        | 3/20 [07:27<38:55, 137.36s/it]
Task 4, Epoch 4/20 => Loss 0.624, Loss_clf 0.339, Loss_aux 0.285, Train_accy 90.27:  15%|█▌        | 3/20 [09:20<38:55, 137.36s/it]
Task 4, Epoch 4/20 => Loss 0.624, Loss_clf 0.339, Loss_aux 0.285, Train_accy 90.27:  20%|██        | 4/20 [09:20<34:04, 127.80s/it]
Task 4, Epoch 5/20 => Loss 0.589, Loss_clf 0.317, Loss_aux 0.271, Train_accy 90.57:  20%|██        | 4/20 [11:13<34:04, 127.80s/it]
Task 4, Epoch 5/20 => Loss 0.589, Loss_clf 0.317, Loss_aux 0.271, Train_accy 90.57:  25%|██▌       | 5/20 [11:13<30:36, 122.46s/it]
Task 4, Epoch 6/20 => Loss 0.574, Loss_clf 0.312, Loss_aux 0.262, Train_accy 91.37, Test_accy 83.38:  25%|██▌       | 5/20 [14:55<30:36, 122.46s/it]
Task 4, Epoch 6/20 => Loss 0.574, Loss_clf 0.312, Loss_aux 0.262, Train_accy 91.37, Test_accy 83.38:  30%|███       | 6/20 [14:55<36:29, 156.36s/it]
Task 4, Epoch 7/20 => Loss 0.560, Loss_clf 0.311, Loss_aux 0.249, Train_accy 91.17:  30%|███       | 6/20 [16:49<36:29, 156.36s/it]                 
Task 4, Epoch 7/20 => Loss 0.560, Loss_clf 0.311, Loss_aux 0.249, Train_accy 91.17:  35%|███▌      | 7/20 [16:49<30:50, 142.33s/it]
Task 4, Epoch 8/20 => Loss 0.564, Loss_clf 0.310, Loss_aux 0.254, Train_accy 91.16:  35%|███▌      | 7/20 [18:42<30:50, 142.33s/it]
Task 4, Epoch 8/20 => Loss 0.564, Loss_clf 0.310, Loss_aux 0.254, Train_accy 91.16:  40%|████      | 8/20 [18:42<26:38, 133.23s/it]
Task 4, Epoch 9/20 => Loss 0.521, Loss_clf 0.282, Loss_aux 0.239, Train_accy 91.87:  40%|████      | 8/20 [20:37<26:38, 133.23s/it]
Task 4, Epoch 9/20 => Loss 0.521, Loss_clf 0.282, Loss_aux 0.239, Train_accy 91.87:  45%|████▌     | 9/20 [20:37<23:21, 127.39s/it]
Task 4, Epoch 10/20 => Loss 0.491, Loss_clf 0.272, Loss_aux 0.219, Train_accy 92.13:  45%|████▌     | 9/20 [22:30<23:21, 127.39s/it]
Task 4, Epoch 10/20 => Loss 0.491, Loss_clf 0.272, Loss_aux 0.219, Train_accy 92.13:  50%|█████     | 10/20 [22:30<20:30, 123.03s/it]
Task 4, Epoch 11/20 => Loss 0.490, Loss_clf 0.274, Loss_aux 0.215, Train_accy 92.34, Test_accy 83.81:  50%|█████     | 10/20 [26:12<20:30, 123.03s/it]
Task 4, Epoch 11/20 => Loss 0.490, Loss_clf 0.274, Loss_aux 0.215, Train_accy 92.34, Test_accy 83.81:  55%|█████▌    | 11/20 [26:12<22:58, 153.20s/it]
Task 4, Epoch 12/20 => Loss 0.506, Loss_clf 0.292, Loss_aux 0.214, Train_accy 92.01:  55%|█████▌    | 11/20 [28:05<22:58, 153.20s/it]                 
Task 4, Epoch 12/20 => Loss 0.506, Loss_clf 0.292, Loss_aux 0.214, Train_accy 92.01:  60%|██████    | 12/20 [28:05<18:48, 141.04s/it]
Task 4, Epoch 13/20 => Loss 0.487, Loss_clf 0.270, Loss_aux 0.217, Train_accy 92.44:  60%|██████    | 12/20 [29:58<18:48, 141.04s/it]
Task 4, Epoch 13/20 => Loss 0.487, Loss_clf 0.270, Loss_aux 0.217, Train_accy 92.44:  65%|██████▌   | 13/20 [29:58<15:27, 132.51s/it]
Task 4, Epoch 14/20 => Loss 0.474, Loss_clf 0.271, Loss_aux 0.203, Train_accy 92.50:  65%|██████▌   | 13/20 [31:51<15:27, 132.51s/it]
Task 4, Epoch 14/20 => Loss 0.474, Loss_clf 0.271, Loss_aux 0.203, Train_accy 92.50:  70%|███████   | 14/20 [31:51<12:39, 126.58s/it]
Task 4, Epoch 15/20 => Loss 0.483, Loss_clf 0.273, Loss_aux 0.210, Train_accy 92.61:  70%|███████   | 14/20 [33:44<12:39, 126.58s/it]
Task 4, Epoch 15/20 => Loss 0.483, Loss_clf 0.273, Loss_aux 0.210, Train_accy 92.61:  75%|███████▌  | 15/20 [33:44<10:12, 122.44s/it]
Task 4, Epoch 16/20 => Loss 0.482, Loss_clf 0.274, Loss_aux 0.208, Train_accy 92.60, Test_accy 83.82:  75%|███████▌  | 15/20 [37:24<10:12, 122.44s/it]
Task 4, Epoch 16/20 => Loss 0.482, Loss_clf 0.274, Loss_aux 0.208, Train_accy 92.60, Test_accy 83.82:  80%|████████  | 16/20 [37:24<10:07, 151.99s/it]
Task 4, Epoch 17/20 => Loss 0.461, Loss_clf 0.256, Loss_aux 0.205, Train_accy 92.80:  80%|████████  | 16/20 [39:16<10:07, 151.99s/it]                 
Task 4, Epoch 17/20 => Loss 0.461, Loss_clf 0.256, Loss_aux 0.205, Train_accy 92.80:  85%|████████▌ | 17/20 [39:16<06:59, 139.95s/it]
Task 4, Epoch 18/20 => Loss 0.436, Loss_clf 0.253, Loss_aux 0.183, Train_accy 93.06:  85%|████████▌ | 17/20 [41:08<06:59, 139.95s/it]
Task 4, Epoch 18/20 => Loss 0.436, Loss_clf 0.253, Loss_aux 0.183, Train_accy 93.06:  90%|█████████ | 18/20 [41:08<04:23, 131.52s/it]
Task 4, Epoch 19/20 => Loss 0.429, Loss_clf 0.240, Loss_aux 0.189, Train_accy 93.49:  90%|█████████ | 18/20 [43:00<04:23, 131.52s/it]
Task 4, Epoch 19/20 => Loss 0.429, Loss_clf 0.240, Loss_aux 0.189, Train_accy 93.49:  95%|█████████▌| 19/20 [43:00<02:05, 125.62s/it]
Task 4, Epoch 20/20 => Loss 0.455, Loss_clf 0.256, Loss_aux 0.199, Train_accy 92.79:  95%|█████████▌| 19/20 [44:52<02:05, 125.62s/it]
Task 4, Epoch 20/20 => Loss 0.455, Loss_clf 0.256, Loss_aux 0.199, Train_accy 92.79: 100%|██████████| 20/20 [44:52<00:00, 121.53s/it]
Task 4, Epoch 20/20 => Loss 0.455, Loss_clf 0.256, Loss_aux 0.199, Train_accy 92.79: 100%|██████████| 20/20 [44:52<00:00, 134.62s/it]
2024-04-20 20:08:02,182 [der.py] => Task 4, Epoch 20/20 => Loss 0.455, Loss_clf 0.256, Loss_aux 0.199, Train_accy 92.79
2024-04-20 20:08:02,183 [base.py] => Reducing exemplars...(22 per classes)
2024-04-20 20:08:46,733 [base.py] => Constructing exemplars...(22 per classes)
2024-04-20 20:13:33,181 [der.py] => Exemplar size: 1980
2024-04-20 20:13:33,181 [trainer.py] => CNN: {'total': 83.13, '00-49': 82.1, '50-59': 73.0, '60-69': 83.6, '70-79': 84.1, '80-89': 97.0, 'old': 81.4, 'new': 97.0}
2024-04-20 20:13:33,181 [trainer.py] => NME: {'total': 86.97, '00-49': 86.58, '50-59': 81.1, '60-69': 88.9, '70-79': 88.9, '80-89': 90.9, 'old': 86.48, 'new': 90.9}
2024-04-20 20:13:33,181 [trainer.py] => CNN top1 curve: [93.6, 90.82, 89.89, 84.42, 83.13]
2024-04-20 20:13:33,181 [trainer.py] => CNN top5 curve: [99.36, 98.92, 98.73, 97.79, 97.29]
2024-04-20 20:13:33,181 [trainer.py] => NME top1 curve: [93.3, 92.35, 91.49, 88.34, 86.97]
2024-04-20 20:13:33,181 [trainer.py] => NME top5 curve: [99.5, 99.4, 99.26, 98.88, 98.48]

Average Accuracy (CNN): 88.37
Average Accuracy (NME): 90.49
2024-04-20 20:13:33,181 [trainer.py] => Average Accuracy (CNN): 88.37
2024-04-20 20:13:33,181 [trainer.py] => Average Accuracy (NME): 90.49
2024-04-20 20:13:33,181 [trainer.py] => Train Time: 11579.75
2024-04-20 20:13:33,181 [trainer.py] => Test Time: 564.98 

2024-04-20 20:13:33,184 [trainer.py] => All params: 429347429
2024-04-20 20:13:33,186 [trainer.py] => Trainable params: 86152805
2024-04-20 20:13:34,704 [der.py] => Learning on 90-100
2024-04-20 20:13:34,710 [der.py] => All params: 515261295
2024-04-20 20:13:34,713 [der.py] => Trainable params: 86268015

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.801, Loss_clf 1.130, Loss_aux 0.671, Train_accy 78.80, Test_accy 80.86:   0%|          | 0/20 [04:30<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.801, Loss_clf 1.130, Loss_aux 0.671, Train_accy 78.80, Test_accy 80.86:   5%|▌         | 1/20 [04:30<1:25:32, 270.15s/it]
Task 5, Epoch 2/20 => Loss 0.791, Loss_clf 0.445, Loss_aux 0.347, Train_accy 87.72:   5%|▌         | 1/20 [06:38<1:25:32, 270.15s/it]                 
Task 5, Epoch 2/20 => Loss 0.791, Loss_clf 0.445, Loss_aux 0.347, Train_accy 87.72:  10%|█         | 2/20 [06:38<55:56, 186.45s/it]  
Task 5, Epoch 3/20 => Loss 0.665, Loss_clf 0.362, Loss_aux 0.303, Train_accy 89.47:  10%|█         | 2/20 [08:46<55:56, 186.45s/it]
Task 5, Epoch 3/20 => Loss 0.665, Loss_clf 0.362, Loss_aux 0.303, Train_accy 89.47:  15%|█▌        | 3/20 [08:46<45:17, 159.83s/it]
Task 5, Epoch 4/20 => Loss 0.625, Loss_clf 0.346, Loss_aux 0.279, Train_accy 90.52:  15%|█▌        | 3/20 [10:53<45:17, 159.83s/it]
Task 5, Epoch 4/20 => Loss 0.625, Loss_clf 0.346, Loss_aux 0.279, Train_accy 90.52:  20%|██        | 4/20 [10:53<39:15, 147.19s/it]
Task 5, Epoch 5/20 => Loss 0.598, Loss_clf 0.328, Loss_aux 0.270, Train_accy 90.10:  20%|██        | 4/20 [13:01<39:15, 147.19s/it]
Task 5, Epoch 5/20 => Loss 0.598, Loss_clf 0.328, Loss_aux 0.270, Train_accy 90.10:  25%|██▌       | 5/20 [13:01<35:03, 140.25s/it]
Task 5, Epoch 6/20 => Loss 0.570, Loss_clf 0.309, Loss_aux 0.262, Train_accy 91.05, Test_accy 81.47:  25%|██▌       | 5/20 [17:32<35:03, 140.25s/it]
Task 5, Epoch 6/20 => Loss 0.570, Loss_clf 0.309, Loss_aux 0.262, Train_accy 91.05, Test_accy 81.47:  30%|███       | 6/20 [17:32<43:04, 184.62s/it]
Task 5, Epoch 7/20 => Loss 0.570, Loss_clf 0.319, Loss_aux 0.251, Train_accy 90.69:  30%|███       | 6/20 [19:40<43:04, 184.62s/it]                 
Task 5, Epoch 7/20 => Loss 0.570, Loss_clf 0.319, Loss_aux 0.251, Train_accy 90.69:  35%|███▌      | 7/20 [19:40<35:59, 166.15s/it]
Task 5, Epoch 8/20 => Loss 0.558, Loss_clf 0.311, Loss_aux 0.247, Train_accy 91.16:  35%|███▌      | 7/20 [21:49<35:59, 166.15s/it]
Task 5, Epoch 8/20 => Loss 0.558, Loss_clf 0.311, Loss_aux 0.247, Train_accy 91.16:  40%|████      | 8/20 [21:49<30:49, 154.14s/it]
Task 5, Epoch 9/20 => Loss 0.533, Loss_clf 0.301, Loss_aux 0.231, Train_accy 91.76:  40%|████      | 8/20 [23:57<30:49, 154.14s/it]
Task 5, Epoch 9/20 => Loss 0.533, Loss_clf 0.301, Loss_aux 0.231, Train_accy 91.76:  45%|████▌     | 9/20 [23:57<26:46, 146.01s/it]
Task 5, Epoch 10/20 => Loss 0.480, Loss_clf 0.265, Loss_aux 0.215, Train_accy 92.16:  45%|████▌     | 9/20 [26:05<26:46, 146.01s/it]
Task 5, Epoch 10/20 => Loss 0.480, Loss_clf 0.265, Loss_aux 0.215, Train_accy 92.16:  50%|█████     | 10/20 [26:05<23:24, 140.45s/it]
Task 5, Epoch 11/20 => Loss 0.493, Loss_clf 0.279, Loss_aux 0.214, Train_accy 92.25, Test_accy 82.48:  50%|█████     | 10/20 [30:35<23:24, 140.45s/it]
Task 5, Epoch 11/20 => Loss 0.493, Loss_clf 0.279, Loss_aux 0.214, Train_accy 92.25, Test_accy 82.48:  55%|█████▌    | 11/20 [30:35<27:02, 180.24s/it]
Task 5, Epoch 12/20 => Loss 0.491, Loss_clf 0.277, Loss_aux 0.215, Train_accy 92.15:  55%|█████▌    | 11/20 [32:43<27:02, 180.24s/it]                 
Task 5, Epoch 12/20 => Loss 0.491, Loss_clf 0.277, Loss_aux 0.215, Train_accy 92.15:  60%|██████    | 12/20 [32:43<21:55, 164.38s/it]
Task 5, Epoch 13/20 => Loss 0.486, Loss_clf 0.273, Loss_aux 0.212, Train_accy 92.42:  60%|██████    | 12/20 [34:51<21:55, 164.38s/it]
Task 5, Epoch 13/20 => Loss 0.486, Loss_clf 0.273, Loss_aux 0.212, Train_accy 92.42:  65%|██████▌   | 13/20 [34:51<17:53, 153.36s/it]
Task 5, Epoch 14/20 => Loss 0.508, Loss_clf 0.289, Loss_aux 0.219, Train_accy 92.19:  65%|██████▌   | 13/20 [36:59<17:53, 153.36s/it]
Task 5, Epoch 14/20 => Loss 0.508, Loss_clf 0.289, Loss_aux 0.219, Train_accy 92.19:  70%|███████   | 14/20 [36:59<14:34, 145.71s/it]
Task 5, Epoch 15/20 => Loss 0.470, Loss_clf 0.266, Loss_aux 0.204, Train_accy 92.78:  70%|███████   | 14/20 [39:08<14:34, 145.71s/it]
Task 5, Epoch 15/20 => Loss 0.470, Loss_clf 0.266, Loss_aux 0.204, Train_accy 92.78:  75%|███████▌  | 15/20 [39:08<11:42, 140.41s/it]
Task 5, Epoch 16/20 => Loss 0.490, Loss_clf 0.277, Loss_aux 0.213, Train_accy 92.54, Test_accy 81.97:  75%|███████▌  | 15/20 [43:38<11:42, 140.41s/it]
Task 5, Epoch 16/20 => Loss 0.490, Loss_clf 0.277, Loss_aux 0.213, Train_accy 92.54, Test_accy 81.97:  80%|████████  | 16/20 [43:38<11:58, 179.66s/it]
Task 5, Epoch 17/20 => Loss 0.445, Loss_clf 0.257, Loss_aux 0.188, Train_accy 92.55:  80%|████████  | 16/20 [45:47<11:58, 179.66s/it]                 
Task 5, Epoch 17/20 => Loss 0.445, Loss_clf 0.257, Loss_aux 0.188, Train_accy 92.55:  85%|████████▌ | 17/20 [45:47<08:12, 164.19s/it]
Task 5, Epoch 18/20 => Loss 0.456, Loss_clf 0.256, Loss_aux 0.200, Train_accy 92.65:  85%|████████▌ | 17/20 [47:55<08:12, 164.19s/it]
Task 5, Epoch 18/20 => Loss 0.456, Loss_clf 0.256, Loss_aux 0.200, Train_accy 92.65:  90%|█████████ | 18/20 [47:55<05:07, 153.58s/it]
Task 5, Epoch 19/20 => Loss 0.449, Loss_clf 0.259, Loss_aux 0.190, Train_accy 92.91:  90%|█████████ | 18/20 [50:04<05:07, 153.58s/it]
Task 5, Epoch 19/20 => Loss 0.449, Loss_clf 0.259, Loss_aux 0.190, Train_accy 92.91:  95%|█████████▌| 19/20 [50:04<02:26, 146.18s/it]
Task 5, Epoch 20/20 => Loss 0.416, Loss_clf 0.242, Loss_aux 0.174, Train_accy 93.31:  95%|█████████▌| 19/20 [52:13<02:26, 146.18s/it]
Task 5, Epoch 20/20 => Loss 0.416, Loss_clf 0.242, Loss_aux 0.174, Train_accy 93.31: 100%|██████████| 20/20 [52:13<00:00, 140.87s/it]
Task 5, Epoch 20/20 => Loss 0.416, Loss_clf 0.242, Loss_aux 0.174, Train_accy 93.31: 100%|██████████| 20/20 [52:13<00:00, 156.67s/it]
2024-04-20 21:05:48,261 [der.py] => Task 5, Epoch 20/20 => Loss 0.416, Loss_clf 0.242, Loss_aux 0.174, Train_accy 93.31
2024-04-20 21:05:48,262 [base.py] => Reducing exemplars...(20 per classes)
2024-04-20 21:06:41,145 [base.py] => Constructing exemplars...(20 per classes)
2024-04-20 21:12:49,721 [der.py] => Exemplar size: 2000
2024-04-20 21:12:49,721 [trainer.py] => CNN: {'total': 81.33, '00-49': 79.12, '50-59': 67.4, '60-69': 83.4, '70-79': 82.0, '80-89': 88.5, '90-99': 96.4, 'old': 79.66, 'new': 96.4}
2024-04-20 21:12:49,721 [trainer.py] => NME: {'total': 85.92, '00-49': 85.06, '50-59': 78.3, '60-69': 88.0, '70-79': 86.2, '80-89': 91.5, '90-99': 89.9, 'old': 85.48, 'new': 89.9}
2024-04-20 21:12:49,721 [trainer.py] => CNN top1 curve: [93.6, 90.82, 89.89, 84.42, 83.13, 81.33]
2024-04-20 21:12:49,721 [trainer.py] => CNN top5 curve: [99.36, 98.92, 98.73, 97.79, 97.29, 96.2]
2024-04-20 21:12:49,721 [trainer.py] => NME top1 curve: [93.3, 92.35, 91.49, 88.34, 86.97, 85.92]
2024-04-20 21:12:49,721 [trainer.py] => NME top5 curve: [99.5, 99.4, 99.26, 98.88, 98.48, 97.94]

Average Accuracy (CNN): 87.2
Average Accuracy (NME): 89.73
2024-04-20 21:12:49,721 [trainer.py] => Average Accuracy (CNN): 87.2
2024-04-20 21:12:49,722 [trainer.py] => Average Accuracy (NME): 89.73
2024-04-20 21:12:49,722 [trainer.py] => Train Time: 14713.24
2024-04-20 21:12:49,722 [trainer.py] => Test Time: 852.06 

Accuracy Matrix (CNN):
[[93.6  89.6  89.28 84.8  82.1  79.12]
 [ 0.   96.9  84.8  70.1  73.   67.4 ]
 [ 0.    0.   98.   86.1  83.6  83.4 ]
 [ 0.    0.    0.   95.2  84.1  82.  ]
 [ 0.    0.    0.    0.   97.   88.5 ]
 [ 0.    0.    0.    0.    0.   96.4 ]]
2024-04-20 21:12:49,722 [trainer.py] => Forgetting (CNN): 16.055999999999997
Accuracy Matrix (NME):
[[93.3  92.   91.16 89.34 86.58 85.06]
 [ 0.   94.1  90.1  81.5  81.1  78.3 ]
 [ 0.    0.   94.5  89.3  88.9  88.  ]
 [ 0.    0.    0.   89.2  88.9  86.2 ]
 [ 0.    0.    0.    0.   90.9  91.5 ]
 [ 0.    0.    0.    0.    0.   89.9 ]]
2024-04-20 21:12:49,723 [trainer.py] => Forgetting (NME): 6.707999999999998

nohup: 忽略输入
2024-04-20 19:58:25,135 [trainer.py] => config: ./exps/foster_B50.json
2024-04-20 19:58:25,135 [trainer.py] => prefix: cil
2024-04-20 19:58:25,135 [trainer.py] => dataset: cifar224
2024-04-20 19:58:25,135 [trainer.py] => memory_size: 2000
2024-04-20 19:58:25,135 [trainer.py] => memory_per_class: 20
2024-04-20 19:58:25,135 [trainer.py] => fixed_memory: True
2024-04-20 19:58:25,135 [trainer.py] => shuffle: True
2024-04-20 19:58:25,135 [trainer.py] => init_cls: 50
2024-04-20 19:58:25,135 [trainer.py] => increment: 10
2024-04-20 19:58:25,135 [trainer.py] => model_name: foster
2024-04-20 19:58:25,135 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-20 19:58:25,135 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-20 19:58:25,135 [trainer.py] => seed: 1993
2024-04-20 19:58:25,135 [trainer.py] => beta1: 0.96
2024-04-20 19:58:25,135 [trainer.py] => beta2: 0.97
2024-04-20 19:58:25,135 [trainer.py] => oofc: ft
2024-04-20 19:58:25,136 [trainer.py] => is_teacher_wa: False
2024-04-20 19:58:25,136 [trainer.py] => is_student_wa: False
2024-04-20 19:58:25,136 [trainer.py] => lambda_okd: 1
2024-04-20 19:58:25,136 [trainer.py] => wa_value: 1
2024-04-20 19:58:25,136 [trainer.py] => init_epochs: 1
2024-04-20 19:58:25,136 [trainer.py] => init_lr: 0.001
2024-04-20 19:58:25,136 [trainer.py] => init_weight_decay: 0.0005
2024-04-20 19:58:25,136 [trainer.py] => boosting_epochs: 1
2024-04-20 19:58:25,136 [trainer.py] => compression_epochs: 1
2024-04-20 19:58:25,136 [trainer.py] => lr: 0.001
2024-04-20 19:58:25,136 [trainer.py] => batch_size: 48
2024-04-20 19:58:25,136 [trainer.py] => weight_decay: 0.0005
2024-04-20 19:58:25,136 [trainer.py] => num_workers: 8
2024-04-20 19:58:25,136 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-04-20 19:58:27,209 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-20 19:58:27,998 [trainer.py] => All params: 0
2024-04-20 19:58:27,998 [trainer.py] => Trainable params: 0
2024-04-20 19:58:32,303 [foster.py] => Learning on 0-50
2024-04-20 19:58:32,304 [foster.py] => All params: 85875556
2024-04-20 19:58:32,304 [foster.py] => Trainable params: 85875556

  0%|          | 0/1 [00:00<?, ?it/s]
Task 0, Epoch 1/1 => Loss 1.483, Train_accy 61.54, Test_accy 91.02:   0%|          | 0/1 [02:50<?, ?it/s]
Task 0, Epoch 1/1 => Loss 1.483, Train_accy 61.54, Test_accy 91.02: 100%|██████████| 1/1 [02:50<00:00, 170.30s/it]
Task 0, Epoch 1/1 => Loss 1.483, Train_accy 61.54, Test_accy 91.02: 100%|██████████| 1/1 [02:50<00:00, 170.30s/it]
2024-04-20 20:01:23,551 [foster.py] => Task 0, Epoch 1/1 => Loss 1.483, Train_accy 61.54, Test_accy 91.02
2024-04-20 20:01:23,552 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-20 20:03:17,905 [foster.py] => Exemplar size: 1000
2024-04-20 20:03:17,906 [trainer.py] => CNN: {'total': 91.02, '00-49': 91.02, 'old': 0, 'new': 91.02}
2024-04-20 20:03:17,906 [trainer.py] => NME: {'total': 91.56, '00-49': 91.56, 'old': 0, 'new': 91.56}
2024-04-20 20:03:17,906 [trainer.py] => CNN top1 curve: [91.02]
2024-04-20 20:03:17,906 [trainer.py] => CNN top5 curve: [98.72]
2024-04-20 20:03:17,906 [trainer.py] => NME top1 curve: [91.56]
2024-04-20 20:03:17,906 [trainer.py] => NME top5 curve: [98.8]

Average Accuracy (CNN): 91.02
Average Accuracy (NME): 91.56
2024-04-20 20:03:17,906 [trainer.py] => Average Accuracy (CNN): 91.02
2024-04-20 20:03:17,906 [trainer.py] => Average Accuracy (NME): 91.56
2024-04-20 20:03:17,906 [trainer.py] => Train Time: 170.82
2024-04-20 20:03:17,906 [trainer.py] => Test Time: 25.26 

2024-04-20 20:03:17,907 [trainer.py] => All params: 85875556
2024-04-20 20:03:17,907 [trainer.py] => Trainable params: 85875556
2024-04-20 20:03:21,370 [foster.py] => Learning on 50-60
2024-04-20 20:03:21,372 [foster.py] => All params: 171774122
2024-04-20 20:03:21,374 [foster.py] => Trainable params: 85937016
2024-04-20 20:03:21,520 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/1 [00:00<?, ?it/s]
Task 1, Epoch 1/1 => Loss 5.328, Loss_clf 0.906, Loss_fe 1.421, Loss_kd 2.501, Train_accy 64.12, Test_accy 88.58:   0%|          | 0/1 [01:20<?, ?it/s]
Task 1, Epoch 1/1 => Loss 5.328, Loss_clf 0.906, Loss_fe 1.421, Loss_kd 2.501, Train_accy 64.12, Test_accy 88.58: 100%|██████████| 1/1 [01:20<00:00, 80.12s/it]
Task 1, Epoch 1/1 => Loss 5.328, Loss_clf 0.906, Loss_fe 1.421, Loss_kd 2.501, Train_accy 64.12, Test_accy 88.58: 100%|██████████| 1/1 [01:20<00:00, 80.12s/it]
2024-04-20 20:04:41,644 [foster.py] => Task 1, Epoch 1/1 => Loss 5.328, Loss_clf 0.906, Loss_fe 1.421, Loss_kd 2.501, Train_accy 64.12, Test_accy 88.58
2024-04-20 20:04:41,646 [foster.py] => do not weight align teacher!
2024-04-20 20:04:41,649 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/1 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/1 => Loss 3.059,  Train_accy 37.75, Test_accy 85.40:   0%|          | 0/1 [01:20<?, ?it/s]
SNet: Task 1, Epoch 1/1 => Loss 3.059,  Train_accy 37.75, Test_accy 85.40: 100%|██████████| 1/1 [01:20<00:00, 80.11s/it]
SNet: Task 1, Epoch 1/1 => Loss 3.059,  Train_accy 37.75, Test_accy 85.40: 100%|██████████| 1/1 [01:20<00:00, 80.12s/it]
2024-04-20 20:06:04,420 [foster.py] => SNet: Task 1, Epoch 1/1 => Loss 3.059,  Train_accy 37.75, Test_accy 85.40
2024-04-20 20:06:04,420 [foster.py] => do not weight align student!
2024-04-20 20:06:19,615 [foster.py] => darknet eval: 
2024-04-20 20:06:19,615 [foster.py] => CNN top1 curve: 85.4
2024-04-20 20:06:19,615 [foster.py] => CNN top5 curve: 98.03
2024-04-20 20:06:19,617 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-20 20:08:03,571 [foster.py] => Exemplar size: 1200
2024-04-20 20:08:03,572 [trainer.py] => CNN: {'total': 88.58, '00-49': 90.84, '50-59': 77.3, 'old': 90.84, 'new': 77.3}
2024-04-20 20:08:03,572 [trainer.py] => NME: {'total': 89.98, '00-49': 90.82, '50-59': 85.8, 'old': 90.82, 'new': 85.8}
2024-04-20 20:08:03,572 [trainer.py] => CNN top1 curve: [91.02, 88.58]
2024-04-20 20:08:03,572 [trainer.py] => CNN top5 curve: [98.72, 98.37]
2024-04-20 20:08:03,572 [trainer.py] => NME top1 curve: [91.56, 89.98]
2024-04-20 20:08:03,572 [trainer.py] => NME top5 curve: [98.8, 98.75]

Average Accuracy (CNN): 89.8
Average Accuracy (NME): 90.77
2024-04-20 20:08:03,572 [trainer.py] => Average Accuracy (CNN): 89.8
2024-04-20 20:08:03,572 [trainer.py] => Average Accuracy (NME): 90.77
2024-04-20 20:08:03,572 [trainer.py] => Train Time: 348.97
2024-04-20 20:08:03,572 [trainer.py] => Test Time: 83.07000000000001 

2024-04-20 20:08:03,573 [trainer.py] => All params: 171774122
2024-04-20 20:08:03,574 [trainer.py] => Trainable params: 85937016
2024-04-20 20:08:05,916 [foster.py] => Learning on 60-70
2024-04-20 20:08:05,919 [foster.py] => All params: 171804872
2024-04-20 20:08:05,920 [foster.py] => Trainable params: 85960076
2024-04-20 20:08:06,044 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604]

  0%|          | 0/1 [00:00<?, ?it/s]
Task 2, Epoch 1/1 => Loss 5.316, Loss_clf 0.804, Loss_fe 1.425, Loss_kd 2.646, Train_accy 67.61, Test_accy 86.19:   0%|          | 0/1 [01:26<?, ?it/s]
Task 2, Epoch 1/1 => Loss 5.316, Loss_clf 0.804, Loss_fe 1.425, Loss_kd 2.646, Train_accy 67.61, Test_accy 86.19: 100%|██████████| 1/1 [01:26<00:00, 86.67s/it]
Task 2, Epoch 1/1 => Loss 5.316, Loss_clf 0.804, Loss_fe 1.425, Loss_kd 2.646, Train_accy 67.61, Test_accy 86.19: 100%|██████████| 1/1 [01:26<00:00, 86.67s/it]
2024-04-20 20:09:32,719 [foster.py] => Task 2, Epoch 1/1 => Loss 5.316, Loss_clf 0.804, Loss_fe 1.425, Loss_kd 2.646, Train_accy 67.61, Test_accy 86.19
2024-04-20 20:09:32,720 [foster.py] => do not weight align teacher!
2024-04-20 20:09:32,721 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102]

  0%|          | 0/1 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/1 => Loss 2.990,  Train_accy 43.31, Test_accy 83.96:   0%|          | 0/1 [01:25<?, ?it/s]
SNet: Task 2, Epoch 1/1 => Loss 2.990,  Train_accy 43.31, Test_accy 83.96: 100%|██████████| 1/1 [01:25<00:00, 85.02s/it]
SNet: Task 2, Epoch 1/1 => Loss 2.990,  Train_accy 43.31, Test_accy 83.96: 100%|██████████| 1/1 [01:25<00:00, 85.02s/it]
2024-04-20 20:10:59,828 [foster.py] => SNet: Task 2, Epoch 1/1 => Loss 2.990,  Train_accy 43.31, Test_accy 83.96
2024-04-20 20:10:59,828 [foster.py] => do not weight align student!
2024-04-20 20:11:17,638 [foster.py] => darknet eval: 
2024-04-20 20:11:17,638 [foster.py] => CNN top1 curve: 83.96
2024-04-20 20:11:17,638 [foster.py] => CNN top5 curve: 97.96
2024-04-20 20:11:17,641 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-20 20:13:17,232 [foster.py] => Exemplar size: 1400
2024-04-20 20:13:17,233 [trainer.py] => CNN: {'total': 86.19, '00-49': 90.76, '50-59': 70.8, '60-69': 78.7, 'old': 87.43, 'new': 78.7}
2024-04-20 20:13:17,233 [trainer.py] => NME: {'total': 89.17, '00-49': 90.68, '50-59': 79.9, '60-69': 90.9, 'old': 88.88, 'new': 90.9}
2024-04-20 20:13:17,233 [trainer.py] => CNN top1 curve: [91.02, 88.58, 86.19]
2024-04-20 20:13:17,233 [trainer.py] => CNN top5 curve: [98.72, 98.37, 98.2]
2024-04-20 20:13:17,233 [trainer.py] => NME top1 curve: [91.56, 89.98, 89.17]
2024-04-20 20:13:17,233 [trainer.py] => NME top5 curve: [98.8, 98.75, 98.36]

Average Accuracy (CNN): 88.6
Average Accuracy (NME): 90.24
2024-04-20 20:13:17,233 [trainer.py] => Average Accuracy (CNN): 88.6
2024-04-20 20:13:17,233 [trainer.py] => Average Accuracy (NME): 90.24
2024-04-20 20:13:17,233 [trainer.py] => Train Time: 540.62
2024-04-20 20:13:17,233 [trainer.py] => Test Time: 150.60000000000002 

2024-04-20 20:13:17,235 [trainer.py] => All params: 171804872
2024-04-20 20:13:17,236 [trainer.py] => Trainable params: 85960076
2024-04-20 20:13:19,120 [foster.py] => Learning on 70-80
2024-04-20 20:13:19,122 [foster.py] => All params: 171835622
2024-04-20 20:13:19,123 [foster.py] => Trainable params: 85983136
2024-04-20 20:13:19,245 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006]

  0%|          | 0/1 [00:00<?, ?it/s]
Task 3, Epoch 1/1 => Loss 5.948, Loss_clf 1.041, Loss_fe 1.725, Loss_kd 2.785, Train_accy 54.77, Test_accy 81.74:   0%|          | 0/1 [01:33<?, ?it/s]
Task 3, Epoch 1/1 => Loss 5.948, Loss_clf 1.041, Loss_fe 1.725, Loss_kd 2.785, Train_accy 54.77, Test_accy 81.74: 100%|██████████| 1/1 [01:33<00:00, 93.16s/it]
Task 3, Epoch 1/1 => Loss 5.948, Loss_clf 1.041, Loss_fe 1.725, Loss_kd 2.785, Train_accy 54.77, Test_accy 81.74: 100%|██████████| 1/1 [01:33<00:00, 93.16s/it]
2024-04-20 20:14:52,408 [foster.py] => Task 3, Epoch 1/1 => Loss 5.948, Loss_clf 1.041, Loss_fe 1.725, Loss_kd 2.785, Train_accy 54.77, Test_accy 81.74
2024-04-20 20:14:52,408 [foster.py] => do not weight align teacher!
2024-04-20 20:14:52,410 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755]

  0%|          | 0/1 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/1 => Loss 3.249,  Train_accy 27.52, Test_accy 79.25:   0%|          | 0/1 [01:29<?, ?it/s]
SNet: Task 3, Epoch 1/1 => Loss 3.249,  Train_accy 27.52, Test_accy 79.25: 100%|██████████| 1/1 [01:29<00:00, 89.73s/it]
SNet: Task 3, Epoch 1/1 => Loss 3.249,  Train_accy 27.52, Test_accy 79.25: 100%|██████████| 1/1 [01:29<00:00, 89.73s/it]
2024-04-20 20:16:24,661 [foster.py] => SNet: Task 3, Epoch 1/1 => Loss 3.249,  Train_accy 27.52, Test_accy 79.25
2024-04-20 20:16:24,662 [foster.py] => do not weight align student!
2024-04-20 20:16:45,233 [foster.py] => darknet eval: 
2024-04-20 20:16:45,233 [foster.py] => CNN top1 curve: 79.25
2024-04-20 20:16:45,233 [foster.py] => CNN top5 curve: 97.0
2024-04-20 20:16:45,235 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-20 20:18:59,070 [foster.py] => Exemplar size: 1600
2024-04-20 20:18:59,071 [trainer.py] => CNN: {'total': 81.74, '00-49': 90.2, '50-59': 71.9, '60-69': 72.6, '70-79': 58.4, 'old': 85.07, 'new': 58.4}
2024-04-20 20:18:59,071 [trainer.py] => NME: {'total': 86.78, '00-49': 90.52, '50-59': 76.6, '60-69': 85.9, '70-79': 79.1, 'old': 87.87, 'new': 79.1}
2024-04-20 20:18:59,071 [trainer.py] => CNN top1 curve: [91.02, 88.58, 86.19, 81.74]
2024-04-20 20:18:59,071 [trainer.py] => CNN top5 curve: [98.72, 98.37, 98.2, 97.82]
2024-04-20 20:18:59,071 [trainer.py] => NME top1 curve: [91.56, 89.98, 89.17, 86.78]
2024-04-20 20:18:59,071 [trainer.py] => NME top5 curve: [98.8, 98.75, 98.36, 98.25]

Average Accuracy (CNN): 86.88
Average Accuracy (NME): 89.37
2024-04-20 20:18:59,071 [trainer.py] => Average Accuracy (CNN): 86.88
2024-04-20 20:18:59,071 [trainer.py] => Average Accuracy (NME): 89.37
2024-04-20 20:18:59,071 [trainer.py] => Train Time: 746.66
2024-04-20 20:18:59,071 [trainer.py] => Test Time: 227.82000000000002 

2024-04-20 20:18:59,072 [trainer.py] => All params: 171835622
2024-04-20 20:18:59,073 [trainer.py] => Trainable params: 85983136
2024-04-20 20:19:00,666 [foster.py] => Learning on 80-90
2024-04-20 20:19:00,668 [foster.py] => All params: 171866372
2024-04-20 20:19:00,669 [foster.py] => Trainable params: 86006196
2024-04-20 20:19:00,771 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]

  0%|          | 0/1 [00:00<?, ?it/s]
Task 4, Epoch 1/1 => Loss 6.038, Loss_clf 1.013, Loss_fe 1.802, Loss_kd 2.865, Train_accy 57.21, Test_accy 80.01:   0%|          | 0/1 [01:39<?, ?it/s]
Task 4, Epoch 1/1 => Loss 6.038, Loss_clf 1.013, Loss_fe 1.802, Loss_kd 2.865, Train_accy 57.21, Test_accy 80.01: 100%|██████████| 1/1 [01:39<00:00, 99.56s/it]
Task 4, Epoch 1/1 => Loss 6.038, Loss_clf 1.013, Loss_fe 1.802, Loss_kd 2.865, Train_accy 57.21, Test_accy 80.01: 100%|██████████| 1/1 [01:39<00:00, 99.56s/it]
2024-04-20 20:20:40,338 [foster.py] => Task 4, Epoch 1/1 => Loss 6.038, Loss_clf 1.013, Loss_fe 1.802, Loss_kd 2.865, Train_accy 57.21, Test_accy 80.01
2024-04-20 20:20:40,340 [foster.py] => do not weight align teacher!
2024-04-20 20:20:40,345 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/1 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/1 => Loss 3.206,  Train_accy 32.94, Test_accy 77.19:   0%|          | 0/1 [01:34<?, ?it/s]
SNet: Task 4, Epoch 1/1 => Loss 3.206,  Train_accy 32.94, Test_accy 77.19: 100%|██████████| 1/1 [01:34<00:00, 94.29s/it]
SNet: Task 4, Epoch 1/1 => Loss 3.206,  Train_accy 32.94, Test_accy 77.19: 100%|██████████| 1/1 [01:34<00:00, 94.29s/it]
2024-04-20 20:22:16,848 [foster.py] => SNet: Task 4, Epoch 1/1 => Loss 3.206,  Train_accy 32.94, Test_accy 77.19
2024-04-20 20:22:16,848 [foster.py] => do not weight align student!
2024-04-20 20:22:39,576 [foster.py] => darknet eval: 
2024-04-20 20:22:39,577 [foster.py] => CNN top1 curve: 77.19
2024-04-20 20:22:39,577 [foster.py] => CNN top5 curve: 96.49
2024-04-20 20:22:39,580 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-20 20:25:08,834 [foster.py] => Exemplar size: 1800
2024-04-20 20:25:08,834 [trainer.py] => CNN: {'total': 80.01, '00-49': 90.08, '50-59': 71.0, '60-69': 82.0, '70-79': 56.9, '80-89': 59.8, 'old': 82.54, 'new': 59.8}
2024-04-20 20:25:08,834 [trainer.py] => NME: {'total': 85.63, '00-49': 89.54, '50-59': 77.2, '60-69': 86.0, '70-79': 75.5, '80-89': 84.3, 'old': 85.8, 'new': 84.3}
2024-04-20 20:25:08,834 [trainer.py] => CNN top1 curve: [91.02, 88.58, 86.19, 81.74, 80.01]
2024-04-20 20:25:08,835 [trainer.py] => CNN top5 curve: [98.72, 98.37, 98.2, 97.82, 97.63]
2024-04-20 20:25:08,835 [trainer.py] => NME top1 curve: [91.56, 89.98, 89.17, 86.78, 85.63]
2024-04-20 20:25:08,835 [trainer.py] => NME top5 curve: [98.8, 98.75, 98.36, 98.25, 98.02]

Average Accuracy (CNN): 85.51
Average Accuracy (NME): 88.62
2024-04-20 20:25:08,835 [trainer.py] => Average Accuracy (CNN): 85.51
2024-04-20 20:25:08,835 [trainer.py] => Average Accuracy (NME): 88.62
2024-04-20 20:25:08,835 [trainer.py] => Train Time: 965.51
2024-04-20 20:25:08,835 [trainer.py] => Test Time: 314.45000000000005 

2024-04-20 20:25:08,836 [trainer.py] => All params: 171866372
2024-04-20 20:25:08,837 [trainer.py] => Trainable params: 86006196
2024-04-20 20:25:11,531 [foster.py] => Learning on 90-100
2024-04-20 20:25:11,534 [foster.py] => All params: 171897122
2024-04-20 20:25:11,536 [foster.py] => Trainable params: 86029256
2024-04-20 20:25:11,695 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175]

  0%|          | 0/1 [00:00<?, ?it/s]
Task 5, Epoch 1/1 => Loss 6.560, Loss_clf 1.132, Loss_fe 2.028, Loss_kd 3.060, Train_accy 57.59, Test_accy 79.74:   0%|          | 0/1 [01:46<?, ?it/s]
Task 5, Epoch 1/1 => Loss 6.560, Loss_clf 1.132, Loss_fe 2.028, Loss_kd 3.060, Train_accy 57.59, Test_accy 79.74: 100%|██████████| 1/1 [01:46<00:00, 106.79s/it]
Task 5, Epoch 1/1 => Loss 6.560, Loss_clf 1.132, Loss_fe 2.028, Loss_kd 3.060, Train_accy 57.59, Test_accy 79.74: 100%|██████████| 1/1 [01:46<00:00, 106.79s/it]
2024-04-20 20:26:58,486 [foster.py] => Task 5, Epoch 1/1 => Loss 6.560, Loss_clf 1.132, Loss_fe 2.028, Loss_kd 3.060, Train_accy 57.59, Test_accy 79.74
2024-04-20 20:26:58,487 [foster.py] => do not weight align teacher!
2024-04-20 20:26:58,489 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405 ]

  0%|          | 0/1 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/1 => Loss 3.325,  Train_accy 35.54, Test_accy 77.54:   0%|          | 0/1 [01:39<?, ?it/s]
SNet: Task 5, Epoch 1/1 => Loss 3.325,  Train_accy 35.54, Test_accy 77.54: 100%|██████████| 1/1 [01:39<00:00, 99.65s/it]
SNet: Task 5, Epoch 1/1 => Loss 3.325,  Train_accy 35.54, Test_accy 77.54: 100%|██████████| 1/1 [01:39<00:00, 99.65s/it]
2024-04-20 20:28:43,318 [foster.py] => SNet: Task 5, Epoch 1/1 => Loss 3.325,  Train_accy 35.54, Test_accy 77.54
2024-04-20 20:28:43,318 [foster.py] => do not weight align student!
2024-04-20 20:29:08,499 [foster.py] => darknet eval: 
2024-04-20 20:29:08,500 [foster.py] => CNN top1 curve: 77.54
2024-04-20 20:29:08,500 [foster.py] => CNN top5 curve: 96.2
2024-04-20 20:29:08,502 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-20 20:31:51,542 [foster.py] => Exemplar size: 2000
2024-04-20 20:31:51,542 [trainer.py] => CNN: {'total': 79.74, '00-49': 89.38, '50-59': 73.0, '60-69': 80.1, '70-79': 64.3, '80-89': 65.1, '90-99': 68.0, 'old': 81.04, 'new': 68.0}
2024-04-20 20:31:51,543 [trainer.py] => NME: {'total': 84.08, '00-49': 88.92, '50-59': 75.8, '60-69': 85.8, '70-79': 73.9, '80-89': 79.4, '90-99': 81.3, 'old': 84.39, 'new': 81.3}
2024-04-20 20:31:51,543 [trainer.py] => CNN top1 curve: [91.02, 88.58, 86.19, 81.74, 80.01, 79.74]
2024-04-20 20:31:51,543 [trainer.py] => CNN top5 curve: [98.72, 98.37, 98.2, 97.82, 97.63, 97.0]
2024-04-20 20:31:51,543 [trainer.py] => NME top1 curve: [91.56, 89.98, 89.17, 86.78, 85.63, 84.08]
2024-04-20 20:31:51,543 [trainer.py] => NME top5 curve: [98.8, 98.75, 98.36, 98.25, 98.02, 97.48]

Average Accuracy (CNN): 84.55
Average Accuracy (NME): 87.87
2024-04-20 20:31:51,543 [trainer.py] => Average Accuracy (CNN): 84.55
2024-04-20 20:31:51,543 [trainer.py] => Average Accuracy (NME): 87.87
2024-04-20 20:31:51,543 [trainer.py] => Train Time: 1202.36
2024-04-20 20:31:51,543 [trainer.py] => Test Time: 411.52000000000004 

Accuracy Matrix (CNN):
[[91.02 90.84 90.76 90.2  90.08 89.38]
 [ 0.   77.3  70.8  71.9  71.   73.  ]
 [ 0.    0.   78.7  72.6  82.   80.1 ]
 [ 0.    0.    0.   58.4  56.9  64.3 ]
 [ 0.    0.    0.    0.   59.8  65.1 ]
 [ 0.    0.    0.    0.    0.   68.  ]]
2024-04-20 20:31:51,544 [trainer.py] => Forgetting (CNN): 1.5680000000000007
Accuracy Matrix (NME):
[[91.56 90.82 90.68 90.52 89.54 88.92]
 [ 0.   85.8  79.9  76.6  77.2  75.8 ]
 [ 0.    0.   90.9  85.9  86.   85.8 ]
 [ 0.    0.    0.   79.1  75.5  73.9 ]
 [ 0.    0.    0.    0.   84.3  79.4 ]
 [ 0.    0.    0.    0.    0.   81.3 ]]
2024-04-20 20:31:51,544 [trainer.py] => Forgetting (NME): 5.567999999999998


2024-04-20 20:31:55,925 [trainer.py] => config: ./exps/l2p_B50.json
2024-04-20 20:31:55,947 [trainer.py] => prefix:  
2024-04-20 20:31:55,947 [trainer.py] => dataset: cifar224
2024-04-20 20:31:55,947 [trainer.py] => memory_size: 0
2024-04-20 20:31:55,948 [trainer.py] => memory_per_class: 0
2024-04-20 20:31:55,948 [trainer.py] => fixed_memory: False
2024-04-20 20:31:55,948 [trainer.py] => shuffle: True
2024-04-20 20:31:55,948 [trainer.py] => init_cls: 50
2024-04-20 20:31:55,948 [trainer.py] => increment: 10
2024-04-20 20:31:55,948 [trainer.py] => model_name: l2p
2024-04-20 20:31:55,948 [trainer.py] => backbone_type: vit_base_patch16_224_l2p
2024-04-20 20:31:55,948 [trainer.py] => get_original_backbone: True
2024-04-20 20:31:55,948 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-20 20:31:55,948 [trainer.py] => seed: 1993
2024-04-20 20:31:55,948 [trainer.py] => tuned_epoch: 20
2024-04-20 20:31:55,948 [trainer.py] => init_lr: 0.001875
2024-04-20 20:31:55,949 [trainer.py] => batch_size: 48
2024-04-20 20:31:55,949 [trainer.py] => weight_decay: 0
2024-04-20 20:31:55,949 [trainer.py] => min_lr: 1e-05
2024-04-20 20:31:55,949 [trainer.py] => optimizer: adam
2024-04-20 20:31:55,949 [trainer.py] => scheduler: constant
2024-04-20 20:31:55,949 [trainer.py] => reinit_optimizer: True
2024-04-20 20:31:55,949 [trainer.py] => global_pool: token
2024-04-20 20:31:55,949 [trainer.py] => head_type: prompt
2024-04-20 20:31:55,949 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-20 20:31:55,950 [trainer.py] => pretrained: True
2024-04-20 20:31:55,950 [trainer.py] => drop: 0.0
2024-04-20 20:31:55,950 [trainer.py] => drop_path: 0.0
2024-04-20 20:31:55,950 [trainer.py] => prompt_pool: True
2024-04-20 20:31:55,950 [trainer.py] => size: 10
2024-04-20 20:31:55,950 [trainer.py] => length: 5
2024-04-20 20:31:55,950 [trainer.py] => top_k: 5
2024-04-20 20:31:55,950 [trainer.py] => initializer: uniform
2024-04-20 20:31:55,950 [trainer.py] => prompt_key: True
2024-04-20 20:31:55,951 [trainer.py] => prompt_key_init: uniform
2024-04-20 20:31:55,951 [trainer.py] => use_prompt_mask: False
2024-04-20 20:31:55,951 [trainer.py] => shared_prompt_pool: False
2024-04-20 20:31:55,951 [trainer.py] => shared_prompt_key: False
2024-04-20 20:31:55,951 [trainer.py] => batchwise_prompt: True
2024-04-20 20:31:55,951 [trainer.py] => embedding_key: cls
2024-04-20 20:31:55,951 [trainer.py] => predefined_key: 
2024-04-20 20:31:55,951 [trainer.py] => pull_constraint: True
2024-04-20 20:31:55,951 [trainer.py] => pull_constraint_coeff: 0.1
Files already downloaded and verified
Files already downloaded and verified
2024-04-20 20:31:57,958 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-20 20:31:59,764 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-04-20 20:31:59,764 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-04-20 20:32:03,175 [l2p.py] => 85,940,836 model total parameters.
2024-04-20 20:32:03,176 [l2p.py] => 122,980 model training parameters.
2024-04-20 20:32:03,176 [l2p.py] => prompt.prompt: 38400
2024-04-20 20:32:03,176 [l2p.py] => prompt.prompt_key: 7680
2024-04-20 20:32:03,176 [l2p.py] => head.weight: 76800
2024-04-20 20:32:03,176 [l2p.py] => head.bias: 100
2024-04-20 20:32:03,177 [trainer.py] => All params: 171816392
2024-04-20 20:32:03,178 [trainer.py] => Trainable params: 122980
2024-04-20 20:32:03,178 [l2p.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.197, Train_accy 64.83:   0%|          | 0/20 [03:17<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.197, Train_accy 64.83:   5%|▌         | 1/20 [03:17<1:02:25, 197.12s/it]
Task 0, Epoch 2/20 => Loss 0.610, Train_accy 75.20:   5%|▌         | 1/20 [06:33<1:02:25, 197.12s/it]
Task 0, Epoch 2/20 => Loss 0.610, Train_accy 75.20:  10%|█         | 2/20 [06:33<58:56, 196.47s/it]  
Task 0, Epoch 3/20 => Loss 0.469, Train_accy 78.02:  10%|█         | 2/20 [09:49<58:56, 196.47s/it]
Task 0, Epoch 3/20 => Loss 0.469, Train_accy 78.02:  15%|█▌        | 3/20 [09:49<55:43, 196.65s/it]
Task 0, Epoch 4/20 => Loss 0.416, Train_accy 79.25:  15%|█▌        | 3/20 [13:06<55:43, 196.65s/it]
Task 0, Epoch 4/20 => Loss 0.416, Train_accy 79.25:  20%|██        | 4/20 [13:06<52:22, 196.41s/it]
Task 0, Epoch 5/20 => Loss 0.371, Train_accy 80.42, Test_accy 93.12:  20%|██        | 4/20 [16:48<52:22, 196.41s/it]
Task 0, Epoch 5/20 => Loss 0.371, Train_accy 80.42, Test_accy 93.12:  25%|██▌       | 5/20 [16:48<51:24, 205.66s/it]
Task 0, Epoch 6/20 => Loss 0.351, Train_accy 81.15:  25%|██▌       | 5/20 [20:04<51:24, 205.66s/it]                 
Task 0, Epoch 6/20 => Loss 0.351, Train_accy 81.15:  30%|███       | 6/20 [20:04<47:17, 202.68s/it]
Task 0, Epoch 7/20 => Loss 0.327, Train_accy 81.69:  30%|███       | 6/20 [23:21<47:17, 202.68s/it]
Task 0, Epoch 7/20 => Loss 0.327, Train_accy 81.69:  35%|███▌      | 7/20 [23:21<43:27, 200.61s/it]
Task 0, Epoch 8/20 => Loss 0.316, Train_accy 82.02:  35%|███▌      | 7/20 [26:37<43:27, 200.61s/it]
Task 0, Epoch 8/20 => Loss 0.316, Train_accy 82.02:  40%|████      | 8/20 [26:37<39:51, 199.27s/it]
Task 0, Epoch 9/20 => Loss 0.303, Train_accy 82.46:  40%|████      | 8/20 [29:55<39:51, 199.27s/it]
Task 0, Epoch 9/20 => Loss 0.303, Train_accy 82.46:  45%|████▌     | 9/20 [29:55<36:27, 198.88s/it]
Task 0, Epoch 10/20 => Loss 0.303, Train_accy 82.30, Test_accy 93.88:  45%|████▌     | 9/20 [33:39<36:27, 198.88s/it]
Task 0, Epoch 10/20 => Loss 0.303, Train_accy 82.30, Test_accy 93.88:  50%|█████     | 10/20 [33:39<34:24, 206.47s/it]
Task 0, Epoch 11/20 => Loss 0.283, Train_accy 82.92:  50%|█████     | 10/20 [36:56<34:24, 206.47s/it]                 
Task 0, Epoch 11/20 => Loss 0.283, Train_accy 82.92:  55%|█████▌    | 11/20 [36:56<30:31, 203.53s/it]
Task 0, Epoch 12/20 => Loss 0.279, Train_accy 83.06:  55%|█████▌    | 11/20 [40:12<30:31, 203.53s/it]
Task 0, Epoch 12/20 => Loss 0.279, Train_accy 83.06:  60%|██████    | 12/20 [40:12<26:50, 201.26s/it]
Task 0, Epoch 13/20 => Loss 0.257, Train_accy 83.54:  60%|██████    | 12/20 [43:27<26:50, 201.26s/it]
Task 0, Epoch 13/20 => Loss 0.257, Train_accy 83.54:  65%|██████▌   | 13/20 [43:27<23:17, 199.60s/it]
Task 0, Epoch 14/20 => Loss 0.246, Train_accy 83.74:  65%|██████▌   | 13/20 [46:43<23:17, 199.60s/it]
Task 0, Epoch 14/20 => Loss 0.246, Train_accy 83.74:  70%|███████   | 14/20 [46:43<19:50, 198.34s/it]
Task 0, Epoch 15/20 => Loss 0.243, Train_accy 83.99, Test_accy 93.80:  70%|███████   | 14/20 [50:24<19:50, 198.34s/it]
Task 0, Epoch 15/20 => Loss 0.243, Train_accy 83.99, Test_accy 93.80:  75%|███████▌  | 15/20 [50:24<17:05, 205.13s/it]
Task 0, Epoch 16/20 => Loss 0.246, Train_accy 83.79:  75%|███████▌  | 15/20 [53:40<17:05, 205.13s/it]                 
Task 0, Epoch 16/20 => Loss 0.246, Train_accy 83.79:  80%|████████  | 16/20 [53:40<13:29, 202.33s/it]
Task 0, Epoch 17/20 => Loss 0.233, Train_accy 84.22:  80%|████████  | 16/20 [56:55<13:29, 202.33s/it]
Task 0, Epoch 17/20 => Loss 0.233, Train_accy 84.22:  85%|████████▌ | 17/20 [56:55<10:00, 200.31s/it]
Task 0, Epoch 18/20 => Loss 0.227, Train_accy 84.22:  85%|████████▌ | 17/20 [1:00:11<10:00, 200.31s/it]
Task 0, Epoch 18/20 => Loss 0.227, Train_accy 84.22:  90%|█████████ | 18/20 [1:00:11<06:37, 198.99s/it]
Task 0, Epoch 19/20 => Loss 0.221, Train_accy 84.48:  90%|█████████ | 18/20 [1:03:27<06:37, 198.99s/it]
Task 0, Epoch 19/20 => Loss 0.221, Train_accy 84.48:  95%|█████████▌| 19/20 [1:03:27<03:17, 197.95s/it]
Task 0, Epoch 20/20 => Loss 0.224, Train_accy 84.19, Test_accy 93.54:  95%|█████████▌| 19/20 [1:07:08<03:17, 197.95s/it]
Task 0, Epoch 20/20 => Loss 0.224, Train_accy 84.19, Test_accy 93.54: 100%|██████████| 20/20 [1:07:08<00:00, 204.99s/it]
Task 0, Epoch 20/20 => Loss 0.224, Train_accy 84.19, Test_accy 93.54: 100%|██████████| 20/20 [1:07:08<00:00, 201.43s/it]
2024-04-20 21:39:12,352 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.224, Train_accy 84.19, Test_accy 93.54
2024-04-20 21:39:37,784 [trainer.py] => No NME accuracy.
2024-04-20 21:39:37,784 [trainer.py] => CNN: {'total': 93.54, '00-49': 93.54, 'old': 0, 'new': 93.54}
2024-04-20 21:39:37,784 [trainer.py] => CNN top1 curve: [93.54]
2024-04-20 21:39:37,784 [trainer.py] => CNN top5 curve: [99.3]

Average Accuracy (CNN): 93.54
2024-04-20 21:39:37,784 [trainer.py] => Average Accuracy (CNN): 93.54 

2024-04-20 21:39:37,784 [trainer.py] => Train Time: 8057.64
2024-04-20 21:39:37,784 [trainer.py] => Test Time: 25.43 

2024-04-20 21:39:37,786 [trainer.py] => All params: 171816392
2024-04-20 21:39:37,787 [trainer.py] => Trainable params: 122980
2024-04-20 21:39:37,787 [l2p.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.114, Train_accy 86.90:   0%|          | 0/20 [00:39<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.114, Train_accy 86.90:   5%|▌         | 1/20 [00:39<12:30, 39.49s/it]
Task 1, Epoch 2/20 => Loss -0.087, Train_accy 91.40:   5%|▌         | 1/20 [01:18<12:30, 39.49s/it]
Task 1, Epoch 2/20 => Loss -0.087, Train_accy 91.40:  10%|█         | 2/20 [01:18<11:50, 39.50s/it]
Task 1, Epoch 3/20 => Loss -0.103, Train_accy 92.10:  10%|█         | 2/20 [01:58<11:50, 39.50s/it]
Task 1, Epoch 3/20 => Loss -0.103, Train_accy 92.10:  15%|█▌        | 3/20 [01:58<11:11, 39.48s/it]
Task 1, Epoch 4/20 => Loss -0.105, Train_accy 91.86:  15%|█▌        | 3/20 [02:38<11:11, 39.48s/it]
Task 1, Epoch 4/20 => Loss -0.105, Train_accy 91.86:  20%|██        | 4/20 [02:38<10:33, 39.56s/it]
Task 1, Epoch 5/20 => Loss -0.121, Train_accy 92.62, Test_accy 88.25:  20%|██        | 4/20 [03:48<10:33, 39.56s/it]
Task 1, Epoch 5/20 => Loss -0.121, Train_accy 92.62, Test_accy 88.25:  25%|██▌       | 5/20 [03:48<12:39, 50.64s/it]
Task 1, Epoch 6/20 => Loss -0.134, Train_accy 93.20:  25%|██▌       | 5/20 [04:27<12:39, 50.64s/it]                 
Task 1, Epoch 6/20 => Loss -0.134, Train_accy 93.20:  30%|███       | 6/20 [04:27<10:56, 46.88s/it]
Task 1, Epoch 7/20 => Loss -0.127, Train_accy 92.50:  30%|███       | 6/20 [05:07<10:56, 46.88s/it]
Task 1, Epoch 7/20 => Loss -0.127, Train_accy 92.50:  35%|███▌      | 7/20 [05:07<09:37, 44.44s/it]
Task 1, Epoch 8/20 => Loss -0.129, Train_accy 93.16:  35%|███▌      | 7/20 [05:46<09:37, 44.44s/it]
Task 1, Epoch 8/20 => Loss -0.129, Train_accy 93.16:  40%|████      | 8/20 [05:46<08:34, 42.85s/it]
Task 1, Epoch 9/20 => Loss -0.139, Train_accy 93.36:  40%|████      | 8/20 [06:26<08:34, 42.85s/it]
Task 1, Epoch 9/20 => Loss -0.139, Train_accy 93.36:  45%|████▌     | 9/20 [06:26<07:40, 41.82s/it]
Task 1, Epoch 10/20 => Loss -0.120, Train_accy 92.58, Test_accy 89.68:  45%|████▌     | 9/20 [07:36<07:40, 41.82s/it]
Task 1, Epoch 10/20 => Loss -0.120, Train_accy 92.58, Test_accy 89.68:  50%|█████     | 10/20 [07:36<08:25, 50.52s/it]
Task 1, Epoch 11/20 => Loss -0.146, Train_accy 93.70:  50%|█████     | 10/20 [08:15<08:25, 50.52s/it]                 
Task 1, Epoch 11/20 => Loss -0.146, Train_accy 93.70:  55%|█████▌    | 11/20 [08:15<07:04, 47.14s/it]
Task 1, Epoch 12/20 => Loss -0.121, Train_accy 92.50:  55%|█████▌    | 11/20 [08:55<07:04, 47.14s/it]
Task 1, Epoch 12/20 => Loss -0.121, Train_accy 92.50:  60%|██████    | 12/20 [08:55<05:59, 44.90s/it]
Task 1, Epoch 13/20 => Loss -0.140, Train_accy 93.56:  60%|██████    | 12/20 [09:35<05:59, 44.90s/it]
Task 1, Epoch 13/20 => Loss -0.140, Train_accy 93.56:  65%|██████▌   | 13/20 [09:35<05:02, 43.28s/it]
Task 1, Epoch 14/20 => Loss -0.125, Train_accy 93.10:  65%|██████▌   | 13/20 [10:14<05:02, 43.28s/it]
Task 1, Epoch 14/20 => Loss -0.125, Train_accy 93.10:  70%|███████   | 14/20 [10:14<04:12, 42.16s/it]
Task 1, Epoch 15/20 => Loss -0.129, Train_accy 92.84, Test_accy 90.52:  70%|███████   | 14/20 [11:24<04:12, 42.16s/it]
Task 1, Epoch 15/20 => Loss -0.129, Train_accy 92.84, Test_accy 90.52:  75%|███████▌  | 15/20 [11:24<04:12, 50.55s/it]
Task 1, Epoch 16/20 => Loss -0.159, Train_accy 93.86:  75%|███████▌  | 15/20 [12:04<04:12, 50.55s/it]                 
Task 1, Epoch 16/20 => Loss -0.159, Train_accy 93.86:  80%|████████  | 16/20 [12:04<03:08, 47.21s/it]
Task 1, Epoch 17/20 => Loss -0.155, Train_accy 93.72:  80%|████████  | 16/20 [12:43<03:08, 47.21s/it]
Task 1, Epoch 17/20 => Loss -0.155, Train_accy 93.72:  85%|████████▌ | 17/20 [12:43<02:14, 44.91s/it]
Task 1, Epoch 18/20 => Loss -0.136, Train_accy 93.38:  85%|████████▌ | 17/20 [13:23<02:14, 44.91s/it]
Task 1, Epoch 18/20 => Loss -0.136, Train_accy 93.38:  90%|█████████ | 18/20 [13:23<01:26, 43.33s/it]
Task 1, Epoch 19/20 => Loss -0.137, Train_accy 93.22:  90%|█████████ | 18/20 [14:03<01:26, 43.33s/it]
Task 1, Epoch 19/20 => Loss -0.137, Train_accy 93.22:  95%|█████████▌| 19/20 [14:03<00:42, 42.27s/it]
Task 1, Epoch 20/20 => Loss -0.148, Train_accy 93.70, Test_accy 91.35:  95%|█████████▌| 19/20 [15:13<00:42, 42.27s/it]
Task 1, Epoch 20/20 => Loss -0.148, Train_accy 93.70, Test_accy 91.35: 100%|██████████| 20/20 [15:13<00:00, 50.63s/it]
Task 1, Epoch 20/20 => Loss -0.148, Train_accy 93.70, Test_accy 91.35: 100%|██████████| 20/20 [15:13<00:00, 45.67s/it]
2024-04-20 21:54:51,190 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.148, Train_accy 93.70, Test_accy 91.35
2024-04-20 21:55:21,624 [trainer.py] => No NME accuracy.
2024-04-20 21:55:21,625 [trainer.py] => CNN: {'total': 91.35, '00-49': 93.7, '50-59': 79.6, 'old': 93.7, 'new': 79.6}
2024-04-20 21:55:21,625 [trainer.py] => CNN top1 curve: [93.54, 91.35]
2024-04-20 21:55:21,625 [trainer.py] => CNN top5 curve: [99.3, 99.18]

Average Accuracy (CNN): 92.44
2024-04-20 21:55:21,625 [trainer.py] => Average Accuracy (CNN): 92.44 

2024-04-20 21:55:21,625 [trainer.py] => Train Time: 9884.37
2024-04-20 21:55:21,625 [trainer.py] => Test Time: 55.86 

2024-04-20 21:55:21,627 [trainer.py] => All params: 171816392
2024-04-20 21:55:21,628 [trainer.py] => Trainable params: 122980
2024-04-20 21:55:21,628 [l2p.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss -0.015, Train_accy 91.00:   0%|          | 0/20 [00:39<?, ?it/s]
Task 2, Epoch 1/20 => Loss -0.015, Train_accy 91.00:   5%|▌         | 1/20 [00:39<12:29, 39.43s/it]
Task 2, Epoch 2/20 => Loss -0.137, Train_accy 93.72:   5%|▌         | 1/20 [01:18<12:29, 39.43s/it]
Task 2, Epoch 2/20 => Loss -0.137, Train_accy 93.72:  10%|█         | 2/20 [01:18<11:50, 39.48s/it]
Task 2, Epoch 3/20 => Loss -0.147, Train_accy 94.12:  10%|█         | 2/20 [01:58<11:50, 39.48s/it]
Task 2, Epoch 3/20 => Loss -0.147, Train_accy 94.12:  15%|█▌        | 3/20 [01:58<11:11, 39.50s/it]
Task 2, Epoch 4/20 => Loss -0.146, Train_accy 94.18:  15%|█▌        | 3/20 [02:38<11:11, 39.50s/it]
Task 2, Epoch 4/20 => Loss -0.146, Train_accy 94.18:  20%|██        | 4/20 [02:38<10:32, 39.53s/it]
Task 2, Epoch 5/20 => Loss -0.165, Train_accy 94.60, Test_accy 86.43:  20%|██        | 4/20 [03:52<10:32, 39.53s/it]
Task 2, Epoch 5/20 => Loss -0.165, Train_accy 94.60, Test_accy 86.43:  25%|██▌       | 5/20 [03:52<13:03, 52.25s/it]
Task 2, Epoch 6/20 => Loss -0.168, Train_accy 94.74:  25%|██▌       | 5/20 [04:32<13:03, 52.25s/it]                 
Task 2, Epoch 6/20 => Loss -0.168, Train_accy 94.74:  30%|███       | 6/20 [04:32<11:11, 47.94s/it]
Task 2, Epoch 7/20 => Loss -0.170, Train_accy 94.92:  30%|███       | 6/20 [05:11<11:11, 47.94s/it]
Task 2, Epoch 7/20 => Loss -0.170, Train_accy 94.92:  35%|███▌      | 7/20 [05:11<09:47, 45.19s/it]
Task 2, Epoch 8/20 => Loss -0.160, Train_accy 94.58:  35%|███▌      | 7/20 [05:51<09:47, 45.19s/it]
Task 2, Epoch 8/20 => Loss -0.160, Train_accy 94.58:  40%|████      | 8/20 [05:51<08:40, 43.41s/it]
Task 2, Epoch 9/20 => Loss -0.152, Train_accy 94.34:  40%|████      | 8/20 [06:31<08:40, 43.41s/it]
Task 2, Epoch 9/20 => Loss -0.152, Train_accy 94.34:  45%|████▌     | 9/20 [06:31<07:44, 42.26s/it]
Task 2, Epoch 10/20 => Loss -0.167, Train_accy 95.10, Test_accy 88.39:  45%|████▌     | 9/20 [07:46<07:44, 42.26s/it]
Task 2, Epoch 10/20 => Loss -0.167, Train_accy 95.10, Test_accy 88.39:  50%|█████     | 10/20 [07:46<08:44, 52.45s/it]
Task 2, Epoch 11/20 => Loss -0.165, Train_accy 94.78:  50%|█████     | 10/20 [08:26<08:44, 52.45s/it]                 
Task 2, Epoch 11/20 => Loss -0.165, Train_accy 94.78:  55%|█████▌    | 11/20 [08:26<07:17, 48.59s/it]
Task 2, Epoch 12/20 => Loss -0.168, Train_accy 95.08:  55%|█████▌    | 11/20 [09:06<07:17, 48.59s/it]
Task 2, Epoch 12/20 => Loss -0.168, Train_accy 95.08:  60%|██████    | 12/20 [09:06<06:07, 45.94s/it]
Task 2, Epoch 13/20 => Loss -0.161, Train_accy 94.64:  60%|██████    | 12/20 [09:45<06:07, 45.94s/it]
Task 2, Epoch 13/20 => Loss -0.161, Train_accy 94.64:  65%|██████▌   | 13/20 [09:45<05:08, 44.05s/it]
Task 2, Epoch 14/20 => Loss -0.162, Train_accy 94.48:  65%|██████▌   | 13/20 [10:25<05:08, 44.05s/it]
Task 2, Epoch 14/20 => Loss -0.162, Train_accy 94.48:  70%|███████   | 14/20 [10:25<04:16, 42.72s/it]
Task 2, Epoch 15/20 => Loss -0.169, Train_accy 95.18, Test_accy 88.81:  70%|███████   | 14/20 [11:40<04:16, 42.72s/it]
Task 2, Epoch 15/20 => Loss -0.169, Train_accy 95.18, Test_accy 88.81:  75%|███████▌  | 15/20 [11:40<04:22, 52.42s/it]
Task 2, Epoch 16/20 => Loss -0.181, Train_accy 95.14:  75%|███████▌  | 15/20 [12:20<04:22, 52.42s/it]                 
Task 2, Epoch 16/20 => Loss -0.181, Train_accy 95.14:  80%|████████  | 16/20 [12:20<03:14, 48.56s/it]
Task 2, Epoch 17/20 => Loss -0.184, Train_accy 95.32:  80%|████████  | 16/20 [12:59<03:14, 48.56s/it]
Task 2, Epoch 17/20 => Loss -0.184, Train_accy 95.32:  85%|████████▌ | 17/20 [12:59<02:17, 45.88s/it]
Task 2, Epoch 18/20 => Loss -0.175, Train_accy 95.06:  85%|████████▌ | 17/20 [13:40<02:17, 45.88s/it]
Task 2, Epoch 18/20 => Loss -0.175, Train_accy 95.06:  90%|█████████ | 18/20 [13:40<01:28, 44.23s/it]
Task 2, Epoch 19/20 => Loss -0.168, Train_accy 94.82:  90%|█████████ | 18/20 [14:20<01:28, 44.23s/it]
Task 2, Epoch 19/20 => Loss -0.168, Train_accy 94.82:  95%|█████████▌| 19/20 [14:20<00:43, 43.02s/it]
Task 2, Epoch 20/20 => Loss -0.155, Train_accy 94.84, Test_accy 89.59:  95%|█████████▌| 19/20 [15:35<00:43, 43.02s/it]
Task 2, Epoch 20/20 => Loss -0.155, Train_accy 94.84, Test_accy 89.59: 100%|██████████| 20/20 [15:35<00:00, 52.72s/it]
Task 2, Epoch 20/20 => Loss -0.155, Train_accy 94.84, Test_accy 89.59: 100%|██████████| 20/20 [15:35<00:00, 46.78s/it]
2024-04-20 22:10:57,364 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.155, Train_accy 94.84, Test_accy 89.59
2024-04-20 22:11:33,056 [trainer.py] => No NME accuracy.
2024-04-20 22:11:33,056 [trainer.py] => CNN: {'total': 89.59, '00-49': 93.64, '50-59': 76.6, '60-69': 82.3, 'old': 90.8, 'new': 82.3}
2024-04-20 22:11:33,056 [trainer.py] => CNN top1 curve: [93.54, 91.35, 89.59]
2024-04-20 22:11:33,056 [trainer.py] => CNN top5 curve: [99.3, 99.18, 98.93]

Average Accuracy (CNN): 91.49
2024-04-20 22:11:33,056 [trainer.py] => Average Accuracy (CNN): 91.49 

2024-04-20 22:11:33,056 [trainer.py] => Train Time: 11755.740000000002
2024-04-20 22:11:33,056 [trainer.py] => Test Time: 91.55 

2024-04-20 22:11:33,057 [trainer.py] => All params: 171816392
2024-04-20 22:11:33,058 [trainer.py] => Trainable params: 122980
2024-04-20 22:11:33,058 [l2p.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.096, Train_accy 86.74:   0%|          | 0/20 [00:39<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.096, Train_accy 86.74:   5%|▌         | 1/20 [00:39<12:34, 39.71s/it]
Task 3, Epoch 2/20 => Loss -0.089, Train_accy 91.66:   5%|▌         | 1/20 [01:19<12:34, 39.71s/it]
Task 3, Epoch 2/20 => Loss -0.089, Train_accy 91.66:  10%|█         | 2/20 [01:19<11:53, 39.65s/it]
Task 3, Epoch 3/20 => Loss -0.110, Train_accy 92.10:  10%|█         | 2/20 [01:58<11:53, 39.65s/it]
Task 3, Epoch 3/20 => Loss -0.110, Train_accy 92.10:  15%|█▌        | 3/20 [01:58<11:14, 39.65s/it]
Task 3, Epoch 4/20 => Loss -0.122, Train_accy 92.38:  15%|█▌        | 3/20 [02:38<11:14, 39.65s/it]
Task 3, Epoch 4/20 => Loss -0.122, Train_accy 92.38:  20%|██        | 4/20 [02:38<10:35, 39.74s/it]
Task 3, Epoch 5/20 => Loss -0.101, Train_accy 92.00, Test_accy 81.88:  20%|██        | 4/20 [03:59<10:35, 39.74s/it]
Task 3, Epoch 5/20 => Loss -0.101, Train_accy 92.00, Test_accy 81.88:  25%|██▌       | 5/20 [03:59<13:37, 54.48s/it]
Task 3, Epoch 6/20 => Loss -0.128, Train_accy 93.16:  25%|██▌       | 5/20 [04:39<13:37, 54.48s/it]                 
Task 3, Epoch 6/20 => Loss -0.128, Train_accy 93.16:  30%|███       | 6/20 [04:39<11:32, 49.44s/it]
Task 3, Epoch 7/20 => Loss -0.129, Train_accy 93.14:  30%|███       | 6/20 [05:18<11:32, 49.44s/it]
Task 3, Epoch 7/20 => Loss -0.129, Train_accy 93.14:  35%|███▌      | 7/20 [05:18<10:00, 46.22s/it]
Task 3, Epoch 8/20 => Loss -0.156, Train_accy 93.56:  35%|███▌      | 7/20 [05:58<10:00, 46.22s/it]
Task 3, Epoch 8/20 => Loss -0.156, Train_accy 93.56:  40%|████      | 8/20 [05:58<08:50, 44.20s/it]
Task 3, Epoch 9/20 => Loss -0.143, Train_accy 93.42:  40%|████      | 8/20 [06:38<08:50, 44.20s/it]
Task 3, Epoch 9/20 => Loss -0.143, Train_accy 93.42:  45%|████▌     | 9/20 [06:38<07:50, 42.80s/it]
Task 3, Epoch 10/20 => Loss -0.134, Train_accy 93.48, Test_accy 83.72:  45%|████▌     | 9/20 [07:58<07:50, 42.80s/it]
Task 3, Epoch 10/20 => Loss -0.134, Train_accy 93.48, Test_accy 83.72:  50%|█████     | 10/20 [07:58<09:03, 54.35s/it]
Task 3, Epoch 11/20 => Loss -0.134, Train_accy 93.14:  50%|█████     | 10/20 [08:38<09:03, 54.35s/it]                 
Task 3, Epoch 11/20 => Loss -0.134, Train_accy 93.14:  55%|█████▌    | 11/20 [08:38<07:28, 49.84s/it]
Task 3, Epoch 12/20 => Loss -0.135, Train_accy 93.06:  55%|█████▌    | 11/20 [09:17<07:28, 49.84s/it]
Task 3, Epoch 12/20 => Loss -0.135, Train_accy 93.06:  60%|██████    | 12/20 [09:17<06:13, 46.74s/it]
Task 3, Epoch 13/20 => Loss -0.155, Train_accy 94.00:  60%|██████    | 12/20 [09:57<06:13, 46.74s/it]
Task 3, Epoch 13/20 => Loss -0.155, Train_accy 94.00:  65%|██████▌   | 13/20 [09:57<05:11, 44.56s/it]
Task 3, Epoch 14/20 => Loss -0.143, Train_accy 93.46:  65%|██████▌   | 13/20 [10:37<05:11, 44.56s/it]
Task 3, Epoch 14/20 => Loss -0.143, Train_accy 93.46:  70%|███████   | 14/20 [10:37<04:18, 43.10s/it]
Task 3, Epoch 15/20 => Loss -0.147, Train_accy 93.46, Test_accy 84.30:  70%|███████   | 14/20 [11:57<04:18, 43.10s/it]
Task 3, Epoch 15/20 => Loss -0.147, Train_accy 93.46, Test_accy 84.30:  75%|███████▌  | 15/20 [11:57<04:31, 54.32s/it]
Task 3, Epoch 16/20 => Loss -0.133, Train_accy 93.24:  75%|███████▌  | 15/20 [12:37<04:31, 54.32s/it]                 
Task 3, Epoch 16/20 => Loss -0.133, Train_accy 93.24:  80%|████████  | 16/20 [12:37<03:19, 49.93s/it]
Task 3, Epoch 17/20 => Loss -0.147, Train_accy 93.72:  80%|████████  | 16/20 [13:17<03:19, 49.93s/it]
Task 3, Epoch 17/20 => Loss -0.147, Train_accy 93.72:  85%|████████▌ | 17/20 [13:17<02:20, 46.92s/it]
Task 3, Epoch 18/20 => Loss -0.138, Train_accy 93.06:  85%|████████▌ | 17/20 [13:56<02:20, 46.92s/it]
Task 3, Epoch 18/20 => Loss -0.138, Train_accy 93.06:  90%|█████████ | 18/20 [13:56<01:29, 44.75s/it]
Task 3, Epoch 19/20 => Loss -0.148, Train_accy 93.58:  90%|█████████ | 18/20 [14:36<01:29, 44.75s/it]
Task 3, Epoch 19/20 => Loss -0.148, Train_accy 93.58:  95%|█████████▌| 19/20 [14:36<00:43, 43.25s/it]
Task 3, Epoch 20/20 => Loss -0.152, Train_accy 93.68, Test_accy 85.30:  95%|█████████▌| 19/20 [15:57<00:43, 43.25s/it]
Task 3, Epoch 20/20 => Loss -0.152, Train_accy 93.68, Test_accy 85.30: 100%|██████████| 20/20 [15:57<00:00, 54.44s/it]
Task 3, Epoch 20/20 => Loss -0.152, Train_accy 93.68, Test_accy 85.30: 100%|██████████| 20/20 [15:57<00:00, 47.85s/it]
2024-04-20 22:27:30,121 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.152, Train_accy 93.68, Test_accy 85.30
2024-04-20 22:28:11,099 [trainer.py] => No NME accuracy.
2024-04-20 22:28:11,099 [trainer.py] => CNN: {'total': 85.3, '00-49': 93.42, '50-59': 74.7, '60-69': 79.9, '70-79': 60.7, 'old': 88.81, 'new': 60.7}
2024-04-20 22:28:11,099 [trainer.py] => CNN top1 curve: [93.54, 91.35, 89.59, 85.3]
2024-04-20 22:28:11,099 [trainer.py] => CNN top5 curve: [99.3, 99.18, 98.93, 98.75]

Average Accuracy (CNN): 89.94
2024-04-20 22:28:11,099 [trainer.py] => Average Accuracy (CNN): 89.94 

2024-04-20 22:28:11,099 [trainer.py] => Train Time: 13669.790000000003
2024-04-20 22:28:11,099 [trainer.py] => Test Time: 132.53 

2024-04-20 22:28:11,101 [trainer.py] => All params: 171816392
2024-04-20 22:28:11,102 [trainer.py] => Trainable params: 122980
2024-04-20 22:28:11,102 [l2p.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.053, Train_accy 88.58:   0%|          | 0/20 [00:56<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.053, Train_accy 88.58:   5%|▌         | 1/20 [00:56<17:52, 56.47s/it]
Task 4, Epoch 2/20 => Loss -0.105, Train_accy 92.38:   5%|▌         | 1/20 [02:14<17:52, 56.47s/it]
Task 4, Epoch 2/20 => Loss -0.105, Train_accy 92.38:  10%|█         | 2/20 [02:14<20:39, 68.87s/it]
Task 4, Epoch 3/20 => Loss -0.116, Train_accy 92.38:  10%|█         | 2/20 [03:31<20:39, 68.87s/it]
Task 4, Epoch 3/20 => Loss -0.116, Train_accy 92.38:  15%|█▌        | 3/20 [03:31<20:37, 72.78s/it]
Task 4, Epoch 4/20 => Loss -0.123, Train_accy 92.98:  15%|█▌        | 3/20 [04:48<20:37, 72.78s/it]
Task 4, Epoch 4/20 => Loss -0.123, Train_accy 92.98:  20%|██        | 4/20 [04:48<19:53, 74.57s/it]
Task 4, Epoch 5/20 => Loss -0.127, Train_accy 93.40, Test_accy 79.20:  20%|██        | 4/20 [07:32<19:53, 74.57s/it]
Task 4, Epoch 5/20 => Loss -0.127, Train_accy 93.40, Test_accy 79.20:  25%|██▌       | 5/20 [07:32<26:43, 106.87s/it]
Task 4, Epoch 6/20 => Loss -0.112, Train_accy 92.76:  25%|██▌       | 5/20 [08:23<26:43, 106.87s/it]                 
Task 4, Epoch 6/20 => Loss -0.112, Train_accy 92.76:  30%|███       | 6/20 [08:23<20:27, 87.67s/it] 
Task 4, Epoch 7/20 => Loss -0.158, Train_accy 94.22:  30%|███       | 6/20 [09:41<20:27, 87.67s/it]
Task 4, Epoch 7/20 => Loss -0.158, Train_accy 94.22:  35%|███▌      | 7/20 [09:41<18:19, 84.55s/it]
Task 4, Epoch 8/20 => Loss -0.131, Train_accy 93.74:  35%|███▌      | 7/20 [10:58<18:19, 84.55s/it]
Task 4, Epoch 8/20 => Loss -0.131, Train_accy 93.74:  40%|████      | 8/20 [10:58<16:27, 82.26s/it]
Task 4, Epoch 9/20 => Loss -0.145, Train_accy 93.70:  40%|████      | 8/20 [12:15<16:27, 82.26s/it]
Task 4, Epoch 9/20 => Loss -0.145, Train_accy 93.70:  45%|████▌     | 9/20 [12:15<14:46, 80.58s/it]
Task 4, Epoch 10/20 => Loss -0.153, Train_accy 93.70, Test_accy 80.03:  45%|████▌     | 9/20 [14:55<14:46, 80.58s/it]
Task 4, Epoch 10/20 => Loss -0.153, Train_accy 93.70, Test_accy 80.03:  50%|█████     | 10/20 [14:55<17:31, 105.16s/it]
Task 4, Epoch 11/20 => Loss -0.150, Train_accy 94.26:  50%|█████     | 10/20 [16:04<17:31, 105.16s/it]                 
Task 4, Epoch 11/20 => Loss -0.150, Train_accy 94.26:  55%|█████▌    | 11/20 [16:04<14:04, 93.85s/it] 
Task 4, Epoch 12/20 => Loss -0.140, Train_accy 93.78:  55%|█████▌    | 11/20 [17:03<14:04, 93.85s/it]
Task 4, Epoch 12/20 => Loss -0.140, Train_accy 93.78:  60%|██████    | 12/20 [17:03<11:07, 83.39s/it]
Task 4, Epoch 13/20 => Loss -0.120, Train_accy 93.12:  60%|██████    | 12/20 [18:21<11:07, 83.39s/it]
Task 4, Epoch 13/20 => Loss -0.120, Train_accy 93.12:  65%|██████▌   | 13/20 [18:21<09:31, 81.59s/it]
Task 4, Epoch 14/20 => Loss -0.129, Train_accy 93.62:  65%|██████▌   | 13/20 [19:38<09:31, 81.59s/it]
Task 4, Epoch 14/20 => Loss -0.129, Train_accy 93.62:  70%|███████   | 14/20 [19:38<08:01, 80.31s/it]
Task 4, Epoch 15/20 => Loss -0.141, Train_accy 93.76, Test_accy 80.78:  70%|███████   | 14/20 [22:23<08:01, 80.31s/it]
Task 4, Epoch 15/20 => Loss -0.141, Train_accy 93.76, Test_accy 80.78:  75%|███████▌  | 15/20 [22:23<08:49, 105.85s/it]
Task 4, Epoch 16/20 => Loss -0.140, Train_accy 93.60:  75%|███████▌  | 15/20 [23:39<08:49, 105.85s/it]                 
Task 4, Epoch 16/20 => Loss -0.140, Train_accy 93.60:  80%|████████  | 16/20 [23:39<06:27, 96.77s/it] 
Task 4, Epoch 17/20 => Loss -0.123, Train_accy 93.34:  80%|████████  | 16/20 [24:28<06:27, 96.77s/it]
Task 4, Epoch 17/20 => Loss -0.123, Train_accy 93.34:  85%|████████▌ | 17/20 [24:28<04:07, 82.66s/it]
Task 4, Epoch 18/20 => Loss -0.166, Train_accy 94.30:  85%|████████▌ | 17/20 [25:46<04:07, 82.66s/it]
Task 4, Epoch 18/20 => Loss -0.166, Train_accy 94.30:  90%|█████████ | 18/20 [25:46<02:42, 81.07s/it]
Task 4, Epoch 19/20 => Loss -0.156, Train_accy 94.10:  90%|█████████ | 18/20 [27:03<02:42, 81.07s/it]
Task 4, Epoch 19/20 => Loss -0.156, Train_accy 94.10:  95%|█████████▌| 19/20 [27:03<01:19, 79.92s/it]
Task 4, Epoch 20/20 => Loss -0.160, Train_accy 94.34, Test_accy 81.47:  95%|█████████▌| 19/20 [29:48<01:19, 79.92s/it]
Task 4, Epoch 20/20 => Loss -0.160, Train_accy 94.34, Test_accy 81.47: 100%|██████████| 20/20 [29:48<00:00, 105.44s/it]
Task 4, Epoch 20/20 => Loss -0.160, Train_accy 94.34, Test_accy 81.47: 100%|██████████| 20/20 [29:48<00:00, 89.42s/it] 
2024-04-20 22:57:59,607 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.160, Train_accy 94.34, Test_accy 81.47
2024-04-20 22:59:28,077 [trainer.py] => No NME accuracy.
2024-04-20 22:59:28,078 [trainer.py] => CNN: {'total': 81.47, '00-49': 93.14, '50-59': 73.8, '60-69': 79.6, '70-79': 58.2, '80-89': 55.9, 'old': 84.66, 'new': 55.9}
2024-04-20 22:59:28,078 [trainer.py] => CNN top1 curve: [93.54, 91.35, 89.59, 85.3, 81.47]
2024-04-20 22:59:28,078 [trainer.py] => CNN top5 curve: [99.3, 99.18, 98.93, 98.75, 98.37]

Average Accuracy (CNN): 88.25
2024-04-20 22:59:28,078 [trainer.py] => Average Accuracy (CNN): 88.25 

2024-04-20 22:59:28,078 [trainer.py] => Train Time: 17246.730000000003
2024-04-20 22:59:28,078 [trainer.py] => Test Time: 220.98000000000002 

2024-04-20 22:59:28,079 [trainer.py] => All params: 171816392
2024-04-20 22:59:28,081 [trainer.py] => Trainable params: 122980
2024-04-20 22:59:28,081 [l2p.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.085, Train_accy 87.02:   0%|          | 0/20 [00:57<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.085, Train_accy 87.02:   5%|▌         | 1/20 [00:57<18:19, 57.89s/it]
Task 5, Epoch 2/20 => Loss -0.066, Train_accy 90.96:   5%|▌         | 1/20 [02:05<18:19, 57.89s/it]
Task 5, Epoch 2/20 => Loss -0.066, Train_accy 90.96:  10%|█         | 2/20 [02:05<19:07, 63.75s/it]
Task 5, Epoch 3/20 => Loss -0.086, Train_accy 91.70:  10%|█         | 2/20 [03:22<19:07, 63.75s/it]
Task 5, Epoch 3/20 => Loss -0.086, Train_accy 91.70:  15%|█▌        | 3/20 [03:22<19:47, 69.88s/it]
Task 5, Epoch 4/20 => Loss -0.089, Train_accy 91.68:  15%|█▌        | 3/20 [04:40<19:47, 69.88s/it]
Task 5, Epoch 4/20 => Loss -0.089, Train_accy 91.68:  20%|██        | 4/20 [04:40<19:23, 72.74s/it]
Task 5, Epoch 5/20 => Loss -0.116, Train_accy 92.92, Test_accy 78.40:  20%|██        | 4/20 [07:35<19:23, 72.74s/it]
Task 5, Epoch 5/20 => Loss -0.116, Train_accy 92.92, Test_accy 78.40:  25%|██▌       | 5/20 [07:35<27:24, 109.60s/it]
Task 5, Epoch 6/20 => Loss -0.097, Train_accy 91.78:  25%|██▌       | 5/20 [08:43<27:24, 109.60s/it]                 
Task 5, Epoch 6/20 => Loss -0.097, Train_accy 91.78:  30%|███       | 6/20 [08:43<22:18, 95.61s/it] 
Task 5, Epoch 7/20 => Loss -0.108, Train_accy 92.48:  30%|███       | 6/20 [09:43<22:18, 95.61s/it]
Task 5, Epoch 7/20 => Loss -0.108, Train_accy 92.48:  35%|███▌      | 7/20 [09:43<18:11, 83.95s/it]
Task 5, Epoch 8/20 => Loss -0.122, Train_accy 92.80:  35%|███▌      | 7/20 [11:00<18:11, 83.95s/it]
Task 5, Epoch 8/20 => Loss -0.122, Train_accy 92.80:  40%|████      | 8/20 [11:00<16:22, 81.89s/it]
Task 5, Epoch 9/20 => Loss -0.114, Train_accy 92.96:  40%|████      | 8/20 [12:18<16:22, 81.89s/it]
Task 5, Epoch 9/20 => Loss -0.114, Train_accy 92.96:  45%|████▌     | 9/20 [12:18<14:46, 80.57s/it]
Task 5, Epoch 10/20 => Loss -0.113, Train_accy 92.36, Test_accy 79.30:  45%|████▌     | 9/20 [15:13<14:46, 80.57s/it]
Task 5, Epoch 10/20 => Loss -0.113, Train_accy 92.36, Test_accy 79.30:  50%|█████     | 10/20 [15:13<18:18, 109.81s/it]
Task 5, Epoch 11/20 => Loss -0.137, Train_accy 93.54:  50%|█████     | 10/20 [16:28<18:18, 109.81s/it]                 
Task 5, Epoch 11/20 => Loss -0.137, Train_accy 93.54:  55%|█████▌    | 11/20 [16:28<14:52, 99.15s/it] 
Task 5, Epoch 12/20 => Loss -0.128, Train_accy 93.42:  55%|█████▌    | 11/20 [17:17<14:52, 99.15s/it]
Task 5, Epoch 12/20 => Loss -0.128, Train_accy 93.42:  60%|██████    | 12/20 [17:17<11:09, 83.72s/it]
Task 5, Epoch 13/20 => Loss -0.123, Train_accy 92.82:  60%|██████    | 12/20 [18:34<11:09, 83.72s/it]
Task 5, Epoch 13/20 => Loss -0.123, Train_accy 92.82:  65%|██████▌   | 13/20 [18:34<09:31, 81.69s/it]
Task 5, Epoch 14/20 => Loss -0.132, Train_accy 93.36:  65%|██████▌   | 13/20 [19:52<09:31, 81.69s/it]
Task 5, Epoch 14/20 => Loss -0.132, Train_accy 93.36:  70%|███████   | 14/20 [19:52<08:03, 80.59s/it]
Task 5, Epoch 15/20 => Loss -0.143, Train_accy 93.64, Test_accy 79.76:  70%|███████   | 14/20 [22:46<08:03, 80.59s/it]
Task 5, Epoch 15/20 => Loss -0.143, Train_accy 93.64, Test_accy 79.76:  75%|███████▌  | 15/20 [22:46<09:03, 108.77s/it]
Task 5, Epoch 16/20 => Loss -0.128, Train_accy 93.20:  75%|███████▌  | 15/20 [24:03<09:03, 108.77s/it]                 
Task 5, Epoch 16/20 => Loss -0.128, Train_accy 93.20:  80%|████████  | 16/20 [24:03<06:37, 99.29s/it] 
Task 5, Epoch 17/20 => Loss -0.133, Train_accy 93.16:  80%|████████  | 16/20 [24:59<06:37, 99.29s/it]
Task 5, Epoch 17/20 => Loss -0.133, Train_accy 93.16:  85%|████████▌ | 17/20 [24:59<04:18, 86.19s/it]
Task 5, Epoch 18/20 => Loss -0.143, Train_accy 93.70:  85%|████████▌ | 17/20 [26:09<04:18, 86.19s/it]
Task 5, Epoch 18/20 => Loss -0.143, Train_accy 93.70:  90%|█████████ | 18/20 [26:09<02:42, 81.25s/it]
Task 5, Epoch 19/20 => Loss -0.146, Train_accy 93.72:  90%|█████████ | 18/20 [27:26<02:42, 81.25s/it]
Task 5, Epoch 19/20 => Loss -0.146, Train_accy 93.72:  95%|█████████▌| 19/20 [27:26<01:19, 79.99s/it]
Task 5, Epoch 20/20 => Loss -0.142, Train_accy 93.56, Test_accy 80.54:  95%|█████████▌| 19/20 [30:20<01:19, 79.99s/it]
Task 5, Epoch 20/20 => Loss -0.142, Train_accy 93.56, Test_accy 80.54: 100%|██████████| 20/20 [30:20<00:00, 108.32s/it]
Task 5, Epoch 20/20 => Loss -0.142, Train_accy 93.56, Test_accy 80.54: 100%|██████████| 20/20 [30:20<00:00, 91.03s/it] 
2024-04-20 23:29:48,715 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.142, Train_accy 93.56, Test_accy 80.54
2024-04-20 23:31:26,411 [trainer.py] => No NME accuracy.
2024-04-20 23:31:26,411 [trainer.py] => CNN: {'total': 80.54, '00-49': 93.06, '50-59': 74.8, '60-69': 79.2, '70-79': 58.1, '80-89': 55.4, '90-99': 72.6, 'old': 81.42, 'new': 72.6}
2024-04-20 23:31:26,411 [trainer.py] => CNN top1 curve: [93.54, 91.35, 89.59, 85.3, 81.47, 80.54]
2024-04-20 23:31:26,411 [trainer.py] => CNN top5 curve: [99.3, 99.18, 98.93, 98.75, 98.37, 97.96]

Average Accuracy (CNN): 86.96
2024-04-20 23:31:26,412 [trainer.py] => Average Accuracy (CNN): 86.96 

2024-04-20 23:31:26,412 [trainer.py] => Train Time: 20887.810000000005
2024-04-20 23:31:26,412 [trainer.py] => Test Time: 318.67 

Accuracy Matrix (CNN):
[[93.54 93.7  93.64 93.42 93.14 93.06]
 [ 0.   79.6  76.6  74.7  73.8  74.8 ]
 [ 0.    0.   82.3  79.9  79.6  79.2 ]
 [ 0.    0.    0.   60.7  58.2  58.1 ]
 [ 0.    0.    0.    0.   55.9  55.4 ]
 [ 0.    0.    0.    0.    0.   72.6 ]]
2024-04-20 23:31:26,415 [trainer.py] => Forgetting (CNN): 2.3279999999999985
2024-04-20 23:31:32,209 [trainer.py] => config: ./exps/dualprompt_B50.json
2024-04-20 23:31:32,216 [trainer.py] => prefix:  
2024-04-20 23:31:32,216 [trainer.py] => dataset: cifar224
2024-04-20 23:31:32,216 [trainer.py] => memory_size: 0
2024-04-20 23:31:32,216 [trainer.py] => memory_per_class: 0
2024-04-20 23:31:32,216 [trainer.py] => fixed_memory: False
2024-04-20 23:31:32,216 [trainer.py] => shuffle: True
2024-04-20 23:31:32,216 [trainer.py] => init_cls: 50
2024-04-20 23:31:32,216 [trainer.py] => increment: 10
2024-04-20 23:31:32,216 [trainer.py] => model_name: dualprompt
2024-04-20 23:31:32,216 [trainer.py] => backbone_type: vit_base_patch16_224_dualprompt
2024-04-20 23:31:32,216 [trainer.py] => get_original_backbone: True
2024-04-20 23:31:32,216 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-20 23:31:32,216 [trainer.py] => seed: 1993
2024-04-20 23:31:32,216 [trainer.py] => tuned_epoch: 20
2024-04-20 23:31:32,216 [trainer.py] => init_lr: 0.001
2024-04-20 23:31:32,216 [trainer.py] => batch_size: 48
2024-04-20 23:31:32,216 [trainer.py] => weight_decay: 0
2024-04-20 23:31:32,216 [trainer.py] => min_lr: 1e-05
2024-04-20 23:31:32,216 [trainer.py] => optimizer: adam
2024-04-20 23:31:32,217 [trainer.py] => scheduler: constant
2024-04-20 23:31:32,217 [trainer.py] => reinit_optimizer: True
2024-04-20 23:31:32,217 [trainer.py] => global_pool: token
2024-04-20 23:31:32,217 [trainer.py] => head_type: token
2024-04-20 23:31:32,217 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-20 23:31:32,217 [trainer.py] => pretrained: True
2024-04-20 23:31:32,217 [trainer.py] => drop: 0.0
2024-04-20 23:31:32,217 [trainer.py] => drop_path: 0.0
2024-04-20 23:31:32,217 [trainer.py] => use_g_prompt: True
2024-04-20 23:31:32,217 [trainer.py] => g_prompt_length: 5
2024-04-20 23:31:32,217 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-04-20 23:31:32,217 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-04-20 23:31:32,217 [trainer.py] => use_e_prompt: True
2024-04-20 23:31:32,217 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-04-20 23:31:32,217 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-04-20 23:31:32,217 [trainer.py] => prompt_pool: True
2024-04-20 23:31:32,217 [trainer.py] => size: 10
2024-04-20 23:31:32,217 [trainer.py] => length: 5
2024-04-20 23:31:32,217 [trainer.py] => top_k: 1
2024-04-20 23:31:32,217 [trainer.py] => initializer: uniform
2024-04-20 23:31:32,217 [trainer.py] => prompt_key: True
2024-04-20 23:31:32,217 [trainer.py] => prompt_key_init: uniform
2024-04-20 23:31:32,218 [trainer.py] => use_prompt_mask: True
2024-04-20 23:31:32,218 [trainer.py] => shared_prompt_pool: True
2024-04-20 23:31:32,218 [trainer.py] => shared_prompt_key: False
2024-04-20 23:31:32,218 [trainer.py] => batchwise_prompt: True
2024-04-20 23:31:32,218 [trainer.py] => embedding_key: cls
2024-04-20 23:31:32,218 [trainer.py] => predefined_key: 
2024-04-20 23:31:32,218 [trainer.py] => pull_constraint: True
2024-04-20 23:31:32,218 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-20 23:31:32,218 [trainer.py] => same_key_value: False
Files already downloaded and verified
Files already downloaded and verified
2024-04-20 23:31:34,681 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-20 23:31:44,995 [dualprompt.py] => 86,128,996 model total parameters.
2024-04-20 23:31:44,996 [dualprompt.py] => 330,340 model training parameters.
2024-04-20 23:31:44,996 [dualprompt.py] => g_prompt: 15360
2024-04-20 23:31:44,997 [dualprompt.py] => e_prompt.prompt: 230400
2024-04-20 23:31:44,997 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-04-20 23:31:44,998 [dualprompt.py] => head.weight: 76800
2024-04-20 23:31:44,998 [dualprompt.py] => head.bias: 100
2024-04-20 23:31:45,000 [trainer.py] => All params: 172004552
2024-04-20 23:31:45,002 [trainer.py] => Trainable params: 330340
2024-04-20 23:31:45,003 [dualprompt.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.209, Train_accy 67.88:   0%|          | 0/20 [05:21<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.209, Train_accy 67.88:   5%|▌         | 1/20 [05:21<1:41:53, 321.75s/it]
Task 0, Epoch 2/20 => Loss 0.862, Train_accy 75.89:   5%|▌         | 1/20 [10:40<1:41:53, 321.75s/it]
Task 0, Epoch 2/20 => Loss 0.862, Train_accy 75.89:  10%|█         | 2/20 [10:40<1:35:59, 319.95s/it]
Task 0, Epoch 3/20 => Loss 0.740, Train_accy 78.32:  10%|█         | 2/20 [16:20<1:35:59, 319.95s/it]
Task 0, Epoch 3/20 => Loss 0.740, Train_accy 78.32:  15%|█▌        | 3/20 [16:20<1:33:15, 329.15s/it]
Task 0, Epoch 4/20 => Loss 0.658, Train_accy 80.11:  15%|█▌        | 3/20 [21:53<1:33:15, 329.15s/it]
Task 0, Epoch 4/20 => Loss 0.658, Train_accy 80.11:  20%|██        | 4/20 [21:53<1:28:11, 330.73s/it]
Task 0, Epoch 5/20 => Loss 0.644, Train_accy 80.31, Test_accy 91.98:  20%|██        | 4/20 [27:58<1:28:11, 330.73s/it]
Task 0, Epoch 5/20 => Loss 0.644, Train_accy 80.31, Test_accy 91.98:  25%|██▌       | 5/20 [27:58<1:25:45, 343.03s/it]
Task 0, Epoch 6/20 => Loss 0.595, Train_accy 81.47:  25%|██▌       | 5/20 [33:19<1:25:45, 343.03s/it]                 
Task 0, Epoch 6/20 => Loss 0.595, Train_accy 81.47:  30%|███       | 6/20 [33:19<1:18:16, 335.45s/it]
Task 0, Epoch 7/20 => Loss 0.583, Train_accy 81.81:  30%|███       | 6/20 [38:37<1:18:16, 335.45s/it]
Task 0, Epoch 7/20 => Loss 0.583, Train_accy 81.81:  35%|███▌      | 7/20 [38:37<1:11:26, 329.71s/it]
Task 0, Epoch 8/20 => Loss 0.591, Train_accy 81.79:  35%|███▌      | 7/20 [43:54<1:11:26, 329.71s/it]
Task 0, Epoch 8/20 => Loss 0.591, Train_accy 81.79:  40%|████      | 8/20 [43:54<1:05:11, 325.93s/it]
Task 0, Epoch 9/20 => Loss 0.571, Train_accy 82.14:  40%|████      | 8/20 [49:12<1:05:11, 325.93s/it]
Task 0, Epoch 9/20 => Loss 0.571, Train_accy 82.14:  45%|████▌     | 9/20 [49:12<59:15, 323.25s/it]  
Task 0, Epoch 10/20 => Loss 0.572, Train_accy 82.23, Test_accy 92.80:  45%|████▌     | 9/20 [55:17<59:15, 323.25s/it]
Task 0, Epoch 10/20 => Loss 0.572, Train_accy 82.23, Test_accy 92.80:  50%|█████     | 10/20 [55:17<56:01, 336.19s/it]
Task 0, Epoch 11/20 => Loss 0.549, Train_accy 82.75:  50%|█████     | 10/20 [1:00:38<56:01, 336.19s/it]               
Task 0, Epoch 11/20 => Loss 0.549, Train_accy 82.75:  55%|█████▌    | 11/20 [1:00:38<49:42, 331.44s/it]
Task 0, Epoch 12/20 => Loss 0.535, Train_accy 83.20:  55%|█████▌    | 11/20 [1:05:58<49:42, 331.44s/it]
Task 0, Epoch 12/20 => Loss 0.535, Train_accy 83.20:  60%|██████    | 12/20 [1:05:58<43:44, 328.11s/it]
Task 0, Epoch 13/20 => Loss 0.538, Train_accy 83.06:  60%|██████    | 12/20 [1:11:14<43:44, 328.11s/it]
Task 0, Epoch 13/20 => Loss 0.538, Train_accy 83.06:  65%|██████▌   | 13/20 [1:11:14<37:50, 324.29s/it]
Task 0, Epoch 14/20 => Loss 0.532, Train_accy 83.14:  65%|██████▌   | 13/20 [1:16:27<37:50, 324.29s/it]
Task 0, Epoch 14/20 => Loss 0.532, Train_accy 83.14:  70%|███████   | 14/20 [1:16:27<32:05, 320.89s/it]
Task 0, Epoch 15/20 => Loss 0.520, Train_accy 83.62, Test_accy 92.64:  70%|███████   | 14/20 [1:22:26<32:05, 320.89s/it]
Task 0, Epoch 15/20 => Loss 0.520, Train_accy 83.62, Test_accy 92.64:  75%|███████▌  | 15/20 [1:22:26<27:42, 332.46s/it]
Task 0, Epoch 16/20 => Loss 0.502, Train_accy 84.01:  75%|███████▌  | 15/20 [1:27:40<27:42, 332.46s/it]                 
Task 0, Epoch 16/20 => Loss 0.502, Train_accy 84.01:  80%|████████  | 16/20 [1:27:40<21:47, 327.00s/it]
Task 0, Epoch 17/20 => Loss 0.503, Train_accy 84.00:  80%|████████  | 16/20 [1:32:56<21:47, 327.00s/it]
Task 0, Epoch 17/20 => Loss 0.503, Train_accy 84.00:  85%|████████▌ | 17/20 [1:32:56<16:11, 323.75s/it]
Task 0, Epoch 18/20 => Loss 0.507, Train_accy 83.70:  85%|████████▌ | 17/20 [1:38:23<16:11, 323.75s/it]
Task 0, Epoch 18/20 => Loss 0.507, Train_accy 83.70:  90%|█████████ | 18/20 [1:38:23<10:49, 324.64s/it]
Task 0, Epoch 19/20 => Loss 0.501, Train_accy 84.18:  90%|█████████ | 18/20 [1:44:00<10:49, 324.64s/it]
Task 0, Epoch 19/20 => Loss 0.501, Train_accy 84.18:  95%|█████████▌| 19/20 [1:44:00<05:28, 328.22s/it]
Task 0, Epoch 20/20 => Loss 0.502, Train_accy 84.26, Test_accy 92.98:  95%|█████████▌| 19/20 [1:50:04<05:28, 328.22s/it]
Task 0, Epoch 20/20 => Loss 0.502, Train_accy 84.26, Test_accy 92.98: 100%|██████████| 20/20 [1:50:04<00:00, 339.02s/it]
Task 0, Epoch 20/20 => Loss 0.502, Train_accy 84.26, Test_accy 92.98: 100%|██████████| 20/20 [1:50:04<00:00, 330.22s/it]
2024-04-21 01:21:50,391 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.502, Train_accy 84.26, Test_accy 92.98
2024-04-21 01:22:18,382 [trainer.py] => No NME accuracy.
2024-04-21 01:22:18,382 [trainer.py] => CNN: {'total': 92.98, '00-49': 92.98, 'old': 0, 'new': 92.98}
2024-04-21 01:22:18,382 [trainer.py] => CNN top1 curve: [92.98]
2024-04-21 01:22:18,382 [trainer.py] => CNN top5 curve: [99.0]

Average Accuracy (CNN): 92.98
2024-04-21 01:22:18,382 [trainer.py] => Average Accuracy (CNN): 92.98 

2024-04-21 01:22:18,383 [trainer.py] => Train Time: 13209.77
2024-04-21 01:22:18,383 [trainer.py] => Test Time: 27.97 

2024-04-21 01:22:18,384 [trainer.py] => All params: 172004552
2024-04-21 01:22:18,386 [trainer.py] => Trainable params: 330340
2024-04-21 01:22:18,386 [dualprompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.550, Train_accy 83.36:   0%|          | 0/20 [01:03<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.550, Train_accy 83.36:   5%|▌         | 1/20 [01:03<20:03, 63.33s/it]
Task 1, Epoch 2/20 => Loss 0.257, Train_accy 91.04:   5%|▌         | 1/20 [02:15<20:03, 63.33s/it]
Task 1, Epoch 2/20 => Loss 0.257, Train_accy 91.04:  10%|█         | 2/20 [02:15<20:28, 68.28s/it]
Task 1, Epoch 3/20 => Loss 0.224, Train_accy 91.68:  10%|█         | 2/20 [03:27<20:28, 68.28s/it]
Task 1, Epoch 3/20 => Loss 0.224, Train_accy 91.68:  15%|█▌        | 3/20 [03:27<19:54, 70.24s/it]
Task 1, Epoch 4/20 => Loss 0.210, Train_accy 92.04:  15%|█▌        | 3/20 [04:38<19:54, 70.24s/it]
Task 1, Epoch 4/20 => Loss 0.210, Train_accy 92.04:  20%|██        | 4/20 [04:38<18:48, 70.55s/it]
Task 1, Epoch 5/20 => Loss 0.207, Train_accy 92.04, Test_accy 88.30:  20%|██        | 4/20 [06:09<18:48, 70.55s/it]
Task 1, Epoch 5/20 => Loss 0.207, Train_accy 92.04, Test_accy 88.30:  25%|██▌       | 5/20 [06:09<19:28, 77.87s/it]
Task 1, Epoch 6/20 => Loss 0.168, Train_accy 93.82:  25%|██▌       | 5/20 [07:17<19:28, 77.87s/it]                 
Task 1, Epoch 6/20 => Loss 0.168, Train_accy 93.82:  30%|███       | 6/20 [07:17<17:24, 74.60s/it]
Task 1, Epoch 7/20 => Loss 0.176, Train_accy 93.16:  30%|███       | 6/20 [08:29<17:24, 74.60s/it]
Task 1, Epoch 7/20 => Loss 0.176, Train_accy 93.16:  35%|███▌      | 7/20 [08:29<15:59, 73.80s/it]
Task 1, Epoch 8/20 => Loss 0.177, Train_accy 92.42:  35%|███▌      | 7/20 [09:42<15:59, 73.80s/it]
Task 1, Epoch 8/20 => Loss 0.177, Train_accy 92.42:  40%|████      | 8/20 [09:42<14:39, 73.31s/it]
Task 1, Epoch 9/20 => Loss 0.179, Train_accy 92.74:  40%|████      | 8/20 [10:51<14:39, 73.31s/it]
Task 1, Epoch 9/20 => Loss 0.179, Train_accy 92.74:  45%|████▌     | 9/20 [10:51<13:13, 72.12s/it]
Task 1, Epoch 10/20 => Loss 0.160, Train_accy 93.12, Test_accy 89.07:  45%|████▌     | 9/20 [12:19<13:13, 72.12s/it]
Task 1, Epoch 10/20 => Loss 0.160, Train_accy 93.12, Test_accy 89.07:  50%|█████     | 10/20 [12:19<12:50, 77.02s/it]
Task 1, Epoch 11/20 => Loss 0.155, Train_accy 93.06:  50%|█████     | 10/20 [13:31<12:50, 77.02s/it]                 
Task 1, Epoch 11/20 => Loss 0.155, Train_accy 93.06:  55%|█████▌    | 11/20 [13:31<11:20, 75.58s/it]
Task 1, Epoch 12/20 => Loss 0.130, Train_accy 93.80:  55%|█████▌    | 11/20 [14:44<11:20, 75.58s/it]
Task 1, Epoch 12/20 => Loss 0.130, Train_accy 93.80:  60%|██████    | 12/20 [14:44<09:56, 74.62s/it]
Task 1, Epoch 13/20 => Loss 0.150, Train_accy 93.26:  60%|██████    | 12/20 [15:55<09:56, 74.62s/it]
Task 1, Epoch 13/20 => Loss 0.150, Train_accy 93.26:  65%|██████▌   | 13/20 [15:55<08:35, 73.70s/it]
Task 1, Epoch 14/20 => Loss 0.151, Train_accy 92.68:  65%|██████▌   | 13/20 [17:05<08:35, 73.70s/it]
Task 1, Epoch 14/20 => Loss 0.151, Train_accy 92.68:  70%|███████   | 14/20 [17:05<07:14, 72.39s/it]
Task 1, Epoch 15/20 => Loss 0.156, Train_accy 92.36, Test_accy 89.67:  70%|███████   | 14/20 [18:31<07:14, 72.39s/it]
Task 1, Epoch 15/20 => Loss 0.156, Train_accy 92.36, Test_accy 89.67:  75%|███████▌  | 15/20 [18:31<06:22, 76.51s/it]
Task 1, Epoch 16/20 => Loss 0.145, Train_accy 92.84:  75%|███████▌  | 15/20 [19:43<06:22, 76.51s/it]                 
Task 1, Epoch 16/20 => Loss 0.145, Train_accy 92.84:  80%|████████  | 16/20 [19:43<05:00, 75.15s/it]
Task 1, Epoch 17/20 => Loss 0.139, Train_accy 93.24:  80%|████████  | 16/20 [20:55<05:00, 75.15s/it]
Task 1, Epoch 17/20 => Loss 0.139, Train_accy 93.24:  85%|████████▌ | 17/20 [20:55<03:42, 74.31s/it]
Task 1, Epoch 18/20 => Loss 0.144, Train_accy 92.96:  85%|████████▌ | 17/20 [22:07<03:42, 74.31s/it]
Task 1, Epoch 18/20 => Loss 0.144, Train_accy 92.96:  90%|█████████ | 18/20 [22:07<02:26, 73.41s/it]
Task 1, Epoch 19/20 => Loss 0.151, Train_accy 92.86:  90%|█████████ | 18/20 [23:15<02:26, 73.41s/it]
Task 1, Epoch 19/20 => Loss 0.151, Train_accy 92.86:  95%|█████████▌| 19/20 [23:15<01:11, 71.98s/it]
Task 1, Epoch 20/20 => Loss 0.141, Train_accy 92.96, Test_accy 90.48:  95%|█████████▌| 19/20 [24:40<01:11, 71.98s/it]
Task 1, Epoch 20/20 => Loss 0.141, Train_accy 92.96, Test_accy 90.48: 100%|██████████| 20/20 [24:40<00:00, 75.93s/it]
Task 1, Epoch 20/20 => Loss 0.141, Train_accy 92.96, Test_accy 90.48: 100%|██████████| 20/20 [24:40<00:00, 74.04s/it]
2024-04-21 01:46:59,301 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.141, Train_accy 92.96, Test_accy 90.48
2024-04-21 01:47:56,342 [trainer.py] => No NME accuracy.
2024-04-21 01:47:56,342 [trainer.py] => CNN: {'total': 90.48, '00-49': 92.68, '50-59': 79.5, 'old': 92.68, 'new': 79.5}
2024-04-21 01:47:56,343 [trainer.py] => CNN top1 curve: [92.98, 90.48]
2024-04-21 01:47:56,343 [trainer.py] => CNN top5 curve: [99.0, 98.77]

Average Accuracy (CNN): 91.73
2024-04-21 01:47:56,343 [trainer.py] => Average Accuracy (CNN): 91.73 

2024-04-21 01:47:56,343 [trainer.py] => Train Time: 16171.480000000001
2024-04-21 01:47:56,343 [trainer.py] => Test Time: 85.00999999999999 

2024-04-21 01:47:56,344 [trainer.py] => All params: 172004552
2024-04-21 01:47:56,345 [trainer.py] => Trainable params: 330340
2024-04-21 01:47:56,345 [dualprompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.393, Train_accy 88.26:   0%|          | 0/20 [01:12<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.393, Train_accy 88.26:   5%|▌         | 1/20 [01:12<22:57, 72.51s/it]
Task 2, Epoch 2/20 => Loss 0.184, Train_accy 93.80:   5%|▌         | 1/20 [02:24<22:57, 72.51s/it]
Task 2, Epoch 2/20 => Loss 0.184, Train_accy 93.80:  10%|█         | 2/20 [02:24<21:43, 72.41s/it]
Task 2, Epoch 3/20 => Loss 0.175, Train_accy 94.10:  10%|█         | 2/20 [03:35<21:43, 72.41s/it]
Task 2, Epoch 3/20 => Loss 0.175, Train_accy 94.10:  15%|█▌        | 3/20 [03:35<20:19, 71.72s/it]
Task 2, Epoch 4/20 => Loss 0.163, Train_accy 93.98:  15%|█▌        | 3/20 [04:35<20:19, 71.72s/it]
Task 2, Epoch 4/20 => Loss 0.163, Train_accy 93.98:  20%|██        | 4/20 [04:35<17:49, 66.82s/it]
Task 2, Epoch 5/20 => Loss 0.137, Train_accy 94.70, Test_accy 87.86:  20%|██        | 4/20 [06:18<17:49, 66.82s/it]
Task 2, Epoch 5/20 => Loss 0.137, Train_accy 94.70, Test_accy 87.86:  25%|██▌       | 5/20 [06:18<20:02, 80.14s/it]
Task 2, Epoch 6/20 => Loss 0.138, Train_accy 94.64:  25%|██▌       | 5/20 [07:30<20:02, 80.14s/it]                 
Task 2, Epoch 6/20 => Loss 0.138, Train_accy 94.64:  30%|███       | 6/20 [07:30<18:03, 77.36s/it]
Task 2, Epoch 7/20 => Loss 0.133, Train_accy 94.52:  30%|███       | 6/20 [08:42<18:03, 77.36s/it]
Task 2, Epoch 7/20 => Loss 0.133, Train_accy 94.52:  35%|███▌      | 7/20 [08:42<16:23, 75.67s/it]
Task 2, Epoch 8/20 => Loss 0.118, Train_accy 94.76:  35%|███▌      | 7/20 [09:54<16:23, 75.67s/it]
Task 2, Epoch 8/20 => Loss 0.118, Train_accy 94.76:  40%|████      | 8/20 [09:54<14:53, 74.50s/it]
Task 2, Epoch 9/20 => Loss 0.134, Train_accy 94.52:  40%|████      | 8/20 [10:59<14:53, 74.50s/it]
Task 2, Epoch 9/20 => Loss 0.134, Train_accy 94.52:  45%|████▌     | 9/20 [10:59<13:03, 71.27s/it]
Task 2, Epoch 10/20 => Loss 0.088, Train_accy 95.68, Test_accy 88.90:  45%|████▌     | 9/20 [12:35<13:03, 71.27s/it]
Task 2, Epoch 10/20 => Loss 0.088, Train_accy 95.68, Test_accy 88.90:  50%|█████     | 10/20 [12:35<13:11, 79.10s/it]
Task 2, Epoch 11/20 => Loss 0.100, Train_accy 95.38:  50%|█████     | 10/20 [13:47<13:11, 79.10s/it]                 
Task 2, Epoch 11/20 => Loss 0.100, Train_accy 95.38:  55%|█████▌    | 11/20 [13:47<11:31, 76.82s/it]
Task 2, Epoch 12/20 => Loss 0.107, Train_accy 94.44:  55%|█████▌    | 11/20 [14:59<11:31, 76.82s/it]
Task 2, Epoch 12/20 => Loss 0.107, Train_accy 94.44:  60%|██████    | 12/20 [14:59<10:03, 75.43s/it]
Task 2, Epoch 13/20 => Loss 0.089, Train_accy 95.34:  60%|██████    | 12/20 [16:11<10:03, 75.43s/it]
Task 2, Epoch 13/20 => Loss 0.089, Train_accy 95.34:  65%|██████▌   | 13/20 [16:11<08:40, 74.36s/it]
Task 2, Epoch 14/20 => Loss 0.114, Train_accy 94.12:  65%|██████▌   | 13/20 [17:18<08:40, 74.36s/it]
Task 2, Epoch 14/20 => Loss 0.114, Train_accy 94.12:  70%|███████   | 14/20 [17:18<07:11, 72.00s/it]
Task 2, Epoch 15/20 => Loss 0.096, Train_accy 95.10, Test_accy 89.06:  70%|███████   | 14/20 [18:47<07:11, 72.00s/it]
Task 2, Epoch 15/20 => Loss 0.096, Train_accy 95.10, Test_accy 89.06:  75%|███████▌  | 15/20 [18:47<06:26, 77.36s/it]
Task 2, Epoch 16/20 => Loss 0.085, Train_accy 95.30:  75%|███████▌  | 15/20 [19:59<06:26, 77.36s/it]                 
Task 2, Epoch 16/20 => Loss 0.085, Train_accy 95.30:  80%|████████  | 16/20 [19:59<05:03, 75.75s/it]
Task 2, Epoch 17/20 => Loss 0.080, Train_accy 95.30:  80%|████████  | 16/20 [21:12<05:03, 75.75s/it]
Task 2, Epoch 17/20 => Loss 0.080, Train_accy 95.30:  85%|████████▌ | 17/20 [21:12<03:44, 74.68s/it]
Task 2, Epoch 18/20 => Loss 0.084, Train_accy 95.12:  85%|████████▌ | 17/20 [22:23<03:44, 74.68s/it]
Task 2, Epoch 18/20 => Loss 0.084, Train_accy 95.12:  90%|█████████ | 18/20 [22:23<02:27, 73.76s/it]
Task 2, Epoch 19/20 => Loss 0.086, Train_accy 95.26:  90%|█████████ | 18/20 [23:32<02:27, 73.76s/it]
Task 2, Epoch 19/20 => Loss 0.086, Train_accy 95.26:  95%|█████████▌| 19/20 [23:32<01:12, 72.40s/it]
Task 2, Epoch 20/20 => Loss 0.085, Train_accy 94.94, Test_accy 89.20:  95%|█████████▌| 19/20 [25:04<01:12, 72.40s/it]
Task 2, Epoch 20/20 => Loss 0.085, Train_accy 94.94, Test_accy 89.20: 100%|██████████| 20/20 [25:04<00:00, 78.21s/it]
Task 2, Epoch 20/20 => Loss 0.085, Train_accy 94.94, Test_accy 89.20: 100%|██████████| 20/20 [25:04<00:00, 75.24s/it]
2024-04-21 02:13:01,115 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.085, Train_accy 94.94, Test_accy 89.20
2024-04-21 02:14:07,782 [trainer.py] => No NME accuracy.
2024-04-21 02:14:07,783 [trainer.py] => CNN: {'total': 89.2, '00-49': 92.48, '50-59': 76.4, '60-69': 85.6, 'old': 89.8, 'new': 85.6}
2024-04-21 02:14:07,783 [trainer.py] => CNN top1 curve: [92.98, 90.48, 89.2]
2024-04-21 02:14:07,783 [trainer.py] => CNN top5 curve: [99.0, 98.77, 98.5]

Average Accuracy (CNN): 90.89
2024-04-21 02:14:07,783 [trainer.py] => Average Accuracy (CNN): 90.89 

2024-04-21 02:14:07,783 [trainer.py] => Train Time: 19180.89
2024-04-21 02:14:07,783 [trainer.py] => Test Time: 151.68 

2024-04-21 02:14:07,786 [trainer.py] => All params: 172004552
2024-04-21 02:14:07,787 [trainer.py] => Trainable params: 330340
2024-04-21 02:14:07,788 [dualprompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.470, Train_accy 85.40:   0%|          | 0/20 [01:12<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.470, Train_accy 85.40:   5%|▌         | 1/20 [01:12<22:52, 72.24s/it]
Task 3, Epoch 2/20 => Loss 0.247, Train_accy 91.46:   5%|▌         | 1/20 [02:24<22:52, 72.24s/it]
Task 3, Epoch 2/20 => Loss 0.247, Train_accy 91.46:  10%|█         | 2/20 [02:24<21:45, 72.50s/it]
Task 3, Epoch 3/20 => Loss 0.237, Train_accy 91.58:  10%|█         | 2/20 [03:36<21:45, 72.50s/it]
Task 3, Epoch 3/20 => Loss 0.237, Train_accy 91.58:  15%|█▌        | 3/20 [03:36<20:22, 71.89s/it]
Task 3, Epoch 4/20 => Loss 0.205, Train_accy 92.14:  15%|█▌        | 3/20 [04:35<20:22, 71.89s/it]
Task 3, Epoch 4/20 => Loss 0.205, Train_accy 92.14:  20%|██        | 4/20 [04:35<17:49, 66.81s/it]
Task 3, Epoch 5/20 => Loss 0.182, Train_accy 92.52, Test_accy 82.71:  20%|██        | 4/20 [06:25<17:49, 66.81s/it]
Task 3, Epoch 5/20 => Loss 0.182, Train_accy 92.52, Test_accy 82.71:  25%|██▌       | 5/20 [06:25<20:37, 82.52s/it]
Task 3, Epoch 6/20 => Loss 0.189, Train_accy 92.14:  25%|██▌       | 5/20 [07:37<20:37, 82.52s/it]                 
Task 3, Epoch 6/20 => Loss 0.189, Train_accy 92.14:  30%|███       | 6/20 [07:37<18:27, 79.09s/it]
Task 3, Epoch 7/20 => Loss 0.170, Train_accy 92.34:  30%|███       | 6/20 [08:50<18:27, 79.09s/it]
Task 3, Epoch 7/20 => Loss 0.170, Train_accy 92.34:  35%|███▌      | 7/20 [08:50<16:39, 76.87s/it]
Task 3, Epoch 8/20 => Loss 0.151, Train_accy 93.46:  35%|███▌      | 7/20 [10:02<16:39, 76.87s/it]
Task 3, Epoch 8/20 => Loss 0.151, Train_accy 93.46:  40%|████      | 8/20 [10:02<15:03, 75.29s/it]
Task 3, Epoch 9/20 => Loss 0.157, Train_accy 93.18:  40%|████      | 8/20 [11:03<15:03, 75.29s/it]
Task 3, Epoch 9/20 => Loss 0.157, Train_accy 93.18:  45%|████▌     | 9/20 [11:03<13:01, 71.05s/it]
Task 3, Epoch 10/20 => Loss 0.150, Train_accy 93.36, Test_accy 83.89:  45%|████▌     | 9/20 [12:53<13:01, 71.05s/it]
Task 3, Epoch 10/20 => Loss 0.150, Train_accy 93.36, Test_accy 83.89:  50%|█████     | 10/20 [12:53<13:49, 82.90s/it]
Task 3, Epoch 11/20 => Loss 0.148, Train_accy 93.54:  50%|█████     | 10/20 [14:05<13:49, 82.90s/it]                 
Task 3, Epoch 11/20 => Loss 0.148, Train_accy 93.54:  55%|█████▌    | 11/20 [14:05<11:55, 79.52s/it]
Task 3, Epoch 12/20 => Loss 0.139, Train_accy 93.42:  55%|█████▌    | 11/20 [15:17<11:55, 79.52s/it]
Task 3, Epoch 12/20 => Loss 0.139, Train_accy 93.42:  60%|██████    | 12/20 [15:17<10:18, 77.33s/it]
Task 3, Epoch 13/20 => Loss 0.143, Train_accy 93.18:  60%|██████    | 12/20 [16:29<10:18, 77.33s/it]
Task 3, Epoch 13/20 => Loss 0.143, Train_accy 93.18:  65%|██████▌   | 13/20 [16:29<08:50, 75.85s/it]
Task 3, Epoch 14/20 => Loss 0.140, Train_accy 93.64:  65%|██████▌   | 13/20 [17:36<08:50, 75.85s/it]
Task 3, Epoch 14/20 => Loss 0.140, Train_accy 93.64:  70%|███████   | 14/20 [17:36<07:19, 73.17s/it]
Task 3, Epoch 15/20 => Loss 0.136, Train_accy 93.14, Test_accy 84.44:  70%|███████   | 14/20 [19:13<07:19, 73.17s/it]
Task 3, Epoch 15/20 => Loss 0.136, Train_accy 93.14, Test_accy 84.44:  75%|███████▌  | 15/20 [19:13<06:41, 80.26s/it]
Task 3, Epoch 16/20 => Loss 0.125, Train_accy 93.44:  75%|███████▌  | 15/20 [20:26<06:41, 80.26s/it]                 
Task 3, Epoch 16/20 => Loss 0.125, Train_accy 93.44:  80%|████████  | 16/20 [20:26<05:11, 77.92s/it]
Task 3, Epoch 17/20 => Loss 0.136, Train_accy 93.22:  80%|████████  | 16/20 [21:38<05:11, 77.92s/it]
Task 3, Epoch 17/20 => Loss 0.136, Train_accy 93.22:  85%|████████▌ | 17/20 [21:38<03:48, 76.33s/it]
Task 3, Epoch 18/20 => Loss 0.120, Train_accy 93.88:  85%|████████▌ | 17/20 [22:50<03:48, 76.33s/it]
Task 3, Epoch 18/20 => Loss 0.120, Train_accy 93.88:  90%|█████████ | 18/20 [22:50<02:29, 74.95s/it]
Task 3, Epoch 19/20 => Loss 0.121, Train_accy 93.18:  90%|█████████ | 18/20 [24:01<02:29, 74.95s/it]
Task 3, Epoch 19/20 => Loss 0.121, Train_accy 93.18:  95%|█████████▌| 19/20 [24:01<01:13, 73.67s/it]
Task 3, Epoch 20/20 => Loss 0.110, Train_accy 94.00, Test_accy 85.36:  95%|█████████▌| 19/20 [25:44<01:13, 73.67s/it]
Task 3, Epoch 20/20 => Loss 0.110, Train_accy 94.00, Test_accy 85.36: 100%|██████████| 20/20 [25:44<00:00, 82.73s/it]
Task 3, Epoch 20/20 => Loss 0.110, Train_accy 94.00, Test_accy 85.36: 100%|██████████| 20/20 [25:44<00:00, 77.25s/it]
2024-04-21 02:39:52,828 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.110, Train_accy 94.00, Test_accy 85.36
2024-04-21 02:41:05,362 [trainer.py] => No NME accuracy.
2024-04-21 02:41:05,362 [trainer.py] => CNN: {'total': 85.36, '00-49': 92.46, '50-59': 76.8, '60-69': 84.6, '70-79': 59.2, 'old': 89.1, 'new': 59.2}
2024-04-21 02:41:05,362 [trainer.py] => CNN top1 curve: [92.98, 90.48, 89.2, 85.36]
2024-04-21 02:41:05,362 [trainer.py] => CNN top5 curve: [99.0, 98.77, 98.5, 98.1]

Average Accuracy (CNN): 89.51
2024-04-21 02:41:05,362 [trainer.py] => Average Accuracy (CNN): 89.51 

2024-04-21 02:41:05,362 [trainer.py] => Train Time: 22270.82
2024-04-21 02:41:05,363 [trainer.py] => Test Time: 224.21 

2024-04-21 02:41:05,364 [trainer.py] => All params: 172004552
2024-04-21 02:41:05,366 [trainer.py] => Trainable params: 330340
2024-04-21 02:41:05,366 [dualprompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.467, Train_accy 85.30:   0%|          | 0/20 [01:12<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.467, Train_accy 85.30:   5%|▌         | 1/20 [01:12<22:59, 72.59s/it]
Task 4, Epoch 2/20 => Loss 0.251, Train_accy 91.30:   5%|▌         | 1/20 [02:25<22:59, 72.59s/it]
Task 4, Epoch 2/20 => Loss 0.251, Train_accy 91.30:  10%|█         | 2/20 [02:25<21:45, 72.53s/it]
Task 4, Epoch 3/20 => Loss 0.198, Train_accy 92.94:  10%|█         | 2/20 [03:37<21:45, 72.53s/it]
Task 4, Epoch 3/20 => Loss 0.198, Train_accy 92.94:  15%|█▌        | 3/20 [03:37<20:30, 72.37s/it]
Task 4, Epoch 4/20 => Loss 0.184, Train_accy 93.52:  15%|█▌        | 3/20 [04:43<20:30, 72.37s/it]
Task 4, Epoch 4/20 => Loss 0.184, Train_accy 93.52:  20%|██        | 4/20 [04:43<18:37, 69.81s/it]
Task 4, Epoch 5/20 => Loss 0.167, Train_accy 93.44, Test_accy 80.04:  20%|██        | 4/20 [06:26<18:37, 69.81s/it]
Task 4, Epoch 5/20 => Loss 0.167, Train_accy 93.44, Test_accy 80.04:  25%|██▌       | 5/20 [06:26<20:27, 81.86s/it]
Task 4, Epoch 6/20 => Loss 0.186, Train_accy 93.04:  25%|██▌       | 5/20 [07:38<20:27, 81.86s/it]                 
Task 4, Epoch 6/20 => Loss 0.186, Train_accy 93.04:  30%|███       | 6/20 [07:38<18:20, 78.63s/it]
Task 4, Epoch 7/20 => Loss 0.167, Train_accy 93.10:  30%|███       | 6/20 [08:51<18:20, 78.63s/it]
Task 4, Epoch 7/20 => Loss 0.167, Train_accy 93.10:  35%|███▌      | 7/20 [08:51<16:35, 76.59s/it]
Task 4, Epoch 8/20 => Loss 0.146, Train_accy 93.86:  35%|███▌      | 7/20 [10:03<16:35, 76.59s/it]
Task 4, Epoch 8/20 => Loss 0.146, Train_accy 93.86:  40%|████      | 8/20 [10:03<15:02, 75.17s/it]
Task 4, Epoch 9/20 => Loss 0.143, Train_accy 93.78:  40%|████      | 8/20 [11:12<15:02, 75.17s/it]
Task 4, Epoch 9/20 => Loss 0.143, Train_accy 93.78:  45%|████▌     | 9/20 [11:12<13:26, 73.35s/it]
Task 4, Epoch 10/20 => Loss 0.145, Train_accy 93.58, Test_accy 81.11:  45%|████▌     | 9/20 [12:56<13:26, 73.35s/it]
Task 4, Epoch 10/20 => Loss 0.145, Train_accy 93.58, Test_accy 81.11:  50%|█████     | 10/20 [12:56<13:49, 82.91s/it]
Task 4, Epoch 11/20 => Loss 0.152, Train_accy 93.36:  50%|█████     | 10/20 [14:08<13:49, 82.91s/it]                 
Task 4, Epoch 11/20 => Loss 0.152, Train_accy 93.36:  55%|█████▌    | 11/20 [14:08<11:55, 79.47s/it]
Task 4, Epoch 12/20 => Loss 0.118, Train_accy 94.32:  55%|█████▌    | 11/20 [15:20<11:55, 79.47s/it]
Task 4, Epoch 12/20 => Loss 0.118, Train_accy 94.32:  60%|██████    | 12/20 [15:20<10:17, 77.23s/it]
Task 4, Epoch 13/20 => Loss 0.120, Train_accy 94.50:  60%|██████    | 12/20 [16:33<10:17, 77.23s/it]
Task 4, Epoch 13/20 => Loss 0.120, Train_accy 94.50:  65%|██████▌   | 13/20 [16:33<08:50, 75.74s/it]
Task 4, Epoch 14/20 => Loss 0.130, Train_accy 93.66:  65%|██████▌   | 13/20 [17:45<08:50, 75.74s/it]
Task 4, Epoch 14/20 => Loss 0.130, Train_accy 93.66:  70%|███████   | 14/20 [17:45<07:28, 74.69s/it]
Task 4, Epoch 15/20 => Loss 0.133, Train_accy 93.56, Test_accy 81.53:  70%|███████   | 14/20 [19:40<07:28, 74.69s/it]
Task 4, Epoch 15/20 => Loss 0.133, Train_accy 93.56, Test_accy 81.53:  75%|███████▌  | 15/20 [19:40<07:14, 86.83s/it]
Task 4, Epoch 16/20 => Loss 0.119, Train_accy 94.22:  75%|███████▌  | 15/20 [20:40<07:14, 86.83s/it]                 
Task 4, Epoch 16/20 => Loss 0.119, Train_accy 94.22:  80%|████████  | 16/20 [20:40<05:15, 78.87s/it]
Task 4, Epoch 17/20 => Loss 0.118, Train_accy 94.00:  80%|████████  | 16/20 [21:52<05:15, 78.87s/it]
Task 4, Epoch 17/20 => Loss 0.118, Train_accy 94.00:  85%|████████▌ | 17/20 [21:52<03:50, 76.87s/it]
Task 4, Epoch 18/20 => Loss 0.105, Train_accy 94.76:  85%|████████▌ | 17/20 [23:04<03:50, 76.87s/it]
Task 4, Epoch 18/20 => Loss 0.105, Train_accy 94.76:  90%|█████████ | 18/20 [23:04<02:30, 75.33s/it]
Task 4, Epoch 19/20 => Loss 0.127, Train_accy 93.70:  90%|█████████ | 18/20 [24:17<02:30, 75.33s/it]
Task 4, Epoch 19/20 => Loss 0.127, Train_accy 93.70:  95%|█████████▌| 19/20 [24:17<01:14, 74.46s/it]
Task 4, Epoch 20/20 => Loss 0.129, Train_accy 93.60, Test_accy 82.10:  95%|█████████▌| 19/20 [26:23<01:14, 74.46s/it]
Task 4, Epoch 20/20 => Loss 0.129, Train_accy 93.60, Test_accy 82.10: 100%|██████████| 20/20 [26:23<00:00, 90.18s/it]
Task 4, Epoch 20/20 => Loss 0.129, Train_accy 93.60, Test_accy 82.10: 100%|██████████| 20/20 [26:23<00:00, 79.19s/it]
2024-04-21 03:07:29,254 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.129, Train_accy 93.60, Test_accy 82.10
2024-04-21 03:08:29,026 [trainer.py] => No NME accuracy.
2024-04-21 03:08:29,027 [trainer.py] => CNN: {'total': 82.1, '00-49': 92.48, '50-59': 75.9, '60-69': 83.0, '70-79': 57.4, '80-89': 60.2, 'old': 84.84, 'new': 60.2}
2024-04-21 03:08:29,027 [trainer.py] => CNN top1 curve: [92.98, 90.48, 89.2, 85.36, 82.1]
2024-04-21 03:08:29,027 [trainer.py] => CNN top5 curve: [99.0, 98.77, 98.5, 98.1, 97.62]

Average Accuracy (CNN): 88.02
2024-04-21 03:08:29,027 [trainer.py] => Average Accuracy (CNN): 88.02 

2024-04-21 03:08:29,027 [trainer.py] => Train Time: 25438.49
2024-04-21 03:08:29,027 [trainer.py] => Test Time: 283.98 

2024-04-21 03:08:29,028 [trainer.py] => All params: 172004552
2024-04-21 03:08:29,029 [trainer.py] => Trainable params: 330340
2024-04-21 03:08:29,030 [dualprompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.482, Train_accy 84.38:   0%|          | 0/20 [01:10<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.482, Train_accy 84.38:   5%|▌         | 1/20 [01:10<22:26, 70.87s/it]
Task 5, Epoch 2/20 => Loss 0.253, Train_accy 91.18:   5%|▌         | 1/20 [02:21<22:26, 70.87s/it]
Task 5, Epoch 2/20 => Loss 0.253, Train_accy 91.18:  10%|█         | 2/20 [02:21<21:13, 70.74s/it]
Task 5, Epoch 3/20 => Loss 0.232, Train_accy 91.76:  10%|█         | 2/20 [03:32<21:13, 70.74s/it]
Task 5, Epoch 3/20 => Loss 0.232, Train_accy 91.76:  15%|█▌        | 3/20 [03:32<20:05, 70.92s/it]
Task 5, Epoch 4/20 => Loss 0.223, Train_accy 91.72:  15%|█▌        | 3/20 [04:42<20:05, 70.92s/it]
Task 5, Epoch 4/20 => Loss 0.223, Train_accy 91.72:  20%|██        | 4/20 [04:42<18:50, 70.68s/it]
Task 5, Epoch 5/20 => Loss 0.207, Train_accy 92.26, Test_accy 78.49:  20%|██        | 4/20 [07:12<18:50, 70.68s/it]
Task 5, Epoch 5/20 => Loss 0.207, Train_accy 92.26, Test_accy 78.49:  25%|██▌       | 5/20 [07:12<24:48, 99.24s/it]
Task 5, Epoch 6/20 => Loss 0.192, Train_accy 92.78:  25%|██▌       | 5/20 [08:09<24:48, 99.24s/it]                 
Task 5, Epoch 6/20 => Loss 0.192, Train_accy 92.78:  30%|███       | 6/20 [08:09<19:47, 84.81s/it]
Task 5, Epoch 7/20 => Loss 0.175, Train_accy 93.00:  30%|███       | 6/20 [09:20<19:47, 84.81s/it]
Task 5, Epoch 7/20 => Loss 0.175, Train_accy 93.00:  35%|███▌      | 7/20 [09:20<17:21, 80.12s/it]
Task 5, Epoch 8/20 => Loss 0.166, Train_accy 93.10:  35%|███▌      | 7/20 [10:30<17:21, 80.12s/it]
Task 5, Epoch 8/20 => Loss 0.166, Train_accy 93.10:  40%|████      | 8/20 [10:30<15:26, 77.17s/it]
Task 5, Epoch 9/20 => Loss 0.180, Train_accy 92.58:  40%|████      | 8/20 [11:41<15:26, 77.17s/it]
Task 5, Epoch 9/20 => Loss 0.180, Train_accy 92.58:  45%|████▌     | 9/20 [11:41<13:46, 75.17s/it]
Task 5, Epoch 10/20 => Loss 0.154, Train_accy 93.32, Test_accy 79.70:  45%|████▌     | 9/20 [14:25<13:46, 75.17s/it]
Task 5, Epoch 10/20 => Loss 0.154, Train_accy 93.32, Test_accy 79.70:  50%|█████     | 10/20 [14:25<17:04, 102.47s/it]
Task 5, Epoch 11/20 => Loss 0.157, Train_accy 92.96:  50%|█████     | 10/20 [15:18<17:04, 102.47s/it]                 
Task 5, Epoch 11/20 => Loss 0.157, Train_accy 92.96:  55%|█████▌    | 11/20 [15:18<13:05, 87.24s/it] 
Task 5, Epoch 12/20 => Loss 0.144, Train_accy 93.64:  55%|█████▌    | 11/20 [16:19<13:05, 87.24s/it]
Task 5, Epoch 12/20 => Loss 0.144, Train_accy 93.64:  60%|██████    | 12/20 [16:19<10:35, 79.50s/it]
Task 5, Epoch 13/20 => Loss 0.147, Train_accy 93.58:  60%|██████    | 12/20 [17:30<10:35, 79.50s/it]
Task 5, Epoch 13/20 => Loss 0.147, Train_accy 93.58:  65%|██████▌   | 13/20 [17:30<08:57, 76.80s/it]
Task 5, Epoch 14/20 => Loss 0.146, Train_accy 93.58:  65%|██████▌   | 13/20 [18:41<08:57, 76.80s/it]
Task 5, Epoch 14/20 => Loss 0.146, Train_accy 93.58:  70%|███████   | 14/20 [18:41<07:29, 74.98s/it]
Task 5, Epoch 15/20 => Loss 0.164, Train_accy 93.10, Test_accy 80.19:  70%|███████   | 14/20 [21:24<07:29, 74.98s/it]
Task 5, Epoch 15/20 => Loss 0.164, Train_accy 93.10, Test_accy 80.19:  75%|███████▌  | 15/20 [21:24<08:28, 101.65s/it]
Task 5, Epoch 16/20 => Loss 0.136, Train_accy 93.56:  75%|███████▌  | 15/20 [22:33<08:28, 101.65s/it]                 
Task 5, Epoch 16/20 => Loss 0.136, Train_accy 93.56:  80%|████████  | 16/20 [22:33<06:07, 91.89s/it] 
Task 5, Epoch 17/20 => Loss 0.118, Train_accy 93.82:  80%|████████  | 16/20 [23:22<06:07, 91.89s/it]
Task 5, Epoch 17/20 => Loss 0.118, Train_accy 93.82:  85%|████████▌ | 17/20 [23:22<03:56, 78.87s/it]
Task 5, Epoch 18/20 => Loss 0.137, Train_accy 93.26:  85%|████████▌ | 17/20 [24:28<03:56, 78.87s/it]
Task 5, Epoch 18/20 => Loss 0.137, Train_accy 93.26:  90%|█████████ | 18/20 [24:28<02:29, 74.97s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 94.32:  90%|█████████ | 18/20 [25:39<02:29, 74.97s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 94.32:  95%|█████████▌| 19/20 [25:39<01:13, 73.69s/it]
Task 5, Epoch 20/20 => Loss 0.130, Train_accy 93.56, Test_accy 80.72:  95%|█████████▌| 19/20 [28:22<01:13, 73.69s/it]
Task 5, Epoch 20/20 => Loss 0.130, Train_accy 93.56, Test_accy 80.72: 100%|██████████| 20/20 [28:22<00:00, 100.67s/it]
Task 5, Epoch 20/20 => Loss 0.130, Train_accy 93.56, Test_accy 80.72: 100%|██████████| 20/20 [28:22<00:00, 85.13s/it] 
2024-04-21 03:36:51,706 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.130, Train_accy 93.56, Test_accy 80.72
2024-04-21 03:38:24,844 [trainer.py] => No NME accuracy.
2024-04-21 03:38:24,845 [trainer.py] => CNN: {'total': 80.72, '00-49': 92.54, '50-59': 75.5, '60-69': 83.3, '70-79': 58.0, '80-89': 60.6, '90-99': 67.1, 'old': 82.23, 'new': 67.1}
2024-04-21 03:38:24,845 [trainer.py] => CNN top1 curve: [92.98, 90.48, 89.2, 85.36, 82.1, 80.72]
2024-04-21 03:38:24,845 [trainer.py] => CNN top5 curve: [99.0, 98.77, 98.5, 98.1, 97.62, 97.34]

Average Accuracy (CNN): 86.81
2024-04-21 03:38:24,845 [trainer.py] => Average Accuracy (CNN): 86.81 

2024-04-21 03:38:24,845 [trainer.py] => Train Time: 28843.760000000002
2024-04-21 03:38:24,845 [trainer.py] => Test Time: 377.12 

Accuracy Matrix (CNN):
[[92.98 92.68 92.48 92.46 92.48 92.54]
 [ 0.   79.5  76.4  76.8  75.9  75.5 ]
 [ 0.    0.   85.6  84.6  83.   83.3 ]
 [ 0.    0.    0.   59.2  57.4  58.  ]
 [ 0.    0.    0.    0.   60.2  60.6 ]
 [ 0.    0.    0.    0.    0.   67.1 ]]
2024-04-21 03:38:24,847 [trainer.py] => Forgetting (CNN): 1.5879999999999996
2024-04-21 03:38:29,145 [trainer.py] => config: ./exps/coda_prompt_B50.json
2024-04-21 03:38:29,146 [trainer.py] => prefix:  
2024-04-21 03:38:29,146 [trainer.py] => dataset: cifar224
2024-04-21 03:38:29,146 [trainer.py] => memory_size: 0
2024-04-21 03:38:29,146 [trainer.py] => memory_per_class: 0
2024-04-21 03:38:29,146 [trainer.py] => fixed_memory: False
2024-04-21 03:38:29,146 [trainer.py] => shuffle: False
2024-04-21 03:38:29,146 [trainer.py] => init_cls: 50
2024-04-21 03:38:29,146 [trainer.py] => increment: 10
2024-04-21 03:38:29,146 [trainer.py] => model_name: coda_prompt
2024-04-21 03:38:29,146 [trainer.py] => backbone_type: vit_base_patch16_224_coda_prompt
2024-04-21 03:38:29,146 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-21 03:38:29,146 [trainer.py] => seed: 1993
2024-04-21 03:38:29,146 [trainer.py] => tuned_epoch: 20
2024-04-21 03:38:29,146 [trainer.py] => init_lr: 0.001
2024-04-21 03:38:29,146 [trainer.py] => batch_size: 48
2024-04-21 03:38:29,147 [trainer.py] => weight_decay: 0
2024-04-21 03:38:29,147 [trainer.py] => min_lr: 1e-05
2024-04-21 03:38:29,147 [trainer.py] => optimizer: adam
2024-04-21 03:38:29,147 [trainer.py] => scheduler: cosine
2024-04-21 03:38:29,147 [trainer.py] => reinit_optimizer: True
2024-04-21 03:38:29,147 [trainer.py] => pretrained: True
2024-04-21 03:38:29,147 [trainer.py] => drop: 0.0
2024-04-21 03:38:29,147 [trainer.py] => drop_path: 0.0
2024-04-21 03:38:29,147 [trainer.py] => prompt_param: [100, 8.0, 0.0]
Files already downloaded and verified
Files already downloaded and verified
2024-04-21 03:38:31,377 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-04-21 03:38:33,950 [coda_prompt.py] => 89,715,556 total parameters.
2024-04-21 03:38:33,950 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-04-21 03:38:33,950 [trainer.py] => All params: 89715556
2024-04-21 03:38:33,951 [trainer.py] => Trainable params: 89715556
2024-04-21 03:38:33,951 [coda_prompt.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.960, Train_accy 74.56:   0%|          | 0/20 [06:50<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.960, Train_accy 74.56:   5%|▌         | 1/20 [06:50<2:09:51, 410.10s/it]
Task 0, Epoch 2/20 => Loss 0.612, Train_accy 82.96:   5%|▌         | 1/20 [13:38<2:09:51, 410.10s/it]
Task 0, Epoch 2/20 => Loss 0.612, Train_accy 82.96:  10%|█         | 2/20 [13:38<2:02:48, 409.34s/it]
Task 0, Epoch 3/20 => Loss 0.556, Train_accy 84.31:  10%|█         | 2/20 [20:26<2:02:48, 409.34s/it]
Task 0, Epoch 3/20 => Loss 0.556, Train_accy 84.31:  15%|█▌        | 3/20 [20:26<1:55:47, 408.70s/it]
Task 0, Epoch 4/20 => Loss 0.517, Train_accy 85.19:  15%|█▌        | 3/20 [27:13<1:55:47, 408.70s/it]
Task 0, Epoch 4/20 => Loss 0.517, Train_accy 85.19:  20%|██        | 4/20 [27:13<1:48:49, 408.08s/it]
Task 0, Epoch 5/20 => Loss 0.511, Train_accy 85.26, Test_accy 93.38:  20%|██        | 4/20 [34:48<1:48:49, 408.08s/it]
Task 0, Epoch 5/20 => Loss 0.511, Train_accy 85.26, Test_accy 93.38:  25%|██▌       | 5/20 [34:48<1:46:12, 424.83s/it]
Task 0, Epoch 6/20 => Loss 0.485, Train_accy 85.96:  25%|██▌       | 5/20 [41:44<1:46:12, 424.83s/it]                 
Task 0, Epoch 6/20 => Loss 0.485, Train_accy 85.96:  30%|███       | 6/20 [41:44<1:38:25, 421.82s/it]
Task 0, Epoch 7/20 => Loss 0.475, Train_accy 86.28:  30%|███       | 6/20 [48:54<1:38:25, 421.82s/it]
Task 0, Epoch 7/20 => Loss 0.475, Train_accy 86.28:  35%|███▌      | 7/20 [48:54<1:31:59, 424.59s/it]
Task 0, Epoch 8/20 => Loss 0.470, Train_accy 86.35:  35%|███▌      | 7/20 [55:45<1:31:59, 424.59s/it]
Task 0, Epoch 8/20 => Loss 0.470, Train_accy 86.35:  40%|████      | 8/20 [55:45<1:24:00, 420.08s/it]
Task 0, Epoch 9/20 => Loss 0.439, Train_accy 87.41:  40%|████      | 8/20 [1:02:34<1:24:00, 420.08s/it]
Task 0, Epoch 9/20 => Loss 0.439, Train_accy 87.41:  45%|████▌     | 9/20 [1:02:34<1:16:24, 416.78s/it]
Task 0, Epoch 10/20 => Loss 0.439, Train_accy 87.20, Test_accy 93.64:  45%|████▌     | 9/20 [1:10:12<1:16:24, 416.78s/it]
Task 0, Epoch 10/20 => Loss 0.439, Train_accy 87.20, Test_accy 93.64:  50%|█████     | 10/20 [1:10:12<1:11:34, 429.48s/it]
Task 0, Epoch 11/20 => Loss 0.424, Train_accy 88.09:  50%|█████     | 10/20 [1:16:34<1:11:34, 429.48s/it]                 
Task 0, Epoch 11/20 => Loss 0.424, Train_accy 88.09:  55%|█████▌    | 11/20 [1:16:34<1:02:14, 414.99s/it]
Task 0, Epoch 12/20 => Loss 0.421, Train_accy 87.79:  55%|█████▌    | 11/20 [1:23:17<1:02:14, 414.99s/it]
Task 0, Epoch 12/20 => Loss 0.421, Train_accy 87.79:  60%|██████    | 12/20 [1:23:17<54:49, 411.19s/it]  
Task 0, Epoch 13/20 => Loss 0.400, Train_accy 88.21:  60%|██████    | 12/20 [1:30:07<54:49, 411.19s/it]
Task 0, Epoch 13/20 => Loss 0.400, Train_accy 88.21:  65%|██████▌   | 13/20 [1:30:07<47:55, 410.80s/it]
Task 0, Epoch 14/20 => Loss 0.392, Train_accy 88.67:  65%|██████▌   | 13/20 [1:36:52<47:55, 410.80s/it]
Task 0, Epoch 14/20 => Loss 0.392, Train_accy 88.67:  70%|███████   | 14/20 [1:36:52<40:54, 409.08s/it]
Task 0, Epoch 15/20 => Loss 0.381, Train_accy 88.83, Test_accy 94.26:  70%|███████   | 14/20 [1:43:50<40:54, 409.08s/it]
Task 0, Epoch 15/20 => Loss 0.381, Train_accy 88.83, Test_accy 94.26:  75%|███████▌  | 15/20 [1:43:50<34:18, 411.70s/it]
Task 0, Epoch 16/20 => Loss 0.378, Train_accy 89.15:  75%|███████▌  | 15/20 [1:50:32<34:18, 411.70s/it]                 
Task 0, Epoch 16/20 => Loss 0.378, Train_accy 89.15:  80%|████████  | 16/20 [1:50:32<27:15, 408.91s/it]
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 89.20:  80%|████████  | 16/20 [1:57:14<27:15, 408.91s/it]
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 89.20:  85%|████████▌ | 17/20 [1:57:14<20:20, 406.90s/it]
Task 0, Epoch 18/20 => Loss 0.354, Train_accy 89.68:  85%|████████▌ | 17/20 [2:03:57<20:20, 406.90s/it]
Task 0, Epoch 18/20 => Loss 0.354, Train_accy 89.68:  90%|█████████ | 18/20 [2:03:57<13:31, 405.66s/it]
Task 0, Epoch 19/20 => Loss 0.343, Train_accy 89.90:  90%|█████████ | 18/20 [2:10:39<13:31, 405.66s/it]
Task 0, Epoch 19/20 => Loss 0.343, Train_accy 89.90:  95%|█████████▌| 19/20 [2:10:39<06:44, 404.72s/it]
Task 0, Epoch 20/20 => Loss 0.343, Train_accy 90.14, Test_accy 94.32:  95%|█████████▌| 19/20 [2:17:54<06:44, 404.72s/it]
Task 0, Epoch 20/20 => Loss 0.343, Train_accy 90.14, Test_accy 94.32: 100%|██████████| 20/20 [2:17:54<00:00, 413.72s/it]
Task 0, Epoch 20/20 => Loss 0.343, Train_accy 90.14, Test_accy 94.32: 100%|██████████| 20/20 [2:17:54<00:00, 413.73s/it]
2024-04-21 05:56:29,445 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.343, Train_accy 90.14, Test_accy 94.32
2024-04-21 05:56:57,034 [trainer.py] => No NME accuracy.
2024-04-21 05:56:57,035 [trainer.py] => CNN: {'total': 94.32, '00-49': 94.32, 'old': 0, 'new': 94.32}
2024-04-21 05:56:57,035 [trainer.py] => CNN top1 curve: [94.32]
2024-04-21 05:56:57,035 [trainer.py] => CNN top5 curve: [99.54]

Average Accuracy (CNN): 94.32
2024-04-21 05:56:57,035 [trainer.py] => Average Accuracy (CNN): 94.32 

2024-04-21 05:56:57,035 [trainer.py] => Train Time: 16550.09
2024-04-21 05:56:57,035 [trainer.py] => Test Time: 27.59 

2024-04-21 05:56:57,036 [trainer.py] => All params: 89715556
2024-04-21 05:56:57,037 [trainer.py] => Trainable params: 89715556
2024-04-21 05:56:58,730 [coda_prompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.406, Train_accy 86.88:   0%|          | 0/20 [01:30<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.406, Train_accy 86.88:   5%|▌         | 1/20 [01:30<28:33, 90.20s/it]
Task 1, Epoch 2/20 => Loss 0.207, Train_accy 92.91:   5%|▌         | 1/20 [02:59<28:33, 90.20s/it]
Task 1, Epoch 2/20 => Loss 0.207, Train_accy 92.91:  10%|█         | 2/20 [02:59<26:58, 89.92s/it]
Task 1, Epoch 3/20 => Loss 0.181, Train_accy 93.69:  10%|█         | 2/20 [04:29<26:58, 89.92s/it]
Task 1, Epoch 3/20 => Loss 0.181, Train_accy 93.69:  15%|█▌        | 3/20 [04:29<25:23, 89.62s/it]
Task 1, Epoch 4/20 => Loss 0.172, Train_accy 93.87:  15%|█▌        | 3/20 [05:37<25:23, 89.62s/it]
Task 1, Epoch 4/20 => Loss 0.172, Train_accy 93.87:  20%|██        | 4/20 [05:37<21:39, 81.19s/it]
Task 1, Epoch 5/20 => Loss 0.154, Train_accy 94.25, Test_accy 87.52:  20%|██        | 4/20 [07:40<21:39, 81.19s/it]
Task 1, Epoch 5/20 => Loss 0.154, Train_accy 94.25, Test_accy 87.52:  25%|██▌       | 5/20 [07:40<24:03, 96.21s/it]
Task 1, Epoch 6/20 => Loss 0.161, Train_accy 94.13:  25%|██▌       | 5/20 [09:09<24:03, 96.21s/it]                 
Task 1, Epoch 6/20 => Loss 0.161, Train_accy 94.13:  30%|███       | 6/20 [09:09<21:55, 93.95s/it]
Task 1, Epoch 7/20 => Loss 0.165, Train_accy 93.95:  30%|███       | 6/20 [10:39<21:55, 93.95s/it]
Task 1, Epoch 7/20 => Loss 0.165, Train_accy 93.95:  35%|███▌      | 7/20 [10:39<20:01, 92.43s/it]
Task 1, Epoch 8/20 => Loss 0.152, Train_accy 94.49:  35%|███▌      | 7/20 [11:47<20:01, 92.43s/it]
Task 1, Epoch 8/20 => Loss 0.152, Train_accy 94.49:  40%|████      | 8/20 [11:47<16:56, 84.69s/it]
Task 1, Epoch 9/20 => Loss 0.149, Train_accy 94.69:  40%|████      | 8/20 [12:54<16:56, 84.69s/it]
Task 1, Epoch 9/20 => Loss 0.149, Train_accy 94.69:  45%|████▌     | 9/20 [12:54<14:30, 79.15s/it]
Task 1, Epoch 10/20 => Loss 0.150, Train_accy 94.67, Test_accy 88.70:  45%|████▌     | 9/20 [15:19<14:30, 79.15s/it]
Task 1, Epoch 10/20 => Loss 0.150, Train_accy 94.67, Test_accy 88.70:  50%|█████     | 10/20 [15:19<16:36, 99.61s/it]
Task 1, Epoch 11/20 => Loss 0.146, Train_accy 95.11:  50%|█████     | 10/20 [16:48<16:36, 99.61s/it]                 
Task 1, Epoch 11/20 => Loss 0.146, Train_accy 95.11:  55%|█████▌    | 11/20 [16:48<14:27, 96.38s/it]
Task 1, Epoch 12/20 => Loss 0.142, Train_accy 94.93:  55%|█████▌    | 11/20 [17:56<14:27, 96.38s/it]
Task 1, Epoch 12/20 => Loss 0.142, Train_accy 94.93:  60%|██████    | 12/20 [17:56<11:42, 87.81s/it]
Task 1, Epoch 13/20 => Loss 0.155, Train_accy 94.55:  60%|██████    | 12/20 [19:03<11:42, 87.81s/it]
Task 1, Epoch 13/20 => Loss 0.155, Train_accy 94.55:  65%|██████▌   | 13/20 [19:03<09:30, 81.48s/it]
Task 1, Epoch 14/20 => Loss 0.139, Train_accy 95.09:  65%|██████▌   | 13/20 [20:33<09:30, 81.48s/it]
Task 1, Epoch 14/20 => Loss 0.139, Train_accy 95.09:  70%|███████   | 14/20 [20:33<08:24, 84.05s/it]
Task 1, Epoch 15/20 => Loss 0.132, Train_accy 95.05, Test_accy 89.38:  70%|███████   | 14/20 [22:59<08:24, 84.05s/it]
Task 1, Epoch 15/20 => Loss 0.132, Train_accy 95.05, Test_accy 89.38:  75%|███████▌  | 15/20 [22:59<08:32, 102.53s/it]
Task 1, Epoch 16/20 => Loss 0.122, Train_accy 95.45:  75%|███████▌  | 15/20 [24:07<08:32, 102.53s/it]                 
Task 1, Epoch 16/20 => Loss 0.122, Train_accy 95.45:  80%|████████  | 16/20 [24:07<06:08, 92.10s/it] 
Task 1, Epoch 17/20 => Loss 0.142, Train_accy 95.07:  80%|████████  | 16/20 [25:16<06:08, 92.10s/it]
Task 1, Epoch 17/20 => Loss 0.142, Train_accy 95.07:  85%|████████▌ | 17/20 [25:16<04:15, 85.16s/it]
Task 1, Epoch 18/20 => Loss 0.125, Train_accy 95.69:  85%|████████▌ | 17/20 [26:45<04:15, 85.16s/it]
Task 1, Epoch 18/20 => Loss 0.125, Train_accy 95.69:  90%|█████████ | 18/20 [26:45<02:53, 86.53s/it]
Task 1, Epoch 19/20 => Loss 0.120, Train_accy 95.61:  90%|█████████ | 18/20 [28:15<02:53, 86.53s/it]
Task 1, Epoch 19/20 => Loss 0.120, Train_accy 95.61:  95%|█████████▌| 19/20 [28:15<01:27, 87.49s/it]
Task 1, Epoch 20/20 => Loss 0.107, Train_accy 96.15, Test_accy 89.32:  95%|█████████▌| 19/20 [30:17<01:27, 87.49s/it]
Task 1, Epoch 20/20 => Loss 0.107, Train_accy 96.15, Test_accy 89.32: 100%|██████████| 20/20 [30:17<00:00, 97.72s/it]
Task 1, Epoch 20/20 => Loss 0.107, Train_accy 96.15, Test_accy 89.32: 100%|██████████| 20/20 [30:17<00:00, 90.86s/it]
2024-04-21 06:27:15,884 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.107, Train_accy 96.15, Test_accy 89.32
2024-04-21 06:27:53,895 [trainer.py] => No NME accuracy.
2024-04-21 06:27:53,896 [trainer.py] => CNN: {'total': 89.32, '00-49': 94.06, '50-59': 65.6, 'old': 94.06, 'new': 65.6}
2024-04-21 06:27:53,896 [trainer.py] => CNN top1 curve: [94.32, 89.32]
2024-04-21 06:27:53,896 [trainer.py] => CNN top5 curve: [99.54, 99.4]

Average Accuracy (CNN): 91.82
2024-04-21 06:27:53,896 [trainer.py] => Average Accuracy (CNN): 91.82 

2024-04-21 06:27:53,896 [trainer.py] => Train Time: 20184.329999999998
2024-04-21 06:27:53,896 [trainer.py] => Test Time: 65.6 

2024-04-21 06:27:53,897 [trainer.py] => All params: 89715556
2024-04-21 06:27:53,897 [trainer.py] => Trainable params: 89715556
2024-04-21 06:28:02,893 [coda_prompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.420, Train_accy 86.10:   0%|          | 0/20 [01:30<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.420, Train_accy 86.10:   5%|▌         | 1/20 [01:30<28:30, 90.02s/it]
Task 2, Epoch 2/20 => Loss 0.194, Train_accy 92.97:   5%|▌         | 1/20 [03:00<28:30, 90.02s/it]
Task 2, Epoch 2/20 => Loss 0.194, Train_accy 92.97:  10%|█         | 2/20 [03:00<27:06, 90.37s/it]
Task 2, Epoch 3/20 => Loss 0.192, Train_accy 93.55:  10%|█         | 2/20 [04:27<27:06, 90.37s/it]
Task 2, Epoch 3/20 => Loss 0.192, Train_accy 93.55:  15%|█▌        | 3/20 [04:27<25:12, 88.96s/it]
Task 2, Epoch 4/20 => Loss 0.186, Train_accy 93.77:  15%|█▌        | 3/20 [05:34<25:12, 88.96s/it]
Task 2, Epoch 4/20 => Loss 0.186, Train_accy 93.77:  20%|██        | 4/20 [05:34<21:23, 80.20s/it]
Task 2, Epoch 5/20 => Loss 0.171, Train_accy 94.09, Test_accy 84.06:  20%|██        | 4/20 [07:44<21:23, 80.20s/it]
Task 2, Epoch 5/20 => Loss 0.171, Train_accy 94.09, Test_accy 84.06:  25%|██▌       | 5/20 [07:44<24:29, 97.95s/it]
Task 2, Epoch 6/20 => Loss 0.157, Train_accy 94.53:  25%|██▌       | 5/20 [09:13<24:29, 97.95s/it]                 
Task 2, Epoch 6/20 => Loss 0.157, Train_accy 94.53:  30%|███       | 6/20 [09:13<22:10, 95.02s/it]
Task 2, Epoch 7/20 => Loss 0.169, Train_accy 94.23:  30%|███       | 6/20 [10:43<22:10, 95.02s/it]
Task 2, Epoch 7/20 => Loss 0.169, Train_accy 94.23:  35%|███▌      | 7/20 [10:43<20:15, 93.48s/it]
Task 2, Epoch 8/20 => Loss 0.158, Train_accy 94.17:  35%|███▌      | 7/20 [11:59<20:15, 93.48s/it]
Task 2, Epoch 8/20 => Loss 0.158, Train_accy 94.17:  40%|████      | 8/20 [11:59<17:32, 87.70s/it]
Task 2, Epoch 9/20 => Loss 0.153, Train_accy 94.55:  40%|████      | 8/20 [12:52<17:32, 87.70s/it]
Task 2, Epoch 9/20 => Loss 0.153, Train_accy 94.55:  45%|████▌     | 9/20 [12:52<14:08, 77.11s/it]
Task 2, Epoch 10/20 => Loss 0.147, Train_accy 95.05, Test_accy 85.56:  45%|████▌     | 9/20 [15:29<14:08, 77.11s/it]
Task 2, Epoch 10/20 => Loss 0.147, Train_accy 95.05, Test_accy 85.56:  50%|█████     | 10/20 [15:29<16:55, 101.57s/it]
Task 2, Epoch 11/20 => Loss 0.155, Train_accy 94.53:  50%|█████     | 10/20 [16:58<16:55, 101.57s/it]                 
Task 2, Epoch 11/20 => Loss 0.155, Train_accy 94.53:  55%|█████▌    | 11/20 [16:58<14:41, 97.94s/it] 
Task 2, Epoch 12/20 => Loss 0.135, Train_accy 95.03:  55%|█████▌    | 11/20 [18:23<14:41, 97.94s/it]
Task 2, Epoch 12/20 => Loss 0.135, Train_accy 95.03:  60%|██████    | 12/20 [18:23<12:31, 93.93s/it]
Task 2, Epoch 13/20 => Loss 0.142, Train_accy 95.25:  60%|██████    | 12/20 [19:16<12:31, 93.93s/it]
Task 2, Epoch 13/20 => Loss 0.142, Train_accy 95.25:  65%|██████▌   | 13/20 [19:16<09:29, 81.38s/it]
Task 2, Epoch 14/20 => Loss 0.133, Train_accy 95.53:  65%|██████▌   | 13/20 [20:39<09:29, 81.38s/it]
Task 2, Epoch 14/20 => Loss 0.133, Train_accy 95.53:  70%|███████   | 14/20 [20:39<08:12, 82.07s/it]
Task 2, Epoch 15/20 => Loss 0.136, Train_accy 95.23, Test_accy 86.20:  70%|███████   | 14/20 [23:14<08:12, 82.07s/it]
Task 2, Epoch 15/20 => Loss 0.136, Train_accy 95.23, Test_accy 86.20:  75%|███████▌  | 15/20 [23:14<08:39, 103.98s/it]
Task 2, Epoch 16/20 => Loss 0.118, Train_accy 95.89:  75%|███████▌  | 15/20 [24:41<08:39, 103.98s/it]                 
Task 2, Epoch 16/20 => Loss 0.118, Train_accy 95.89:  80%|████████  | 16/20 [24:41<06:34, 98.70s/it] 
Task 2, Epoch 17/20 => Loss 0.143, Train_accy 95.21:  80%|████████  | 16/20 [25:40<06:34, 98.70s/it]
Task 2, Epoch 17/20 => Loss 0.143, Train_accy 95.21:  85%|████████▌ | 17/20 [25:40<04:20, 86.79s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 95.55:  85%|████████▌ | 17/20 [26:51<04:20, 86.79s/it]
Task 2, Epoch 18/20 => Loss 0.128, Train_accy 95.55:  90%|█████████ | 18/20 [26:51<02:44, 82.10s/it]
Task 2, Epoch 19/20 => Loss 0.134, Train_accy 95.41:  90%|█████████ | 18/20 [28:21<02:44, 82.10s/it]
Task 2, Epoch 19/20 => Loss 0.134, Train_accy 95.41:  95%|█████████▌| 19/20 [28:21<01:24, 84.39s/it]
Task 2, Epoch 20/20 => Loss 0.126, Train_accy 95.73, Test_accy 86.39:  95%|█████████▌| 19/20 [30:55<01:24, 84.39s/it]
Task 2, Epoch 20/20 => Loss 0.126, Train_accy 95.73, Test_accy 86.39: 100%|██████████| 20/20 [30:55<00:00, 105.45s/it]
Task 2, Epoch 20/20 => Loss 0.126, Train_accy 95.73, Test_accy 86.39: 100%|██████████| 20/20 [30:55<00:00, 92.78s/it] 
2024-04-21 06:58:58,535 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.126, Train_accy 95.73, Test_accy 86.39
2024-04-21 06:59:54,033 [trainer.py] => No NME accuracy.
2024-04-21 06:59:54,033 [trainer.py] => CNN: {'total': 86.39, '00-49': 94.02, '50-59': 64.2, '60-69': 70.4, 'old': 89.05, 'new': 70.4}
2024-04-21 06:59:54,033 [trainer.py] => CNN top1 curve: [94.32, 89.32, 86.39]
2024-04-21 06:59:54,033 [trainer.py] => CNN top5 curve: [99.54, 99.4, 99.0]

Average Accuracy (CNN): 90.01
2024-04-21 06:59:54,033 [trainer.py] => Average Accuracy (CNN): 90.01 

2024-04-21 06:59:54,033 [trainer.py] => Train Time: 23895.539999999997
2024-04-21 06:59:54,033 [trainer.py] => Test Time: 121.09 

2024-04-21 06:59:54,034 [trainer.py] => All params: 89715556
2024-04-21 06:59:54,035 [trainer.py] => Trainable params: 89715556
2024-04-21 06:59:57,635 [coda_prompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.423, Train_accy 86.66:   0%|          | 0/20 [01:08<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.423, Train_accy 86.66:   5%|▌         | 1/20 [01:08<21:45, 68.71s/it]
Task 3, Epoch 2/20 => Loss 0.227, Train_accy 92.67:   5%|▌         | 1/20 [02:39<21:45, 68.71s/it]
Task 3, Epoch 2/20 => Loss 0.227, Train_accy 92.67:  10%|█         | 2/20 [02:39<24:29, 81.64s/it]
Task 3, Epoch 3/20 => Loss 0.180, Train_accy 94.33:  10%|█         | 2/20 [04:10<24:29, 81.64s/it]
Task 3, Epoch 3/20 => Loss 0.180, Train_accy 94.33:  15%|█▌        | 3/20 [04:10<24:21, 85.98s/it]
Task 3, Epoch 4/20 => Loss 0.171, Train_accy 94.45:  15%|█▌        | 3/20 [05:37<24:21, 85.98s/it]
Task 3, Epoch 4/20 => Loss 0.171, Train_accy 94.45:  20%|██        | 4/20 [05:37<23:01, 86.37s/it]
Task 3, Epoch 5/20 => Loss 0.165, Train_accy 94.45, Test_accy 81.55:  20%|██        | 4/20 [07:37<23:01, 86.37s/it]
Task 3, Epoch 5/20 => Loss 0.165, Train_accy 94.45, Test_accy 81.55:  25%|██▌       | 5/20 [07:37<24:36, 98.42s/it]
Task 3, Epoch 6/20 => Loss 0.174, Train_accy 94.13:  25%|██▌       | 5/20 [09:07<24:36, 98.42s/it]                 
Task 3, Epoch 6/20 => Loss 0.174, Train_accy 94.13:  30%|███       | 6/20 [09:07<22:19, 95.68s/it]
Task 3, Epoch 7/20 => Loss 0.155, Train_accy 94.87:  30%|███       | 6/20 [10:38<22:19, 95.68s/it]
Task 3, Epoch 7/20 => Loss 0.155, Train_accy 94.87:  35%|███▌      | 7/20 [10:38<20:23, 94.13s/it]
Task 3, Epoch 8/20 => Loss 0.141, Train_accy 95.13:  35%|███▌      | 7/20 [12:07<20:23, 94.13s/it]
Task 3, Epoch 8/20 => Loss 0.141, Train_accy 95.13:  40%|████      | 8/20 [12:07<18:29, 92.42s/it]
Task 3, Epoch 9/20 => Loss 0.147, Train_accy 94.83:  40%|████      | 8/20 [13:19<18:29, 92.42s/it]
Task 3, Epoch 9/20 => Loss 0.147, Train_accy 94.83:  45%|████▌     | 9/20 [13:19<15:45, 85.99s/it]
Task 3, Epoch 10/20 => Loss 0.136, Train_accy 95.33, Test_accy 83.14:  45%|████▌     | 9/20 [15:27<15:45, 85.99s/it]
Task 3, Epoch 10/20 => Loss 0.136, Train_accy 95.33, Test_accy 83.14:  50%|█████     | 10/20 [15:27<16:30, 99.01s/it]
Task 3, Epoch 11/20 => Loss 0.150, Train_accy 94.85:  50%|█████     | 10/20 [16:57<16:30, 99.01s/it]                 
Task 3, Epoch 11/20 => Loss 0.150, Train_accy 94.85:  55%|█████▌    | 11/20 [16:57<14:27, 96.38s/it]
Task 3, Epoch 12/20 => Loss 0.134, Train_accy 95.45:  55%|█████▌    | 11/20 [18:28<14:27, 96.38s/it]
Task 3, Epoch 12/20 => Loss 0.134, Train_accy 95.45:  60%|██████    | 12/20 [18:28<12:36, 94.59s/it]
Task 3, Epoch 13/20 => Loss 0.133, Train_accy 95.51:  60%|██████    | 12/20 [19:54<12:36, 94.59s/it]
Task 3, Epoch 13/20 => Loss 0.133, Train_accy 95.51:  65%|██████▌   | 13/20 [19:54<10:43, 91.95s/it]
Task 3, Epoch 14/20 => Loss 0.121, Train_accy 96.09:  65%|██████▌   | 13/20 [20:51<10:43, 91.95s/it]
Task 3, Epoch 14/20 => Loss 0.121, Train_accy 96.09:  70%|███████   | 14/20 [20:51<08:08, 81.37s/it]
Task 3, Epoch 15/20 => Loss 0.126, Train_accy 96.05, Test_accy 83.66:  70%|███████   | 14/20 [23:19<08:08, 81.37s/it]
Task 3, Epoch 15/20 => Loss 0.126, Train_accy 96.05, Test_accy 83.66:  75%|███████▌  | 15/20 [23:19<08:28, 101.72s/it]
Task 3, Epoch 16/20 => Loss 0.122, Train_accy 95.75:  75%|███████▌  | 15/20 [24:50<08:28, 101.72s/it]                 
Task 3, Epoch 16/20 => Loss 0.122, Train_accy 95.75:  80%|████████  | 16/20 [24:50<06:33, 98.48s/it] 
Task 3, Epoch 17/20 => Loss 0.118, Train_accy 96.01:  80%|████████  | 16/20 [26:19<06:33, 98.48s/it]
Task 3, Epoch 17/20 => Loss 0.118, Train_accy 96.01:  85%|████████▌ | 17/20 [26:19<04:46, 95.54s/it]
Task 3, Epoch 18/20 => Loss 0.115, Train_accy 96.03:  85%|████████▌ | 17/20 [27:30<04:46, 95.54s/it]
Task 3, Epoch 18/20 => Loss 0.115, Train_accy 96.03:  90%|█████████ | 18/20 [27:30<02:56, 88.26s/it]
Task 3, Epoch 19/20 => Loss 0.114, Train_accy 95.99:  90%|█████████ | 18/20 [28:26<02:56, 88.26s/it]
Task 3, Epoch 19/20 => Loss 0.114, Train_accy 95.99:  95%|█████████▌| 19/20 [28:26<01:18, 78.48s/it]
Task 3, Epoch 20/20 => Loss 0.107, Train_accy 96.27, Test_accy 83.79:  95%|█████████▌| 19/20 [31:12<01:18, 78.48s/it]
Task 3, Epoch 20/20 => Loss 0.107, Train_accy 96.27, Test_accy 83.79: 100%|██████████| 20/20 [31:12<00:00, 104.81s/it]
Task 3, Epoch 20/20 => Loss 0.107, Train_accy 96.27, Test_accy 83.79: 100%|██████████| 20/20 [31:12<00:00, 93.64s/it] 
2024-04-21 07:31:10,477 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.107, Train_accy 96.27, Test_accy 83.79
2024-04-21 07:32:25,095 [trainer.py] => No NME accuracy.
2024-04-21 07:32:25,096 [trainer.py] => CNN: {'total': 83.79, '00-49': 94.06, '50-59': 62.7, '60-69': 69.3, '70-79': 68.0, 'old': 86.04, 'new': 68.0}
2024-04-21 07:32:25,096 [trainer.py] => CNN top1 curve: [94.32, 89.32, 86.39, 83.79]
2024-04-21 07:32:25,096 [trainer.py] => CNN top5 curve: [99.54, 99.4, 99.0, 98.52]

Average Accuracy (CNN): 88.46
2024-04-21 07:32:25,096 [trainer.py] => Average Accuracy (CNN): 88.46 

2024-04-21 07:32:25,096 [trainer.py] => Train Time: 27641.149999999998
2024-04-21 07:32:25,096 [trainer.py] => Test Time: 195.71 

2024-04-21 07:32:25,097 [trainer.py] => All params: 89715556
2024-04-21 07:32:25,097 [trainer.py] => Trainable params: 89715556
2024-04-21 07:32:49,689 [coda_prompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.373, Train_accy 88.60:   0%|          | 0/20 [01:15<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.373, Train_accy 88.60:   5%|▌         | 1/20 [01:15<23:50, 75.30s/it]
Task 4, Epoch 2/20 => Loss 0.161, Train_accy 94.77:   5%|▌         | 1/20 [02:08<23:50, 75.30s/it]
Task 4, Epoch 2/20 => Loss 0.161, Train_accy 94.77:  10%|█         | 2/20 [02:08<18:38, 62.13s/it]
Task 4, Epoch 3/20 => Loss 0.153, Train_accy 94.83:  10%|█         | 2/20 [03:37<18:38, 62.13s/it]
Task 4, Epoch 3/20 => Loss 0.153, Train_accy 94.83:  15%|█▌        | 3/20 [03:37<21:07, 74.54s/it]
Task 4, Epoch 4/20 => Loss 0.138, Train_accy 95.53:  15%|█▌        | 3/20 [05:07<21:07, 74.54s/it]
Task 4, Epoch 4/20 => Loss 0.138, Train_accy 95.53:  20%|██        | 4/20 [05:07<21:31, 80.75s/it]
Task 4, Epoch 5/20 => Loss 0.141, Train_accy 95.23, Test_accy 80.27:  20%|██        | 4/20 [07:58<21:31, 80.75s/it]
Task 4, Epoch 5/20 => Loss 0.141, Train_accy 95.23, Test_accy 80.27:  25%|██▌       | 5/20 [07:58<28:17, 113.14s/it]
Task 4, Epoch 6/20 => Loss 0.144, Train_accy 95.13:  25%|██▌       | 5/20 [08:53<28:17, 113.14s/it]                 
Task 4, Epoch 6/20 => Loss 0.144, Train_accy 95.13:  30%|███       | 6/20 [08:53<21:47, 93.36s/it] 
Task 4, Epoch 7/20 => Loss 0.138, Train_accy 95.03:  30%|███       | 6/20 [10:10<21:47, 93.36s/it]
Task 4, Epoch 7/20 => Loss 0.138, Train_accy 95.03:  35%|███▌      | 7/20 [10:10<19:02, 87.92s/it]
Task 4, Epoch 8/20 => Loss 0.141, Train_accy 95.29:  35%|███▌      | 7/20 [11:40<19:02, 87.92s/it]
Task 4, Epoch 8/20 => Loss 0.141, Train_accy 95.29:  40%|████      | 8/20 [11:40<17:45, 88.77s/it]
Task 4, Epoch 9/20 => Loss 0.129, Train_accy 95.81:  40%|████      | 8/20 [13:11<17:45, 88.77s/it]
Task 4, Epoch 9/20 => Loss 0.129, Train_accy 95.81:  45%|████▌     | 9/20 [13:11<16:22, 89.36s/it]
Task 4, Epoch 10/20 => Loss 0.123, Train_accy 95.61, Test_accy 81.50:  45%|████▌     | 9/20 [15:38<16:22, 89.36s/it]
Task 4, Epoch 10/20 => Loss 0.123, Train_accy 95.61, Test_accy 81.50:  50%|█████     | 10/20 [15:38<17:52, 107.29s/it]
Task 4, Epoch 11/20 => Loss 0.125, Train_accy 95.79:  50%|█████     | 10/20 [16:30<17:52, 107.29s/it]                 
Task 4, Epoch 11/20 => Loss 0.125, Train_accy 95.79:  55%|█████▌    | 11/20 [16:30<13:32, 90.23s/it] 
Task 4, Epoch 12/20 => Loss 0.118, Train_accy 96.05:  55%|█████▌    | 11/20 [17:50<13:32, 90.23s/it]
Task 4, Epoch 12/20 => Loss 0.118, Train_accy 96.05:  60%|██████    | 12/20 [17:50<11:38, 87.33s/it]
Task 4, Epoch 13/20 => Loss 0.122, Train_accy 96.27:  60%|██████    | 12/20 [19:05<11:38, 87.33s/it]
Task 4, Epoch 13/20 => Loss 0.122, Train_accy 96.27:  65%|██████▌   | 13/20 [19:05<09:44, 83.56s/it]
Task 4, Epoch 14/20 => Loss 0.114, Train_accy 96.21:  65%|██████▌   | 13/20 [20:15<09:44, 83.56s/it]
Task 4, Epoch 14/20 => Loss 0.114, Train_accy 96.21:  70%|███████   | 14/20 [20:15<07:56, 79.46s/it]
Task 4, Epoch 15/20 => Loss 0.103, Train_accy 96.33, Test_accy 81.59:  70%|███████   | 14/20 [22:44<07:56, 79.46s/it]
Task 4, Epoch 15/20 => Loss 0.103, Train_accy 96.33, Test_accy 81.59:  75%|███████▌  | 15/20 [22:44<08:21, 100.40s/it]
Task 4, Epoch 16/20 => Loss 0.112, Train_accy 96.65:  75%|███████▌  | 15/20 [24:05<08:21, 100.40s/it]                 
Task 4, Epoch 16/20 => Loss 0.112, Train_accy 96.65:  80%|████████  | 16/20 [24:05<06:17, 94.44s/it] 
Task 4, Epoch 17/20 => Loss 0.097, Train_accy 96.79:  80%|████████  | 16/20 [25:21<06:17, 94.44s/it]
Task 4, Epoch 17/20 => Loss 0.097, Train_accy 96.79:  85%|████████▌ | 17/20 [25:21<04:26, 88.95s/it]
Task 4, Epoch 18/20 => Loss 0.112, Train_accy 96.23:  85%|████████▌ | 17/20 [26:33<04:26, 88.95s/it]
Task 4, Epoch 18/20 => Loss 0.112, Train_accy 96.23:  90%|█████████ | 18/20 [26:33<02:47, 83.95s/it]
Task 4, Epoch 19/20 => Loss 0.089, Train_accy 97.18:  90%|█████████ | 18/20 [27:55<02:47, 83.95s/it]
Task 4, Epoch 19/20 => Loss 0.089, Train_accy 97.18:  95%|█████████▌| 19/20 [27:55<01:23, 83.17s/it]
Task 4, Epoch 20/20 => Loss 0.109, Train_accy 96.25, Test_accy 81.50:  95%|█████████▌| 19/20 [30:24<01:23, 83.17s/it]
Task 4, Epoch 20/20 => Loss 0.109, Train_accy 96.25, Test_accy 81.50: 100%|██████████| 20/20 [30:24<00:00, 102.98s/it]
Task 4, Epoch 20/20 => Loss 0.109, Train_accy 96.25, Test_accy 81.50: 100%|██████████| 20/20 [30:24<00:00, 91.22s/it] 
2024-04-21 08:03:14,177 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.109, Train_accy 96.25, Test_accy 81.50
2024-04-21 08:04:23,500 [trainer.py] => No NME accuracy.
2024-04-21 08:04:23,500 [trainer.py] => CNN: {'total': 81.5, '00-49': 93.7, '50-59': 61.8, '60-69': 68.9, '70-79': 67.4, '80-89': 66.9, 'old': 83.32, 'new': 66.9}
2024-04-21 08:04:23,500 [trainer.py] => CNN top1 curve: [94.32, 89.32, 86.39, 83.79, 81.5]
2024-04-21 08:04:23,500 [trainer.py] => CNN top5 curve: [99.54, 99.4, 99.0, 98.52, 98.38]

Average Accuracy (CNN): 87.06
2024-04-21 08:04:23,500 [trainer.py] => Average Accuracy (CNN): 87.06 

2024-04-21 08:04:23,501 [trainer.py] => Train Time: 31289.899999999998
2024-04-21 08:04:23,501 [trainer.py] => Test Time: 265.03 

2024-04-21 08:04:23,502 [trainer.py] => All params: 89715556
2024-04-21 08:04:23,503 [trainer.py] => Trainable params: 89715556
2024-04-21 08:04:29,356 [coda_prompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.308, Train_accy 90.34:   0%|          | 0/20 [01:11<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.308, Train_accy 90.34:   5%|▌         | 1/20 [01:11<22:42, 71.70s/it]
Task 5, Epoch 2/20 => Loss 0.116, Train_accy 96.09:   5%|▌         | 1/20 [02:31<22:42, 71.70s/it]
Task 5, Epoch 2/20 => Loss 0.116, Train_accy 96.09:  10%|█         | 2/20 [02:31<23:01, 76.74s/it]
Task 5, Epoch 3/20 => Loss 0.119, Train_accy 95.99:  10%|█         | 2/20 [03:39<23:01, 76.74s/it]
Task 5, Epoch 3/20 => Loss 0.119, Train_accy 95.99:  15%|█▌        | 3/20 [03:39<20:35, 72.67s/it]
Task 5, Epoch 4/20 => Loss 0.124, Train_accy 96.09:  15%|█▌        | 3/20 [05:05<20:35, 72.67s/it]
Task 5, Epoch 4/20 => Loss 0.124, Train_accy 96.09:  20%|██        | 4/20 [05:05<20:43, 77.72s/it]
Task 5, Epoch 5/20 => Loss 0.113, Train_accy 96.45, Test_accy 77.72:  20%|██        | 4/20 [07:38<20:43, 77.72s/it]
Task 5, Epoch 5/20 => Loss 0.113, Train_accy 96.45, Test_accy 77.72:  25%|██▌       | 5/20 [07:38<26:14, 104.96s/it]
Task 5, Epoch 6/20 => Loss 0.103, Train_accy 96.88:  25%|██▌       | 5/20 [08:56<26:14, 104.96s/it]                 
Task 5, Epoch 6/20 => Loss 0.103, Train_accy 96.88:  30%|███       | 6/20 [08:56<22:23, 95.93s/it] 
Task 5, Epoch 7/20 => Loss 0.099, Train_accy 96.69:  30%|███       | 6/20 [10:05<22:23, 95.93s/it]
Task 5, Epoch 7/20 => Loss 0.099, Train_accy 96.69:  35%|███▌      | 7/20 [10:05<18:52, 87.15s/it]
Task 5, Epoch 8/20 => Loss 0.106, Train_accy 96.77:  35%|███▌      | 7/20 [11:28<18:52, 87.15s/it]
Task 5, Epoch 8/20 => Loss 0.106, Train_accy 96.77:  40%|████      | 8/20 [11:28<17:07, 85.63s/it]
Task 5, Epoch 9/20 => Loss 0.096, Train_accy 96.83:  40%|████      | 8/20 [12:42<17:07, 85.63s/it]
Task 5, Epoch 9/20 => Loss 0.096, Train_accy 96.83:  45%|████▌     | 9/20 [12:42<15:01, 81.97s/it]
Task 5, Epoch 10/20 => Loss 0.095, Train_accy 96.96, Test_accy 79.10:  45%|████▌     | 9/20 [15:21<15:01, 81.97s/it]
Task 5, Epoch 10/20 => Loss 0.095, Train_accy 96.96, Test_accy 79.10:  50%|█████     | 10/20 [15:21<17:36, 105.68s/it]
Task 5, Epoch 11/20 => Loss 0.091, Train_accy 97.18:  50%|█████     | 10/20 [16:30<17:36, 105.68s/it]                 
Task 5, Epoch 11/20 => Loss 0.091, Train_accy 97.18:  55%|█████▌    | 11/20 [16:30<14:12, 94.70s/it] 
Task 5, Epoch 12/20 => Loss 0.090, Train_accy 97.26:  55%|█████▌    | 11/20 [17:51<14:12, 94.70s/it]
Task 5, Epoch 12/20 => Loss 0.090, Train_accy 97.26:  60%|██████    | 12/20 [17:51<12:02, 90.36s/it]
Task 5, Epoch 13/20 => Loss 0.093, Train_accy 97.04:  60%|██████    | 12/20 [18:49<12:02, 90.36s/it]
Task 5, Epoch 13/20 => Loss 0.093, Train_accy 97.04:  65%|██████▌   | 13/20 [18:49<09:23, 80.49s/it]
Task 5, Epoch 14/20 => Loss 0.097, Train_accy 96.79:  65%|██████▌   | 13/20 [19:47<09:23, 80.49s/it]
Task 5, Epoch 14/20 => Loss 0.097, Train_accy 96.79:  70%|███████   | 14/20 [19:47<07:22, 73.83s/it]
Task 5, Epoch 15/20 => Loss 0.086, Train_accy 97.52, Test_accy 79.39:  70%|███████   | 14/20 [22:17<07:22, 73.83s/it]
Task 5, Epoch 15/20 => Loss 0.086, Train_accy 97.52, Test_accy 79.39:  75%|███████▌  | 15/20 [22:17<08:04, 96.90s/it]
Task 5, Epoch 16/20 => Loss 0.089, Train_accy 97.10:  75%|███████▌  | 15/20 [23:24<08:04, 96.90s/it]                 
Task 5, Epoch 16/20 => Loss 0.089, Train_accy 97.10:  80%|████████  | 16/20 [23:24<05:50, 87.75s/it]
Task 5, Epoch 17/20 => Loss 0.076, Train_accy 97.58:  80%|████████  | 16/20 [24:45<05:50, 87.75s/it]
Task 5, Epoch 17/20 => Loss 0.076, Train_accy 97.58:  85%|████████▌ | 17/20 [24:45<04:17, 85.68s/it]
Task 5, Epoch 18/20 => Loss 0.092, Train_accy 97.26:  85%|████████▌ | 17/20 [26:00<04:17, 85.68s/it]
Task 5, Epoch 18/20 => Loss 0.092, Train_accy 97.26:  90%|█████████ | 18/20 [26:00<02:44, 82.48s/it]
Task 5, Epoch 19/20 => Loss 0.077, Train_accy 97.32:  90%|█████████ | 18/20 [27:09<02:44, 82.48s/it]
Task 5, Epoch 19/20 => Loss 0.077, Train_accy 97.32:  95%|█████████▌| 19/20 [27:09<01:18, 78.52s/it]
Task 5, Epoch 20/20 => Loss 0.086, Train_accy 97.42, Test_accy 79.24:  95%|█████████▌| 19/20 [29:38<01:18, 78.52s/it]
Task 5, Epoch 20/20 => Loss 0.086, Train_accy 97.42, Test_accy 79.24: 100%|██████████| 20/20 [29:38<00:00, 99.70s/it]
Task 5, Epoch 20/20 => Loss 0.086, Train_accy 97.42, Test_accy 79.24: 100%|██████████| 20/20 [29:38<00:00, 88.93s/it]
2024-04-21 08:34:08,057 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.086, Train_accy 97.42, Test_accy 79.24
2024-04-21 08:35:33,872 [trainer.py] => No NME accuracy.
2024-04-21 08:35:33,872 [trainer.py] => CNN: {'total': 79.24, '00-49': 93.74, '50-59': 62.3, '60-69': 69.7, '70-79': 65.7, '80-89': 66.9, '90-99': 59.1, 'old': 81.48, 'new': 59.1}
2024-04-21 08:35:33,872 [trainer.py] => CNN top1 curve: [94.32, 89.32, 86.39, 83.79, 81.5, 79.24]
2024-04-21 08:35:33,873 [trainer.py] => CNN top5 curve: [99.54, 99.4, 99.0, 98.52, 98.38, 98.27]

Average Accuracy (CNN): 85.76
2024-04-21 08:35:33,873 [trainer.py] => Average Accuracy (CNN): 85.76 

2024-04-21 08:35:33,873 [trainer.py] => Train Time: 34847.19
2024-04-21 08:35:33,873 [trainer.py] => Test Time: 350.84 

Accuracy Matrix (CNN):
[[94.32 94.06 94.02 94.06 93.7  93.74]
 [ 0.   65.6  64.2  62.7  61.8  62.3 ]
 [ 0.    0.   70.4  69.3  68.9  69.7 ]
 [ 0.    0.    0.   68.   67.4  65.7 ]
 [ 0.    0.    0.    0.   66.9  66.9 ]
 [ 0.    0.    0.    0.    0.   59.1 ]]
2024-04-21 08:35:33,874 [trainer.py] => Forgetting (CNN): 1.375999999999999
2024-04-21 08:35:37,276 [trainer.py] => config: ./exps/ease_B50.json
2024-04-21 08:35:37,276 [trainer.py] => prefix:  
2024-04-21 08:35:37,276 [trainer.py] => dataset: cifar224
2024-04-21 08:35:37,276 [trainer.py] => memory_size: 0
2024-04-21 08:35:37,276 [trainer.py] => memory_per_class: 0
2024-04-21 08:35:37,276 [trainer.py] => fixed_memory: False
2024-04-21 08:35:37,276 [trainer.py] => shuffle: True
2024-04-21 08:35:37,276 [trainer.py] => init_cls: 50
2024-04-21 08:35:37,276 [trainer.py] => increment: 10
2024-04-21 08:35:37,276 [trainer.py] => model_name: ease
2024-04-21 08:35:37,276 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2024-04-21 08:35:37,277 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-21 08:35:37,277 [trainer.py] => seed: 1993
2024-04-21 08:35:37,277 [trainer.py] => init_epochs: 20
2024-04-21 08:35:37,277 [trainer.py] => init_lr: 0.025
2024-04-21 08:35:37,277 [trainer.py] => later_epochs: 20
2024-04-21 08:35:37,277 [trainer.py] => later_lr: 0.025
2024-04-21 08:35:37,277 [trainer.py] => batch_size: 48
2024-04-21 08:35:37,277 [trainer.py] => weight_decay: 0.0005
2024-04-21 08:35:37,277 [trainer.py] => min_lr: 0
2024-04-21 08:35:37,277 [trainer.py] => optimizer: sgd
2024-04-21 08:35:37,277 [trainer.py] => scheduler: cosine
2024-04-21 08:35:37,277 [trainer.py] => pretrained: True
2024-04-21 08:35:37,277 [trainer.py] => vpt_type: Deep
2024-04-21 08:35:37,277 [trainer.py] => prompt_token_num: 5
2024-04-21 08:35:37,277 [trainer.py] => ffn_num: 64
2024-04-21 08:35:37,277 [trainer.py] => use_diagonal: False
2024-04-21 08:35:37,278 [trainer.py] => recalc_sim: True
2024-04-21 08:35:37,278 [trainer.py] => alpha: 0.1
2024-04-21 08:35:37,278 [trainer.py] => use_init_ptm: False
2024-04-21 08:35:37,278 [trainer.py] => beta: 0
2024-04-21 08:35:37,278 [trainer.py] => use_old_data: False
2024-04-21 08:35:37,278 [trainer.py] => use_reweight: True
2024-04-21 08:35:37,278 [trainer.py] => moni_adam: False
2024-04-21 08:35:37,278 [trainer.py] => adapter_num: -1
Files already downloaded and verified
Files already downloaded and verified
2024-04-21 08:35:39,638 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
_IncompatibleKeys(missing_keys=['cur_adapter.0.down_proj.weight', 'cur_adapter.0.down_proj.bias', 'cur_adapter.0.up_proj.weight', 'cur_adapter.0.up_proj.bias', 'cur_adapter.1.down_proj.weight', 'cur_adapter.1.down_proj.bias', 'cur_adapter.1.up_proj.weight', 'cur_adapter.1.up_proj.bias', 'cur_adapter.2.down_proj.weight', 'cur_adapter.2.down_proj.bias', 'cur_adapter.2.up_proj.weight', 'cur_adapter.2.up_proj.bias', 'cur_adapter.3.down_proj.weight', 'cur_adapter.3.down_proj.bias', 'cur_adapter.3.up_proj.weight', 'cur_adapter.3.up_proj.bias', 'cur_adapter.4.down_proj.weight', 'cur_adapter.4.down_proj.bias', 'cur_adapter.4.up_proj.weight', 'cur_adapter.4.up_proj.bias', 'cur_adapter.5.down_proj.weight', 'cur_adapter.5.down_proj.bias', 'cur_adapter.5.up_proj.weight', 'cur_adapter.5.up_proj.bias', 'cur_adapter.6.down_proj.weight', 'cur_adapter.6.down_proj.bias', 'cur_adapter.6.up_proj.weight', 'cur_adapter.6.up_proj.bias', 'cur_adapter.7.down_proj.weight', 'cur_adapter.7.down_proj.bias', 'cur_adapter.7.up_proj.weight', 'cur_adapter.7.up_proj.bias', 'cur_adapter.8.down_proj.weight', 'cur_adapter.8.down_proj.bias', 'cur_adapter.8.up_proj.weight', 'cur_adapter.8.up_proj.bias', 'cur_adapter.9.down_proj.weight', 'cur_adapter.9.down_proj.bias', 'cur_adapter.9.up_proj.weight', 'cur_adapter.9.up_proj.bias', 'cur_adapter.10.down_proj.weight', 'cur_adapter.10.down_proj.bias', 'cur_adapter.10.up_proj.weight', 'cur_adapter.10.up_proj.bias', 'cur_adapter.11.down_proj.weight', 'cur_adapter.11.down_proj.bias', 'cur_adapter.11.up_proj.weight', 'cur_adapter.11.up_proj.bias'], unexpected_keys=[])
After BaseNet initialization.
2024-04-21 08:35:44,458 [trainer.py] => All params: 86988288
2024-04-21 08:35:44,459 [trainer.py] => Trainable params: 1189632
2024-04-21 08:35:44,466 [ease.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.634, Train_accy 65.98:   0%|          | 0/20 [03:23<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.634, Train_accy 65.98:   5%|▌         | 1/20 [03:23<1:04:27, 203.58s/it]
Task 0, Epoch 2/20 => Loss 0.645, Train_accy 82.22:   5%|▌         | 1/20 [06:47<1:04:27, 203.58s/it]
Task 0, Epoch 2/20 => Loss 0.645, Train_accy 82.22:  10%|█         | 2/20 [06:47<1:01:04, 203.58s/it]
Task 0, Epoch 3/20 => Loss 0.606, Train_accy 83.25:  10%|█         | 2/20 [10:11<1:01:04, 203.58s/it]
Task 0, Epoch 3/20 => Loss 0.606, Train_accy 83.25:  15%|█▌        | 3/20 [10:11<57:49, 204.06s/it]  
Task 0, Epoch 4/20 => Loss 0.574, Train_accy 83.87:  15%|█▌        | 3/20 [13:31<57:49, 204.06s/it]
Task 0, Epoch 4/20 => Loss 0.574, Train_accy 83.87:  20%|██        | 4/20 [13:31<53:58, 202.43s/it]
Task 0, Epoch 5/20 => Loss 0.569, Train_accy 84.12:  20%|██        | 4/20 [16:54<53:58, 202.43s/it]
Task 0, Epoch 5/20 => Loss 0.569, Train_accy 84.12:  25%|██▌       | 5/20 [16:54<50:37, 202.50s/it]
Task 0, Epoch 6/20 => Loss 0.563, Train_accy 84.21:  25%|██▌       | 5/20 [20:17<50:37, 202.50s/it]
Task 0, Epoch 6/20 => Loss 0.563, Train_accy 84.21:  30%|███       | 6/20 [20:17<47:19, 202.81s/it]
Task 0, Epoch 7/20 => Loss 0.551, Train_accy 84.34:  30%|███       | 6/20 [23:39<47:19, 202.81s/it]
Task 0, Epoch 7/20 => Loss 0.551, Train_accy 84.34:  35%|███▌      | 7/20 [23:39<43:53, 202.60s/it]
Task 0, Epoch 8/20 => Loss 0.528, Train_accy 85.12:  35%|███▌      | 7/20 [27:01<43:53, 202.60s/it]
Task 0, Epoch 8/20 => Loss 0.528, Train_accy 85.12:  40%|████      | 8/20 [27:01<40:27, 202.29s/it]
Task 0, Epoch 9/20 => Loss 0.516, Train_accy 85.33:  40%|████      | 8/20 [30:22<40:27, 202.29s/it]
Task 0, Epoch 9/20 => Loss 0.516, Train_accy 85.33:  45%|████▌     | 9/20 [30:22<37:01, 201.96s/it]
Task 0, Epoch 10/20 => Loss 0.525, Train_accy 84.99:  45%|████▌     | 9/20 [33:33<37:01, 201.96s/it]
Task 0, Epoch 10/20 => Loss 0.525, Train_accy 84.99:  50%|█████     | 10/20 [33:33<33:04, 198.45s/it]
Task 0, Epoch 11/20 => Loss 0.512, Train_accy 85.70:  50%|█████     | 10/20 [36:30<33:04, 198.45s/it]
Task 0, Epoch 11/20 => Loss 0.512, Train_accy 85.70:  55%|█████▌    | 11/20 [36:30<28:46, 191.87s/it]
Task 0, Epoch 12/20 => Loss 0.512, Train_accy 85.50:  55%|█████▌    | 11/20 [39:45<28:46, 191.87s/it]
Task 0, Epoch 12/20 => Loss 0.512, Train_accy 85.50:  60%|██████    | 12/20 [39:45<25:43, 192.91s/it]
Task 0, Epoch 13/20 => Loss 0.503, Train_accy 85.73:  60%|██████    | 12/20 [42:56<25:43, 192.91s/it]
Task 0, Epoch 13/20 => Loss 0.503, Train_accy 85.73:  65%|██████▌   | 13/20 [42:56<22:26, 192.39s/it]
Task 0, Epoch 14/20 => Loss 0.493, Train_accy 86.02:  65%|██████▌   | 13/20 [46:13<22:26, 192.39s/it]
Task 0, Epoch 14/20 => Loss 0.493, Train_accy 86.02:  70%|███████   | 14/20 [46:13<19:21, 193.67s/it]
Task 0, Epoch 15/20 => Loss 0.485, Train_accy 86.12:  70%|███████   | 14/20 [49:25<19:21, 193.67s/it]
Task 0, Epoch 15/20 => Loss 0.485, Train_accy 86.12:  75%|███████▌  | 15/20 [49:25<16:06, 193.22s/it]
Task 0, Epoch 16/20 => Loss 0.475, Train_accy 86.42:  75%|███████▌  | 15/20 [52:44<16:06, 193.22s/it]
Task 0, Epoch 16/20 => Loss 0.475, Train_accy 86.42:  80%|████████  | 16/20 [52:44<12:59, 194.94s/it]
Task 0, Epoch 17/20 => Loss 0.478, Train_accy 86.42:  80%|████████  | 16/20 [55:52<12:59, 194.94s/it]
Task 0, Epoch 17/20 => Loss 0.478, Train_accy 86.42:  85%|████████▌ | 17/20 [55:52<09:38, 192.76s/it]
Task 0, Epoch 18/20 => Loss 0.480, Train_accy 86.20:  85%|████████▌ | 17/20 [58:45<09:38, 192.76s/it]
Task 0, Epoch 18/20 => Loss 0.480, Train_accy 86.20:  90%|█████████ | 18/20 [58:45<06:13, 186.83s/it]
Task 0, Epoch 19/20 => Loss 0.483, Train_accy 86.10:  90%|█████████ | 18/20 [1:02:11<06:13, 186.83s/it]
Task 0, Epoch 19/20 => Loss 0.483, Train_accy 86.10:  95%|█████████▌| 19/20 [1:02:11<03:12, 192.63s/it]
Task 0, Epoch 20/20 => Loss 0.475, Train_accy 86.47:  95%|█████████▌| 19/20 [1:05:28<03:12, 192.63s/it]
Task 0, Epoch 20/20 => Loss 0.475, Train_accy 86.47: 100%|██████████| 20/20 [1:05:28<00:00, 193.91s/it]
Task 0, Epoch 20/20 => Loss 0.475, Train_accy 86.47: 100%|██████████| 20/20 [1:05:28<00:00, 196.42s/it]
2024-04-21 09:41:12,969 [ease.py] => Task 0, Epoch 20/20 => Loss 0.475, Train_accy 86.47
2024-04-21 09:43:14,033 [ease.py] => Task correct: 95.2
2024-04-21 09:43:14,034 [ease.py] => Task acc: 97.96
2024-04-21 09:43:14,077 [trainer.py] => No NME accuracy.
2024-04-21 09:43:14,077 [trainer.py] => CNN: {'total': 94.52, '00-49': 94.52, 'old': 0, 'new': 94.52}
2024-04-21 09:43:14,078 [trainer.py] => CNN top1 curve: [94.52]
2024-04-21 09:43:14,078 [trainer.py] => CNN top5 curve: [99.6]

Average Accuracy (CNN): 94.52
2024-04-21 09:43:14,078 [trainer.py] => Average Accuracy (CNN): 94.52 

2024-04-21 09:43:14,078 [trainer.py] => Train Time: 7856.73
2024-04-21 09:43:14,078 [trainer.py] => Test Time: 16.75 

2024-04-21 09:43:14,078 [trainer.py] => All params: 87065090
2024-04-21 09:43:14,079 [trainer.py] => Trainable params: 1189632
2024-04-21 09:43:14,081 [ease.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.709, Train_accy 66.58:   0%|          | 0/20 [00:38<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.709, Train_accy 66.58:   5%|▌         | 1/20 [00:38<12:05, 38.18s/it]
Task 1, Epoch 2/20 => Loss 0.568, Train_accy 87.24:   5%|▌         | 1/20 [01:26<12:05, 38.18s/it]
Task 1, Epoch 2/20 => Loss 0.568, Train_accy 87.24:  10%|█         | 2/20 [01:26<13:09, 43.87s/it]
Task 1, Epoch 3/20 => Loss 0.336, Train_accy 90.78:  10%|█         | 2/20 [02:06<13:09, 43.87s/it]
Task 1, Epoch 3/20 => Loss 0.336, Train_accy 90.78:  15%|█▌        | 3/20 [02:06<11:58, 42.26s/it]
Task 1, Epoch 4/20 => Loss 0.288, Train_accy 91.42:  15%|█▌        | 3/20 [02:46<11:58, 42.26s/it]
Task 1, Epoch 4/20 => Loss 0.288, Train_accy 91.42:  20%|██        | 4/20 [02:46<11:01, 41.36s/it]
Task 1, Epoch 5/20 => Loss 0.250, Train_accy 92.18:  20%|██        | 4/20 [03:28<11:01, 41.36s/it]
Task 1, Epoch 5/20 => Loss 0.250, Train_accy 92.18:  25%|██▌       | 5/20 [03:28<10:22, 41.51s/it]
Task 1, Epoch 6/20 => Loss 0.246, Train_accy 92.30:  25%|██▌       | 5/20 [04:08<10:22, 41.51s/it]
Task 1, Epoch 6/20 => Loss 0.246, Train_accy 92.30:  30%|███       | 6/20 [04:08<09:37, 41.28s/it]
Task 1, Epoch 7/20 => Loss 0.253, Train_accy 91.88:  30%|███       | 6/20 [04:38<09:37, 41.28s/it]
Task 1, Epoch 7/20 => Loss 0.253, Train_accy 91.88:  35%|███▌      | 7/20 [04:38<08:06, 37.46s/it]
Task 1, Epoch 8/20 => Loss 0.233, Train_accy 92.62:  35%|███▌      | 7/20 [05:24<08:06, 37.46s/it]
Task 1, Epoch 8/20 => Loss 0.233, Train_accy 92.62:  40%|████      | 8/20 [05:24<08:00, 40.05s/it]
Task 1, Epoch 9/20 => Loss 0.232, Train_accy 92.84:  40%|████      | 8/20 [06:10<08:00, 40.05s/it]
Task 1, Epoch 9/20 => Loss 0.232, Train_accy 92.84:  45%|████▌     | 9/20 [06:10<07:41, 41.92s/it]
Task 1, Epoch 10/20 => Loss 0.229, Train_accy 93.04:  45%|████▌     | 9/20 [06:44<07:41, 41.92s/it]
Task 1, Epoch 10/20 => Loss 0.229, Train_accy 93.04:  50%|█████     | 10/20 [06:44<06:36, 39.66s/it]
Task 1, Epoch 11/20 => Loss 0.222, Train_accy 92.84:  50%|█████     | 10/20 [07:23<06:36, 39.66s/it]
Task 1, Epoch 11/20 => Loss 0.222, Train_accy 92.84:  55%|█████▌    | 11/20 [07:23<05:55, 39.46s/it]
Task 1, Epoch 12/20 => Loss 0.224, Train_accy 92.92:  55%|█████▌    | 11/20 [08:05<05:55, 39.46s/it]
Task 1, Epoch 12/20 => Loss 0.224, Train_accy 92.92:  60%|██████    | 12/20 [08:05<05:20, 40.06s/it]
Task 1, Epoch 13/20 => Loss 0.220, Train_accy 93.38:  60%|██████    | 12/20 [08:45<05:20, 40.06s/it]
Task 1, Epoch 13/20 => Loss 0.220, Train_accy 93.38:  65%|██████▌   | 13/20 [08:45<04:40, 40.09s/it]
Task 1, Epoch 14/20 => Loss 0.212, Train_accy 93.40:  65%|██████▌   | 13/20 [09:15<04:40, 40.09s/it]
Task 1, Epoch 14/20 => Loss 0.212, Train_accy 93.40:  70%|███████   | 14/20 [09:15<03:42, 37.07s/it]
Task 1, Epoch 15/20 => Loss 0.212, Train_accy 93.36:  70%|███████   | 14/20 [09:59<03:42, 37.07s/it]
Task 1, Epoch 15/20 => Loss 0.212, Train_accy 93.36:  75%|███████▌  | 15/20 [09:59<03:15, 39.17s/it]
Task 1, Epoch 16/20 => Loss 0.200, Train_accy 93.72:  75%|███████▌  | 15/20 [10:46<03:15, 39.17s/it]
Task 1, Epoch 16/20 => Loss 0.200, Train_accy 93.72:  80%|████████  | 16/20 [10:46<02:45, 41.50s/it]
Task 1, Epoch 17/20 => Loss 0.207, Train_accy 93.52:  80%|████████  | 16/20 [11:25<02:45, 41.50s/it]
Task 1, Epoch 17/20 => Loss 0.207, Train_accy 93.52:  85%|████████▌ | 17/20 [11:25<02:02, 40.76s/it]
Task 1, Epoch 18/20 => Loss 0.190, Train_accy 93.92:  85%|████████▌ | 17/20 [12:06<02:02, 40.76s/it]
Task 1, Epoch 18/20 => Loss 0.190, Train_accy 93.92:  90%|█████████ | 18/20 [12:06<01:21, 40.88s/it]
Task 1, Epoch 19/20 => Loss 0.204, Train_accy 93.32:  90%|█████████ | 18/20 [12:48<01:21, 40.88s/it]
Task 1, Epoch 19/20 => Loss 0.204, Train_accy 93.32:  95%|█████████▌| 19/20 [12:48<00:41, 41.08s/it]
Task 1, Epoch 20/20 => Loss 0.189, Train_accy 94.10:  95%|█████████▌| 19/20 [13:24<00:41, 41.08s/it]
Task 1, Epoch 20/20 => Loss 0.189, Train_accy 94.10: 100%|██████████| 20/20 [13:24<00:00, 39.79s/it]
Task 1, Epoch 20/20 => Loss 0.189, Train_accy 94.10: 100%|██████████| 20/20 [13:24<00:00, 40.25s/it]
2024-04-21 09:56:39,104 [ease.py] => Task 1, Epoch 20/20 => Loss 0.189, Train_accy 94.10
2024-04-21 09:58:16,893 [ease.py] => Task correct: 91.61666666666666
2024-04-21 09:58:16,893 [ease.py] => Task acc: 98.1
2024-04-21 09:58:17,109 [trainer.py] => No NME accuracy.
2024-04-21 09:58:17,109 [trainer.py] => CNN: {'total': 91.1, '00-49': 90.0, '50-59': 96.6, 'old': 90.0, 'new': 96.6}
2024-04-21 09:58:17,110 [trainer.py] => CNN top1 curve: [94.52, 91.1]
2024-04-21 09:58:17,110 [trainer.py] => CNN top5 curve: [99.6, 99.43]

Average Accuracy (CNN): 92.81
2024-04-21 09:58:17,110 [trainer.py] => Average Accuracy (CNN): 92.81 

2024-04-21 09:58:17,110 [trainer.py] => Train Time: 9466.64
2024-04-21 09:58:17,110 [trainer.py] => Test Time: 74.33 

2024-04-21 09:58:17,111 [trainer.py] => All params: 87088130
2024-04-21 09:58:17,111 [trainer.py] => Trainable params: 1189632
2024-04-21 09:58:17,119 [ease.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.542, Train_accy 75.00:   0%|          | 0/20 [00:38<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.542, Train_accy 75.00:   5%|▌         | 1/20 [00:38<12:12, 38.56s/it]
Task 2, Epoch 2/20 => Loss 0.405, Train_accy 91.14:   5%|▌         | 1/20 [01:19<12:12, 38.56s/it]
Task 2, Epoch 2/20 => Loss 0.405, Train_accy 91.14:  10%|█         | 2/20 [01:19<11:59, 39.95s/it]
Task 2, Epoch 3/20 => Loss 0.241, Train_accy 93.56:  10%|█         | 2/20 [02:02<11:59, 39.95s/it]
Task 2, Epoch 3/20 => Loss 0.241, Train_accy 93.56:  15%|█▌        | 3/20 [02:02<11:39, 41.17s/it]
Task 2, Epoch 4/20 => Loss 0.224, Train_accy 93.26:  15%|█▌        | 3/20 [02:38<11:39, 41.17s/it]
Task 2, Epoch 4/20 => Loss 0.224, Train_accy 93.26:  20%|██        | 4/20 [02:38<10:28, 39.31s/it]
Task 2, Epoch 5/20 => Loss 0.218, Train_accy 93.80:  20%|██        | 4/20 [03:11<10:28, 39.31s/it]
Task 2, Epoch 5/20 => Loss 0.218, Train_accy 93.80:  25%|██▌       | 5/20 [03:11<09:16, 37.12s/it]
Task 2, Epoch 6/20 => Loss 0.187, Train_accy 94.38:  25%|██▌       | 5/20 [03:59<09:16, 37.12s/it]
Task 2, Epoch 6/20 => Loss 0.187, Train_accy 94.38:  30%|███       | 6/20 [03:59<09:28, 40.62s/it]
Task 2, Epoch 7/20 => Loss 0.190, Train_accy 94.20:  30%|███       | 6/20 [04:42<09:28, 40.62s/it]
Task 2, Epoch 7/20 => Loss 0.190, Train_accy 94.20:  35%|███▌      | 7/20 [04:42<08:57, 41.36s/it]
Task 2, Epoch 8/20 => Loss 0.210, Train_accy 93.72:  35%|███▌      | 7/20 [05:18<08:57, 41.36s/it]
Task 2, Epoch 8/20 => Loss 0.210, Train_accy 93.72:  40%|████      | 8/20 [05:18<07:59, 39.94s/it]
Task 2, Epoch 9/20 => Loss 0.180, Train_accy 94.52:  40%|████      | 8/20 [05:59<07:59, 39.94s/it]
Task 2, Epoch 9/20 => Loss 0.180, Train_accy 94.52:  45%|████▌     | 9/20 [05:59<07:21, 40.14s/it]
Task 2, Epoch 10/20 => Loss 0.160, Train_accy 95.16:  45%|████▌     | 9/20 [06:41<07:21, 40.14s/it]
Task 2, Epoch 10/20 => Loss 0.160, Train_accy 95.16:  50%|█████     | 10/20 [06:41<06:47, 40.72s/it]
Task 2, Epoch 11/20 => Loss 0.156, Train_accy 95.26:  50%|█████     | 10/20 [07:22<06:47, 40.72s/it]
Task 2, Epoch 11/20 => Loss 0.156, Train_accy 95.26:  55%|█████▌    | 11/20 [07:22<06:06, 40.74s/it]
Task 2, Epoch 12/20 => Loss 0.171, Train_accy 94.76:  55%|█████▌    | 11/20 [07:52<06:06, 40.74s/it]
Task 2, Epoch 12/20 => Loss 0.171, Train_accy 94.76:  60%|██████    | 12/20 [07:52<04:59, 37.39s/it]
Task 2, Epoch 13/20 => Loss 0.164, Train_accy 94.90:  60%|██████    | 12/20 [08:30<04:59, 37.39s/it]
Task 2, Epoch 13/20 => Loss 0.164, Train_accy 94.90:  65%|██████▌   | 13/20 [08:30<04:22, 37.55s/it]
Task 2, Epoch 14/20 => Loss 0.161, Train_accy 94.74:  65%|██████▌   | 13/20 [09:18<04:22, 37.55s/it]
Task 2, Epoch 14/20 => Loss 0.161, Train_accy 94.74:  70%|███████   | 14/20 [09:18<04:04, 40.76s/it]
Task 2, Epoch 15/20 => Loss 0.170, Train_accy 94.82:  70%|███████   | 14/20 [09:58<04:04, 40.76s/it]
Task 2, Epoch 15/20 => Loss 0.170, Train_accy 94.82:  75%|███████▌  | 15/20 [09:58<03:23, 40.60s/it]
Task 2, Epoch 16/20 => Loss 0.166, Train_accy 95.02:  75%|███████▌  | 15/20 [10:34<03:23, 40.60s/it]
Task 2, Epoch 16/20 => Loss 0.166, Train_accy 95.02:  80%|████████  | 16/20 [10:34<02:37, 39.25s/it]
Task 2, Epoch 17/20 => Loss 0.159, Train_accy 95.30:  80%|████████  | 16/20 [11:09<02:37, 39.25s/it]
Task 2, Epoch 17/20 => Loss 0.159, Train_accy 95.30:  85%|████████▌ | 17/20 [11:09<01:53, 37.90s/it]
Task 2, Epoch 18/20 => Loss 0.158, Train_accy 95.22:  85%|████████▌ | 17/20 [11:44<01:53, 37.90s/it]
Task 2, Epoch 18/20 => Loss 0.158, Train_accy 95.22:  90%|█████████ | 18/20 [11:44<01:14, 37.16s/it]
Task 2, Epoch 19/20 => Loss 0.162, Train_accy 95.44:  90%|█████████ | 18/20 [12:20<01:14, 37.16s/it]
Task 2, Epoch 19/20 => Loss 0.162, Train_accy 95.44:  95%|█████████▌| 19/20 [12:20<00:36, 36.78s/it]
Task 2, Epoch 20/20 => Loss 0.151, Train_accy 95.34:  95%|█████████▌| 19/20 [12:56<00:36, 36.78s/it]
Task 2, Epoch 20/20 => Loss 0.151, Train_accy 95.34: 100%|██████████| 20/20 [12:56<00:00, 36.37s/it]
Task 2, Epoch 20/20 => Loss 0.151, Train_accy 95.34: 100%|██████████| 20/20 [12:56<00:00, 38.80s/it]
2024-04-21 10:11:13,257 [ease.py] => Task 2, Epoch 20/20 => Loss 0.151, Train_accy 95.34
2024-04-21 10:13:44,070 [ease.py] => Task correct: 90.37142857142857
2024-04-21 10:13:44,070 [ease.py] => Task acc: 98.3
2024-04-21 10:13:44,358 [trainer.py] => No NME accuracy.
2024-04-21 10:13:44,358 [trainer.py] => CNN: {'total': 89.97, '00-49': 88.18, '50-59': 94.2, '60-69': 94.7, 'old': 89.18, 'new': 94.7}
2024-04-21 10:13:44,358 [trainer.py] => CNN top1 curve: [94.52, 91.1, 89.97]
2024-04-21 10:13:44,358 [trainer.py] => CNN top5 curve: [99.6, 99.43, 99.36]

Average Accuracy (CNN): 91.86
2024-04-21 10:13:44,358 [trainer.py] => Average Accuracy (CNN): 91.86 

2024-04-21 10:13:44,358 [trainer.py] => Train Time: 11018.759999999998
2024-04-21 10:13:44,358 [trainer.py] => Test Time: 165.3 

2024-04-21 10:13:44,359 [trainer.py] => All params: 87157250
2024-04-21 10:13:44,360 [trainer.py] => Trainable params: 1189632
2024-04-21 10:13:44,365 [ease.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.704, Train_accy 66.20:   0%|          | 0/20 [00:35<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.704, Train_accy 66.20:   5%|▌         | 1/20 [00:35<11:15, 35.55s/it]
Task 3, Epoch 2/20 => Loss 0.579, Train_accy 86.84:   5%|▌         | 1/20 [01:12<11:15, 35.55s/it]
Task 3, Epoch 2/20 => Loss 0.579, Train_accy 86.84:  10%|█         | 2/20 [01:12<10:52, 36.23s/it]
Task 3, Epoch 3/20 => Loss 0.350, Train_accy 90.34:  10%|█         | 2/20 [01:48<10:52, 36.23s/it]
Task 3, Epoch 3/20 => Loss 0.350, Train_accy 90.34:  15%|█▌        | 3/20 [01:48<10:16, 36.25s/it]
Task 3, Epoch 4/20 => Loss 0.292, Train_accy 91.12:  15%|█▌        | 3/20 [02:25<10:16, 36.25s/it]
Task 3, Epoch 4/20 => Loss 0.292, Train_accy 91.12:  20%|██        | 4/20 [02:25<09:42, 36.41s/it]
Task 3, Epoch 5/20 => Loss 0.274, Train_accy 91.52:  20%|██        | 4/20 [03:02<09:42, 36.41s/it]
Task 3, Epoch 5/20 => Loss 0.274, Train_accy 91.52:  25%|██▌       | 5/20 [03:02<09:08, 36.57s/it]
Task 3, Epoch 6/20 => Loss 0.240, Train_accy 92.54:  25%|██▌       | 5/20 [03:34<09:08, 36.57s/it]
Task 3, Epoch 6/20 => Loss 0.240, Train_accy 92.54:  30%|███       | 6/20 [03:34<08:14, 35.32s/it]
Task 3, Epoch 7/20 => Loss 0.247, Train_accy 92.14:  30%|███       | 6/20 [04:08<08:14, 35.32s/it]
Task 3, Epoch 7/20 => Loss 0.247, Train_accy 92.14:  35%|███▌      | 7/20 [04:08<07:32, 34.79s/it]
Task 3, Epoch 8/20 => Loss 0.220, Train_accy 92.94:  35%|███▌      | 7/20 [04:55<07:32, 34.79s/it]
Task 3, Epoch 8/20 => Loss 0.220, Train_accy 92.94:  40%|████      | 8/20 [04:55<07:44, 38.68s/it]
Task 3, Epoch 9/20 => Loss 0.227, Train_accy 92.56:  40%|████      | 8/20 [05:38<07:44, 38.68s/it]
Task 3, Epoch 9/20 => Loss 0.227, Train_accy 92.56:  45%|████▌     | 9/20 [05:38<07:20, 40.07s/it]
Task 3, Epoch 10/20 => Loss 0.224, Train_accy 92.84:  45%|████▌     | 9/20 [06:15<07:20, 40.07s/it]
Task 3, Epoch 10/20 => Loss 0.224, Train_accy 92.84:  50%|█████     | 10/20 [06:15<06:30, 39.00s/it]
Task 3, Epoch 11/20 => Loss 0.213, Train_accy 93.54:  50%|█████     | 10/20 [06:50<06:30, 39.00s/it]
Task 3, Epoch 11/20 => Loss 0.213, Train_accy 93.54:  55%|█████▌    | 11/20 [06:50<05:41, 37.96s/it]
Task 3, Epoch 12/20 => Loss 0.219, Train_accy 93.06:  55%|█████▌    | 11/20 [07:27<05:41, 37.96s/it]
Task 3, Epoch 12/20 => Loss 0.219, Train_accy 93.06:  60%|██████    | 12/20 [07:27<05:00, 37.58s/it]
Task 3, Epoch 13/20 => Loss 0.207, Train_accy 93.30:  60%|██████    | 12/20 [08:05<05:00, 37.58s/it]
Task 3, Epoch 13/20 => Loss 0.207, Train_accy 93.30:  65%|██████▌   | 13/20 [08:05<04:23, 37.69s/it]
Task 3, Epoch 14/20 => Loss 0.200, Train_accy 93.58:  65%|██████▌   | 13/20 [08:42<04:23, 37.69s/it]
Task 3, Epoch 14/20 => Loss 0.200, Train_accy 93.58:  70%|███████   | 14/20 [08:42<03:44, 37.41s/it]
Task 3, Epoch 15/20 => Loss 0.196, Train_accy 93.66:  70%|███████   | 14/20 [09:14<03:44, 37.41s/it]
Task 3, Epoch 15/20 => Loss 0.196, Train_accy 93.66:  75%|███████▌  | 15/20 [09:14<02:59, 35.86s/it]
Task 3, Epoch 16/20 => Loss 0.219, Train_accy 92.68:  75%|███████▌  | 15/20 [09:50<02:59, 35.86s/it]
Task 3, Epoch 16/20 => Loss 0.219, Train_accy 92.68:  80%|████████  | 16/20 [09:50<02:23, 35.92s/it]
Task 3, Epoch 17/20 => Loss 0.198, Train_accy 93.52:  80%|████████  | 16/20 [10:37<02:23, 35.92s/it]
Task 3, Epoch 17/20 => Loss 0.198, Train_accy 93.52:  85%|████████▌ | 17/20 [10:37<01:57, 39.27s/it]
Task 3, Epoch 18/20 => Loss 0.197, Train_accy 93.76:  85%|████████▌ | 17/20 [11:19<01:57, 39.27s/it]
Task 3, Epoch 18/20 => Loss 0.197, Train_accy 93.76:  90%|█████████ | 18/20 [11:19<01:19, 39.93s/it]
Task 3, Epoch 19/20 => Loss 0.212, Train_accy 93.16:  90%|█████████ | 18/20 [11:56<01:19, 39.93s/it]
Task 3, Epoch 19/20 => Loss 0.212, Train_accy 93.16:  95%|█████████▌| 19/20 [11:56<00:38, 38.98s/it]
Task 3, Epoch 20/20 => Loss 0.202, Train_accy 93.40:  95%|█████████▌| 19/20 [12:32<00:38, 38.98s/it]
Task 3, Epoch 20/20 => Loss 0.202, Train_accy 93.40: 100%|██████████| 20/20 [12:32<00:00, 38.36s/it]
Task 3, Epoch 20/20 => Loss 0.202, Train_accy 93.40: 100%|██████████| 20/20 [12:32<00:00, 37.65s/it]
2024-04-21 10:26:17,412 [ease.py] => Task 3, Epoch 20/20 => Loss 0.202, Train_accy 93.40
2024-04-21 10:29:31,111 [ease.py] => Task correct: 87.0625
2024-04-21 10:29:31,111 [ease.py] => Task acc: 98.125
2024-04-21 10:29:31,382 [trainer.py] => No NME accuracy.
2024-04-21 10:29:31,382 [trainer.py] => CNN: {'total': 86.4, '00-49': 84.6, '50-59': 84.8, '60-69': 89.0, '70-79': 94.4, 'old': 85.26, 'new': 94.4}
2024-04-21 10:29:31,382 [trainer.py] => CNN top1 curve: [94.52, 91.1, 89.97, 86.4]
2024-04-21 10:29:31,382 [trainer.py] => CNN top5 curve: [99.6, 99.43, 99.36, 99.16]

Average Accuracy (CNN): 90.5
2024-04-21 10:29:31,382 [trainer.py] => Average Accuracy (CNN): 90.5 

2024-04-21 10:29:31,382 [trainer.py] => Train Time: 12524.609999999999
2024-04-21 10:29:31,382 [trainer.py] => Test Time: 273.67 

2024-04-21 10:29:31,383 [trainer.py] => All params: 87241730
2024-04-21 10:29:31,384 [trainer.py] => Trainable params: 1189632
2024-04-21 10:29:31,400 [ease.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.685, Train_accy 69.52:   0%|          | 0/20 [00:47<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.685, Train_accy 69.52:   5%|▌         | 1/20 [00:47<15:05, 47.67s/it]
Task 4, Epoch 2/20 => Loss 0.520, Train_accy 88.82:   5%|▌         | 1/20 [01:26<15:05, 47.67s/it]
Task 4, Epoch 2/20 => Loss 0.520, Train_accy 88.82:  10%|█         | 2/20 [01:26<12:46, 42.57s/it]
Task 4, Epoch 3/20 => Loss 0.315, Train_accy 91.50:  10%|█         | 2/20 [02:02<12:46, 42.57s/it]
Task 4, Epoch 3/20 => Loss 0.315, Train_accy 91.50:  15%|█▌        | 3/20 [02:02<11:10, 39.42s/it]
Task 4, Epoch 4/20 => Loss 0.270, Train_accy 92.16:  15%|█▌        | 3/20 [02:38<11:10, 39.42s/it]
Task 4, Epoch 4/20 => Loss 0.270, Train_accy 92.16:  20%|██        | 4/20 [02:38<10:09, 38.11s/it]
Task 4, Epoch 5/20 => Loss 0.251, Train_accy 92.36:  20%|██        | 4/20 [03:13<10:09, 38.11s/it]
Task 4, Epoch 5/20 => Loss 0.251, Train_accy 92.36:  25%|██▌       | 5/20 [03:13<09:17, 37.17s/it]
Task 4, Epoch 6/20 => Loss 0.245, Train_accy 92.68:  25%|██▌       | 5/20 [03:51<09:17, 37.17s/it]
Task 4, Epoch 6/20 => Loss 0.245, Train_accy 92.68:  30%|███       | 6/20 [03:51<08:39, 37.14s/it]
Task 4, Epoch 7/20 => Loss 0.227, Train_accy 92.68:  30%|███       | 6/20 [04:28<08:39, 37.14s/it]
Task 4, Epoch 7/20 => Loss 0.227, Train_accy 92.68:  35%|███▌      | 7/20 [04:28<08:03, 37.23s/it]
Task 4, Epoch 8/20 => Loss 0.216, Train_accy 92.94:  35%|███▌      | 7/20 [04:59<08:03, 37.23s/it]
Task 4, Epoch 8/20 => Loss 0.216, Train_accy 92.94:  40%|████      | 8/20 [04:59<07:04, 35.42s/it]
Task 4, Epoch 9/20 => Loss 0.214, Train_accy 93.12:  40%|████      | 8/20 [05:32<07:04, 35.42s/it]
Task 4, Epoch 9/20 => Loss 0.214, Train_accy 93.12:  45%|████▌     | 9/20 [05:32<06:20, 34.62s/it]
Task 4, Epoch 10/20 => Loss 0.202, Train_accy 93.54:  45%|████▌     | 9/20 [06:18<06:20, 34.62s/it]
Task 4, Epoch 10/20 => Loss 0.202, Train_accy 93.54:  50%|█████     | 10/20 [06:18<06:20, 38.10s/it]
Task 4, Epoch 11/20 => Loss 0.200, Train_accy 93.44:  50%|█████     | 10/20 [07:00<06:20, 38.10s/it]
Task 4, Epoch 11/20 => Loss 0.200, Train_accy 93.44:  55%|█████▌    | 11/20 [07:00<05:54, 39.34s/it]
Task 4, Epoch 12/20 => Loss 0.207, Train_accy 93.16:  55%|█████▌    | 11/20 [07:37<05:54, 39.34s/it]
Task 4, Epoch 12/20 => Loss 0.207, Train_accy 93.16:  60%|██████    | 12/20 [07:37<05:07, 38.45s/it]
Task 4, Epoch 13/20 => Loss 0.198, Train_accy 93.82:  60%|██████    | 12/20 [08:13<05:07, 38.45s/it]
Task 4, Epoch 13/20 => Loss 0.198, Train_accy 93.82:  65%|██████▌   | 13/20 [08:13<04:23, 37.64s/it]
Task 4, Epoch 14/20 => Loss 0.185, Train_accy 94.22:  65%|██████▌   | 13/20 [08:47<04:23, 37.64s/it]
Task 4, Epoch 14/20 => Loss 0.185, Train_accy 94.22:  70%|███████   | 14/20 [08:47<03:40, 36.68s/it]
Task 4, Epoch 15/20 => Loss 0.189, Train_accy 94.24:  70%|███████   | 14/20 [09:29<03:40, 36.68s/it]
Task 4, Epoch 15/20 => Loss 0.189, Train_accy 94.24:  75%|███████▌  | 15/20 [09:29<03:11, 38.24s/it]
Task 4, Epoch 16/20 => Loss 0.182, Train_accy 94.08:  75%|███████▌  | 15/20 [10:15<03:11, 38.24s/it]
Task 4, Epoch 16/20 => Loss 0.182, Train_accy 94.08:  80%|████████  | 16/20 [10:15<02:42, 40.64s/it]
Task 4, Epoch 17/20 => Loss 0.185, Train_accy 94.18:  80%|████████  | 16/20 [10:51<02:42, 40.64s/it]
Task 4, Epoch 17/20 => Loss 0.185, Train_accy 94.18:  85%|████████▌ | 17/20 [10:51<01:57, 39.29s/it]
Task 4, Epoch 18/20 => Loss 0.186, Train_accy 94.20:  85%|████████▌ | 17/20 [11:26<01:57, 39.29s/it]
Task 4, Epoch 18/20 => Loss 0.186, Train_accy 94.20:  90%|█████████ | 18/20 [11:26<01:15, 37.99s/it]
Task 4, Epoch 19/20 => Loss 0.197, Train_accy 93.82:  90%|█████████ | 18/20 [12:02<01:15, 37.99s/it]
Task 4, Epoch 19/20 => Loss 0.197, Train_accy 93.82:  95%|█████████▌| 19/20 [12:02<00:37, 37.30s/it]
Task 4, Epoch 20/20 => Loss 0.194, Train_accy 93.84:  95%|█████████▌| 19/20 [12:34<00:37, 37.30s/it]
Task 4, Epoch 20/20 => Loss 0.194, Train_accy 93.84: 100%|██████████| 20/20 [12:34<00:00, 35.69s/it]
Task 4, Epoch 20/20 => Loss 0.194, Train_accy 93.84: 100%|██████████| 20/20 [12:34<00:00, 37.72s/it]
2024-04-21 10:42:05,894 [ease.py] => Task 4, Epoch 20/20 => Loss 0.194, Train_accy 93.84
2024-04-21 10:46:55,941 [ease.py] => Task correct: 85.71111111111111
2024-04-21 10:46:55,942 [ease.py] => Task acc: 98.15555555555555
2024-04-21 10:46:56,118 [trainer.py] => No NME accuracy.
2024-04-21 10:46:56,118 [trainer.py] => CNN: {'total': 85.07, '00-49': 81.36, '50-59': 83.3, '60-69': 87.8, '70-79': 92.6, '80-89': 95.1, 'old': 83.81, 'new': 95.1}
2024-04-21 10:46:56,119 [trainer.py] => CNN top1 curve: [94.52, 91.1, 89.97, 86.4, 85.07]
2024-04-21 10:46:56,119 [trainer.py] => CNN top5 curve: [99.6, 99.43, 99.36, 99.16, 98.92]

Average Accuracy (CNN): 89.41
2024-04-21 10:46:56,119 [trainer.py] => Average Accuracy (CNN): 89.41 

2024-04-21 10:46:56,119 [trainer.py] => Train Time: 14033.32
2024-04-21 10:46:56,119 [trainer.py] => Test Time: 441.76 

2024-04-21 10:46:56,120 [trainer.py] => All params: 87341570
2024-04-21 10:46:56,121 [trainer.py] => Trainable params: 1189632
2024-04-21 10:46:56,128 [ease.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.638, Train_accy 69.50:   0%|          | 0/20 [00:38<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.638, Train_accy 69.50:   5%|▌         | 1/20 [00:38<12:20, 38.95s/it]
Task 5, Epoch 2/20 => Loss 0.535, Train_accy 87.28:   5%|▌         | 1/20 [01:15<12:20, 38.95s/it]
Task 5, Epoch 2/20 => Loss 0.535, Train_accy 87.28:  10%|█         | 2/20 [01:15<11:12, 37.37s/it]
Task 5, Epoch 3/20 => Loss 0.348, Train_accy 90.08:  10%|█         | 2/20 [01:52<11:12, 37.37s/it]
Task 5, Epoch 3/20 => Loss 0.348, Train_accy 90.08:  15%|█▌        | 3/20 [01:52<10:35, 37.39s/it]
Task 5, Epoch 4/20 => Loss 0.287, Train_accy 91.18:  15%|█▌        | 3/20 [02:24<10:35, 37.39s/it]
Task 5, Epoch 4/20 => Loss 0.287, Train_accy 91.18:  20%|██        | 4/20 [02:24<09:20, 35.05s/it]
Task 5, Epoch 5/20 => Loss 0.288, Train_accy 91.26:  20%|██        | 4/20 [03:11<09:20, 35.05s/it]
Task 5, Epoch 5/20 => Loss 0.288, Train_accy 91.26:  25%|██▌       | 5/20 [03:11<09:50, 39.39s/it]
Task 5, Epoch 6/20 => Loss 0.263, Train_accy 91.78:  25%|██▌       | 5/20 [03:54<09:50, 39.39s/it]
Task 5, Epoch 6/20 => Loss 0.263, Train_accy 91.78:  30%|███       | 6/20 [03:54<09:32, 40.87s/it]
Task 5, Epoch 7/20 => Loss 0.245, Train_accy 92.30:  30%|███       | 6/20 [04:31<09:32, 40.87s/it]
Task 5, Epoch 7/20 => Loss 0.245, Train_accy 92.30:  35%|███▌      | 7/20 [04:31<08:32, 39.42s/it]
Task 5, Epoch 8/20 => Loss 0.255, Train_accy 92.06:  35%|███▌      | 7/20 [05:08<08:32, 39.42s/it]
Task 5, Epoch 8/20 => Loss 0.255, Train_accy 92.06:  40%|████      | 8/20 [05:08<07:44, 38.67s/it]
Task 5, Epoch 9/20 => Loss 0.249, Train_accy 92.08:  40%|████      | 8/20 [05:42<07:44, 38.67s/it]
Task 5, Epoch 9/20 => Loss 0.249, Train_accy 92.08:  45%|████▌     | 9/20 [05:42<06:50, 37.29s/it]
Task 5, Epoch 10/20 => Loss 0.234, Train_accy 92.36:  45%|████▌     | 9/20 [06:24<06:50, 37.29s/it]
Task 5, Epoch 10/20 => Loss 0.234, Train_accy 92.36:  50%|█████     | 10/20 [06:24<06:28, 38.80s/it]
Task 5, Epoch 11/20 => Loss 0.243, Train_accy 92.48:  50%|█████     | 10/20 [07:10<06:28, 38.80s/it]
Task 5, Epoch 11/20 => Loss 0.243, Train_accy 92.48:  55%|█████▌    | 11/20 [07:10<06:08, 40.96s/it]
Task 5, Epoch 12/20 => Loss 0.227, Train_accy 92.82:  55%|█████▌    | 11/20 [07:47<06:08, 40.96s/it]
Task 5, Epoch 12/20 => Loss 0.227, Train_accy 92.82:  60%|██████    | 12/20 [07:47<05:17, 39.70s/it]
Task 5, Epoch 13/20 => Loss 0.217, Train_accy 92.90:  60%|██████    | 12/20 [08:24<05:17, 39.70s/it]
Task 5, Epoch 13/20 => Loss 0.217, Train_accy 92.90:  65%|██████▌   | 13/20 [08:24<04:31, 38.76s/it]
Task 5, Epoch 14/20 => Loss 0.220, Train_accy 92.84:  65%|██████▌   | 13/20 [09:01<04:31, 38.76s/it]
Task 5, Epoch 14/20 => Loss 0.220, Train_accy 92.84:  70%|███████   | 14/20 [09:01<03:49, 38.28s/it]
Task 5, Epoch 15/20 => Loss 0.222, Train_accy 92.66:  70%|███████   | 14/20 [09:35<03:49, 38.28s/it]
Task 5, Epoch 15/20 => Loss 0.222, Train_accy 92.66:  75%|███████▌  | 15/20 [09:35<03:04, 36.95s/it]
Task 5, Epoch 16/20 => Loss 0.221, Train_accy 92.72:  75%|███████▌  | 15/20 [10:21<03:04, 36.95s/it]
Task 5, Epoch 16/20 => Loss 0.221, Train_accy 92.72:  80%|████████  | 16/20 [10:21<02:38, 39.73s/it]
Task 5, Epoch 17/20 => Loss 0.216, Train_accy 93.14:  80%|████████  | 16/20 [11:03<02:38, 39.73s/it]
Task 5, Epoch 17/20 => Loss 0.216, Train_accy 93.14:  85%|████████▌ | 17/20 [11:03<02:00, 40.31s/it]
Task 5, Epoch 18/20 => Loss 0.202, Train_accy 93.72:  85%|████████▌ | 17/20 [11:39<02:00, 40.31s/it]
Task 5, Epoch 18/20 => Loss 0.202, Train_accy 93.72:  90%|█████████ | 18/20 [11:39<01:18, 39.05s/it]
Task 5, Epoch 19/20 => Loss 0.188, Train_accy 94.00:  90%|█████████ | 18/20 [12:16<01:18, 39.05s/it]
Task 5, Epoch 19/20 => Loss 0.188, Train_accy 94.00:  95%|█████████▌| 19/20 [12:16<00:38, 38.44s/it]
Task 5, Epoch 20/20 => Loss 0.215, Train_accy 93.08:  95%|█████████▌| 19/20 [12:49<00:38, 38.44s/it]
Task 5, Epoch 20/20 => Loss 0.215, Train_accy 93.08: 100%|██████████| 20/20 [12:49<00:00, 36.85s/it]
Task 5, Epoch 20/20 => Loss 0.215, Train_accy 93.08: 100%|██████████| 20/20 [12:49<00:00, 38.46s/it]
2024-04-21 10:59:45,495 [ease.py] => Task 5, Epoch 20/20 => Loss 0.215, Train_accy 93.08
2024-04-21 11:05:48,807 [ease.py] => Task correct: 85.55
2024-04-21 11:05:48,808 [ease.py] => Task acc: 98.06
2024-04-21 11:05:49,017 [trainer.py] => No NME accuracy.
2024-04-21 11:05:49,018 [trainer.py] => CNN: {'total': 84.87, '00-49': 80.4, '50-59': 82.3, '60-69': 87.5, '70-79': 91.6, '80-89': 94.5, '90-99': 90.8, 'old': 84.21, 'new': 90.8}
2024-04-21 11:05:49,018 [trainer.py] => CNN top1 curve: [94.52, 91.1, 89.97, 86.4, 85.07, 84.87]
2024-04-21 11:05:49,018 [trainer.py] => CNN top5 curve: [99.6, 99.43, 99.36, 99.16, 98.92, 98.72]

Average Accuracy (CNN): 88.66
2024-04-21 11:05:49,018 [trainer.py] => Average Accuracy (CNN): 88.66 

2024-04-21 11:05:49,018 [trainer.py] => Train Time: 15571.91
2024-04-21 11:05:49,018 [trainer.py] => Test Time: 663.97 

Accuracy Matrix (CNN):
[[94.52 90.   88.18 84.6  81.36 80.4 ]
 [ 0.   96.6  94.2  84.8  83.3  82.3 ]
 [ 0.    0.   94.7  89.   87.8  87.5 ]
 [ 0.    0.    0.   94.4  92.6  91.6 ]
 [ 0.    0.    0.    0.   95.1  94.5 ]
 [ 0.    0.    0.    0.    0.   90.8 ]]
2024-04-21 11:05:49,019 [trainer.py] => Forgetting (CNN): 7.803999999999999

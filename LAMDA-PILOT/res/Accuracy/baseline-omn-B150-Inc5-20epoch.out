nohup: 忽略输入
2024-04-23 14:36:41,977 [trainer.py] => config: ./exps/finetune_omn_B150.json
2024-04-23 14:36:41,977 [trainer.py] => prefix: reproduce
2024-04-23 14:36:41,977 [trainer.py] => dataset: omnibenchmark
2024-04-23 14:36:41,977 [trainer.py] => memory_size: 0
2024-04-23 14:36:41,977 [trainer.py] => memory_per_class: 0
2024-04-23 14:36:41,977 [trainer.py] => fixed_memory: False
2024-04-23 14:36:41,977 [trainer.py] => shuffle: True
2024-04-23 14:36:41,977 [trainer.py] => init_cls: 150
2024-04-23 14:36:41,977 [trainer.py] => increment: 30
2024-04-23 14:36:41,977 [trainer.py] => model_name: finetune
2024-04-23 14:36:41,977 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-23 14:36:41,977 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-23 14:36:41,977 [trainer.py] => seed: 1993
2024-04-23 14:36:41,977 [trainer.py] => init_epoch: 20
2024-04-23 14:36:41,977 [trainer.py] => init_lr: 0.001
2024-04-23 14:36:41,977 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-23 14:36:41,977 [trainer.py] => init_lr_decay: 0.1
2024-04-23 14:36:41,977 [trainer.py] => init_weight_decay: 0.0005
2024-04-23 14:36:41,977 [trainer.py] => epochs: 20
2024-04-23 14:36:41,977 [trainer.py] => lrate: 0.001
2024-04-23 14:36:41,977 [trainer.py] => milestones: [40, 70]
2024-04-23 14:36:41,977 [trainer.py] => lrate_decay: 0.1
2024-04-23 14:36:41,977 [trainer.py] => batch_size: 48
2024-04-23 14:36:41,977 [trainer.py] => weight_decay: 0.0002
2024-04-23 14:36:42,242 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-23 14:36:44,833 [trainer.py] => All params: 85798656
2024-04-23 14:36:44,834 [trainer.py] => Trainable params: 85798656
2024-04-23 14:36:44,834 [finetune.py] => Learning on 0-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.449, Train_accy 61.60, Test_accy 76.75:   0%|          | 0/20 [05:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.449, Train_accy 61.60, Test_accy 76.75:   5%|▌         | 1/20 [05:00<1:35:11, 300.61s/it]
Task 0, Epoch 2/20 => Loss 0.873, Train_accy 74.55:   5%|▌         | 1/20 [09:52<1:35:11, 300.61s/it]                 
Task 0, Epoch 2/20 => Loss 0.873, Train_accy 74.55:  10%|█         | 2/20 [09:52<1:28:37, 295.44s/it]
Task 0, Epoch 3/20 => Loss 0.758, Train_accy 77.83:  10%|█         | 2/20 [14:43<1:28:37, 295.44s/it]
Task 0, Epoch 3/20 => Loss 0.758, Train_accy 77.83:  15%|█▌        | 3/20 [14:43<1:23:11, 293.62s/it]
Task 0, Epoch 4/20 => Loss 0.664, Train_accy 80.48:  15%|█▌        | 3/20 [19:35<1:23:11, 293.62s/it]
Task 0, Epoch 4/20 => Loss 0.664, Train_accy 80.48:  20%|██        | 4/20 [19:35<1:18:02, 292.68s/it]
Task 0, Epoch 5/20 => Loss 0.618, Train_accy 81.70:  20%|██        | 4/20 [24:28<1:18:02, 292.68s/it]
Task 0, Epoch 5/20 => Loss 0.618, Train_accy 81.70:  25%|██▌       | 5/20 [24:28<1:13:11, 292.77s/it]
Task 0, Epoch 6/20 => Loss 0.568, Train_accy 83.01, Test_accy 84.07:  25%|██▌       | 5/20 [29:27<1:13:11, 292.77s/it]
Task 0, Epoch 6/20 => Loss 0.568, Train_accy 83.01, Test_accy 84.07:  30%|███       | 6/20 [29:27<1:08:48, 294.92s/it]
Task 0, Epoch 7/20 => Loss 0.536, Train_accy 83.97:  30%|███       | 6/20 [34:18<1:08:48, 294.92s/it]                 
Task 0, Epoch 7/20 => Loss 0.536, Train_accy 83.97:  35%|███▌      | 7/20 [34:18<1:03:40, 293.87s/it]
Task 0, Epoch 8/20 => Loss 0.517, Train_accy 84.52:  35%|███▌      | 7/20 [39:10<1:03:40, 293.87s/it]
Task 0, Epoch 8/20 => Loss 0.517, Train_accy 84.52:  40%|████      | 8/20 [39:10<58:39, 293.32s/it]  
Task 0, Epoch 9/20 => Loss 0.486, Train_accy 85.44:  40%|████      | 8/20 [44:16<58:39, 293.32s/it]
Task 0, Epoch 9/20 => Loss 0.486, Train_accy 85.44:  45%|████▌     | 9/20 [44:16<54:29, 297.24s/it]
Task 0, Epoch 10/20 => Loss 0.469, Train_accy 86.03:  45%|████▌     | 9/20 [49:08<54:29, 297.24s/it]
Task 0, Epoch 10/20 => Loss 0.469, Train_accy 86.03:  50%|█████     | 10/20 [49:08<49:13, 295.36s/it]
Task 0, Epoch 11/20 => Loss 0.456, Train_accy 86.30, Test_accy 85.91:  50%|█████     | 10/20 [54:08<49:13, 295.36s/it]
Task 0, Epoch 11/20 => Loss 0.456, Train_accy 86.30, Test_accy 85.91:  55%|█████▌    | 11/20 [54:08<44:33, 297.06s/it]
Task 0, Epoch 12/20 => Loss 0.434, Train_accy 87.20:  55%|█████▌    | 11/20 [58:59<44:33, 297.06s/it]                 
Task 0, Epoch 12/20 => Loss 0.434, Train_accy 87.20:  60%|██████    | 12/20 [58:59<39:21, 295.14s/it]
Task 0, Epoch 13/20 => Loss 0.423, Train_accy 87.28:  60%|██████    | 12/20 [1:03:50<39:21, 295.14s/it]
Task 0, Epoch 13/20 => Loss 0.423, Train_accy 87.28:  65%|██████▌   | 13/20 [1:03:50<34:17, 293.94s/it]
Task 0, Epoch 14/20 => Loss 0.406, Train_accy 88.01:  65%|██████▌   | 13/20 [1:08:42<34:17, 293.94s/it]
Task 0, Epoch 14/20 => Loss 0.406, Train_accy 88.01:  70%|███████   | 14/20 [1:08:42<29:18, 293.13s/it]
Task 0, Epoch 15/20 => Loss 0.395, Train_accy 88.19:  70%|███████   | 14/20 [1:13:34<29:18, 293.13s/it]
Task 0, Epoch 15/20 => Loss 0.395, Train_accy 88.19:  75%|███████▌  | 15/20 [1:13:34<24:25, 293.03s/it]
Task 0, Epoch 16/20 => Loss 0.384, Train_accy 88.55, Test_accy 84.47:  75%|███████▌  | 15/20 [1:18:35<24:25, 293.03s/it]
Task 0, Epoch 16/20 => Loss 0.384, Train_accy 88.55, Test_accy 84.47:  80%|████████  | 16/20 [1:18:35<19:41, 295.25s/it]
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 88.73:  80%|████████  | 16/20 [1:23:26<19:41, 295.25s/it]                 
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 88.73:  85%|████████▌ | 17/20 [1:23:26<14:42, 294.04s/it]
Task 0, Epoch 18/20 => Loss 0.361, Train_accy 89.34:  85%|████████▌ | 17/20 [1:28:18<14:42, 294.04s/it]
Task 0, Epoch 18/20 => Loss 0.361, Train_accy 89.34:  90%|█████████ | 18/20 [1:28:18<09:46, 293.42s/it]
Task 0, Epoch 19/20 => Loss 0.355, Train_accy 89.46:  90%|█████████ | 18/20 [1:33:09<09:46, 293.42s/it]
Task 0, Epoch 19/20 => Loss 0.355, Train_accy 89.46:  95%|█████████▌| 19/20 [1:33:09<04:52, 292.57s/it]
Task 0, Epoch 20/20 => Loss 0.351, Train_accy 89.60:  95%|█████████▌| 19/20 [1:37:59<04:52, 292.57s/it]
Task 0, Epoch 20/20 => Loss 0.351, Train_accy 89.60: 100%|██████████| 20/20 [1:37:59<00:00, 292.00s/it]
Task 0, Epoch 20/20 => Loss 0.351, Train_accy 89.60: 100%|██████████| 20/20 [1:37:59<00:00, 293.99s/it]
2024-04-23 16:14:45,097 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.351, Train_accy 89.60
2024-04-23 16:14:53,353 [trainer.py] => No NME accuracy.
2024-04-23 16:14:53,354 [trainer.py] => CNN: {'total': 84.64, '00-149': 84.64, 'old': 0, 'new': 84.64}
2024-04-23 16:14:53,354 [trainer.py] => CNN top1 curve: [84.64]
2024-04-23 16:14:53,354 [trainer.py] => CNN top5 curve: [97.19]

Average Accuracy (CNN): 84.64
2024-04-23 16:14:53,355 [trainer.py] => Average Accuracy (CNN): 84.64 

2024-04-23 16:14:53,355 [trainer.py] => Train Time: 11760.02
2024-04-23 16:14:53,355 [trainer.py] => Test Time: 8.25 

2024-04-23 16:14:53,357 [trainer.py] => All params: 85914006
2024-04-23 16:14:53,358 [trainer.py] => Trainable params: 85914006
2024-04-23 16:14:53,362 [finetune.py] => Learning on 150-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.695, Train_accy 34.07, Test_accy 77.00:   0%|          | 0/20 [01:08<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.695, Train_accy 34.07, Test_accy 77.00:   5%|▌         | 1/20 [01:08<21:33, 68.07s/it]
Task 1, Epoch 2/20 => Loss 0.302, Train_accy 50.73:   5%|▌         | 1/20 [02:06<21:33, 68.07s/it]                 
Task 1, Epoch 2/20 => Loss 0.302, Train_accy 50.73:  10%|█         | 2/20 [02:06<18:38, 62.14s/it]
Task 1, Epoch 3/20 => Loss 0.245, Train_accy 59.17:  10%|█         | 2/20 [03:03<18:38, 62.14s/it]
Task 1, Epoch 3/20 => Loss 0.245, Train_accy 59.17:  15%|█▌        | 3/20 [03:03<17:03, 60.18s/it]
Task 1, Epoch 4/20 => Loss 0.213, Train_accy 64.96:  15%|█▌        | 3/20 [04:01<17:03, 60.18s/it]
Task 1, Epoch 4/20 => Loss 0.213, Train_accy 64.96:  20%|██        | 4/20 [04:01<15:48, 59.30s/it]
Task 1, Epoch 5/20 => Loss 0.189, Train_accy 68.06:  20%|██        | 4/20 [04:59<15:48, 59.30s/it]
Task 1, Epoch 5/20 => Loss 0.189, Train_accy 68.06:  25%|██▌       | 5/20 [04:59<14:41, 58.78s/it]
Task 1, Epoch 6/20 => Loss 0.181, Train_accy 71.76, Test_accy 79.96:  25%|██▌       | 5/20 [06:07<14:41, 58.78s/it]
Task 1, Epoch 6/20 => Loss 0.181, Train_accy 71.76, Test_accy 79.96:  30%|███       | 6/20 [06:07<14:24, 61.72s/it]
Task 1, Epoch 7/20 => Loss 0.169, Train_accy 74.10:  30%|███       | 6/20 [07:05<14:24, 61.72s/it]                 
Task 1, Epoch 7/20 => Loss 0.169, Train_accy 74.10:  35%|███▌      | 7/20 [07:05<13:06, 60.50s/it]
Task 1, Epoch 8/20 => Loss 0.150, Train_accy 76.60:  35%|███▌      | 7/20 [08:03<13:06, 60.50s/it]
Task 1, Epoch 8/20 => Loss 0.150, Train_accy 76.60:  40%|████      | 8/20 [08:03<11:56, 59.71s/it]
Task 1, Epoch 9/20 => Loss 0.164, Train_accy 77.02:  40%|████      | 8/20 [09:01<11:56, 59.71s/it]
Task 1, Epoch 9/20 => Loss 0.164, Train_accy 77.02:  45%|████▌     | 9/20 [09:01<10:50, 59.15s/it]
Task 1, Epoch 10/20 => Loss 0.145, Train_accy 79.13:  45%|████▌     | 9/20 [09:59<10:50, 59.15s/it]
Task 1, Epoch 10/20 => Loss 0.145, Train_accy 79.13:  50%|█████     | 10/20 [09:59<09:47, 58.78s/it]
Task 1, Epoch 11/20 => Loss 0.144, Train_accy 80.83, Test_accy 79.15:  50%|█████     | 10/20 [11:06<09:47, 58.78s/it]
Task 1, Epoch 11/20 => Loss 0.144, Train_accy 80.83, Test_accy 79.15:  55%|█████▌    | 11/20 [11:06<09:13, 61.51s/it]
Task 1, Epoch 12/20 => Loss 0.122, Train_accy 83.46:  55%|█████▌    | 11/20 [12:04<09:13, 61.51s/it]                 
Task 1, Epoch 12/20 => Loss 0.122, Train_accy 83.46:  60%|██████    | 12/20 [12:04<08:03, 60.42s/it]
Task 1, Epoch 13/20 => Loss 0.129, Train_accy 82.97:  60%|██████    | 12/20 [13:03<08:03, 60.42s/it]
Task 1, Epoch 13/20 => Loss 0.129, Train_accy 82.97:  65%|██████▌   | 13/20 [13:03<06:58, 59.80s/it]
Task 1, Epoch 14/20 => Loss 0.141, Train_accy 82.76:  65%|██████▌   | 13/20 [14:01<06:58, 59.80s/it]
Task 1, Epoch 14/20 => Loss 0.141, Train_accy 82.76:  70%|███████   | 14/20 [14:01<05:55, 59.25s/it]
Task 1, Epoch 15/20 => Loss 0.125, Train_accy 84.04:  70%|███████   | 14/20 [14:58<05:55, 59.25s/it]
Task 1, Epoch 15/20 => Loss 0.125, Train_accy 84.04:  75%|███████▌  | 15/20 [14:58<04:54, 58.87s/it]
Task 1, Epoch 16/20 => Loss 0.120, Train_accy 85.68, Test_accy 78.65:  75%|███████▌  | 15/20 [16:06<04:54, 58.87s/it]
Task 1, Epoch 16/20 => Loss 0.120, Train_accy 85.68, Test_accy 78.65:  80%|████████  | 16/20 [16:06<04:06, 61.53s/it]
Task 1, Epoch 17/20 => Loss 0.127, Train_accy 86.30:  80%|████████  | 16/20 [17:04<04:06, 61.53s/it]                 
Task 1, Epoch 17/20 => Loss 0.127, Train_accy 86.30:  85%|████████▌ | 17/20 [17:04<03:01, 60.46s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 87.29:  85%|████████▌ | 17/20 [18:02<03:01, 60.46s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 87.29:  90%|█████████ | 18/20 [18:02<01:59, 59.72s/it]
Task 1, Epoch 19/20 => Loss 0.108, Train_accy 88.25:  90%|█████████ | 18/20 [19:00<01:59, 59.72s/it]
Task 1, Epoch 19/20 => Loss 0.108, Train_accy 88.25:  95%|█████████▌| 19/20 [19:00<00:59, 59.20s/it]
Task 1, Epoch 20/20 => Loss 0.103, Train_accy 89.21:  95%|█████████▌| 19/20 [19:58<00:59, 59.20s/it]
Task 1, Epoch 20/20 => Loss 0.103, Train_accy 89.21: 100%|██████████| 20/20 [19:58<00:00, 58.81s/it]
Task 1, Epoch 20/20 => Loss 0.103, Train_accy 89.21: 100%|██████████| 20/20 [19:58<00:00, 59.93s/it]
2024-04-23 16:34:51,953 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.103, Train_accy 89.21
2024-04-23 16:35:01,523 [trainer.py] => No NME accuracy.
2024-04-23 16:35:01,523 [trainer.py] => CNN: {'total': 77.34, '00-149': 75.08, '150-179': 88.63, 'old': 75.08, 'new': 88.63}
2024-04-23 16:35:01,524 [trainer.py] => CNN top1 curve: [84.64, 77.34]
2024-04-23 16:35:01,524 [trainer.py] => CNN top5 curve: [97.19, 94.93]

Average Accuracy (CNN): 80.99
2024-04-23 16:35:01,524 [trainer.py] => Average Accuracy (CNN): 80.99 

2024-04-23 16:35:01,524 [trainer.py] => Train Time: 12958.59
2024-04-23 16:35:01,524 [trainer.py] => Test Time: 17.82 

2024-04-23 16:35:01,526 [trainer.py] => All params: 85937076
2024-04-23 16:35:01,527 [trainer.py] => Trainable params: 85937076
2024-04-23 16:35:01,531 [finetune.py] => Learning on 180-210

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.661, Train_accy 37.31, Test_accy 72.02:   0%|          | 0/20 [01:08<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.661, Train_accy 37.31, Test_accy 72.02:   5%|▌         | 1/20 [01:08<21:47, 68.84s/it]
Task 2, Epoch 2/20 => Loss 0.331, Train_accy 56.92:   5%|▌         | 1/20 [02:06<21:47, 68.84s/it]                 
Task 2, Epoch 2/20 => Loss 0.331, Train_accy 56.92:  10%|█         | 2/20 [02:06<18:40, 62.27s/it]
Task 2, Epoch 3/20 => Loss 0.272, Train_accy 65.92:  10%|█         | 2/20 [03:04<18:40, 62.27s/it]
Task 2, Epoch 3/20 => Loss 0.272, Train_accy 65.92:  15%|█▌        | 3/20 [03:04<17:04, 60.28s/it]
Task 2, Epoch 4/20 => Loss 0.226, Train_accy 70.50:  15%|█▌        | 3/20 [04:02<17:04, 60.28s/it]
Task 2, Epoch 4/20 => Loss 0.226, Train_accy 70.50:  20%|██        | 4/20 [04:02<15:48, 59.31s/it]
Task 2, Epoch 5/20 => Loss 0.212, Train_accy 73.54:  20%|██        | 4/20 [05:00<15:48, 59.31s/it]
Task 2, Epoch 5/20 => Loss 0.212, Train_accy 73.54:  25%|██▌       | 5/20 [05:00<14:42, 58.83s/it]
Task 2, Epoch 6/20 => Loss 0.194, Train_accy 76.31, Test_accy 72.48:  25%|██▌       | 5/20 [06:09<14:42, 58.83s/it]
Task 2, Epoch 6/20 => Loss 0.194, Train_accy 76.31, Test_accy 72.48:  30%|███       | 6/20 [06:09<14:31, 62.27s/it]
Task 2, Epoch 7/20 => Loss 0.207, Train_accy 78.45:  30%|███       | 6/20 [07:06<14:31, 62.27s/it]                 
Task 2, Epoch 7/20 => Loss 0.207, Train_accy 78.45:  35%|███▌      | 7/20 [07:06<13:09, 60.73s/it]
Task 2, Epoch 8/20 => Loss 0.176, Train_accy 80.10:  35%|███▌      | 7/20 [08:04<13:09, 60.73s/it]
Task 2, Epoch 8/20 => Loss 0.176, Train_accy 80.10:  40%|████      | 8/20 [08:04<11:57, 59.82s/it]
Task 2, Epoch 9/20 => Loss 0.162, Train_accy 82.18:  40%|████      | 8/20 [09:02<11:57, 59.82s/it]
Task 2, Epoch 9/20 => Loss 0.162, Train_accy 82.18:  45%|████▌     | 9/20 [09:02<10:50, 59.15s/it]
Task 2, Epoch 10/20 => Loss 0.148, Train_accy 83.34:  45%|████▌     | 9/20 [09:59<10:50, 59.15s/it]
Task 2, Epoch 10/20 => Loss 0.148, Train_accy 83.34:  50%|█████     | 10/20 [09:59<09:47, 58.70s/it]
Task 2, Epoch 11/20 => Loss 0.146, Train_accy 82.92, Test_accy 71.11:  50%|█████     | 10/20 [11:08<09:47, 58.70s/it]
Task 2, Epoch 11/20 => Loss 0.146, Train_accy 82.92, Test_accy 71.11:  55%|█████▌    | 11/20 [11:08<09:16, 61.81s/it]
Task 2, Epoch 12/20 => Loss 0.137, Train_accy 84.07:  55%|█████▌    | 11/20 [12:06<09:16, 61.81s/it]                 
Task 2, Epoch 12/20 => Loss 0.137, Train_accy 84.07:  60%|██████    | 12/20 [12:06<08:04, 60.59s/it]
Task 2, Epoch 13/20 => Loss 0.129, Train_accy 86.02:  60%|██████    | 12/20 [13:04<08:04, 60.59s/it]
Task 2, Epoch 13/20 => Loss 0.129, Train_accy 86.02:  65%|██████▌   | 13/20 [13:04<06:58, 59.75s/it]
Task 2, Epoch 14/20 => Loss 0.151, Train_accy 86.34:  65%|██████▌   | 13/20 [14:02<06:58, 59.75s/it]
Task 2, Epoch 14/20 => Loss 0.151, Train_accy 86.34:  70%|███████   | 14/20 [14:02<05:54, 59.11s/it]
Task 2, Epoch 15/20 => Loss 0.136, Train_accy 87.32:  70%|███████   | 14/20 [14:59<05:54, 59.11s/it]
Task 2, Epoch 15/20 => Loss 0.136, Train_accy 87.32:  75%|███████▌  | 15/20 [14:59<04:53, 58.69s/it]
Task 2, Epoch 16/20 => Loss 0.124, Train_accy 88.75, Test_accy 71.66:  75%|███████▌  | 15/20 [16:08<04:53, 58.69s/it]
Task 2, Epoch 16/20 => Loss 0.124, Train_accy 88.75, Test_accy 71.66:  80%|████████  | 16/20 [16:08<04:06, 61.74s/it]
Task 2, Epoch 17/20 => Loss 0.138, Train_accy 89.51:  80%|████████  | 16/20 [17:06<04:06, 61.74s/it]                 
Task 2, Epoch 17/20 => Loss 0.138, Train_accy 89.51:  85%|████████▌ | 17/20 [17:06<03:01, 60.52s/it]
Task 2, Epoch 18/20 => Loss 0.165, Train_accy 87.71:  85%|████████▌ | 17/20 [18:04<03:01, 60.52s/it]
Task 2, Epoch 18/20 => Loss 0.165, Train_accy 87.71:  90%|█████████ | 18/20 [18:04<01:59, 59.73s/it]
Task 2, Epoch 19/20 => Loss 0.140, Train_accy 89.71:  90%|█████████ | 18/20 [19:01<01:59, 59.73s/it]
Task 2, Epoch 19/20 => Loss 0.140, Train_accy 89.71:  95%|█████████▌| 19/20 [19:01<00:59, 59.13s/it]
Task 2, Epoch 20/20 => Loss 0.121, Train_accy 90.66:  95%|█████████▌| 19/20 [19:59<00:59, 59.13s/it]
Task 2, Epoch 20/20 => Loss 0.121, Train_accy 90.66: 100%|██████████| 20/20 [19:59<00:00, 58.72s/it]
Task 2, Epoch 20/20 => Loss 0.121, Train_accy 90.66: 100%|██████████| 20/20 [19:59<00:00, 59.98s/it]
2024-04-23 16:55:01,235 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.121, Train_accy 90.66
2024-04-23 16:55:12,212 [trainer.py] => No NME accuracy.
2024-04-23 16:55:12,212 [trainer.py] => CNN: {'total': 68.94, '00-149': 65.03, '150-179': 67.22, '180-209': 90.28, 'old': 65.4, 'new': 90.28}
2024-04-23 16:55:12,212 [trainer.py] => CNN top1 curve: [84.64, 77.34, 68.94]
2024-04-23 16:55:12,212 [trainer.py] => CNN top5 curve: [97.19, 94.93, 93.24]

Average Accuracy (CNN): 76.97
2024-04-23 16:55:12,213 [trainer.py] => Average Accuracy (CNN): 76.97 

2024-04-23 16:55:12,213 [trainer.py] => Train Time: 14158.28
2024-04-23 16:55:12,213 [trainer.py] => Test Time: 28.8 

2024-04-23 16:55:12,215 [trainer.py] => All params: 85960146
2024-04-23 16:55:12,216 [trainer.py] => Trainable params: 85960146
2024-04-23 16:55:12,220 [finetune.py] => Learning on 210-240

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.679, Train_accy 32.48, Test_accy 65.18:   0%|          | 0/20 [01:13<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.679, Train_accy 32.48, Test_accy 65.18:   5%|▌         | 1/20 [01:13<23:12, 73.29s/it]
Task 3, Epoch 2/20 => Loss 0.331, Train_accy 50.56:   5%|▌         | 1/20 [02:14<23:12, 73.29s/it]                 
Task 3, Epoch 2/20 => Loss 0.331, Train_accy 50.56:  10%|█         | 2/20 [02:14<19:48, 66.03s/it]
Task 3, Epoch 3/20 => Loss 0.283, Train_accy 58.20:  10%|█         | 2/20 [03:14<19:48, 66.03s/it]
Task 3, Epoch 3/20 => Loss 0.283, Train_accy 58.20:  15%|█▌        | 3/20 [03:14<18:00, 63.57s/it]
Task 3, Epoch 4/20 => Loss 0.259, Train_accy 61.92:  15%|█▌        | 3/20 [04:15<18:00, 63.57s/it]
Task 3, Epoch 4/20 => Loss 0.259, Train_accy 61.92:  20%|██        | 4/20 [04:15<16:39, 62.44s/it]
Task 3, Epoch 5/20 => Loss 0.230, Train_accy 66.50:  20%|██        | 4/20 [05:16<16:39, 62.44s/it]
Task 3, Epoch 5/20 => Loss 0.230, Train_accy 66.50:  25%|██▌       | 5/20 [05:16<15:27, 61.85s/it]
Task 3, Epoch 6/20 => Loss 0.212, Train_accy 70.41, Test_accy 65.58:  25%|██▌       | 5/20 [06:29<15:27, 61.85s/it]
Task 3, Epoch 6/20 => Loss 0.212, Train_accy 70.41, Test_accy 65.58:  30%|███       | 6/20 [06:29<15:20, 65.73s/it]
Task 3, Epoch 7/20 => Loss 0.193, Train_accy 72.61:  30%|███       | 6/20 [07:30<15:20, 65.73s/it]                 
Task 3, Epoch 7/20 => Loss 0.193, Train_accy 72.61:  35%|███▌      | 7/20 [07:30<13:53, 64.09s/it]
Task 3, Epoch 8/20 => Loss 0.192, Train_accy 74.60:  35%|███▌      | 7/20 [08:31<13:53, 64.09s/it]
Task 3, Epoch 8/20 => Loss 0.192, Train_accy 74.60:  40%|████      | 8/20 [08:31<12:38, 63.19s/it]
Task 3, Epoch 9/20 => Loss 0.180, Train_accy 75.65:  40%|████      | 8/20 [09:32<12:38, 63.19s/it]
Task 3, Epoch 9/20 => Loss 0.180, Train_accy 75.65:  45%|████▌     | 9/20 [09:32<11:27, 62.47s/it]
Task 3, Epoch 10/20 => Loss 0.165, Train_accy 77.57:  45%|████▌     | 9/20 [10:33<11:27, 62.47s/it]
Task 3, Epoch 10/20 => Loss 0.165, Train_accy 77.57:  50%|█████     | 10/20 [10:33<10:19, 61.94s/it]
Task 3, Epoch 11/20 => Loss 0.164, Train_accy 78.70, Test_accy 64.95:  50%|█████     | 10/20 [11:46<10:19, 61.94s/it]
Task 3, Epoch 11/20 => Loss 0.164, Train_accy 78.70, Test_accy 64.95:  55%|█████▌    | 11/20 [11:46<09:49, 65.47s/it]
Task 3, Epoch 12/20 => Loss 0.154, Train_accy 80.93:  55%|█████▌    | 11/20 [12:47<09:49, 65.47s/it]                 
Task 3, Epoch 12/20 => Loss 0.154, Train_accy 80.93:  60%|██████    | 12/20 [12:47<08:32, 64.05s/it]
Task 3, Epoch 13/20 => Loss 0.146, Train_accy 81.99:  60%|██████    | 12/20 [13:48<08:32, 64.05s/it]
Task 3, Epoch 13/20 => Loss 0.146, Train_accy 81.99:  65%|██████▌   | 13/20 [13:48<07:21, 63.05s/it]
Task 3, Epoch 14/20 => Loss 0.148, Train_accy 82.72:  65%|██████▌   | 13/20 [14:48<07:21, 63.05s/it]
Task 3, Epoch 14/20 => Loss 0.148, Train_accy 82.72:  70%|███████   | 14/20 [14:48<06:13, 62.31s/it]
Task 3, Epoch 15/20 => Loss 0.137, Train_accy 84.31:  70%|███████   | 14/20 [15:49<06:13, 62.31s/it]
Task 3, Epoch 15/20 => Loss 0.137, Train_accy 84.31:  75%|███████▌  | 15/20 [15:49<05:09, 61.85s/it]
Task 3, Epoch 16/20 => Loss 0.144, Train_accy 84.83, Test_accy 63.43:  75%|███████▌  | 15/20 [17:02<05:09, 61.85s/it]
Task 3, Epoch 16/20 => Loss 0.144, Train_accy 84.83, Test_accy 63.43:  80%|████████  | 16/20 [17:02<04:21, 65.26s/it]
Task 3, Epoch 17/20 => Loss 0.126, Train_accy 86.47:  80%|████████  | 16/20 [18:03<04:21, 65.26s/it]                 
Task 3, Epoch 17/20 => Loss 0.126, Train_accy 86.47:  85%|████████▌ | 17/20 [18:03<03:11, 63.91s/it]
Task 3, Epoch 18/20 => Loss 0.124, Train_accy 87.16:  85%|████████▌ | 17/20 [19:04<03:11, 63.91s/it]
Task 3, Epoch 18/20 => Loss 0.124, Train_accy 87.16:  90%|█████████ | 18/20 [19:04<02:05, 62.98s/it]
Task 3, Epoch 19/20 => Loss 0.121, Train_accy 87.41:  90%|█████████ | 18/20 [20:05<02:05, 62.98s/it]
Task 3, Epoch 19/20 => Loss 0.121, Train_accy 87.41:  95%|█████████▌| 19/20 [20:05<01:02, 62.36s/it]
Task 3, Epoch 20/20 => Loss 0.129, Train_accy 87.31:  95%|█████████▌| 19/20 [21:06<01:02, 62.36s/it]
Task 3, Epoch 20/20 => Loss 0.129, Train_accy 87.31: 100%|██████████| 20/20 [21:06<00:00, 61.96s/it]
Task 3, Epoch 20/20 => Loss 0.129, Train_accy 87.31: 100%|██████████| 20/20 [21:06<00:00, 63.32s/it]
2024-04-23 17:16:18,651 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.129, Train_accy 87.31
2024-04-23 17:16:31,235 [trainer.py] => No NME accuracy.
2024-04-23 17:16:31,236 [trainer.py] => CNN: {'total': 62.82, '00-149': 57.45, '150-179': 58.53, '180-209': 71.19, '210-239': 85.64, 'old': 59.56, 'new': 85.64}
2024-04-23 17:16:31,236 [trainer.py] => CNN top1 curve: [84.64, 77.34, 68.94, 62.82]
2024-04-23 17:16:31,236 [trainer.py] => CNN top5 curve: [97.19, 94.93, 93.24, 91.27]

Average Accuracy (CNN): 73.44
2024-04-23 17:16:31,236 [trainer.py] => Average Accuracy (CNN): 73.44 

2024-04-23 17:16:31,236 [trainer.py] => Train Time: 15424.69
2024-04-23 17:16:31,236 [trainer.py] => Test Time: 41.38 

2024-04-23 17:16:31,237 [trainer.py] => All params: 85983216
2024-04-23 17:16:31,237 [trainer.py] => Trainable params: 85983216
2024-04-23 17:16:31,239 [finetune.py] => Learning on 240-270

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.611, Train_accy 33.69, Test_accy 59.88:   0%|          | 0/20 [01:14<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.611, Train_accy 33.69, Test_accy 59.88:   5%|▌         | 1/20 [01:14<23:37, 74.62s/it]
Task 4, Epoch 2/20 => Loss 0.273, Train_accy 53.09:   5%|▌         | 1/20 [02:14<23:37, 74.62s/it]                 
Task 4, Epoch 2/20 => Loss 0.273, Train_accy 53.09:  10%|█         | 2/20 [02:14<19:49, 66.06s/it]
Task 4, Epoch 3/20 => Loss 0.218, Train_accy 59.96:  10%|█         | 2/20 [03:14<19:49, 66.06s/it]
Task 4, Epoch 3/20 => Loss 0.218, Train_accy 59.96:  15%|█▌        | 3/20 [03:14<17:55, 63.28s/it]
Task 4, Epoch 4/20 => Loss 0.196, Train_accy 64.48:  15%|█▌        | 3/20 [04:14<17:55, 63.28s/it]
Task 4, Epoch 4/20 => Loss 0.196, Train_accy 64.48:  20%|██        | 4/20 [04:14<16:29, 61.83s/it]
Task 4, Epoch 5/20 => Loss 0.169, Train_accy 69.77:  20%|██        | 4/20 [05:13<16:29, 61.83s/it]
Task 4, Epoch 5/20 => Loss 0.169, Train_accy 69.77:  25%|██▌       | 5/20 [05:13<15:15, 61.06s/it]
Task 4, Epoch 6/20 => Loss 0.160, Train_accy 71.99, Test_accy 62.45:  25%|██▌       | 5/20 [06:28<15:15, 61.06s/it]
Task 4, Epoch 6/20 => Loss 0.160, Train_accy 71.99, Test_accy 62.45:  30%|███       | 6/20 [06:28<15:17, 65.56s/it]
Task 4, Epoch 7/20 => Loss 0.160, Train_accy 74.76:  30%|███       | 6/20 [07:28<15:17, 65.56s/it]                 
Task 4, Epoch 7/20 => Loss 0.160, Train_accy 74.76:  35%|███▌      | 7/20 [07:28<13:49, 63.80s/it]
Task 4, Epoch 8/20 => Loss 0.154, Train_accy 76.76:  35%|███▌      | 7/20 [08:28<13:49, 63.80s/it]
Task 4, Epoch 8/20 => Loss 0.154, Train_accy 76.76:  40%|████      | 8/20 [08:28<12:30, 62.55s/it]
Task 4, Epoch 9/20 => Loss 0.137, Train_accy 79.36:  40%|████      | 8/20 [09:28<12:30, 62.55s/it]
Task 4, Epoch 9/20 => Loss 0.137, Train_accy 79.36:  45%|████▌     | 9/20 [09:28<11:20, 61.84s/it]
Task 4, Epoch 10/20 => Loss 0.141, Train_accy 80.68:  45%|████▌     | 9/20 [10:28<11:20, 61.84s/it]
Task 4, Epoch 10/20 => Loss 0.141, Train_accy 80.68:  50%|█████     | 10/20 [10:28<10:12, 61.28s/it]
Task 4, Epoch 11/20 => Loss 0.134, Train_accy 80.96, Test_accy 61.28:  50%|█████     | 10/20 [11:42<10:12, 61.28s/it]
Task 4, Epoch 11/20 => Loss 0.134, Train_accy 80.96, Test_accy 61.28:  55%|█████▌    | 11/20 [11:42<09:45, 65.07s/it]
Task 4, Epoch 12/20 => Loss 0.138, Train_accy 81.93:  55%|█████▌    | 11/20 [12:41<09:45, 65.07s/it]                 
Task 4, Epoch 12/20 => Loss 0.138, Train_accy 81.93:  60%|██████    | 12/20 [12:42<08:27, 63.44s/it]
Task 4, Epoch 13/20 => Loss 0.123, Train_accy 82.17:  60%|██████    | 12/20 [13:41<08:27, 63.44s/it]
Task 4, Epoch 13/20 => Loss 0.123, Train_accy 82.17:  65%|██████▌   | 13/20 [13:41<07:15, 62.26s/it]
Task 4, Epoch 14/20 => Loss 0.120, Train_accy 83.00:  65%|██████▌   | 13/20 [14:41<07:15, 62.26s/it]
Task 4, Epoch 14/20 => Loss 0.120, Train_accy 83.00:  70%|███████   | 14/20 [14:41<06:09, 61.52s/it]
Task 4, Epoch 15/20 => Loss 0.115, Train_accy 84.28:  70%|███████   | 14/20 [15:41<06:09, 61.52s/it]
Task 4, Epoch 15/20 => Loss 0.115, Train_accy 84.28:  75%|███████▌  | 15/20 [15:41<05:04, 60.98s/it]
Task 4, Epoch 16/20 => Loss 0.123, Train_accy 84.46, Test_accy 60.83:  75%|███████▌  | 15/20 [16:54<05:04, 60.98s/it]
Task 4, Epoch 16/20 => Loss 0.123, Train_accy 84.46, Test_accy 60.83:  80%|████████  | 16/20 [16:54<04:19, 64.81s/it]
Task 4, Epoch 17/20 => Loss 0.111, Train_accy 85.11:  80%|████████  | 16/20 [17:54<04:19, 64.81s/it]                 
Task 4, Epoch 17/20 => Loss 0.111, Train_accy 85.11:  85%|████████▌ | 17/20 [17:54<03:09, 63.28s/it]
Task 4, Epoch 18/20 => Loss 0.097, Train_accy 85.85:  85%|████████▌ | 17/20 [18:54<03:09, 63.28s/it]
Task 4, Epoch 18/20 => Loss 0.097, Train_accy 85.85:  90%|█████████ | 18/20 [18:54<02:04, 62.24s/it]
Task 4, Epoch 19/20 => Loss 0.103, Train_accy 86.91:  90%|█████████ | 18/20 [19:54<02:04, 62.24s/it]
Task 4, Epoch 19/20 => Loss 0.103, Train_accy 86.91:  95%|█████████▌| 19/20 [19:54<01:01, 61.49s/it]
Task 4, Epoch 20/20 => Loss 0.102, Train_accy 87.66:  95%|█████████▌| 19/20 [20:53<01:01, 61.49s/it]
Task 4, Epoch 20/20 => Loss 0.102, Train_accy 87.66: 100%|██████████| 20/20 [20:53<00:00, 60.96s/it]
Task 4, Epoch 20/20 => Loss 0.102, Train_accy 87.66: 100%|██████████| 20/20 [20:53<00:00, 62.69s/it]
2024-04-23 17:37:25,059 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.102, Train_accy 87.66
2024-04-23 17:37:39,107 [trainer.py] => No NME accuracy.
2024-04-23 17:37:39,107 [trainer.py] => CNN: {'total': 59.4, '00-149': 52.07, '150-179': 50.0, '180-209': 60.64, '210-239': 78.13, '240-269': 85.48, 'old': 56.14, 'new': 85.48}
2024-04-23 17:37:39,107 [trainer.py] => CNN top1 curve: [84.64, 77.34, 68.94, 62.82, 59.4]
2024-04-23 17:37:39,107 [trainer.py] => CNN top5 curve: [97.19, 94.93, 93.24, 91.27, 89.81]

Average Accuracy (CNN): 70.63
2024-04-23 17:37:39,107 [trainer.py] => Average Accuracy (CNN): 70.63 

2024-04-23 17:37:39,107 [trainer.py] => Train Time: 16678.5
2024-04-23 17:37:39,108 [trainer.py] => Test Time: 55.43000000000001 

2024-04-23 17:37:39,109 [trainer.py] => All params: 86006286
2024-04-23 17:37:39,110 [trainer.py] => Trainable params: 86006286
2024-04-23 17:37:39,114 [finetune.py] => Learning on 270-300

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.642, Train_accy 35.82, Test_accy 56.52:   0%|          | 0/20 [01:11<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.642, Train_accy 35.82, Test_accy 56.52:   5%|▌         | 1/20 [01:11<22:43, 71.79s/it]
Task 5, Epoch 2/20 => Loss 0.260, Train_accy 56.48:   5%|▌         | 1/20 [02:07<22:43, 71.79s/it]                 
Task 5, Epoch 2/20 => Loss 0.260, Train_accy 56.48:  10%|█         | 2/20 [02:07<18:46, 62.56s/it]
Task 5, Epoch 3/20 => Loss 0.232, Train_accy 63.76:  10%|█         | 2/20 [03:04<18:46, 62.56s/it]
Task 5, Epoch 3/20 => Loss 0.232, Train_accy 63.76:  15%|█▌        | 3/20 [03:04<16:54, 59.66s/it]
Task 5, Epoch 4/20 => Loss 0.202, Train_accy 67.63:  15%|█▌        | 3/20 [04:00<16:54, 59.66s/it]
Task 5, Epoch 4/20 => Loss 0.202, Train_accy 67.63:  20%|██        | 4/20 [04:00<15:33, 58.35s/it]
Task 5, Epoch 5/20 => Loss 0.183, Train_accy 71.01:  20%|██        | 4/20 [04:56<15:33, 58.35s/it]
Task 5, Epoch 5/20 => Loss 0.183, Train_accy 71.01:  25%|██▌       | 5/20 [04:56<14:24, 57.60s/it]
Task 5, Epoch 6/20 => Loss 0.166, Train_accy 74.28, Test_accy 56.46:  25%|██▌       | 5/20 [06:09<14:24, 57.60s/it]
Task 5, Epoch 6/20 => Loss 0.166, Train_accy 74.28, Test_accy 56.46:  30%|███       | 6/20 [06:09<14:36, 62.63s/it]
Task 5, Epoch 7/20 => Loss 0.156, Train_accy 75.90:  30%|███       | 6/20 [07:05<14:36, 62.63s/it]                 
Task 5, Epoch 7/20 => Loss 0.156, Train_accy 75.90:  35%|███▌      | 7/20 [07:05<13:08, 60.67s/it]
Task 5, Epoch 8/20 => Loss 0.139, Train_accy 77.06:  35%|███▌      | 7/20 [08:02<13:08, 60.67s/it]
Task 5, Epoch 8/20 => Loss 0.139, Train_accy 77.06:  40%|████      | 8/20 [08:02<11:53, 59.43s/it]
Task 5, Epoch 9/20 => Loss 0.153, Train_accy 77.75:  40%|████      | 8/20 [08:58<11:53, 59.43s/it]
Task 5, Epoch 9/20 => Loss 0.153, Train_accy 77.75:  45%|████▌     | 9/20 [08:58<10:43, 58.50s/it]
Task 5, Epoch 10/20 => Loss 0.126, Train_accy 79.23:  45%|████▌     | 9/20 [09:55<10:43, 58.50s/it]
Task 5, Epoch 10/20 => Loss 0.126, Train_accy 79.23:  50%|█████     | 10/20 [09:55<09:38, 57.89s/it]
Task 5, Epoch 11/20 => Loss 0.128, Train_accy 81.30, Test_accy 56.12:  50%|█████     | 10/20 [11:07<09:38, 57.89s/it]
Task 5, Epoch 11/20 => Loss 0.128, Train_accy 81.30, Test_accy 56.12:  55%|█████▌    | 11/20 [11:07<09:18, 62.08s/it]
Task 5, Epoch 12/20 => Loss 0.121, Train_accy 81.94:  55%|█████▌    | 11/20 [12:03<09:18, 62.08s/it]                 
Task 5, Epoch 12/20 => Loss 0.121, Train_accy 81.94:  60%|██████    | 12/20 [12:03<08:02, 60.36s/it]
Task 5, Epoch 13/20 => Loss 0.125, Train_accy 82.26:  60%|██████    | 12/20 [12:59<08:02, 60.36s/it]
Task 5, Epoch 13/20 => Loss 0.125, Train_accy 82.26:  65%|██████▌   | 13/20 [12:59<06:54, 59.15s/it]
Task 5, Epoch 14/20 => Loss 0.119, Train_accy 82.49:  65%|██████▌   | 13/20 [13:56<06:54, 59.15s/it]
Task 5, Epoch 14/20 => Loss 0.119, Train_accy 82.49:  70%|███████   | 14/20 [13:56<05:49, 58.30s/it]
Task 5, Epoch 15/20 => Loss 0.116, Train_accy 84.14:  70%|███████   | 14/20 [14:52<05:49, 58.30s/it]
Task 5, Epoch 15/20 => Loss 0.116, Train_accy 84.14:  75%|███████▌  | 15/20 [14:52<04:48, 57.70s/it]
Task 5, Epoch 16/20 => Loss 0.105, Train_accy 86.47, Test_accy 55.10:  75%|███████▌  | 15/20 [16:04<04:48, 57.70s/it]
Task 5, Epoch 16/20 => Loss 0.105, Train_accy 86.47, Test_accy 55.10:  80%|████████  | 16/20 [16:04<04:08, 62.10s/it]
Task 5, Epoch 17/20 => Loss 0.098, Train_accy 86.46:  80%|████████  | 16/20 [17:01<04:08, 62.10s/it]                 
Task 5, Epoch 17/20 => Loss 0.098, Train_accy 86.46:  85%|████████▌ | 17/20 [17:01<03:01, 60.35s/it]
Task 5, Epoch 18/20 => Loss 0.112, Train_accy 85.61:  85%|████████▌ | 17/20 [17:58<03:01, 60.35s/it]
Task 5, Epoch 18/20 => Loss 0.112, Train_accy 85.61:  90%|█████████ | 18/20 [17:58<01:58, 59.35s/it]
Task 5, Epoch 19/20 => Loss 0.103, Train_accy 87.65:  90%|█████████ | 18/20 [18:54<01:58, 59.35s/it]
Task 5, Epoch 19/20 => Loss 0.103, Train_accy 87.65:  95%|█████████▌| 19/20 [18:54<00:58, 58.50s/it]
Task 5, Epoch 20/20 => Loss 0.104, Train_accy 88.15:  95%|█████████▌| 19/20 [19:50<00:58, 58.50s/it]
Task 5, Epoch 20/20 => Loss 0.104, Train_accy 88.15: 100%|██████████| 20/20 [19:50<00:00, 57.84s/it]
Task 5, Epoch 20/20 => Loss 0.104, Train_accy 88.15: 100%|██████████| 20/20 [19:50<00:00, 59.55s/it]
2024-04-23 17:57:30,068 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.104, Train_accy 88.15
2024-04-23 17:57:45,847 [trainer.py] => No NME accuracy.
2024-04-23 17:57:45,847 [trainer.py] => CNN: {'total': 54.59, '00-149': 46.99, '150-179': 43.81, '180-209': 50.59, '210-239': 57.93, '240-269': 73.12, '270-299': 85.45, 'old': 51.16, 'new': 85.45}
2024-04-23 17:57:45,847 [trainer.py] => CNN top1 curve: [84.64, 77.34, 68.94, 62.82, 59.4, 54.59]
2024-04-23 17:57:45,847 [trainer.py] => CNN top5 curve: [97.19, 94.93, 93.24, 91.27, 89.81, 87.13]

Average Accuracy (CNN): 67.96
2024-04-23 17:57:45,847 [trainer.py] => Average Accuracy (CNN): 67.96 

2024-04-23 17:57:45,847 [trainer.py] => Train Time: 17869.44
2024-04-23 17:57:45,848 [trainer.py] => Test Time: 71.21000000000001 

Accuracy Matrix (CNN):
[[84.64 75.08 65.03 57.45 52.07 46.99]
 [ 0.   88.63 67.22 58.53 50.   43.81]
 [ 0.    0.   90.28 71.19 60.64 50.59]
 [ 0.    0.    0.   85.64 78.13 57.93]
 [ 0.    0.    0.    0.   85.48 73.12]
 [ 0.    0.    0.    0.    0.   85.45]]
2024-04-23 17:57:45,848 [trainer.py] => Forgetting (CNN): 32.446000000000005

nohup: 忽略输入
2024-04-26 16:21:54,404 [trainer.py] => config: ./exps/icarl_omn_B150_Inc5.json
2024-04-26 16:21:54,405 [trainer.py] => prefix: reproduce
2024-04-26 16:21:54,405 [trainer.py] => dataset: omnibenchmark
2024-04-26 16:21:54,405 [trainer.py] => memory_size: 6000
2024-04-26 16:21:54,405 [trainer.py] => memory_per_class: 20
2024-04-26 16:21:54,405 [trainer.py] => fixed_memory: True
2024-04-26 16:21:54,405 [trainer.py] => shuffle: True
2024-04-26 16:21:54,405 [trainer.py] => init_cls: 150
2024-04-26 16:21:54,405 [trainer.py] => increment: 30
2024-04-26 16:21:54,405 [trainer.py] => model_name: icarl
2024-04-26 16:21:54,405 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-26 16:21:54,405 [trainer.py] => device: [device(type='cuda', index=1)]
2024-04-26 16:21:54,405 [trainer.py] => seed: 1993
2024-04-26 16:21:54,405 [trainer.py] => init_epoch: 20
2024-04-26 16:21:54,405 [trainer.py] => init_lr: 0.001
2024-04-26 16:21:54,405 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-26 16:21:54,405 [trainer.py] => init_lr_decay: 0.1
2024-04-26 16:21:54,405 [trainer.py] => init_weight_decay: 0.0005
2024-04-26 16:21:54,405 [trainer.py] => epochs: 20
2024-04-26 16:21:54,405 [trainer.py] => lrate: 0.001
2024-04-26 16:21:54,405 [trainer.py] => milestones: [80, 120]
2024-04-26 16:21:54,405 [trainer.py] => lrate_decay: 0.1
2024-04-26 16:21:54,405 [trainer.py] => batch_size: 48
2024-04-26 16:21:54,405 [trainer.py] => weight_decay: 0.0002
2024-04-26 16:21:54,405 [trainer.py] => T: 2
2024-04-26 16:21:54,659 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-26 16:21:56,940 [trainer.py] => All params: 85798656
2024-04-26 16:21:56,941 [trainer.py] => Trainable params: 85798656
2024-04-26 16:21:56,942 [icarl.py] => Learning on 0-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.427, Train_accy 62.03, Test_accy 77.52:   0%|          | 0/20 [05:42<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.427, Train_accy 62.03, Test_accy 77.52:   5%|▌         | 1/20 [05:42<1:48:23, 342.31s/it]
Task 0, Epoch 2/20 => Loss 0.860, Train_accy 74.88:   5%|▌         | 1/20 [11:16<1:48:23, 342.31s/it]                 
Task 0, Epoch 2/20 => Loss 0.860, Train_accy 74.88:  10%|█         | 2/20 [11:16<1:41:12, 337.39s/it]
Task 0, Epoch 3/20 => Loss 0.740, Train_accy 78.11:  10%|█         | 2/20 [16:50<1:41:12, 337.39s/it]
Task 0, Epoch 3/20 => Loss 0.740, Train_accy 78.11:  15%|█▌        | 3/20 [16:50<1:35:10, 335.91s/it]
Task 0, Epoch 4/20 => Loss 0.659, Train_accy 80.47:  15%|█▌        | 3/20 [22:24<1:35:10, 335.91s/it]
Task 0, Epoch 4/20 => Loss 0.659, Train_accy 80.47:  20%|██        | 4/20 [22:24<1:29:25, 335.35s/it]
Task 0, Epoch 5/20 => Loss 0.612, Train_accy 81.87:  20%|██        | 4/20 [28:00<1:29:25, 335.35s/it]
Task 0, Epoch 5/20 => Loss 0.612, Train_accy 81.87:  25%|██▌       | 5/20 [28:00<1:23:50, 335.34s/it]
Task 0, Epoch 6/20 => Loss 0.563, Train_accy 83.35, Test_accy 85.07:  25%|██▌       | 5/20 [33:44<1:23:50, 335.34s/it]
Task 0, Epoch 6/20 => Loss 0.563, Train_accy 83.35, Test_accy 85.07:  30%|███       | 6/20 [33:44<1:18:57, 338.42s/it]
Task 0, Epoch 7/20 => Loss 0.532, Train_accy 84.05:  30%|███       | 6/20 [39:20<1:18:57, 338.42s/it]                 
Task 0, Epoch 7/20 => Loss 0.532, Train_accy 84.05:  35%|███▌      | 7/20 [39:20<1:13:08, 337.57s/it]
Task 0, Epoch 8/20 => Loss 0.512, Train_accy 84.69:  35%|███▌      | 7/20 [44:55<1:13:08, 337.57s/it]
Task 0, Epoch 8/20 => Loss 0.512, Train_accy 84.69:  40%|████      | 8/20 [44:55<1:07:19, 336.65s/it]
Task 0, Epoch 9/20 => Loss 0.485, Train_accy 85.57:  40%|████      | 8/20 [50:30<1:07:19, 336.65s/it]
Task 0, Epoch 9/20 => Loss 0.485, Train_accy 85.57:  45%|████▌     | 9/20 [50:30<1:01:37, 336.10s/it]
Task 0, Epoch 10/20 => Loss 0.461, Train_accy 86.34:  45%|████▌     | 9/20 [56:04<1:01:37, 336.10s/it]
Task 0, Epoch 10/20 => Loss 0.461, Train_accy 86.34:  50%|█████     | 10/20 [56:04<55:55, 335.55s/it] 
Task 0, Epoch 11/20 => Loss 0.452, Train_accy 86.41, Test_accy 85.70:  50%|█████     | 10/20 [1:01:47<55:55, 335.55s/it]
Task 0, Epoch 11/20 => Loss 0.452, Train_accy 86.41, Test_accy 85.70:  55%|█████▌    | 11/20 [1:01:47<50:42, 338.02s/it]
Task 0, Epoch 12/20 => Loss 0.433, Train_accy 87.07:  55%|█████▌    | 11/20 [1:07:22<50:42, 338.02s/it]                 
Task 0, Epoch 12/20 => Loss 0.433, Train_accy 87.07:  60%|██████    | 12/20 [1:07:22<44:55, 336.97s/it]
Task 0, Epoch 13/20 => Loss 0.421, Train_accy 87.46:  60%|██████    | 12/20 [1:12:57<44:55, 336.97s/it]
Task 0, Epoch 13/20 => Loss 0.421, Train_accy 87.46:  65%|██████▌   | 13/20 [1:12:57<39:14, 336.32s/it]
Task 0, Epoch 14/20 => Loss 0.405, Train_accy 88.03:  65%|██████▌   | 13/20 [1:18:31<39:14, 336.32s/it]
Task 0, Epoch 14/20 => Loss 0.405, Train_accy 88.03:  70%|███████   | 14/20 [1:18:31<33:34, 335.80s/it]
Task 0, Epoch 15/20 => Loss 0.400, Train_accy 88.19:  70%|███████   | 14/20 [1:24:07<33:34, 335.80s/it]
Task 0, Epoch 15/20 => Loss 0.400, Train_accy 88.19:  75%|███████▌  | 15/20 [1:24:07<27:58, 335.76s/it]
Task 0, Epoch 16/20 => Loss 0.383, Train_accy 88.56, Test_accy 85.97:  75%|███████▌  | 15/20 [1:29:51<27:58, 335.76s/it]
Task 0, Epoch 16/20 => Loss 0.383, Train_accy 88.56, Test_accy 85.97:  80%|████████  | 16/20 [1:29:51<22:32, 338.22s/it]
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 88.77:  80%|████████  | 16/20 [1:35:26<22:32, 338.22s/it]                 
Task 0, Epoch 17/20 => Loss 0.377, Train_accy 88.77:  85%|████████▌ | 17/20 [1:35:26<16:51, 337.14s/it]
Task 0, Epoch 18/20 => Loss 0.360, Train_accy 89.45:  85%|████████▌ | 17/20 [1:41:00<16:51, 337.14s/it]
Task 0, Epoch 18/20 => Loss 0.360, Train_accy 89.45:  90%|█████████ | 18/20 [1:41:00<11:12, 336.33s/it]
Task 0, Epoch 19/20 => Loss 0.355, Train_accy 89.48:  90%|█████████ | 18/20 [1:46:35<11:12, 336.33s/it]
Task 0, Epoch 19/20 => Loss 0.355, Train_accy 89.48:  95%|█████████▌| 19/20 [1:46:35<05:35, 335.86s/it]
Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.61:  95%|█████████▌| 19/20 [1:52:10<05:35, 335.86s/it]
Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.61: 100%|██████████| 20/20 [1:52:10<00:00, 335.50s/it]
Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.61: 100%|██████████| 20/20 [1:52:10<00:00, 336.50s/it]
2024-04-26 18:14:07,578 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.352, Train_accy 89.61
2024-04-26 18:14:07,580 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 18:19:20,293 [icarl.py] => Exemplar size: 3000
2024-04-26 18:19:20,293 [trainer.py] => CNN: {'total': 84.7, '00-149': 84.7, 'old': 0, 'new': 84.7}
2024-04-26 18:19:20,293 [trainer.py] => NME: {'total': 85.47, '00-149': 85.47, 'old': 0, 'new': 85.47}
2024-04-26 18:19:20,293 [trainer.py] => CNN top1 curve: [84.7]
2024-04-26 18:19:20,294 [trainer.py] => CNN top5 curve: [96.83]
2024-04-26 18:19:20,294 [trainer.py] => NME top1 curve: [85.47]
2024-04-26 18:19:20,294 [trainer.py] => NME top5 curve: [97.06]

Average Accuracy (CNN): 84.7
Average Accuracy (NME): 85.47
2024-04-26 18:19:20,294 [trainer.py] => Average Accuracy (CNN): 84.7
2024-04-26 18:19:20,294 [trainer.py] => Average Accuracy (NME): 85.47
2024-04-26 18:19:20,294 [trainer.py] => Train Time: 0
2024-04-26 18:19:20,294 [trainer.py] => Test Time: 18.12 

2024-04-26 18:19:20,294 [trainer.py] => All params: 85914006
2024-04-26 18:19:20,295 [trainer.py] => Trainable params: 85914006
2024-04-26 18:19:20,296 [icarl.py] => Learning on 150-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.390, Train_accy 75.06, Test_accy 76.39:   0%|          | 0/20 [02:10<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.390, Train_accy 75.06, Test_accy 76.39:   5%|▌         | 1/20 [02:10<41:16, 130.33s/it]
Task 1, Epoch 2/20 => Loss 2.758, Train_accy 86.38:   5%|▌         | 1/20 [04:09<41:16, 130.33s/it]                 
Task 1, Epoch 2/20 => Loss 2.758, Train_accy 86.38:  10%|█         | 2/20 [04:09<37:08, 123.82s/it]
Task 1, Epoch 3/20 => Loss 2.646, Train_accy 89.14:  10%|█         | 2/20 [06:08<37:08, 123.82s/it]
Task 1, Epoch 3/20 => Loss 2.646, Train_accy 89.14:  15%|█▌        | 3/20 [06:08<34:30, 121.77s/it]
Task 1, Epoch 4/20 => Loss 2.604, Train_accy 90.08:  15%|█▌        | 3/20 [08:08<34:30, 121.77s/it]
Task 1, Epoch 4/20 => Loss 2.604, Train_accy 90.08:  20%|██        | 4/20 [08:08<32:12, 120.77s/it]
Task 1, Epoch 5/20 => Loss 2.568, Train_accy 91.16:  20%|██        | 4/20 [10:07<32:12, 120.77s/it]
Task 1, Epoch 5/20 => Loss 2.568, Train_accy 91.16:  25%|██▌       | 5/20 [10:07<30:03, 120.22s/it]
Task 1, Epoch 6/20 => Loss 2.512, Train_accy 92.44, Test_accy 78.20:  25%|██▌       | 5/20 [12:17<30:03, 120.22s/it]
Task 1, Epoch 6/20 => Loss 2.512, Train_accy 92.44, Test_accy 78.20:  30%|███       | 6/20 [12:17<28:50, 123.58s/it]
Task 1, Epoch 7/20 => Loss 2.538, Train_accy 92.39:  30%|███       | 6/20 [14:16<28:50, 123.58s/it]                 
Task 1, Epoch 7/20 => Loss 2.538, Train_accy 92.39:  35%|███▌      | 7/20 [14:16<26:28, 122.22s/it]
Task 1, Epoch 8/20 => Loss 2.506, Train_accy 92.95:  35%|███▌      | 7/20 [16:16<26:28, 122.22s/it]
Task 1, Epoch 8/20 => Loss 2.506, Train_accy 92.95:  40%|████      | 8/20 [16:16<24:15, 121.31s/it]
Task 1, Epoch 9/20 => Loss 2.454, Train_accy 93.82:  40%|████      | 8/20 [18:15<24:15, 121.31s/it]
Task 1, Epoch 9/20 => Loss 2.454, Train_accy 93.82:  45%|████▌     | 9/20 [18:15<22:08, 120.75s/it]
Task 1, Epoch 10/20 => Loss 2.475, Train_accy 93.27:  45%|████▌     | 9/20 [20:15<22:08, 120.75s/it]
Task 1, Epoch 10/20 => Loss 2.475, Train_accy 93.27:  50%|█████     | 10/20 [20:15<20:02, 120.29s/it]
Task 1, Epoch 11/20 => Loss 2.495, Train_accy 93.78, Test_accy 78.87:  50%|█████     | 10/20 [22:25<20:02, 120.29s/it]
Task 1, Epoch 11/20 => Loss 2.495, Train_accy 93.78, Test_accy 78.87:  55%|█████▌    | 11/20 [22:25<18:30, 123.35s/it]
Task 1, Epoch 12/20 => Loss 2.482, Train_accy 94.18:  55%|█████▌    | 11/20 [24:24<18:30, 123.35s/it]                 
Task 1, Epoch 12/20 => Loss 2.482, Train_accy 94.18:  60%|██████    | 12/20 [24:24<16:16, 122.11s/it]
Task 1, Epoch 13/20 => Loss 2.462, Train_accy 94.19:  60%|██████    | 12/20 [26:23<16:16, 122.11s/it]
Task 1, Epoch 13/20 => Loss 2.462, Train_accy 94.19:  65%|██████▌   | 13/20 [26:23<14:08, 121.23s/it]
Task 1, Epoch 14/20 => Loss 2.449, Train_accy 94.28:  65%|██████▌   | 13/20 [28:23<14:08, 121.23s/it]
Task 1, Epoch 14/20 => Loss 2.449, Train_accy 94.28:  70%|███████   | 14/20 [28:23<12:03, 120.66s/it]
Task 1, Epoch 15/20 => Loss 2.438, Train_accy 94.84:  70%|███████   | 14/20 [30:22<12:03, 120.66s/it]
Task 1, Epoch 15/20 => Loss 2.438, Train_accy 94.84:  75%|███████▌  | 15/20 [30:22<10:01, 120.23s/it]
Task 1, Epoch 16/20 => Loss 2.451, Train_accy 94.64, Test_accy 79.54:  75%|███████▌  | 15/20 [32:32<10:01, 120.23s/it]
Task 1, Epoch 16/20 => Loss 2.451, Train_accy 94.64, Test_accy 79.54:  80%|████████  | 16/20 [32:32<08:13, 123.32s/it]
Task 1, Epoch 17/20 => Loss 2.425, Train_accy 94.79:  80%|████████  | 16/20 [34:32<08:13, 123.32s/it]                 
Task 1, Epoch 17/20 => Loss 2.425, Train_accy 94.79:  85%|████████▌ | 17/20 [34:32<06:06, 122.19s/it]
Task 1, Epoch 18/20 => Loss 2.434, Train_accy 95.05:  85%|████████▌ | 17/20 [36:31<06:06, 122.19s/it]
Task 1, Epoch 18/20 => Loss 2.434, Train_accy 95.05:  90%|█████████ | 18/20 [36:31<04:02, 121.38s/it]
Task 1, Epoch 19/20 => Loss 2.438, Train_accy 94.88:  90%|█████████ | 18/20 [38:31<04:02, 121.38s/it]
Task 1, Epoch 19/20 => Loss 2.438, Train_accy 94.88:  95%|█████████▌| 19/20 [38:31<02:00, 120.76s/it]
Task 1, Epoch 20/20 => Loss 2.440, Train_accy 95.25:  95%|█████████▌| 19/20 [40:30<02:00, 120.76s/it]
Task 1, Epoch 20/20 => Loss 2.440, Train_accy 95.25: 100%|██████████| 20/20 [40:30<00:00, 120.32s/it]
Task 1, Epoch 20/20 => Loss 2.440, Train_accy 95.25: 100%|██████████| 20/20 [40:30<00:00, 121.53s/it]
2024-04-26 18:59:50,897 [icarl.py] => Task 1, Epoch 20/20 => Loss 2.440, Train_accy 95.25
2024-04-26 18:59:50,899 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 19:02:06,410 [icarl.py] => Exemplar size: 3600
2024-04-26 19:02:06,410 [trainer.py] => CNN: {'total': 79.59, '00-149': 77.15, '150-179': 91.81, 'old': 77.15, 'new': 91.81}
2024-04-26 19:02:06,410 [trainer.py] => NME: {'total': 82.41, '00-149': 82.4, '150-179': 82.44, 'old': 82.4, 'new': 82.44}
2024-04-26 19:02:06,410 [trainer.py] => CNN top1 curve: [84.7, 79.59]
2024-04-26 19:02:06,410 [trainer.py] => CNN top5 curve: [96.83, 95.66]
2024-04-26 19:02:06,410 [trainer.py] => NME top1 curve: [85.47, 82.41]
2024-04-26 19:02:06,411 [trainer.py] => NME top5 curve: [97.06, 96.19]

Average Accuracy (CNN): 82.15
Average Accuracy (NME): 83.94
2024-04-26 19:02:06,411 [trainer.py] => Average Accuracy (CNN): 82.15
2024-04-26 19:02:06,411 [trainer.py] => Average Accuracy (NME): 83.94
2024-04-26 19:02:06,411 [trainer.py] => Train Time: 0
2024-04-26 19:02:06,411 [trainer.py] => Test Time: 39.99 

2024-04-26 19:02:06,411 [trainer.py] => All params: 85937076
2024-04-26 19:02:06,412 [trainer.py] => Trainable params: 85937076
2024-04-26 19:02:06,413 [icarl.py] => Learning on 180-210

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.322, Train_accy 77.19, Test_accy 75.79:   0%|          | 0/20 [02:17<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.322, Train_accy 77.19, Test_accy 75.79:   5%|▌         | 1/20 [02:17<43:29, 137.32s/it]
Task 2, Epoch 2/20 => Loss 2.735, Train_accy 87.10:   5%|▌         | 1/20 [04:22<43:29, 137.32s/it]                 
Task 2, Epoch 2/20 => Loss 2.735, Train_accy 87.10:  10%|█         | 2/20 [04:22<39:03, 130.20s/it]
Task 2, Epoch 3/20 => Loss 2.619, Train_accy 89.27:  10%|█         | 2/20 [06:27<39:03, 130.20s/it]
Task 2, Epoch 3/20 => Loss 2.619, Train_accy 89.27:  15%|█▌        | 3/20 [06:27<36:13, 127.86s/it]
Task 2, Epoch 4/20 => Loss 2.592, Train_accy 90.69:  15%|█▌        | 3/20 [08:32<36:13, 127.86s/it]
Task 2, Epoch 4/20 => Loss 2.592, Train_accy 90.69:  20%|██        | 4/20 [08:32<33:48, 126.77s/it]
Task 2, Epoch 5/20 => Loss 2.557, Train_accy 91.87:  20%|██        | 4/20 [10:37<33:48, 126.77s/it]
Task 2, Epoch 5/20 => Loss 2.557, Train_accy 91.87:  25%|██▌       | 5/20 [10:37<31:32, 126.17s/it]
Task 2, Epoch 6/20 => Loss 2.526, Train_accy 92.38, Test_accy 75.65:  25%|██▌       | 5/20 [12:55<31:32, 126.17s/it]
Task 2, Epoch 6/20 => Loss 2.526, Train_accy 92.38, Test_accy 75.65:  30%|███       | 6/20 [12:55<30:20, 130.02s/it]
Task 2, Epoch 7/20 => Loss 2.492, Train_accy 93.31:  30%|███       | 6/20 [15:00<30:20, 130.02s/it]                 
Task 2, Epoch 7/20 => Loss 2.492, Train_accy 93.31:  35%|███▌      | 7/20 [15:00<27:48, 128.36s/it]
Task 2, Epoch 8/20 => Loss 2.505, Train_accy 92.95:  35%|███▌      | 7/20 [17:05<27:48, 128.36s/it]
Task 2, Epoch 8/20 => Loss 2.505, Train_accy 92.95:  40%|████      | 8/20 [17:05<25:28, 127.34s/it]
Task 2, Epoch 9/20 => Loss 2.480, Train_accy 93.74:  40%|████      | 8/20 [19:10<25:28, 127.34s/it]
Task 2, Epoch 9/20 => Loss 2.480, Train_accy 93.74:  45%|████▌     | 9/20 [19:10<23:13, 126.67s/it]
Task 2, Epoch 10/20 => Loss 2.456, Train_accy 93.92:  45%|████▌     | 9/20 [21:15<23:13, 126.67s/it]
Task 2, Epoch 10/20 => Loss 2.456, Train_accy 93.92:  50%|█████     | 10/20 [21:15<21:01, 126.16s/it]
Task 2, Epoch 11/20 => Loss 2.481, Train_accy 93.82, Test_accy 75.13:  50%|█████     | 10/20 [23:32<21:01, 126.16s/it]
Task 2, Epoch 11/20 => Loss 2.481, Train_accy 93.82, Test_accy 75.13:  55%|█████▌    | 11/20 [23:32<19:25, 129.54s/it]
Task 2, Epoch 12/20 => Loss 2.460, Train_accy 94.45:  55%|█████▌    | 11/20 [25:37<19:25, 129.54s/it]                 
Task 2, Epoch 12/20 => Loss 2.460, Train_accy 94.45:  60%|██████    | 12/20 [25:37<17:05, 128.15s/it]
Task 2, Epoch 13/20 => Loss 2.432, Train_accy 94.93:  60%|██████    | 12/20 [27:42<17:05, 128.15s/it]
Task 2, Epoch 13/20 => Loss 2.432, Train_accy 94.93:  65%|██████▌   | 13/20 [27:42<14:50, 127.17s/it]
Task 2, Epoch 14/20 => Loss 2.446, Train_accy 94.78:  65%|██████▌   | 13/20 [29:47<14:50, 127.17s/it]
Task 2, Epoch 14/20 => Loss 2.446, Train_accy 94.78:  70%|███████   | 14/20 [29:47<12:39, 126.51s/it]
Task 2, Epoch 15/20 => Loss 2.466, Train_accy 94.44:  70%|███████   | 14/20 [31:52<12:39, 126.51s/it]
Task 2, Epoch 15/20 => Loss 2.466, Train_accy 94.44:  75%|███████▌  | 15/20 [31:52<10:30, 126.09s/it]
Task 2, Epoch 16/20 => Loss 2.447, Train_accy 94.82, Test_accy 75.60:  75%|███████▌  | 15/20 [34:10<10:30, 126.09s/it]
Task 2, Epoch 16/20 => Loss 2.447, Train_accy 94.82, Test_accy 75.60:  80%|████████  | 16/20 [34:10<08:38, 129.64s/it]
Task 2, Epoch 17/20 => Loss 2.436, Train_accy 95.12:  80%|████████  | 16/20 [36:15<08:38, 129.64s/it]                 
Task 2, Epoch 17/20 => Loss 2.436, Train_accy 95.12:  85%|████████▌ | 17/20 [36:15<06:24, 128.23s/it]
Task 2, Epoch 18/20 => Loss 2.412, Train_accy 95.30:  85%|████████▌ | 17/20 [38:20<06:24, 128.23s/it]
Task 2, Epoch 18/20 => Loss 2.412, Train_accy 95.30:  90%|█████████ | 18/20 [38:20<04:14, 127.30s/it]
Task 2, Epoch 19/20 => Loss 2.429, Train_accy 95.42:  90%|█████████ | 18/20 [40:26<04:14, 127.30s/it]
Task 2, Epoch 19/20 => Loss 2.429, Train_accy 95.42:  95%|█████████▌| 19/20 [40:26<02:06, 126.70s/it]
Task 2, Epoch 20/20 => Loss 2.421, Train_accy 95.65:  95%|█████████▌| 19/20 [42:31<02:06, 126.70s/it]
Task 2, Epoch 20/20 => Loss 2.421, Train_accy 95.65: 100%|██████████| 20/20 [42:31<00:00, 126.27s/it]
Task 2, Epoch 20/20 => Loss 2.421, Train_accy 95.65: 100%|██████████| 20/20 [42:31<00:00, 127.57s/it]
2024-04-26 19:44:37,779 [icarl.py] => Task 2, Epoch 20/20 => Loss 2.421, Train_accy 95.65
2024-04-26 19:44:37,781 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 19:47:12,503 [icarl.py] => Exemplar size: 4200
2024-04-26 19:47:12,503 [trainer.py] => CNN: {'total': 75.82, '00-149': 71.54, '150-179': 79.43, '180-209': 93.63, 'old': 72.86, 'new': 93.63}
2024-04-26 19:47:12,503 [trainer.py] => NME: {'total': 80.23, '00-149': 79.49, '150-179': 78.76, '180-209': 85.43, 'old': 79.37, 'new': 85.43}
2024-04-26 19:47:12,503 [trainer.py] => CNN top1 curve: [84.7, 79.59, 75.82]
2024-04-26 19:47:12,503 [trainer.py] => CNN top5 curve: [96.83, 95.66, 93.44]
2024-04-26 19:47:12,503 [trainer.py] => NME top1 curve: [85.47, 82.41, 80.23]
2024-04-26 19:47:12,503 [trainer.py] => NME top5 curve: [97.06, 96.19, 95.39]

Average Accuracy (CNN): 80.04
Average Accuracy (NME): 82.7
2024-04-26 19:47:12,503 [trainer.py] => Average Accuracy (CNN): 80.04
2024-04-26 19:47:12,503 [trainer.py] => Average Accuracy (NME): 82.7
2024-04-26 19:47:12,503 [trainer.py] => Train Time: 0
2024-04-26 19:47:12,504 [trainer.py] => Test Time: 65.61 

2024-04-26 19:47:12,504 [trainer.py] => All params: 85960146
2024-04-26 19:47:12,505 [trainer.py] => Trainable params: 85960146
2024-04-26 19:47:12,507 [icarl.py] => Learning on 210-240

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.206, Train_accy 76.64, Test_accy 69.05:   0%|          | 0/20 [02:30<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.206, Train_accy 76.64, Test_accy 69.05:   5%|▌         | 1/20 [02:30<47:46, 150.86s/it]
Task 3, Epoch 2/20 => Loss 2.547, Train_accy 86.89:   5%|▌         | 1/20 [04:47<47:46, 150.86s/it]                 
Task 3, Epoch 2/20 => Loss 2.547, Train_accy 86.89:  10%|█         | 2/20 [04:47<42:42, 142.37s/it]
Task 3, Epoch 3/20 => Loss 2.447, Train_accy 89.12:  10%|█         | 2/20 [07:03<42:42, 142.37s/it]
Task 3, Epoch 3/20 => Loss 2.447, Train_accy 89.12:  15%|█▌        | 3/20 [07:03<39:32, 139.53s/it]
Task 3, Epoch 4/20 => Loss 2.412, Train_accy 90.46:  15%|█▌        | 3/20 [09:19<39:32, 139.53s/it]
Task 3, Epoch 4/20 => Loss 2.412, Train_accy 90.46:  20%|██        | 4/20 [09:19<36:47, 138.00s/it]
Task 3, Epoch 5/20 => Loss 2.394, Train_accy 91.20:  20%|██        | 4/20 [11:34<36:47, 138.00s/it]
Task 3, Epoch 5/20 => Loss 2.394, Train_accy 91.20:  25%|██▌       | 5/20 [11:34<34:17, 137.15s/it]
Task 3, Epoch 6/20 => Loss 2.336, Train_accy 92.17, Test_accy 70.41:  25%|██▌       | 5/20 [14:04<34:17, 137.15s/it]
Task 3, Epoch 6/20 => Loss 2.336, Train_accy 92.17, Test_accy 70.41:  30%|███       | 6/20 [14:04<32:58, 141.36s/it]
Task 3, Epoch 7/20 => Loss 2.320, Train_accy 92.60:  30%|███       | 6/20 [16:19<32:58, 141.36s/it]                 
Task 3, Epoch 7/20 => Loss 2.320, Train_accy 92.60:  35%|███▌      | 7/20 [16:19<30:13, 139.46s/it]
Task 3, Epoch 8/20 => Loss 2.322, Train_accy 92.92:  35%|███▌      | 7/20 [18:35<30:13, 139.46s/it]
Task 3, Epoch 8/20 => Loss 2.322, Train_accy 92.92:  40%|████      | 8/20 [18:35<27:38, 138.23s/it]
Task 3, Epoch 9/20 => Loss 2.299, Train_accy 93.50:  40%|████      | 8/20 [20:50<27:38, 138.23s/it]
Task 3, Epoch 9/20 => Loss 2.299, Train_accy 93.50:  45%|████▌     | 9/20 [20:50<25:11, 137.40s/it]
Task 3, Epoch 10/20 => Loss 2.292, Train_accy 93.73:  45%|████▌     | 9/20 [23:06<25:11, 137.40s/it]
Task 3, Epoch 10/20 => Loss 2.292, Train_accy 93.73:  50%|█████     | 10/20 [23:06<22:48, 136.83s/it]
Task 3, Epoch 11/20 => Loss 2.271, Train_accy 94.15, Test_accy 71.55:  50%|█████     | 10/20 [25:36<22:48, 136.83s/it]
Task 3, Epoch 11/20 => Loss 2.271, Train_accy 94.15, Test_accy 71.55:  55%|█████▌    | 11/20 [25:36<21:06, 140.72s/it]
Task 3, Epoch 12/20 => Loss 2.285, Train_accy 94.26:  55%|█████▌    | 11/20 [27:51<21:06, 140.72s/it]                 
Task 3, Epoch 12/20 => Loss 2.285, Train_accy 94.26:  60%|██████    | 12/20 [27:51<18:33, 139.15s/it]
Task 3, Epoch 13/20 => Loss 2.252, Train_accy 94.82:  60%|██████    | 12/20 [30:07<18:33, 139.15s/it]
Task 3, Epoch 13/20 => Loss 2.252, Train_accy 94.82:  65%|██████▌   | 13/20 [30:07<16:06, 138.05s/it]
Task 3, Epoch 14/20 => Loss 2.264, Train_accy 94.53:  65%|██████▌   | 13/20 [32:22<16:06, 138.05s/it]
Task 3, Epoch 14/20 => Loss 2.264, Train_accy 94.53:  70%|███████   | 14/20 [32:22<13:43, 137.30s/it]
Task 3, Epoch 15/20 => Loss 2.263, Train_accy 94.66:  70%|███████   | 14/20 [34:38<13:43, 137.30s/it]
Task 3, Epoch 15/20 => Loss 2.263, Train_accy 94.66:  75%|███████▌  | 15/20 [34:38<11:23, 136.79s/it]
Task 3, Epoch 16/20 => Loss 2.236, Train_accy 95.12, Test_accy 71.68:  75%|███████▌  | 15/20 [37:07<11:23, 136.79s/it]
Task 3, Epoch 16/20 => Loss 2.236, Train_accy 95.12, Test_accy 71.68:  80%|████████  | 16/20 [37:07<09:22, 140.60s/it]
Task 3, Epoch 17/20 => Loss 2.260, Train_accy 94.97:  80%|████████  | 16/20 [39:23<09:22, 140.60s/it]                 
Task 3, Epoch 17/20 => Loss 2.260, Train_accy 94.97:  85%|████████▌ | 17/20 [39:23<06:57, 139.08s/it]
Task 3, Epoch 18/20 => Loss 2.245, Train_accy 95.23:  85%|████████▌ | 17/20 [41:38<06:57, 139.08s/it]
Task 3, Epoch 18/20 => Loss 2.245, Train_accy 95.23:  90%|█████████ | 18/20 [41:38<04:36, 138.04s/it]
Task 3, Epoch 19/20 => Loss 2.242, Train_accy 95.17:  90%|█████████ | 18/20 [43:54<04:36, 138.04s/it]
Task 3, Epoch 19/20 => Loss 2.242, Train_accy 95.17:  95%|█████████▌| 19/20 [43:54<02:17, 137.32s/it]
Task 3, Epoch 20/20 => Loss 2.226, Train_accy 95.62:  95%|█████████▌| 19/20 [46:10<02:17, 137.32s/it]
Task 3, Epoch 20/20 => Loss 2.226, Train_accy 95.62: 100%|██████████| 20/20 [46:10<00:00, 136.81s/it]
Task 3, Epoch 20/20 => Loss 2.226, Train_accy 95.62: 100%|██████████| 20/20 [46:10<00:00, 138.51s/it]
2024-04-26 20:33:22,725 [icarl.py] => Task 3, Epoch 20/20 => Loss 2.226, Train_accy 95.62
2024-04-26 20:33:22,727 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 20:36:09,853 [icarl.py] => Exemplar size: 4800
2024-04-26 20:36:09,853 [trainer.py] => CNN: {'total': 70.95, '00-149': 65.3, '150-179': 67.06, '180-209': 81.57, '210-239': 92.49, 'old': 67.87, 'new': 92.49}
2024-04-26 20:36:09,853 [trainer.py] => NME: {'total': 78.59, '00-149': 77.15, '150-179': 76.59, '180-209': 80.57, '210-239': 85.81, 'old': 77.56, 'new': 85.81}
2024-04-26 20:36:09,853 [trainer.py] => CNN top1 curve: [84.7, 79.59, 75.82, 70.95]
2024-04-26 20:36:09,853 [trainer.py] => CNN top5 curve: [96.83, 95.66, 93.44, 91.4]
2024-04-26 20:36:09,853 [trainer.py] => NME top1 curve: [85.47, 82.41, 80.23, 78.59]
2024-04-26 20:36:09,853 [trainer.py] => NME top5 curve: [97.06, 96.19, 95.39, 95.01]

Average Accuracy (CNN): 77.76
Average Accuracy (NME): 81.68
2024-04-26 20:36:09,853 [trainer.py] => Average Accuracy (CNN): 77.76
2024-04-26 20:36:09,854 [trainer.py] => Average Accuracy (NME): 81.68
2024-04-26 20:36:09,854 [trainer.py] => Train Time: 0
2024-04-26 20:36:09,854 [trainer.py] => Test Time: 94.13 

2024-04-26 20:36:09,854 [trainer.py] => All params: 85983216
2024-04-26 20:36:09,855 [trainer.py] => Trainable params: 85983216
2024-04-26 20:36:09,857 [icarl.py] => Learning on 240-270

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.168, Train_accy 80.75, Test_accy 69.37:   0%|          | 0/20 [02:36<?, ?it/s]
Task 4, Epoch 1/20 => Loss 3.168, Train_accy 80.75, Test_accy 69.37:   5%|▌         | 1/20 [02:36<49:33, 156.49s/it]
Task 4, Epoch 2/20 => Loss 2.550, Train_accy 89.13:   5%|▌         | 1/20 [04:56<49:33, 156.49s/it]                 
Task 4, Epoch 2/20 => Loss 2.550, Train_accy 89.13:  10%|█         | 2/20 [04:56<44:03, 146.85s/it]
Task 4, Epoch 3/20 => Loss 2.460, Train_accy 91.80:  10%|█         | 2/20 [07:16<44:03, 146.85s/it]
Task 4, Epoch 3/20 => Loss 2.460, Train_accy 91.80:  15%|█▌        | 3/20 [07:16<40:43, 143.75s/it]
Task 4, Epoch 4/20 => Loss 2.435, Train_accy 92.45:  15%|█▌        | 3/20 [09:36<40:43, 143.75s/it]
Task 4, Epoch 4/20 => Loss 2.435, Train_accy 92.45:  20%|██        | 4/20 [09:36<37:56, 142.27s/it]
Task 4, Epoch 5/20 => Loss 2.421, Train_accy 92.90:  20%|██        | 4/20 [11:56<37:56, 142.27s/it]
Task 4, Epoch 5/20 => Loss 2.421, Train_accy 92.90:  25%|██▌       | 5/20 [11:56<35:22, 141.52s/it]
Task 4, Epoch 6/20 => Loss 2.387, Train_accy 93.72, Test_accy 68.00:  25%|██▌       | 5/20 [14:32<35:22, 141.52s/it]
Task 4, Epoch 6/20 => Loss 2.387, Train_accy 93.72, Test_accy 68.00:  30%|███       | 6/20 [14:32<34:09, 146.39s/it]
Task 4, Epoch 7/20 => Loss 2.369, Train_accy 94.14:  30%|███       | 6/20 [16:52<34:09, 146.39s/it]                 
Task 4, Epoch 7/20 => Loss 2.369, Train_accy 94.14:  35%|███▌      | 7/20 [16:52<31:16, 144.33s/it]
Task 4, Epoch 8/20 => Loss 2.372, Train_accy 94.14:  35%|███▌      | 7/20 [19:12<31:16, 144.33s/it]
Task 4, Epoch 8/20 => Loss 2.372, Train_accy 94.14:  40%|████      | 8/20 [19:12<28:35, 142.98s/it]
Task 4, Epoch 9/20 => Loss 2.337, Train_accy 94.57:  40%|████      | 8/20 [21:32<28:35, 142.98s/it]
Task 4, Epoch 9/20 => Loss 2.337, Train_accy 94.57:  45%|████▌     | 9/20 [21:32<26:02, 142.08s/it]
Task 4, Epoch 10/20 => Loss 2.370, Train_accy 94.37:  45%|████▌     | 9/20 [24:50<26:02, 142.08s/it]
Task 4, Epoch 10/20 => Loss 2.370, Train_accy 94.37:  50%|█████     | 10/20 [24:50<26:32, 159.26s/it]
Task 4, Epoch 11/20 => Loss 2.321, Train_accy 95.08, Test_accy 68.41:  50%|█████     | 10/20 [28:35<26:32, 159.26s/it]
Task 4, Epoch 11/20 => Loss 2.321, Train_accy 95.08, Test_accy 68.41:  55%|█████▌    | 11/20 [28:35<26:52, 179.18s/it]
Task 4, Epoch 12/20 => Loss 2.317, Train_accy 95.39:  55%|█████▌    | 11/20 [30:55<26:52, 179.18s/it]                 
Task 4, Epoch 12/20 => Loss 2.317, Train_accy 95.39:  60%|██████    | 12/20 [30:55<22:19, 167.45s/it]
Task 4, Epoch 13/20 => Loss 2.350, Train_accy 95.06:  60%|██████    | 12/20 [33:29<22:19, 167.45s/it]
Task 4, Epoch 13/20 => Loss 2.350, Train_accy 95.06:  65%|██████▌   | 13/20 [33:29<19:03, 163.29s/it]
Task 4, Epoch 14/20 => Loss 2.313, Train_accy 95.45:  65%|██████▌   | 13/20 [36:06<19:03, 163.29s/it]
Task 4, Epoch 14/20 => Loss 2.313, Train_accy 95.45:  70%|███████   | 14/20 [36:06<16:09, 161.55s/it]
Task 4, Epoch 15/20 => Loss 2.326, Train_accy 95.49:  70%|███████   | 14/20 [38:27<16:09, 161.55s/it]
Task 4, Epoch 15/20 => Loss 2.326, Train_accy 95.49:  75%|███████▌  | 15/20 [38:27<12:55, 155.10s/it]
Task 4, Epoch 16/20 => Loss 2.318, Train_accy 95.49, Test_accy 68.02:  75%|███████▌  | 15/20 [41:02<12:55, 155.10s/it]
Task 4, Epoch 16/20 => Loss 2.318, Train_accy 95.49, Test_accy 68.02:  80%|████████  | 16/20 [41:02<10:21, 155.34s/it]
Task 4, Epoch 17/20 => Loss 2.298, Train_accy 95.87:  80%|████████  | 16/20 [43:33<10:21, 155.34s/it]                 
Task 4, Epoch 17/20 => Loss 2.298, Train_accy 95.87:  85%|████████▌ | 17/20 [43:33<07:41, 153.77s/it]
Task 4, Epoch 18/20 => Loss 2.291, Train_accy 96.06:  85%|████████▌ | 17/20 [45:53<07:41, 153.77s/it]
Task 4, Epoch 18/20 => Loss 2.291, Train_accy 96.06:  90%|█████████ | 18/20 [45:53<04:59, 149.78s/it]
Task 4, Epoch 19/20 => Loss 2.303, Train_accy 95.63:  90%|█████████ | 18/20 [49:50<04:59, 149.78s/it]
Task 4, Epoch 19/20 => Loss 2.303, Train_accy 95.63:  95%|█████████▌| 19/20 [49:50<02:55, 175.81s/it]
Task 4, Epoch 20/20 => Loss 2.294, Train_accy 96.03:  95%|█████████▌| 19/20 [52:50<02:55, 175.81s/it]
Task 4, Epoch 20/20 => Loss 2.294, Train_accy 96.03: 100%|██████████| 20/20 [52:50<00:00, 177.13s/it]
Task 4, Epoch 20/20 => Loss 2.294, Train_accy 96.03: 100%|██████████| 20/20 [52:50<00:00, 158.51s/it]
2024-04-26 21:29:00,103 [icarl.py] => Task 4, Epoch 20/20 => Loss 2.294, Train_accy 96.03
2024-04-26 21:29:00,105 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 21:32:06,577 [icarl.py] => Exemplar size: 5400
2024-04-26 21:32:06,577 [trainer.py] => CNN: {'total': 68.93, '00-149': 61.12, '150-179': 64.72, '180-209': 71.19, '210-239': 85.64, '240-269': 93.16, 'old': 65.89, 'new': 93.16}
2024-04-26 21:32:06,577 [trainer.py] => NME: {'total': 76.2, '00-149': 73.75, '150-179': 73.75, '180-209': 76.05, '210-239': 81.64, '240-269': 85.64, 'old': 75.02, 'new': 85.64}
2024-04-26 21:32:06,577 [trainer.py] => CNN top1 curve: [84.7, 79.59, 75.82, 70.95, 68.93]
2024-04-26 21:32:06,577 [trainer.py] => CNN top5 curve: [96.83, 95.66, 93.44, 91.4, 90.33]
2024-04-26 21:32:06,577 [trainer.py] => NME top1 curve: [85.47, 82.41, 80.23, 78.59, 76.2]
2024-04-26 21:32:06,577 [trainer.py] => NME top5 curve: [97.06, 96.19, 95.39, 95.01, 93.82]

Average Accuracy (CNN): 76.0
Average Accuracy (NME): 80.58
2024-04-26 21:32:06,577 [trainer.py] => Average Accuracy (CNN): 76.0
2024-04-26 21:32:06,577 [trainer.py] => Average Accuracy (NME): 80.58
2024-04-26 21:32:06,577 [trainer.py] => Train Time: 0
2024-04-26 21:32:06,577 [trainer.py] => Test Time: 126.41999999999999 

2024-04-26 21:32:06,578 [trainer.py] => All params: 86006286
2024-04-26 21:32:06,578 [trainer.py] => Trainable params: 86006286
2024-04-26 21:32:06,580 [icarl.py] => Learning on 270-300

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.179, Train_accy 80.15, Test_accy 65.55:   0%|          | 0/20 [03:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 3.179, Train_accy 80.15, Test_accy 65.55:   5%|▌         | 1/20 [03:00<57:12, 180.68s/it]
Task 5, Epoch 2/20 => Loss 2.628, Train_accy 89.06:   5%|▌         | 1/20 [06:36<57:12, 180.68s/it]                 
Task 5, Epoch 2/20 => Loss 2.628, Train_accy 89.06:  10%|█         | 2/20 [06:36<1:00:23, 201.28s/it]
Task 5, Epoch 3/20 => Loss 2.522, Train_accy 91.56:  10%|█         | 2/20 [10:11<1:00:23, 201.28s/it]
Task 5, Epoch 3/20 => Loss 2.522, Train_accy 91.56:  15%|█▌        | 3/20 [10:11<58:46, 207.44s/it]  
Task 5, Epoch 4/20 => Loss 2.550, Train_accy 91.72:  15%|█▌        | 3/20 [13:01<58:46, 207.44s/it]
Task 5, Epoch 4/20 => Loss 2.550, Train_accy 91.72:  20%|██        | 4/20 [13:01<51:27, 192.99s/it]
Task 5, Epoch 5/20 => Loss 2.678, Train_accy 89.85:  20%|██        | 4/20 [15:24<51:27, 192.99s/it]
Task 5, Epoch 5/20 => Loss 2.678, Train_accy 89.85:  25%|██▌       | 5/20 [15:24<43:42, 174.84s/it]
Task 5, Epoch 6/20 => Loss 2.498, Train_accy 92.69, Test_accy 65.96:  25%|██▌       | 5/20 [18:04<43:42, 174.84s/it]
Task 5, Epoch 6/20 => Loss 2.498, Train_accy 92.69, Test_accy 65.96:  30%|███       | 6/20 [18:04<39:34, 169.62s/it]
Task 5, Epoch 7/20 => Loss 2.478, Train_accy 93.79:  30%|███       | 6/20 [20:25<39:34, 169.62s/it]                 
Task 5, Epoch 7/20 => Loss 2.478, Train_accy 93.79:  35%|███▌      | 7/20 [20:25<34:45, 160.39s/it]
Task 5, Epoch 8/20 => Loss 2.460, Train_accy 93.66:  35%|███▌      | 7/20 [22:46<34:45, 160.39s/it]
Task 5, Epoch 8/20 => Loss 2.460, Train_accy 93.66:  40%|████      | 8/20 [22:46<30:51, 154.28s/it]
Task 5, Epoch 9/20 => Loss 2.417, Train_accy 94.60:  40%|████      | 8/20 [25:07<30:51, 154.28s/it]
Task 5, Epoch 9/20 => Loss 2.417, Train_accy 94.60:  45%|████▌     | 9/20 [25:07<27:30, 150.06s/it]
Task 5, Epoch 10/20 => Loss 2.439, Train_accy 94.96:  45%|████▌     | 9/20 [27:28<27:30, 150.06s/it]
Task 5, Epoch 10/20 => Loss 2.439, Train_accy 94.96:  50%|█████     | 10/20 [27:28<24:33, 147.38s/it]
Task 5, Epoch 11/20 => Loss 2.444, Train_accy 94.64, Test_accy 65.95:  50%|█████     | 10/20 [30:08<24:33, 147.38s/it]
Task 5, Epoch 11/20 => Loss 2.444, Train_accy 94.64, Test_accy 65.95:  55%|█████▌    | 11/20 [30:08<22:38, 150.98s/it]
Task 5, Epoch 12/20 => Loss 2.388, Train_accy 95.31:  55%|█████▌    | 11/20 [32:29<22:38, 150.98s/it]                 
Task 5, Epoch 12/20 => Loss 2.388, Train_accy 95.31:  60%|██████    | 12/20 [32:29<19:43, 147.98s/it]
Task 5, Epoch 13/20 => Loss 2.420, Train_accy 94.84:  60%|██████    | 12/20 [34:50<19:43, 147.98s/it]
Task 5, Epoch 13/20 => Loss 2.420, Train_accy 94.84:  65%|██████▌   | 13/20 [34:50<17:01, 145.86s/it]
Task 5, Epoch 14/20 => Loss 2.366, Train_accy 95.66:  65%|██████▌   | 13/20 [37:11<17:01, 145.86s/it]
Task 5, Epoch 14/20 => Loss 2.366, Train_accy 95.66:  70%|███████   | 14/20 [37:11<14:26, 144.47s/it]
Task 5, Epoch 15/20 => Loss 2.377, Train_accy 95.69:  70%|███████   | 14/20 [39:32<14:26, 144.47s/it]
Task 5, Epoch 15/20 => Loss 2.377, Train_accy 95.69:  75%|███████▌  | 15/20 [39:32<11:57, 143.53s/it]
Task 5, Epoch 16/20 => Loss 2.397, Train_accy 95.58, Test_accy 66.17:  75%|███████▌  | 15/20 [42:11<11:57, 143.53s/it]
Task 5, Epoch 16/20 => Loss 2.397, Train_accy 95.58, Test_accy 66.17:  80%|████████  | 16/20 [42:11<09:53, 148.26s/it]
Task 5, Epoch 17/20 => Loss 2.376, Train_accy 95.63:  80%|████████  | 16/20 [44:32<09:53, 148.26s/it]                 
Task 5, Epoch 17/20 => Loss 2.376, Train_accy 95.63:  85%|████████▌ | 17/20 [44:32<07:17, 146.00s/it]
Task 5, Epoch 18/20 => Loss 2.417, Train_accy 94.87:  85%|████████▌ | 17/20 [46:53<07:17, 146.00s/it]
Task 5, Epoch 18/20 => Loss 2.417, Train_accy 94.87:  90%|█████████ | 18/20 [46:53<04:48, 144.41s/it]
Task 5, Epoch 19/20 => Loss 2.350, Train_accy 96.28:  90%|█████████ | 18/20 [49:15<04:48, 144.41s/it]
Task 5, Epoch 19/20 => Loss 2.350, Train_accy 96.28:  95%|█████████▌| 19/20 [49:15<02:23, 143.70s/it]
Task 5, Epoch 20/20 => Loss 2.381, Train_accy 95.81:  95%|█████████▌| 19/20 [51:36<02:23, 143.70s/it]
Task 5, Epoch 20/20 => Loss 2.381, Train_accy 95.81: 100%|██████████| 20/20 [51:36<00:00, 142.83s/it]
Task 5, Epoch 20/20 => Loss 2.381, Train_accy 95.81: 100%|██████████| 20/20 [51:36<00:00, 154.81s/it]
2024-04-26 22:23:42,883 [icarl.py] => Task 5, Epoch 20/20 => Loss 2.381, Train_accy 95.81
2024-04-26 22:23:42,885 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 22:27:02,015 [icarl.py] => Exemplar size: 6000
2024-04-26 22:27:02,016 [trainer.py] => CNN: {'total': 66.03, '00-149': 57.58, '150-179': 60.54, '180-209': 64.49, '210-239': 73.12, '240-269': 80.47, '270-299': 93.81, 'old': 62.95, 'new': 93.81}
2024-04-26 22:27:02,016 [trainer.py] => NME: {'total': 74.92, '00-149': 71.68, '150-179': 72.91, '180-209': 74.54, '210-239': 78.63, '240-269': 80.63, '270-299': 84.11, 'old': 73.9, 'new': 84.11}
2024-04-26 22:27:02,016 [trainer.py] => CNN top1 curve: [84.7, 79.59, 75.82, 70.95, 68.93, 66.03]
2024-04-26 22:27:02,016 [trainer.py] => CNN top5 curve: [96.83, 95.66, 93.44, 91.4, 90.33, 88.42]
2024-04-26 22:27:02,016 [trainer.py] => NME top1 curve: [85.47, 82.41, 80.23, 78.59, 76.2, 74.92]
2024-04-26 22:27:02,016 [trainer.py] => NME top5 curve: [97.06, 96.19, 95.39, 95.01, 93.82, 92.77]

Average Accuracy (CNN): 74.34
Average Accuracy (NME): 79.64
2024-04-26 22:27:02,016 [trainer.py] => Average Accuracy (CNN): 74.34
2024-04-26 22:27:02,016 [trainer.py] => Average Accuracy (NME): 79.64
2024-04-26 22:27:02,016 [trainer.py] => Train Time: 0
2024-04-26 22:27:02,016 [trainer.py] => Test Time: 162.67999999999998 

Accuracy Matrix (CNN):
[[84.7  77.15 71.54 65.3  61.12 57.58]
 [ 0.   91.81 79.43 67.06 64.72 60.54]
 [ 0.    0.   93.63 81.57 71.19 64.49]
 [ 0.    0.    0.   92.49 85.64 73.12]
 [ 0.    0.    0.    0.   93.16 80.47]
 [ 0.    0.    0.    0.    0.   93.81]]
2024-04-26 22:27:02,017 [trainer.py] => Forgetting (CNN): 23.918
Accuracy Matrix (NME):
[[85.47 82.4  79.49 77.15 73.75 71.68]
 [ 0.   82.44 78.76 76.59 73.75 72.91]
 [ 0.    0.   85.43 80.57 76.05 74.54]
 [ 0.    0.    0.   85.81 81.64 78.63]
 [ 0.    0.    0.    0.   85.64 80.63]
 [ 0.    0.    0.    0.    0.   84.11]]
2024-04-26 22:27:02,017 [trainer.py] => Forgetting (NME): 9.280000000000001

2024-04-26 22:27:04,740 [trainer.py] => config: ./exps/der_omn_B150_Inc5.json
2024-04-26 22:27:04,740 [trainer.py] => prefix: reproduce
2024-04-26 22:27:04,740 [trainer.py] => dataset: omnibenchmark
2024-04-26 22:27:04,740 [trainer.py] => memory_size: 6000
2024-04-26 22:27:04,740 [trainer.py] => memory_per_class: 20
2024-04-26 22:27:04,740 [trainer.py] => fixed_memory: True
2024-04-26 22:27:04,741 [trainer.py] => shuffle: True
2024-04-26 22:27:04,741 [trainer.py] => init_cls: 150
2024-04-26 22:27:04,741 [trainer.py] => increment: 30
2024-04-26 22:27:04,741 [trainer.py] => model_name: der
2024-04-26 22:27:04,741 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-26 22:27:04,741 [trainer.py] => device: [device(type='cuda', index=1)]
2024-04-26 22:27:04,741 [trainer.py] => seed: 1993
2024-04-26 22:27:04,741 [trainer.py] => init_epoch: 20
2024-04-26 22:27:04,741 [trainer.py] => init_lr: 0.001
2024-04-26 22:27:04,741 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-26 22:27:04,741 [trainer.py] => init_lr_decay: 0.1
2024-04-26 22:27:04,741 [trainer.py] => init_weight_decay: 0.0005
2024-04-26 22:27:04,741 [trainer.py] => epochs: 20
2024-04-26 22:27:04,741 [trainer.py] => lrate: 0.001
2024-04-26 22:27:04,741 [trainer.py] => milestones: [80, 120, 150]
2024-04-26 22:27:04,741 [trainer.py] => lrate_decay: 0.1
2024-04-26 22:27:04,741 [trainer.py] => batch_size: 48
2024-04-26 22:27:04,741 [trainer.py] => weight_decay: 0.0002
2024-04-26 22:27:04,741 [trainer.py] => T: 2
2024-04-26 22:27:05,017 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
2024-04-26 22:27:05,717 [trainer.py] => All params: 0
2024-04-26 22:27:05,717 [trainer.py] => Trainable params: 0
2024-04-26 22:27:07,333 [der.py] => Learning on 0-150
2024-04-26 22:27:07,334 [der.py] => All params: 86030125
2024-04-26 22:27:07,335 [der.py] => Trainable params: 86030125

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.534, Train_accy 60.41, Test_accy 77.66:   0%|          | 0/20 [05:43<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.534, Train_accy 60.41, Test_accy 77.66:   5%|▌         | 1/20 [05:43<1:48:50, 343.73s/it]
Task 0, Epoch 2/20 => Loss 0.888, Train_accy 74.43:   5%|▌         | 1/20 [11:21<1:48:50, 343.73s/it]                 
Task 0, Epoch 2/20 => Loss 0.888, Train_accy 74.43:  10%|█         | 2/20 [11:21<1:42:04, 340.24s/it]
Task 0, Epoch 3/20 => Loss 0.757, Train_accy 77.61:  10%|█         | 2/20 [16:55<1:42:04, 340.24s/it]
Task 0, Epoch 3/20 => Loss 0.757, Train_accy 77.61:  15%|█▌        | 3/20 [16:55<1:35:36, 337.46s/it]
Task 0, Epoch 4/20 => Loss 0.679, Train_accy 80.05:  15%|█▌        | 3/20 [22:29<1:35:36, 337.46s/it]
Task 0, Epoch 4/20 => Loss 0.679, Train_accy 80.05:  20%|██        | 4/20 [22:29<1:29:37, 336.10s/it]
Task 0, Epoch 5/20 => Loss 0.622, Train_accy 81.64:  20%|██        | 4/20 [28:43<1:29:37, 336.10s/it]
Task 0, Epoch 5/20 => Loss 0.622, Train_accy 81.64:  25%|██▌       | 5/20 [28:43<1:27:24, 349.66s/it]
Task 0, Epoch 6/20 => Loss 0.584, Train_accy 82.70, Test_accy 85.00:  25%|██▌       | 5/20 [35:12<1:27:24, 349.66s/it]
Task 0, Epoch 6/20 => Loss 0.584, Train_accy 82.70, Test_accy 85.00:  30%|███       | 6/20 [35:12<1:24:40, 362.93s/it]
Task 0, Epoch 7/20 => Loss 0.547, Train_accy 83.94:  30%|███       | 6/20 [41:31<1:24:40, 362.93s/it]                 
Task 0, Epoch 7/20 => Loss 0.547, Train_accy 83.94:  35%|███▌      | 7/20 [41:31<1:19:49, 368.42s/it]
Task 0, Epoch 8/20 => Loss 0.514, Train_accy 84.73:  35%|███▌      | 7/20 [50:14<1:19:49, 368.42s/it]
Task 0, Epoch 8/20 => Loss 0.514, Train_accy 84.73:  40%|████      | 8/20 [50:14<1:23:31, 417.65s/it]
Task 0, Epoch 9/20 => Loss 0.490, Train_accy 85.50:  40%|████      | 8/20 [58:49<1:23:31, 417.65s/it]
Task 0, Epoch 9/20 => Loss 0.490, Train_accy 85.50:  45%|████▌     | 9/20 [58:49<1:22:07, 447.98s/it]
Task 0, Epoch 10/20 => Loss 0.473, Train_accy 85.95:  45%|████▌     | 9/20 [1:05:12<1:22:07, 447.98s/it]
Task 0, Epoch 10/20 => Loss 0.473, Train_accy 85.95:  50%|█████     | 10/20 [1:05:12<1:11:20, 428.06s/it]
Task 0, Epoch 11/20 => Loss 0.454, Train_accy 86.57, Test_accy 85.27:  50%|█████     | 10/20 [1:10:55<1:11:20, 428.06s/it]
Task 0, Epoch 11/20 => Loss 0.454, Train_accy 86.57, Test_accy 85.27:  55%|█████▌    | 11/20 [1:10:55<1:00:18, 402.01s/it]
Task 0, Epoch 12/20 => Loss 0.434, Train_accy 87.07:  55%|█████▌    | 11/20 [1:16:30<1:00:18, 402.01s/it]                 
Task 0, Epoch 12/20 => Loss 0.434, Train_accy 87.07:  60%|██████    | 12/20 [1:16:30<50:50, 381.37s/it]  
Task 0, Epoch 13/20 => Loss 0.416, Train_accy 87.60:  60%|██████    | 12/20 [1:22:07<50:50, 381.37s/it]
Task 0, Epoch 13/20 => Loss 0.416, Train_accy 87.60:  65%|██████▌   | 13/20 [1:22:07<42:57, 368.19s/it]
Task 0, Epoch 14/20 => Loss 0.407, Train_accy 87.78:  65%|██████▌   | 13/20 [1:27:43<42:57, 368.19s/it]
Task 0, Epoch 14/20 => Loss 0.407, Train_accy 87.78:  70%|███████   | 14/20 [1:27:43<35:49, 358.32s/it]
Task 0, Epoch 15/20 => Loss 0.396, Train_accy 88.15:  70%|███████   | 14/20 [1:33:17<35:49, 358.32s/it]
Task 0, Epoch 15/20 => Loss 0.396, Train_accy 88.15:  75%|███████▌  | 15/20 [1:33:17<29:15, 351.05s/it]
Task 0, Epoch 16/20 => Loss 0.389, Train_accy 88.59, Test_accy 84.27:  75%|███████▌  | 15/20 [1:39:00<29:15, 351.05s/it]
Task 0, Epoch 16/20 => Loss 0.389, Train_accy 88.59, Test_accy 84.27:  80%|████████  | 16/20 [1:39:00<23:14, 348.68s/it]
Task 0, Epoch 17/20 => Loss 0.373, Train_accy 88.84:  80%|████████  | 16/20 [1:44:34<23:14, 348.68s/it]                 
Task 0, Epoch 17/20 => Loss 0.373, Train_accy 88.84:  85%|████████▌ | 17/20 [1:44:34<17:12, 344.22s/it]
Task 0, Epoch 18/20 => Loss 0.371, Train_accy 89.05:  85%|████████▌ | 17/20 [1:50:09<17:12, 344.22s/it]
Task 0, Epoch 18/20 => Loss 0.371, Train_accy 89.05:  90%|█████████ | 18/20 [1:50:09<11:22, 341.38s/it]
Task 0, Epoch 19/20 => Loss 0.357, Train_accy 89.49:  90%|█████████ | 18/20 [1:55:43<11:22, 341.38s/it]
Task 0, Epoch 19/20 => Loss 0.357, Train_accy 89.49:  95%|█████████▌| 19/20 [1:55:43<05:39, 339.15s/it]
Task 0, Epoch 20/20 => Loss 0.353, Train_accy 89.48:  95%|█████████▌| 19/20 [2:01:17<05:39, 339.15s/it]
Task 0, Epoch 20/20 => Loss 0.353, Train_accy 89.48: 100%|██████████| 20/20 [2:01:17<00:00, 337.64s/it]
Task 0, Epoch 20/20 => Loss 0.353, Train_accy 89.48: 100%|██████████| 20/20 [2:01:17<00:00, 363.88s/it]
2024-04-27 00:28:25,395 [der.py] => Task 0, Epoch 20/20 => Loss 0.353, Train_accy 89.48
2024-04-27 00:28:25,396 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 00:33:42,373 [der.py] => Exemplar size: 3000
2024-04-27 00:33:42,373 [trainer.py] => CNN: {'total': 85.2, '00-149': 85.2, 'old': 0, 'new': 85.2}
2024-04-27 00:33:42,373 [trainer.py] => NME: {'total': 84.94, '00-149': 84.94, 'old': 0, 'new': 84.94}
2024-04-27 00:33:42,374 [trainer.py] => CNN top1 curve: [85.2]
2024-04-27 00:33:42,374 [trainer.py] => CNN top5 curve: [97.43]
2024-04-27 00:33:42,374 [trainer.py] => NME top1 curve: [84.94]
2024-04-27 00:33:42,374 [trainer.py] => NME top5 curve: [97.49]

Average Accuracy (CNN): 85.2
Average Accuracy (NME): 84.94
2024-04-27 00:33:42,374 [trainer.py] => Average Accuracy (CNN): 85.2
2024-04-27 00:33:42,374 [trainer.py] => Average Accuracy (NME): 84.94
2024-04-27 00:33:42,374 [trainer.py] => Train Time: 7278.03
2024-04-27 00:33:42,374 [trainer.py] => Test Time: 18.23 

2024-04-27 00:33:42,375 [trainer.py] => All params: 86030125
2024-04-27 00:33:42,375 [trainer.py] => Trainable params: 86030125
2024-04-27 00:33:44,005 [der.py] => Learning on 150-180
2024-04-27 00:33:44,007 [der.py] => All params: 171897811
2024-04-27 00:33:44,008 [der.py] => Trainable params: 86099155

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.084, Loss_clf 1.217, Loss_aux 0.867, Train_accy 75.89, Test_accy 75.89:   0%|          | 0/20 [02:19<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.084, Loss_clf 1.217, Loss_aux 0.867, Train_accy 75.89, Test_accy 75.89:   5%|▌         | 1/20 [02:19<44:02, 139.09s/it]
Task 1, Epoch 2/20 => Loss 0.961, Loss_clf 0.488, Loss_aux 0.473, Train_accy 85.66:   5%|▌         | 1/20 [04:18<44:02, 139.09s/it]                 
Task 1, Epoch 2/20 => Loss 0.961, Loss_clf 0.488, Loss_aux 0.473, Train_accy 85.66:  10%|█         | 2/20 [04:18<38:15, 127.52s/it]
Task 1, Epoch 3/20 => Loss 0.811, Loss_clf 0.411, Loss_aux 0.400, Train_accy 87.78:  10%|█         | 2/20 [06:17<38:15, 127.52s/it]
Task 1, Epoch 3/20 => Loss 0.811, Loss_clf 0.411, Loss_aux 0.400, Train_accy 87.78:  15%|█▌        | 3/20 [06:17<35:03, 123.73s/it]
Task 1, Epoch 4/20 => Loss 0.743, Loss_clf 0.380, Loss_aux 0.364, Train_accy 88.63:  15%|█▌        | 3/20 [08:17<35:03, 123.73s/it]
Task 1, Epoch 4/20 => Loss 0.743, Loss_clf 0.380, Loss_aux 0.364, Train_accy 88.63:  20%|██        | 4/20 [08:17<32:32, 122.01s/it]
Task 1, Epoch 5/20 => Loss 0.686, Loss_clf 0.351, Loss_aux 0.335, Train_accy 89.72:  20%|██        | 4/20 [10:16<32:32, 122.01s/it]
Task 1, Epoch 5/20 => Loss 0.686, Loss_clf 0.351, Loss_aux 0.335, Train_accy 89.72:  25%|██▌       | 5/20 [10:16<30:15, 121.01s/it]
Task 1, Epoch 6/20 => Loss 0.628, Loss_clf 0.326, Loss_aux 0.302, Train_accy 90.42, Test_accy 78.37:  25%|██▌       | 5/20 [12:35<30:15, 121.01s/it]
Task 1, Epoch 6/20 => Loss 0.628, Loss_clf 0.326, Loss_aux 0.302, Train_accy 90.42, Test_accy 78.37:  30%|███       | 6/20 [12:35<29:42, 127.31s/it]
Task 1, Epoch 7/20 => Loss 0.598, Loss_clf 0.304, Loss_aux 0.294, Train_accy 91.27:  30%|███       | 6/20 [14:35<29:42, 127.31s/it]                 
Task 1, Epoch 7/20 => Loss 0.598, Loss_clf 0.304, Loss_aux 0.294, Train_accy 91.27:  35%|███▌      | 7/20 [14:35<27:01, 124.73s/it]
Task 1, Epoch 8/20 => Loss 0.550, Loss_clf 0.279, Loss_aux 0.271, Train_accy 91.51:  35%|███▌      | 7/20 [16:34<27:01, 124.73s/it]
Task 1, Epoch 8/20 => Loss 0.550, Loss_clf 0.279, Loss_aux 0.271, Train_accy 91.51:  40%|████      | 8/20 [16:34<24:36, 123.08s/it]
Task 1, Epoch 9/20 => Loss 0.538, Loss_clf 0.274, Loss_aux 0.264, Train_accy 91.94:  40%|████      | 8/20 [18:34<24:36, 123.08s/it]
Task 1, Epoch 9/20 => Loss 0.538, Loss_clf 0.274, Loss_aux 0.264, Train_accy 91.94:  45%|████▌     | 9/20 [18:34<22:20, 121.89s/it]
Task 1, Epoch 10/20 => Loss 0.496, Loss_clf 0.259, Loss_aux 0.237, Train_accy 92.49:  45%|████▌     | 9/20 [20:33<22:20, 121.89s/it]
Task 1, Epoch 10/20 => Loss 0.496, Loss_clf 0.259, Loss_aux 0.237, Train_accy 92.49:  50%|█████     | 10/20 [20:33<20:10, 121.07s/it]
Task 1, Epoch 11/20 => Loss 0.488, Loss_clf 0.255, Loss_aux 0.234, Train_accy 92.69, Test_accy 79.18:  50%|█████     | 10/20 [22:53<20:10, 121.07s/it]
Task 1, Epoch 11/20 => Loss 0.488, Loss_clf 0.255, Loss_aux 0.234, Train_accy 92.69, Test_accy 79.18:  55%|█████▌    | 11/20 [22:53<19:00, 126.76s/it]
Task 1, Epoch 12/20 => Loss 0.482, Loss_clf 0.250, Loss_aux 0.232, Train_accy 92.78:  55%|█████▌    | 11/20 [24:52<19:00, 126.76s/it]                 
Task 1, Epoch 12/20 => Loss 0.482, Loss_clf 0.250, Loss_aux 0.232, Train_accy 92.78:  60%|██████    | 12/20 [24:52<16:35, 124.47s/it]
Task 1, Epoch 13/20 => Loss 0.453, Loss_clf 0.240, Loss_aux 0.214, Train_accy 93.02:  60%|██████    | 12/20 [26:51<16:35, 124.47s/it]
Task 1, Epoch 13/20 => Loss 0.453, Loss_clf 0.240, Loss_aux 0.214, Train_accy 93.02:  65%|██████▌   | 13/20 [26:51<14:20, 122.90s/it]
Task 1, Epoch 14/20 => Loss 0.442, Loss_clf 0.235, Loss_aux 0.207, Train_accy 93.34:  65%|██████▌   | 13/20 [28:51<14:20, 122.90s/it]
Task 1, Epoch 14/20 => Loss 0.442, Loss_clf 0.235, Loss_aux 0.207, Train_accy 93.34:  70%|███████   | 14/20 [28:51<12:11, 121.88s/it]
Task 1, Epoch 15/20 => Loss 0.425, Loss_clf 0.220, Loss_aux 0.204, Train_accy 93.34:  70%|███████   | 14/20 [30:50<12:11, 121.88s/it]
Task 1, Epoch 15/20 => Loss 0.425, Loss_clf 0.220, Loss_aux 0.204, Train_accy 93.34:  75%|███████▌  | 15/20 [30:50<10:05, 121.09s/it]
Task 1, Epoch 16/20 => Loss 0.382, Loss_clf 0.200, Loss_aux 0.182, Train_accy 94.11, Test_accy 77.59:  75%|███████▌  | 15/20 [33:09<10:05, 121.09s/it]
Task 1, Epoch 16/20 => Loss 0.382, Loss_clf 0.200, Loss_aux 0.182, Train_accy 94.11, Test_accy 77.59:  80%|████████  | 16/20 [33:09<08:26, 126.53s/it]
Task 1, Epoch 17/20 => Loss 0.385, Loss_clf 0.204, Loss_aux 0.182, Train_accy 94.17:  80%|████████  | 16/20 [35:08<08:26, 126.53s/it]                 
Task 1, Epoch 17/20 => Loss 0.385, Loss_clf 0.204, Loss_aux 0.182, Train_accy 94.17:  85%|████████▌ | 17/20 [35:08<06:13, 124.34s/it]
Task 1, Epoch 18/20 => Loss 0.406, Loss_clf 0.213, Loss_aux 0.192, Train_accy 93.84:  85%|████████▌ | 17/20 [37:08<06:13, 124.34s/it]
Task 1, Epoch 18/20 => Loss 0.406, Loss_clf 0.213, Loss_aux 0.192, Train_accy 93.84:  90%|█████████ | 18/20 [37:08<04:05, 122.82s/it]
Task 1, Epoch 19/20 => Loss 0.382, Loss_clf 0.202, Loss_aux 0.180, Train_accy 94.26:  90%|█████████ | 18/20 [39:07<04:05, 122.82s/it]
Task 1, Epoch 19/20 => Loss 0.382, Loss_clf 0.202, Loss_aux 0.180, Train_accy 94.26:  95%|█████████▌| 19/20 [39:07<02:01, 121.77s/it]
Task 1, Epoch 20/20 => Loss 0.393, Loss_clf 0.206, Loss_aux 0.186, Train_accy 94.09:  95%|█████████▌| 19/20 [41:06<02:01, 121.77s/it]
Task 1, Epoch 20/20 => Loss 0.393, Loss_clf 0.206, Loss_aux 0.186, Train_accy 94.09: 100%|██████████| 20/20 [41:06<00:00, 121.01s/it]
Task 1, Epoch 20/20 => Loss 0.393, Loss_clf 0.206, Loss_aux 0.186, Train_accy 94.09: 100%|██████████| 20/20 [41:06<00:00, 123.33s/it]
2024-04-27 01:14:50,635 [der.py] => Task 1, Epoch 20/20 => Loss 0.393, Loss_clf 0.206, Loss_aux 0.186, Train_accy 94.09
2024-04-27 01:14:50,637 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 01:18:10,818 [der.py] => Exemplar size: 3600
2024-04-27 01:18:10,818 [trainer.py] => CNN: {'total': 79.06, '00-149': 76.19, '150-179': 93.48, 'old': 76.19, 'new': 93.48}
2024-04-27 01:18:10,818 [trainer.py] => NME: {'total': 81.46, '00-149': 80.46, '150-179': 86.45, 'old': 80.46, 'new': 86.45}
2024-04-27 01:18:10,818 [trainer.py] => CNN top1 curve: [85.2, 79.06]
2024-04-27 01:18:10,818 [trainer.py] => CNN top5 curve: [97.43, 95.02]
2024-04-27 01:18:10,818 [trainer.py] => NME top1 curve: [84.94, 81.46]
2024-04-27 01:18:10,818 [trainer.py] => NME top5 curve: [97.49, 96.6]

Average Accuracy (CNN): 82.13
Average Accuracy (NME): 83.2
2024-04-27 01:18:10,818 [trainer.py] => Average Accuracy (CNN): 82.13
2024-04-27 01:18:10,818 [trainer.py] => Average Accuracy (NME): 83.2
2024-04-27 01:18:10,818 [trainer.py] => Train Time: 9744.64
2024-04-27 01:18:10,818 [trainer.py] => Test Time: 58.739999999999995 

2024-04-27 01:18:10,820 [trainer.py] => All params: 171897811
2024-04-27 01:18:10,821 [trainer.py] => Trainable params: 86099155
2024-04-27 01:18:12,301 [der.py] => Learning on 180-210
2024-04-27 01:18:12,304 [der.py] => All params: 257903857
2024-04-27 01:18:12,305 [der.py] => Trainable params: 86306545

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.012, Loss_clf 1.187, Loss_aux 0.825, Train_accy 76.49, Test_accy 75.10:   0%|          | 0/20 [03:11<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.012, Loss_clf 1.187, Loss_aux 0.825, Train_accy 76.49, Test_accy 75.10:   5%|▌         | 1/20 [03:11<1:00:30, 191.07s/it]
Task 2, Epoch 2/20 => Loss 0.927, Loss_clf 0.463, Loss_aux 0.464, Train_accy 85.76:   5%|▌         | 1/20 [05:47<1:00:30, 191.07s/it]                 
Task 2, Epoch 2/20 => Loss 0.927, Loss_clf 0.463, Loss_aux 0.464, Train_accy 85.76:  10%|█         | 2/20 [05:47<51:16, 170.92s/it]  
Task 2, Epoch 3/20 => Loss 0.779, Loss_clf 0.401, Loss_aux 0.378, Train_accy 87.54:  10%|█         | 2/20 [08:24<51:16, 170.92s/it]
Task 2, Epoch 3/20 => Loss 0.779, Loss_clf 0.401, Loss_aux 0.378, Train_accy 87.54:  15%|█▌        | 3/20 [08:24<46:37, 164.56s/it]
Task 2, Epoch 4/20 => Loss 0.717, Loss_clf 0.364, Loss_aux 0.354, Train_accy 89.03:  15%|█▌        | 3/20 [11:02<46:37, 164.56s/it]
Task 2, Epoch 4/20 => Loss 0.717, Loss_clf 0.364, Loss_aux 0.354, Train_accy 89.03:  20%|██        | 4/20 [11:02<43:06, 161.68s/it]
Task 2, Epoch 5/20 => Loss 0.680, Loss_clf 0.345, Loss_aux 0.336, Train_accy 89.51:  20%|██        | 4/20 [13:40<43:06, 161.68s/it]
Task 2, Epoch 5/20 => Loss 0.680, Loss_clf 0.345, Loss_aux 0.336, Train_accy 89.51:  25%|██▌       | 5/20 [13:40<40:04, 160.30s/it]
Task 2, Epoch 6/20 => Loss 0.606, Loss_clf 0.320, Loss_aux 0.286, Train_accy 90.12, Test_accy 76.18:  25%|██▌       | 5/20 [16:51<40:04, 160.30s/it]
Task 2, Epoch 6/20 => Loss 0.606, Loss_clf 0.320, Loss_aux 0.286, Train_accy 90.12, Test_accy 76.18:  30%|███       | 6/20 [16:51<39:50, 170.76s/it]
Task 2, Epoch 7/20 => Loss 0.569, Loss_clf 0.298, Loss_aux 0.271, Train_accy 91.19:  30%|███       | 6/20 [19:28<39:50, 170.76s/it]                 
Task 2, Epoch 7/20 => Loss 0.569, Loss_clf 0.298, Loss_aux 0.271, Train_accy 91.19:  35%|███▌      | 7/20 [19:28<36:01, 166.25s/it]
Task 2, Epoch 8/20 => Loss 0.543, Loss_clf 0.282, Loss_aux 0.261, Train_accy 91.69:  35%|███▌      | 7/20 [22:04<36:01, 166.25s/it]
Task 2, Epoch 8/20 => Loss 0.543, Loss_clf 0.282, Loss_aux 0.261, Train_accy 91.69:  40%|████      | 8/20 [22:04<32:39, 163.25s/it]
Task 2, Epoch 9/20 => Loss 0.535, Loss_clf 0.277, Loss_aux 0.258, Train_accy 91.94:  40%|████      | 8/20 [24:42<32:39, 163.25s/it]
Task 2, Epoch 9/20 => Loss 0.535, Loss_clf 0.277, Loss_aux 0.258, Train_accy 91.94:  45%|████▌     | 9/20 [24:42<29:35, 161.43s/it]
Task 2, Epoch 10/20 => Loss 0.511, Loss_clf 0.263, Loss_aux 0.248, Train_accy 92.30:  45%|████▌     | 9/20 [27:20<29:35, 161.43s/it]
Task 2, Epoch 10/20 => Loss 0.511, Loss_clf 0.263, Loss_aux 0.248, Train_accy 92.30:  50%|█████     | 10/20 [27:20<26:42, 160.29s/it]
Task 2, Epoch 11/20 => Loss 0.476, Loss_clf 0.251, Loss_aux 0.225, Train_accy 92.70, Test_accy 77.63:  50%|█████     | 10/20 [30:30<26:42, 160.29s/it]
Task 2, Epoch 11/20 => Loss 0.476, Loss_clf 0.251, Loss_aux 0.225, Train_accy 92.70, Test_accy 77.63:  55%|█████▌    | 11/20 [30:30<25:27, 169.68s/it]
Task 2, Epoch 12/20 => Loss 0.474, Loss_clf 0.256, Loss_aux 0.218, Train_accy 92.58:  55%|█████▌    | 11/20 [33:07<25:27, 169.68s/it]                 
Task 2, Epoch 12/20 => Loss 0.474, Loss_clf 0.256, Loss_aux 0.218, Train_accy 92.58:  60%|██████    | 12/20 [33:07<22:06, 165.79s/it]
Task 2, Epoch 13/20 => Loss 0.445, Loss_clf 0.246, Loss_aux 0.198, Train_accy 93.10:  60%|██████    | 12/20 [35:44<22:06, 165.79s/it]
Task 2, Epoch 13/20 => Loss 0.445, Loss_clf 0.246, Loss_aux 0.198, Train_accy 93.10:  65%|██████▌   | 13/20 [35:44<19:01, 163.11s/it]
Task 2, Epoch 14/20 => Loss 0.440, Loss_clf 0.235, Loss_aux 0.205, Train_accy 93.14:  65%|██████▌   | 13/20 [38:22<19:01, 163.11s/it]
Task 2, Epoch 14/20 => Loss 0.440, Loss_clf 0.235, Loss_aux 0.205, Train_accy 93.14:  70%|███████   | 14/20 [38:22<16:08, 161.40s/it]
Task 2, Epoch 15/20 => Loss 0.414, Loss_clf 0.219, Loss_aux 0.195, Train_accy 93.66:  70%|███████   | 14/20 [40:59<16:08, 161.40s/it]
Task 2, Epoch 15/20 => Loss 0.414, Loss_clf 0.219, Loss_aux 0.195, Train_accy 93.66:  75%|███████▌  | 15/20 [40:59<13:20, 160.16s/it]
Task 2, Epoch 16/20 => Loss 0.432, Loss_clf 0.226, Loss_aux 0.205, Train_accy 93.32, Test_accy 77.58:  75%|███████▌  | 15/20 [44:11<13:20, 160.16s/it]
Task 2, Epoch 16/20 => Loss 0.432, Loss_clf 0.226, Loss_aux 0.205, Train_accy 93.32, Test_accy 77.58:  80%|████████  | 16/20 [44:11<11:18, 169.62s/it]
Task 2, Epoch 17/20 => Loss 0.387, Loss_clf 0.209, Loss_aux 0.178, Train_accy 94.13:  80%|████████  | 16/20 [46:48<11:18, 169.62s/it]                 
Task 2, Epoch 17/20 => Loss 0.387, Loss_clf 0.209, Loss_aux 0.178, Train_accy 94.13:  85%|████████▌ | 17/20 [46:48<08:17, 165.84s/it]
Task 2, Epoch 18/20 => Loss 0.402, Loss_clf 0.211, Loss_aux 0.191, Train_accy 93.95:  85%|████████▌ | 17/20 [49:25<08:17, 165.84s/it]
Task 2, Epoch 18/20 => Loss 0.402, Loss_clf 0.211, Loss_aux 0.191, Train_accy 93.95:  90%|█████████ | 18/20 [49:25<05:26, 163.22s/it]
Task 2, Epoch 19/20 => Loss 0.407, Loss_clf 0.214, Loss_aux 0.193, Train_accy 93.71:  90%|█████████ | 18/20 [52:02<05:26, 163.22s/it]
Task 2, Epoch 19/20 => Loss 0.407, Loss_clf 0.214, Loss_aux 0.193, Train_accy 93.71:  95%|█████████▌| 19/20 [52:02<02:41, 161.34s/it]
Task 2, Epoch 20/20 => Loss 0.375, Loss_clf 0.206, Loss_aux 0.169, Train_accy 94.18:  95%|█████████▌| 19/20 [54:39<02:41, 161.34s/it]
Task 2, Epoch 20/20 => Loss 0.375, Loss_clf 0.206, Loss_aux 0.169, Train_accy 94.18: 100%|██████████| 20/20 [54:39<00:00, 160.03s/it]
Task 2, Epoch 20/20 => Loss 0.375, Loss_clf 0.206, Loss_aux 0.169, Train_accy 94.18: 100%|██████████| 20/20 [54:39<00:00, 163.96s/it]
2024-04-27 02:12:51,620 [der.py] => Task 2, Epoch 20/20 => Loss 0.375, Loss_clf 0.206, Loss_aux 0.169, Train_accy 94.18
2024-04-27 02:12:51,622 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 02:17:43,860 [der.py] => Exemplar size: 4200
2024-04-27 02:17:43,860 [trainer.py] => CNN: {'total': 77.35, '00-149': 74.38, '150-179': 77.93, '180-209': 91.62, 'old': 74.97, 'new': 91.62}
2024-04-27 02:17:43,860 [trainer.py] => NME: {'total': 79.54, '00-149': 78.32, '150-179': 81.1, '180-209': 84.09, 'old': 78.79, 'new': 84.09}
2024-04-27 02:17:43,860 [trainer.py] => CNN top1 curve: [85.2, 79.06, 77.35]
2024-04-27 02:17:43,860 [trainer.py] => CNN top5 curve: [97.43, 95.02, 94.34]
2024-04-27 02:17:43,860 [trainer.py] => NME top1 curve: [84.94, 81.46, 79.54]
2024-04-27 02:17:43,861 [trainer.py] => NME top5 curve: [97.49, 96.6, 95.87]

Average Accuracy (CNN): 80.54
Average Accuracy (NME): 81.98
2024-04-27 02:17:43,861 [trainer.py] => Average Accuracy (CNN): 80.54
2024-04-27 02:17:43,861 [trainer.py] => Average Accuracy (NME): 81.98
2024-04-27 02:17:43,861 [trainer.py] => Train Time: 13023.939999999999
2024-04-27 02:17:43,861 [trainer.py] => Test Time: 128.41 

2024-04-27 02:17:43,863 [trainer.py] => All params: 257903857
2024-04-27 02:17:43,864 [trainer.py] => Trainable params: 86306545
2024-04-27 02:17:45,417 [der.py] => Learning on 210-240
2024-04-27 02:17:45,421 [der.py] => All params: 343955983
2024-04-27 02:17:45,423 [der.py] => Trainable params: 86560015

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.969, Loss_clf 1.140, Loss_aux 0.829, Train_accy 77.76, Test_accy 72.01:   0%|          | 0/20 [04:18<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.969, Loss_clf 1.140, Loss_aux 0.829, Train_accy 77.76, Test_accy 72.01:   5%|▌         | 1/20 [04:18<1:21:46, 258.25s/it]
Task 3, Epoch 2/20 => Loss 0.964, Loss_clf 0.481, Loss_aux 0.483, Train_accy 85.89:   5%|▌         | 1/20 [07:43<1:21:46, 258.25s/it]                 
Task 3, Epoch 2/20 => Loss 0.964, Loss_clf 0.481, Loss_aux 0.483, Train_accy 85.89:  10%|█         | 2/20 [07:43<1:08:08, 227.13s/it]
Task 3, Epoch 3/20 => Loss 0.859, Loss_clf 0.439, Loss_aux 0.420, Train_accy 87.15:  10%|█         | 2/20 [11:08<1:08:08, 227.13s/it]
Task 3, Epoch 3/20 => Loss 0.859, Loss_clf 0.439, Loss_aux 0.420, Train_accy 87.15:  15%|█▌        | 3/20 [11:08<1:01:31, 217.18s/it]
Task 3, Epoch 4/20 => Loss 0.774, Loss_clf 0.393, Loss_aux 0.380, Train_accy 88.21:  15%|█▌        | 3/20 [14:34<1:01:31, 217.18s/it]
Task 3, Epoch 4/20 => Loss 0.774, Loss_clf 0.393, Loss_aux 0.380, Train_accy 88.21:  20%|██        | 4/20 [14:34<56:39, 212.46s/it]  
Task 3, Epoch 5/20 => Loss 0.719, Loss_clf 0.372, Loss_aux 0.346, Train_accy 89.21:  20%|██        | 4/20 [17:59<56:39, 212.46s/it]
Task 3, Epoch 5/20 => Loss 0.719, Loss_clf 0.372, Loss_aux 0.346, Train_accy 89.21:  25%|██▌       | 5/20 [17:59<52:26, 209.79s/it]
Task 3, Epoch 6/20 => Loss 0.661, Loss_clf 0.344, Loss_aux 0.317, Train_accy 89.93, Test_accy 73.45:  25%|██▌       | 5/20 [22:15<52:26, 209.79s/it]
Task 3, Epoch 6/20 => Loss 0.661, Loss_clf 0.344, Loss_aux 0.317, Train_accy 89.93, Test_accy 73.45:  30%|███       | 6/20 [22:15<52:37, 225.52s/it]
Task 3, Epoch 7/20 => Loss 0.626, Loss_clf 0.319, Loss_aux 0.307, Train_accy 90.60:  30%|███       | 6/20 [25:40<52:37, 225.52s/it]                 
Task 3, Epoch 7/20 => Loss 0.626, Loss_clf 0.319, Loss_aux 0.307, Train_accy 90.60:  35%|███▌      | 7/20 [25:40<47:25, 218.87s/it]
Task 3, Epoch 8/20 => Loss 0.605, Loss_clf 0.312, Loss_aux 0.293, Train_accy 90.78:  35%|███▌      | 7/20 [29:05<47:25, 218.87s/it]
Task 3, Epoch 8/20 => Loss 0.605, Loss_clf 0.312, Loss_aux 0.293, Train_accy 90.78:  40%|████      | 8/20 [29:05<42:54, 214.56s/it]
Task 3, Epoch 9/20 => Loss 0.558, Loss_clf 0.287, Loss_aux 0.271, Train_accy 91.49:  40%|████      | 8/20 [32:31<42:54, 214.56s/it]
Task 3, Epoch 9/20 => Loss 0.558, Loss_clf 0.287, Loss_aux 0.271, Train_accy 91.49:  45%|████▌     | 9/20 [32:31<38:48, 211.66s/it]
Task 3, Epoch 10/20 => Loss 0.523, Loss_clf 0.268, Loss_aux 0.255, Train_accy 92.13:  45%|████▌     | 9/20 [35:56<38:48, 211.66s/it]
Task 3, Epoch 10/20 => Loss 0.523, Loss_clf 0.268, Loss_aux 0.255, Train_accy 92.13:  50%|█████     | 10/20 [35:56<34:56, 209.70s/it]
Task 3, Epoch 11/20 => Loss 0.507, Loss_clf 0.263, Loss_aux 0.244, Train_accy 92.37, Test_accy 73.52:  50%|█████     | 10/20 [40:13<34:56, 209.70s/it]
Task 3, Epoch 11/20 => Loss 0.507, Loss_clf 0.263, Loss_aux 0.244, Train_accy 92.37, Test_accy 73.52:  55%|█████▌    | 11/20 [40:13<33:36, 224.07s/it]
Task 3, Epoch 12/20 => Loss 0.504, Loss_clf 0.259, Loss_aux 0.245, Train_accy 92.34:  55%|█████▌    | 11/20 [43:38<33:36, 224.07s/it]                 
Task 3, Epoch 12/20 => Loss 0.504, Loss_clf 0.259, Loss_aux 0.245, Train_accy 92.34:  60%|██████    | 12/20 [43:38<29:07, 218.43s/it]
Task 3, Epoch 13/20 => Loss 0.503, Loss_clf 0.259, Loss_aux 0.244, Train_accy 92.30:  60%|██████    | 12/20 [47:03<29:07, 218.43s/it]
Task 3, Epoch 13/20 => Loss 0.503, Loss_clf 0.259, Loss_aux 0.244, Train_accy 92.30:  65%|██████▌   | 13/20 [47:03<25:01, 214.48s/it]
Task 3, Epoch 14/20 => Loss 0.475, Loss_clf 0.248, Loss_aux 0.227, Train_accy 92.94:  65%|██████▌   | 13/20 [50:29<25:01, 214.48s/it]
Task 3, Epoch 14/20 => Loss 0.475, Loss_clf 0.248, Loss_aux 0.227, Train_accy 92.94:  70%|███████   | 14/20 [50:29<21:10, 211.75s/it]
Task 3, Epoch 15/20 => Loss 0.461, Loss_clf 0.241, Loss_aux 0.220, Train_accy 93.01:  70%|███████   | 14/20 [53:54<21:10, 211.75s/it]
Task 3, Epoch 15/20 => Loss 0.461, Loss_clf 0.241, Loss_aux 0.220, Train_accy 93.01:  75%|███████▌  | 15/20 [53:54<17:29, 209.80s/it]
Task 3, Epoch 16/20 => Loss 0.457, Loss_clf 0.240, Loss_aux 0.217, Train_accy 93.24, Test_accy 73.83:  75%|███████▌  | 15/20 [58:11<17:29, 209.80s/it]
Task 3, Epoch 16/20 => Loss 0.457, Loss_clf 0.240, Loss_aux 0.217, Train_accy 93.24, Test_accy 73.83:  80%|████████  | 16/20 [58:11<14:55, 223.84s/it]
Task 3, Epoch 17/20 => Loss 0.415, Loss_clf 0.217, Loss_aux 0.198, Train_accy 93.82:  80%|████████  | 16/20 [1:01:36<14:55, 223.84s/it]               
Task 3, Epoch 17/20 => Loss 0.415, Loss_clf 0.217, Loss_aux 0.198, Train_accy 93.82:  85%|████████▌ | 17/20 [1:01:36<10:54, 218.19s/it]
Task 3, Epoch 18/20 => Loss 0.438, Loss_clf 0.229, Loss_aux 0.209, Train_accy 93.36:  85%|████████▌ | 17/20 [1:05:01<10:54, 218.19s/it]
Task 3, Epoch 18/20 => Loss 0.438, Loss_clf 0.229, Loss_aux 0.209, Train_accy 93.36:  90%|█████████ | 18/20 [1:05:01<07:08, 214.47s/it]
Task 3, Epoch 19/20 => Loss 0.429, Loss_clf 0.232, Loss_aux 0.197, Train_accy 93.67:  90%|█████████ | 18/20 [1:08:27<07:08, 214.47s/it]
Task 3, Epoch 19/20 => Loss 0.429, Loss_clf 0.232, Loss_aux 0.197, Train_accy 93.67:  95%|█████████▌| 19/20 [1:08:27<03:31, 211.73s/it]
Task 3, Epoch 20/20 => Loss 0.422, Loss_clf 0.225, Loss_aux 0.197, Train_accy 93.43:  95%|█████████▌| 19/20 [1:11:52<03:31, 211.73s/it]
Task 3, Epoch 20/20 => Loss 0.422, Loss_clf 0.225, Loss_aux 0.197, Train_accy 93.43: 100%|██████████| 20/20 [1:11:52<00:00, 209.80s/it]
Task 3, Epoch 20/20 => Loss 0.422, Loss_clf 0.225, Loss_aux 0.197, Train_accy 93.43: 100%|██████████| 20/20 [1:11:52<00:00, 215.63s/it]
2024-04-27 03:29:38,124 [der.py] => Task 3, Epoch 20/20 => Loss 0.422, Loss_clf 0.225, Loss_aux 0.197, Train_accy 93.43
2024-04-27 03:29:38,126 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 03:35:58,925 [der.py] => Exemplar size: 4800
2024-04-27 03:35:58,926 [trainer.py] => CNN: {'total': 73.58, '00-149': 69.77, '150-179': 68.9, '180-209': 78.39, '210-239': 92.49, 'old': 70.88, 'new': 92.49}
2024-04-27 03:35:58,926 [trainer.py] => NME: {'total': 77.84, '00-149': 75.62, '150-179': 78.26, '180-209': 82.41, '210-239': 83.97, 'old': 76.96, 'new': 83.97}
2024-04-27 03:35:58,926 [trainer.py] => CNN top1 curve: [85.2, 79.06, 77.35, 73.58]
2024-04-27 03:35:58,926 [trainer.py] => CNN top5 curve: [97.43, 95.02, 94.34, 92.9]
2024-04-27 03:35:58,926 [trainer.py] => NME top1 curve: [84.94, 81.46, 79.54, 77.84]
2024-04-27 03:35:58,926 [trainer.py] => NME top5 curve: [97.49, 96.6, 95.87, 95.01]

Average Accuracy (CNN): 78.8
Average Accuracy (NME): 80.94
2024-04-27 03:35:58,926 [trainer.py] => Average Accuracy (CNN): 78.8
2024-04-27 03:35:58,926 [trainer.py] => Average Accuracy (NME): 80.94
2024-04-27 03:35:58,926 [trainer.py] => Train Time: 17336.629999999997
2024-04-27 03:35:58,926 [trainer.py] => Test Time: 232.72 

2024-04-27 03:35:58,928 [trainer.py] => All params: 343955983
2024-04-27 03:35:58,930 [trainer.py] => Trainable params: 86560015
2024-04-27 03:36:00,659 [der.py] => Learning on 240-270
2024-04-27 03:36:00,664 [der.py] => All params: 430054189
2024-04-27 03:36:00,666 [der.py] => Trainable params: 86859565

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.813, Loss_clf 1.057, Loss_aux 0.756, Train_accy 81.05, Test_accy 70.39:   0%|          | 0/20 [05:19<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.813, Loss_clf 1.057, Loss_aux 0.756, Train_accy 81.05, Test_accy 70.39:   5%|▌         | 1/20 [05:19<1:41:12, 319.59s/it]
Task 4, Epoch 2/20 => Loss 0.831, Loss_clf 0.422, Loss_aux 0.409, Train_accy 88.20:   5%|▌         | 1/20 [09:27<1:41:12, 319.59s/it]                 
Task 4, Epoch 2/20 => Loss 0.831, Loss_clf 0.422, Loss_aux 0.409, Train_accy 88.20:  10%|█         | 2/20 [09:27<1:23:15, 277.53s/it]
Task 4, Epoch 3/20 => Loss 0.694, Loss_clf 0.365, Loss_aux 0.330, Train_accy 89.66:  10%|█         | 2/20 [13:35<1:23:15, 277.53s/it]
Task 4, Epoch 3/20 => Loss 0.694, Loss_clf 0.365, Loss_aux 0.330, Train_accy 89.66:  15%|█▌        | 3/20 [13:35<1:14:49, 264.11s/it]
Task 4, Epoch 4/20 => Loss 0.631, Loss_clf 0.329, Loss_aux 0.302, Train_accy 90.61:  15%|█▌        | 3/20 [17:43<1:14:49, 264.11s/it]
Task 4, Epoch 4/20 => Loss 0.631, Loss_clf 0.329, Loss_aux 0.302, Train_accy 90.61:  20%|██        | 4/20 [17:43<1:08:44, 257.79s/it]
Task 4, Epoch 5/20 => Loss 0.603, Loss_clf 0.316, Loss_aux 0.287, Train_accy 91.19:  20%|██        | 4/20 [21:51<1:08:44, 257.79s/it]
Task 4, Epoch 5/20 => Loss 0.603, Loss_clf 0.316, Loss_aux 0.287, Train_accy 91.19:  25%|██▌       | 5/20 [21:51<1:03:32, 254.17s/it]
Task 4, Epoch 6/20 => Loss 0.563, Loss_clf 0.300, Loss_aux 0.263, Train_accy 91.34, Test_accy 71.62:  25%|██▌       | 5/20 [27:10<1:03:32, 254.17s/it]
Task 4, Epoch 6/20 => Loss 0.563, Loss_clf 0.300, Loss_aux 0.263, Train_accy 91.34, Test_accy 71.62:  30%|███       | 6/20 [27:10<1:04:27, 276.22s/it]
Task 4, Epoch 7/20 => Loss 0.536, Loss_clf 0.287, Loss_aux 0.249, Train_accy 91.89:  30%|███       | 6/20 [31:18<1:04:27, 276.22s/it]                 
Task 4, Epoch 7/20 => Loss 0.536, Loss_clf 0.287, Loss_aux 0.249, Train_accy 91.89:  35%|███▌      | 7/20 [31:18<57:50, 266.93s/it]  
Task 4, Epoch 8/20 => Loss 0.485, Loss_clf 0.255, Loss_aux 0.230, Train_accy 92.98:  35%|███▌      | 7/20 [35:26<57:50, 266.93s/it]
Task 4, Epoch 8/20 => Loss 0.485, Loss_clf 0.255, Loss_aux 0.230, Train_accy 92.98:  40%|████      | 8/20 [35:26<52:11, 260.93s/it]
Task 4, Epoch 9/20 => Loss 0.495, Loss_clf 0.265, Loss_aux 0.229, Train_accy 92.71:  40%|████      | 8/20 [39:34<52:11, 260.93s/it]
Task 4, Epoch 9/20 => Loss 0.495, Loss_clf 0.265, Loss_aux 0.229, Train_accy 92.71:  45%|████▌     | 9/20 [39:34<47:05, 256.89s/it]
Task 4, Epoch 10/20 => Loss 0.463, Loss_clf 0.253, Loss_aux 0.210, Train_accy 93.21:  45%|████▌     | 9/20 [43:42<47:05, 256.89s/it]
Task 4, Epoch 10/20 => Loss 0.463, Loss_clf 0.253, Loss_aux 0.210, Train_accy 93.21:  50%|█████     | 10/20 [43:42<42:21, 254.19s/it]
Task 4, Epoch 11/20 => Loss 0.439, Loss_clf 0.235, Loss_aux 0.203, Train_accy 93.46, Test_accy 72.90:  50%|█████     | 10/20 [49:01<42:21, 254.19s/it]
Task 4, Epoch 11/20 => Loss 0.439, Loss_clf 0.235, Loss_aux 0.203, Train_accy 93.46, Test_accy 72.90:  55%|█████▌    | 11/20 [49:01<41:06, 274.11s/it]
Task 4, Epoch 12/20 => Loss 0.430, Loss_clf 0.233, Loss_aux 0.197, Train_accy 93.64:  55%|█████▌    | 11/20 [53:09<41:06, 274.11s/it]                 
Task 4, Epoch 12/20 => Loss 0.430, Loss_clf 0.233, Loss_aux 0.197, Train_accy 93.64:  60%|██████    | 12/20 [53:09<35:28, 266.09s/it]
Task 4, Epoch 13/20 => Loss 0.410, Loss_clf 0.219, Loss_aux 0.191, Train_accy 93.79:  60%|██████    | 12/20 [57:17<35:28, 266.09s/it]
Task 4, Epoch 13/20 => Loss 0.410, Loss_clf 0.219, Loss_aux 0.191, Train_accy 93.79:  65%|██████▌   | 13/20 [57:17<30:23, 260.51s/it]
Task 4, Epoch 14/20 => Loss 0.408, Loss_clf 0.219, Loss_aux 0.189, Train_accy 93.98:  65%|██████▌   | 13/20 [1:01:25<30:23, 260.51s/it]
Task 4, Epoch 14/20 => Loss 0.408, Loss_clf 0.219, Loss_aux 0.189, Train_accy 93.98:  70%|███████   | 14/20 [1:01:25<25:40, 256.70s/it]
Task 4, Epoch 15/20 => Loss 0.401, Loss_clf 0.221, Loss_aux 0.180, Train_accy 94.10:  70%|███████   | 14/20 [1:05:33<25:40, 256.70s/it]
Task 4, Epoch 15/20 => Loss 0.401, Loss_clf 0.221, Loss_aux 0.180, Train_accy 94.10:  75%|███████▌  | 15/20 [1:05:33<21:10, 254.06s/it]
Task 4, Epoch 16/20 => Loss 0.377, Loss_clf 0.205, Loss_aux 0.172, Train_accy 94.10, Test_accy 72.55:  75%|███████▌  | 15/20 [1:10:52<21:10, 254.06s/it]
Task 4, Epoch 16/20 => Loss 0.377, Loss_clf 0.205, Loss_aux 0.172, Train_accy 94.10, Test_accy 72.55:  80%|████████  | 16/20 [1:10:52<18:15, 273.77s/it]
Task 4, Epoch 17/20 => Loss 0.391, Loss_clf 0.218, Loss_aux 0.173, Train_accy 94.10:  80%|████████  | 16/20 [1:15:00<18:15, 273.77s/it]                 
Task 4, Epoch 17/20 => Loss 0.391, Loss_clf 0.218, Loss_aux 0.173, Train_accy 94.10:  85%|████████▌ | 17/20 [1:15:00<13:18, 266.05s/it]
Task 4, Epoch 18/20 => Loss 0.375, Loss_clf 0.205, Loss_aux 0.170, Train_accy 94.50:  85%|████████▌ | 17/20 [1:19:08<13:18, 266.05s/it]
Task 4, Epoch 18/20 => Loss 0.375, Loss_clf 0.205, Loss_aux 0.170, Train_accy 94.50:  90%|█████████ | 18/20 [1:19:08<08:41, 260.64s/it]
Task 4, Epoch 19/20 => Loss 0.368, Loss_clf 0.206, Loss_aux 0.162, Train_accy 94.17:  90%|█████████ | 18/20 [1:23:16<08:41, 260.64s/it]
Task 4, Epoch 19/20 => Loss 0.368, Loss_clf 0.206, Loss_aux 0.162, Train_accy 94.17:  95%|█████████▌| 19/20 [1:23:16<04:16, 256.79s/it]
Task 4, Epoch 20/20 => Loss 0.363, Loss_clf 0.201, Loss_aux 0.162, Train_accy 94.60:  95%|█████████▌| 19/20 [1:27:24<04:16, 256.79s/it]
Task 4, Epoch 20/20 => Loss 0.363, Loss_clf 0.201, Loss_aux 0.162, Train_accy 94.60: 100%|██████████| 20/20 [1:27:24<00:00, 254.09s/it]
Task 4, Epoch 20/20 => Loss 0.363, Loss_clf 0.201, Loss_aux 0.162, Train_accy 94.60: 100%|██████████| 20/20 [1:27:24<00:00, 262.23s/it]
2024-04-27 05:03:25,274 [der.py] => Task 4, Epoch 20/20 => Loss 0.363, Loss_clf 0.201, Loss_aux 0.162, Train_accy 94.60
2024-04-27 05:03:25,276 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 05:11:26,186 [der.py] => Exemplar size: 5400
2024-04-27 05:11:26,186 [trainer.py] => CNN: {'total': 72.77, '00-149': 67.57, '150-179': 68.23, '180-209': 71.52, '210-239': 83.64, '240-269': 93.66, 'old': 70.15, 'new': 93.66}
2024-04-27 05:11:26,186 [trainer.py] => NME: {'total': 76.15, '00-149': 73.01, '150-179': 75.42, '180-209': 78.06, '210-239': 83.97, '240-269': 82.8, 'old': 75.31, 'new': 82.8}
2024-04-27 05:11:26,186 [trainer.py] => CNN top1 curve: [85.2, 79.06, 77.35, 73.58, 72.77]
2024-04-27 05:11:26,186 [trainer.py] => CNN top5 curve: [97.43, 95.02, 94.34, 92.9, 92.39]
2024-04-27 05:11:26,187 [trainer.py] => NME top1 curve: [84.94, 81.46, 79.54, 77.84, 76.15]
2024-04-27 05:11:26,187 [trainer.py] => NME top5 curve: [97.49, 96.6, 95.87, 95.01, 94.52]

Average Accuracy (CNN): 77.59
Average Accuracy (NME): 79.99
2024-04-27 05:11:26,187 [trainer.py] => Average Accuracy (CNN): 77.59
2024-04-27 05:11:26,187 [trainer.py] => Average Accuracy (NME): 79.99
2024-04-27 05:11:26,187 [trainer.py] => Train Time: 22581.219999999998
2024-04-27 05:11:26,187 [trainer.py] => Test Time: 378.4 

2024-04-27 05:11:26,189 [trainer.py] => All params: 430054189
2024-04-27 05:11:26,192 [trainer.py] => Trainable params: 86859565
2024-04-27 05:11:27,831 [der.py] => Learning on 270-300
2024-04-27 05:11:27,836 [der.py] => All params: 516198475
2024-04-27 05:11:27,838 [der.py] => Trainable params: 87205195

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.768, Loss_clf 1.007, Loss_aux 0.760, Train_accy 80.76, Test_accy 68.42:   0%|          | 0/20 [06:20<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.768, Loss_clf 1.007, Loss_aux 0.760, Train_accy 80.76, Test_accy 68.42:   5%|▌         | 1/20 [06:20<2:00:29, 380.50s/it]
Task 5, Epoch 2/20 => Loss 0.831, Loss_clf 0.429, Loss_aux 0.402, Train_accy 87.47:   5%|▌         | 1/20 [11:06<2:00:29, 380.50s/it]                 
Task 5, Epoch 2/20 => Loss 0.831, Loss_clf 0.429, Loss_aux 0.402, Train_accy 87.47:  10%|█         | 2/20 [11:06<1:37:25, 324.74s/it]
Task 5, Epoch 3/20 => Loss 0.760, Loss_clf 0.412, Loss_aux 0.347, Train_accy 89.07:  10%|█         | 2/20 [15:51<1:37:25, 324.74s/it]
Task 5, Epoch 3/20 => Loss 0.760, Loss_clf 0.412, Loss_aux 0.347, Train_accy 89.07:  15%|█▌        | 3/20 [15:51<1:26:57, 306.91s/it]
Task 5, Epoch 4/20 => Loss 1.065, Loss_clf 0.667, Loss_aux 0.397, Train_accy 88.60:  15%|█▌        | 3/20 [20:37<1:26:57, 306.91s/it]
Task 5, Epoch 4/20 => Loss 1.065, Loss_clf 0.667, Loss_aux 0.397, Train_accy 88.60:  20%|██        | 4/20 [20:37<1:19:35, 298.49s/it]
Task 5, Epoch 5/20 => Loss 0.734, Loss_clf 0.377, Loss_aux 0.357, Train_accy 90.28:  20%|██        | 4/20 [25:22<1:19:35, 298.49s/it]
Task 5, Epoch 5/20 => Loss 0.734, Loss_clf 0.377, Loss_aux 0.357, Train_accy 90.28:  25%|██▌       | 5/20 [25:22<1:13:25, 293.72s/it]
Task 5, Epoch 6/20 => Loss 0.888, Loss_clf 0.523, Loss_aux 0.364, Train_accy 90.05, Test_accy 69.59:  25%|██▌       | 5/20 [31:42<1:13:25, 293.72s/it]
Task 5, Epoch 6/20 => Loss 0.888, Loss_clf 0.523, Loss_aux 0.364, Train_accy 90.05, Test_accy 69.59:  30%|███       | 6/20 [31:42<1:15:22, 323.03s/it]
Task 5, Epoch 7/20 => Loss 0.616, Loss_clf 0.353, Loss_aux 0.263, Train_accy 91.47:  30%|███       | 6/20 [36:28<1:15:22, 323.03s/it]                 
Task 5, Epoch 7/20 => Loss 0.616, Loss_clf 0.353, Loss_aux 0.263, Train_accy 91.47:  35%|███▌      | 7/20 [36:28<1:07:20, 310.83s/it]
Task 5, Epoch 8/20 => Loss 0.525, Loss_clf 0.286, Loss_aux 0.239, Train_accy 92.06:  35%|███▌      | 7/20 [41:14<1:07:20, 310.83s/it]
Task 5, Epoch 8/20 => Loss 0.525, Loss_clf 0.286, Loss_aux 0.239, Train_accy 92.06:  40%|████      | 8/20 [41:14<1:00:34, 302.84s/it]
Task 5, Epoch 9/20 => Loss 0.531, Loss_clf 0.300, Loss_aux 0.231, Train_accy 91.98:  40%|████      | 8/20 [45:59<1:00:34, 302.84s/it]
Task 5, Epoch 9/20 => Loss 0.531, Loss_clf 0.300, Loss_aux 0.231, Train_accy 91.98:  45%|████▌     | 9/20 [45:59<54:32, 297.51s/it]  
Task 5, Epoch 10/20 => Loss 0.560, Loss_clf 0.293, Loss_aux 0.267, Train_accy 92.26:  45%|████▌     | 9/20 [50:45<54:32, 297.51s/it]
Task 5, Epoch 10/20 => Loss 0.560, Loss_clf 0.293, Loss_aux 0.267, Train_accy 92.26:  50%|█████     | 10/20 [50:45<48:58, 293.84s/it]
Task 5, Epoch 11/20 => Loss 0.480, Loss_clf 0.263, Loss_aux 0.217, Train_accy 92.59, Test_accy 69.59:  50%|█████     | 10/20 [57:05<48:58, 293.84s/it]
Task 5, Epoch 11/20 => Loss 0.480, Loss_clf 0.263, Loss_aux 0.217, Train_accy 92.59, Test_accy 69.59:  55%|█████▌    | 11/20 [57:05<48:01, 320.17s/it]
Task 5, Epoch 12/20 => Loss 0.446, Loss_clf 0.242, Loss_aux 0.204, Train_accy 93.33:  55%|█████▌    | 11/20 [1:01:50<48:01, 320.17s/it]               
Task 5, Epoch 12/20 => Loss 0.446, Loss_clf 0.242, Loss_aux 0.204, Train_accy 93.33:  60%|██████    | 12/20 [1:01:50<41:16, 309.57s/it]
Task 5, Epoch 13/20 => Loss 0.431, Loss_clf 0.236, Loss_aux 0.195, Train_accy 93.31:  60%|██████    | 12/20 [1:06:36<41:16, 309.57s/it]
Task 5, Epoch 13/20 => Loss 0.431, Loss_clf 0.236, Loss_aux 0.195, Train_accy 93.31:  65%|██████▌   | 13/20 [1:06:36<35:16, 302.32s/it]
Task 5, Epoch 14/20 => Loss 0.424, Loss_clf 0.236, Loss_aux 0.187, Train_accy 93.34:  65%|██████▌   | 13/20 [1:11:22<35:16, 302.32s/it]
Task 5, Epoch 14/20 => Loss 0.424, Loss_clf 0.236, Loss_aux 0.187, Train_accy 93.34:  70%|███████   | 14/20 [1:11:22<29:43, 297.31s/it]
Task 5, Epoch 15/20 => Loss 0.425, Loss_clf 0.234, Loss_aux 0.191, Train_accy 93.59:  70%|███████   | 14/20 [1:16:07<29:43, 297.31s/it]
Task 5, Epoch 15/20 => Loss 0.425, Loss_clf 0.234, Loss_aux 0.191, Train_accy 93.59:  75%|███████▌  | 15/20 [1:16:07<24:29, 293.83s/it]
Task 5, Epoch 16/20 => Loss 0.383, Loss_clf 0.214, Loss_aux 0.169, Train_accy 93.96, Test_accy 70.09:  75%|███████▌  | 15/20 [1:22:28<24:29, 293.83s/it]
Task 5, Epoch 16/20 => Loss 0.383, Loss_clf 0.214, Loss_aux 0.169, Train_accy 93.96, Test_accy 70.09:  80%|████████  | 16/20 [1:22:28<21:19, 319.92s/it]
Task 5, Epoch 17/20 => Loss 0.410, Loss_clf 0.224, Loss_aux 0.185, Train_accy 93.74:  80%|████████  | 16/20 [1:27:14<21:19, 319.92s/it]                 
Task 5, Epoch 17/20 => Loss 0.410, Loss_clf 0.224, Loss_aux 0.185, Train_accy 93.74:  85%|████████▌ | 17/20 [1:27:14<15:28, 309.64s/it]
Task 5, Epoch 18/20 => Loss 0.403, Loss_clf 0.225, Loss_aux 0.178, Train_accy 93.69:  85%|████████▌ | 17/20 [1:31:59<15:28, 309.64s/it]
Task 5, Epoch 18/20 => Loss 0.403, Loss_clf 0.225, Loss_aux 0.178, Train_accy 93.69:  90%|█████████ | 18/20 [1:31:59<10:04, 302.43s/it]
Task 5, Epoch 19/20 => Loss 0.364, Loss_clf 0.206, Loss_aux 0.158, Train_accy 94.41:  90%|█████████ | 18/20 [1:36:45<10:04, 302.43s/it]
Task 5, Epoch 19/20 => Loss 0.364, Loss_clf 0.206, Loss_aux 0.158, Train_accy 94.41:  95%|█████████▌| 19/20 [1:36:45<04:57, 297.28s/it]
Task 5, Epoch 20/20 => Loss 0.359, Loss_clf 0.202, Loss_aux 0.157, Train_accy 94.51:  95%|█████████▌| 19/20 [1:41:30<04:57, 297.28s/it]
Task 5, Epoch 20/20 => Loss 0.359, Loss_clf 0.202, Loss_aux 0.157, Train_accy 94.51: 100%|██████████| 20/20 [1:41:30<00:00, 293.69s/it]
Task 5, Epoch 20/20 => Loss 0.359, Loss_clf 0.202, Loss_aux 0.157, Train_accy 94.51: 100%|██████████| 20/20 [1:41:30<00:00, 304.52s/it]
2024-04-27 06:52:58,265 [der.py] => Task 5, Epoch 20/20 => Loss 0.359, Loss_clf 0.202, Loss_aux 0.157, Train_accy 94.51
2024-04-27 06:52:58,267 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 07:02:43,863 [der.py] => Exemplar size: 6000
2024-04-27 07:02:43,863 [trainer.py] => CNN: {'total': 70.94, '00-149': 65.36, '150-179': 66.05, '180-209': 70.85, '210-239': 74.12, '240-269': 78.46, '270-299': 93.14, 'old': 68.48, 'new': 93.14}
2024-04-27 07:02:43,863 [trainer.py] => NME: {'total': 75.1, '00-149': 71.44, '150-179': 73.08, '180-209': 76.88, '210-239': 81.97, '240-269': 79.97, '270-299': 81.94, 'old': 74.35, 'new': 81.94}
2024-04-27 07:02:43,864 [trainer.py] => CNN top1 curve: [85.2, 79.06, 77.35, 73.58, 72.77, 70.94]
2024-04-27 07:02:43,864 [trainer.py] => CNN top5 curve: [97.43, 95.02, 94.34, 92.9, 92.39, 91.63]
2024-04-27 07:02:43,864 [trainer.py] => NME top1 curve: [84.94, 81.46, 79.54, 77.84, 76.15, 75.1]
2024-04-27 07:02:43,864 [trainer.py] => NME top5 curve: [97.49, 96.6, 95.87, 95.01, 94.52, 93.83]

Average Accuracy (CNN): 76.48
Average Accuracy (NME): 79.17
2024-04-27 07:02:43,864 [trainer.py] => Average Accuracy (CNN): 76.48
2024-04-27 07:02:43,864 [trainer.py] => Average Accuracy (NME): 79.17
2024-04-27 07:02:43,864 [trainer.py] => Train Time: 28671.629999999997
2024-04-27 07:02:43,864 [trainer.py] => Test Time: 572.36 

Accuracy Matrix (CNN):
[[85.2  76.19 74.38 69.77 67.57 65.36]
 [ 0.   93.48 77.93 68.9  68.23 66.05]
 [ 0.    0.   91.62 78.39 71.52 70.85]
 [ 0.    0.    0.   92.49 83.64 74.12]
 [ 0.    0.    0.    0.   93.66 78.46]
 [ 0.    0.    0.    0.    0.   93.14]]
2024-04-27 07:02:43,865 [trainer.py] => Forgetting (CNN): 20.322000000000003
Accuracy Matrix (NME):
[[84.94 80.46 78.32 75.62 73.01 71.44]
 [ 0.   86.45 81.1  78.26 75.42 73.08]
 [ 0.    0.   84.09 82.41 78.06 76.88]
 [ 0.    0.    0.   83.97 83.97 81.97]
 [ 0.    0.    0.    0.   82.8  79.97]
 [ 0.    0.    0.    0.    0.   81.94]]
2024-04-27 07:02:43,865 [trainer.py] => Forgetting (NME): 7.782000000000002

2024-04-27 07:02:46,558 [trainer.py] => config: ./exps/foster_omn_B150_Inc5.json
2024-04-27 07:02:46,559 [trainer.py] => prefix: cil
2024-04-27 07:02:46,559 [trainer.py] => dataset: omnibenchmark
2024-04-27 07:02:46,559 [trainer.py] => memory_size: 6000
2024-04-27 07:02:46,559 [trainer.py] => memory_per_class: 20
2024-04-27 07:02:46,559 [trainer.py] => fixed_memory: True
2024-04-27 07:02:46,559 [trainer.py] => shuffle: True
2024-04-27 07:02:46,559 [trainer.py] => init_cls: 150
2024-04-27 07:02:46,559 [trainer.py] => increment: 30
2024-04-27 07:02:46,559 [trainer.py] => model_name: foster
2024-04-27 07:02:46,559 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-27 07:02:46,559 [trainer.py] => device: [device(type='cuda', index=1)]
2024-04-27 07:02:46,559 [trainer.py] => seed: 1993
2024-04-27 07:02:46,559 [trainer.py] => beta1: 0.96
2024-04-27 07:02:46,559 [trainer.py] => beta2: 0.97
2024-04-27 07:02:46,559 [trainer.py] => oofc: ft
2024-04-27 07:02:46,559 [trainer.py] => is_teacher_wa: False
2024-04-27 07:02:46,559 [trainer.py] => is_student_wa: False
2024-04-27 07:02:46,559 [trainer.py] => lambda_okd: 1
2024-04-27 07:02:46,559 [trainer.py] => wa_value: 1
2024-04-27 07:02:46,559 [trainer.py] => init_epochs: 20
2024-04-27 07:02:46,559 [trainer.py] => init_lr: 0.001
2024-04-27 07:02:46,559 [trainer.py] => init_weight_decay: 0.0005
2024-04-27 07:02:46,559 [trainer.py] => boosting_epochs: 20
2024-04-27 07:02:46,559 [trainer.py] => compression_epochs: 20
2024-04-27 07:02:46,559 [trainer.py] => lr: 0.001
2024-04-27 07:02:46,559 [trainer.py] => batch_size: 48
2024-04-27 07:02:46,559 [trainer.py] => weight_decay: 0.0005
2024-04-27 07:02:46,559 [trainer.py] => num_workers: 8
2024-04-27 07:02:46,559 [trainer.py] => T: 2
2024-04-27 07:02:46,814 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
2024-04-27 07:02:47,498 [trainer.py] => All params: 0
2024-04-27 07:02:47,498 [trainer.py] => Trainable params: 0
2024-04-27 07:02:49,041 [foster.py] => Learning on 0-150
2024-04-27 07:02:49,041 [foster.py] => All params: 86029356
2024-04-27 07:02:49,042 [foster.py] => Trainable params: 86029356

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.615, Train_accy 59.03, Test_accy 78.32:   0%|          | 0/20 [05:34<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.615, Train_accy 59.03, Test_accy 78.32:   5%|▌         | 1/20 [05:34<1:45:59, 334.70s/it]
Task 0, Epoch 2/20 => Loss 0.895, Train_accy 74.13:   5%|▌         | 1/20 [11:00<1:45:59, 334.70s/it]                 
Task 0, Epoch 2/20 => Loss 0.895, Train_accy 74.13:  10%|█         | 2/20 [11:00<1:38:46, 329.26s/it]
Task 0, Epoch 3/20 => Loss 0.754, Train_accy 77.89:  10%|█         | 2/20 [16:25<1:38:46, 329.26s/it]
Task 0, Epoch 3/20 => Loss 0.754, Train_accy 77.89:  15%|█▌        | 3/20 [16:25<1:32:48, 327.54s/it]
Task 0, Epoch 4/20 => Loss 0.677, Train_accy 80.03:  15%|█▌        | 3/20 [21:51<1:32:48, 327.54s/it]
Task 0, Epoch 4/20 => Loss 0.677, Train_accy 80.03:  20%|██        | 4/20 [21:51<1:27:07, 326.74s/it]
Task 0, Epoch 5/20 => Loss 0.607, Train_accy 81.79:  20%|██        | 4/20 [27:16<1:27:07, 326.74s/it]
Task 0, Epoch 5/20 => Loss 0.607, Train_accy 81.79:  25%|██▌       | 5/20 [27:16<1:21:32, 326.17s/it]
Task 0, Epoch 6/20 => Loss 0.550, Train_accy 83.76, Test_accy 84.37:  25%|██▌       | 5/20 [32:50<1:21:32, 326.17s/it]
Task 0, Epoch 6/20 => Loss 0.550, Train_accy 83.76, Test_accy 84.37:  30%|███       | 6/20 [32:50<1:16:43, 328.79s/it]
Task 0, Epoch 7/20 => Loss 0.514, Train_accy 84.58:  30%|███       | 6/20 [38:15<1:16:43, 328.79s/it]                 
Task 0, Epoch 7/20 => Loss 0.514, Train_accy 84.58:  35%|███▌      | 7/20 [38:15<1:10:59, 327.62s/it]
Task 0, Epoch 8/20 => Loss 0.466, Train_accy 86.10:  35%|███▌      | 7/20 [43:40<1:10:59, 327.62s/it]
Task 0, Epoch 8/20 => Loss 0.466, Train_accy 86.10:  40%|████      | 8/20 [43:40<1:05:23, 326.94s/it]
Task 0, Epoch 9/20 => Loss 0.432, Train_accy 87.14:  40%|████      | 8/20 [49:06<1:05:23, 326.94s/it]
Task 0, Epoch 9/20 => Loss 0.432, Train_accy 87.14:  45%|████▌     | 9/20 [49:06<59:51, 326.50s/it]  
Task 0, Epoch 10/20 => Loss 0.408, Train_accy 87.87:  45%|████▌     | 9/20 [54:32<59:51, 326.50s/it]
Task 0, Epoch 10/20 => Loss 0.408, Train_accy 87.87:  50%|█████     | 10/20 [54:32<54:22, 326.23s/it]
Task 0, Epoch 11/20 => Loss 0.366, Train_accy 89.01, Test_accy 86.27:  50%|█████     | 10/20 [1:00:06<54:22, 326.23s/it]
Task 0, Epoch 11/20 => Loss 0.366, Train_accy 89.01, Test_accy 86.27:  55%|█████▌    | 11/20 [1:00:06<49:19, 328.78s/it]
Task 0, Epoch 12/20 => Loss 0.349, Train_accy 89.79:  55%|█████▌    | 11/20 [1:05:31<49:19, 328.78s/it]                 
Task 0, Epoch 12/20 => Loss 0.349, Train_accy 89.79:  60%|██████    | 12/20 [1:05:31<43:41, 327.70s/it]
Task 0, Epoch 13/20 => Loss 0.320, Train_accy 90.38:  60%|██████    | 12/20 [1:10:56<43:41, 327.70s/it]
Task 0, Epoch 13/20 => Loss 0.320, Train_accy 90.38:  65%|██████▌   | 13/20 [1:10:56<38:08, 326.86s/it]
Task 0, Epoch 14/20 => Loss 0.300, Train_accy 91.10:  65%|██████▌   | 13/20 [1:16:21<38:08, 326.86s/it]
Task 0, Epoch 14/20 => Loss 0.300, Train_accy 91.10:  70%|███████   | 14/20 [1:16:21<32:37, 326.32s/it]
Task 0, Epoch 15/20 => Loss 0.285, Train_accy 91.52:  70%|███████   | 14/20 [1:21:47<32:37, 326.32s/it]
Task 0, Epoch 15/20 => Loss 0.285, Train_accy 91.52:  75%|███████▌  | 15/20 [1:21:47<27:10, 326.04s/it]
Task 0, Epoch 16/20 => Loss 0.262, Train_accy 92.20, Test_accy 87.27:  75%|███████▌  | 15/20 [1:27:21<27:10, 326.04s/it]
Task 0, Epoch 16/20 => Loss 0.262, Train_accy 92.20, Test_accy 87.27:  80%|████████  | 16/20 [1:27:21<21:54, 328.60s/it]
Task 0, Epoch 17/20 => Loss 0.252, Train_accy 92.54:  80%|████████  | 16/20 [1:32:47<21:54, 328.60s/it]                 
Task 0, Epoch 17/20 => Loss 0.252, Train_accy 92.54:  85%|████████▌ | 17/20 [1:32:47<16:22, 327.64s/it]
Task 0, Epoch 18/20 => Loss 0.248, Train_accy 92.72:  85%|████████▌ | 17/20 [1:38:12<16:22, 327.64s/it]
Task 0, Epoch 18/20 => Loss 0.248, Train_accy 92.72:  90%|█████████ | 18/20 [1:38:12<10:53, 326.83s/it]
Task 0, Epoch 19/20 => Loss 0.243, Train_accy 92.89:  90%|█████████ | 18/20 [1:43:37<10:53, 326.83s/it]
Task 0, Epoch 19/20 => Loss 0.243, Train_accy 92.89:  95%|█████████▌| 19/20 [1:43:37<05:26, 326.25s/it]
Task 0, Epoch 20/20 => Loss 0.247, Train_accy 92.84:  95%|█████████▌| 19/20 [1:49:02<05:26, 326.25s/it]
Task 0, Epoch 20/20 => Loss 0.247, Train_accy 92.84: 100%|██████████| 20/20 [1:49:02<00:00, 326.03s/it]
Task 0, Epoch 20/20 => Loss 0.247, Train_accy 92.84: 100%|██████████| 20/20 [1:49:02<00:00, 327.13s/it]
2024-04-27 08:51:52,149 [foster.py] => Task 0, Epoch 20/20 => Loss 0.247, Train_accy 92.84
2024-04-27 08:51:52,151 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 08:57:07,410 [foster.py] => Exemplar size: 3000
2024-04-27 08:57:07,410 [trainer.py] => CNN: {'total': 87.71, '00-149': 87.71, 'old': 0, 'new': 87.71}
2024-04-27 08:57:07,410 [trainer.py] => NME: {'total': 86.97, '00-149': 86.97, 'old': 0, 'new': 86.97}
2024-04-27 08:57:07,410 [trainer.py] => CNN top1 curve: [87.71]
2024-04-27 08:57:07,410 [trainer.py] => CNN top5 curve: [97.6]
2024-04-27 08:57:07,410 [trainer.py] => NME top1 curve: [86.97]
2024-04-27 08:57:07,410 [trainer.py] => NME top5 curve: [97.76]

Average Accuracy (CNN): 87.71
Average Accuracy (NME): 86.97
2024-04-27 08:57:07,410 [trainer.py] => Average Accuracy (CNN): 87.71
2024-04-27 08:57:07,411 [trainer.py] => Average Accuracy (NME): 86.97
2024-04-27 08:57:07,411 [trainer.py] => Train Time: 6543.08
2024-04-27 08:57:07,411 [trainer.py] => Test Time: 18.02 

2024-04-27 08:57:07,411 [trainer.py] => All params: 86029356
2024-04-27 08:57:07,412 [trainer.py] => Trainable params: 86029356
2024-04-27 08:57:08,946 [foster.py] => Learning on 150-180
2024-04-27 08:57:08,947 [foster.py] => All params: 172127742
2024-04-27 08:57:08,948 [foster.py] => Trainable params: 86213736
2024-04-27 08:57:09,006 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 4.411, Loss_clf 1.043, Loss_fe 1.639, Loss_kd 1.441, Train_accy 49.51, Test_accy 80.23:   0%|          | 0/20 [02:17<?, ?it/s]
Task 1, Epoch 1/20 => Loss 4.411, Loss_clf 1.043, Loss_fe 1.639, Loss_kd 1.441, Train_accy 49.51, Test_accy 80.23:   5%|▌         | 1/20 [02:17<43:25, 137.11s/it]
Task 1, Epoch 2/20 => Loss 2.921, Loss_clf 0.512, Loss_fe 0.713, Loss_kd 1.414, Train_accy 51.79:   5%|▌         | 1/20 [04:14<43:25, 137.11s/it]                 
Task 1, Epoch 2/20 => Loss 2.921, Loss_clf 0.512, Loss_fe 0.713, Loss_kd 1.414, Train_accy 51.79:  10%|█         | 2/20 [04:14<37:38, 125.48s/it]
Task 1, Epoch 3/20 => Loss 2.746, Loss_clf 0.444, Loss_fe 0.593, Loss_kd 1.425, Train_accy 51.66:  10%|█         | 2/20 [06:11<37:38, 125.48s/it]
Task 1, Epoch 3/20 => Loss 2.746, Loss_clf 0.444, Loss_fe 0.593, Loss_kd 1.425, Train_accy 51.66:  15%|█▌        | 3/20 [06:11<34:30, 121.78s/it]
Task 1, Epoch 4/20 => Loss 2.601, Loss_clf 0.391, Loss_fe 0.511, Loss_kd 1.416, Train_accy 52.82:  15%|█▌        | 3/20 [08:09<34:30, 121.78s/it]
Task 1, Epoch 4/20 => Loss 2.601, Loss_clf 0.391, Loss_fe 0.511, Loss_kd 1.416, Train_accy 52.82:  20%|██        | 4/20 [08:09<32:00, 120.04s/it]
Task 1, Epoch 5/20 => Loss 2.520, Loss_clf 0.358, Loss_fe 0.453, Loss_kd 1.424, Train_accy 53.56:  20%|██        | 4/20 [10:06<32:00, 120.04s/it]
Task 1, Epoch 5/20 => Loss 2.520, Loss_clf 0.358, Loss_fe 0.453, Loss_kd 1.424, Train_accy 53.56:  25%|██▌       | 5/20 [10:06<29:45, 119.05s/it]
Task 1, Epoch 6/20 => Loss 2.470, Loss_clf 0.332, Loss_fe 0.426, Loss_kd 1.426, Train_accy 54.38, Test_accy 80.15:  25%|██▌       | 5/20 [12:23<29:45, 119.05s/it]
Task 1, Epoch 6/20 => Loss 2.470, Loss_clf 0.332, Loss_fe 0.426, Loss_kd 1.426, Train_accy 54.38, Test_accy 80.15:  30%|███       | 6/20 [12:23<29:13, 125.28s/it]
Task 1, Epoch 7/20 => Loss 2.373, Loss_clf 0.293, Loss_fe 0.374, Loss_kd 1.423, Train_accy 55.57:  30%|███       | 6/20 [14:21<29:13, 125.28s/it]                 
Task 1, Epoch 7/20 => Loss 2.373, Loss_clf 0.293, Loss_fe 0.374, Loss_kd 1.423, Train_accy 55.57:  35%|███▌      | 7/20 [14:21<26:34, 122.67s/it]
Task 1, Epoch 8/20 => Loss 2.334, Loss_clf 0.283, Loss_fe 0.342, Loss_kd 1.425, Train_accy 56.17:  35%|███▌      | 7/20 [16:18<26:34, 122.67s/it]
Task 1, Epoch 8/20 => Loss 2.334, Loss_clf 0.283, Loss_fe 0.342, Loss_kd 1.425, Train_accy 56.17:  40%|████      | 8/20 [16:18<24:11, 120.98s/it]
Task 1, Epoch 9/20 => Loss 2.272, Loss_clf 0.260, Loss_fe 0.309, Loss_kd 1.419, Train_accy 57.41:  40%|████      | 8/20 [18:15<24:11, 120.98s/it]
Task 1, Epoch 9/20 => Loss 2.272, Loss_clf 0.260, Loss_fe 0.309, Loss_kd 1.419, Train_accy 57.41:  45%|████▌     | 9/20 [18:15<21:58, 119.85s/it]
Task 1, Epoch 10/20 => Loss 2.198, Loss_clf 0.231, Loss_fe 0.270, Loss_kd 1.414, Train_accy 58.21:  45%|████▌     | 9/20 [20:13<21:58, 119.85s/it]
Task 1, Epoch 10/20 => Loss 2.198, Loss_clf 0.231, Loss_fe 0.270, Loss_kd 1.414, Train_accy 58.21:  50%|█████     | 10/20 [20:13<19:50, 119.08s/it]
Task 1, Epoch 11/20 => Loss 2.207, Loss_clf 0.236, Loss_fe 0.272, Loss_kd 1.416, Train_accy 57.16, Test_accy 80.65:  50%|█████     | 10/20 [22:30<19:50, 119.08s/it]
Task 1, Epoch 11/20 => Loss 2.207, Loss_clf 0.236, Loss_fe 0.272, Loss_kd 1.416, Train_accy 57.16, Test_accy 80.65:  55%|█████▌    | 11/20 [22:30<18:42, 124.67s/it]
Task 1, Epoch 12/20 => Loss 2.113, Loss_clf 0.194, Loss_fe 0.227, Loss_kd 1.410, Train_accy 58.80:  55%|█████▌    | 11/20 [24:27<18:42, 124.67s/it]                 
Task 1, Epoch 12/20 => Loss 2.113, Loss_clf 0.194, Loss_fe 0.227, Loss_kd 1.410, Train_accy 58.80:  60%|██████    | 12/20 [24:27<16:19, 122.44s/it]
Task 1, Epoch 13/20 => Loss 2.113, Loss_clf 0.200, Loss_fe 0.223, Loss_kd 1.408, Train_accy 59.36:  60%|██████    | 12/20 [26:25<16:19, 122.44s/it]
Task 1, Epoch 13/20 => Loss 2.113, Loss_clf 0.200, Loss_fe 0.223, Loss_kd 1.408, Train_accy 59.36:  65%|██████▌   | 13/20 [26:25<14:06, 120.90s/it]
Task 1, Epoch 14/20 => Loss 2.114, Loss_clf 0.198, Loss_fe 0.220, Loss_kd 1.413, Train_accy 58.38:  65%|██████▌   | 13/20 [28:22<14:06, 120.90s/it]
Task 1, Epoch 14/20 => Loss 2.114, Loss_clf 0.198, Loss_fe 0.220, Loss_kd 1.413, Train_accy 58.38:  70%|███████   | 14/20 [28:22<11:58, 119.81s/it]
Task 1, Epoch 15/20 => Loss 2.107, Loss_clf 0.195, Loss_fe 0.199, Loss_kd 1.428, Train_accy 59.34:  70%|███████   | 14/20 [30:19<11:58, 119.81s/it]
Task 1, Epoch 15/20 => Loss 2.107, Loss_clf 0.195, Loss_fe 0.199, Loss_kd 1.428, Train_accy 59.34:  75%|███████▌  | 15/20 [30:19<09:55, 119.06s/it]
Task 1, Epoch 16/20 => Loss 2.082, Loss_clf 0.182, Loss_fe 0.190, Loss_kd 1.424, Train_accy 60.02, Test_accy 80.62:  75%|███████▌  | 15/20 [32:37<09:55, 119.06s/it]
Task 1, Epoch 16/20 => Loss 2.082, Loss_clf 0.182, Loss_fe 0.190, Loss_kd 1.424, Train_accy 60.02, Test_accy 80.62:  80%|████████  | 16/20 [32:37<08:18, 124.51s/it]
Task 1, Epoch 17/20 => Loss 2.057, Loss_clf 0.174, Loss_fe 0.183, Loss_kd 1.416, Train_accy 59.77:  80%|████████  | 16/20 [34:34<08:18, 124.51s/it]                 
Task 1, Epoch 17/20 => Loss 2.057, Loss_clf 0.174, Loss_fe 0.183, Loss_kd 1.416, Train_accy 59.77:  85%|████████▌ | 17/20 [34:34<06:07, 122.36s/it]
Task 1, Epoch 18/20 => Loss 2.054, Loss_clf 0.174, Loss_fe 0.176, Loss_kd 1.420, Train_accy 60.28:  85%|████████▌ | 17/20 [36:31<06:07, 122.36s/it]
Task 1, Epoch 18/20 => Loss 2.054, Loss_clf 0.174, Loss_fe 0.176, Loss_kd 1.420, Train_accy 60.28:  90%|█████████ | 18/20 [36:31<04:01, 120.84s/it]
Task 1, Epoch 19/20 => Loss 2.034, Loss_clf 0.170, Loss_fe 0.172, Loss_kd 1.410, Train_accy 59.97:  90%|█████████ | 18/20 [38:29<04:01, 120.84s/it]
Task 1, Epoch 19/20 => Loss 2.034, Loss_clf 0.170, Loss_fe 0.172, Loss_kd 1.410, Train_accy 59.97:  95%|█████████▌| 19/20 [38:29<01:59, 119.77s/it]
Task 1, Epoch 20/20 => Loss 2.036, Loss_clf 0.170, Loss_fe 0.176, Loss_kd 1.409, Train_accy 60.71:  95%|█████████▌| 19/20 [40:26<01:59, 119.77s/it]
Task 1, Epoch 20/20 => Loss 2.036, Loss_clf 0.170, Loss_fe 0.176, Loss_kd 1.409, Train_accy 60.71: 100%|██████████| 20/20 [40:26<00:00, 119.05s/it]
Task 1, Epoch 20/20 => Loss 2.036, Loss_clf 0.170, Loss_fe 0.176, Loss_kd 1.409, Train_accy 60.71: 100%|██████████| 20/20 [40:26<00:00, 121.32s/it]
2024-04-27 09:37:35,402 [foster.py] => Task 1, Epoch 20/20 => Loss 2.036, Loss_clf 0.170, Loss_fe 0.176, Loss_kd 1.409, Train_accy 60.71
2024-04-27 09:37:35,403 [foster.py] => do not weight align teacher!
2024-04-27 09:37:35,407 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.633,  Train_accy 45.68, Test_accy 79.54:   0%|          | 0/20 [02:38<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.633,  Train_accy 45.68, Test_accy 79.54:   5%|▌         | 1/20 [02:38<50:12, 158.58s/it]
SNet: Task 1, Epoch 2/20 => Loss 1.509,  Train_accy 49.76:   5%|▌         | 1/20 [05:06<50:12, 158.58s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 1.509,  Train_accy 49.76:  10%|█         | 2/20 [05:06<45:40, 152.25s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.495,  Train_accy 49.71:  10%|█         | 2/20 [07:34<45:40, 152.25s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.495,  Train_accy 49.71:  15%|█▌        | 3/20 [07:34<42:33, 150.22s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.479,  Train_accy 49.96:  15%|█▌        | 3/20 [10:01<42:33, 150.22s/it]
SNet: Task 1, Epoch 4/20 => Loss 1.479,  Train_accy 49.96:  20%|██        | 4/20 [10:01<39:48, 149.26s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.459,  Train_accy 50.18:  20%|██        | 4/20 [12:29<39:48, 149.26s/it]
SNet: Task 1, Epoch 5/20 => Loss 1.459,  Train_accy 50.18:  25%|██▌       | 5/20 [12:29<37:11, 148.73s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.465,  Train_accy 50.38, Test_accy 79.29:  25%|██▌       | 5/20 [15:08<37:11, 148.73s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.465,  Train_accy 50.38, Test_accy 79.29:  30%|███       | 6/20 [15:08<35:28, 152.03s/it]
SNet: Task 1, Epoch 7/20 => Loss 1.464,  Train_accy 50.22:  30%|███       | 6/20 [17:35<35:28, 152.03s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 1.464,  Train_accy 50.22:  35%|███▌      | 7/20 [17:35<32:38, 150.63s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.463,  Train_accy 50.52:  35%|███▌      | 7/20 [20:03<32:38, 150.63s/it]
SNet: Task 1, Epoch 8/20 => Loss 1.463,  Train_accy 50.52:  40%|████      | 8/20 [20:03<29:56, 149.73s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.473,  Train_accy 50.79:  40%|████      | 8/20 [22:31<29:56, 149.73s/it]
SNet: Task 1, Epoch 9/20 => Loss 1.473,  Train_accy 50.79:  45%|████▌     | 9/20 [22:31<27:20, 149.13s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.450,  Train_accy 50.68:  45%|████▌     | 9/20 [24:59<27:20, 149.13s/it]
SNet: Task 1, Epoch 10/20 => Loss 1.450,  Train_accy 50.68:  50%|█████     | 10/20 [24:59<24:46, 148.69s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.459,  Train_accy 50.56, Test_accy 79.26:  50%|█████     | 10/20 [27:37<24:46, 148.69s/it]
SNet: Task 1, Epoch 11/20 => Loss 1.459,  Train_accy 50.56, Test_accy 79.26:  55%|█████▌    | 11/20 [27:37<22:45, 151.74s/it]
SNet: Task 1, Epoch 12/20 => Loss 1.446,  Train_accy 50.91:  55%|█████▌    | 11/20 [30:05<22:45, 151.74s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 1.446,  Train_accy 50.91:  60%|██████    | 12/20 [30:05<20:04, 150.54s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.447,  Train_accy 50.82:  60%|██████    | 12/20 [32:33<20:04, 150.54s/it]
SNet: Task 1, Epoch 13/20 => Loss 1.447,  Train_accy 50.82:  65%|██████▌   | 13/20 [32:33<17:27, 149.71s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.450,  Train_accy 50.66:  65%|██████▌   | 13/20 [35:01<17:27, 149.71s/it]
SNet: Task 1, Epoch 14/20 => Loss 1.450,  Train_accy 50.66:  70%|███████   | 14/20 [35:01<14:54, 149.13s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.443,  Train_accy 50.63:  70%|███████   | 14/20 [37:29<14:54, 149.13s/it]
SNet: Task 1, Epoch 15/20 => Loss 1.443,  Train_accy 50.63:  75%|███████▌  | 15/20 [37:29<12:23, 148.72s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.434,  Train_accy 51.11, Test_accy 79.48:  75%|███████▌  | 15/20 [40:07<12:23, 148.72s/it]
SNet: Task 1, Epoch 16/20 => Loss 1.434,  Train_accy 51.11, Test_accy 79.48:  80%|████████  | 16/20 [40:07<10:06, 151.66s/it]
SNet: Task 1, Epoch 17/20 => Loss 1.445,  Train_accy 50.71:  80%|████████  | 16/20 [42:35<10:06, 151.66s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 1.445,  Train_accy 50.71:  85%|████████▌ | 17/20 [42:35<07:31, 150.51s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.444,  Train_accy 50.79:  85%|████████▌ | 17/20 [45:03<07:31, 150.51s/it]
SNet: Task 1, Epoch 18/20 => Loss 1.444,  Train_accy 50.79:  90%|█████████ | 18/20 [45:03<04:59, 149.71s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.439,  Train_accy 51.15:  90%|█████████ | 18/20 [47:31<04:59, 149.71s/it]
SNet: Task 1, Epoch 19/20 => Loss 1.439,  Train_accy 51.15:  95%|█████████▌| 19/20 [47:31<02:29, 149.13s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.432,  Train_accy 51.40:  95%|█████████▌| 19/20 [49:58<02:29, 149.13s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.432,  Train_accy 51.40: 100%|██████████| 20/20 [49:58<00:00, 148.75s/it]
SNet: Task 1, Epoch 20/20 => Loss 1.432,  Train_accy 51.40: 100%|██████████| 20/20 [49:58<00:00, 149.95s/it]
2024-04-27 10:27:35,784 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 1.432,  Train_accy 51.40
2024-04-27 10:27:35,784 [foster.py] => do not weight align student!
2024-04-27 10:27:46,551 [foster.py] => darknet eval: 
2024-04-27 10:27:46,551 [foster.py] => CNN top1 curve: 79.54
2024-04-27 10:27:46,551 [foster.py] => CNN top5 curve: 96.24
2024-04-27 10:27:46,553 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 10:31:08,795 [foster.py] => Exemplar size: 3600
2024-04-27 10:31:08,796 [trainer.py] => CNN: {'total': 80.54, '00-149': 86.87, '150-179': 48.83, 'old': 86.87, 'new': 48.83}
2024-04-27 10:31:08,796 [trainer.py] => NME: {'total': 83.77, '00-149': 83.53, '150-179': 84.95, 'old': 83.53, 'new': 84.95}
2024-04-27 10:31:08,796 [trainer.py] => CNN top1 curve: [87.71, 80.54]
2024-04-27 10:31:08,796 [trainer.py] => CNN top5 curve: [97.6, 97.1]
2024-04-27 10:31:08,796 [trainer.py] => NME top1 curve: [86.97, 83.77]
2024-04-27 10:31:08,796 [trainer.py] => NME top5 curve: [97.76, 96.94]

Average Accuracy (CNN): 84.12
Average Accuracy (NME): 85.37
2024-04-27 10:31:08,796 [trainer.py] => Average Accuracy (CNN): 84.12
2024-04-27 10:31:08,796 [trainer.py] => Average Accuracy (NME): 85.37
2024-04-27 10:31:08,796 [trainer.py] => Train Time: 11980.67
2024-04-27 10:31:08,796 [trainer.py] => Test Time: 59.349999999999994 

2024-04-27 10:31:08,797 [trainer.py] => All params: 172127742
2024-04-27 10:31:08,798 [trainer.py] => Trainable params: 86213736
2024-04-27 10:31:10,297 [foster.py] => Learning on 180-210
2024-04-27 10:31:10,298 [foster.py] => All params: 172219992
2024-04-27 10:31:10,299 [foster.py] => Trainable params: 86282916
2024-04-27 10:31:10,364 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 4.828, Loss_clf 1.097, Loss_fe 1.818, Loss_kd 1.640, Train_accy 52.16, Test_accy 77.27:   0%|          | 0/20 [02:48<?, ?it/s]
Task 2, Epoch 1/20 => Loss 4.828, Loss_clf 1.097, Loss_fe 1.818, Loss_kd 1.640, Train_accy 52.16, Test_accy 77.27:   5%|▌         | 1/20 [02:48<53:26, 168.75s/it]
Task 2, Epoch 2/20 => Loss 3.290, Loss_clf 0.595, Loss_fe 0.802, Loss_kd 1.622, Train_accy 54.18:   5%|▌         | 1/20 [05:16<53:26, 168.75s/it]                 
Task 2, Epoch 2/20 => Loss 3.290, Loss_clf 0.595, Loss_fe 0.802, Loss_kd 1.622, Train_accy 54.18:  10%|█         | 2/20 [05:16<46:53, 156.30s/it]
Task 2, Epoch 3/20 => Loss 3.036, Loss_clf 0.506, Loss_fe 0.646, Loss_kd 1.614, Train_accy 56.06:  10%|█         | 2/20 [07:43<46:53, 156.30s/it]
Task 2, Epoch 3/20 => Loss 3.036, Loss_clf 0.506, Loss_fe 0.646, Loss_kd 1.614, Train_accy 56.06:  15%|█▌        | 3/20 [07:43<43:08, 152.25s/it]
Task 2, Epoch 4/20 => Loss 2.969, Loss_clf 0.480, Loss_fe 0.590, Loss_kd 1.627, Train_accy 56.04:  15%|█▌        | 3/20 [10:10<43:08, 152.25s/it]
Task 2, Epoch 4/20 => Loss 2.969, Loss_clf 0.480, Loss_fe 0.590, Loss_kd 1.627, Train_accy 56.04:  20%|██        | 4/20 [10:10<40:04, 150.26s/it]
Task 2, Epoch 5/20 => Loss 2.869, Loss_clf 0.414, Loss_fe 0.561, Loss_kd 1.623, Train_accy 57.46:  20%|██        | 4/20 [12:38<40:04, 150.26s/it]
Task 2, Epoch 5/20 => Loss 2.869, Loss_clf 0.414, Loss_fe 0.561, Loss_kd 1.623, Train_accy 57.46:  25%|██▌       | 5/20 [12:38<37:20, 149.34s/it]
Task 2, Epoch 6/20 => Loss 2.738, Loss_clf 0.390, Loss_fe 0.468, Loss_kd 1.611, Train_accy 58.49, Test_accy 78.61:  25%|██▌       | 5/20 [15:36<37:20, 149.34s/it]
Task 2, Epoch 6/20 => Loss 2.738, Loss_clf 0.390, Loss_fe 0.468, Loss_kd 1.611, Train_accy 58.49, Test_accy 78.61:  30%|███       | 6/20 [15:36<37:06, 159.00s/it]
Task 2, Epoch 7/20 => Loss 2.637, Loss_clf 0.343, Loss_fe 0.415, Loss_kd 1.611, Train_accy 60.13:  30%|███       | 6/20 [18:04<37:06, 159.00s/it]                 
Task 2, Epoch 7/20 => Loss 2.637, Loss_clf 0.343, Loss_fe 0.415, Loss_kd 1.611, Train_accy 60.13:  35%|███▌      | 7/20 [18:04<33:39, 155.33s/it]
Task 2, Epoch 8/20 => Loss 2.572, Loss_clf 0.319, Loss_fe 0.374, Loss_kd 1.611, Train_accy 59.77:  35%|███▌      | 7/20 [20:31<33:39, 155.33s/it]
Task 2, Epoch 8/20 => Loss 2.572, Loss_clf 0.319, Loss_fe 0.374, Loss_kd 1.611, Train_accy 59.77:  40%|████      | 8/20 [20:31<30:33, 152.83s/it]
Task 2, Epoch 9/20 => Loss 2.550, Loss_clf 0.304, Loss_fe 0.343, Loss_kd 1.631, Train_accy 60.44:  40%|████      | 8/20 [22:59<30:33, 152.83s/it]
Task 2, Epoch 9/20 => Loss 2.550, Loss_clf 0.304, Loss_fe 0.343, Loss_kd 1.631, Train_accy 60.44:  45%|████▌     | 9/20 [22:59<27:44, 151.32s/it]
Task 2, Epoch 10/20 => Loss 2.528, Loss_clf 0.298, Loss_fe 0.338, Loss_kd 1.622, Train_accy 60.23:  45%|████▌     | 9/20 [25:27<27:44, 151.32s/it]
Task 2, Epoch 10/20 => Loss 2.528, Loss_clf 0.298, Loss_fe 0.338, Loss_kd 1.622, Train_accy 60.23:  50%|█████     | 10/20 [25:27<25:02, 150.21s/it]
Task 2, Epoch 11/20 => Loss 2.413, Loss_clf 0.257, Loss_fe 0.287, Loss_kd 1.602, Train_accy 60.82, Test_accy 78.47:  50%|█████     | 10/20 [28:08<25:02, 150.21s/it]
Task 2, Epoch 11/20 => Loss 2.413, Loss_clf 0.257, Loss_fe 0.287, Loss_kd 1.602, Train_accy 60.82, Test_accy 78.47:  55%|█████▌    | 11/20 [28:08<23:02, 153.66s/it]
Task 2, Epoch 12/20 => Loss 2.384, Loss_clf 0.242, Loss_fe 0.266, Loss_kd 1.607, Train_accy 60.69:  55%|█████▌    | 11/20 [30:11<23:02, 153.66s/it]                 
Task 2, Epoch 12/20 => Loss 2.384, Loss_clf 0.242, Loss_fe 0.266, Loss_kd 1.607, Train_accy 60.69:  60%|██████    | 12/20 [30:11<19:14, 144.31s/it]
Task 2, Epoch 13/20 => Loss 2.400, Loss_clf 0.251, Loss_fe 0.255, Loss_kd 1.623, Train_accy 61.87:  60%|██████    | 12/20 [32:14<19:14, 144.31s/it]
Task 2, Epoch 13/20 => Loss 2.400, Loss_clf 0.251, Loss_fe 0.255, Loss_kd 1.623, Train_accy 61.87:  65%|██████▌   | 13/20 [32:14<16:04, 137.84s/it]
Task 2, Epoch 14/20 => Loss 2.333, Loss_clf 0.225, Loss_fe 0.227, Loss_kd 1.612, Train_accy 61.86:  65%|██████▌   | 13/20 [34:17<16:04, 137.84s/it]
Task 2, Epoch 14/20 => Loss 2.333, Loss_clf 0.225, Loss_fe 0.227, Loss_kd 1.612, Train_accy 61.86:  70%|███████   | 14/20 [34:17<13:20, 133.35s/it]
Task 2, Epoch 15/20 => Loss 2.361, Loss_clf 0.234, Loss_fe 0.233, Loss_kd 1.623, Train_accy 62.57:  70%|███████   | 14/20 [36:20<13:20, 133.35s/it]
Task 2, Epoch 15/20 => Loss 2.361, Loss_clf 0.234, Loss_fe 0.233, Loss_kd 1.623, Train_accy 62.57:  75%|███████▌  | 15/20 [36:20<10:51, 130.23s/it]
Task 2, Epoch 16/20 => Loss 2.283, Loss_clf 0.205, Loss_fe 0.201, Loss_kd 1.608, Train_accy 62.88, Test_accy 78.75:  75%|███████▌  | 15/20 [38:46<10:51, 130.23s/it]
Task 2, Epoch 16/20 => Loss 2.283, Loss_clf 0.205, Loss_fe 0.201, Loss_kd 1.608, Train_accy 62.88, Test_accy 78.75:  80%|████████  | 16/20 [38:46<08:59, 135.00s/it]
Task 2, Epoch 17/20 => Loss 2.267, Loss_clf 0.202, Loss_fe 0.190, Loss_kd 1.607, Train_accy 62.99:  80%|████████  | 16/20 [40:49<08:59, 135.00s/it]                 
Task 2, Epoch 17/20 => Loss 2.267, Loss_clf 0.202, Loss_fe 0.190, Loss_kd 1.607, Train_accy 62.99:  85%|████████▌ | 17/20 [40:49<06:33, 131.33s/it]
Task 2, Epoch 18/20 => Loss 2.284, Loss_clf 0.210, Loss_fe 0.201, Loss_kd 1.605, Train_accy 62.65:  85%|████████▌ | 17/20 [42:52<06:33, 131.33s/it]
Task 2, Epoch 18/20 => Loss 2.284, Loss_clf 0.210, Loss_fe 0.201, Loss_kd 1.605, Train_accy 62.65:  90%|█████████ | 18/20 [42:52<04:17, 128.76s/it]
Task 2, Epoch 19/20 => Loss 2.268, Loss_clf 0.198, Loss_fe 0.185, Loss_kd 1.616, Train_accy 63.24:  90%|█████████ | 18/20 [44:55<04:17, 128.76s/it]
Task 2, Epoch 19/20 => Loss 2.268, Loss_clf 0.198, Loss_fe 0.185, Loss_kd 1.616, Train_accy 63.24:  95%|█████████▌| 19/20 [44:55<02:06, 126.96s/it]
Task 2, Epoch 20/20 => Loss 2.284, Loss_clf 0.205, Loss_fe 0.194, Loss_kd 1.616, Train_accy 62.40:  95%|█████████▌| 19/20 [46:57<02:06, 126.96s/it]
Task 2, Epoch 20/20 => Loss 2.284, Loss_clf 0.205, Loss_fe 0.194, Loss_kd 1.616, Train_accy 62.40: 100%|██████████| 20/20 [46:57<00:00, 125.66s/it]
Task 2, Epoch 20/20 => Loss 2.284, Loss_clf 0.205, Loss_fe 0.194, Loss_kd 1.616, Train_accy 62.40: 100%|██████████| 20/20 [46:57<00:00, 140.89s/it]
2024-04-27 11:18:08,162 [foster.py] => Task 2, Epoch 20/20 => Loss 2.284, Loss_clf 0.205, Loss_fe 0.194, Loss_kd 1.616, Train_accy 62.40
2024-04-27 11:18:08,163 [foster.py] => do not weight align teacher!
2024-04-27 11:18:08,173 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.867,  Train_accy 46.83, Test_accy 76.99:   0%|          | 0/20 [02:47<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.867,  Train_accy 46.83, Test_accy 76.99:   5%|▌         | 1/20 [02:47<52:56, 167.21s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.743,  Train_accy 50.97:   5%|▌         | 1/20 [05:21<52:56, 167.21s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.743,  Train_accy 50.97:  10%|█         | 2/20 [05:21<47:58, 159.89s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.708,  Train_accy 51.68:  10%|█         | 2/20 [07:56<47:58, 159.89s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.708,  Train_accy 51.68:  15%|█▌        | 3/20 [07:56<44:38, 157.56s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.705,  Train_accy 52.63:  15%|█▌        | 3/20 [10:31<44:38, 157.56s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.705,  Train_accy 52.63:  20%|██        | 4/20 [10:31<41:43, 156.47s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.701,  Train_accy 53.03:  20%|██        | 4/20 [13:06<41:43, 156.47s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.701,  Train_accy 53.03:  25%|██▌       | 5/20 [13:06<38:58, 155.88s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.696,  Train_accy 52.67, Test_accy 77.49:  25%|██▌       | 5/20 [15:53<38:58, 155.88s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.696,  Train_accy 52.67, Test_accy 77.49:  30%|███       | 6/20 [15:53<37:17, 159.79s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.669,  Train_accy 53.09:  30%|███       | 6/20 [18:28<37:17, 159.79s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.669,  Train_accy 53.09:  35%|███▌      | 7/20 [18:28<34:16, 158.18s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.668,  Train_accy 52.93:  35%|███▌      | 7/20 [21:03<34:16, 158.18s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.668,  Train_accy 52.93:  40%|████      | 8/20 [21:03<31:25, 157.10s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.688,  Train_accy 53.23:  40%|████      | 8/20 [23:38<31:25, 157.10s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.688,  Train_accy 53.23:  45%|████▌     | 9/20 [23:38<28:39, 156.34s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.683,  Train_accy 53.48:  45%|████▌     | 9/20 [26:12<28:39, 156.34s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.683,  Train_accy 53.48:  50%|█████     | 10/20 [26:12<25:58, 155.81s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.680,  Train_accy 53.31, Test_accy 77.63:  50%|█████     | 10/20 [28:59<25:58, 155.81s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.680,  Train_accy 53.31, Test_accy 77.63:  55%|█████▌    | 11/20 [28:59<23:52, 159.19s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.664,  Train_accy 53.22:  55%|█████▌    | 11/20 [31:34<23:52, 159.19s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.664,  Train_accy 53.22:  60%|██████    | 12/20 [31:34<21:02, 157.83s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.658,  Train_accy 53.40:  60%|██████    | 12/20 [34:09<21:02, 157.83s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.658,  Train_accy 53.40:  65%|██████▌   | 13/20 [34:09<18:18, 156.90s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.675,  Train_accy 53.04:  65%|██████▌   | 13/20 [36:45<18:18, 156.90s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.675,  Train_accy 53.04:  70%|███████   | 14/20 [36:45<15:40, 156.68s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.675,  Train_accy 52.99:  70%|███████   | 14/20 [39:20<15:40, 156.68s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.675,  Train_accy 52.99:  75%|███████▌  | 15/20 [39:20<13:00, 156.13s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.680,  Train_accy 52.92, Test_accy 77.80:  75%|███████▌  | 15/20 [42:07<13:00, 156.13s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.680,  Train_accy 52.92, Test_accy 77.80:  80%|████████  | 16/20 [42:07<10:38, 159.58s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.676,  Train_accy 53.23:  80%|████████  | 16/20 [44:42<10:38, 159.58s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.676,  Train_accy 53.23:  85%|████████▌ | 17/20 [44:42<07:54, 158.14s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.656,  Train_accy 53.50:  85%|████████▌ | 17/20 [47:17<07:54, 158.14s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.656,  Train_accy 53.50:  90%|█████████ | 18/20 [47:17<05:14, 157.12s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.677,  Train_accy 53.68:  90%|█████████ | 18/20 [49:51<05:14, 157.12s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.677,  Train_accy 53.68:  95%|█████████▌| 19/20 [49:51<02:36, 156.40s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.673,  Train_accy 53.57:  95%|█████████▌| 19/20 [52:26<02:36, 156.40s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.673,  Train_accy 53.57: 100%|██████████| 20/20 [52:26<00:00, 155.85s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.673,  Train_accy 53.57: 100%|██████████| 20/20 [52:26<00:00, 157.33s/it]
2024-04-27 12:10:36,231 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.673,  Train_accy 53.57
2024-04-27 12:10:36,232 [foster.py] => do not weight align student!
2024-04-27 12:10:48,619 [foster.py] => darknet eval: 
2024-04-27 12:10:48,620 [foster.py] => CNN top1 curve: 77.73
2024-04-27 12:10:48,620 [foster.py] => CNN top5 curve: 95.54
2024-04-27 12:10:48,623 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 12:14:41,337 [foster.py] => Exemplar size: 4200
2024-04-27 12:14:41,337 [trainer.py] => CNN: {'total': 78.75, '00-149': 86.57, '150-179': 68.06, '180-209': 50.25, 'old': 83.49, 'new': 50.25}
2024-04-27 12:14:41,337 [trainer.py] => NME: {'total': 81.98, '00-149': 83.2, '150-179': 72.91, '180-209': 84.92, 'old': 81.49, 'new': 84.92}
2024-04-27 12:14:41,338 [trainer.py] => CNN top1 curve: [87.71, 80.54, 78.75]
2024-04-27 12:14:41,338 [trainer.py] => CNN top5 curve: [97.6, 97.1, 96.08]
2024-04-27 12:14:41,338 [trainer.py] => NME top1 curve: [86.97, 83.77, 81.98]
2024-04-27 12:14:41,338 [trainer.py] => NME top5 curve: [97.76, 96.94, 96.51]

Average Accuracy (CNN): 82.33
Average Accuracy (NME): 84.24
2024-04-27 12:14:41,338 [trainer.py] => Average Accuracy (CNN): 82.33
2024-04-27 12:14:41,338 [trainer.py] => Average Accuracy (NME): 84.24
2024-04-27 12:14:41,338 [trainer.py] => Train Time: 17958.98
2024-04-27 12:14:41,338 [trainer.py] => Test Time: 106.32999999999998 

2024-04-27 12:14:41,339 [trainer.py] => All params: 172219992
2024-04-27 12:14:41,340 [trainer.py] => Trainable params: 86282916
2024-04-27 12:14:42,920 [foster.py] => Learning on 210-240
2024-04-27 12:14:42,922 [foster.py] => All params: 172312242
2024-04-27 12:14:42,923 [foster.py] => Trainable params: 86352096
2024-04-27 12:14:42,984 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 4.933, Loss_clf 1.173, Loss_fe 1.956, Loss_kd 1.579, Train_accy 45.83, Test_accy 75.15:   0%|          | 0/20 [02:39<?, ?it/s]
Task 3, Epoch 1/20 => Loss 4.933, Loss_clf 1.173, Loss_fe 1.956, Loss_kd 1.579, Train_accy 45.83, Test_accy 75.15:   5%|▌         | 1/20 [02:39<50:39, 159.97s/it]
Task 3, Epoch 2/20 => Loss 3.383, Loss_clf 0.667, Loss_fe 0.904, Loss_kd 1.585, Train_accy 47.23:   5%|▌         | 1/20 [04:53<50:39, 159.97s/it]                 
Task 3, Epoch 2/20 => Loss 3.383, Loss_clf 0.667, Loss_fe 0.904, Loss_kd 1.585, Train_accy 47.23:  10%|█         | 2/20 [04:53<43:20, 144.45s/it]
Task 3, Epoch 3/20 => Loss 3.127, Loss_clf 0.576, Loss_fe 0.749, Loss_kd 1.577, Train_accy 47.66:  10%|█         | 2/20 [07:07<43:20, 144.45s/it]
Task 3, Epoch 3/20 => Loss 3.127, Loss_clf 0.576, Loss_fe 0.749, Loss_kd 1.577, Train_accy 47.66:  15%|█▌        | 3/20 [07:07<39:31, 139.49s/it]
Task 3, Epoch 4/20 => Loss 2.932, Loss_clf 0.506, Loss_fe 0.631, Loss_kd 1.571, Train_accy 48.74:  15%|█▌        | 3/20 [09:20<39:31, 139.49s/it]
Task 3, Epoch 4/20 => Loss 2.932, Loss_clf 0.506, Loss_fe 0.631, Loss_kd 1.571, Train_accy 48.74:  20%|██        | 4/20 [09:20<36:33, 137.12s/it]
Task 3, Epoch 5/20 => Loss 2.832, Loss_clf 0.477, Loss_fe 0.574, Loss_kd 1.558, Train_accy 48.89:  20%|██        | 4/20 [11:34<36:33, 137.12s/it]
Task 3, Epoch 5/20 => Loss 2.832, Loss_clf 0.477, Loss_fe 0.574, Loss_kd 1.558, Train_accy 48.89:  25%|██▌       | 5/20 [11:34<33:57, 135.81s/it]
Task 3, Epoch 6/20 => Loss 2.763, Loss_clf 0.448, Loss_fe 0.522, Loss_kd 1.569, Train_accy 49.91, Test_accy 75.63:  25%|██▌       | 5/20 [14:14<33:57, 135.81s/it]
Task 3, Epoch 6/20 => Loss 2.763, Loss_clf 0.448, Loss_fe 0.522, Loss_kd 1.569, Train_accy 49.91, Test_accy 75.63:  30%|███       | 6/20 [14:14<33:36, 144.03s/it]
Task 3, Epoch 7/20 => Loss 2.668, Loss_clf 0.412, Loss_fe 0.474, Loss_kd 1.559, Train_accy 49.40:  30%|███       | 6/20 [16:27<33:36, 144.03s/it]                 
Task 3, Epoch 7/20 => Loss 2.668, Loss_clf 0.412, Loss_fe 0.474, Loss_kd 1.559, Train_accy 49.40:  35%|███▌      | 7/20 [16:27<30:27, 140.59s/it]
Task 3, Epoch 8/20 => Loss 2.603, Loss_clf 0.383, Loss_fe 0.427, Loss_kd 1.569, Train_accy 50.45:  35%|███▌      | 7/20 [18:41<30:27, 140.59s/it]
Task 3, Epoch 8/20 => Loss 2.603, Loss_clf 0.383, Loss_fe 0.427, Loss_kd 1.569, Train_accy 50.45:  40%|████      | 8/20 [18:41<27:39, 138.33s/it]
Task 3, Epoch 9/20 => Loss 2.498, Loss_clf 0.343, Loss_fe 0.370, Loss_kd 1.561, Train_accy 51.54:  40%|████      | 8/20 [20:54<27:39, 138.33s/it]
Task 3, Epoch 9/20 => Loss 2.498, Loss_clf 0.343, Loss_fe 0.370, Loss_kd 1.561, Train_accy 51.54:  45%|████▌     | 9/20 [20:54<25:05, 136.89s/it]
Task 3, Epoch 10/20 => Loss 2.514, Loss_clf 0.344, Loss_fe 0.370, Loss_kd 1.576, Train_accy 51.97:  45%|████▌     | 9/20 [23:08<25:05, 136.89s/it]
Task 3, Epoch 10/20 => Loss 2.514, Loss_clf 0.344, Loss_fe 0.370, Loss_kd 1.576, Train_accy 51.97:  50%|█████     | 10/20 [23:08<22:38, 135.86s/it]
Task 3, Epoch 11/20 => Loss 2.425, Loss_clf 0.309, Loss_fe 0.321, Loss_kd 1.571, Train_accy 52.76, Test_accy 75.61:  50%|█████     | 10/20 [25:48<22:38, 135.86s/it]
Task 3, Epoch 11/20 => Loss 2.425, Loss_clf 0.309, Loss_fe 0.321, Loss_kd 1.571, Train_accy 52.76, Test_accy 75.61:  55%|█████▌    | 11/20 [25:48<21:28, 143.15s/it]
Task 3, Epoch 12/20 => Loss 2.374, Loss_clf 0.291, Loss_fe 0.296, Loss_kd 1.564, Train_accy 53.08:  55%|█████▌    | 11/20 [28:01<21:28, 143.15s/it]                 
Task 3, Epoch 12/20 => Loss 2.374, Loss_clf 0.291, Loss_fe 0.296, Loss_kd 1.564, Train_accy 53.08:  60%|██████    | 12/20 [28:01<18:41, 140.14s/it]
Task 3, Epoch 13/20 => Loss 2.364, Loss_clf 0.283, Loss_fe 0.287, Loss_kd 1.569, Train_accy 52.33:  60%|██████    | 12/20 [30:14<18:41, 140.14s/it]
Task 3, Epoch 13/20 => Loss 2.364, Loss_clf 0.283, Loss_fe 0.287, Loss_kd 1.569, Train_accy 52.33:  65%|██████▌   | 13/20 [30:14<16:06, 138.04s/it]
Task 3, Epoch 14/20 => Loss 2.281, Loss_clf 0.250, Loss_fe 0.250, Loss_kd 1.559, Train_accy 53.05:  65%|██████▌   | 13/20 [32:27<16:06, 138.04s/it]
Task 3, Epoch 14/20 => Loss 2.281, Loss_clf 0.250, Loss_fe 0.250, Loss_kd 1.559, Train_accy 53.05:  70%|███████   | 14/20 [32:27<13:39, 136.58s/it]
Task 3, Epoch 15/20 => Loss 2.304, Loss_clf 0.251, Loss_fe 0.253, Loss_kd 1.575, Train_accy 53.07:  70%|███████   | 14/20 [34:41<13:39, 136.58s/it]
Task 3, Epoch 15/20 => Loss 2.304, Loss_clf 0.251, Loss_fe 0.253, Loss_kd 1.575, Train_accy 53.07:  75%|███████▌  | 15/20 [34:41<11:17, 135.59s/it]
Task 3, Epoch 16/20 => Loss 2.259, Loss_clf 0.238, Loss_fe 0.230, Loss_kd 1.568, Train_accy 54.30, Test_accy 75.48:  75%|███████▌  | 15/20 [37:20<11:17, 135.59s/it]
Task 3, Epoch 16/20 => Loss 2.259, Loss_clf 0.238, Loss_fe 0.230, Loss_kd 1.568, Train_accy 54.30, Test_accy 75.48:  80%|████████  | 16/20 [37:20<09:31, 142.90s/it]
Task 3, Epoch 17/20 => Loss 2.226, Loss_clf 0.228, Loss_fe 0.217, Loss_kd 1.558, Train_accy 54.36:  80%|████████  | 16/20 [39:34<09:31, 142.90s/it]                 
Task 3, Epoch 17/20 => Loss 2.226, Loss_clf 0.228, Loss_fe 0.217, Loss_kd 1.558, Train_accy 54.36:  85%|████████▌ | 17/20 [39:34<07:00, 140.04s/it]
Task 3, Epoch 18/20 => Loss 2.225, Loss_clf 0.225, Loss_fe 0.209, Loss_kd 1.567, Train_accy 54.37:  85%|████████▌ | 17/20 [41:47<07:00, 140.04s/it]
Task 3, Epoch 18/20 => Loss 2.225, Loss_clf 0.225, Loss_fe 0.209, Loss_kd 1.567, Train_accy 54.37:  90%|█████████ | 18/20 [41:47<04:36, 138.08s/it]
Task 3, Epoch 19/20 => Loss 2.234, Loss_clf 0.232, Loss_fe 0.213, Loss_kd 1.566, Train_accy 54.66:  90%|█████████ | 18/20 [44:01<04:36, 138.08s/it]
Task 3, Epoch 19/20 => Loss 2.234, Loss_clf 0.232, Loss_fe 0.213, Loss_kd 1.566, Train_accy 54.66:  95%|█████████▌| 19/20 [44:01<02:16, 136.70s/it]
Task 3, Epoch 20/20 => Loss 2.226, Loss_clf 0.225, Loss_fe 0.210, Loss_kd 1.567, Train_accy 54.62:  95%|█████████▌| 19/20 [46:14<02:16, 136.70s/it]
Task 3, Epoch 20/20 => Loss 2.226, Loss_clf 0.225, Loss_fe 0.210, Loss_kd 1.567, Train_accy 54.62: 100%|██████████| 20/20 [46:14<00:00, 135.75s/it]
Task 3, Epoch 20/20 => Loss 2.226, Loss_clf 0.225, Loss_fe 0.210, Loss_kd 1.567, Train_accy 54.62: 100%|██████████| 20/20 [46:14<00:00, 138.74s/it]
2024-04-27 13:00:57,792 [foster.py] => Task 3, Epoch 20/20 => Loss 2.226, Loss_clf 0.225, Loss_fe 0.210, Loss_kd 1.567, Train_accy 54.62
2024-04-27 13:00:57,793 [foster.py] => do not weight align teacher!
2024-04-27 13:00:57,798 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.825,  Train_accy 40.52, Test_accy 74.25:   0%|          | 0/20 [03:02<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.825,  Train_accy 40.52, Test_accy 74.25:   5%|▌         | 1/20 [03:02<57:44, 182.33s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.737,  Train_accy 43.50:   5%|▌         | 1/20 [05:50<57:44, 182.33s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.737,  Train_accy 43.50:  10%|█         | 2/20 [05:50<52:11, 173.99s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.709,  Train_accy 44.01:  10%|█         | 2/20 [08:38<52:11, 173.99s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.709,  Train_accy 44.01:  15%|█▌        | 3/20 [08:38<48:32, 171.32s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.702,  Train_accy 44.61:  15%|█▌        | 3/20 [11:26<48:32, 171.32s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.702,  Train_accy 44.61:  20%|██        | 4/20 [11:26<45:21, 170.10s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.699,  Train_accy 44.62:  20%|██        | 4/20 [14:15<45:21, 170.10s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.699,  Train_accy 44.62:  25%|██▌       | 5/20 [14:15<42:21, 169.42s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.689,  Train_accy 44.90, Test_accy 74.48:  25%|██▌       | 5/20 [17:17<42:21, 169.42s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.689,  Train_accy 44.90, Test_accy 74.48:  30%|███       | 6/20 [17:17<40:34, 173.87s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.696,  Train_accy 44.70:  30%|███       | 6/20 [20:05<40:34, 173.87s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.696,  Train_accy 44.70:  35%|███▌      | 7/20 [20:05<37:15, 172.00s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.689,  Train_accy 45.04:  35%|███▌      | 7/20 [22:53<37:15, 172.00s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.689,  Train_accy 45.04:  40%|████      | 8/20 [22:53<34:09, 170.78s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.692,  Train_accy 45.01:  40%|████      | 8/20 [25:42<34:09, 170.78s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.692,  Train_accy 45.01:  45%|████▌     | 9/20 [25:42<31:09, 169.96s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.687,  Train_accy 45.48:  45%|████▌     | 9/20 [28:30<31:09, 169.96s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.687,  Train_accy 45.48:  50%|█████     | 10/20 [28:30<28:14, 169.41s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.679,  Train_accy 45.31, Test_accy 74.33:  50%|█████     | 10/20 [31:32<28:14, 169.41s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.679,  Train_accy 45.31, Test_accy 74.33:  55%|█████▌    | 11/20 [31:32<26:00, 173.34s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.673,  Train_accy 45.58:  55%|█████▌    | 11/20 [34:20<26:00, 173.34s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.673,  Train_accy 45.58:  60%|██████    | 12/20 [34:20<22:54, 171.76s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.677,  Train_accy 45.32:  60%|██████    | 12/20 [37:08<22:54, 171.76s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.677,  Train_accy 45.32:  65%|██████▌   | 13/20 [37:08<19:54, 170.67s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.666,  Train_accy 45.42:  65%|██████▌   | 13/20 [39:56<19:54, 170.67s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.666,  Train_accy 45.42:  70%|███████   | 14/20 [39:56<16:59, 169.89s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.679,  Train_accy 45.49:  70%|███████   | 14/20 [42:45<16:59, 169.89s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.679,  Train_accy 45.49:  75%|███████▌  | 15/20 [42:45<14:06, 169.37s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.681,  Train_accy 45.61, Test_accy 74.39:  75%|███████▌  | 15/20 [45:47<14:06, 169.37s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.681,  Train_accy 45.61, Test_accy 74.39:  80%|████████  | 16/20 [45:47<11:33, 173.37s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.691,  Train_accy 45.06:  80%|████████  | 16/20 [48:35<11:33, 173.37s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.691,  Train_accy 45.06:  85%|████████▌ | 17/20 [48:35<08:35, 171.81s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.687,  Train_accy 45.49:  85%|████████▌ | 17/20 [51:24<08:35, 171.81s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.687,  Train_accy 45.49:  90%|█████████ | 18/20 [51:24<05:41, 170.74s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.672,  Train_accy 44.95:  90%|█████████ | 18/20 [54:12<05:41, 170.74s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.672,  Train_accy 44.95:  95%|█████████▌| 19/20 [54:12<02:49, 169.97s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.672,  Train_accy 45.61:  95%|█████████▌| 19/20 [57:00<02:49, 169.97s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.672,  Train_accy 45.61: 100%|██████████| 20/20 [57:00<00:00, 169.45s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.672,  Train_accy 45.61: 100%|██████████| 20/20 [57:00<00:00, 171.03s/it]
2024-04-27 13:57:59,819 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.672,  Train_accy 45.61
2024-04-27 13:57:59,819 [foster.py] => do not weight align student!
2024-04-27 13:58:14,235 [foster.py] => darknet eval: 
2024-04-27 13:58:14,235 [foster.py] => CNN top1 curve: 74.58
2024-04-27 13:58:14,235 [foster.py] => CNN top5 curve: 94.76
2024-04-27 13:58:14,238 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 14:02:34,365 [foster.py] => Exemplar size: 4800
2024-04-27 14:02:34,366 [trainer.py] => CNN: {'total': 75.48, '00-149': 85.91, '150-179': 71.07, '180-209': 64.99, '210-239': 38.23, 'old': 80.81, 'new': 38.23}
2024-04-27 14:02:34,366 [trainer.py] => NME: {'total': 79.91, '00-149': 81.0, '150-179': 73.75, '180-209': 77.05, '210-239': 83.47, 'old': 79.4, 'new': 83.47}
2024-04-27 14:02:34,366 [trainer.py] => CNN top1 curve: [87.71, 80.54, 78.75, 75.48]
2024-04-27 14:02:34,366 [trainer.py] => CNN top5 curve: [97.6, 97.1, 96.08, 95.32]
2024-04-27 14:02:34,366 [trainer.py] => NME top1 curve: [86.97, 83.77, 81.98, 79.91]
2024-04-27 14:02:34,366 [trainer.py] => NME top5 curve: [97.76, 96.94, 96.51, 95.7]

Average Accuracy (CNN): 80.62
Average Accuracy (NME): 83.16
2024-04-27 14:02:34,366 [trainer.py] => Average Accuracy (CNN): 80.62
2024-04-27 14:02:34,366 [trainer.py] => Average Accuracy (NME): 83.16
2024-04-27 14:02:34,366 [trainer.py] => Train Time: 24170.28
2024-04-27 14:02:34,366 [trainer.py] => Test Time: 160.45999999999998 

2024-04-27 14:02:34,367 [trainer.py] => All params: 172312242
2024-04-27 14:02:34,369 [trainer.py] => Trainable params: 86352096
2024-04-27 14:02:35,887 [foster.py] => Learning on 240-270
2024-04-27 14:02:35,888 [foster.py] => All params: 172404492
2024-04-27 14:02:35,889 [foster.py] => Trainable params: 86421276
2024-04-27 14:02:35,953 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 4.853, Loss_clf 0.982, Loss_fe 1.962, Loss_kd 1.697, Train_accy 48.40, Test_accy 73.47:   0%|          | 0/20 [02:47<?, ?it/s]
Task 4, Epoch 1/20 => Loss 4.853, Loss_clf 0.982, Loss_fe 1.962, Loss_kd 1.697, Train_accy 48.40, Test_accy 73.47:   5%|▌         | 1/20 [02:47<53:04, 167.61s/it]
Task 4, Epoch 2/20 => Loss 3.358, Loss_clf 0.569, Loss_fe 0.875, Loss_kd 1.702, Train_accy 51.34:   5%|▌         | 1/20 [05:05<53:04, 167.61s/it]                 
Task 4, Epoch 2/20 => Loss 3.358, Loss_clf 0.569, Loss_fe 0.875, Loss_kd 1.702, Train_accy 51.34:  10%|█         | 2/20 [05:05<45:03, 150.20s/it]
Task 4, Epoch 3/20 => Loss 3.070, Loss_clf 0.482, Loss_fe 0.697, Loss_kd 1.681, Train_accy 51.59:  10%|█         | 2/20 [07:23<45:03, 150.20s/it]
Task 4, Epoch 3/20 => Loss 3.070, Loss_clf 0.482, Loss_fe 0.697, Loss_kd 1.681, Train_accy 51.59:  15%|█▌        | 3/20 [07:23<40:58, 144.62s/it]
Task 4, Epoch 4/20 => Loss 2.945, Loss_clf 0.436, Loss_fe 0.611, Loss_kd 1.687, Train_accy 52.20:  15%|█▌        | 3/20 [09:41<40:58, 144.62s/it]
Task 4, Epoch 4/20 => Loss 2.945, Loss_clf 0.436, Loss_fe 0.611, Loss_kd 1.687, Train_accy 52.20:  20%|██        | 4/20 [09:41<37:51, 141.99s/it]
Task 4, Epoch 5/20 => Loss 2.845, Loss_clf 0.407, Loss_fe 0.545, Loss_kd 1.683, Train_accy 52.67:  20%|██        | 4/20 [11:59<37:51, 141.99s/it]
Task 4, Epoch 5/20 => Loss 2.845, Loss_clf 0.407, Loss_fe 0.545, Loss_kd 1.683, Train_accy 52.67:  25%|██▌       | 5/20 [11:59<35:07, 140.52s/it]
Task 4, Epoch 6/20 => Loss 2.769, Loss_clf 0.380, Loss_fe 0.492, Loss_kd 1.687, Train_accy 53.29, Test_accy 74.44:  25%|██▌       | 5/20 [14:47<35:07, 140.52s/it]
Task 4, Epoch 6/20 => Loss 2.769, Loss_clf 0.380, Loss_fe 0.492, Loss_kd 1.687, Train_accy 53.29, Test_accy 74.44:  30%|███       | 6/20 [14:47<34:56, 149.78s/it]
Task 4, Epoch 7/20 => Loss 2.705, Loss_clf 0.356, Loss_fe 0.452, Loss_kd 1.686, Train_accy 53.68:  30%|███       | 6/20 [17:05<34:56, 149.78s/it]                 
Task 4, Epoch 7/20 => Loss 2.705, Loss_clf 0.356, Loss_fe 0.452, Loss_kd 1.686, Train_accy 53.68:  35%|███▌      | 7/20 [17:05<31:36, 145.91s/it]
Task 4, Epoch 8/20 => Loss 2.658, Loss_clf 0.342, Loss_fe 0.415, Loss_kd 1.690, Train_accy 54.46:  35%|███▌      | 7/20 [19:23<31:36, 145.91s/it]
Task 4, Epoch 8/20 => Loss 2.658, Loss_clf 0.342, Loss_fe 0.415, Loss_kd 1.690, Train_accy 54.46:  40%|████      | 8/20 [19:23<28:40, 143.37s/it]
Task 4, Epoch 9/20 => Loss 2.571, Loss_clf 0.313, Loss_fe 0.362, Loss_kd 1.685, Train_accy 54.82:  40%|████      | 8/20 [21:40<28:40, 143.37s/it]
Task 4, Epoch 9/20 => Loss 2.571, Loss_clf 0.313, Loss_fe 0.362, Loss_kd 1.685, Train_accy 54.82:  45%|████▌     | 9/20 [21:40<25:58, 141.66s/it]
Task 4, Epoch 10/20 => Loss 2.537, Loss_clf 0.295, Loss_fe 0.339, Loss_kd 1.692, Train_accy 56.18:  45%|████▌     | 9/20 [23:58<25:58, 141.66s/it]
Task 4, Epoch 10/20 => Loss 2.537, Loss_clf 0.295, Loss_fe 0.339, Loss_kd 1.692, Train_accy 56.18:  50%|█████     | 10/20 [23:58<23:25, 140.51s/it]
Task 4, Epoch 11/20 => Loss 2.516, Loss_clf 0.298, Loss_fe 0.329, Loss_kd 1.680, Train_accy 55.35, Test_accy 74.35:  50%|█████     | 10/20 [26:46<23:25, 140.51s/it]
Task 4, Epoch 11/20 => Loss 2.516, Loss_clf 0.298, Loss_fe 0.329, Loss_kd 1.680, Train_accy 55.35, Test_accy 74.35:  55%|█████▌    | 11/20 [26:46<22:19, 148.85s/it]
Task 4, Epoch 12/20 => Loss 2.447, Loss_clf 0.273, Loss_fe 0.287, Loss_kd 1.677, Train_accy 56.73:  55%|█████▌    | 11/20 [29:04<22:19, 148.85s/it]                 
Task 4, Epoch 12/20 => Loss 2.447, Loss_clf 0.273, Loss_fe 0.287, Loss_kd 1.677, Train_accy 56.73:  60%|██████    | 12/20 [29:04<19:24, 145.50s/it]
Task 4, Epoch 13/20 => Loss 2.399, Loss_clf 0.252, Loss_fe 0.266, Loss_kd 1.671, Train_accy 56.88:  60%|██████    | 12/20 [31:22<19:24, 145.50s/it]
Task 4, Epoch 13/20 => Loss 2.399, Loss_clf 0.252, Loss_fe 0.266, Loss_kd 1.671, Train_accy 56.88:  65%|██████▌   | 13/20 [31:22<16:42, 143.20s/it]
Task 4, Epoch 14/20 => Loss 2.394, Loss_clf 0.251, Loss_fe 0.252, Loss_kd 1.681, Train_accy 56.62:  65%|██████▌   | 13/20 [33:40<16:42, 143.20s/it]
Task 4, Epoch 14/20 => Loss 2.394, Loss_clf 0.251, Loss_fe 0.252, Loss_kd 1.681, Train_accy 56.62:  70%|███████   | 14/20 [33:40<14:09, 141.61s/it]
Task 4, Epoch 15/20 => Loss 2.353, Loss_clf 0.235, Loss_fe 0.234, Loss_kd 1.674, Train_accy 57.52:  70%|███████   | 14/20 [35:58<14:09, 141.61s/it]
Task 4, Epoch 15/20 => Loss 2.353, Loss_clf 0.235, Loss_fe 0.234, Loss_kd 1.674, Train_accy 57.52:  75%|███████▌  | 15/20 [35:58<11:42, 140.48s/it]
Task 4, Epoch 16/20 => Loss 2.357, Loss_clf 0.238, Loss_fe 0.228, Loss_kd 1.681, Train_accy 58.09, Test_accy 74.70:  75%|███████▌  | 15/20 [38:46<11:42, 140.48s/it]
Task 4, Epoch 16/20 => Loss 2.357, Loss_clf 0.238, Loss_fe 0.228, Loss_kd 1.681, Train_accy 58.09, Test_accy 74.70:  80%|████████  | 16/20 [38:46<09:54, 148.72s/it]
Task 4, Epoch 17/20 => Loss 2.344, Loss_clf 0.228, Loss_fe 0.225, Loss_kd 1.681, Train_accy 57.79:  80%|████████  | 16/20 [41:04<09:54, 148.72s/it]                 
Task 4, Epoch 17/20 => Loss 2.344, Loss_clf 0.228, Loss_fe 0.225, Loss_kd 1.681, Train_accy 57.79:  85%|████████▌ | 17/20 [41:04<07:16, 145.47s/it]
Task 4, Epoch 18/20 => Loss 2.281, Loss_clf 0.214, Loss_fe 0.200, Loss_kd 1.659, Train_accy 58.04:  85%|████████▌ | 17/20 [43:21<07:16, 145.47s/it]
Task 4, Epoch 18/20 => Loss 2.281, Loss_clf 0.214, Loss_fe 0.200, Loss_kd 1.659, Train_accy 58.04:  90%|█████████ | 18/20 [43:21<04:46, 143.20s/it]
Task 4, Epoch 19/20 => Loss 2.333, Loss_clf 0.224, Loss_fe 0.210, Loss_kd 1.688, Train_accy 58.34:  90%|█████████ | 18/20 [45:39<04:46, 143.20s/it]
Task 4, Epoch 19/20 => Loss 2.333, Loss_clf 0.224, Loss_fe 0.210, Loss_kd 1.688, Train_accy 58.34:  95%|█████████▌| 19/20 [45:39<02:21, 141.61s/it]
Task 4, Epoch 20/20 => Loss 2.301, Loss_clf 0.219, Loss_fe 0.203, Loss_kd 1.670, Train_accy 57.81:  95%|█████████▌| 19/20 [47:57<02:21, 141.61s/it]
Task 4, Epoch 20/20 => Loss 2.301, Loss_clf 0.219, Loss_fe 0.203, Loss_kd 1.670, Train_accy 57.81: 100%|██████████| 20/20 [47:57<00:00, 140.48s/it]
Task 4, Epoch 20/20 => Loss 2.301, Loss_clf 0.219, Loss_fe 0.203, Loss_kd 1.670, Train_accy 57.81: 100%|██████████| 20/20 [47:57<00:00, 143.88s/it]
2024-04-27 14:50:33,624 [foster.py] => Task 4, Epoch 20/20 => Loss 2.301, Loss_clf 0.219, Loss_fe 0.203, Loss_kd 1.670, Train_accy 57.81
2024-04-27 14:50:33,625 [foster.py] => do not weight align teacher!
2024-04-27 14:50:33,635 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.903,  Train_accy 43.86, Test_accy 73.42:   0%|          | 0/20 [03:09<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.903,  Train_accy 43.86, Test_accy 73.42:   5%|▌         | 1/20 [03:09<59:57, 189.33s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.814,  Train_accy 47.18:   5%|▌         | 1/20 [06:03<59:57, 189.33s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.814,  Train_accy 47.18:  10%|█         | 2/20 [06:03<54:02, 180.13s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.790,  Train_accy 48.10:  10%|█         | 2/20 [08:56<54:02, 180.13s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.790,  Train_accy 48.10:  15%|█▌        | 3/20 [08:56<50:12, 177.18s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.785,  Train_accy 48.61:  15%|█▌        | 3/20 [11:50<50:12, 177.18s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.785,  Train_accy 48.61:  20%|██        | 4/20 [11:50<46:52, 175.77s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.784,  Train_accy 48.53:  20%|██        | 4/20 [14:44<46:52, 175.77s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.784,  Train_accy 48.53:  25%|██▌       | 5/20 [14:44<43:45, 175.03s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.765,  Train_accy 48.69, Test_accy 73.44:  25%|██▌       | 5/20 [17:53<43:45, 175.03s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.765,  Train_accy 48.69, Test_accy 73.44:  30%|███       | 6/20 [17:53<42:00, 180.07s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.778,  Train_accy 48.86:  30%|███       | 6/20 [20:47<42:00, 180.07s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.778,  Train_accy 48.86:  35%|███▌      | 7/20 [20:47<38:33, 177.99s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.755,  Train_accy 49.18:  35%|███▌      | 7/20 [23:41<38:33, 177.99s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.755,  Train_accy 49.18:  40%|████      | 8/20 [23:41<35:19, 176.62s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.765,  Train_accy 49.21:  40%|████      | 8/20 [26:34<35:19, 176.62s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.765,  Train_accy 49.21:  45%|████▌     | 9/20 [26:34<32:12, 175.70s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.761,  Train_accy 48.84:  45%|████▌     | 9/20 [29:28<32:12, 175.70s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.761,  Train_accy 48.84:  50%|█████     | 10/20 [29:28<29:10, 175.07s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.766,  Train_accy 49.48, Test_accy 73.83:  50%|█████     | 10/20 [32:38<29:10, 175.07s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.766,  Train_accy 49.48, Test_accy 73.83:  55%|█████▌    | 11/20 [32:38<26:55, 179.48s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.767,  Train_accy 49.45:  55%|█████▌    | 11/20 [35:31<26:55, 179.48s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.767,  Train_accy 49.45:  60%|██████    | 12/20 [35:31<23:41, 177.70s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.759,  Train_accy 49.50:  60%|██████    | 12/20 [38:25<23:41, 177.70s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.759,  Train_accy 49.50:  65%|██████▌   | 13/20 [38:25<20:35, 176.48s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.763,  Train_accy 49.54:  65%|██████▌   | 13/20 [41:19<20:35, 176.48s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.763,  Train_accy 49.54:  70%|███████   | 14/20 [41:19<17:33, 175.62s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.761,  Train_accy 49.31:  70%|███████   | 14/20 [44:12<17:33, 175.62s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.761,  Train_accy 49.31:  75%|███████▌  | 15/20 [44:12<14:35, 175.06s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.754,  Train_accy 49.65, Test_accy 73.73:  75%|███████▌  | 15/20 [47:22<14:35, 175.06s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.754,  Train_accy 49.65, Test_accy 73.73:  80%|████████  | 16/20 [47:22<11:57, 179.50s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.753,  Train_accy 49.19:  80%|████████  | 16/20 [50:16<11:57, 179.50s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.753,  Train_accy 49.19:  85%|████████▌ | 17/20 [50:16<08:53, 177.77s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.757,  Train_accy 49.51:  85%|████████▌ | 17/20 [53:10<08:53, 177.77s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.757,  Train_accy 49.51:  90%|█████████ | 18/20 [53:10<05:53, 176.55s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.766,  Train_accy 49.09:  90%|█████████ | 18/20 [56:03<05:53, 176.55s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.766,  Train_accy 49.09:  95%|█████████▌| 19/20 [56:03<02:55, 175.75s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.764,  Train_accy 49.27:  95%|█████████▌| 19/20 [58:57<02:55, 175.75s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.764,  Train_accy 49.27: 100%|██████████| 20/20 [58:57<00:00, 175.15s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.764,  Train_accy 49.27: 100%|██████████| 20/20 [58:57<00:00, 176.88s/it]
2024-04-27 15:49:32,823 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.764,  Train_accy 49.27
2024-04-27 15:49:32,823 [foster.py] => do not weight align student!
2024-04-27 15:49:49,131 [foster.py] => darknet eval: 
2024-04-27 15:49:49,131 [foster.py] => CNN top1 curve: 73.71
2024-04-27 15:49:49,131 [foster.py] => CNN top5 curve: 94.86
2024-04-27 15:49:49,133 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 15:54:29,643 [foster.py] => Exemplar size: 5400
2024-04-27 15:54:29,643 [trainer.py] => CNN: {'total': 74.49, '00-149': 84.7, '150-179': 71.57, '180-209': 73.03, '210-239': 61.44, '240-269': 40.9, 'old': 78.7, 'new': 40.9}
2024-04-27 15:54:29,643 [trainer.py] => NME: {'total': 78.69, '00-149': 79.66, '150-179': 72.41, '180-209': 76.05, '210-239': 76.46, '240-269': 84.97, 'old': 77.9, 'new': 84.97}
2024-04-27 15:54:29,644 [trainer.py] => CNN top1 curve: [87.71, 80.54, 78.75, 75.48, 74.49]
2024-04-27 15:54:29,644 [trainer.py] => CNN top5 curve: [97.6, 97.1, 96.08, 95.32, 95.03]
2024-04-27 15:54:29,644 [trainer.py] => NME top1 curve: [86.97, 83.77, 81.98, 79.91, 78.69]
2024-04-27 15:54:29,644 [trainer.py] => NME top5 curve: [97.76, 96.94, 96.51, 95.7, 95.27]

Average Accuracy (CNN): 79.39
Average Accuracy (NME): 82.26
2024-04-27 15:54:29,644 [trainer.py] => Average Accuracy (CNN): 79.39
2024-04-27 15:54:29,644 [trainer.py] => Average Accuracy (NME): 82.26
2024-04-27 15:54:29,644 [trainer.py] => Train Time: 30603.51
2024-04-27 15:54:29,644 [trainer.py] => Test Time: 221.51 

2024-04-27 15:54:29,645 [trainer.py] => All params: 172404492
2024-04-27 15:54:29,646 [trainer.py] => Trainable params: 86421276
2024-04-27 15:54:31,312 [foster.py] => Learning on 270-300
2024-04-27 15:54:31,314 [foster.py] => All params: 172496742
2024-04-27 15:54:31,315 [foster.py] => Trainable params: 86490456
2024-04-27 15:54:31,389 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 5.378, Loss_clf 1.005, Loss_fe 2.196, Loss_kd 1.959, Train_accy 53.82, Test_accy 73.37:   0%|          | 0/20 [02:51<?, ?it/s]
Task 5, Epoch 1/20 => Loss 5.378, Loss_clf 1.005, Loss_fe 2.196, Loss_kd 1.959, Train_accy 53.82, Test_accy 73.37:   5%|▌         | 1/20 [02:51<54:19, 171.57s/it]
Task 5, Epoch 2/20 => Loss 3.804, Loss_clf 0.646, Loss_fe 0.987, Loss_kd 1.954, Train_accy 56.31:   5%|▌         | 1/20 [05:10<54:19, 171.57s/it]                 
Task 5, Epoch 2/20 => Loss 3.804, Loss_clf 0.646, Loss_fe 0.987, Loss_kd 1.954, Train_accy 56.31:  10%|█         | 2/20 [05:10<45:40, 152.25s/it]
Task 5, Epoch 3/20 => Loss 3.515, Loss_clf 0.554, Loss_fe 0.801, Loss_kd 1.945, Train_accy 57.74:  10%|█         | 2/20 [07:28<45:40, 152.25s/it]
Task 5, Epoch 3/20 => Loss 3.515, Loss_clf 0.554, Loss_fe 0.801, Loss_kd 1.945, Train_accy 57.74:  15%|█▌        | 3/20 [07:28<41:22, 146.02s/it]
Task 5, Epoch 4/20 => Loss 3.539, Loss_clf 0.566, Loss_fe 0.807, Loss_kd 1.949, Train_accy 58.58:  15%|█▌        | 3/20 [09:47<41:22, 146.02s/it]
Task 5, Epoch 4/20 => Loss 3.539, Loss_clf 0.566, Loss_fe 0.807, Loss_kd 1.949, Train_accy 58.58:  20%|██        | 4/20 [09:47<38:09, 143.08s/it]
Task 5, Epoch 5/20 => Loss 3.329, Loss_clf 0.470, Loss_fe 0.698, Loss_kd 1.945, Train_accy 59.53:  20%|██        | 4/20 [12:05<38:09, 143.08s/it]
Task 5, Epoch 5/20 => Loss 3.329, Loss_clf 0.470, Loss_fe 0.698, Loss_kd 1.945, Train_accy 59.53:  25%|██▌       | 5/20 [12:05<35:21, 141.42s/it]
Task 5, Epoch 6/20 => Loss 3.194, Loss_clf 0.448, Loss_fe 0.582, Loss_kd 1.948, Train_accy 60.11, Test_accy 73.92:  25%|██▌       | 5/20 [14:57<35:21, 141.42s/it]
Task 5, Epoch 6/20 => Loss 3.194, Loss_clf 0.448, Loss_fe 0.582, Loss_kd 1.948, Train_accy 60.11, Test_accy 73.92:  30%|███       | 6/20 [14:57<35:21, 151.56s/it]
Task 5, Epoch 7/20 => Loss 3.078, Loss_clf 0.400, Loss_fe 0.519, Loss_kd 1.943, Train_accy 61.29:  30%|███       | 6/20 [17:15<35:21, 151.56s/it]                 
Task 5, Epoch 7/20 => Loss 3.078, Loss_clf 0.400, Loss_fe 0.519, Loss_kd 1.943, Train_accy 61.29:  35%|███▌      | 7/20 [17:15<31:53, 147.19s/it]
Task 5, Epoch 8/20 => Loss 3.100, Loss_clf 0.395, Loss_fe 0.525, Loss_kd 1.963, Train_accy 59.96:  35%|███▌      | 7/20 [19:33<31:53, 147.19s/it]
Task 5, Epoch 8/20 => Loss 3.100, Loss_clf 0.395, Loss_fe 0.525, Loss_kd 1.963, Train_accy 59.96:  40%|████      | 8/20 [19:33<28:52, 144.37s/it]
Task 5, Epoch 9/20 => Loss 2.939, Loss_clf 0.354, Loss_fe 0.440, Loss_kd 1.930, Train_accy 61.73:  40%|████      | 8/20 [21:52<28:52, 144.37s/it]
Task 5, Epoch 9/20 => Loss 2.939, Loss_clf 0.354, Loss_fe 0.440, Loss_kd 1.930, Train_accy 61.73:  45%|████▌     | 9/20 [21:52<26:07, 142.51s/it]
Task 5, Epoch 10/20 => Loss 2.883, Loss_clf 0.333, Loss_fe 0.390, Loss_kd 1.944, Train_accy 61.85:  45%|████▌     | 9/20 [24:10<26:07, 142.51s/it]
Task 5, Epoch 10/20 => Loss 2.883, Loss_clf 0.333, Loss_fe 0.390, Loss_kd 1.944, Train_accy 61.85:  50%|█████     | 10/20 [24:10<23:32, 141.26s/it]
Task 5, Epoch 11/20 => Loss 2.850, Loss_clf 0.324, Loss_fe 0.366, Loss_kd 1.944, Train_accy 62.45, Test_accy 74.12:  50%|█████     | 10/20 [27:02<23:32, 141.26s/it]
Task 5, Epoch 11/20 => Loss 2.850, Loss_clf 0.324, Loss_fe 0.366, Loss_kd 1.944, Train_accy 62.45, Test_accy 74.12:  55%|█████▌    | 11/20 [27:02<22:35, 150.64s/it]
Task 5, Epoch 12/20 => Loss 2.772, Loss_clf 0.297, Loss_fe 0.322, Loss_kd 1.938, Train_accy 62.45:  55%|█████▌    | 11/20 [29:21<22:35, 150.64s/it]                 
Task 5, Epoch 12/20 => Loss 2.772, Loss_clf 0.297, Loss_fe 0.322, Loss_kd 1.938, Train_accy 62.45:  60%|██████    | 12/20 [29:21<19:35, 146.96s/it]
Task 5, Epoch 13/20 => Loss 2.726, Loss_clf 0.283, Loss_fe 0.295, Loss_kd 1.933, Train_accy 63.21:  60%|██████    | 12/20 [31:39<19:35, 146.96s/it]
Task 5, Epoch 13/20 => Loss 2.726, Loss_clf 0.283, Loss_fe 0.295, Loss_kd 1.933, Train_accy 63.21:  65%|██████▌   | 13/20 [31:39<16:50, 144.39s/it]
Task 5, Epoch 14/20 => Loss 2.701, Loss_clf 0.269, Loss_fe 0.272, Loss_kd 1.944, Train_accy 63.44:  65%|██████▌   | 13/20 [33:58<16:50, 144.39s/it]
Task 5, Epoch 14/20 => Loss 2.701, Loss_clf 0.269, Loss_fe 0.272, Loss_kd 1.944, Train_accy 63.44:  70%|███████   | 14/20 [33:58<14:15, 142.60s/it]
Task 5, Epoch 15/20 => Loss 2.662, Loss_clf 0.255, Loss_fe 0.259, Loss_kd 1.933, Train_accy 63.98:  70%|███████   | 14/20 [36:16<14:15, 142.60s/it]
Task 5, Epoch 15/20 => Loss 2.662, Loss_clf 0.255, Loss_fe 0.259, Loss_kd 1.933, Train_accy 63.98:  75%|███████▌  | 15/20 [36:16<11:46, 141.33s/it]
Task 5, Epoch 16/20 => Loss 2.677, Loss_clf 0.265, Loss_fe 0.253, Loss_kd 1.943, Train_accy 64.47, Test_accy 74.45:  75%|███████▌  | 15/20 [39:07<11:46, 141.33s/it]
Task 5, Epoch 16/20 => Loss 2.677, Loss_clf 0.265, Loss_fe 0.253, Loss_kd 1.943, Train_accy 64.47, Test_accy 74.45:  80%|████████  | 16/20 [39:07<10:01, 150.31s/it]
Task 5, Epoch 17/20 => Loss 2.674, Loss_clf 0.251, Loss_fe 0.250, Loss_kd 1.956, Train_accy 64.22:  80%|████████  | 16/20 [41:25<10:01, 150.31s/it]                 
Task 5, Epoch 17/20 => Loss 2.674, Loss_clf 0.251, Loss_fe 0.250, Loss_kd 1.956, Train_accy 64.22:  85%|████████▌ | 17/20 [41:25<07:20, 146.69s/it]
Task 5, Epoch 18/20 => Loss 2.637, Loss_clf 0.235, Loss_fe 0.238, Loss_kd 1.947, Train_accy 64.35:  85%|████████▌ | 17/20 [43:43<07:20, 146.69s/it]
Task 5, Epoch 18/20 => Loss 2.637, Loss_clf 0.235, Loss_fe 0.238, Loss_kd 1.947, Train_accy 64.35:  90%|█████████ | 18/20 [43:43<04:48, 144.13s/it]
Task 5, Epoch 19/20 => Loss 2.598, Loss_clf 0.231, Loss_fe 0.219, Loss_kd 1.933, Train_accy 64.41:  90%|█████████ | 18/20 [46:02<04:48, 144.13s/it]
Task 5, Epoch 19/20 => Loss 2.598, Loss_clf 0.231, Loss_fe 0.219, Loss_kd 1.933, Train_accy 64.41:  95%|█████████▌| 19/20 [46:02<02:22, 142.38s/it]
Task 5, Epoch 20/20 => Loss 2.623, Loss_clf 0.242, Loss_fe 0.226, Loss_kd 1.939, Train_accy 64.71:  95%|█████████▌| 19/20 [48:20<02:22, 142.38s/it]
Task 5, Epoch 20/20 => Loss 2.623, Loss_clf 0.242, Loss_fe 0.226, Loss_kd 1.939, Train_accy 64.71: 100%|██████████| 20/20 [48:20<00:00, 141.19s/it]
Task 5, Epoch 20/20 => Loss 2.623, Loss_clf 0.242, Loss_fe 0.226, Loss_kd 1.939, Train_accy 64.71: 100%|██████████| 20/20 [48:20<00:00, 145.03s/it]
2024-04-27 16:42:52,091 [foster.py] => Task 5, Epoch 20/20 => Loss 2.623, Loss_clf 0.242, Loss_fe 0.226, Loss_kd 1.939, Train_accy 64.71
2024-04-27 16:42:52,091 [foster.py] => do not weight align teacher!
2024-04-27 16:42:52,095 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 2.080,  Train_accy 50.02, Test_accy 73.28:   0%|          | 0/20 [03:11<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 2.080,  Train_accy 50.02, Test_accy 73.28:   5%|▌         | 1/20 [03:11<1:00:45, 191.88s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.990,  Train_accy 53.36:   5%|▌         | 1/20 [06:06<1:00:45, 191.88s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.990,  Train_accy 53.36:  10%|█         | 2/20 [06:06<54:29, 181.62s/it]  
SNet: Task 5, Epoch 3/20 => Loss 1.976,  Train_accy 53.88:  10%|█         | 2/20 [09:00<54:29, 181.62s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.976,  Train_accy 53.88:  15%|█▌        | 3/20 [09:00<50:31, 178.33s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.971,  Train_accy 54.15:  15%|█▌        | 3/20 [11:55<50:31, 178.33s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.971,  Train_accy 54.15:  20%|██        | 4/20 [11:55<47:08, 176.79s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.947,  Train_accy 54.88:  20%|██        | 4/20 [14:49<47:08, 176.79s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.947,  Train_accy 54.88:  25%|██▌       | 5/20 [14:49<43:59, 175.94s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.959,  Train_accy 55.34, Test_accy 73.48:  25%|██▌       | 5/20 [18:01<43:59, 175.94s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.959,  Train_accy 55.34, Test_accy 73.48:  30%|███       | 6/20 [18:01<42:20, 181.43s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.931,  Train_accy 55.19:  30%|███       | 6/20 [20:56<42:20, 181.43s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.931,  Train_accy 55.19:  35%|███▌      | 7/20 [20:56<38:49, 179.16s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.943,  Train_accy 55.17:  35%|███▌      | 7/20 [23:50<38:49, 179.16s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.943,  Train_accy 55.17:  40%|████      | 8/20 [23:50<35:32, 177.68s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.936,  Train_accy 55.25:  40%|████      | 8/20 [26:45<35:32, 177.68s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.936,  Train_accy 55.25:  45%|████▌     | 9/20 [26:45<32:23, 176.70s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.937,  Train_accy 55.28:  45%|████▌     | 9/20 [29:39<32:23, 176.70s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.937,  Train_accy 55.28:  50%|█████     | 10/20 [29:39<29:19, 175.99s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.942,  Train_accy 55.05, Test_accy 73.38:  50%|█████     | 10/20 [32:51<29:19, 175.99s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.942,  Train_accy 55.05, Test_accy 73.38:  55%|█████▌    | 11/20 [32:51<27:08, 180.95s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.939,  Train_accy 55.18:  55%|█████▌    | 11/20 [35:46<27:08, 180.95s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.939,  Train_accy 55.18:  60%|██████    | 12/20 [35:46<23:51, 179.00s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.937,  Train_accy 55.63:  60%|██████    | 12/20 [38:40<23:51, 179.00s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.937,  Train_accy 55.63:  65%|██████▌   | 13/20 [38:40<20:43, 177.60s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.949,  Train_accy 55.21:  65%|██████▌   | 13/20 [41:34<20:43, 177.60s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.949,  Train_accy 55.21:  70%|███████   | 14/20 [41:34<17:39, 176.59s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.940,  Train_accy 55.58:  70%|███████   | 14/20 [44:29<17:39, 176.59s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.940,  Train_accy 55.58:  75%|███████▌  | 15/20 [44:29<14:39, 175.85s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.941,  Train_accy 54.94, Test_accy 73.47:  75%|███████▌  | 15/20 [47:40<14:39, 175.85s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.941,  Train_accy 54.94, Test_accy 73.47:  80%|████████  | 16/20 [47:40<12:02, 180.59s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.945,  Train_accy 55.24:  80%|████████  | 16/20 [50:35<12:02, 180.59s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.945,  Train_accy 55.24:  85%|████████▌ | 17/20 [50:35<08:56, 178.71s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.933,  Train_accy 55.65:  85%|████████▌ | 17/20 [53:29<08:56, 178.71s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.933,  Train_accy 55.65:  90%|█████████ | 18/20 [53:29<05:54, 177.43s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.937,  Train_accy 55.32:  90%|█████████ | 18/20 [56:23<05:54, 177.43s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.937,  Train_accy 55.32:  95%|█████████▌| 19/20 [56:23<02:56, 176.53s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.935,  Train_accy 55.69:  95%|█████████▌| 19/20 [59:18<02:56, 176.53s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.935,  Train_accy 55.69: 100%|██████████| 20/20 [59:18<00:00, 175.90s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.935,  Train_accy 55.69: 100%|██████████| 20/20 [59:18<00:00, 177.92s/it]
2024-04-27 17:42:12,014 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.935,  Train_accy 55.69
2024-04-27 17:42:12,015 [foster.py] => do not weight align student!
2024-04-27 17:42:29,758 [foster.py] => darknet eval: 
2024-04-27 17:42:29,758 [foster.py] => CNN top1 curve: 73.42
2024-04-27 17:42:29,758 [foster.py] => CNN top5 curve: 94.47
2024-04-27 17:42:29,761 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 17:47:30,039 [foster.py] => Exemplar size: 6000
2024-04-27 17:47:30,039 [trainer.py] => CNN: {'total': 74.57, '00-149': 83.0, '150-179': 71.57, '180-209': 76.55, '210-239': 72.45, '240-269': 58.93, '270-299': 51.17, 'old': 77.17, 'new': 51.17}
2024-04-27 17:47:30,039 [trainer.py] => NME: {'total': 78.11, '00-149': 79.19, '150-179': 70.9, '180-209': 76.38, '210-239': 76.79, '240-269': 73.46, '270-299': 87.63, 'old': 77.06, 'new': 87.63}
2024-04-27 17:47:30,039 [trainer.py] => CNN top1 curve: [87.71, 80.54, 78.75, 75.48, 74.49, 74.57]
2024-04-27 17:47:30,039 [trainer.py] => CNN top5 curve: [97.6, 97.1, 96.08, 95.32, 95.03, 94.44]
2024-04-27 17:47:30,039 [trainer.py] => NME top1 curve: [86.97, 83.77, 81.98, 79.91, 78.69, 78.11]
2024-04-27 17:47:30,039 [trainer.py] => NME top5 curve: [97.76, 96.94, 96.51, 95.7, 95.27, 94.89]

Average Accuracy (CNN): 78.59
Average Accuracy (NME): 81.57
2024-04-27 17:47:30,039 [trainer.py] => Average Accuracy (CNN): 78.59
2024-04-27 17:47:30,039 [trainer.py] => Average Accuracy (NME): 81.57
2024-04-27 17:47:30,040 [trainer.py] => Train Time: 37081.93
2024-04-27 17:47:30,040 [trainer.py] => Test Time: 289.77 

Accuracy Matrix (CNN):
[[87.71 86.87 86.57 85.91 84.7  83.  ]
 [ 0.   48.83 68.06 71.07 71.57 71.57]
 [ 0.    0.   50.25 64.99 73.03 76.55]
 [ 0.    0.    0.   38.23 61.44 72.45]
 [ 0.    0.    0.    0.   40.9  58.93]
 [ 0.    0.    0.    0.    0.   51.17]]
2024-04-27 17:47:30,040 [trainer.py] => Forgetting (CNN): 0.9419999999999987
Accuracy Matrix (NME):
[[86.97 83.53 83.2  81.   79.66 79.19]
 [ 0.   84.95 72.91 73.75 72.41 70.9 ]
 [ 0.    0.   84.92 77.05 76.05 76.38]
 [ 0.    0.    0.   83.47 76.46 76.79]
 [ 0.    0.    0.    0.   84.97 73.46]
 [ 0.    0.    0.    0.    0.   87.63]]
2024-04-27 17:47:30,041 [trainer.py] => Forgetting (NME): 9.712

2024-04-23 17:57:48,448 [trainer.py] => config: ./exps/simplecil_omn_B150.json
2024-04-23 17:57:48,449 [trainer.py] => prefix:  
2024-04-23 17:57:48,449 [trainer.py] => dataset: omnibenchmark
2024-04-23 17:57:48,449 [trainer.py] => memory_size: 0
2024-04-23 17:57:48,449 [trainer.py] => memory_per_class: 0
2024-04-23 17:57:48,449 [trainer.py] => fixed_memory: False
2024-04-23 17:57:48,449 [trainer.py] => shuffle: True
2024-04-23 17:57:48,449 [trainer.py] => init_cls: 150
2024-04-23 17:57:48,449 [trainer.py] => increment: 30
2024-04-23 17:57:48,449 [trainer.py] => model_name: simplecil
2024-04-23 17:57:48,449 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-04-23 17:57:48,449 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-23 17:57:48,449 [trainer.py] => seed: 1993
2024-04-23 17:57:48,449 [trainer.py] => tuned_epoch: 0
2024-04-23 17:57:48,449 [trainer.py] => init_lr: 0.01
2024-04-23 17:57:48,449 [trainer.py] => batch_size: 48
2024-04-23 17:57:48,449 [trainer.py] => weight_decay: 0.05
2024-04-23 17:57:48,449 [trainer.py] => min_lr: 1e-08
2024-04-23 17:57:48,449 [trainer.py] => optimizer: sgd
2024-04-23 17:57:48,449 [trainer.py] => vpt_type: shallow
2024-04-23 17:57:48,449 [trainer.py] => prompt_token_num: 3
2024-04-23 17:57:48,709 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-23 17:57:51,202 [trainer.py] => All params: 85798656
2024-04-23 17:57:51,203 [trainer.py] => Trainable params: 85798656
2024-04-23 17:57:51,612 [simplecil.py] => Learning on 0-150
2024-04-23 17:59:51,857 [trainer.py] => No NME accuracy.
2024-04-23 17:59:51,857 [trainer.py] => CNN: {'total': 78.66, '00-149': 78.66, 'old': 0, 'new': 78.66}
2024-04-23 17:59:51,857 [trainer.py] => CNN top1 curve: [78.66]
2024-04-23 17:59:51,857 [trainer.py] => CNN top5 curve: [94.46]

Average Accuracy (CNN): 78.66
2024-04-23 17:59:51,857 [trainer.py] => Average Accuracy (CNN): 78.66 

2024-04-23 17:59:51,857 [trainer.py] => Train Time: 111.35
2024-04-23 17:59:51,857 [trainer.py] => Test Time: 8.81 

2024-04-23 17:59:51,858 [trainer.py] => All params: 85913857
2024-04-23 17:59:51,859 [trainer.py] => Trainable params: 85913857
2024-04-23 17:59:51,862 [simplecil.py] => Learning on 150-180
2024-04-23 18:00:25,184 [trainer.py] => No NME accuracy.
2024-04-23 18:00:25,185 [trainer.py] => CNN: {'total': 75.92, '00-149': 76.72, '150-179': 71.91, 'old': 76.72, 'new': 71.91}
2024-04-23 18:00:25,185 [trainer.py] => CNN top1 curve: [78.66, 75.92]
2024-04-23 18:00:25,185 [trainer.py] => CNN top5 curve: [94.46, 92.85]

Average Accuracy (CNN): 77.29
2024-04-23 18:00:25,185 [trainer.py] => Average Accuracy (CNN): 77.29 

2024-04-23 18:00:25,186 [trainer.py] => Train Time: 134.41
2024-04-23 18:00:25,186 [trainer.py] => Test Time: 19.04 

2024-04-23 18:00:25,187 [trainer.py] => All params: 85936897
2024-04-23 18:00:25,189 [trainer.py] => Trainable params: 85936897
2024-04-23 18:00:25,193 [simplecil.py] => Learning on 180-210
2024-04-23 18:00:59,694 [trainer.py] => No NME accuracy.
2024-04-23 18:00:59,694 [trainer.py] => CNN: {'total': 74.77, '00-149': 75.82, '150-179': 70.57, '180-209': 73.7, 'old': 74.94, 'new': 73.7}
2024-04-23 18:00:59,694 [trainer.py] => CNN top1 curve: [78.66, 75.92, 74.77]
2024-04-23 18:00:59,694 [trainer.py] => CNN top5 curve: [94.46, 92.85, 92.12]

Average Accuracy (CNN): 76.45
2024-04-23 18:00:59,694 [trainer.py] => Average Accuracy (CNN): 76.45 

2024-04-23 18:00:59,694 [trainer.py] => Train Time: 157.31
2024-04-23 18:00:59,695 [trainer.py] => Test Time: 30.61 

2024-04-23 18:00:59,695 [trainer.py] => All params: 85959937
2024-04-23 18:00:59,696 [trainer.py] => Trainable params: 85959937
2024-04-23 18:00:59,700 [simplecil.py] => Learning on 210-240
2024-04-23 18:01:36,717 [trainer.py] => No NME accuracy.
2024-04-23 18:01:36,717 [trainer.py] => CNN: {'total': 73.02, '00-149': 74.38, '150-179': 68.9, '180-209': 71.86, '210-239': 71.45, 'old': 73.24, 'new': 71.45}
2024-04-23 18:01:36,717 [trainer.py] => CNN top1 curve: [78.66, 75.92, 74.77, 73.02]
2024-04-23 18:01:36,717 [trainer.py] => CNN top5 curve: [94.46, 92.85, 92.12, 90.77]

Average Accuracy (CNN): 75.59
2024-04-23 18:01:36,717 [trainer.py] => Average Accuracy (CNN): 75.59 

2024-04-23 18:01:36,717 [trainer.py] => Train Time: 181.21
2024-04-23 18:01:36,718 [trainer.py] => Test Time: 43.71 

2024-04-23 18:01:36,718 [trainer.py] => All params: 85982977
2024-04-23 18:01:36,719 [trainer.py] => Trainable params: 85982977
2024-04-23 18:01:36,724 [simplecil.py] => Learning on 240-270
2024-04-23 18:02:15,777 [trainer.py] => No NME accuracy.
2024-04-23 18:02:15,778 [trainer.py] => CNN: {'total': 72.3, '00-149': 73.08, '150-179': 67.73, '180-209': 70.52, '210-239': 71.12, '240-269': 75.96, 'old': 71.85, 'new': 75.96}
2024-04-23 18:02:15,778 [trainer.py] => CNN top1 curve: [78.66, 75.92, 74.77, 73.02, 72.3]
2024-04-23 18:02:15,778 [trainer.py] => CNN top5 curve: [94.46, 92.85, 92.12, 90.77, 90.89]

Average Accuracy (CNN): 74.93
2024-04-23 18:02:15,779 [trainer.py] => Average Accuracy (CNN): 74.93 

2024-04-23 18:02:15,779 [trainer.py] => Train Time: 205.57
2024-04-23 18:02:15,779 [trainer.py] => Test Time: 58.38 

2024-04-23 18:02:15,781 [trainer.py] => All params: 86006017
2024-04-23 18:02:15,782 [trainer.py] => Trainable params: 86006017
2024-04-23 18:02:15,789 [simplecil.py] => Learning on 270-300
2024-04-23 18:02:54,438 [trainer.py] => No NME accuracy.
2024-04-23 18:02:54,438 [trainer.py] => CNN: {'total': 72.18, '00-149': 72.41, '150-179': 67.06, '180-209': 70.02, '210-239': 70.62, '240-269': 73.62, '270-299': 78.43, 'old': 71.49, 'new': 78.43}
2024-04-23 18:02:54,438 [trainer.py] => CNN top1 curve: [78.66, 75.92, 74.77, 73.02, 72.3, 72.18]
2024-04-23 18:02:54,438 [trainer.py] => CNN top5 curve: [94.46, 92.85, 92.12, 90.77, 90.89, 90.59]

Average Accuracy (CNN): 74.47
2024-04-23 18:02:54,438 [trainer.py] => Average Accuracy (CNN): 74.47 

2024-04-23 18:02:54,438 [trainer.py] => Train Time: 228.26
2024-04-23 18:02:54,438 [trainer.py] => Test Time: 74.31 

Accuracy Matrix (CNN):
[[78.66 76.72 75.82 74.38 73.08 72.41]
 [ 0.   71.91 70.57 68.9  67.73 67.06]
 [ 0.    0.   73.7  71.86 70.52 70.02]
 [ 0.    0.    0.   71.45 71.12 70.62]
 [ 0.    0.    0.    0.   75.96 73.62]
 [ 0.    0.    0.    0.    0.   78.43]]
2024-04-23 18:02:54,439 [trainer.py] => Forgetting (CNN): 3.5899999999999976
2024-04-23 18:02:57,310 [trainer.py] => config: ./exps/l2p_omn_B150.json
2024-04-23 18:02:57,311 [trainer.py] => prefix:  
2024-04-23 18:02:57,311 [trainer.py] => dataset: omnibenchmark
2024-04-23 18:02:57,311 [trainer.py] => memory_size: 0
2024-04-23 18:02:57,311 [trainer.py] => memory_per_class: 0
2024-04-23 18:02:57,311 [trainer.py] => fixed_memory: False
2024-04-23 18:02:57,311 [trainer.py] => shuffle: True
2024-04-23 18:02:57,311 [trainer.py] => init_cls: 150
2024-04-23 18:02:57,311 [trainer.py] => increment: 30
2024-04-23 18:02:57,311 [trainer.py] => model_name: l2p
2024-04-23 18:02:57,311 [trainer.py] => backbone_type: vit_base_patch16_224_l2p
2024-04-23 18:02:57,311 [trainer.py] => get_original_backbone: True
2024-04-23 18:02:57,311 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-23 18:02:57,311 [trainer.py] => seed: 1993
2024-04-23 18:02:57,311 [trainer.py] => tuned_epoch: 20
2024-04-23 18:02:57,311 [trainer.py] => init_lr: 0.001875
2024-04-23 18:02:57,311 [trainer.py] => batch_size: 48
2024-04-23 18:02:57,311 [trainer.py] => weight_decay: 0
2024-04-23 18:02:57,311 [trainer.py] => min_lr: 1e-05
2024-04-23 18:02:57,311 [trainer.py] => optimizer: adam
2024-04-23 18:02:57,311 [trainer.py] => scheduler: constant
2024-04-23 18:02:57,311 [trainer.py] => reinit_optimizer: True
2024-04-23 18:02:57,311 [trainer.py] => global_pool: token
2024-04-23 18:02:57,311 [trainer.py] => head_type: prompt
2024-04-23 18:02:57,311 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-23 18:02:57,311 [trainer.py] => pretrained: True
2024-04-23 18:02:57,311 [trainer.py] => drop: 0.0
2024-04-23 18:02:57,311 [trainer.py] => drop_path: 0.0
2024-04-23 18:02:57,311 [trainer.py] => prompt_pool: True
2024-04-23 18:02:57,311 [trainer.py] => size: 10
2024-04-23 18:02:57,311 [trainer.py] => length: 5
2024-04-23 18:02:57,312 [trainer.py] => top_k: 5
2024-04-23 18:02:57,312 [trainer.py] => initializer: uniform
2024-04-23 18:02:57,312 [trainer.py] => prompt_key: True
2024-04-23 18:02:57,312 [trainer.py] => prompt_key_init: uniform
2024-04-23 18:02:57,312 [trainer.py] => use_prompt_mask: False
2024-04-23 18:02:57,312 [trainer.py] => shared_prompt_pool: False
2024-04-23 18:02:57,312 [trainer.py] => shared_prompt_key: False
2024-04-23 18:02:57,312 [trainer.py] => batchwise_prompt: True
2024-04-23 18:02:57,312 [trainer.py] => embedding_key: cls
2024-04-23 18:02:57,312 [trainer.py] => predefined_key: 
2024-04-23 18:02:57,312 [trainer.py] => pull_constraint: True
2024-04-23 18:02:57,312 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-23 18:02:57,569 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
2024-04-23 18:02:59,743 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-04-23 18:02:59,744 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-04-23 18:03:02,140 [l2p.py] => 86,094,636 model total parameters.
2024-04-23 18:03:02,140 [l2p.py] => 276,780 model training parameters.
2024-04-23 18:03:02,140 [l2p.py] => prompt.prompt: 38400
2024-04-23 18:03:02,141 [l2p.py] => prompt.prompt_key: 7680
2024-04-23 18:03:02,141 [l2p.py] => head.weight: 230400
2024-04-23 18:03:02,141 [l2p.py] => head.bias: 300
2024-04-23 18:03:02,142 [trainer.py] => All params: 172123992
2024-04-23 18:03:02,144 [trainer.py] => Trainable params: 276780
2024-04-23 18:03:02,144 [l2p.py] => Learning on 0-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.160, Train_accy 67.61:   0%|          | 0/20 [05:53<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.160, Train_accy 67.61:   5%|▌         | 1/20 [05:53<1:51:56, 353.52s/it]
Task 0, Epoch 2/20 => Loss 0.676, Train_accy 76.35:   5%|▌         | 1/20 [11:49<1:51:56, 353.52s/it]
Task 0, Epoch 2/20 => Loss 0.676, Train_accy 76.35:  10%|█         | 2/20 [11:49<1:46:26, 354.81s/it]
Task 0, Epoch 3/20 => Loss 0.596, Train_accy 78.28:  10%|█         | 2/20 [17:39<1:46:26, 354.81s/it]
Task 0, Epoch 3/20 => Loss 0.596, Train_accy 78.28:  15%|█▌        | 3/20 [17:39<1:39:59, 352.89s/it]
Task 0, Epoch 4/20 => Loss 0.540, Train_accy 79.72:  15%|█▌        | 3/20 [23:31<1:39:59, 352.89s/it]
Task 0, Epoch 4/20 => Loss 0.540, Train_accy 79.72:  20%|██        | 4/20 [23:31<1:34:01, 352.58s/it]
Task 0, Epoch 5/20 => Loss 0.504, Train_accy 80.55, Test_accy 82.97:  20%|██        | 4/20 [29:38<1:34:01, 352.58s/it]
Task 0, Epoch 5/20 => Loss 0.504, Train_accy 80.55, Test_accy 82.97:  25%|██▌       | 5/20 [29:38<1:29:26, 357.79s/it]
Task 0, Epoch 6/20 => Loss 0.463, Train_accy 81.41:  25%|██▌       | 5/20 [35:28<1:29:26, 357.79s/it]                 
Task 0, Epoch 6/20 => Loss 0.463, Train_accy 81.41:  30%|███       | 6/20 [35:28<1:22:50, 355.06s/it]
Task 0, Epoch 7/20 => Loss 0.449, Train_accy 82.09:  30%|███       | 6/20 [41:19<1:22:50, 355.06s/it]
Task 0, Epoch 7/20 => Loss 0.449, Train_accy 82.09:  35%|███▌      | 7/20 [41:19<1:16:36, 353.59s/it]
Task 0, Epoch 8/20 => Loss 0.429, Train_accy 82.50:  35%|███▌      | 7/20 [47:10<1:16:36, 353.59s/it]
Task 0, Epoch 8/20 => Loss 0.429, Train_accy 82.50:  40%|████      | 8/20 [47:10<1:10:34, 352.91s/it]
Task 0, Epoch 9/20 => Loss 0.414, Train_accy 82.97:  40%|████      | 8/20 [53:01<1:10:34, 352.91s/it]
Task 0, Epoch 9/20 => Loss 0.414, Train_accy 82.97:  45%|████▌     | 9/20 [53:01<1:04:36, 352.39s/it]
Task 0, Epoch 10/20 => Loss 0.392, Train_accy 83.51, Test_accy 84.10:  45%|████▌     | 9/20 [59:08<1:04:36, 352.39s/it]
Task 0, Epoch 10/20 => Loss 0.392, Train_accy 83.51, Test_accy 84.10:  50%|█████     | 10/20 [59:08<59:27, 356.78s/it] 
Task 0, Epoch 11/20 => Loss 0.395, Train_accy 83.30:  50%|█████     | 10/20 [1:04:59<59:27, 356.78s/it]               
Task 0, Epoch 11/20 => Loss 0.395, Train_accy 83.30:  55%|█████▌    | 11/20 [1:04:59<53:14, 354.99s/it]
Task 0, Epoch 12/20 => Loss 0.383, Train_accy 83.80:  55%|█████▌    | 11/20 [1:10:50<53:14, 354.99s/it]
Task 0, Epoch 12/20 => Loss 0.383, Train_accy 83.80:  60%|██████    | 12/20 [1:10:50<47:11, 353.90s/it]
Task 0, Epoch 13/20 => Loss 0.370, Train_accy 84.12:  60%|██████    | 12/20 [1:16:41<47:11, 353.90s/it]
Task 0, Epoch 13/20 => Loss 0.370, Train_accy 84.12:  65%|██████▌   | 13/20 [1:16:41<41:10, 352.86s/it]
Task 0, Epoch 14/20 => Loss 0.351, Train_accy 84.60:  65%|██████▌   | 13/20 [1:22:31<41:10, 352.86s/it]
Task 0, Epoch 14/20 => Loss 0.351, Train_accy 84.60:  70%|███████   | 14/20 [1:22:31<35:11, 351.98s/it]
Task 0, Epoch 15/20 => Loss 0.352, Train_accy 84.48, Test_accy 84.47:  70%|███████   | 14/20 [1:28:37<35:11, 351.98s/it]
Task 0, Epoch 15/20 => Loss 0.352, Train_accy 84.48, Test_accy 84.47:  75%|███████▌  | 15/20 [1:28:37<29:41, 356.39s/it]
Task 0, Epoch 16/20 => Loss 0.342, Train_accy 84.73:  75%|███████▌  | 15/20 [1:34:29<29:41, 356.39s/it]                 
Task 0, Epoch 16/20 => Loss 0.342, Train_accy 84.73:  80%|████████  | 16/20 [1:34:29<23:39, 354.90s/it]
Task 0, Epoch 17/20 => Loss 0.342, Train_accy 85.06:  80%|████████  | 16/20 [1:40:20<23:39, 354.90s/it]
Task 0, Epoch 17/20 => Loss 0.342, Train_accy 85.06:  85%|████████▌ | 17/20 [1:40:20<17:41, 353.83s/it]
Task 0, Epoch 18/20 => Loss 0.344, Train_accy 84.89:  85%|████████▌ | 17/20 [1:46:11<17:41, 353.83s/it]
Task 0, Epoch 18/20 => Loss 0.344, Train_accy 84.89:  90%|█████████ | 18/20 [1:46:11<11:45, 352.92s/it]
Task 0, Epoch 19/20 => Loss 0.320, Train_accy 85.45:  90%|█████████ | 18/20 [1:52:04<11:45, 352.92s/it]
Task 0, Epoch 19/20 => Loss 0.320, Train_accy 85.45:  95%|█████████▌| 19/20 [1:52:04<05:52, 352.81s/it]
Task 0, Epoch 20/20 => Loss 0.319, Train_accy 85.34, Test_accy 84.74:  95%|█████████▌| 19/20 [1:58:13<05:52, 352.81s/it]
Task 0, Epoch 20/20 => Loss 0.319, Train_accy 85.34, Test_accy 84.74: 100%|██████████| 20/20 [1:58:13<00:00, 357.65s/it]
Task 0, Epoch 20/20 => Loss 0.319, Train_accy 85.34, Test_accy 84.74: 100%|██████████| 20/20 [1:58:13<00:00, 354.65s/it]
2024-04-23 20:01:15,768 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.319, Train_accy 85.34, Test_accy 84.74
2024-04-23 20:01:31,733 [trainer.py] => No NME accuracy.
2024-04-23 20:01:31,733 [trainer.py] => CNN: {'total': 84.74, '00-149': 84.74, 'old': 0, 'new': 84.74}
2024-04-23 20:01:31,733 [trainer.py] => CNN top1 curve: [84.74]
2024-04-23 20:01:31,733 [trainer.py] => CNN top5 curve: [97.23]

Average Accuracy (CNN): 84.74
2024-04-23 20:01:31,733 [trainer.py] => Average Accuracy (CNN): 84.74 

2024-04-23 20:01:31,733 [trainer.py] => Train Time: 14186.619999999999
2024-04-23 20:01:31,733 [trainer.py] => Test Time: 15.96 

2024-04-23 20:01:31,735 [trainer.py] => All params: 172123992
2024-04-23 20:01:31,736 [trainer.py] => Trainable params: 276780
2024-04-23 20:01:31,736 [l2p.py] => Learning on 150-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.380, Train_accy 84.09:   0%|          | 0/20 [01:10<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.380, Train_accy 84.09:   5%|▌         | 1/20 [01:10<22:13, 70.20s/it]
Task 1, Epoch 2/20 => Loss 0.113, Train_accy 90.25:   5%|▌         | 1/20 [02:20<22:13, 70.20s/it]
Task 1, Epoch 2/20 => Loss 0.113, Train_accy 90.25:  10%|█         | 2/20 [02:20<21:06, 70.36s/it]
Task 1, Epoch 3/20 => Loss 0.073, Train_accy 91.63:  10%|█         | 2/20 [03:31<21:06, 70.36s/it]
Task 1, Epoch 3/20 => Loss 0.073, Train_accy 91.63:  15%|█▌        | 3/20 [03:31<19:56, 70.39s/it]
Task 1, Epoch 4/20 => Loss 0.051, Train_accy 92.10:  15%|█▌        | 3/20 [04:41<19:56, 70.39s/it]
Task 1, Epoch 4/20 => Loss 0.051, Train_accy 92.10:  20%|██        | 4/20 [04:41<18:45, 70.34s/it]
Task 1, Epoch 5/20 => Loss 0.024, Train_accy 92.85, Test_accy 72.47:  20%|██        | 4/20 [06:10<18:45, 70.34s/it]
Task 1, Epoch 5/20 => Loss 0.024, Train_accy 92.85, Test_accy 72.47:  25%|██▌       | 5/20 [06:10<19:16, 77.10s/it]
Task 1, Epoch 6/20 => Loss 0.008, Train_accy 93.46:  25%|██▌       | 5/20 [07:20<19:16, 77.10s/it]                 
Task 1, Epoch 6/20 => Loss 0.008, Train_accy 93.46:  30%|███       | 6/20 [07:20<17:26, 74.73s/it]
Task 1, Epoch 7/20 => Loss 0.010, Train_accy 93.49:  30%|███       | 6/20 [08:30<17:26, 74.73s/it]
Task 1, Epoch 7/20 => Loss 0.010, Train_accy 93.49:  35%|███▌      | 7/20 [08:30<15:50, 73.14s/it]
Task 1, Epoch 8/20 => Loss 0.004, Train_accy 93.93:  35%|███▌      | 7/20 [09:40<15:50, 73.14s/it]
Task 1, Epoch 8/20 => Loss 0.004, Train_accy 93.93:  40%|████      | 8/20 [09:40<14:25, 72.12s/it]
Task 1, Epoch 9/20 => Loss 0.000, Train_accy 93.70:  40%|████      | 8/20 [10:50<14:25, 72.12s/it]
Task 1, Epoch 9/20 => Loss 0.000, Train_accy 93.70:  45%|████▌     | 9/20 [10:50<13:06, 71.46s/it]
Task 1, Epoch 10/20 => Loss -0.002, Train_accy 94.07, Test_accy 73.33:  45%|████▌     | 9/20 [12:19<13:06, 71.46s/it]
Task 1, Epoch 10/20 => Loss -0.002, Train_accy 94.07, Test_accy 73.33:  50%|█████     | 10/20 [12:19<12:48, 76.82s/it]
Task 1, Epoch 11/20 => Loss -0.011, Train_accy 94.31:  50%|█████     | 10/20 [13:29<12:48, 76.82s/it]                 
Task 1, Epoch 11/20 => Loss -0.011, Train_accy 94.31:  55%|█████▌    | 11/20 [13:29<11:12, 74.71s/it]
Task 1, Epoch 12/20 => Loss -0.012, Train_accy 94.36:  55%|█████▌    | 11/20 [14:39<11:12, 74.71s/it]
Task 1, Epoch 12/20 => Loss -0.012, Train_accy 94.36:  60%|██████    | 12/20 [14:39<09:46, 73.26s/it]
Task 1, Epoch 13/20 => Loss -0.015, Train_accy 93.93:  60%|██████    | 12/20 [15:49<09:46, 73.26s/it]
Task 1, Epoch 13/20 => Loss -0.015, Train_accy 93.93:  65%|██████▌   | 13/20 [15:49<08:27, 72.43s/it]
Task 1, Epoch 14/20 => Loss -0.016, Train_accy 94.41:  65%|██████▌   | 13/20 [17:00<08:27, 72.43s/it]
Task 1, Epoch 14/20 => Loss -0.016, Train_accy 94.41:  70%|███████   | 14/20 [17:00<07:11, 71.87s/it]
Task 1, Epoch 15/20 => Loss -0.022, Train_accy 94.71, Test_accy 73.97:  70%|███████   | 14/20 [18:29<07:11, 71.87s/it]
Task 1, Epoch 15/20 => Loss -0.022, Train_accy 94.71, Test_accy 73.97:  75%|███████▌  | 15/20 [18:29<06:25, 77.06s/it]
Task 1, Epoch 16/20 => Loss -0.027, Train_accy 94.58:  75%|███████▌  | 15/20 [19:39<06:25, 77.06s/it]                 
Task 1, Epoch 16/20 => Loss -0.027, Train_accy 94.58:  80%|████████  | 16/20 [19:39<04:59, 74.98s/it]
Task 1, Epoch 17/20 => Loss -0.035, Train_accy 95.04:  80%|████████  | 16/20 [20:49<04:59, 74.98s/it]
Task 1, Epoch 17/20 => Loss -0.035, Train_accy 95.04:  85%|████████▌ | 17/20 [20:49<03:40, 73.44s/it]
Task 1, Epoch 18/20 => Loss -0.037, Train_accy 95.43:  85%|████████▌ | 17/20 [21:59<03:40, 73.44s/it]
Task 1, Epoch 18/20 => Loss -0.037, Train_accy 95.43:  90%|█████████ | 18/20 [21:59<02:24, 72.35s/it]
Task 1, Epoch 19/20 => Loss -0.019, Train_accy 94.22:  90%|█████████ | 18/20 [23:09<02:24, 72.35s/it]
Task 1, Epoch 19/20 => Loss -0.019, Train_accy 94.22:  95%|█████████▌| 19/20 [23:09<01:11, 71.75s/it]
Task 1, Epoch 20/20 => Loss -0.037, Train_accy 95.01, Test_accy 75.45:  95%|█████████▌| 19/20 [24:38<01:11, 71.75s/it]
Task 1, Epoch 20/20 => Loss -0.037, Train_accy 95.01, Test_accy 75.45: 100%|██████████| 20/20 [24:38<00:00, 76.90s/it]
Task 1, Epoch 20/20 => Loss -0.037, Train_accy 95.01, Test_accy 75.45: 100%|██████████| 20/20 [24:38<00:00, 73.92s/it]
2024-04-23 20:26:10,114 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.037, Train_accy 95.01, Test_accy 75.45
2024-04-23 20:26:28,927 [trainer.py] => No NME accuracy.
2024-04-23 20:26:28,928 [trainer.py] => CNN: {'total': 75.45, '00-149': 85.04, '150-179': 27.42, 'old': 85.04, 'new': 27.42}
2024-04-23 20:26:28,928 [trainer.py] => CNN top1 curve: [84.74, 75.45]
2024-04-23 20:26:28,928 [trainer.py] => CNN top5 curve: [97.23, 94.68]

Average Accuracy (CNN): 80.1
2024-04-23 20:26:28,928 [trainer.py] => Average Accuracy (CNN): 80.1 

2024-04-23 20:26:28,928 [trainer.py] => Train Time: 17143.329999999998
2024-04-23 20:26:28,928 [trainer.py] => Test Time: 34.769999999999996 

2024-04-23 20:26:28,931 [trainer.py] => All params: 172123992
2024-04-23 20:26:28,933 [trainer.py] => Trainable params: 276780
2024-04-23 20:26:28,933 [l2p.py] => Learning on 180-210

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.317, Train_accy 84.29:   0%|          | 0/20 [01:09<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.317, Train_accy 84.29:   5%|▌         | 1/20 [01:09<22:03, 69.65s/it]
Task 2, Epoch 2/20 => Loss 0.103, Train_accy 90.28:   5%|▌         | 1/20 [02:19<22:03, 69.65s/it]
Task 2, Epoch 2/20 => Loss 0.103, Train_accy 90.28:  10%|█         | 2/20 [02:19<20:55, 69.76s/it]
Task 2, Epoch 3/20 => Loss 0.069, Train_accy 91.23:  10%|█         | 2/20 [03:29<20:55, 69.76s/it]
Task 2, Epoch 3/20 => Loss 0.069, Train_accy 91.23:  15%|█▌        | 3/20 [03:29<19:46, 69.79s/it]
Task 2, Epoch 4/20 => Loss 0.045, Train_accy 91.94:  15%|█▌        | 3/20 [04:39<19:46, 69.79s/it]
Task 2, Epoch 4/20 => Loss 0.045, Train_accy 91.94:  20%|██        | 4/20 [04:39<18:37, 69.87s/it]
Task 2, Epoch 5/20 => Loss 0.050, Train_accy 92.13, Test_accy 65.43:  20%|██        | 4/20 [06:10<18:37, 69.87s/it]
Task 2, Epoch 5/20 => Loss 0.050, Train_accy 92.13, Test_accy 65.43:  25%|██▌       | 5/20 [06:10<19:25, 77.71s/it]
Task 2, Epoch 6/20 => Loss 0.026, Train_accy 92.70:  25%|██▌       | 5/20 [07:20<19:25, 77.71s/it]                 
Task 2, Epoch 6/20 => Loss 0.026, Train_accy 92.70:  30%|███       | 6/20 [07:20<17:30, 75.05s/it]
Task 2, Epoch 7/20 => Loss 0.027, Train_accy 92.73:  30%|███       | 6/20 [08:30<17:30, 75.05s/it]
Task 2, Epoch 7/20 => Loss 0.027, Train_accy 92.73:  35%|███▌      | 7/20 [08:30<15:52, 73.29s/it]
Task 2, Epoch 8/20 => Loss 0.026, Train_accy 92.87:  35%|███▌      | 7/20 [09:40<15:52, 73.29s/it]
Task 2, Epoch 8/20 => Loss 0.026, Train_accy 92.87:  40%|████      | 8/20 [09:40<14:25, 72.14s/it]
Task 2, Epoch 9/20 => Loss 0.001, Train_accy 93.84:  40%|████      | 8/20 [10:49<14:25, 72.14s/it]
Task 2, Epoch 9/20 => Loss 0.001, Train_accy 93.84:  45%|████▌     | 9/20 [10:49<13:05, 71.42s/it]
Task 2, Epoch 10/20 => Loss 0.009, Train_accy 93.50, Test_accy 67.25:  45%|████▌     | 9/20 [12:21<13:05, 71.42s/it]
Task 2, Epoch 10/20 => Loss 0.009, Train_accy 93.50, Test_accy 67.25:  50%|█████     | 10/20 [12:21<12:55, 77.59s/it]
Task 2, Epoch 11/20 => Loss 0.004, Train_accy 93.72:  50%|█████     | 10/20 [13:31<12:55, 77.59s/it]                 
Task 2, Epoch 11/20 => Loss 0.004, Train_accy 93.72:  55%|█████▌    | 11/20 [13:31<11:17, 75.23s/it]
Task 2, Epoch 12/20 => Loss -0.002, Train_accy 94.18:  55%|█████▌    | 11/20 [14:41<11:17, 75.23s/it]
Task 2, Epoch 12/20 => Loss -0.002, Train_accy 94.18:  60%|██████    | 12/20 [14:41<09:48, 73.57s/it]
Task 2, Epoch 13/20 => Loss 0.006, Train_accy 93.40:  60%|██████    | 12/20 [15:51<09:48, 73.57s/it] 
Task 2, Epoch 13/20 => Loss 0.006, Train_accy 93.40:  65%|██████▌   | 13/20 [15:51<08:27, 72.49s/it]
Task 2, Epoch 14/20 => Loss -0.015, Train_accy 94.56:  65%|██████▌   | 13/20 [17:00<08:27, 72.49s/it]
Task 2, Epoch 14/20 => Loss -0.015, Train_accy 94.56:  70%|███████   | 14/20 [17:00<07:09, 71.60s/it]
Task 2, Epoch 15/20 => Loss -0.004, Train_accy 94.27, Test_accy 68.70:  70%|███████   | 14/20 [18:32<07:09, 71.60s/it]
Task 2, Epoch 15/20 => Loss -0.004, Train_accy 94.27, Test_accy 68.70:  75%|███████▌  | 15/20 [18:32<06:28, 77.70s/it]
Task 2, Epoch 16/20 => Loss -0.005, Train_accy 93.97:  75%|███████▌  | 15/20 [19:42<06:28, 77.70s/it]                 
Task 2, Epoch 16/20 => Loss -0.005, Train_accy 93.97:  80%|████████  | 16/20 [19:42<05:01, 75.38s/it]
Task 2, Epoch 17/20 => Loss -0.010, Train_accy 94.18:  80%|████████  | 16/20 [20:52<05:01, 75.38s/it]
Task 2, Epoch 17/20 => Loss -0.010, Train_accy 94.18:  85%|████████▌ | 17/20 [20:52<03:41, 73.70s/it]
Task 2, Epoch 18/20 => Loss -0.021, Train_accy 94.58:  85%|████████▌ | 17/20 [22:02<03:41, 73.70s/it]
Task 2, Epoch 18/20 => Loss -0.021, Train_accy 94.58:  90%|█████████ | 18/20 [22:02<02:25, 72.63s/it]
Task 2, Epoch 19/20 => Loss -0.029, Train_accy 94.70:  90%|█████████ | 18/20 [23:12<02:25, 72.63s/it]
Task 2, Epoch 19/20 => Loss -0.029, Train_accy 94.70:  95%|█████████▌| 19/20 [23:12<01:11, 71.82s/it]
Task 2, Epoch 20/20 => Loss -0.013, Train_accy 94.32, Test_accy 69.44:  95%|█████████▌| 19/20 [24:43<01:11, 71.82s/it]
Task 2, Epoch 20/20 => Loss -0.013, Train_accy 94.32, Test_accy 69.44: 100%|██████████| 20/20 [24:43<00:00, 77.69s/it]
Task 2, Epoch 20/20 => Loss -0.013, Train_accy 94.32, Test_accy 69.44: 100%|██████████| 20/20 [24:43<00:00, 74.18s/it]
2024-04-23 20:51:12,585 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.013, Train_accy 94.32, Test_accy 69.44
2024-04-23 20:51:34,558 [trainer.py] => No NME accuracy.
2024-04-23 20:51:34,559 [trainer.py] => CNN: {'total': 69.44, '00-149': 85.1, '150-179': 25.42, '180-209': 35.01, 'old': 75.17, 'new': 35.01}
2024-04-23 20:51:34,559 [trainer.py] => CNN top1 curve: [84.74, 75.45, 69.44]
2024-04-23 20:51:34,559 [trainer.py] => CNN top5 curve: [97.23, 94.68, 92.0]

Average Accuracy (CNN): 76.54
2024-04-23 20:51:34,559 [trainer.py] => Average Accuracy (CNN): 76.54 

2024-04-23 20:51:34,560 [trainer.py] => Train Time: 20110.59
2024-04-23 20:51:34,560 [trainer.py] => Test Time: 56.739999999999995 

2024-04-23 20:51:34,563 [trainer.py] => All params: 172123992
2024-04-23 20:51:34,565 [trainer.py] => Trainable params: 276780
2024-04-23 20:51:34,565 [l2p.py] => Learning on 210-240

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.374, Train_accy 81.97:   0%|          | 0/20 [01:13<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.374, Train_accy 81.97:   5%|▌         | 1/20 [01:13<23:23, 73.87s/it]
Task 3, Epoch 2/20 => Loss 0.163, Train_accy 88.04:   5%|▌         | 1/20 [02:27<23:23, 73.87s/it]
Task 3, Epoch 2/20 => Loss 0.163, Train_accy 88.04:  10%|█         | 2/20 [02:27<22:08, 73.79s/it]
Task 3, Epoch 3/20 => Loss 0.126, Train_accy 89.14:  10%|█         | 2/20 [03:41<22:08, 73.79s/it]
Task 3, Epoch 3/20 => Loss 0.126, Train_accy 89.14:  15%|█▌        | 3/20 [03:41<20:55, 73.83s/it]
Task 3, Epoch 4/20 => Loss 0.100, Train_accy 90.25:  15%|█▌        | 3/20 [04:55<20:55, 73.83s/it]
Task 3, Epoch 4/20 => Loss 0.100, Train_accy 90.25:  20%|██        | 4/20 [04:55<19:40, 73.80s/it]
Task 3, Epoch 5/20 => Loss 0.078, Train_accy 91.00, Test_accy 62.20:  20%|██        | 4/20 [06:33<19:40, 73.80s/it]
Task 3, Epoch 5/20 => Loss 0.078, Train_accy 91.00, Test_accy 62.20:  25%|██▌       | 5/20 [06:33<20:41, 82.75s/it]
Task 3, Epoch 6/20 => Loss 0.065, Train_accy 91.51:  25%|██▌       | 5/20 [07:47<20:41, 82.75s/it]                 
Task 3, Epoch 6/20 => Loss 0.065, Train_accy 91.51:  30%|███       | 6/20 [07:47<18:35, 79.71s/it]
Task 3, Epoch 7/20 => Loss 0.071, Train_accy 91.07:  30%|███       | 6/20 [09:01<18:35, 79.71s/it]
Task 3, Epoch 7/20 => Loss 0.071, Train_accy 91.07:  35%|███▌      | 7/20 [09:01<16:50, 77.76s/it]
Task 3, Epoch 8/20 => Loss 0.059, Train_accy 91.26:  35%|███▌      | 7/20 [10:15<16:50, 77.76s/it]
Task 3, Epoch 8/20 => Loss 0.059, Train_accy 91.26:  40%|████      | 8/20 [10:15<15:17, 76.49s/it]
Task 3, Epoch 9/20 => Loss 0.055, Train_accy 91.74:  40%|████      | 8/20 [11:28<15:17, 76.49s/it]
Task 3, Epoch 9/20 => Loss 0.055, Train_accy 91.74:  45%|████▌     | 9/20 [11:28<13:51, 75.59s/it]
Task 3, Epoch 10/20 => Loss 0.045, Train_accy 91.97, Test_accy 63.05:  45%|████▌     | 9/20 [13:07<13:51, 75.59s/it]
Task 3, Epoch 10/20 => Loss 0.045, Train_accy 91.97, Test_accy 63.05:  50%|█████     | 10/20 [13:07<13:47, 82.74s/it]
Task 3, Epoch 11/20 => Loss 0.043, Train_accy 92.27:  50%|█████     | 10/20 [14:21<13:47, 82.74s/it]                 
Task 3, Epoch 11/20 => Loss 0.043, Train_accy 92.27:  55%|█████▌    | 11/20 [14:21<11:59, 79.94s/it]
Task 3, Epoch 12/20 => Loss 0.048, Train_accy 91.93:  55%|█████▌    | 11/20 [15:34<11:59, 79.94s/it]
Task 3, Epoch 12/20 => Loss 0.048, Train_accy 91.93:  60%|██████    | 12/20 [15:34<10:24, 78.03s/it]
Task 3, Epoch 13/20 => Loss 0.035, Train_accy 92.33:  60%|██████    | 12/20 [16:48<10:24, 78.03s/it]
Task 3, Epoch 13/20 => Loss 0.035, Train_accy 92.33:  65%|██████▌   | 13/20 [16:48<08:57, 76.74s/it]
Task 3, Epoch 14/20 => Loss 0.026, Train_accy 92.78:  65%|██████▌   | 13/20 [18:02<08:57, 76.74s/it]
Task 3, Epoch 14/20 => Loss 0.026, Train_accy 92.78:  70%|███████   | 14/20 [18:02<07:35, 75.87s/it]
Task 3, Epoch 15/20 => Loss 0.026, Train_accy 92.78, Test_accy 63.97:  70%|███████   | 14/20 [19:41<07:35, 75.87s/it]
Task 3, Epoch 15/20 => Loss 0.026, Train_accy 92.78, Test_accy 63.97:  75%|███████▌  | 15/20 [19:41<06:53, 82.78s/it]
Task 3, Epoch 16/20 => Loss 0.017, Train_accy 93.17:  75%|███████▌  | 15/20 [20:54<06:53, 82.78s/it]                 
Task 3, Epoch 16/20 => Loss 0.017, Train_accy 93.17:  80%|████████  | 16/20 [20:54<05:19, 79.98s/it]
Task 3, Epoch 17/20 => Loss 0.018, Train_accy 92.82:  80%|████████  | 16/20 [22:08<05:19, 79.98s/it]
Task 3, Epoch 17/20 => Loss 0.018, Train_accy 92.82:  85%|████████▌ | 17/20 [22:08<03:54, 78.10s/it]
Task 3, Epoch 18/20 => Loss 0.012, Train_accy 93.26:  85%|████████▌ | 17/20 [23:21<03:54, 78.10s/it]
Task 3, Epoch 18/20 => Loss 0.012, Train_accy 93.26:  90%|█████████ | 18/20 [23:21<02:33, 76.73s/it]
Task 3, Epoch 19/20 => Loss 0.008, Train_accy 93.12:  90%|█████████ | 18/20 [24:35<02:33, 76.73s/it]
Task 3, Epoch 19/20 => Loss 0.008, Train_accy 93.12:  95%|█████████▌| 19/20 [24:35<01:15, 75.88s/it]
Task 3, Epoch 20/20 => Loss 0.024, Train_accy 92.98, Test_accy 64.81:  95%|█████████▌| 19/20 [26:14<01:15, 75.88s/it]
Task 3, Epoch 20/20 => Loss 0.024, Train_accy 92.98, Test_accy 64.81: 100%|██████████| 20/20 [26:14<00:00, 82.63s/it]
Task 3, Epoch 20/20 => Loss 0.024, Train_accy 92.98, Test_accy 64.81: 100%|██████████| 20/20 [26:14<00:00, 78.71s/it]
2024-04-23 21:17:48,819 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.024, Train_accy 92.98, Test_accy 64.81
2024-04-23 21:18:13,808 [trainer.py] => No NME accuracy.
2024-04-23 21:18:13,808 [trainer.py] => CNN: {'total': 64.81, '00-149': 85.34, '150-179': 26.25, '180-209': 36.01, '210-239': 29.38, 'old': 69.87, 'new': 29.38}
2024-04-23 21:18:13,808 [trainer.py] => CNN top1 curve: [84.74, 75.45, 69.44, 64.81]
2024-04-23 21:18:13,808 [trainer.py] => CNN top5 curve: [97.23, 94.68, 92.0, 89.7]

Average Accuracy (CNN): 73.61
2024-04-23 21:18:13,808 [trainer.py] => Average Accuracy (CNN): 73.61 

2024-04-23 21:18:13,808 [trainer.py] => Train Time: 23259.05
2024-04-23 21:18:13,808 [trainer.py] => Test Time: 81.72999999999999 

2024-04-23 21:18:13,810 [trainer.py] => All params: 172123992
2024-04-23 21:18:13,812 [trainer.py] => Trainable params: 276780
2024-04-23 21:18:13,812 [l2p.py] => Learning on 240-270

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.217, Train_accy 89.56:   0%|          | 0/20 [01:12<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.217, Train_accy 89.56:   5%|▌         | 1/20 [01:12<22:56, 72.47s/it]
Task 4, Epoch 2/20 => Loss 0.020, Train_accy 93.98:   5%|▌         | 1/20 [02:24<22:56, 72.47s/it]
Task 4, Epoch 2/20 => Loss 0.020, Train_accy 93.98:  10%|█         | 2/20 [02:24<21:42, 72.35s/it]
Task 4, Epoch 3/20 => Loss -0.003, Train_accy 94.86:  10%|█         | 2/20 [03:37<21:42, 72.35s/it]
Task 4, Epoch 3/20 => Loss -0.003, Train_accy 94.86:  15%|█▌        | 3/20 [03:37<20:31, 72.44s/it]
Task 4, Epoch 4/20 => Loss -0.003, Train_accy 94.86:  15%|█▌        | 3/20 [04:49<20:31, 72.44s/it]
Task 4, Epoch 4/20 => Loss -0.003, Train_accy 94.86:  20%|██        | 4/20 [04:49<19:18, 72.42s/it]
Task 4, Epoch 5/20 => Loss -0.024, Train_accy 95.16, Test_accy 57.68:  20%|██        | 4/20 [06:29<19:18, 72.42s/it]
Task 4, Epoch 5/20 => Loss -0.024, Train_accy 95.16, Test_accy 57.68:  25%|██▌       | 5/20 [06:29<20:37, 82.47s/it]
Task 4, Epoch 6/20 => Loss -0.024, Train_accy 95.30:  25%|██▌       | 5/20 [07:42<20:37, 82.47s/it]                 
Task 4, Epoch 6/20 => Loss -0.024, Train_accy 95.30:  30%|███       | 6/20 [07:42<18:27, 79.10s/it]
Task 4, Epoch 7/20 => Loss -0.030, Train_accy 95.59:  30%|███       | 6/20 [08:54<18:27, 79.10s/it]
Task 4, Epoch 7/20 => Loss -0.030, Train_accy 95.59:  35%|███▌      | 7/20 [08:54<16:39, 76.85s/it]
Task 4, Epoch 8/20 => Loss -0.036, Train_accy 95.85:  35%|███▌      | 7/20 [10:06<16:39, 76.85s/it]
Task 4, Epoch 8/20 => Loss -0.036, Train_accy 95.85:  40%|████      | 8/20 [10:06<15:04, 75.35s/it]
Task 4, Epoch 9/20 => Loss -0.041, Train_accy 95.85:  40%|████      | 8/20 [11:18<15:04, 75.35s/it]
Task 4, Epoch 9/20 => Loss -0.041, Train_accy 95.85:  45%|████▌     | 9/20 [11:18<13:37, 74.33s/it]
Task 4, Epoch 10/20 => Loss -0.036, Train_accy 95.51, Test_accy 58.94:  45%|████▌     | 9/20 [12:58<13:37, 74.33s/it]
Task 4, Epoch 10/20 => Loss -0.036, Train_accy 95.51, Test_accy 58.94:  50%|█████     | 10/20 [12:58<13:42, 82.21s/it]
Task 4, Epoch 11/20 => Loss -0.037, Train_accy 95.65:  50%|█████     | 10/20 [14:10<13:42, 82.21s/it]                 
Task 4, Epoch 11/20 => Loss -0.037, Train_accy 95.65:  55%|█████▌    | 11/20 [14:10<11:52, 79.12s/it]
Task 4, Epoch 12/20 => Loss -0.040, Train_accy 95.99:  55%|█████▌    | 11/20 [15:22<11:52, 79.12s/it]
Task 4, Epoch 12/20 => Loss -0.040, Train_accy 95.99:  60%|██████    | 12/20 [15:22<10:15, 76.95s/it]
Task 4, Epoch 13/20 => Loss -0.052, Train_accy 96.24:  60%|██████    | 12/20 [16:35<10:15, 76.95s/it]
Task 4, Epoch 13/20 => Loss -0.052, Train_accy 96.24:  65%|██████▌   | 13/20 [16:35<08:48, 75.54s/it]
Task 4, Epoch 14/20 => Loss -0.061, Train_accy 96.54:  65%|██████▌   | 13/20 [17:47<08:48, 75.54s/it]
Task 4, Epoch 14/20 => Loss -0.061, Train_accy 96.54:  70%|███████   | 14/20 [17:47<07:26, 74.49s/it]
Task 4, Epoch 15/20 => Loss -0.049, Train_accy 96.20, Test_accy 59.61:  70%|███████   | 14/20 [19:27<07:26, 74.49s/it]
Task 4, Epoch 15/20 => Loss -0.049, Train_accy 96.20, Test_accy 59.61:  75%|███████▌  | 15/20 [19:27<06:50, 82.19s/it]
Task 4, Epoch 16/20 => Loss -0.056, Train_accy 96.55:  75%|███████▌  | 15/20 [20:39<06:50, 82.19s/it]                 
Task 4, Epoch 16/20 => Loss -0.056, Train_accy 96.55:  80%|████████  | 16/20 [20:39<05:17, 79.26s/it]
Task 4, Epoch 17/20 => Loss -0.044, Train_accy 96.02:  80%|████████  | 16/20 [21:52<05:17, 79.26s/it]
Task 4, Epoch 17/20 => Loss -0.044, Train_accy 96.02:  85%|████████▌ | 17/20 [21:52<03:51, 77.24s/it]
Task 4, Epoch 18/20 => Loss -0.047, Train_accy 96.08:  85%|████████▌ | 17/20 [23:05<03:51, 77.24s/it]
Task 4, Epoch 18/20 => Loss -0.047, Train_accy 96.08:  90%|█████████ | 18/20 [23:05<02:31, 75.93s/it]
Task 4, Epoch 19/20 => Loss -0.054, Train_accy 96.45:  90%|█████████ | 18/20 [24:17<02:31, 75.93s/it]
Task 4, Epoch 19/20 => Loss -0.054, Train_accy 96.45:  95%|█████████▌| 19/20 [24:17<01:14, 74.88s/it]
Task 4, Epoch 20/20 => Loss -0.059, Train_accy 96.40, Test_accy 60.79:  95%|█████████▌| 19/20 [25:58<01:14, 74.88s/it]
Task 4, Epoch 20/20 => Loss -0.059, Train_accy 96.40, Test_accy 60.79: 100%|██████████| 20/20 [25:58<00:00, 82.64s/it]
Task 4, Epoch 20/20 => Loss -0.059, Train_accy 96.40, Test_accy 60.79: 100%|██████████| 20/20 [25:58<00:00, 77.92s/it]
2024-04-23 21:44:12,207 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.059, Train_accy 96.40, Test_accy 60.79
2024-04-23 21:44:40,186 [trainer.py] => No NME accuracy.
2024-04-23 21:44:40,187 [trainer.py] => CNN: {'total': 60.79, '00-149': 84.94, '150-179': 24.92, '180-209': 35.34, '210-239': 29.38, '240-269': 32.72, 'old': 64.31, 'new': 32.72}
2024-04-23 21:44:40,187 [trainer.py] => CNN top1 curve: [84.74, 75.45, 69.44, 64.81, 60.79]
2024-04-23 21:44:40,187 [trainer.py] => CNN top5 curve: [97.23, 94.68, 92.0, 89.7, 88.47]

Average Accuracy (CNN): 71.05
2024-04-23 21:44:40,187 [trainer.py] => Average Accuracy (CNN): 71.05 

2024-04-23 21:44:40,187 [trainer.py] => Train Time: 26375.8
2024-04-23 21:44:40,188 [trainer.py] => Test Time: 109.71 

2024-04-23 21:44:40,191 [trainer.py] => All params: 172123992
2024-04-23 21:44:40,193 [trainer.py] => Trainable params: 276780
2024-04-23 21:44:40,193 [l2p.py] => Learning on 270-300

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.219, Train_accy 88.53:   0%|          | 0/20 [01:08<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.219, Train_accy 88.53:   5%|▌         | 1/20 [01:08<21:36, 68.25s/it]
Task 5, Epoch 2/20 => Loss 0.027, Train_accy 93.23:   5%|▌         | 1/20 [02:16<21:36, 68.25s/it]
Task 5, Epoch 2/20 => Loss 0.027, Train_accy 93.23:  10%|█         | 2/20 [02:16<20:29, 68.31s/it]
Task 5, Epoch 3/20 => Loss 0.014, Train_accy 93.76:  10%|█         | 2/20 [03:24<20:29, 68.31s/it]
Task 5, Epoch 3/20 => Loss 0.014, Train_accy 93.76:  15%|█▌        | 3/20 [03:24<19:21, 68.35s/it]
Task 5, Epoch 4/20 => Loss -0.005, Train_accy 94.16:  15%|█▌        | 3/20 [04:33<19:21, 68.35s/it]
Task 5, Epoch 4/20 => Loss -0.005, Train_accy 94.16:  20%|██        | 4/20 [04:33<18:16, 68.54s/it]
Task 5, Epoch 5/20 => Loss -0.020, Train_accy 94.92, Test_accy 54.92:  20%|██        | 4/20 [06:13<18:16, 68.54s/it]
Task 5, Epoch 5/20 => Loss -0.020, Train_accy 94.92, Test_accy 54.92:  25%|██▌       | 5/20 [06:13<19:56, 79.74s/it]
Task 5, Epoch 6/20 => Loss -0.024, Train_accy 95.10:  25%|██▌       | 5/20 [07:22<19:56, 79.74s/it]                 
Task 5, Epoch 6/20 => Loss -0.024, Train_accy 95.10:  30%|███       | 6/20 [07:22<17:43, 75.96s/it]
Task 5, Epoch 7/20 => Loss -0.022, Train_accy 95.03:  30%|███       | 6/20 [08:30<17:43, 75.96s/it]
Task 5, Epoch 7/20 => Loss -0.022, Train_accy 95.03:  35%|███▌      | 7/20 [08:30<15:54, 73.40s/it]
Task 5, Epoch 8/20 => Loss -0.037, Train_accy 95.45:  35%|███▌      | 7/20 [09:38<15:54, 73.40s/it]
Task 5, Epoch 8/20 => Loss -0.037, Train_accy 95.45:  40%|████      | 8/20 [09:38<14:21, 71.83s/it]
Task 5, Epoch 9/20 => Loss -0.028, Train_accy 95.25:  40%|████      | 8/20 [10:46<14:21, 71.83s/it]
Task 5, Epoch 9/20 => Loss -0.028, Train_accy 95.25:  45%|████▌     | 9/20 [10:46<12:57, 70.66s/it]
Task 5, Epoch 10/20 => Loss -0.036, Train_accy 95.69, Test_accy 56.16:  45%|████▌     | 9/20 [12:26<12:57, 70.66s/it]
Task 5, Epoch 10/20 => Loss -0.036, Train_accy 95.69, Test_accy 56.16:  50%|█████     | 10/20 [12:26<13:16, 79.63s/it]
Task 5, Epoch 11/20 => Loss -0.037, Train_accy 95.66:  50%|█████     | 10/20 [13:34<13:16, 79.63s/it]                 
Task 5, Epoch 11/20 => Loss -0.037, Train_accy 95.66:  55%|█████▌    | 11/20 [13:34<11:25, 76.14s/it]
Task 5, Epoch 12/20 => Loss -0.046, Train_accy 95.74:  55%|█████▌    | 11/20 [14:43<11:25, 76.14s/it]
Task 5, Epoch 12/20 => Loss -0.046, Train_accy 95.74:  60%|██████    | 12/20 [14:43<09:50, 73.83s/it]
Task 5, Epoch 13/20 => Loss -0.049, Train_accy 95.92:  60%|██████    | 12/20 [15:51<09:50, 73.83s/it]
Task 5, Epoch 13/20 => Loss -0.049, Train_accy 95.92:  65%|██████▌   | 13/20 [15:51<08:25, 72.24s/it]
Task 5, Epoch 14/20 => Loss -0.056, Train_accy 96.18:  65%|██████▌   | 13/20 [17:00<08:25, 72.24s/it]
Task 5, Epoch 14/20 => Loss -0.056, Train_accy 96.18:  70%|███████   | 14/20 [17:00<07:06, 71.09s/it]
Task 5, Epoch 15/20 => Loss -0.048, Train_accy 96.07, Test_accy 56.91:  70%|███████   | 14/20 [18:40<07:06, 71.09s/it]
Task 5, Epoch 15/20 => Loss -0.048, Train_accy 96.07, Test_accy 56.91:  75%|███████▌  | 15/20 [18:40<06:39, 79.82s/it]
Task 5, Epoch 16/20 => Loss -0.049, Train_accy 96.01:  75%|███████▌  | 15/20 [19:48<06:39, 79.82s/it]                 
Task 5, Epoch 16/20 => Loss -0.049, Train_accy 96.01:  80%|████████  | 16/20 [19:48<05:05, 76.42s/it]
Task 5, Epoch 17/20 => Loss -0.046, Train_accy 96.09:  80%|████████  | 16/20 [20:57<05:05, 76.42s/it]
Task 5, Epoch 17/20 => Loss -0.046, Train_accy 96.09:  85%|████████▌ | 17/20 [20:57<03:41, 73.98s/it]
Task 5, Epoch 18/20 => Loss -0.054, Train_accy 96.22:  85%|████████▌ | 17/20 [22:05<03:41, 73.98s/it]
Task 5, Epoch 18/20 => Loss -0.054, Train_accy 96.22:  90%|█████████ | 18/20 [22:05<02:24, 72.27s/it]
Task 5, Epoch 19/20 => Loss -0.053, Train_accy 95.95:  90%|█████████ | 18/20 [23:13<02:24, 72.27s/it]
Task 5, Epoch 19/20 => Loss -0.053, Train_accy 95.95:  95%|█████████▌| 19/20 [23:13<01:11, 71.06s/it]
Task 5, Epoch 20/20 => Loss -0.041, Train_accy 95.62, Test_accy 58.10:  95%|█████████▌| 19/20 [24:53<01:11, 71.06s/it]
Task 5, Epoch 20/20 => Loss -0.041, Train_accy 95.62, Test_accy 58.10: 100%|██████████| 20/20 [24:53<00:00, 79.58s/it]
Task 5, Epoch 20/20 => Loss -0.041, Train_accy 95.62, Test_accy 58.10: 100%|██████████| 20/20 [24:53<00:00, 74.65s/it]
2024-04-23 22:09:33,283 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.041, Train_accy 95.62, Test_accy 58.10
2024-04-23 22:10:04,126 [trainer.py] => No NME accuracy.
2024-04-23 22:10:04,127 [trainer.py] => CNN: {'total': 58.1, '00-149': 84.84, '150-179': 25.92, '180-209': 36.01, '210-239': 28.71, '240-269': 31.72, '270-299': 34.28, 'old': 60.74, 'new': 34.28}
2024-04-23 22:10:04,127 [trainer.py] => CNN top1 curve: [84.74, 75.45, 69.44, 64.81, 60.79, 58.1]
2024-04-23 22:10:04,127 [trainer.py] => CNN top5 curve: [97.23, 94.68, 92.0, 89.7, 88.47, 87.87]

Average Accuracy (CNN): 68.89
2024-04-23 22:10:04,127 [trainer.py] => Average Accuracy (CNN): 68.89 

2024-04-23 22:10:04,127 [trainer.py] => Train Time: 29361.93
2024-04-23 22:10:04,127 [trainer.py] => Test Time: 140.54999999999998 

Accuracy Matrix (CNN):
[[84.74 85.04 85.1  85.34 84.94 84.84]
 [ 0.   27.42 25.42 26.25 24.92 25.92]
 [ 0.    0.   35.01 36.01 35.34 36.01]
 [ 0.    0.    0.   29.38 29.38 28.71]
 [ 0.    0.    0.    0.   32.72 31.72]
 [ 0.    0.    0.    0.    0.   34.28]]
2024-04-23 22:10:04,129 [trainer.py] => Forgetting (CNN): 0.7339999999999997
2024-04-23 22:10:06,919 [trainer.py] => config: ./exps/dualprompt_omn_B150.json
2024-04-23 22:10:06,919 [trainer.py] => prefix:  
2024-04-23 22:10:06,919 [trainer.py] => dataset: omnibenchmark
2024-04-23 22:10:06,919 [trainer.py] => memory_size: 0
2024-04-23 22:10:06,919 [trainer.py] => memory_per_class: 0
2024-04-23 22:10:06,919 [trainer.py] => fixed_memory: False
2024-04-23 22:10:06,919 [trainer.py] => shuffle: True
2024-04-23 22:10:06,919 [trainer.py] => init_cls: 150
2024-04-23 22:10:06,919 [trainer.py] => increment: 30
2024-04-23 22:10:06,919 [trainer.py] => model_name: dualprompt
2024-04-23 22:10:06,919 [trainer.py] => backbone_type: vit_base_patch16_224_dualprompt
2024-04-23 22:10:06,919 [trainer.py] => get_original_backbone: True
2024-04-23 22:10:06,919 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-23 22:10:06,919 [trainer.py] => seed: 1993
2024-04-23 22:10:06,919 [trainer.py] => tuned_epoch: 20
2024-04-23 22:10:06,919 [trainer.py] => init_lr: 0.001
2024-04-23 22:10:06,919 [trainer.py] => batch_size: 48
2024-04-23 22:10:06,919 [trainer.py] => weight_decay: 0
2024-04-23 22:10:06,919 [trainer.py] => min_lr: 1e-05
2024-04-23 22:10:06,919 [trainer.py] => optimizer: adam
2024-04-23 22:10:06,919 [trainer.py] => scheduler: constant
2024-04-23 22:10:06,919 [trainer.py] => reinit_optimizer: True
2024-04-23 22:10:06,919 [trainer.py] => global_pool: token
2024-04-23 22:10:06,919 [trainer.py] => head_type: token
2024-04-23 22:10:06,919 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-23 22:10:06,919 [trainer.py] => pretrained: True
2024-04-23 22:10:06,919 [trainer.py] => drop: 0.0
2024-04-23 22:10:06,919 [trainer.py] => drop_path: 0.0
2024-04-23 22:10:06,919 [trainer.py] => use_g_prompt: True
2024-04-23 22:10:06,920 [trainer.py] => g_prompt_length: 5
2024-04-23 22:10:06,920 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-04-23 22:10:06,920 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-04-23 22:10:06,920 [trainer.py] => use_e_prompt: True
2024-04-23 22:10:06,920 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-04-23 22:10:06,920 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-04-23 22:10:06,920 [trainer.py] => prompt_pool: True
2024-04-23 22:10:06,920 [trainer.py] => size: 10
2024-04-23 22:10:06,920 [trainer.py] => length: 5
2024-04-23 22:10:06,920 [trainer.py] => top_k: 1
2024-04-23 22:10:06,920 [trainer.py] => initializer: uniform
2024-04-23 22:10:06,920 [trainer.py] => prompt_key: True
2024-04-23 22:10:06,920 [trainer.py] => prompt_key_init: uniform
2024-04-23 22:10:06,920 [trainer.py] => use_prompt_mask: True
2024-04-23 22:10:06,920 [trainer.py] => shared_prompt_pool: True
2024-04-23 22:10:06,920 [trainer.py] => shared_prompt_key: False
2024-04-23 22:10:06,920 [trainer.py] => batchwise_prompt: True
2024-04-23 22:10:06,920 [trainer.py] => embedding_key: cls
2024-04-23 22:10:06,920 [trainer.py] => predefined_key: 
2024-04-23 22:10:06,920 [trainer.py] => pull_constraint: True
2024-04-23 22:10:06,920 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-23 22:10:06,920 [trainer.py] => same_key_value: False
2024-04-23 22:10:07,178 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
2024-04-23 22:10:12,713 [dualprompt.py] => 86,282,796 model total parameters.
2024-04-23 22:10:12,713 [dualprompt.py] => 484,140 model training parameters.
2024-04-23 22:10:12,713 [dualprompt.py] => g_prompt: 15360
2024-04-23 22:10:12,713 [dualprompt.py] => e_prompt.prompt: 230400
2024-04-23 22:10:12,713 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-04-23 22:10:12,714 [dualprompt.py] => head.weight: 230400
2024-04-23 22:10:12,714 [dualprompt.py] => head.bias: 300
2024-04-23 22:10:12,715 [trainer.py] => All params: 172312152
2024-04-23 22:10:12,716 [trainer.py] => Trainable params: 484140
2024-04-23 22:10:12,716 [dualprompt.py] => Learning on 0-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.169, Train_accy 70.55:   0%|          | 0/20 [05:24<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.169, Train_accy 70.55:   5%|▌         | 1/20 [05:24<1:42:47, 324.63s/it]
Task 0, Epoch 2/20 => Loss 0.755, Train_accy 78.23:   5%|▌         | 1/20 [10:46<1:42:47, 324.63s/it]
Task 0, Epoch 2/20 => Loss 0.755, Train_accy 78.23:  10%|█         | 2/20 [10:46<1:36:55, 323.09s/it]
Task 0, Epoch 3/20 => Loss 0.682, Train_accy 79.75:  10%|█         | 2/20 [16:08<1:36:55, 323.09s/it]
Task 0, Epoch 3/20 => Loss 0.682, Train_accy 79.75:  15%|█▌        | 3/20 [16:08<1:31:20, 322.36s/it]
Task 0, Epoch 4/20 => Loss 0.651, Train_accy 80.67:  15%|█▌        | 3/20 [21:29<1:31:20, 322.36s/it]
Task 0, Epoch 4/20 => Loss 0.651, Train_accy 80.67:  20%|██        | 4/20 [21:29<1:25:49, 321.87s/it]
Task 0, Epoch 5/20 => Loss 0.621, Train_accy 81.29, Test_accy 83.23:  20%|██        | 4/20 [27:04<1:25:49, 321.87s/it]
Task 0, Epoch 5/20 => Loss 0.621, Train_accy 81.29, Test_accy 83.23:  25%|██▌       | 5/20 [27:04<1:21:40, 326.71s/it]
Task 0, Epoch 6/20 => Loss 0.605, Train_accy 81.84:  25%|██▌       | 5/20 [32:25<1:21:40, 326.71s/it]                 
Task 0, Epoch 6/20 => Loss 0.605, Train_accy 81.84:  30%|███       | 6/20 [32:25<1:15:44, 324.64s/it]
Task 0, Epoch 7/20 => Loss 0.596, Train_accy 82.27:  30%|███       | 6/20 [37:45<1:15:44, 324.64s/it]
Task 0, Epoch 7/20 => Loss 0.596, Train_accy 82.27:  35%|███▌      | 7/20 [37:45<1:10:01, 323.18s/it]
Task 0, Epoch 8/20 => Loss 0.570, Train_accy 82.83:  35%|███▌      | 7/20 [43:05<1:10:01, 323.18s/it]
Task 0, Epoch 8/20 => Loss 0.570, Train_accy 82.83:  40%|████      | 8/20 [43:05<1:04:28, 322.35s/it]
Task 0, Epoch 9/20 => Loss 0.566, Train_accy 82.87:  40%|████      | 8/20 [48:26<1:04:28, 322.35s/it]
Task 0, Epoch 9/20 => Loss 0.566, Train_accy 82.87:  45%|████▌     | 9/20 [48:26<58:58, 321.73s/it]  
Task 0, Epoch 10/20 => Loss 0.550, Train_accy 83.39, Test_accy 84.03:  45%|████▌     | 9/20 [54:02<58:58, 321.73s/it]
Task 0, Epoch 10/20 => Loss 0.550, Train_accy 83.39, Test_accy 84.03:  50%|█████     | 10/20 [54:02<54:22, 326.25s/it]
Task 0, Epoch 11/20 => Loss 0.550, Train_accy 83.46:  50%|█████     | 10/20 [59:24<54:22, 326.25s/it]                 
Task 0, Epoch 11/20 => Loss 0.550, Train_accy 83.46:  55%|█████▌    | 11/20 [59:24<48:44, 324.90s/it]
Task 0, Epoch 12/20 => Loss 0.543, Train_accy 83.76:  55%|█████▌    | 11/20 [1:04:43<48:44, 324.90s/it]
Task 0, Epoch 12/20 => Loss 0.543, Train_accy 83.76:  60%|██████    | 12/20 [1:04:43<43:06, 323.25s/it]
Task 0, Epoch 13/20 => Loss 0.528, Train_accy 84.18:  60%|██████    | 12/20 [1:10:03<43:06, 323.25s/it]
Task 0, Epoch 13/20 => Loss 0.528, Train_accy 84.18:  65%|██████▌   | 13/20 [1:10:03<37:35, 322.16s/it]
Task 0, Epoch 14/20 => Loss 0.515, Train_accy 84.50:  65%|██████▌   | 13/20 [1:15:25<37:35, 322.16s/it]
Task 0, Epoch 14/20 => Loss 0.515, Train_accy 84.50:  70%|███████   | 14/20 [1:15:25<32:12, 322.09s/it]
Task 0, Epoch 15/20 => Loss 0.507, Train_accy 84.58, Test_accy 83.63:  70%|███████   | 14/20 [1:21:01<32:12, 322.09s/it]
Task 0, Epoch 15/20 => Loss 0.507, Train_accy 84.58, Test_accy 83.63:  75%|███████▌  | 15/20 [1:21:01<27:11, 326.39s/it]
Task 0, Epoch 16/20 => Loss 0.505, Train_accy 84.74:  75%|███████▌  | 15/20 [1:26:20<27:11, 326.39s/it]                 
Task 0, Epoch 16/20 => Loss 0.505, Train_accy 84.74:  80%|████████  | 16/20 [1:26:20<21:36, 324.18s/it]
Task 0, Epoch 17/20 => Loss 0.496, Train_accy 85.08:  80%|████████  | 16/20 [1:31:40<21:36, 324.18s/it]
Task 0, Epoch 17/20 => Loss 0.496, Train_accy 85.08:  85%|████████▌ | 17/20 [1:31:40<16:08, 322.74s/it]
Task 0, Epoch 18/20 => Loss 0.501, Train_accy 85.02:  85%|████████▌ | 17/20 [1:36:59<16:08, 322.74s/it]
Task 0, Epoch 18/20 => Loss 0.501, Train_accy 85.02:  90%|█████████ | 18/20 [1:36:59<10:43, 321.80s/it]
Task 0, Epoch 19/20 => Loss 0.493, Train_accy 85.05:  90%|█████████ | 18/20 [1:42:18<10:43, 321.80s/it]
Task 0, Epoch 19/20 => Loss 0.493, Train_accy 85.05:  95%|█████████▌| 19/20 [1:42:18<05:20, 320.79s/it]
Task 0, Epoch 20/20 => Loss 0.483, Train_accy 85.27, Test_accy 84.47:  95%|█████████▌| 19/20 [1:47:52<05:20, 320.79s/it]
Task 0, Epoch 20/20 => Loss 0.483, Train_accy 85.27, Test_accy 84.47: 100%|██████████| 20/20 [1:47:52<00:00, 324.78s/it]
Task 0, Epoch 20/20 => Loss 0.483, Train_accy 85.27, Test_accy 84.47: 100%|██████████| 20/20 [1:47:52<00:00, 323.62s/it]
2024-04-23 23:58:05,742 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.483, Train_accy 85.27, Test_accy 84.47
2024-04-23 23:58:20,588 [trainer.py] => No NME accuracy.
2024-04-23 23:58:20,589 [trainer.py] => CNN: {'total': 84.47, '00-149': 84.47, 'old': 0, 'new': 84.47}
2024-04-23 23:58:20,589 [trainer.py] => CNN top1 curve: [84.47]
2024-04-23 23:58:20,589 [trainer.py] => CNN top5 curve: [96.96]

Average Accuracy (CNN): 84.47
2024-04-23 23:58:20,589 [trainer.py] => Average Accuracy (CNN): 84.47 

2024-04-23 23:58:20,590 [trainer.py] => Train Time: 12945.439999999999
2024-04-23 23:58:20,590 [trainer.py] => Test Time: 14.84 

2024-04-23 23:58:20,592 [trainer.py] => All params: 172312152
2024-04-23 23:58:20,594 [trainer.py] => Trainable params: 484140
2024-04-23 23:58:20,595 [dualprompt.py] => Learning on 150-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.618, Train_accy 81.77:   0%|          | 0/20 [01:03<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.618, Train_accy 81.77:   5%|▌         | 1/20 [01:03<20:05, 63.45s/it]
Task 1, Epoch 2/20 => Loss 0.322, Train_accy 89.06:   5%|▌         | 1/20 [02:06<20:05, 63.45s/it]
Task 1, Epoch 2/20 => Loss 0.322, Train_accy 89.06:  10%|█         | 2/20 [02:06<19:01, 63.43s/it]
Task 1, Epoch 3/20 => Loss 0.265, Train_accy 90.87:  10%|█         | 2/20 [03:10<19:01, 63.43s/it]
Task 1, Epoch 3/20 => Loss 0.265, Train_accy 90.87:  15%|█▌        | 3/20 [03:10<17:58, 63.42s/it]
Task 1, Epoch 4/20 => Loss 0.221, Train_accy 92.09:  15%|█▌        | 3/20 [04:13<17:58, 63.42s/it]
Task 1, Epoch 4/20 => Loss 0.221, Train_accy 92.09:  20%|██        | 4/20 [04:13<16:55, 63.47s/it]
Task 1, Epoch 5/20 => Loss 0.194, Train_accy 93.02, Test_accy 72.80:  20%|██        | 4/20 [05:34<16:55, 63.47s/it]
Task 1, Epoch 5/20 => Loss 0.194, Train_accy 93.02, Test_accy 72.80:  25%|██▌       | 5/20 [05:34<17:27, 69.82s/it]
Task 1, Epoch 6/20 => Loss 0.184, Train_accy 93.08:  25%|██▌       | 5/20 [06:38<17:27, 69.82s/it]                 
Task 1, Epoch 6/20 => Loss 0.184, Train_accy 93.08:  30%|███       | 6/20 [06:38<15:47, 67.65s/it]
Task 1, Epoch 7/20 => Loss 0.178, Train_accy 93.20:  30%|███       | 6/20 [07:42<15:47, 67.65s/it]
Task 1, Epoch 7/20 => Loss 0.178, Train_accy 93.20:  35%|███▌      | 7/20 [07:42<14:22, 66.36s/it]
Task 1, Epoch 8/20 => Loss 0.157, Train_accy 93.51:  35%|███▌      | 7/20 [08:45<14:22, 66.36s/it]
Task 1, Epoch 8/20 => Loss 0.157, Train_accy 93.51:  40%|████      | 8/20 [08:45<13:05, 65.49s/it]
Task 1, Epoch 9/20 => Loss 0.161, Train_accy 93.52:  40%|████      | 8/20 [09:49<13:05, 65.49s/it]
Task 1, Epoch 9/20 => Loss 0.161, Train_accy 93.52:  45%|████▌     | 9/20 [09:49<11:53, 64.90s/it]
Task 1, Epoch 10/20 => Loss 0.139, Train_accy 94.40, Test_accy 74.08:  45%|████▌     | 9/20 [11:10<11:53, 64.90s/it]
Task 1, Epoch 10/20 => Loss 0.139, Train_accy 94.40, Test_accy 74.08:  50%|█████     | 10/20 [11:10<11:39, 69.95s/it]
Task 1, Epoch 11/20 => Loss 0.144, Train_accy 94.08:  50%|█████     | 10/20 [12:14<11:39, 69.95s/it]                 
Task 1, Epoch 11/20 => Loss 0.144, Train_accy 94.08:  55%|█████▌    | 11/20 [12:14<10:11, 67.99s/it]
Task 1, Epoch 12/20 => Loss 0.146, Train_accy 93.99:  55%|█████▌    | 11/20 [13:17<10:11, 67.99s/it]
Task 1, Epoch 12/20 => Loss 0.146, Train_accy 93.99:  60%|██████    | 12/20 [13:17<08:53, 66.64s/it]
Task 1, Epoch 13/20 => Loss 0.143, Train_accy 94.02:  60%|██████    | 12/20 [14:21<08:53, 66.64s/it]
Task 1, Epoch 13/20 => Loss 0.143, Train_accy 94.02:  65%|██████▌   | 13/20 [14:21<07:40, 65.72s/it]
Task 1, Epoch 14/20 => Loss 0.136, Train_accy 94.37:  65%|██████▌   | 13/20 [15:24<07:40, 65.72s/it]
Task 1, Epoch 14/20 => Loss 0.136, Train_accy 94.37:  70%|███████   | 14/20 [15:24<06:30, 65.06s/it]
Task 1, Epoch 15/20 => Loss 0.139, Train_accy 94.34, Test_accy 74.83:  70%|███████   | 14/20 [16:46<06:30, 65.06s/it]
Task 1, Epoch 15/20 => Loss 0.139, Train_accy 94.34, Test_accy 74.83:  75%|███████▌  | 15/20 [16:46<05:50, 70.01s/it]
Task 1, Epoch 16/20 => Loss 0.137, Train_accy 94.24:  75%|███████▌  | 15/20 [17:49<05:50, 70.01s/it]                 
Task 1, Epoch 16/20 => Loss 0.137, Train_accy 94.24:  80%|████████  | 16/20 [17:49<04:32, 68.11s/it]
Task 1, Epoch 17/20 => Loss 0.122, Train_accy 95.13:  80%|████████  | 16/20 [18:53<04:32, 68.11s/it]
Task 1, Epoch 17/20 => Loss 0.122, Train_accy 95.13:  85%|████████▌ | 17/20 [18:53<03:20, 66.71s/it]
Task 1, Epoch 18/20 => Loss 0.131, Train_accy 94.34:  85%|████████▌ | 17/20 [19:57<03:20, 66.71s/it]
Task 1, Epoch 18/20 => Loss 0.131, Train_accy 94.34:  90%|█████████ | 18/20 [19:57<02:11, 65.95s/it]
Task 1, Epoch 19/20 => Loss 0.134, Train_accy 94.63:  90%|█████████ | 18/20 [21:01<02:11, 65.95s/it]
Task 1, Epoch 19/20 => Loss 0.134, Train_accy 94.63:  95%|█████████▌| 19/20 [21:01<01:05, 65.28s/it]
Task 1, Epoch 20/20 => Loss 0.119, Train_accy 94.93, Test_accy 75.61:  95%|█████████▌| 19/20 [22:23<01:05, 65.28s/it]
Task 1, Epoch 20/20 => Loss 0.119, Train_accy 94.93, Test_accy 75.61: 100%|██████████| 20/20 [22:23<00:00, 70.29s/it]
Task 1, Epoch 20/20 => Loss 0.119, Train_accy 94.93, Test_accy 75.61: 100%|██████████| 20/20 [22:23<00:00, 67.16s/it]
2024-04-24 00:20:43,878 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.119, Train_accy 94.93, Test_accy 75.61
2024-04-24 00:21:01,884 [trainer.py] => No NME accuracy.
2024-04-24 00:21:01,884 [trainer.py] => CNN: {'total': 75.61, '00-149': 84.07, '150-179': 33.28, 'old': 84.07, 'new': 33.28}
2024-04-24 00:21:01,884 [trainer.py] => CNN top1 curve: [84.47, 75.61]
2024-04-24 00:21:01,885 [trainer.py] => CNN top5 curve: [96.96, 94.18]

Average Accuracy (CNN): 80.04
2024-04-24 00:21:01,885 [trainer.py] => Average Accuracy (CNN): 80.04 

2024-04-24 00:21:01,885 [trainer.py] => Train Time: 15631.96
2024-04-24 00:21:01,885 [trainer.py] => Test Time: 32.84 

2024-04-24 00:21:01,887 [trainer.py] => All params: 172312152
2024-04-24 00:21:01,889 [trainer.py] => Trainable params: 484140
2024-04-24 00:21:01,889 [dualprompt.py] => Learning on 180-210

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.572, Train_accy 81.80:   0%|          | 0/20 [01:04<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.572, Train_accy 81.80:   5%|▌         | 1/20 [01:04<20:27, 64.61s/it]
Task 2, Epoch 2/20 => Loss 0.297, Train_accy 89.15:   5%|▌         | 1/20 [02:08<20:27, 64.61s/it]
Task 2, Epoch 2/20 => Loss 0.297, Train_accy 89.15:  10%|█         | 2/20 [02:08<19:12, 64.02s/it]
Task 2, Epoch 3/20 => Loss 0.236, Train_accy 91.17:  10%|█         | 2/20 [03:11<19:12, 64.02s/it]
Task 2, Epoch 3/20 => Loss 0.236, Train_accy 91.17:  15%|█▌        | 3/20 [03:11<18:02, 63.68s/it]
Task 2, Epoch 4/20 => Loss 0.208, Train_accy 91.76:  15%|█▌        | 3/20 [04:14<18:02, 63.68s/it]
Task 2, Epoch 4/20 => Loss 0.208, Train_accy 91.76:  20%|██        | 4/20 [04:14<16:55, 63.50s/it]
Task 2, Epoch 5/20 => Loss 0.200, Train_accy 92.11, Test_accy 66.98:  20%|██        | 4/20 [05:38<16:55, 63.50s/it]
Task 2, Epoch 5/20 => Loss 0.200, Train_accy 92.11, Test_accy 66.98:  25%|██▌       | 5/20 [05:38<17:44, 70.95s/it]
Task 2, Epoch 6/20 => Loss 0.188, Train_accy 92.12:  25%|██▌       | 5/20 [06:42<17:44, 70.95s/it]                 
Task 2, Epoch 6/20 => Loss 0.188, Train_accy 92.12:  30%|███       | 6/20 [06:42<15:57, 68.39s/it]
Task 2, Epoch 7/20 => Loss 0.184, Train_accy 92.65:  30%|███       | 6/20 [07:45<15:57, 68.39s/it]
Task 2, Epoch 7/20 => Loss 0.184, Train_accy 92.65:  35%|███▌      | 7/20 [07:45<14:27, 66.76s/it]
Task 2, Epoch 8/20 => Loss 0.172, Train_accy 92.71:  35%|███▌      | 7/20 [08:48<14:27, 66.76s/it]
Task 2, Epoch 8/20 => Loss 0.172, Train_accy 92.71:  40%|████      | 8/20 [08:48<13:07, 65.66s/it]
Task 2, Epoch 9/20 => Loss 0.157, Train_accy 93.28:  40%|████      | 8/20 [09:52<13:07, 65.66s/it]
Task 2, Epoch 9/20 => Loss 0.157, Train_accy 93.28:  45%|████▌     | 9/20 [09:52<11:54, 64.97s/it]
Task 2, Epoch 10/20 => Loss 0.160, Train_accy 93.41, Test_accy 68.47:  45%|████▌     | 9/20 [11:16<11:54, 64.97s/it]
Task 2, Epoch 10/20 => Loss 0.160, Train_accy 93.41, Test_accy 68.47:  50%|█████     | 10/20 [11:16<11:48, 70.83s/it]
Task 2, Epoch 11/20 => Loss 0.139, Train_accy 94.01:  50%|█████     | 10/20 [12:19<11:48, 70.83s/it]                 
Task 2, Epoch 11/20 => Loss 0.139, Train_accy 94.01:  55%|█████▌    | 11/20 [12:19<10:17, 68.56s/it]
Task 2, Epoch 12/20 => Loss 0.161, Train_accy 93.14:  55%|█████▌    | 11/20 [13:22<10:17, 68.56s/it]
Task 2, Epoch 12/20 => Loss 0.161, Train_accy 93.14:  60%|██████    | 12/20 [13:22<08:55, 66.92s/it]
Task 2, Epoch 13/20 => Loss 0.145, Train_accy 93.90:  60%|██████    | 12/20 [14:26<08:55, 66.92s/it]
Task 2, Epoch 13/20 => Loss 0.145, Train_accy 93.90:  65%|██████▌   | 13/20 [14:26<07:41, 65.87s/it]
Task 2, Epoch 14/20 => Loss 0.137, Train_accy 93.91:  65%|██████▌   | 13/20 [15:29<07:41, 65.87s/it]
Task 2, Epoch 14/20 => Loss 0.137, Train_accy 93.91:  70%|███████   | 14/20 [15:29<06:30, 65.14s/it]
Task 2, Epoch 15/20 => Loss 0.135, Train_accy 94.09, Test_accy 69.73:  70%|███████   | 14/20 [16:53<06:30, 65.14s/it]
Task 2, Epoch 15/20 => Loss 0.135, Train_accy 94.09, Test_accy 69.73:  75%|███████▌  | 15/20 [16:53<05:54, 70.83s/it]
Task 2, Epoch 16/20 => Loss 0.128, Train_accy 94.09:  75%|███████▌  | 15/20 [17:57<05:54, 70.83s/it]                 
Task 2, Epoch 16/20 => Loss 0.128, Train_accy 94.09:  80%|████████  | 16/20 [17:57<04:34, 68.58s/it]
Task 2, Epoch 17/20 => Loss 0.139, Train_accy 93.90:  80%|████████  | 16/20 [19:00<04:34, 68.58s/it]
Task 2, Epoch 17/20 => Loss 0.139, Train_accy 93.90:  85%|████████▌ | 17/20 [19:00<03:21, 67.05s/it]
Task 2, Epoch 18/20 => Loss 0.134, Train_accy 94.23:  85%|████████▌ | 17/20 [20:03<03:21, 67.05s/it]
Task 2, Epoch 18/20 => Loss 0.134, Train_accy 94.23:  90%|█████████ | 18/20 [20:03<02:11, 65.90s/it]
Task 2, Epoch 19/20 => Loss 0.139, Train_accy 94.13:  90%|█████████ | 18/20 [21:07<02:11, 65.90s/it]
Task 2, Epoch 19/20 => Loss 0.139, Train_accy 94.13:  95%|█████████▌| 19/20 [21:07<01:05, 65.10s/it]
Task 2, Epoch 20/20 => Loss 0.128, Train_accy 94.71, Test_accy 70.88:  95%|█████████▌| 19/20 [22:30<01:05, 65.10s/it]
Task 2, Epoch 20/20 => Loss 0.128, Train_accy 94.71, Test_accy 70.88: 100%|██████████| 20/20 [22:30<00:00, 70.66s/it]
Task 2, Epoch 20/20 => Loss 0.128, Train_accy 94.71, Test_accy 70.88: 100%|██████████| 20/20 [22:30<00:00, 67.54s/it]
2024-04-24 00:43:32,730 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.128, Train_accy 94.71, Test_accy 70.88
2024-04-24 00:43:53,114 [trainer.py] => No NME accuracy.
2024-04-24 00:43:53,115 [trainer.py] => CNN: {'total': 70.88, '00-149': 83.93, '150-179': 32.27, '180-209': 44.05, 'old': 75.33, 'new': 44.05}
2024-04-24 00:43:53,115 [trainer.py] => CNN top1 curve: [84.47, 75.61, 70.88]
2024-04-24 00:43:53,115 [trainer.py] => CNN top5 curve: [96.96, 94.18, 91.91]

Average Accuracy (CNN): 76.99
2024-04-24 00:43:53,115 [trainer.py] => Average Accuracy (CNN): 76.99 

2024-04-24 00:43:53,115 [trainer.py] => Train Time: 18333.6
2024-04-24 00:43:53,115 [trainer.py] => Test Time: 53.22 

2024-04-24 00:43:53,118 [trainer.py] => All params: 172312152
2024-04-24 00:43:53,120 [trainer.py] => Trainable params: 484140
2024-04-24 00:43:53,121 [dualprompt.py] => Learning on 210-240

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.657, Train_accy 79.08:   0%|          | 0/20 [01:06<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.657, Train_accy 79.08:   5%|▌         | 1/20 [01:06<21:03, 66.48s/it]
Task 3, Epoch 2/20 => Loss 0.376, Train_accy 86.73:   5%|▌         | 1/20 [02:13<21:03, 66.48s/it]
Task 3, Epoch 2/20 => Loss 0.376, Train_accy 86.73:  10%|█         | 2/20 [02:13<19:57, 66.51s/it]
Task 3, Epoch 3/20 => Loss 0.305, Train_accy 88.59:  10%|█         | 2/20 [03:19<19:57, 66.51s/it]
Task 3, Epoch 3/20 => Loss 0.305, Train_accy 88.59:  15%|█▌        | 3/20 [03:19<18:51, 66.58s/it]
Task 3, Epoch 4/20 => Loss 0.285, Train_accy 89.45:  15%|█▌        | 3/20 [04:26<18:51, 66.58s/it]
Task 3, Epoch 4/20 => Loss 0.285, Train_accy 89.45:  20%|██        | 4/20 [04:26<17:44, 66.55s/it]
Task 3, Epoch 5/20 => Loss 0.255, Train_accy 90.00, Test_accy 63.95:  20%|██        | 4/20 [05:55<17:44, 66.55s/it]
Task 3, Epoch 5/20 => Loss 0.255, Train_accy 90.00, Test_accy 63.95:  25%|██▌       | 5/20 [05:55<18:43, 74.92s/it]
Task 3, Epoch 6/20 => Loss 0.256, Train_accy 89.95:  25%|██▌       | 5/20 [07:02<18:43, 74.92s/it]                 
Task 3, Epoch 6/20 => Loss 0.256, Train_accy 89.95:  30%|███       | 6/20 [07:02<16:49, 72.10s/it]
Task 3, Epoch 7/20 => Loss 0.232, Train_accy 90.87:  30%|███       | 6/20 [08:09<16:49, 72.10s/it]
Task 3, Epoch 7/20 => Loss 0.232, Train_accy 90.87:  35%|███▌      | 7/20 [08:09<15:13, 70.28s/it]
Task 3, Epoch 8/20 => Loss 0.211, Train_accy 91.63:  35%|███▌      | 7/20 [09:15<15:13, 70.28s/it]
Task 3, Epoch 8/20 => Loss 0.211, Train_accy 91.63:  40%|████      | 8/20 [09:15<13:49, 69.11s/it]
Task 3, Epoch 9/20 => Loss 0.232, Train_accy 90.95:  40%|████      | 8/20 [10:22<13:49, 69.11s/it]
Task 3, Epoch 9/20 => Loss 0.232, Train_accy 90.95:  45%|████▌     | 9/20 [10:22<12:31, 68.29s/it]
Task 3, Epoch 10/20 => Loss 0.212, Train_accy 91.45, Test_accy 64.70:  45%|████▌     | 9/20 [11:52<12:31, 68.29s/it]
Task 3, Epoch 10/20 => Loss 0.212, Train_accy 91.45, Test_accy 64.70:  50%|█████     | 10/20 [11:52<12:29, 74.98s/it]
Task 3, Epoch 11/20 => Loss 0.227, Train_accy 90.96:  50%|█████     | 10/20 [12:58<12:29, 74.98s/it]                 
Task 3, Epoch 11/20 => Loss 0.227, Train_accy 90.96:  55%|█████▌    | 11/20 [12:58<10:51, 72.42s/it]
Task 3, Epoch 12/20 => Loss 0.203, Train_accy 91.91:  55%|█████▌    | 11/20 [14:05<10:51, 72.42s/it]
Task 3, Epoch 12/20 => Loss 0.203, Train_accy 91.91:  60%|██████    | 12/20 [14:05<09:25, 70.74s/it]
Task 3, Epoch 13/20 => Loss 0.198, Train_accy 91.95:  60%|██████    | 12/20 [15:12<09:25, 70.74s/it]
Task 3, Epoch 13/20 => Loss 0.198, Train_accy 91.95:  65%|██████▌   | 13/20 [15:12<08:06, 69.50s/it]
Task 3, Epoch 14/20 => Loss 0.195, Train_accy 91.80:  65%|██████▌   | 13/20 [16:18<08:06, 69.50s/it]
Task 3, Epoch 14/20 => Loss 0.195, Train_accy 91.80:  70%|███████   | 14/20 [16:18<06:51, 68.61s/it]
Task 3, Epoch 15/20 => Loss 0.188, Train_accy 92.58, Test_accy 65.66:  70%|███████   | 14/20 [17:49<06:51, 68.61s/it]
Task 3, Epoch 15/20 => Loss 0.188, Train_accy 92.58, Test_accy 65.66:  75%|███████▌  | 15/20 [17:49<06:16, 75.30s/it]
Task 3, Epoch 16/20 => Loss 0.198, Train_accy 92.29:  75%|███████▌  | 15/20 [18:56<06:16, 75.30s/it]                 
Task 3, Epoch 16/20 => Loss 0.198, Train_accy 92.29:  80%|████████  | 16/20 [18:56<04:50, 72.73s/it]
Task 3, Epoch 17/20 => Loss 0.187, Train_accy 92.21:  80%|████████  | 16/20 [20:03<04:50, 72.73s/it]
Task 3, Epoch 17/20 => Loss 0.187, Train_accy 92.21:  85%|████████▌ | 17/20 [20:03<03:32, 70.91s/it]
Task 3, Epoch 18/20 => Loss 0.182, Train_accy 92.65:  85%|████████▌ | 17/20 [21:09<03:32, 70.91s/it]
Task 3, Epoch 18/20 => Loss 0.182, Train_accy 92.65:  90%|█████████ | 18/20 [21:09<02:19, 69.68s/it]
Task 3, Epoch 19/20 => Loss 0.183, Train_accy 92.40:  90%|█████████ | 18/20 [22:16<02:19, 69.68s/it]
Task 3, Epoch 19/20 => Loss 0.183, Train_accy 92.40:  95%|█████████▌| 19/20 [22:16<01:08, 68.77s/it]
Task 3, Epoch 20/20 => Loss 0.192, Train_accy 92.31, Test_accy 66.58:  95%|█████████▌| 19/20 [23:47<01:08, 68.77s/it]
Task 3, Epoch 20/20 => Loss 0.192, Train_accy 92.31, Test_accy 66.58: 100%|██████████| 20/20 [23:47<00:00, 75.28s/it]
Task 3, Epoch 20/20 => Loss 0.192, Train_accy 92.31, Test_accy 66.58: 100%|██████████| 20/20 [23:47<00:00, 71.35s/it]
2024-04-24 01:07:40,191 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.192, Train_accy 92.31, Test_accy 66.58
2024-04-24 01:08:03,642 [trainer.py] => No NME accuracy.
2024-04-24 01:08:03,643 [trainer.py] => CNN: {'total': 66.58, '00-149': 83.97, '150-179': 31.94, '180-209': 41.37, '210-239': 39.4, 'old': 70.47, 'new': 39.4}
2024-04-24 01:08:03,643 [trainer.py] => CNN top1 curve: [84.47, 75.61, 70.88, 66.58]
2024-04-24 01:08:03,643 [trainer.py] => CNN top5 curve: [96.96, 94.18, 91.91, 89.6]

Average Accuracy (CNN): 74.38
2024-04-24 01:08:03,643 [trainer.py] => Average Accuracy (CNN): 74.38 

2024-04-24 01:08:03,643 [trainer.py] => Train Time: 21187.69
2024-04-24 01:08:03,643 [trainer.py] => Test Time: 76.67 

2024-04-24 01:08:03,646 [trainer.py] => All params: 172312152
2024-04-24 01:08:03,648 [trainer.py] => Trainable params: 484140
2024-04-24 01:08:03,648 [dualprompt.py] => Learning on 240-270

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.433, Train_accy 87.53:   0%|          | 0/20 [01:05<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.433, Train_accy 87.53:   5%|▌         | 1/20 [01:05<20:45, 65.57s/it]
Task 4, Epoch 2/20 => Loss 0.189, Train_accy 93.62:   5%|▌         | 1/20 [02:10<20:45, 65.57s/it]
Task 4, Epoch 2/20 => Loss 0.189, Train_accy 93.62:  10%|█         | 2/20 [02:10<19:37, 65.39s/it]
Task 4, Epoch 3/20 => Loss 0.155, Train_accy 94.71:  10%|█         | 2/20 [03:16<19:37, 65.39s/it]
Task 4, Epoch 3/20 => Loss 0.155, Train_accy 94.71:  15%|█▌        | 3/20 [03:16<18:31, 65.39s/it]
Task 4, Epoch 4/20 => Loss 0.155, Train_accy 94.44:  15%|█▌        | 3/20 [04:21<18:31, 65.39s/it]
Task 4, Epoch 4/20 => Loss 0.155, Train_accy 94.44:  20%|██        | 4/20 [04:21<17:27, 65.44s/it]
Task 4, Epoch 5/20 => Loss 0.130, Train_accy 95.01, Test_accy 60.52:  20%|██        | 4/20 [05:53<17:27, 65.44s/it]
Task 4, Epoch 5/20 => Loss 0.130, Train_accy 95.01, Test_accy 60.52:  25%|██▌       | 5/20 [05:53<18:44, 74.98s/it]
Task 4, Epoch 6/20 => Loss 0.118, Train_accy 95.58:  25%|██▌       | 5/20 [06:59<18:44, 74.98s/it]                 
Task 4, Epoch 6/20 => Loss 0.118, Train_accy 95.58:  30%|███       | 6/20 [06:59<16:45, 71.85s/it]
Task 4, Epoch 7/20 => Loss 0.111, Train_accy 95.54:  30%|███       | 6/20 [08:05<16:45, 71.85s/it]
Task 4, Epoch 7/20 => Loss 0.111, Train_accy 95.54:  35%|███▌      | 7/20 [08:05<15:07, 69.81s/it]
Task 4, Epoch 8/20 => Loss 0.083, Train_accy 96.44:  35%|███▌      | 7/20 [09:10<15:07, 69.81s/it]
Task 4, Epoch 8/20 => Loss 0.083, Train_accy 96.44:  40%|████      | 8/20 [09:10<13:41, 68.44s/it]
Task 4, Epoch 9/20 => Loss 0.109, Train_accy 95.55:  40%|████      | 8/20 [10:15<13:41, 68.44s/it]
Task 4, Epoch 9/20 => Loss 0.109, Train_accy 95.55:  45%|████▌     | 9/20 [10:15<12:22, 67.49s/it]
Task 4, Epoch 10/20 => Loss 0.093, Train_accy 95.98, Test_accy 61.96:  45%|████▌     | 9/20 [11:47<12:22, 67.49s/it]
Task 4, Epoch 10/20 => Loss 0.093, Train_accy 95.98, Test_accy 61.96:  50%|█████     | 10/20 [11:47<12:28, 74.90s/it]
Task 4, Epoch 11/20 => Loss 0.095, Train_accy 96.05:  50%|█████     | 10/20 [12:52<12:28, 74.90s/it]                 
Task 4, Epoch 11/20 => Loss 0.095, Train_accy 96.05:  55%|█████▌    | 11/20 [12:52<10:48, 72.00s/it]
Task 4, Epoch 12/20 => Loss 0.094, Train_accy 96.01:  55%|█████▌    | 11/20 [13:58<10:48, 72.00s/it]
Task 4, Epoch 12/20 => Loss 0.094, Train_accy 96.01:  60%|██████    | 12/20 [13:58<09:21, 70.22s/it]
Task 4, Epoch 13/20 => Loss 0.091, Train_accy 96.13:  60%|██████    | 12/20 [15:04<09:21, 70.22s/it]
Task 4, Epoch 13/20 => Loss 0.091, Train_accy 96.13:  65%|██████▌   | 13/20 [15:04<08:02, 68.91s/it]
Task 4, Epoch 14/20 => Loss 0.089, Train_accy 96.06:  65%|██████▌   | 13/20 [16:10<08:02, 68.91s/it]
Task 4, Epoch 14/20 => Loss 0.089, Train_accy 96.06:  70%|███████   | 14/20 [16:10<06:47, 67.97s/it]
Task 4, Epoch 15/20 => Loss 0.094, Train_accy 96.10, Test_accy 62.86:  70%|███████   | 14/20 [17:42<06:47, 67.97s/it]
Task 4, Epoch 15/20 => Loss 0.094, Train_accy 96.10, Test_accy 62.86:  75%|███████▌  | 15/20 [17:42<06:15, 75.17s/it]
Task 4, Epoch 16/20 => Loss 0.069, Train_accy 96.78:  75%|███████▌  | 15/20 [18:48<06:15, 75.17s/it]                 
Task 4, Epoch 16/20 => Loss 0.069, Train_accy 96.78:  80%|████████  | 16/20 [18:48<04:49, 72.43s/it]
Task 4, Epoch 17/20 => Loss 0.085, Train_accy 96.37:  80%|████████  | 16/20 [19:54<04:49, 72.43s/it]
Task 4, Epoch 17/20 => Loss 0.085, Train_accy 96.37:  85%|████████▌ | 17/20 [19:54<03:31, 70.44s/it]
Task 4, Epoch 18/20 => Loss 0.087, Train_accy 96.11:  85%|████████▌ | 17/20 [21:00<03:31, 70.44s/it]
Task 4, Epoch 18/20 => Loss 0.087, Train_accy 96.11:  90%|█████████ | 18/20 [21:00<02:18, 69.05s/it]
Task 4, Epoch 19/20 => Loss 0.091, Train_accy 96.32:  90%|█████████ | 18/20 [22:06<02:18, 69.05s/it]
Task 4, Epoch 19/20 => Loss 0.091, Train_accy 96.32:  95%|█████████▌| 19/20 [22:06<01:08, 68.09s/it]
Task 4, Epoch 20/20 => Loss 0.078, Train_accy 96.58, Test_accy 63.69:  95%|█████████▌| 19/20 [23:38<01:08, 68.09s/it]
Task 4, Epoch 20/20 => Loss 0.078, Train_accy 96.58, Test_accy 63.69: 100%|██████████| 20/20 [23:38<00:00, 75.29s/it]
Task 4, Epoch 20/20 => Loss 0.078, Train_accy 96.58, Test_accy 63.69: 100%|██████████| 20/20 [23:38<00:00, 70.91s/it]
2024-04-24 01:31:41,843 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.078, Train_accy 96.58, Test_accy 63.69
2024-04-24 01:32:07,983 [trainer.py] => No NME accuracy.
2024-04-24 01:32:07,983 [trainer.py] => CNN: {'total': 63.69, '00-149': 84.0, '150-179': 31.27, '180-209': 40.03, '210-239': 41.24, '240-269': 40.57, 'old': 66.58, 'new': 40.57}
2024-04-24 01:32:07,983 [trainer.py] => CNN top1 curve: [84.47, 75.61, 70.88, 66.58, 63.69]
2024-04-24 01:32:07,983 [trainer.py] => CNN top5 curve: [96.96, 94.18, 91.91, 89.6, 89.27]

Average Accuracy (CNN): 72.25
2024-04-24 01:32:07,983 [trainer.py] => Average Accuracy (CNN): 72.25 

2024-04-24 01:32:07,984 [trainer.py] => Train Time: 24024.04
2024-04-24 01:32:07,984 [trainer.py] => Test Time: 102.81 

2024-04-24 01:32:07,985 [trainer.py] => All params: 172312152
2024-04-24 01:32:07,986 [trainer.py] => Trainable params: 484140
2024-04-24 01:32:07,986 [dualprompt.py] => Learning on 270-300

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.441, Train_accy 86.78:   0%|          | 0/20 [01:01<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.441, Train_accy 86.78:   5%|▌         | 1/20 [01:01<19:37, 61.98s/it]
Task 5, Epoch 2/20 => Loss 0.207, Train_accy 92.92:   5%|▌         | 1/20 [02:03<19:37, 61.98s/it]
Task 5, Epoch 2/20 => Loss 0.207, Train_accy 92.92:  10%|█         | 2/20 [02:03<18:32, 61.82s/it]
Task 5, Epoch 3/20 => Loss 0.172, Train_accy 93.95:  10%|█         | 2/20 [03:05<18:32, 61.82s/it]
Task 5, Epoch 3/20 => Loss 0.172, Train_accy 93.95:  15%|█▌        | 3/20 [03:05<17:29, 61.73s/it]
Task 5, Epoch 4/20 => Loss 0.139, Train_accy 94.63:  15%|█▌        | 3/20 [04:06<17:29, 61.73s/it]
Task 5, Epoch 4/20 => Loss 0.139, Train_accy 94.63:  20%|██        | 4/20 [04:06<16:27, 61.70s/it]
Task 5, Epoch 5/20 => Loss 0.128, Train_accy 95.13, Test_accy 58.63:  20%|██        | 4/20 [05:38<16:27, 61.70s/it]
Task 5, Epoch 5/20 => Loss 0.128, Train_accy 95.13, Test_accy 58.63:  25%|██▌       | 5/20 [05:38<18:05, 72.35s/it]
Task 5, Epoch 6/20 => Loss 0.115, Train_accy 95.42:  25%|██▌       | 5/20 [06:40<18:05, 72.35s/it]                 
Task 5, Epoch 6/20 => Loss 0.115, Train_accy 95.42:  30%|███       | 6/20 [06:40<16:03, 68.82s/it]
Task 5, Epoch 7/20 => Loss 0.120, Train_accy 95.01:  30%|███       | 6/20 [07:41<16:03, 68.82s/it]
Task 5, Epoch 7/20 => Loss 0.120, Train_accy 95.01:  35%|███▌      | 7/20 [07:41<14:24, 66.50s/it]
Task 5, Epoch 8/20 => Loss 0.104, Train_accy 95.43:  35%|███▌      | 7/20 [08:43<14:24, 66.50s/it]
Task 5, Epoch 8/20 => Loss 0.104, Train_accy 95.43:  40%|████      | 8/20 [08:43<12:59, 64.99s/it]
Task 5, Epoch 9/20 => Loss 0.095, Train_accy 95.66:  40%|████      | 8/20 [09:45<12:59, 64.99s/it]
Task 5, Epoch 9/20 => Loss 0.095, Train_accy 95.66:  45%|████▌     | 9/20 [09:45<11:45, 64.15s/it]
Task 5, Epoch 10/20 => Loss 0.099, Train_accy 95.69, Test_accy 60.03:  45%|████▌     | 9/20 [11:17<11:45, 64.15s/it]
Task 5, Epoch 10/20 => Loss 0.099, Train_accy 95.69, Test_accy 60.03:  50%|█████     | 10/20 [11:17<12:05, 72.50s/it]
Task 5, Epoch 11/20 => Loss 0.098, Train_accy 95.68:  50%|█████     | 10/20 [12:18<12:05, 72.50s/it]                 
Task 5, Epoch 11/20 => Loss 0.098, Train_accy 95.68:  55%|█████▌    | 11/20 [12:18<10:23, 69.23s/it]
Task 5, Epoch 12/20 => Loss 0.091, Train_accy 95.79:  55%|█████▌    | 11/20 [13:20<10:23, 69.23s/it]
Task 5, Epoch 12/20 => Loss 0.091, Train_accy 95.79:  60%|██████    | 12/20 [13:20<08:55, 66.93s/it]
Task 5, Epoch 13/20 => Loss 0.089, Train_accy 96.05:  60%|██████    | 12/20 [14:22<08:55, 66.93s/it]
Task 5, Epoch 13/20 => Loss 0.089, Train_accy 96.05:  65%|██████▌   | 13/20 [14:22<07:37, 65.30s/it]
Task 5, Epoch 14/20 => Loss 0.080, Train_accy 96.27:  65%|██████▌   | 13/20 [15:23<07:37, 65.30s/it]
Task 5, Epoch 14/20 => Loss 0.080, Train_accy 96.27:  70%|███████   | 14/20 [15:23<06:25, 64.19s/it]
Task 5, Epoch 15/20 => Loss 0.086, Train_accy 96.08, Test_accy 60.94:  70%|███████   | 14/20 [16:54<06:25, 64.19s/it]
Task 5, Epoch 15/20 => Loss 0.086, Train_accy 96.08, Test_accy 60.94:  75%|███████▌  | 15/20 [16:54<06:01, 72.24s/it]
Task 5, Epoch 16/20 => Loss 0.081, Train_accy 96.19:  75%|███████▌  | 15/20 [17:56<06:01, 72.24s/it]                 
Task 5, Epoch 16/20 => Loss 0.081, Train_accy 96.19:  80%|████████  | 16/20 [17:56<04:36, 69.08s/it]
Task 5, Epoch 17/20 => Loss 0.095, Train_accy 96.00:  80%|████████  | 16/20 [18:58<04:36, 69.08s/it]
Task 5, Epoch 17/20 => Loss 0.095, Train_accy 96.00:  85%|████████▌ | 17/20 [18:58<03:20, 66.98s/it]
Task 5, Epoch 18/20 => Loss 0.089, Train_accy 95.94:  85%|████████▌ | 17/20 [20:00<03:20, 66.98s/it]
Task 5, Epoch 18/20 => Loss 0.089, Train_accy 95.94:  90%|█████████ | 18/20 [20:00<02:10, 65.38s/it]
Task 5, Epoch 19/20 => Loss 0.066, Train_accy 96.65:  90%|█████████ | 18/20 [21:02<02:10, 65.38s/it]
Task 5, Epoch 19/20 => Loss 0.066, Train_accy 96.65:  95%|█████████▌| 19/20 [21:02<01:04, 64.31s/it]
Task 5, Epoch 20/20 => Loss 0.087, Train_accy 95.96, Test_accy 61.77:  95%|█████████▌| 19/20 [22:32<01:04, 64.31s/it]
Task 5, Epoch 20/20 => Loss 0.087, Train_accy 95.96, Test_accy 61.77: 100%|██████████| 20/20 [22:32<00:00, 72.20s/it]
Task 5, Epoch 20/20 => Loss 0.087, Train_accy 95.96, Test_accy 61.77: 100%|██████████| 20/20 [22:32<00:00, 67.63s/it]
2024-04-24 01:54:40,635 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.087, Train_accy 95.96, Test_accy 61.77
2024-04-24 01:55:09,918 [trainer.py] => No NME accuracy.
2024-04-24 01:55:09,918 [trainer.py] => CNN: {'total': 61.77, '00-149': 83.5, '150-179': 31.77, '180-209': 40.03, '210-239': 41.07, '240-269': 41.07, '270-299': 46.15, 'old': 63.5, 'new': 46.15}
2024-04-24 01:55:09,918 [trainer.py] => CNN top1 curve: [84.47, 75.61, 70.88, 66.58, 63.69, 61.77]
2024-04-24 01:55:09,918 [trainer.py] => CNN top5 curve: [96.96, 94.18, 91.91, 89.6, 89.27, 88.94]

Average Accuracy (CNN): 70.5
2024-04-24 01:55:09,919 [trainer.py] => Average Accuracy (CNN): 70.5 

2024-04-24 01:55:09,919 [trainer.py] => Train Time: 26729.29
2024-04-24 01:55:09,919 [trainer.py] => Test Time: 132.09 

Accuracy Matrix (CNN):
[[84.47 84.07 83.93 83.97 84.   83.5 ]
 [ 0.   33.28 32.27 31.94 31.27 31.77]
 [ 0.    0.   44.05 41.37 40.03 40.03]
 [ 0.    0.    0.   39.4  41.24 41.07]
 [ 0.    0.    0.    0.   40.57 41.07]
 [ 0.    0.    0.    0.    0.   46.15]]
2024-04-24 01:55:09,920 [trainer.py] => Forgetting (CNN): 1.3339999999999996
2024-04-24 01:55:12,451 [trainer.py] => config: ./exps/coda_prompt_omn_B150.json
2024-04-24 01:55:12,451 [trainer.py] => prefix:  
2024-04-24 01:55:12,451 [trainer.py] => dataset: omnibenchmark
2024-04-24 01:55:12,451 [trainer.py] => memory_size: 0
2024-04-24 01:55:12,451 [trainer.py] => memory_per_class: 0
2024-04-24 01:55:12,451 [trainer.py] => fixed_memory: False
2024-04-24 01:55:12,451 [trainer.py] => shuffle: False
2024-04-24 01:55:12,451 [trainer.py] => init_cls: 150
2024-04-24 01:55:12,451 [trainer.py] => increment: 30
2024-04-24 01:55:12,451 [trainer.py] => model_name: coda_prompt
2024-04-24 01:55:12,451 [trainer.py] => backbone_type: vit_base_patch16_224_coda_prompt
2024-04-24 01:55:12,451 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-24 01:55:12,451 [trainer.py] => seed: 1993
2024-04-24 01:55:12,451 [trainer.py] => tuned_epoch: 20
2024-04-24 01:55:12,451 [trainer.py] => init_lr: 0.001
2024-04-24 01:55:12,451 [trainer.py] => batch_size: 48
2024-04-24 01:55:12,451 [trainer.py] => weight_decay: 0
2024-04-24 01:55:12,452 [trainer.py] => min_lr: 1e-05
2024-04-24 01:55:12,452 [trainer.py] => optimizer: adam
2024-04-24 01:55:12,452 [trainer.py] => scheduler: cosine
2024-04-24 01:55:12,452 [trainer.py] => reinit_optimizer: True
2024-04-24 01:55:12,452 [trainer.py] => pretrained: True
2024-04-24 01:55:12,452 [trainer.py] => drop: 0.0
2024-04-24 01:55:12,452 [trainer.py] => drop_path: 0.0
2024-04-24 01:55:12,452 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-04-24 01:55:12,704 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299]
2024-04-24 01:55:15,180 [coda_prompt.py] => 89,869,356 total parameters.
2024-04-24 01:55:15,180 [coda_prompt.py] => 4,070,700 fc and prompt training parameters.
2024-04-24 01:55:15,181 [trainer.py] => All params: 89869356
2024-04-24 01:55:15,181 [trainer.py] => Trainable params: 89869356
2024-04-24 01:55:15,181 [coda_prompt.py] => Learning on 0-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.487, Train_accy 60.75:   0%|          | 0/20 [06:52<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.487, Train_accy 60.75:   5%|▌         | 1/20 [06:52<2:10:45, 412.90s/it]
Task 0, Epoch 2/20 => Loss 1.090, Train_accy 68.77:   5%|▌         | 1/20 [13:44<2:10:45, 412.90s/it]
Task 0, Epoch 2/20 => Loss 1.090, Train_accy 68.77:  10%|█         | 2/20 [13:44<2:03:35, 411.96s/it]
Task 0, Epoch 3/20 => Loss 1.009, Train_accy 70.53:  10%|█         | 2/20 [20:35<2:03:35, 411.96s/it]
Task 0, Epoch 3/20 => Loss 1.009, Train_accy 70.53:  15%|█▌        | 3/20 [20:35<1:56:39, 411.76s/it]
Task 0, Epoch 4/20 => Loss 0.951, Train_accy 71.95:  15%|█▌        | 3/20 [27:26<1:56:39, 411.76s/it]
Task 0, Epoch 4/20 => Loss 0.951, Train_accy 71.95:  20%|██        | 4/20 [27:26<1:49:44, 411.50s/it]
Task 0, Epoch 5/20 => Loss 0.903, Train_accy 73.21, Test_accy 75.03:  20%|██        | 4/20 [34:34<1:49:44, 411.50s/it]
Task 0, Epoch 5/20 => Loss 0.903, Train_accy 73.21, Test_accy 75.03:  25%|██▌       | 5/20 [34:34<1:44:20, 417.36s/it]
Task 0, Epoch 6/20 => Loss 0.861, Train_accy 74.12:  25%|██▌       | 5/20 [41:27<1:44:20, 417.36s/it]                 
Task 0, Epoch 6/20 => Loss 0.861, Train_accy 74.12:  30%|███       | 6/20 [41:27<1:36:59, 415.69s/it]
Task 0, Epoch 7/20 => Loss 0.835, Train_accy 75.15:  30%|███       | 6/20 [48:19<1:36:59, 415.69s/it]
Task 0, Epoch 7/20 => Loss 0.835, Train_accy 75.15:  35%|███▌      | 7/20 [48:19<1:29:48, 414.54s/it]
Task 0, Epoch 8/20 => Loss 0.815, Train_accy 75.61:  35%|███▌      | 7/20 [55:10<1:29:48, 414.54s/it]
Task 0, Epoch 8/20 => Loss 0.815, Train_accy 75.61:  40%|████      | 8/20 [55:10<1:22:40, 413.35s/it]
Task 0, Epoch 9/20 => Loss 0.781, Train_accy 76.14:  40%|████      | 8/20 [1:02:00<1:22:40, 413.35s/it]
Task 0, Epoch 9/20 => Loss 0.781, Train_accy 76.14:  45%|████▌     | 9/20 [1:02:00<1:15:35, 412.34s/it]
Task 0, Epoch 10/20 => Loss 0.765, Train_accy 76.64, Test_accy 75.29:  45%|████▌     | 9/20 [1:09:05<1:15:35, 412.34s/it]
Task 0, Epoch 10/20 => Loss 0.765, Train_accy 76.64, Test_accy 75.29:  50%|█████     | 10/20 [1:09:05<1:09:22, 416.22s/it]
Task 0, Epoch 11/20 => Loss 0.739, Train_accy 77.19:  50%|█████     | 10/20 [1:15:58<1:09:22, 416.22s/it]                 
Task 0, Epoch 11/20 => Loss 0.739, Train_accy 77.19:  55%|█████▌    | 11/20 [1:15:58<1:02:17, 415.33s/it]
Task 0, Epoch 12/20 => Loss 0.716, Train_accy 77.79:  55%|█████▌    | 11/20 [1:22:51<1:02:17, 415.33s/it]
Task 0, Epoch 12/20 => Loss 0.716, Train_accy 77.79:  60%|██████    | 12/20 [1:22:51<55:16, 414.60s/it]  
Task 0, Epoch 13/20 => Loss 0.695, Train_accy 78.36:  60%|██████    | 12/20 [1:29:43<55:16, 414.60s/it]
Task 0, Epoch 13/20 => Loss 0.695, Train_accy 78.36:  65%|██████▌   | 13/20 [1:29:43<48:17, 413.96s/it]
Task 0, Epoch 14/20 => Loss 0.676, Train_accy 78.59:  65%|██████▌   | 13/20 [1:36:35<48:17, 413.96s/it]
Task 0, Epoch 14/20 => Loss 0.676, Train_accy 78.59:  70%|███████   | 14/20 [1:36:35<41:20, 413.36s/it]
Task 0, Epoch 15/20 => Loss 0.656, Train_accy 79.19, Test_accy 75.79:  70%|███████   | 14/20 [1:43:43<41:20, 413.36s/it]
Task 0, Epoch 15/20 => Loss 0.656, Train_accy 79.19, Test_accy 75.79:  75%|███████▌  | 15/20 [1:43:43<34:48, 417.64s/it]
Task 0, Epoch 16/20 => Loss 0.637, Train_accy 79.81:  75%|███████▌  | 15/20 [1:50:34<34:48, 417.64s/it]                 
Task 0, Epoch 16/20 => Loss 0.637, Train_accy 79.81:  80%|████████  | 16/20 [1:50:34<27:43, 415.84s/it]
Task 0, Epoch 17/20 => Loss 0.613, Train_accy 80.41:  80%|████████  | 16/20 [1:57:26<27:43, 415.84s/it]
Task 0, Epoch 17/20 => Loss 0.613, Train_accy 80.41:  85%|████████▌ | 17/20 [1:57:26<20:43, 414.58s/it]
Task 0, Epoch 18/20 => Loss 0.604, Train_accy 80.79:  85%|████████▌ | 17/20 [2:04:17<20:43, 414.58s/it]
Task 0, Epoch 18/20 => Loss 0.604, Train_accy 80.79:  90%|█████████ | 18/20 [2:04:17<13:47, 413.60s/it]
Task 0, Epoch 19/20 => Loss 0.579, Train_accy 81.34:  90%|█████████ | 18/20 [2:11:09<13:47, 413.60s/it]
Task 0, Epoch 19/20 => Loss 0.579, Train_accy 81.34:  95%|█████████▌| 19/20 [2:11:09<06:53, 413.11s/it]
Task 0, Epoch 20/20 => Loss 0.562, Train_accy 81.93, Test_accy 75.93:  95%|█████████▌| 19/20 [2:18:16<06:53, 413.11s/it]
Task 0, Epoch 20/20 => Loss 0.562, Train_accy 81.93, Test_accy 75.93: 100%|██████████| 20/20 [2:18:16<00:00, 417.05s/it]
Task 0, Epoch 20/20 => Loss 0.562, Train_accy 81.93, Test_accy 75.93: 100%|██████████| 20/20 [2:18:16<00:00, 414.81s/it]
2024-04-24 04:13:31,865 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.562, Train_accy 81.93, Test_accy 75.93
2024-04-24 04:13:47,046 [trainer.py] => No NME accuracy.
2024-04-24 04:13:47,047 [trainer.py] => CNN: {'total': 75.93, '00-149': 75.93, 'old': 0, 'new': 75.93}
2024-04-24 04:13:47,047 [trainer.py] => CNN top1 curve: [75.93]
2024-04-24 04:13:47,047 [trainer.py] => CNN top5 curve: [95.63]

Average Accuracy (CNN): 75.93
2024-04-24 04:13:47,047 [trainer.py] => Average Accuracy (CNN): 75.93 

2024-04-24 04:13:47,047 [trainer.py] => Train Time: 16592.75
2024-04-24 04:13:47,047 [trainer.py] => Test Time: 15.18 

2024-04-24 04:13:47,049 [trainer.py] => All params: 89869356
2024-04-24 04:13:47,051 [trainer.py] => Trainable params: 89869356
2024-04-24 04:13:47,861 [coda_prompt.py] => Learning on 150-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.405, Train_accy 89.48:   0%|          | 0/20 [01:17<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.405, Train_accy 89.48:   5%|▌         | 1/20 [01:17<24:36, 77.70s/it]
Task 1, Epoch 2/20 => Loss 0.125, Train_accy 96.18:   5%|▌         | 1/20 [02:35<24:36, 77.70s/it]
Task 1, Epoch 2/20 => Loss 0.125, Train_accy 96.18:  10%|█         | 2/20 [02:35<23:15, 77.54s/it]
Task 1, Epoch 3/20 => Loss 0.109, Train_accy 96.87:  10%|█         | 2/20 [03:52<23:15, 77.54s/it]
Task 1, Epoch 3/20 => Loss 0.109, Train_accy 96.87:  15%|█▌        | 3/20 [03:52<21:58, 77.56s/it]
Task 1, Epoch 4/20 => Loss 0.087, Train_accy 97.42:  15%|█▌        | 3/20 [05:10<21:58, 77.56s/it]
Task 1, Epoch 4/20 => Loss 0.087, Train_accy 97.42:  20%|██        | 4/20 [05:10<20:39, 77.47s/it]
Task 1, Epoch 5/20 => Loss 0.083, Train_accy 97.51, Test_accy 72.04:  20%|██        | 4/20 [06:45<20:39, 77.47s/it]
Task 1, Epoch 5/20 => Loss 0.083, Train_accy 97.51, Test_accy 72.04:  25%|██▌       | 5/20 [06:45<20:59, 83.93s/it]
Task 1, Epoch 6/20 => Loss 0.076, Train_accy 97.46:  25%|██▌       | 5/20 [08:03<20:59, 83.93s/it]                 
Task 1, Epoch 6/20 => Loss 0.076, Train_accy 97.46:  30%|███       | 6/20 [08:03<19:05, 81.79s/it]
Task 1, Epoch 7/20 => Loss 0.071, Train_accy 97.90:  30%|███       | 6/20 [09:20<19:05, 81.79s/it]
Task 1, Epoch 7/20 => Loss 0.071, Train_accy 97.90:  35%|███▌      | 7/20 [09:20<17:25, 80.40s/it]
Task 1, Epoch 8/20 => Loss 0.074, Train_accy 97.67:  35%|███▌      | 7/20 [10:38<17:25, 80.40s/it]
Task 1, Epoch 8/20 => Loss 0.074, Train_accy 97.67:  40%|████      | 8/20 [10:38<15:53, 79.46s/it]
Task 1, Epoch 9/20 => Loss 0.068, Train_accy 98.02:  40%|████      | 8/20 [11:55<15:53, 79.46s/it]
Task 1, Epoch 9/20 => Loss 0.068, Train_accy 98.02:  45%|████▌     | 9/20 [11:55<14:27, 78.82s/it]
Task 1, Epoch 10/20 => Loss 0.062, Train_accy 98.11, Test_accy 73.46:  45%|████▌     | 9/20 [13:31<14:27, 78.82s/it]
Task 1, Epoch 10/20 => Loss 0.062, Train_accy 98.11, Test_accy 73.46:  50%|█████     | 10/20 [13:31<13:59, 83.98s/it]
Task 1, Epoch 11/20 => Loss 0.077, Train_accy 97.57:  50%|█████     | 10/20 [14:47<13:59, 83.98s/it]                 
Task 1, Epoch 11/20 => Loss 0.077, Train_accy 97.57:  55%|█████▌    | 11/20 [14:47<12:14, 81.60s/it]
Task 1, Epoch 12/20 => Loss 0.059, Train_accy 98.24:  55%|█████▌    | 11/20 [16:04<12:14, 81.60s/it]
Task 1, Epoch 12/20 => Loss 0.059, Train_accy 98.24:  60%|██████    | 12/20 [16:04<10:42, 80.36s/it]
Task 1, Epoch 13/20 => Loss 0.054, Train_accy 98.25:  60%|██████    | 12/20 [17:22<10:42, 80.36s/it]
Task 1, Epoch 13/20 => Loss 0.054, Train_accy 98.25:  65%|██████▌   | 13/20 [17:22<09:16, 79.43s/it]
Task 1, Epoch 14/20 => Loss 0.053, Train_accy 98.38:  65%|██████▌   | 13/20 [18:39<09:16, 79.43s/it]
Task 1, Epoch 14/20 => Loss 0.053, Train_accy 98.38:  70%|███████   | 14/20 [18:39<07:52, 78.81s/it]
Task 1, Epoch 15/20 => Loss 0.051, Train_accy 98.37, Test_accy 73.54:  70%|███████   | 14/20 [20:14<07:52, 78.81s/it]
Task 1, Epoch 15/20 => Loss 0.051, Train_accy 98.37, Test_accy 73.54:  75%|███████▌  | 15/20 [20:14<06:59, 83.86s/it]
Task 1, Epoch 16/20 => Loss 0.055, Train_accy 98.33:  75%|███████▌  | 15/20 [21:32<06:59, 83.86s/it]                 
Task 1, Epoch 16/20 => Loss 0.055, Train_accy 98.33:  80%|████████  | 16/20 [21:32<05:27, 81.94s/it]
Task 1, Epoch 17/20 => Loss 0.048, Train_accy 98.64:  80%|████████  | 16/20 [22:49<05:27, 81.94s/it]
Task 1, Epoch 17/20 => Loss 0.048, Train_accy 98.64:  85%|████████▌ | 17/20 [22:49<04:01, 80.61s/it]
Task 1, Epoch 18/20 => Loss 0.051, Train_accy 98.50:  85%|████████▌ | 17/20 [24:07<04:01, 80.61s/it]
Task 1, Epoch 18/20 => Loss 0.051, Train_accy 98.50:  90%|█████████ | 18/20 [24:07<02:39, 79.63s/it]
Task 1, Epoch 19/20 => Loss 0.039, Train_accy 98.79:  90%|█████████ | 18/20 [25:24<02:39, 79.63s/it]
Task 1, Epoch 19/20 => Loss 0.039, Train_accy 98.79:  95%|█████████▌| 19/20 [25:24<01:19, 79.02s/it]
Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.63, Test_accy 73.73:  95%|█████████▌| 19/20 [26:59<01:19, 79.02s/it]
Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.63, Test_accy 73.73: 100%|██████████| 20/20 [26:59<00:00, 83.72s/it]
Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.63, Test_accy 73.73: 100%|██████████| 20/20 [26:59<00:00, 80.98s/it]
2024-04-24 04:40:47,469 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.63, Test_accy 73.73
2024-04-24 04:41:05,399 [trainer.py] => No NME accuracy.
2024-04-24 04:41:05,400 [trainer.py] => CNN: {'total': 73.73, '00-149': 73.82, '150-179': 73.29, 'old': 73.82, 'new': 73.29}
2024-04-24 04:41:05,400 [trainer.py] => CNN top1 curve: [75.93, 73.73]
2024-04-24 04:41:05,400 [trainer.py] => CNN top5 curve: [95.63, 94.16]

Average Accuracy (CNN): 74.83
2024-04-24 04:41:05,400 [trainer.py] => Average Accuracy (CNN): 74.83 

2024-04-24 04:41:05,400 [trainer.py] => Train Time: 19831.94
2024-04-24 04:41:05,400 [trainer.py] => Test Time: 33.11 

2024-04-24 04:41:05,402 [trainer.py] => All params: 89869356
2024-04-24 04:41:05,403 [trainer.py] => Trainable params: 89869356
2024-04-24 04:41:06,649 [coda_prompt.py] => Learning on 180-210

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.489, Train_accy 84.67:   0%|          | 0/20 [01:24<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.489, Train_accy 84.67:   5%|▌         | 1/20 [01:24<26:44, 84.47s/it]
Task 2, Epoch 2/20 => Loss 0.235, Train_accy 91.39:   5%|▌         | 1/20 [02:48<26:44, 84.47s/it]
Task 2, Epoch 2/20 => Loss 0.235, Train_accy 91.39:  10%|█         | 2/20 [02:48<25:20, 84.47s/it]
Task 2, Epoch 3/20 => Loss 0.190, Train_accy 92.76:  10%|█         | 2/20 [04:13<25:20, 84.47s/it]
Task 2, Epoch 3/20 => Loss 0.190, Train_accy 92.76:  15%|█▌        | 3/20 [04:13<23:55, 84.47s/it]
Task 2, Epoch 4/20 => Loss 0.179, Train_accy 93.53:  15%|█▌        | 3/20 [05:37<23:55, 84.47s/it]
Task 2, Epoch 4/20 => Loss 0.179, Train_accy 93.53:  20%|██        | 4/20 [05:37<22:29, 84.34s/it]
Task 2, Epoch 5/20 => Loss 0.165, Train_accy 93.95, Test_accy 69.62:  20%|██        | 4/20 [07:22<22:29, 84.34s/it]
Task 2, Epoch 5/20 => Loss 0.165, Train_accy 93.95, Test_accy 69.62:  25%|██▌       | 5/20 [07:22<22:57, 91.84s/it]
Task 2, Epoch 6/20 => Loss 0.155, Train_accy 94.50:  25%|██▌       | 5/20 [08:47<22:57, 91.84s/it]                 
Task 2, Epoch 6/20 => Loss 0.155, Train_accy 94.50:  30%|███       | 6/20 [08:47<20:51, 89.40s/it]
Task 2, Epoch 7/20 => Loss 0.143, Train_accy 94.67:  30%|███       | 6/20 [10:11<20:51, 89.40s/it]
Task 2, Epoch 7/20 => Loss 0.143, Train_accy 94.67:  35%|███▌      | 7/20 [10:11<19:01, 87.81s/it]
Task 2, Epoch 8/20 => Loss 0.140, Train_accy 95.17:  35%|███▌      | 7/20 [11:36<19:01, 87.81s/it]
Task 2, Epoch 8/20 => Loss 0.140, Train_accy 95.17:  40%|████      | 8/20 [11:36<17:19, 86.64s/it]
Task 2, Epoch 9/20 => Loss 0.129, Train_accy 95.18:  40%|████      | 8/20 [13:00<17:19, 86.64s/it]
Task 2, Epoch 9/20 => Loss 0.129, Train_accy 95.18:  45%|████▌     | 9/20 [13:00<15:46, 86.00s/it]
Task 2, Epoch 10/20 => Loss 0.126, Train_accy 95.41, Test_accy 70.90:  45%|████▌     | 9/20 [14:45<15:46, 86.00s/it]
Task 2, Epoch 10/20 => Loss 0.126, Train_accy 95.41, Test_accy 70.90:  50%|█████     | 10/20 [14:45<15:19, 91.93s/it]
Task 2, Epoch 11/20 => Loss 0.113, Train_accy 95.95:  50%|█████     | 10/20 [16:10<15:19, 91.93s/it]                 
Task 2, Epoch 11/20 => Loss 0.113, Train_accy 95.95:  55%|█████▌    | 11/20 [16:10<13:27, 89.72s/it]
Task 2, Epoch 12/20 => Loss 0.113, Train_accy 96.13:  55%|█████▌    | 11/20 [17:34<13:27, 89.72s/it]
Task 2, Epoch 12/20 => Loss 0.113, Train_accy 96.13:  60%|██████    | 12/20 [17:34<11:44, 88.05s/it]
Task 2, Epoch 13/20 => Loss 0.102, Train_accy 96.34:  60%|██████    | 12/20 [18:59<11:44, 88.05s/it]
Task 2, Epoch 13/20 => Loss 0.102, Train_accy 96.34:  65%|██████▌   | 13/20 [18:59<10:08, 86.98s/it]
Task 2, Epoch 14/20 => Loss 0.100, Train_accy 96.31:  65%|██████▌   | 13/20 [20:23<10:08, 86.98s/it]
Task 2, Epoch 14/20 => Loss 0.100, Train_accy 96.31:  70%|███████   | 14/20 [20:23<08:37, 86.23s/it]
Task 2, Epoch 15/20 => Loss 0.095, Train_accy 96.63, Test_accy 71.71:  70%|███████   | 14/20 [22:09<08:37, 86.23s/it]
Task 2, Epoch 15/20 => Loss 0.095, Train_accy 96.63, Test_accy 71.71:  75%|███████▌  | 15/20 [22:09<07:40, 92.02s/it]
Task 2, Epoch 16/20 => Loss 0.089, Train_accy 96.72:  75%|███████▌  | 15/20 [23:33<07:40, 92.02s/it]                 
Task 2, Epoch 16/20 => Loss 0.089, Train_accy 96.72:  80%|████████  | 16/20 [23:33<05:59, 89.80s/it]
Task 2, Epoch 17/20 => Loss 0.091, Train_accy 96.83:  80%|████████  | 16/20 [24:58<05:59, 89.80s/it]
Task 2, Epoch 17/20 => Loss 0.091, Train_accy 96.83:  85%|████████▌ | 17/20 [24:58<04:24, 88.25s/it]
Task 2, Epoch 18/20 => Loss 0.084, Train_accy 97.09:  85%|████████▌ | 17/20 [26:22<04:24, 88.25s/it]
Task 2, Epoch 18/20 => Loss 0.084, Train_accy 97.09:  90%|█████████ | 18/20 [26:22<02:54, 87.11s/it]
Task 2, Epoch 19/20 => Loss 0.083, Train_accy 97.14:  90%|█████████ | 18/20 [27:47<02:54, 87.11s/it]
Task 2, Epoch 19/20 => Loss 0.083, Train_accy 97.14:  95%|█████████▌| 19/20 [27:47<01:26, 86.32s/it]
Task 2, Epoch 20/20 => Loss 0.074, Train_accy 97.43, Test_accy 71.64:  95%|█████████▌| 19/20 [29:32<01:26, 86.32s/it]
Task 2, Epoch 20/20 => Loss 0.074, Train_accy 97.43, Test_accy 71.64: 100%|██████████| 20/20 [29:32<00:00, 92.04s/it]
Task 2, Epoch 20/20 => Loss 0.074, Train_accy 97.43, Test_accy 71.64: 100%|██████████| 20/20 [29:32<00:00, 88.64s/it]
2024-04-24 05:10:39,491 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.074, Train_accy 97.43, Test_accy 71.64
2024-04-24 05:11:00,036 [trainer.py] => No NME accuracy.
2024-04-24 05:11:00,037 [trainer.py] => CNN: {'total': 71.64, '00-149': 74.09, '150-179': 73.12, '180-209': 57.93, 'old': 73.93, 'new': 57.93}
2024-04-24 05:11:00,037 [trainer.py] => CNN top1 curve: [75.93, 73.73, 71.64]
2024-04-24 05:11:00,037 [trainer.py] => CNN top5 curve: [95.63, 94.16, 94.2]

Average Accuracy (CNN): 73.77
2024-04-24 05:11:00,037 [trainer.py] => Average Accuracy (CNN): 73.77 

2024-04-24 05:11:00,037 [trainer.py] => Train Time: 23377.6
2024-04-24 05:11:00,037 [trainer.py] => Test Time: 53.65 

2024-04-24 05:11:00,038 [trainer.py] => All params: 89869356
2024-04-24 05:11:00,039 [trainer.py] => Trainable params: 89869356
2024-04-24 05:11:01,927 [coda_prompt.py] => Learning on 210-240

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.705, Train_accy 76.71:   0%|          | 0/20 [01:19<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.705, Train_accy 76.71:   5%|▌         | 1/20 [01:19<25:04, 79.18s/it]
Task 3, Epoch 2/20 => Loss 0.423, Train_accy 85.35:   5%|▌         | 1/20 [02:38<25:04, 79.18s/it]
Task 3, Epoch 2/20 => Loss 0.423, Train_accy 85.35:  10%|█         | 2/20 [02:38<23:42, 79.04s/it]
Task 3, Epoch 3/20 => Loss 0.373, Train_accy 87.68:  10%|█         | 2/20 [03:57<23:42, 79.04s/it]
Task 3, Epoch 3/20 => Loss 0.373, Train_accy 87.68:  15%|█▌        | 3/20 [03:57<22:23, 79.02s/it]
Task 3, Epoch 4/20 => Loss 0.341, Train_accy 88.47:  15%|█▌        | 3/20 [05:15<22:23, 79.02s/it]
Task 3, Epoch 4/20 => Loss 0.341, Train_accy 88.47:  20%|██        | 4/20 [05:15<21:01, 78.84s/it]
Task 3, Epoch 5/20 => Loss 0.309, Train_accy 89.61, Test_accy 65.85:  20%|██        | 4/20 [06:57<21:01, 78.84s/it]
Task 3, Epoch 5/20 => Loss 0.309, Train_accy 89.61, Test_accy 65.85:  25%|██▌       | 5/20 [06:57<21:45, 87.05s/it]
Task 3, Epoch 6/20 => Loss 0.294, Train_accy 90.02:  25%|██▌       | 5/20 [08:15<21:45, 87.05s/it]                 
Task 3, Epoch 6/20 => Loss 0.294, Train_accy 90.02:  30%|███       | 6/20 [08:15<19:37, 84.14s/it]
Task 3, Epoch 7/20 => Loss 0.274, Train_accy 90.67:  30%|███       | 6/20 [09:34<19:37, 84.14s/it]
Task 3, Epoch 7/20 => Loss 0.274, Train_accy 90.67:  35%|███▌      | 7/20 [09:34<17:49, 82.23s/it]
Task 3, Epoch 8/20 => Loss 0.258, Train_accy 91.37:  35%|███▌      | 7/20 [10:52<17:49, 82.23s/it]
Task 3, Epoch 8/20 => Loss 0.258, Train_accy 91.37:  40%|████      | 8/20 [10:52<16:13, 81.16s/it]
Task 3, Epoch 9/20 => Loss 0.257, Train_accy 91.37:  40%|████      | 8/20 [12:11<16:13, 81.16s/it]
Task 3, Epoch 9/20 => Loss 0.257, Train_accy 91.37:  45%|████▌     | 9/20 [12:11<14:45, 80.48s/it]
Task 3, Epoch 10/20 => Loss 0.239, Train_accy 92.16, Test_accy 67.66:  45%|████▌     | 9/20 [13:54<14:45, 80.48s/it]
Task 3, Epoch 10/20 => Loss 0.239, Train_accy 92.16, Test_accy 67.66:  50%|█████     | 10/20 [13:54<14:31, 87.19s/it]
Task 3, Epoch 11/20 => Loss 0.235, Train_accy 92.11:  50%|█████     | 10/20 [15:12<14:31, 87.19s/it]                 
Task 3, Epoch 11/20 => Loss 0.235, Train_accy 92.11:  55%|█████▌    | 11/20 [15:12<12:41, 84.60s/it]
Task 3, Epoch 12/20 => Loss 0.223, Train_accy 92.52:  55%|█████▌    | 11/20 [16:31<12:41, 84.60s/it]
Task 3, Epoch 12/20 => Loss 0.223, Train_accy 92.52:  60%|██████    | 12/20 [16:31<11:03, 82.89s/it]
Task 3, Epoch 13/20 => Loss 0.210, Train_accy 92.91:  60%|██████    | 12/20 [17:50<11:03, 82.89s/it]
Task 3, Epoch 13/20 => Loss 0.210, Train_accy 92.91:  65%|██████▌   | 13/20 [17:50<09:31, 81.68s/it]
Task 3, Epoch 14/20 => Loss 0.207, Train_accy 93.24:  65%|██████▌   | 13/20 [19:09<09:31, 81.68s/it]
Task 3, Epoch 14/20 => Loss 0.207, Train_accy 93.24:  70%|███████   | 14/20 [19:09<08:04, 80.82s/it]
Task 3, Epoch 15/20 => Loss 0.202, Train_accy 93.39, Test_accy 68.22:  70%|███████   | 14/20 [20:51<08:04, 80.82s/it]
Task 3, Epoch 15/20 => Loss 0.202, Train_accy 93.39, Test_accy 68.22:  75%|███████▌  | 15/20 [20:51<07:16, 87.23s/it]
Task 3, Epoch 16/20 => Loss 0.200, Train_accy 93.69:  75%|███████▌  | 15/20 [22:10<07:16, 87.23s/it]                 
Task 3, Epoch 16/20 => Loss 0.200, Train_accy 93.69:  80%|████████  | 16/20 [22:10<05:38, 84.68s/it]
Task 3, Epoch 17/20 => Loss 0.186, Train_accy 93.83:  80%|████████  | 16/20 [23:29<05:38, 84.68s/it]
Task 3, Epoch 17/20 => Loss 0.186, Train_accy 93.83:  85%|████████▌ | 17/20 [23:29<04:08, 82.95s/it]
Task 3, Epoch 18/20 => Loss 0.183, Train_accy 93.89:  85%|████████▌ | 17/20 [24:48<04:08, 82.95s/it]
Task 3, Epoch 18/20 => Loss 0.183, Train_accy 93.89:  90%|█████████ | 18/20 [24:48<02:43, 81.74s/it]
Task 3, Epoch 19/20 => Loss 0.179, Train_accy 93.96:  90%|█████████ | 18/20 [26:07<02:43, 81.74s/it]
Task 3, Epoch 19/20 => Loss 0.179, Train_accy 93.96:  95%|█████████▌| 19/20 [26:07<01:20, 80.87s/it]
Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.25, Test_accy 67.89:  95%|█████████▌| 19/20 [27:49<01:20, 80.87s/it]
Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.25, Test_accy 67.89: 100%|██████████| 20/20 [27:49<00:00, 87.32s/it]
Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.25, Test_accy 67.89: 100%|██████████| 20/20 [27:49<00:00, 83.48s/it]
2024-04-24 05:38:51,445 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.25, Test_accy 67.89
2024-04-24 05:39:14,912 [trainer.py] => No NME accuracy.
2024-04-24 05:39:14,912 [trainer.py] => CNN: {'total': 67.89, '00-149': 74.06, '150-179': 73.12, '180-209': 56.93, '210-239': 42.83, 'old': 71.48, 'new': 42.83}
2024-04-24 05:39:14,913 [trainer.py] => CNN top1 curve: [75.93, 73.73, 71.64, 67.89]
2024-04-24 05:39:14,913 [trainer.py] => CNN top5 curve: [95.63, 94.16, 94.2, 93.11]

Average Accuracy (CNN): 72.3
2024-04-24 05:39:14,913 [trainer.py] => Average Accuracy (CNN): 72.3 

2024-04-24 05:39:14,913 [trainer.py] => Train Time: 26716.609999999997
2024-04-24 05:39:14,913 [trainer.py] => Test Time: 77.11 

2024-04-24 05:39:14,914 [trainer.py] => All params: 89869356
2024-04-24 05:39:14,915 [trainer.py] => Trainable params: 89869356
2024-04-24 05:39:17,154 [coda_prompt.py] => Learning on 240-270

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.780, Train_accy 77.35:   0%|          | 0/20 [01:22<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.780, Train_accy 77.35:   5%|▌         | 1/20 [01:22<26:01, 82.20s/it]
Task 4, Epoch 2/20 => Loss 0.514, Train_accy 84.55:   5%|▌         | 1/20 [02:44<26:01, 82.20s/it]
Task 4, Epoch 2/20 => Loss 0.514, Train_accy 84.55:  10%|█         | 2/20 [02:44<24:39, 82.21s/it]
Task 4, Epoch 3/20 => Loss 0.442, Train_accy 86.62:  10%|█         | 2/20 [04:06<24:39, 82.21s/it]
Task 4, Epoch 3/20 => Loss 0.442, Train_accy 86.62:  15%|█▌        | 3/20 [04:06<23:14, 82.03s/it]
Task 4, Epoch 4/20 => Loss 0.426, Train_accy 86.82:  15%|█▌        | 3/20 [05:28<23:14, 82.03s/it]
Task 4, Epoch 4/20 => Loss 0.426, Train_accy 86.82:  20%|██        | 4/20 [05:28<21:52, 82.05s/it]
Task 4, Epoch 5/20 => Loss 0.395, Train_accy 87.92, Test_accy 63.12:  20%|██        | 4/20 [07:16<21:52, 82.05s/it]
Task 4, Epoch 5/20 => Loss 0.395, Train_accy 87.92, Test_accy 63.12:  25%|██▌       | 5/20 [07:16<22:53, 91.55s/it]
Task 4, Epoch 6/20 => Loss 0.378, Train_accy 88.60:  25%|██▌       | 5/20 [08:38<22:53, 91.55s/it]                 
Task 4, Epoch 6/20 => Loss 0.378, Train_accy 88.60:  30%|███       | 6/20 [08:38<20:34, 88.21s/it]
Task 4, Epoch 7/20 => Loss 0.350, Train_accy 88.90:  30%|███       | 6/20 [10:00<20:34, 88.21s/it]
Task 4, Epoch 7/20 => Loss 0.350, Train_accy 88.90:  35%|███▌      | 7/20 [10:00<18:40, 86.17s/it]
Task 4, Epoch 8/20 => Loss 0.356, Train_accy 89.10:  35%|███▌      | 7/20 [11:22<18:40, 86.17s/it]
Task 4, Epoch 8/20 => Loss 0.356, Train_accy 89.10:  40%|████      | 8/20 [11:22<16:58, 84.88s/it]
Task 4, Epoch 9/20 => Loss 0.322, Train_accy 89.66:  40%|████      | 8/20 [12:44<16:58, 84.88s/it]
Task 4, Epoch 9/20 => Loss 0.322, Train_accy 89.66:  45%|████▌     | 9/20 [12:44<15:25, 84.10s/it]
Task 4, Epoch 10/20 => Loss 0.312, Train_accy 90.47, Test_accy 63.57:  45%|████▌     | 9/20 [14:33<15:25, 84.10s/it]
Task 4, Epoch 10/20 => Loss 0.312, Train_accy 90.47, Test_accy 63.57:  50%|█████     | 10/20 [14:33<15:15, 91.55s/it]
Task 4, Epoch 11/20 => Loss 0.289, Train_accy 91.08:  50%|█████     | 10/20 [15:55<15:15, 91.55s/it]                 
Task 4, Epoch 11/20 => Loss 0.289, Train_accy 91.08:  55%|█████▌    | 11/20 [15:55<13:17, 88.61s/it]
Task 4, Epoch 12/20 => Loss 0.306, Train_accy 90.44:  55%|█████▌    | 11/20 [17:17<13:17, 88.61s/it]
Task 4, Epoch 12/20 => Loss 0.306, Train_accy 90.44:  60%|██████    | 12/20 [17:17<11:33, 86.68s/it]
Task 4, Epoch 13/20 => Loss 0.296, Train_accy 90.86:  60%|██████    | 12/20 [18:39<11:33, 86.68s/it]
Task 4, Epoch 13/20 => Loss 0.296, Train_accy 90.86:  65%|██████▌   | 13/20 [18:39<09:57, 85.33s/it]
Task 4, Epoch 14/20 => Loss 0.279, Train_accy 91.85:  65%|██████▌   | 13/20 [20:01<09:57, 85.33s/it]
Task 4, Epoch 14/20 => Loss 0.279, Train_accy 91.85:  70%|███████   | 14/20 [20:01<08:26, 84.34s/it]
Task 4, Epoch 15/20 => Loss 0.266, Train_accy 91.77, Test_accy 63.75:  70%|███████   | 14/20 [21:50<08:26, 84.34s/it]
Task 4, Epoch 15/20 => Loss 0.266, Train_accy 91.77, Test_accy 63.75:  75%|███████▌  | 15/20 [21:50<07:38, 91.61s/it]
Task 4, Epoch 16/20 => Loss 0.273, Train_accy 91.33:  75%|███████▌  | 15/20 [23:12<07:38, 91.61s/it]                 
Task 4, Epoch 16/20 => Loss 0.273, Train_accy 91.33:  80%|████████  | 16/20 [23:12<05:55, 88.78s/it]
Task 4, Epoch 17/20 => Loss 0.258, Train_accy 92.07:  80%|████████  | 16/20 [24:34<05:55, 88.78s/it]
Task 4, Epoch 17/20 => Loss 0.258, Train_accy 92.07:  85%|████████▌ | 17/20 [24:34<04:20, 86.75s/it]
Task 4, Epoch 18/20 => Loss 0.257, Train_accy 92.03:  85%|████████▌ | 17/20 [25:56<04:20, 86.75s/it]
Task 4, Epoch 18/20 => Loss 0.257, Train_accy 92.03:  90%|█████████ | 18/20 [25:56<02:50, 85.42s/it]
Task 4, Epoch 19/20 => Loss 0.258, Train_accy 92.34:  90%|█████████ | 18/20 [27:19<02:50, 85.42s/it]
Task 4, Epoch 19/20 => Loss 0.258, Train_accy 92.34:  95%|█████████▌| 19/20 [27:19<01:24, 84.53s/it]
Task 4, Epoch 20/20 => Loss 0.234, Train_accy 92.79, Test_accy 63.33:  95%|█████████▌| 19/20 [29:07<01:24, 84.53s/it]
Task 4, Epoch 20/20 => Loss 0.234, Train_accy 92.79, Test_accy 63.33: 100%|██████████| 20/20 [29:07<00:00, 91.73s/it]
Task 4, Epoch 20/20 => Loss 0.234, Train_accy 92.79, Test_accy 63.33: 100%|██████████| 20/20 [29:07<00:00, 87.38s/it]
2024-04-24 06:08:24,789 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.234, Train_accy 92.79, Test_accy 63.33
2024-04-24 06:08:51,032 [trainer.py] => No NME accuracy.
2024-04-24 06:08:51,032 [trainer.py] => CNN: {'total': 63.33, '00-149': 74.16, '150-179': 72.45, '180-209': 56.76, '210-239': 42.67, '240-269': 27.26, 'old': 67.83, 'new': 27.26}
2024-04-24 06:08:51,033 [trainer.py] => CNN top1 curve: [75.93, 73.73, 71.64, 67.89, 63.33]
2024-04-24 06:08:51,033 [trainer.py] => CNN top5 curve: [95.63, 94.16, 94.2, 93.11, 91.36]

Average Accuracy (CNN): 70.5
2024-04-24 06:08:51,033 [trainer.py] => Average Accuracy (CNN): 70.5 

2024-04-24 06:08:51,033 [trainer.py] => Train Time: 30211.849999999995
2024-04-24 06:08:51,033 [trainer.py] => Test Time: 103.35 

2024-04-24 06:08:51,035 [trainer.py] => All params: 89869356
2024-04-24 06:08:51,036 [trainer.py] => Trainable params: 89869356
2024-04-24 06:08:53,880 [coda_prompt.py] => Learning on 270-300

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.722, Train_accy 78.19:   0%|          | 0/20 [01:28<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.722, Train_accy 78.19:   5%|▌         | 1/20 [01:28<28:00, 88.47s/it]
Task 5, Epoch 2/20 => Loss 0.456, Train_accy 85.83:   5%|▌         | 1/20 [02:56<28:00, 88.47s/it]
Task 5, Epoch 2/20 => Loss 0.456, Train_accy 85.83:  10%|█         | 2/20 [02:56<26:29, 88.31s/it]
Task 5, Epoch 3/20 => Loss 0.431, Train_accy 86.56:  10%|█         | 2/20 [04:24<26:29, 88.31s/it]
Task 5, Epoch 3/20 => Loss 0.431, Train_accy 86.56:  15%|█▌        | 3/20 [04:24<25:00, 88.24s/it]
Task 5, Epoch 4/20 => Loss 0.392, Train_accy 87.45:  15%|█▌        | 3/20 [05:52<25:00, 88.24s/it]
Task 5, Epoch 4/20 => Loss 0.392, Train_accy 87.45:  20%|██        | 4/20 [05:52<23:28, 88.06s/it]
Task 5, Epoch 5/20 => Loss 0.392, Train_accy 87.33, Test_accy 60.13:  20%|██        | 4/20 [07:49<23:28, 88.06s/it]
Task 5, Epoch 5/20 => Loss 0.392, Train_accy 87.33, Test_accy 60.13:  25%|██▌       | 5/20 [07:49<24:35, 98.36s/it]
Task 5, Epoch 6/20 => Loss 0.356, Train_accy 88.60:  25%|██▌       | 5/20 [09:17<24:35, 98.36s/it]                 
Task 5, Epoch 6/20 => Loss 0.356, Train_accy 88.60:  30%|███       | 6/20 [09:17<22:06, 94.78s/it]
Task 5, Epoch 7/20 => Loss 0.344, Train_accy 88.79:  30%|███       | 6/20 [10:45<22:06, 94.78s/it]
Task 5, Epoch 7/20 => Loss 0.344, Train_accy 88.79:  35%|███▌      | 7/20 [10:45<20:03, 92.58s/it]
Task 5, Epoch 8/20 => Loss 0.329, Train_accy 89.63:  35%|███▌      | 7/20 [12:13<20:03, 92.58s/it]
Task 5, Epoch 8/20 => Loss 0.329, Train_accy 89.63:  40%|████      | 8/20 [12:13<18:13, 91.11s/it]
Task 5, Epoch 9/20 => Loss 0.314, Train_accy 89.76:  40%|████      | 8/20 [13:40<18:13, 91.11s/it]
Task 5, Epoch 9/20 => Loss 0.314, Train_accy 89.76:  45%|████▌     | 9/20 [13:40<16:30, 90.06s/it]
Task 5, Epoch 10/20 => Loss 0.320, Train_accy 89.69, Test_accy 60.89:  45%|████▌     | 9/20 [15:37<16:30, 90.06s/it]
Task 5, Epoch 10/20 => Loss 0.320, Train_accy 89.69, Test_accy 60.89:  50%|█████     | 10/20 [15:37<16:24, 98.42s/it]
Task 5, Epoch 11/20 => Loss 0.305, Train_accy 90.32:  50%|█████     | 10/20 [17:05<16:24, 98.42s/it]                 
Task 5, Epoch 11/20 => Loss 0.305, Train_accy 90.32:  55%|█████▌    | 11/20 [17:05<14:16, 95.19s/it]
Task 5, Epoch 12/20 => Loss 0.294, Train_accy 90.39:  55%|█████▌    | 11/20 [18:33<14:16, 95.19s/it]
Task 5, Epoch 12/20 => Loss 0.294, Train_accy 90.39:  60%|██████    | 12/20 [18:33<12:24, 93.03s/it]
Task 5, Epoch 13/20 => Loss 0.280, Train_accy 90.80:  60%|██████    | 12/20 [20:01<12:24, 93.03s/it]
Task 5, Epoch 13/20 => Loss 0.280, Train_accy 90.80:  65%|██████▌   | 13/20 [20:01<10:40, 91.48s/it]
Task 5, Epoch 14/20 => Loss 0.276, Train_accy 91.45:  65%|██████▌   | 13/20 [21:29<10:40, 91.48s/it]
Task 5, Epoch 14/20 => Loss 0.276, Train_accy 91.45:  70%|███████   | 14/20 [21:29<09:02, 90.35s/it]
Task 5, Epoch 15/20 => Loss 0.280, Train_accy 91.20, Test_accy 60.84:  70%|███████   | 14/20 [23:26<09:02, 90.35s/it]
Task 5, Epoch 15/20 => Loss 0.280, Train_accy 91.20, Test_accy 60.84:  75%|███████▌  | 15/20 [23:26<08:11, 98.36s/it]
Task 5, Epoch 16/20 => Loss 0.264, Train_accy 91.71:  75%|███████▌  | 15/20 [24:54<08:11, 98.36s/it]                 
Task 5, Epoch 16/20 => Loss 0.264, Train_accy 91.71:  80%|████████  | 16/20 [24:54<06:20, 95.23s/it]
Task 5, Epoch 17/20 => Loss 0.259, Train_accy 91.75:  80%|████████  | 16/20 [26:22<06:20, 95.23s/it]
Task 5, Epoch 17/20 => Loss 0.259, Train_accy 91.75:  85%|████████▌ | 17/20 [26:22<04:39, 93.07s/it]
Task 5, Epoch 18/20 => Loss 0.265, Train_accy 91.52:  85%|████████▌ | 17/20 [27:50<04:39, 93.07s/it]
Task 5, Epoch 18/20 => Loss 0.265, Train_accy 91.52:  90%|█████████ | 18/20 [27:50<03:03, 91.51s/it]
Task 5, Epoch 19/20 => Loss 0.253, Train_accy 91.79:  90%|█████████ | 18/20 [29:18<03:03, 91.51s/it]
Task 5, Epoch 19/20 => Loss 0.253, Train_accy 91.79:  95%|█████████▌| 19/20 [29:18<01:30, 90.41s/it]
Task 5, Epoch 20/20 => Loss 0.238, Train_accy 92.48, Test_accy 60.79:  95%|█████████▌| 19/20 [31:14<01:30, 90.41s/it]
Task 5, Epoch 20/20 => Loss 0.238, Train_accy 92.48, Test_accy 60.79: 100%|██████████| 20/20 [31:14<00:00, 98.15s/it]
Task 5, Epoch 20/20 => Loss 0.238, Train_accy 92.48, Test_accy 60.79: 100%|██████████| 20/20 [31:14<00:00, 93.72s/it]
2024-04-24 06:40:08,321 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.238, Train_accy 92.48, Test_accy 60.79
2024-04-24 06:40:37,142 [trainer.py] => No NME accuracy.
2024-04-24 06:40:37,142 [trainer.py] => CNN: {'total': 60.79, '00-149': 73.99, '150-179': 72.62, '180-209': 56.59, '210-239': 42.5, '240-269': 27.42, '270-299': 38.55, 'old': 63.24, 'new': 38.55}
2024-04-24 06:40:37,142 [trainer.py] => CNN top1 curve: [75.93, 73.73, 71.64, 67.89, 63.33, 60.79]
2024-04-24 06:40:37,143 [trainer.py] => CNN top5 curve: [95.63, 94.16, 94.2, 93.11, 91.36, 90.16]

Average Accuracy (CNN): 68.89
2024-04-24 06:40:37,143 [trainer.py] => Average Accuracy (CNN): 68.89 

2024-04-24 06:40:37,143 [trainer.py] => Train Time: 33960.7
2024-04-24 06:40:37,143 [trainer.py] => Test Time: 132.17 

Accuracy Matrix (CNN):
[[75.93 73.82 74.09 74.06 74.16 73.99]
 [ 0.   73.29 73.12 73.12 72.45 72.62]
 [ 0.    0.   57.93 56.93 56.76 56.59]
 [ 0.    0.    0.   42.83 42.67 42.5 ]
 [ 0.    0.    0.    0.   27.26 27.42]
 [ 0.    0.    0.    0.    0.   38.55]]
2024-04-24 06:40:37,144 [trainer.py] => Forgetting (CNN): 0.8560000000000016
2024-04-24 06:40:39,706 [trainer.py] => config: ./exps/ease_omn_B150.json
2024-04-24 06:40:39,706 [trainer.py] => prefix:  
2024-04-24 06:40:39,706 [trainer.py] => dataset: omnibenchmark
2024-04-24 06:40:39,706 [trainer.py] => memory_size: 0
2024-04-24 06:40:39,706 [trainer.py] => memory_per_class: 0
2024-04-24 06:40:39,706 [trainer.py] => fixed_memory: False
2024-04-24 06:40:39,706 [trainer.py] => shuffle: True
2024-04-24 06:40:39,706 [trainer.py] => init_cls: 150
2024-04-24 06:40:39,706 [trainer.py] => increment: 30
2024-04-24 06:40:39,706 [trainer.py] => model_name: ease
2024-04-24 06:40:39,706 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2024-04-24 06:40:39,706 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-24 06:40:39,706 [trainer.py] => seed: 1993
2024-04-24 06:40:39,706 [trainer.py] => init_epochs: 20
2024-04-24 06:40:39,706 [trainer.py] => init_lr: 0.05
2024-04-24 06:40:39,706 [trainer.py] => later_epochs: 20
2024-04-24 06:40:39,706 [trainer.py] => later_lr: 0.05
2024-04-24 06:40:39,706 [trainer.py] => batch_size: 48
2024-04-24 06:40:39,706 [trainer.py] => weight_decay: 0.005
2024-04-24 06:40:39,707 [trainer.py] => min_lr: 0
2024-04-24 06:40:39,707 [trainer.py] => optimizer: sgd
2024-04-24 06:40:39,707 [trainer.py] => scheduler: cosine
2024-04-24 06:40:39,707 [trainer.py] => pretrained: True
2024-04-24 06:40:39,707 [trainer.py] => vpt_type: Deep
2024-04-24 06:40:39,707 [trainer.py] => prompt_token_num: 5
2024-04-24 06:40:39,707 [trainer.py] => ffn_num: 64
2024-04-24 06:40:39,707 [trainer.py] => use_diagonal: False
2024-04-24 06:40:39,707 [trainer.py] => recalc_sim: True
2024-04-24 06:40:39,707 [trainer.py] => alpha: 0.1
2024-04-24 06:40:39,707 [trainer.py] => use_init_ptm: False
2024-04-24 06:40:39,707 [trainer.py] => beta: 0
2024-04-24 06:40:39,707 [trainer.py] => use_old_data: False
2024-04-24 06:40:39,707 [trainer.py] => use_reweight: True
2024-04-24 06:40:39,707 [trainer.py] => moni_adam: False
2024-04-24 06:40:39,707 [trainer.py] => adapter_num: -1
2024-04-24 06:40:39,960 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
This is for the BaseNet initialization.
I'm using ViT with adapters.
_IncompatibleKeys(missing_keys=['cur_adapter.0.down_proj.weight', 'cur_adapter.0.down_proj.bias', 'cur_adapter.0.up_proj.weight', 'cur_adapter.0.up_proj.bias', 'cur_adapter.1.down_proj.weight', 'cur_adapter.1.down_proj.bias', 'cur_adapter.1.up_proj.weight', 'cur_adapter.1.up_proj.bias', 'cur_adapter.2.down_proj.weight', 'cur_adapter.2.down_proj.bias', 'cur_adapter.2.up_proj.weight', 'cur_adapter.2.up_proj.bias', 'cur_adapter.3.down_proj.weight', 'cur_adapter.3.down_proj.bias', 'cur_adapter.3.up_proj.weight', 'cur_adapter.3.up_proj.bias', 'cur_adapter.4.down_proj.weight', 'cur_adapter.4.down_proj.bias', 'cur_adapter.4.up_proj.weight', 'cur_adapter.4.up_proj.bias', 'cur_adapter.5.down_proj.weight', 'cur_adapter.5.down_proj.bias', 'cur_adapter.5.up_proj.weight', 'cur_adapter.5.up_proj.bias', 'cur_adapter.6.down_proj.weight', 'cur_adapter.6.down_proj.bias', 'cur_adapter.6.up_proj.weight', 'cur_adapter.6.up_proj.bias', 'cur_adapter.7.down_proj.weight', 'cur_adapter.7.down_proj.bias', 'cur_adapter.7.up_proj.weight', 'cur_adapter.7.up_proj.bias', 'cur_adapter.8.down_proj.weight', 'cur_adapter.8.down_proj.bias', 'cur_adapter.8.up_proj.weight', 'cur_adapter.8.up_proj.bias', 'cur_adapter.9.down_proj.weight', 'cur_adapter.9.down_proj.bias', 'cur_adapter.9.up_proj.weight', 'cur_adapter.9.up_proj.bias', 'cur_adapter.10.down_proj.weight', 'cur_adapter.10.down_proj.bias', 'cur_adapter.10.up_proj.weight', 'cur_adapter.10.up_proj.bias', 'cur_adapter.11.down_proj.weight', 'cur_adapter.11.down_proj.bias', 'cur_adapter.11.up_proj.weight', 'cur_adapter.11.up_proj.bias'], unexpected_keys=[])
After BaseNet initialization.
2024-04-24 06:40:43,726 [trainer.py] => All params: 86988288
2024-04-24 06:40:43,726 [trainer.py] => Trainable params: 1189632
2024-04-24 06:40:43,738 [ease.py] => Learning on 0-150

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.392, Train_accy 67.64:   0%|          | 0/20 [03:43<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.392, Train_accy 67.64:   5%|▌         | 1/20 [03:43<1:10:37, 223.04s/it]
Task 0, Epoch 2/20 => Loss 1.012, Train_accy 72.71:   5%|▌         | 1/20 [07:25<1:10:37, 223.04s/it]
Task 0, Epoch 2/20 => Loss 1.012, Train_accy 72.71:  10%|█         | 2/20 [07:25<1:06:48, 222.67s/it]
Task 0, Epoch 3/20 => Loss 1.004, Train_accy 72.81:  10%|█         | 2/20 [11:08<1:06:48, 222.67s/it]
Task 0, Epoch 3/20 => Loss 1.004, Train_accy 72.81:  15%|█▌        | 3/20 [11:08<1:03:08, 222.87s/it]
Task 0, Epoch 4/20 => Loss 1.008, Train_accy 72.87:  15%|█▌        | 3/20 [14:52<1:03:08, 222.87s/it]
Task 0, Epoch 4/20 => Loss 1.008, Train_accy 72.87:  20%|██        | 4/20 [14:52<59:29, 223.11s/it]  
Task 0, Epoch 5/20 => Loss 1.003, Train_accy 72.68:  20%|██        | 4/20 [18:34<59:29, 223.11s/it]
Task 0, Epoch 5/20 => Loss 1.003, Train_accy 72.68:  25%|██▌       | 5/20 [18:34<55:44, 222.99s/it]
Task 0, Epoch 6/20 => Loss 0.993, Train_accy 73.06:  25%|██▌       | 5/20 [22:17<55:44, 222.99s/it]
Task 0, Epoch 6/20 => Loss 0.993, Train_accy 73.06:  30%|███       | 6/20 [22:17<51:58, 222.78s/it]
Task 0, Epoch 7/20 => Loss 0.991, Train_accy 73.13:  30%|███       | 6/20 [25:59<51:58, 222.78s/it]
Task 0, Epoch 7/20 => Loss 0.991, Train_accy 73.13:  35%|███▌      | 7/20 [25:59<48:15, 222.71s/it]
Task 0, Epoch 8/20 => Loss 0.976, Train_accy 73.50:  35%|███▌      | 7/20 [29:42<48:15, 222.71s/it]
Task 0, Epoch 8/20 => Loss 0.976, Train_accy 73.50:  40%|████      | 8/20 [29:42<44:33, 222.82s/it]
Task 0, Epoch 9/20 => Loss 0.973, Train_accy 73.75:  40%|████      | 8/20 [33:25<44:33, 222.82s/it]
Task 0, Epoch 9/20 => Loss 0.973, Train_accy 73.75:  45%|████▌     | 9/20 [33:25<40:51, 222.88s/it]
Task 0, Epoch 10/20 => Loss 0.964, Train_accy 74.02:  45%|████▌     | 9/20 [37:08<40:51, 222.88s/it]
Task 0, Epoch 10/20 => Loss 0.964, Train_accy 74.02:  50%|█████     | 10/20 [37:08<37:06, 222.70s/it]
Task 0, Epoch 11/20 => Loss 0.957, Train_accy 74.37:  50%|█████     | 10/20 [40:50<37:06, 222.70s/it]
Task 0, Epoch 11/20 => Loss 0.957, Train_accy 74.37:  55%|█████▌    | 11/20 [40:50<33:23, 222.60s/it]
Task 0, Epoch 12/20 => Loss 0.946, Train_accy 74.63:  55%|█████▌    | 11/20 [44:32<33:23, 222.60s/it]
Task 0, Epoch 12/20 => Loss 0.946, Train_accy 74.63:  60%|██████    | 12/20 [44:32<29:39, 222.45s/it]
Task 0, Epoch 13/20 => Loss 0.928, Train_accy 75.18:  60%|██████    | 12/20 [48:14<29:39, 222.45s/it]
Task 0, Epoch 13/20 => Loss 0.928, Train_accy 75.18:  65%|██████▌   | 13/20 [48:14<25:56, 222.36s/it]
Task 0, Epoch 14/20 => Loss 0.923, Train_accy 75.43:  65%|██████▌   | 13/20 [51:57<25:56, 222.36s/it]
Task 0, Epoch 14/20 => Loss 0.923, Train_accy 75.43:  70%|███████   | 14/20 [51:57<22:14, 222.35s/it]
Task 0, Epoch 15/20 => Loss 0.906, Train_accy 76.15:  70%|███████   | 14/20 [55:39<22:14, 222.35s/it]
Task 0, Epoch 15/20 => Loss 0.906, Train_accy 76.15:  75%|███████▌  | 15/20 [55:39<18:31, 222.32s/it]
Task 0, Epoch 16/20 => Loss 0.891, Train_accy 76.58:  75%|███████▌  | 15/20 [59:21<18:31, 222.32s/it]
Task 0, Epoch 16/20 => Loss 0.891, Train_accy 76.58:  80%|████████  | 16/20 [59:21<14:49, 222.40s/it]
Task 0, Epoch 17/20 => Loss 0.873, Train_accy 77.37:  80%|████████  | 16/20 [1:03:04<14:49, 222.40s/it]
Task 0, Epoch 17/20 => Loss 0.873, Train_accy 77.37:  85%|████████▌ | 17/20 [1:03:04<11:06, 222.32s/it]
Task 0, Epoch 18/20 => Loss 0.850, Train_accy 78.30:  85%|████████▌ | 17/20 [1:06:46<11:06, 222.32s/it]
Task 0, Epoch 18/20 => Loss 0.850, Train_accy 78.30:  90%|█████████ | 18/20 [1:06:46<07:24, 222.22s/it]
Task 0, Epoch 19/20 => Loss 0.842, Train_accy 78.85:  90%|█████████ | 18/20 [1:10:28<07:24, 222.22s/it]
Task 0, Epoch 19/20 => Loss 0.842, Train_accy 78.85:  95%|█████████▌| 19/20 [1:10:28<03:42, 222.16s/it]
Task 0, Epoch 20/20 => Loss 0.822, Train_accy 79.53:  95%|█████████▌| 19/20 [1:14:11<03:42, 222.16s/it]
Task 0, Epoch 20/20 => Loss 0.822, Train_accy 79.53: 100%|██████████| 20/20 [1:14:11<00:00, 222.66s/it]
Task 0, Epoch 20/20 => Loss 0.822, Train_accy 79.53: 100%|██████████| 20/20 [1:14:11<00:00, 222.60s/it]
2024-04-24 07:54:55,782 [ease.py] => Task 0, Epoch 20/20 => Loss 0.822, Train_accy 79.53
2024-04-24 07:57:03,203 [ease.py] => Task correct: 83.03273213092852
2024-04-24 07:57:03,204 [ease.py] => Task acc: 89.57915831663327
2024-04-24 07:57:03,245 [trainer.py] => No NME accuracy.
2024-04-24 07:57:03,245 [trainer.py] => CNN: {'total': 79.69, '00-149': 79.69, 'old': 0, 'new': 79.69}
2024-04-24 07:57:03,245 [trainer.py] => CNN top1 curve: [79.69]
2024-04-24 07:57:03,245 [trainer.py] => CNN top5 curve: [95.26]

Average Accuracy (CNN): 79.69
2024-04-24 07:57:03,245 [trainer.py] => Average Accuracy (CNN): 79.69 

2024-04-24 07:57:03,245 [trainer.py] => Train Time: 8903.88
2024-04-24 07:57:03,245 [trainer.py] => Test Time: 8.81 

2024-04-24 07:57:03,246 [trainer.py] => All params: 87218690
2024-04-24 07:57:03,247 [trainer.py] => Trainable params: 1189632
2024-04-24 07:57:03,251 [ease.py] => Learning on 150-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.186, Train_accy 76.71:   0%|          | 0/20 [00:44<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.186, Train_accy 76.71:   5%|▌         | 1/20 [00:44<14:03, 44.38s/it]
Task 1, Epoch 2/20 => Loss 0.503, Train_accy 86.25:   5%|▌         | 1/20 [01:29<14:03, 44.38s/it]
Task 1, Epoch 2/20 => Loss 0.503, Train_accy 86.25:  10%|█         | 2/20 [01:29<13:21, 44.53s/it]
Task 1, Epoch 3/20 => Loss 0.487, Train_accy 86.49:  10%|█         | 2/20 [02:13<13:21, 44.53s/it]
Task 1, Epoch 3/20 => Loss 0.487, Train_accy 86.49:  15%|█▌        | 3/20 [02:13<12:38, 44.60s/it]
Task 1, Epoch 4/20 => Loss 0.466, Train_accy 87.40:  15%|█▌        | 3/20 [02:58<12:38, 44.60s/it]
Task 1, Epoch 4/20 => Loss 0.466, Train_accy 87.40:  20%|██        | 4/20 [02:58<11:52, 44.52s/it]
Task 1, Epoch 5/20 => Loss 0.456, Train_accy 87.75:  20%|██        | 4/20 [03:42<11:52, 44.52s/it]
Task 1, Epoch 5/20 => Loss 0.456, Train_accy 87.75:  25%|██▌       | 5/20 [03:42<11:08, 44.53s/it]
Task 1, Epoch 6/20 => Loss 0.457, Train_accy 87.31:  25%|██▌       | 5/20 [04:27<11:08, 44.53s/it]
Task 1, Epoch 6/20 => Loss 0.457, Train_accy 87.31:  30%|███       | 6/20 [04:27<10:22, 44.50s/it]
Task 1, Epoch 7/20 => Loss 0.452, Train_accy 87.53:  30%|███       | 6/20 [05:11<10:22, 44.50s/it]
Task 1, Epoch 7/20 => Loss 0.452, Train_accy 87.53:  35%|███▌      | 7/20 [05:11<09:37, 44.45s/it]
Task 1, Epoch 8/20 => Loss 0.442, Train_accy 87.88:  35%|███▌      | 7/20 [05:55<09:37, 44.45s/it]
Task 1, Epoch 8/20 => Loss 0.442, Train_accy 87.88:  40%|████      | 8/20 [05:55<08:52, 44.37s/it]
Task 1, Epoch 9/20 => Loss 0.450, Train_accy 87.63:  40%|████      | 8/20 [06:39<08:52, 44.37s/it]
Task 1, Epoch 9/20 => Loss 0.450, Train_accy 87.63:  45%|████▌     | 9/20 [06:39<08:07, 44.31s/it]
Task 1, Epoch 10/20 => Loss 0.437, Train_accy 88.53:  45%|████▌     | 9/20 [07:23<08:07, 44.31s/it]
Task 1, Epoch 10/20 => Loss 0.437, Train_accy 88.53:  50%|█████     | 10/20 [07:23<07:22, 44.25s/it]
Task 1, Epoch 11/20 => Loss 0.432, Train_accy 88.38:  50%|█████     | 10/20 [08:08<07:22, 44.25s/it]
Task 1, Epoch 11/20 => Loss 0.432, Train_accy 88.38:  55%|█████▌    | 11/20 [08:08<06:38, 44.24s/it]
Task 1, Epoch 12/20 => Loss 0.424, Train_accy 88.86:  55%|█████▌    | 11/20 [08:52<06:38, 44.24s/it]
Task 1, Epoch 12/20 => Loss 0.424, Train_accy 88.86:  60%|██████    | 12/20 [08:52<05:54, 44.33s/it]
Task 1, Epoch 13/20 => Loss 0.423, Train_accy 88.67:  60%|██████    | 12/20 [09:37<05:54, 44.33s/it]
Task 1, Epoch 13/20 => Loss 0.423, Train_accy 88.67:  65%|██████▌   | 13/20 [09:37<05:10, 44.35s/it]
Task 1, Epoch 14/20 => Loss 0.411, Train_accy 89.05:  65%|██████▌   | 13/20 [10:21<05:10, 44.35s/it]
Task 1, Epoch 14/20 => Loss 0.411, Train_accy 89.05:  70%|███████   | 14/20 [10:21<04:26, 44.38s/it]
Task 1, Epoch 15/20 => Loss 0.402, Train_accy 89.20:  70%|███████   | 14/20 [11:05<04:26, 44.38s/it]
Task 1, Epoch 15/20 => Loss 0.402, Train_accy 89.20:  75%|███████▌  | 15/20 [11:05<03:41, 44.33s/it]
Task 1, Epoch 16/20 => Loss 0.407, Train_accy 89.24:  75%|███████▌  | 15/20 [11:50<03:41, 44.33s/it]
Task 1, Epoch 16/20 => Loss 0.407, Train_accy 89.24:  80%|████████  | 16/20 [11:50<02:57, 44.32s/it]
Task 1, Epoch 17/20 => Loss 0.399, Train_accy 89.75:  80%|████████  | 16/20 [12:34<02:57, 44.32s/it]
Task 1, Epoch 17/20 => Loss 0.399, Train_accy 89.75:  85%|████████▌ | 17/20 [12:34<02:12, 44.30s/it]
Task 1, Epoch 18/20 => Loss 0.389, Train_accy 90.00:  85%|████████▌ | 17/20 [13:18<02:12, 44.30s/it]
Task 1, Epoch 18/20 => Loss 0.389, Train_accy 90.00:  90%|█████████ | 18/20 [13:18<01:28, 44.30s/it]
Task 1, Epoch 19/20 => Loss 0.393, Train_accy 89.71:  90%|█████████ | 18/20 [14:03<01:28, 44.30s/it]
Task 1, Epoch 19/20 => Loss 0.393, Train_accy 89.71:  95%|█████████▌| 19/20 [14:03<00:44, 44.39s/it]
Task 1, Epoch 20/20 => Loss 0.381, Train_accy 90.09:  95%|█████████▌| 19/20 [14:47<00:44, 44.39s/it]
Task 1, Epoch 20/20 => Loss 0.381, Train_accy 90.09: 100%|██████████| 20/20 [14:47<00:00, 44.35s/it]
Task 1, Epoch 20/20 => Loss 0.381, Train_accy 90.09: 100%|██████████| 20/20 [14:47<00:00, 44.37s/it]
2024-04-24 08:11:50,730 [ease.py] => Task 1, Epoch 20/20 => Loss 0.381, Train_accy 90.09
2024-04-24 08:12:57,796 [ease.py] => Task correct: 78.47995545657015
2024-04-24 08:12:57,796 [ease.py] => Task acc: 89.42093541202672
2024-04-24 08:12:57,846 [trainer.py] => No NME accuracy.
2024-04-24 08:12:57,846 [trainer.py] => CNN: {'total': 75.14, '00-149': 74.35, '150-179': 79.1, 'old': 74.35, 'new': 79.1}
2024-04-24 08:12:57,846 [trainer.py] => CNN top1 curve: [79.69, 75.14]
2024-04-24 08:12:57,846 [trainer.py] => CNN top5 curve: [95.26, 93.37]

Average Accuracy (CNN): 77.41
2024-04-24 08:12:57,846 [trainer.py] => Average Accuracy (CNN): 77.41 

2024-04-24 08:12:57,846 [trainer.py] => Train Time: 10678.8
2024-04-24 08:12:57,846 [trainer.py] => Test Time: 27.560000000000002 

2024-04-24 08:12:57,847 [trainer.py] => All params: 87287810
2024-04-24 08:12:57,847 [trainer.py] => Trainable params: 1189632
2024-04-24 08:12:57,854 [ease.py] => Learning on 180-210

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.139, Train_accy 77.46:   0%|          | 0/20 [00:44<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.139, Train_accy 77.46:   5%|▌         | 1/20 [00:44<14:10, 44.74s/it]
Task 2, Epoch 2/20 => Loss 0.478, Train_accy 85.59:   5%|▌         | 1/20 [01:29<14:10, 44.74s/it]
Task 2, Epoch 2/20 => Loss 0.478, Train_accy 85.59:  10%|█         | 2/20 [01:29<13:24, 44.69s/it]
Task 2, Epoch 3/20 => Loss 0.448, Train_accy 86.07:  10%|█         | 2/20 [02:13<13:24, 44.69s/it]
Task 2, Epoch 3/20 => Loss 0.448, Train_accy 86.07:  15%|█▌        | 3/20 [02:13<12:38, 44.60s/it]
Task 2, Epoch 4/20 => Loss 0.435, Train_accy 86.80:  15%|█▌        | 3/20 [02:58<12:38, 44.60s/it]
Task 2, Epoch 4/20 => Loss 0.435, Train_accy 86.80:  20%|██        | 4/20 [02:58<11:55, 44.74s/it]
Task 2, Epoch 5/20 => Loss 0.420, Train_accy 87.35:  20%|██        | 4/20 [03:43<11:55, 44.74s/it]
Task 2, Epoch 5/20 => Loss 0.420, Train_accy 87.35:  25%|██▌       | 5/20 [03:43<11:10, 44.73s/it]
Task 2, Epoch 6/20 => Loss 0.430, Train_accy 87.11:  25%|██▌       | 5/20 [04:27<11:10, 44.73s/it]
Task 2, Epoch 6/20 => Loss 0.430, Train_accy 87.11:  30%|███       | 6/20 [04:27<10:24, 44.63s/it]
Task 2, Epoch 7/20 => Loss 0.416, Train_accy 87.21:  30%|███       | 6/20 [05:12<10:24, 44.63s/it]
Task 2, Epoch 7/20 => Loss 0.416, Train_accy 87.21:  35%|███▌      | 7/20 [05:12<09:39, 44.55s/it]
Task 2, Epoch 8/20 => Loss 0.423, Train_accy 87.28:  35%|███▌      | 7/20 [05:56<09:39, 44.55s/it]
Task 2, Epoch 8/20 => Loss 0.423, Train_accy 87.28:  40%|████      | 8/20 [05:56<08:53, 44.47s/it]
Task 2, Epoch 9/20 => Loss 0.414, Train_accy 87.45:  40%|████      | 8/20 [06:41<08:53, 44.47s/it]
Task 2, Epoch 9/20 => Loss 0.414, Train_accy 87.45:  45%|████▌     | 9/20 [06:41<08:10, 44.56s/it]
Task 2, Epoch 10/20 => Loss 0.415, Train_accy 87.03:  45%|████▌     | 9/20 [07:26<08:10, 44.56s/it]
Task 2, Epoch 10/20 => Loss 0.415, Train_accy 87.03:  50%|█████     | 10/20 [07:26<07:26, 44.67s/it]
Task 2, Epoch 11/20 => Loss 0.416, Train_accy 86.99:  50%|█████     | 10/20 [08:11<07:26, 44.67s/it]
Task 2, Epoch 11/20 => Loss 0.416, Train_accy 86.99:  55%|█████▌    | 11/20 [08:11<06:42, 44.77s/it]
Task 2, Epoch 12/20 => Loss 0.405, Train_accy 87.72:  55%|█████▌    | 11/20 [08:55<06:42, 44.77s/it]
Task 2, Epoch 12/20 => Loss 0.405, Train_accy 87.72:  60%|██████    | 12/20 [08:55<05:57, 44.73s/it]
Task 2, Epoch 13/20 => Loss 0.389, Train_accy 88.69:  60%|██████    | 12/20 [09:40<05:57, 44.73s/it]
Task 2, Epoch 13/20 => Loss 0.389, Train_accy 88.69:  65%|██████▌   | 13/20 [09:40<05:12, 44.62s/it]
Task 2, Epoch 14/20 => Loss 0.396, Train_accy 88.22:  65%|██████▌   | 13/20 [10:24<05:12, 44.62s/it]
Task 2, Epoch 14/20 => Loss 0.396, Train_accy 88.22:  70%|███████   | 14/20 [10:24<04:27, 44.56s/it]
Task 2, Epoch 15/20 => Loss 0.391, Train_accy 88.46:  70%|███████   | 14/20 [11:09<04:27, 44.56s/it]
Task 2, Epoch 15/20 => Loss 0.391, Train_accy 88.46:  75%|███████▌  | 15/20 [11:09<03:42, 44.46s/it]
Task 2, Epoch 16/20 => Loss 0.393, Train_accy 88.25:  75%|███████▌  | 15/20 [11:53<03:42, 44.46s/it]
Task 2, Epoch 16/20 => Loss 0.393, Train_accy 88.25:  80%|████████  | 16/20 [11:53<02:58, 44.55s/it]
Task 2, Epoch 17/20 => Loss 0.378, Train_accy 89.37:  80%|████████  | 16/20 [12:38<02:58, 44.55s/it]
Task 2, Epoch 17/20 => Loss 0.378, Train_accy 89.37:  85%|████████▌ | 17/20 [12:38<02:13, 44.48s/it]
Task 2, Epoch 18/20 => Loss 0.381, Train_accy 88.94:  85%|████████▌ | 17/20 [13:22<02:13, 44.48s/it]
Task 2, Epoch 18/20 => Loss 0.381, Train_accy 88.94:  90%|█████████ | 18/20 [13:22<01:28, 44.40s/it]
Task 2, Epoch 19/20 => Loss 0.376, Train_accy 89.81:  90%|█████████ | 18/20 [14:06<01:28, 44.40s/it]
Task 2, Epoch 19/20 => Loss 0.376, Train_accy 89.81:  95%|█████████▌| 19/20 [14:06<00:44, 44.39s/it]
Task 2, Epoch 20/20 => Loss 0.370, Train_accy 89.68:  95%|█████████▌| 19/20 [14:50<00:44, 44.39s/it]
Task 2, Epoch 20/20 => Loss 0.370, Train_accy 89.68: 100%|██████████| 20/20 [14:50<00:00, 44.34s/it]
Task 2, Epoch 20/20 => Loss 0.370, Train_accy 89.68: 100%|██████████| 20/20 [14:50<00:00, 44.54s/it]
2024-04-24 08:27:48,768 [ease.py] => Task 2, Epoch 20/20 => Loss 0.370, Train_accy 89.68
2024-04-24 08:29:31,300 [ease.py] => Task correct: 73.86010981141084
2024-04-24 08:29:31,301 [ease.py] => Task acc: 89.80663642874194
2024-04-24 08:29:31,343 [trainer.py] => No NME accuracy.
2024-04-24 08:29:31,343 [trainer.py] => CNN: {'total': 71.09, '00-149': 67.97, '150-179': 70.9, '180-209': 86.93, 'old': 68.46, 'new': 86.93}
2024-04-24 08:29:31,343 [trainer.py] => CNN top1 curve: [79.69, 75.14, 71.09]
2024-04-24 08:29:31,343 [trainer.py] => CNN top5 curve: [95.26, 93.37, 91.96]

Average Accuracy (CNN): 75.31
2024-04-24 08:29:31,343 [trainer.py] => Average Accuracy (CNN): 75.31 

2024-04-24 08:29:31,343 [trainer.py] => Train Time: 12460.589999999998
2024-04-24 08:29:31,343 [trainer.py] => Test Time: 58.910000000000004 

2024-04-24 08:29:31,344 [trainer.py] => All params: 87495170
2024-04-24 08:29:31,345 [trainer.py] => Trainable params: 1189632
2024-04-24 08:29:31,352 [ease.py] => Learning on 210-240

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.196, Train_accy 74.65:   0%|          | 0/20 [00:46<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.196, Train_accy 74.65:   5%|▌         | 1/20 [00:46<14:43, 46.51s/it]
Task 3, Epoch 2/20 => Loss 0.567, Train_accy 83.36:   5%|▌         | 1/20 [01:33<14:43, 46.51s/it]
Task 3, Epoch 2/20 => Loss 0.567, Train_accy 83.36:  10%|█         | 2/20 [01:33<14:06, 47.02s/it]
Task 3, Epoch 3/20 => Loss 0.551, Train_accy 83.56:  10%|█         | 2/20 [02:20<14:06, 47.02s/it]
Task 3, Epoch 3/20 => Loss 0.551, Train_accy 83.56:  15%|█▌        | 3/20 [02:20<13:18, 46.96s/it]
Task 3, Epoch 4/20 => Loss 0.529, Train_accy 84.64:  15%|█▌        | 3/20 [03:07<13:18, 46.96s/it]
Task 3, Epoch 4/20 => Loss 0.529, Train_accy 84.64:  20%|██        | 4/20 [03:07<12:32, 47.06s/it]
Task 3, Epoch 5/20 => Loss 0.528, Train_accy 84.43:  20%|██        | 4/20 [03:54<12:32, 47.06s/it]
Task 3, Epoch 5/20 => Loss 0.528, Train_accy 84.43:  25%|██▌       | 5/20 [03:54<11:42, 46.84s/it]
Task 3, Epoch 6/20 => Loss 0.521, Train_accy 84.59:  25%|██▌       | 5/20 [04:40<11:42, 46.84s/it]
Task 3, Epoch 6/20 => Loss 0.521, Train_accy 84.59:  30%|███       | 6/20 [04:41<10:54, 46.74s/it]
Task 3, Epoch 7/20 => Loss 0.513, Train_accy 85.04:  30%|███       | 6/20 [05:27<10:54, 46.74s/it]
Task 3, Epoch 7/20 => Loss 0.513, Train_accy 85.04:  35%|███▌      | 7/20 [05:27<10:07, 46.69s/it]
Task 3, Epoch 8/20 => Loss 0.518, Train_accy 84.65:  35%|███▌      | 7/20 [06:14<10:07, 46.69s/it]
Task 3, Epoch 8/20 => Loss 0.518, Train_accy 84.65:  40%|████      | 8/20 [06:14<09:19, 46.63s/it]
Task 3, Epoch 9/20 => Loss 0.509, Train_accy 85.05:  40%|████      | 8/20 [07:00<09:19, 46.63s/it]
Task 3, Epoch 9/20 => Loss 0.509, Train_accy 85.05:  45%|████▌     | 9/20 [07:00<08:33, 46.70s/it]
Task 3, Epoch 10/20 => Loss 0.508, Train_accy 85.24:  45%|████▌     | 9/20 [07:47<08:33, 46.70s/it]
Task 3, Epoch 10/20 => Loss 0.508, Train_accy 85.24:  50%|█████     | 10/20 [07:47<07:46, 46.65s/it]
Task 3, Epoch 11/20 => Loss 0.492, Train_accy 85.67:  50%|█████     | 10/20 [08:33<07:46, 46.65s/it]
Task 3, Epoch 11/20 => Loss 0.492, Train_accy 85.67:  55%|█████▌    | 11/20 [08:33<06:59, 46.61s/it]
Task 3, Epoch 12/20 => Loss 0.496, Train_accy 85.48:  55%|█████▌    | 11/20 [09:20<06:59, 46.61s/it]
Task 3, Epoch 12/20 => Loss 0.496, Train_accy 85.48:  60%|██████    | 12/20 [09:20<06:12, 46.56s/it]
Task 3, Epoch 13/20 => Loss 0.499, Train_accy 85.40:  60%|██████    | 12/20 [10:06<06:12, 46.56s/it]
Task 3, Epoch 13/20 => Loss 0.499, Train_accy 85.40:  65%|██████▌   | 13/20 [10:06<05:25, 46.52s/it]
Task 3, Epoch 14/20 => Loss 0.481, Train_accy 86.53:  65%|██████▌   | 13/20 [10:53<05:25, 46.52s/it]
Task 3, Epoch 14/20 => Loss 0.481, Train_accy 86.53:  70%|███████   | 14/20 [10:53<04:39, 46.57s/it]
Task 3, Epoch 15/20 => Loss 0.477, Train_accy 86.71:  70%|███████   | 14/20 [11:40<04:39, 46.57s/it]
Task 3, Epoch 15/20 => Loss 0.477, Train_accy 86.71:  75%|███████▌  | 15/20 [11:40<03:52, 46.54s/it]
Task 3, Epoch 16/20 => Loss 0.472, Train_accy 86.84:  75%|███████▌  | 15/20 [12:26<03:52, 46.54s/it]
Task 3, Epoch 16/20 => Loss 0.472, Train_accy 86.84:  80%|████████  | 16/20 [12:26<03:06, 46.59s/it]
Task 3, Epoch 17/20 => Loss 0.475, Train_accy 86.90:  80%|████████  | 16/20 [13:13<03:06, 46.59s/it]
Task 3, Epoch 17/20 => Loss 0.475, Train_accy 86.90:  85%|████████▌ | 17/20 [13:13<02:19, 46.57s/it]
Task 3, Epoch 18/20 => Loss 0.457, Train_accy 87.69:  85%|████████▌ | 17/20 [14:00<02:19, 46.57s/it]
Task 3, Epoch 18/20 => Loss 0.457, Train_accy 87.69:  90%|█████████ | 18/20 [14:00<01:33, 46.71s/it]
Task 3, Epoch 19/20 => Loss 0.457, Train_accy 87.55:  90%|█████████ | 18/20 [14:46<01:33, 46.71s/it]
Task 3, Epoch 19/20 => Loss 0.457, Train_accy 87.55:  95%|█████████▌| 19/20 [14:46<00:46, 46.64s/it]
Task 3, Epoch 20/20 => Loss 0.454, Train_accy 87.92:  95%|█████████▌| 19/20 [15:33<00:46, 46.64s/it]
Task 3, Epoch 20/20 => Loss 0.454, Train_accy 87.92: 100%|██████████| 20/20 [15:33<00:00, 46.71s/it]
Task 3, Epoch 20/20 => Loss 0.454, Train_accy 87.92: 100%|██████████| 20/20 [15:33<00:00, 46.68s/it]
2024-04-24 08:45:05,006 [ease.py] => Task 3, Epoch 20/20 => Loss 0.454, Train_accy 87.92
2024-04-24 08:47:33,959 [ease.py] => Task correct: 71.15705931495405
2024-04-24 08:47:33,960 [ease.py] => Task acc: 89.53634085213032
2024-04-24 08:47:34,002 [trainer.py] => No NME accuracy.
2024-04-24 08:47:34,002 [trainer.py] => CNN: {'total': 69.05, '00-149': 65.63, '150-179': 64.88, '180-209': 83.42, '210-239': 75.96, 'old': 68.06, 'new': 75.96}
2024-04-24 08:47:34,002 [trainer.py] => CNN top1 curve: [79.69, 75.14, 71.09, 69.05]
2024-04-24 08:47:34,002 [trainer.py] => CNN top5 curve: [95.26, 93.37, 91.96, 90.2]

Average Accuracy (CNN): 73.74
2024-04-24 08:47:34,003 [trainer.py] => Average Accuracy (CNN): 73.74 

2024-04-24 08:47:34,003 [trainer.py] => Train Time: 14327.859999999997
2024-04-24 08:47:34,003 [trainer.py] => Test Time: 105.93 

2024-04-24 08:47:34,003 [trainer.py] => All params: 87748610
2024-04-24 08:47:34,004 [trainer.py] => Trainable params: 1189632
2024-04-24 08:47:34,013 [ease.py] => Learning on 240-270

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.011, Train_accy 83.67:   0%|          | 0/20 [00:46<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.011, Train_accy 83.67:   5%|▌         | 1/20 [00:46<14:37, 46.21s/it]
Task 4, Epoch 2/20 => Loss 0.347, Train_accy 91.21:   5%|▌         | 1/20 [01:32<14:37, 46.21s/it]
Task 4, Epoch 2/20 => Loss 0.347, Train_accy 91.21:  10%|█         | 2/20 [01:32<13:47, 46.00s/it]
Task 4, Epoch 3/20 => Loss 0.325, Train_accy 91.91:  10%|█         | 2/20 [02:17<13:47, 46.00s/it]
Task 4, Epoch 3/20 => Loss 0.325, Train_accy 91.91:  15%|█▌        | 3/20 [02:17<13:00, 45.93s/it]
Task 4, Epoch 4/20 => Loss 0.332, Train_accy 91.23:  15%|█▌        | 3/20 [03:03<13:00, 45.93s/it]
Task 4, Epoch 4/20 => Loss 0.332, Train_accy 91.23:  20%|██        | 4/20 [03:03<12:13, 45.84s/it]
Task 4, Epoch 5/20 => Loss 0.317, Train_accy 91.91:  20%|██        | 4/20 [03:49<12:13, 45.84s/it]
Task 4, Epoch 5/20 => Loss 0.317, Train_accy 91.91:  25%|██▌       | 5/20 [03:49<11:27, 45.86s/it]
Task 4, Epoch 6/20 => Loss 0.320, Train_accy 91.97:  25%|██▌       | 5/20 [04:35<11:27, 45.86s/it]
Task 4, Epoch 6/20 => Loss 0.320, Train_accy 91.97:  30%|███       | 6/20 [04:35<10:42, 45.86s/it]
Task 4, Epoch 7/20 => Loss 0.315, Train_accy 91.60:  30%|███       | 6/20 [05:21<10:42, 45.86s/it]
Task 4, Epoch 7/20 => Loss 0.315, Train_accy 91.60:  35%|███▌      | 7/20 [05:21<09:57, 45.99s/it]
Task 4, Epoch 8/20 => Loss 0.319, Train_accy 91.73:  35%|███▌      | 7/20 [06:07<09:57, 45.99s/it]
Task 4, Epoch 8/20 => Loss 0.319, Train_accy 91.73:  40%|████      | 8/20 [06:07<09:11, 45.96s/it]
Task 4, Epoch 9/20 => Loss 0.310, Train_accy 92.20:  40%|████      | 8/20 [06:53<09:11, 45.96s/it]
Task 4, Epoch 9/20 => Loss 0.310, Train_accy 92.20:  45%|████▌     | 9/20 [06:53<08:25, 45.93s/it]
Task 4, Epoch 10/20 => Loss 0.314, Train_accy 92.29:  45%|████▌     | 9/20 [07:39<08:25, 45.93s/it]
Task 4, Epoch 10/20 => Loss 0.314, Train_accy 92.29:  50%|█████     | 10/20 [07:39<07:39, 45.93s/it]
Task 4, Epoch 11/20 => Loss 0.304, Train_accy 92.46:  50%|█████     | 10/20 [08:25<07:39, 45.93s/it]
Task 4, Epoch 11/20 => Loss 0.304, Train_accy 92.46:  55%|█████▌    | 11/20 [08:25<06:53, 45.92s/it]
Task 4, Epoch 12/20 => Loss 0.308, Train_accy 92.15:  55%|█████▌    | 11/20 [09:11<06:53, 45.92s/it]
Task 4, Epoch 12/20 => Loss 0.308, Train_accy 92.15:  60%|██████    | 12/20 [09:11<06:07, 45.95s/it]
Task 4, Epoch 13/20 => Loss 0.292, Train_accy 92.75:  60%|██████    | 12/20 [09:57<06:07, 45.95s/it]
Task 4, Epoch 13/20 => Loss 0.292, Train_accy 92.75:  65%|██████▌   | 13/20 [09:57<05:22, 46.02s/it]
Task 4, Epoch 14/20 => Loss 0.295, Train_accy 92.87:  65%|██████▌   | 13/20 [10:43<05:22, 46.02s/it]
Task 4, Epoch 14/20 => Loss 0.295, Train_accy 92.87:  70%|███████   | 14/20 [10:43<04:36, 46.12s/it]
Task 4, Epoch 15/20 => Loss 0.300, Train_accy 92.50:  70%|███████   | 14/20 [11:29<04:36, 46.12s/it]
Task 4, Epoch 15/20 => Loss 0.300, Train_accy 92.50:  75%|███████▌  | 15/20 [11:29<03:50, 46.03s/it]
Task 4, Epoch 16/20 => Loss 0.295, Train_accy 92.80:  75%|███████▌  | 15/20 [12:15<03:50, 46.03s/it]
Task 4, Epoch 16/20 => Loss 0.295, Train_accy 92.80:  80%|████████  | 16/20 [12:15<03:03, 45.92s/it]
Task 4, Epoch 17/20 => Loss 0.288, Train_accy 93.25:  80%|████████  | 16/20 [13:01<03:03, 45.92s/it]
Task 4, Epoch 17/20 => Loss 0.288, Train_accy 93.25:  85%|████████▌ | 17/20 [13:01<02:18, 46.09s/it]
Task 4, Epoch 18/20 => Loss 0.285, Train_accy 92.98:  85%|████████▌ | 17/20 [13:47<02:18, 46.09s/it]
Task 4, Epoch 18/20 => Loss 0.285, Train_accy 92.98:  90%|█████████ | 18/20 [13:47<01:31, 45.99s/it]
Task 4, Epoch 19/20 => Loss 0.280, Train_accy 93.40:  90%|█████████ | 18/20 [14:33<01:31, 45.99s/it]
Task 4, Epoch 19/20 => Loss 0.280, Train_accy 93.40:  95%|█████████▌| 19/20 [14:33<00:45, 45.94s/it]
Task 4, Epoch 20/20 => Loss 0.284, Train_accy 93.38:  95%|█████████▌| 19/20 [15:18<00:45, 45.94s/it]
Task 4, Epoch 20/20 => Loss 0.284, Train_accy 93.38: 100%|██████████| 20/20 [15:18<00:00, 45.84s/it]
Task 4, Epoch 20/20 => Loss 0.284, Train_accy 93.38: 100%|██████████| 20/20 [15:18<00:00, 45.95s/it]
2024-04-24 09:02:52,963 [ease.py] => Task 4, Epoch 20/20 => Loss 0.284, Train_accy 93.38
2024-04-24 09:06:04,976 [ease.py] => Task correct: 66.56766289214777
2024-04-24 09:06:04,976 [ease.py] => Task acc: 90.0315574531279
2024-04-24 09:06:05,148 [trainer.py] => No NME accuracy.
2024-04-24 09:06:05,148 [trainer.py] => CNN: {'total': 65.14, '00-149': 59.22, '150-179': 56.52, '180-209': 70.18, '210-239': 72.45, '240-269': 90.98, 'old': 61.9, 'new': 90.98}
2024-04-24 09:06:05,148 [trainer.py] => CNN top1 curve: [79.69, 75.14, 71.09, 69.05, 65.14]
2024-04-24 09:06:05,148 [trainer.py] => CNN top5 curve: [95.26, 93.37, 91.96, 90.2, 89.34]

Average Accuracy (CNN): 72.02
2024-04-24 09:06:05,148 [trainer.py] => Average Accuracy (CNN): 72.02 

2024-04-24 09:06:05,148 [trainer.py] => Train Time: 16165.719999999998
2024-04-24 09:06:05,148 [trainer.py] => Test Time: 171.49 

2024-04-24 09:06:05,149 [trainer.py] => All params: 88048130
2024-04-24 09:06:05,150 [trainer.py] => Trainable params: 1189632
2024-04-24 09:06:05,164 [ease.py] => Learning on 270-300

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.037, Train_accy 81.25:   0%|          | 0/20 [00:43<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.037, Train_accy 81.25:   5%|▌         | 1/20 [00:43<13:52, 43.81s/it]
Task 5, Epoch 2/20 => Loss 0.340, Train_accy 90.57:   5%|▌         | 1/20 [01:27<13:52, 43.81s/it]
Task 5, Epoch 2/20 => Loss 0.340, Train_accy 90.57:  10%|█         | 2/20 [01:27<13:10, 43.90s/it]
Task 5, Epoch 3/20 => Loss 0.331, Train_accy 90.72:  10%|█         | 2/20 [02:11<13:10, 43.90s/it]
Task 5, Epoch 3/20 => Loss 0.331, Train_accy 90.72:  15%|█▌        | 3/20 [02:11<12:21, 43.60s/it]
Task 5, Epoch 4/20 => Loss 0.326, Train_accy 90.99:  15%|█▌        | 3/20 [02:54<12:21, 43.60s/it]
Task 5, Epoch 4/20 => Loss 0.326, Train_accy 90.99:  20%|██        | 4/20 [02:54<11:36, 43.53s/it]
Task 5, Epoch 5/20 => Loss 0.324, Train_accy 90.84:  20%|██        | 4/20 [03:37<11:36, 43.53s/it]
Task 5, Epoch 5/20 => Loss 0.324, Train_accy 90.84:  25%|██▌       | 5/20 [03:37<10:52, 43.49s/it]
Task 5, Epoch 6/20 => Loss 0.316, Train_accy 91.16:  25%|██▌       | 5/20 [04:21<10:52, 43.49s/it]
Task 5, Epoch 6/20 => Loss 0.316, Train_accy 91.16:  30%|███       | 6/20 [04:21<10:08, 43.44s/it]
Task 5, Epoch 7/20 => Loss 0.320, Train_accy 91.12:  30%|███       | 6/20 [05:04<10:08, 43.44s/it]
Task 5, Epoch 7/20 => Loss 0.320, Train_accy 91.12:  35%|███▌      | 7/20 [05:04<09:24, 43.44s/it]
Task 5, Epoch 8/20 => Loss 0.314, Train_accy 91.39:  35%|███▌      | 7/20 [05:47<09:24, 43.44s/it]
Task 5, Epoch 8/20 => Loss 0.314, Train_accy 91.39:  40%|████      | 8/20 [05:47<08:40, 43.39s/it]
Task 5, Epoch 9/20 => Loss 0.324, Train_accy 90.65:  40%|████      | 8/20 [06:31<08:40, 43.39s/it]
Task 5, Epoch 9/20 => Loss 0.324, Train_accy 90.65:  45%|████▌     | 9/20 [06:31<07:57, 43.41s/it]
Task 5, Epoch 10/20 => Loss 0.308, Train_accy 91.84:  45%|████▌     | 9/20 [07:14<07:57, 43.41s/it]
Task 5, Epoch 10/20 => Loss 0.308, Train_accy 91.84:  50%|█████     | 10/20 [07:14<07:13, 43.39s/it]
Task 5, Epoch 11/20 => Loss 0.311, Train_accy 91.15:  50%|█████     | 10/20 [07:58<07:13, 43.39s/it]
Task 5, Epoch 11/20 => Loss 0.311, Train_accy 91.15:  55%|█████▌    | 11/20 [07:58<06:31, 43.50s/it]
Task 5, Epoch 12/20 => Loss 0.311, Train_accy 91.25:  55%|█████▌    | 11/20 [08:42<06:31, 43.50s/it]
Task 5, Epoch 12/20 => Loss 0.311, Train_accy 91.25:  60%|██████    | 12/20 [08:42<05:48, 43.52s/it]
Task 5, Epoch 13/20 => Loss 0.306, Train_accy 91.83:  60%|██████    | 12/20 [09:25<05:48, 43.52s/it]
Task 5, Epoch 13/20 => Loss 0.306, Train_accy 91.83:  65%|██████▌   | 13/20 [09:25<05:04, 43.49s/it]
Task 5, Epoch 14/20 => Loss 0.298, Train_accy 91.69:  65%|██████▌   | 13/20 [10:08<05:04, 43.49s/it]
Task 5, Epoch 14/20 => Loss 0.298, Train_accy 91.69:  70%|███████   | 14/20 [10:08<04:20, 43.44s/it]
Task 5, Epoch 15/20 => Loss 0.292, Train_accy 91.96:  70%|███████   | 14/20 [10:52<04:20, 43.44s/it]
Task 5, Epoch 15/20 => Loss 0.292, Train_accy 91.96:  75%|███████▌  | 15/20 [10:52<03:37, 43.47s/it]
Task 5, Epoch 16/20 => Loss 0.290, Train_accy 92.12:  75%|███████▌  | 15/20 [11:35<03:37, 43.47s/it]
Task 5, Epoch 16/20 => Loss 0.290, Train_accy 92.12:  80%|████████  | 16/20 [11:35<02:53, 43.49s/it]
Task 5, Epoch 17/20 => Loss 0.285, Train_accy 92.47:  80%|████████  | 16/20 [12:19<02:53, 43.49s/it]
Task 5, Epoch 17/20 => Loss 0.285, Train_accy 92.47:  85%|████████▌ | 17/20 [12:19<02:10, 43.63s/it]
Task 5, Epoch 18/20 => Loss 0.280, Train_accy 92.82:  85%|████████▌ | 17/20 [13:03<02:10, 43.63s/it]
Task 5, Epoch 18/20 => Loss 0.280, Train_accy 92.82:  90%|█████████ | 18/20 [13:03<01:27, 43.52s/it]
Task 5, Epoch 19/20 => Loss 0.277, Train_accy 92.67:  90%|█████████ | 18/20 [13:46<01:27, 43.52s/it]
Task 5, Epoch 19/20 => Loss 0.277, Train_accy 92.67:  95%|█████████▌| 19/20 [13:46<00:43, 43.42s/it]
Task 5, Epoch 20/20 => Loss 0.272, Train_accy 92.65:  95%|█████████▌| 19/20 [14:29<00:43, 43.42s/it]
Task 5, Epoch 20/20 => Loss 0.272, Train_accy 92.65: 100%|██████████| 20/20 [14:29<00:00, 43.32s/it]
Task 5, Epoch 20/20 => Loss 0.272, Train_accy 92.65: 100%|██████████| 20/20 [14:29<00:00, 43.47s/it]
2024-04-24 09:20:34,518 [ease.py] => Task 5, Epoch 20/20 => Loss 0.272, Train_accy 92.65
2024-04-24 09:24:24,059 [ease.py] => Task correct: 65.74770258980786
2024-04-24 09:24:24,060 [ease.py] => Task acc: 90.42606516290726
2024-04-24 09:24:24,104 [trainer.py] => No NME accuracy.
2024-04-24 09:24:24,104 [trainer.py] => CNN: {'total': 64.51, '00-149': 57.78, '150-179': 50.84, '180-209': 65.49, '210-239': 68.61, '240-269': 84.14, '270-299': 87.12, 'old': 62.0, 'new': 87.12}
2024-04-24 09:24:24,104 [trainer.py] => CNN top1 curve: [79.69, 75.14, 71.09, 69.05, 65.14, 64.51]
2024-04-24 09:24:24,104 [trainer.py] => CNN top5 curve: [95.26, 93.37, 91.96, 90.2, 89.34, 87.4]

Average Accuracy (CNN): 70.77
2024-04-24 09:24:24,104 [trainer.py] => Average Accuracy (CNN): 70.77 

2024-04-24 09:24:24,104 [trainer.py] => Train Time: 17904.39
2024-04-24 09:24:24,104 [trainer.py] => Test Time: 258.36 

Accuracy Matrix (CNN):
[[79.69 74.35 67.97 65.63 59.22 57.78]
 [ 0.   79.1  70.9  64.88 56.52 50.84]
 [ 0.    0.   86.93 83.42 70.18 65.49]
 [ 0.    0.    0.   75.96 72.45 68.61]
 [ 0.    0.    0.    0.   90.98 84.14]
 [ 0.    0.    0.    0.    0.   87.12]]
2024-04-24 09:24:24,105 [trainer.py] => Forgetting (CNN): 17.16

nohup: 忽略输入
2024-04-19 15:41:57,775 [trainer.py] => config: ./exps/finetune_cub_B0.json
2024-04-19 15:41:57,790 [trainer.py] => prefix: reproduce
2024-04-19 15:41:57,791 [trainer.py] => dataset: cub
2024-04-19 15:41:57,791 [trainer.py] => memory_size: 0
2024-04-19 15:41:57,791 [trainer.py] => memory_per_class: 0
2024-04-19 15:41:57,791 [trainer.py] => fixed_memory: False
2024-04-19 15:41:57,791 [trainer.py] => shuffle: True
2024-04-19 15:41:57,791 [trainer.py] => init_cls: 20
2024-04-19 15:41:57,791 [trainer.py] => increment: 20
2024-04-19 15:41:57,791 [trainer.py] => model_name: finetune
2024-04-19 15:41:57,791 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-19 15:41:57,791 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-19 15:41:57,791 [trainer.py] => seed: 1993
2024-04-19 15:41:57,791 [trainer.py] => init_epoch: 20
2024-04-19 15:41:57,792 [trainer.py] => init_lr: 0.001
2024-04-19 15:41:57,792 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-19 15:41:57,792 [trainer.py] => init_lr_decay: 0.1
2024-04-19 15:41:57,792 [trainer.py] => init_weight_decay: 0.0005
2024-04-19 15:41:57,792 [trainer.py] => epochs: 20
2024-04-19 15:41:57,792 [trainer.py] => lrate: 0.001
2024-04-19 15:41:57,792 [trainer.py] => milestones: [40, 70]
2024-04-19 15:41:57,792 [trainer.py] => lrate_decay: 0.1
2024-04-19 15:41:57,792 [trainer.py] => batch_size: 48
2024-04-19 15:41:57,792 [trainer.py] => weight_decay: 0.0002
2024-04-19 15:41:57,876 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-19 15:42:06,013 [trainer.py] => All params: 85798656
2024-04-19 15:42:06,014 [trainer.py] => Trainable params: 85798656
2024-04-19 15:42:06,015 [finetune.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.771, Train_accy 35.41, Test_accy 85.02:   0%|          | 0/20 [00:08<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.771, Train_accy 35.41, Test_accy 85.02:   5%|▌         | 1/20 [00:08<02:43,  8.63s/it]
Task 0, Epoch 2/20 => Loss 0.735, Train_accy 76.32:   5%|▌         | 1/20 [00:15<02:43,  8.63s/it]                 
Task 0, Epoch 2/20 => Loss 0.735, Train_accy 76.32:  10%|█         | 2/20 [00:15<02:16,  7.56s/it]
Task 0, Epoch 3/20 => Loss 0.408, Train_accy 86.79:  10%|█         | 2/20 [00:22<02:16,  7.56s/it]
Task 0, Epoch 3/20 => Loss 0.408, Train_accy 86.79:  15%|█▌        | 3/20 [00:22<02:02,  7.21s/it]
Task 0, Epoch 4/20 => Loss 0.319, Train_accy 89.53:  15%|█▌        | 3/20 [00:29<02:02,  7.21s/it]
Task 0, Epoch 4/20 => Loss 0.319, Train_accy 89.53:  20%|██        | 4/20 [00:29<01:53,  7.07s/it]
Task 0, Epoch 5/20 => Loss 0.310, Train_accy 91.23:  20%|██        | 4/20 [00:36<01:53,  7.07s/it]
Task 0, Epoch 5/20 => Loss 0.310, Train_accy 91.23:  25%|██▌       | 5/20 [00:36<01:45,  7.02s/it]
Task 0, Epoch 6/20 => Loss 0.285, Train_accy 90.80, Test_accy 94.33:  25%|██▌       | 5/20 [00:44<01:45,  7.02s/it]
Task 0, Epoch 6/20 => Loss 0.285, Train_accy 90.80, Test_accy 94.33:  30%|███       | 6/20 [00:44<01:43,  7.43s/it]
Task 0, Epoch 7/20 => Loss 0.255, Train_accy 91.97:  30%|███       | 6/20 [00:51<01:43,  7.43s/it]                 
Task 0, Epoch 7/20 => Loss 0.255, Train_accy 91.97:  35%|███▌      | 7/20 [00:51<01:33,  7.22s/it]
Task 0, Epoch 8/20 => Loss 0.283, Train_accy 92.49:  35%|███▌      | 7/20 [00:57<01:33,  7.22s/it]
Task 0, Epoch 8/20 => Loss 0.283, Train_accy 92.49:  40%|████      | 8/20 [00:57<01:25,  7.10s/it]
Task 0, Epoch 9/20 => Loss 0.212, Train_accy 93.76:  40%|████      | 8/20 [01:04<01:25,  7.10s/it]
Task 0, Epoch 9/20 => Loss 0.212, Train_accy 93.76:  45%|████▌     | 9/20 [01:04<01:17,  7.03s/it]
Task 0, Epoch 10/20 => Loss 0.258, Train_accy 92.07:  45%|████▌     | 9/20 [01:11<01:17,  7.03s/it]
Task 0, Epoch 10/20 => Loss 0.258, Train_accy 92.07:  50%|█████     | 10/20 [01:11<01:09,  6.96s/it]
Task 0, Epoch 11/20 => Loss 0.230, Train_accy 93.34, Test_accy 97.98:  50%|█████     | 10/20 [01:20<01:09,  6.96s/it]
Task 0, Epoch 11/20 => Loss 0.230, Train_accy 93.34, Test_accy 97.98:  55%|█████▌    | 11/20 [01:20<01:06,  7.42s/it]
Task 0, Epoch 12/20 => Loss 0.222, Train_accy 93.23:  55%|█████▌    | 11/20 [01:26<01:06,  7.42s/it]                 
Task 0, Epoch 12/20 => Loss 0.222, Train_accy 93.23:  60%|██████    | 12/20 [01:26<00:57,  7.25s/it]
Task 0, Epoch 13/20 => Loss 0.171, Train_accy 94.40:  60%|██████    | 12/20 [01:33<00:57,  7.25s/it]
Task 0, Epoch 13/20 => Loss 0.171, Train_accy 94.40:  65%|██████▌   | 13/20 [01:33<00:49,  7.09s/it]
Task 0, Epoch 14/20 => Loss 0.179, Train_accy 93.97:  65%|██████▌   | 13/20 [01:40<00:49,  7.09s/it]
Task 0, Epoch 14/20 => Loss 0.179, Train_accy 93.97:  70%|███████   | 14/20 [01:40<00:42,  7.01s/it]
Task 0, Epoch 15/20 => Loss 0.236, Train_accy 92.28:  70%|███████   | 14/20 [01:47<00:42,  7.01s/it]
Task 0, Epoch 15/20 => Loss 0.236, Train_accy 92.28:  75%|███████▌  | 15/20 [01:47<00:34,  6.95s/it]
Task 0, Epoch 16/20 => Loss 0.203, Train_accy 94.50, Test_accy 96.76:  75%|███████▌  | 15/20 [01:55<00:34,  6.95s/it]
Task 0, Epoch 16/20 => Loss 0.203, Train_accy 94.50, Test_accy 96.76:  80%|████████  | 16/20 [01:55<00:29,  7.34s/it]
Task 0, Epoch 17/20 => Loss 0.188, Train_accy 94.40:  80%|████████  | 16/20 [02:02<00:29,  7.34s/it]                 
Task 0, Epoch 17/20 => Loss 0.188, Train_accy 94.40:  85%|████████▌ | 17/20 [02:02<00:21,  7.20s/it]
Task 0, Epoch 18/20 => Loss 0.140, Train_accy 95.77:  85%|████████▌ | 17/20 [02:09<00:21,  7.20s/it]
Task 0, Epoch 18/20 => Loss 0.140, Train_accy 95.77:  90%|█████████ | 18/20 [02:09<00:14,  7.15s/it]
Task 0, Epoch 19/20 => Loss 0.157, Train_accy 95.56:  90%|█████████ | 18/20 [02:16<00:14,  7.15s/it]
Task 0, Epoch 19/20 => Loss 0.157, Train_accy 95.56:  95%|█████████▌| 19/20 [02:16<00:07,  7.08s/it]
Task 0, Epoch 20/20 => Loss 0.167, Train_accy 94.93:  95%|█████████▌| 19/20 [02:23<00:07,  7.08s/it]
Task 0, Epoch 20/20 => Loss 0.167, Train_accy 94.93: 100%|██████████| 20/20 [02:23<00:00,  7.03s/it]
Task 0, Epoch 20/20 => Loss 0.167, Train_accy 94.93: 100%|██████████| 20/20 [02:23<00:00,  7.16s/it]
2024-04-19 15:44:29,796 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.167, Train_accy 94.93
2024-04-19 15:44:31,303 [trainer.py] => No NME accuracy.
2024-04-19 15:44:31,304 [trainer.py] => CNN: {'total': 95.55, '00-19': 95.55, 'old': 0, 'new': 95.55}
2024-04-19 15:44:31,304 [trainer.py] => CNN top1 curve: [95.55]
2024-04-19 15:44:31,304 [trainer.py] => CNN top5 curve: [99.6]

Average Accuracy (CNN): 95.55
2024-04-19 15:44:31,304 [trainer.py] => Average Accuracy (CNN): 95.55 

2024-04-19 15:44:31,304 [trainer.py] => Train Time: 287.01
2024-04-19 15:44:31,304 [trainer.py] => Test Time: 1.51 

2024-04-19 15:44:31,305 [trainer.py] => All params: 85814036
2024-04-19 15:44:31,305 [trainer.py] => Trainable params: 85814036
2024-04-19 15:44:31,307 [finetune.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.049, Train_accy 13.33, Test_accy 70.48:   0%|          | 0/20 [00:08<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.049, Train_accy 13.33, Test_accy 70.48:   5%|▌         | 1/20 [00:08<02:49,  8.94s/it]
Task 1, Epoch 2/20 => Loss 0.438, Train_accy 58.41:   5%|▌         | 1/20 [00:16<02:49,  8.94s/it]                 
Task 1, Epoch 2/20 => Loss 0.438, Train_accy 58.41:  10%|█         | 2/20 [00:16<02:21,  7.87s/it]
Task 1, Epoch 3/20 => Loss 0.312, Train_accy 75.34:  10%|█         | 2/20 [00:23<02:21,  7.87s/it]
Task 1, Epoch 3/20 => Loss 0.312, Train_accy 75.34:  15%|█▌        | 3/20 [00:23<02:06,  7.46s/it]
Task 1, Epoch 4/20 => Loss 0.256, Train_accy 78.84:  15%|█▌        | 3/20 [00:29<02:06,  7.46s/it]
Task 1, Epoch 4/20 => Loss 0.256, Train_accy 78.84:  20%|██        | 4/20 [00:29<01:56,  7.25s/it]
Task 1, Epoch 5/20 => Loss 0.249, Train_accy 82.86:  20%|██        | 4/20 [00:36<01:56,  7.25s/it]
Task 1, Epoch 5/20 => Loss 0.249, Train_accy 82.86:  25%|██▌       | 5/20 [00:36<01:47,  7.16s/it]
Task 1, Epoch 6/20 => Loss 0.211, Train_accy 85.29, Test_accy 90.09:  25%|██▌       | 5/20 [00:45<01:47,  7.16s/it]
Task 1, Epoch 6/20 => Loss 0.211, Train_accy 85.29, Test_accy 90.09:  30%|███       | 6/20 [00:45<01:46,  7.64s/it]
Task 1, Epoch 7/20 => Loss 0.198, Train_accy 87.30:  30%|███       | 6/20 [00:52<01:46,  7.64s/it]                 
Task 1, Epoch 7/20 => Loss 0.198, Train_accy 87.30:  35%|███▌      | 7/20 [00:52<01:35,  7.38s/it]
Task 1, Epoch 8/20 => Loss 0.168, Train_accy 86.14:  35%|███▌      | 7/20 [00:59<01:35,  7.38s/it]
Task 1, Epoch 8/20 => Loss 0.168, Train_accy 86.14:  40%|████      | 8/20 [00:59<01:27,  7.26s/it]
Task 1, Epoch 9/20 => Loss 0.163, Train_accy 89.84:  40%|████      | 8/20 [01:06<01:27,  7.26s/it]
Task 1, Epoch 9/20 => Loss 0.163, Train_accy 89.84:  45%|████▌     | 9/20 [01:06<01:18,  7.16s/it]
Task 1, Epoch 10/20 => Loss 0.154, Train_accy 89.95:  45%|████▌     | 9/20 [01:13<01:18,  7.16s/it]
Task 1, Epoch 10/20 => Loss 0.154, Train_accy 89.95:  50%|█████     | 10/20 [01:13<01:10,  7.06s/it]
Task 1, Epoch 11/20 => Loss 0.185, Train_accy 90.05, Test_accy 89.87:  50%|█████     | 10/20 [01:21<01:10,  7.06s/it]
Task 1, Epoch 11/20 => Loss 0.185, Train_accy 90.05, Test_accy 89.87:  55%|█████▌    | 11/20 [01:21<01:07,  7.54s/it]
Task 1, Epoch 12/20 => Loss 0.138, Train_accy 90.26:  55%|█████▌    | 11/20 [01:28<01:07,  7.54s/it]                 
Task 1, Epoch 12/20 => Loss 0.138, Train_accy 90.26:  60%|██████    | 12/20 [01:28<00:58,  7.36s/it]
Task 1, Epoch 13/20 => Loss 0.160, Train_accy 90.26:  60%|██████    | 12/20 [01:35<00:58,  7.36s/it]
Task 1, Epoch 13/20 => Loss 0.160, Train_accy 90.26:  65%|██████▌   | 13/20 [01:35<00:50,  7.24s/it]
Task 1, Epoch 14/20 => Loss 0.169, Train_accy 89.74:  65%|██████▌   | 13/20 [01:42<00:50,  7.24s/it]
Task 1, Epoch 14/20 => Loss 0.169, Train_accy 89.74:  70%|███████   | 14/20 [01:42<00:42,  7.15s/it]
Task 1, Epoch 15/20 => Loss 0.149, Train_accy 90.90:  70%|███████   | 14/20 [01:49<00:42,  7.15s/it]
Task 1, Epoch 15/20 => Loss 0.149, Train_accy 90.90:  75%|███████▌  | 15/20 [01:49<00:35,  7.07s/it]
Task 1, Epoch 16/20 => Loss 0.168, Train_accy 91.01, Test_accy 92.73:  75%|███████▌  | 15/20 [01:58<00:35,  7.07s/it]
Task 1, Epoch 16/20 => Loss 0.168, Train_accy 91.01, Test_accy 92.73:  80%|████████  | 16/20 [01:58<00:30,  7.54s/it]
Task 1, Epoch 17/20 => Loss 0.147, Train_accy 92.49:  80%|████████  | 16/20 [02:05<00:30,  7.54s/it]                 
Task 1, Epoch 17/20 => Loss 0.147, Train_accy 92.49:  85%|████████▌ | 17/20 [02:05<00:22,  7.37s/it]
Task 1, Epoch 18/20 => Loss 0.154, Train_accy 91.96:  85%|████████▌ | 17/20 [02:11<00:22,  7.37s/it]
Task 1, Epoch 18/20 => Loss 0.154, Train_accy 91.96:  90%|█████████ | 18/20 [02:11<00:14,  7.18s/it]
Task 1, Epoch 19/20 => Loss 0.167, Train_accy 90.90:  90%|█████████ | 18/20 [02:18<00:14,  7.18s/it]
Task 1, Epoch 19/20 => Loss 0.167, Train_accy 90.90:  95%|█████████▌| 19/20 [02:18<00:07,  7.11s/it]
Task 1, Epoch 20/20 => Loss 0.136, Train_accy 89.31:  95%|█████████▌| 19/20 [02:25<00:07,  7.11s/it]
Task 1, Epoch 20/20 => Loss 0.136, Train_accy 89.31: 100%|██████████| 20/20 [02:25<00:00,  7.04s/it]
Task 1, Epoch 20/20 => Loss 0.136, Train_accy 89.31: 100%|██████████| 20/20 [02:25<00:00,  7.28s/it]
2024-04-19 15:46:57,003 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.136, Train_accy 89.31
2024-04-19 15:46:58,839 [trainer.py] => No NME accuracy.
2024-04-19 15:46:58,839 [trainer.py] => CNN: {'total': 91.41, '00-19': 93.12, '20-39': 89.37, 'old': 93.12, 'new': 89.37}
2024-04-19 15:46:58,839 [trainer.py] => CNN top1 curve: [95.55, 91.41]
2024-04-19 15:46:58,839 [trainer.py] => CNN top5 curve: [99.6, 99.34]

Average Accuracy (CNN): 93.48
2024-04-19 15:46:58,839 [trainer.py] => Average Accuracy (CNN): 93.48 

2024-04-19 15:46:58,839 [trainer.py] => Train Time: 432.7
2024-04-19 15:46:58,839 [trainer.py] => Test Time: 3.34 

2024-04-19 15:46:58,840 [trainer.py] => All params: 85829416
2024-04-19 15:46:58,840 [trainer.py] => Trainable params: 85829416
2024-04-19 15:46:58,841 [finetune.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.759, Train_accy 19.94, Test_accy 77.08:   0%|          | 0/20 [00:09<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.759, Train_accy 19.94, Test_accy 77.08:   5%|▌         | 1/20 [00:09<02:58,  9.39s/it]
Task 2, Epoch 2/20 => Loss 0.364, Train_accy 69.67:   5%|▌         | 1/20 [00:16<02:58,  9.39s/it]                 
Task 2, Epoch 2/20 => Loss 0.364, Train_accy 69.67:  10%|█         | 2/20 [00:16<02:22,  7.94s/it]
Task 2, Epoch 3/20 => Loss 0.308, Train_accy 78.37:  10%|█         | 2/20 [00:23<02:22,  7.94s/it]
Task 2, Epoch 3/20 => Loss 0.308, Train_accy 78.37:  15%|█▌        | 3/20 [00:23<02:06,  7.46s/it]
Task 2, Epoch 4/20 => Loss 0.299, Train_accy 79.11:  15%|█▌        | 3/20 [00:30<02:06,  7.46s/it]
Task 2, Epoch 4/20 => Loss 0.299, Train_accy 79.11:  20%|██        | 4/20 [00:30<01:55,  7.23s/it]
Task 2, Epoch 5/20 => Loss 0.265, Train_accy 82.93:  20%|██        | 4/20 [00:37<01:55,  7.23s/it]
Task 2, Epoch 5/20 => Loss 0.265, Train_accy 82.93:  25%|██▌       | 5/20 [00:37<01:47,  7.14s/it]
Task 2, Epoch 6/20 => Loss 0.280, Train_accy 83.56, Test_accy 85.71:  25%|██▌       | 5/20 [00:46<01:47,  7.14s/it]
Task 2, Epoch 6/20 => Loss 0.280, Train_accy 83.56, Test_accy 85.71:  30%|███       | 6/20 [00:46<01:50,  7.88s/it]
Task 2, Epoch 7/20 => Loss 0.204, Train_accy 85.58:  30%|███       | 6/20 [00:53<01:50,  7.88s/it]                 
Task 2, Epoch 7/20 => Loss 0.204, Train_accy 85.58:  35%|███▌      | 7/20 [00:53<01:37,  7.53s/it]
Task 2, Epoch 8/20 => Loss 0.239, Train_accy 85.15:  35%|███▌      | 7/20 [01:00<01:37,  7.53s/it]
Task 2, Epoch 8/20 => Loss 0.239, Train_accy 85.15:  40%|████      | 8/20 [01:00<01:27,  7.33s/it]
Task 2, Epoch 9/20 => Loss 0.202, Train_accy 86.21:  40%|████      | 8/20 [01:07<01:27,  7.33s/it]
Task 2, Epoch 9/20 => Loss 0.202, Train_accy 86.21:  45%|████▌     | 9/20 [01:07<01:19,  7.20s/it]
Task 2, Epoch 10/20 => Loss 0.219, Train_accy 86.53:  45%|████▌     | 9/20 [01:13<01:19,  7.20s/it]
Task 2, Epoch 10/20 => Loss 0.219, Train_accy 86.53:  50%|█████     | 10/20 [01:13<01:10,  7.10s/it]
Task 2, Epoch 11/20 => Loss 0.185, Train_accy 86.64, Test_accy 85.86:  50%|█████     | 10/20 [01:23<01:10,  7.10s/it]
Task 2, Epoch 11/20 => Loss 0.185, Train_accy 86.64, Test_accy 85.86:  55%|█████▌    | 11/20 [01:23<01:09,  7.76s/it]
Task 2, Epoch 12/20 => Loss 0.195, Train_accy 87.91:  55%|█████▌    | 11/20 [01:30<01:09,  7.76s/it]                 
Task 2, Epoch 12/20 => Loss 0.195, Train_accy 87.91:  60%|██████    | 12/20 [01:30<00:59,  7.49s/it]
Task 2, Epoch 13/20 => Loss 0.217, Train_accy 87.06:  60%|██████    | 12/20 [01:36<00:59,  7.49s/it]
Task 2, Epoch 13/20 => Loss 0.217, Train_accy 87.06:  65%|██████▌   | 13/20 [01:36<00:50,  7.28s/it]
Task 2, Epoch 14/20 => Loss 0.205, Train_accy 86.96:  65%|██████▌   | 13/20 [01:43<00:50,  7.28s/it]
Task 2, Epoch 14/20 => Loss 0.205, Train_accy 86.96:  70%|███████   | 14/20 [01:43<00:43,  7.24s/it]
Task 2, Epoch 15/20 => Loss 0.175, Train_accy 90.24:  70%|███████   | 14/20 [01:50<00:43,  7.24s/it]
Task 2, Epoch 15/20 => Loss 0.175, Train_accy 90.24:  75%|███████▌  | 15/20 [01:50<00:35,  7.08s/it]
Task 2, Epoch 16/20 => Loss 0.199, Train_accy 88.34, Test_accy 84.52:  75%|███████▌  | 15/20 [02:00<00:35,  7.08s/it]
Task 2, Epoch 16/20 => Loss 0.199, Train_accy 88.34, Test_accy 84.52:  80%|████████  | 16/20 [02:00<00:31,  7.86s/it]
Task 2, Epoch 17/20 => Loss 0.192, Train_accy 87.80:  80%|████████  | 16/20 [02:07<00:31,  7.86s/it]                 
Task 2, Epoch 17/20 => Loss 0.192, Train_accy 87.80:  85%|████████▌ | 17/20 [02:07<00:22,  7.57s/it]
Task 2, Epoch 18/20 => Loss 0.175, Train_accy 90.88:  85%|████████▌ | 17/20 [02:14<00:22,  7.57s/it]
Task 2, Epoch 18/20 => Loss 0.175, Train_accy 90.88:  90%|█████████ | 18/20 [02:14<00:14,  7.38s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 92.26:  90%|█████████ | 18/20 [02:21<00:14,  7.38s/it]
Task 2, Epoch 19/20 => Loss 0.145, Train_accy 92.26:  95%|█████████▌| 19/20 [02:21<00:07,  7.26s/it]
Task 2, Epoch 20/20 => Loss 0.147, Train_accy 91.09:  95%|█████████▌| 19/20 [02:28<00:07,  7.26s/it]
Task 2, Epoch 20/20 => Loss 0.147, Train_accy 91.09: 100%|██████████| 20/20 [02:28<00:00,  7.17s/it]
Task 2, Epoch 20/20 => Loss 0.147, Train_accy 91.09: 100%|██████████| 20/20 [02:28<00:00,  7.41s/it]
2024-04-19 15:49:26,955 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.147, Train_accy 91.09
2024-04-19 15:49:29,314 [trainer.py] => No NME accuracy.
2024-04-19 15:49:29,314 [trainer.py] => CNN: {'total': 85.27, '00-19': 84.21, '20-39': 76.81, '40-59': 94.5, 'old': 80.84, 'new': 94.5}
2024-04-19 15:49:29,314 [trainer.py] => CNN top1 curve: [95.55, 91.41, 85.27]
2024-04-19 15:49:29,314 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.81]

Average Accuracy (CNN): 90.74
2024-04-19 15:49:29,315 [trainer.py] => Average Accuracy (CNN): 90.74 

2024-04-19 15:49:29,315 [trainer.py] => Train Time: 580.81
2024-04-19 15:49:29,315 [trainer.py] => Test Time: 5.699999999999999 

2024-04-19 15:49:29,315 [trainer.py] => All params: 85844796
2024-04-19 15:49:29,316 [trainer.py] => Trainable params: 85844796
2024-04-19 15:49:29,318 [finetune.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.469, Train_accy 10.36, Test_accy 72.47:   0%|          | 0/20 [00:10<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.469, Train_accy 10.36, Test_accy 72.47:   5%|▌         | 1/20 [00:10<03:11, 10.09s/it]
Task 3, Epoch 2/20 => Loss 0.324, Train_accy 58.35:   5%|▌         | 1/20 [00:16<03:11, 10.09s/it]                 
Task 3, Epoch 2/20 => Loss 0.324, Train_accy 58.35:  10%|█         | 2/20 [00:16<02:27,  8.22s/it]
Task 3, Epoch 3/20 => Loss 0.267, Train_accy 71.46:  10%|█         | 2/20 [00:24<02:27,  8.22s/it]
Task 3, Epoch 3/20 => Loss 0.267, Train_accy 71.46:  15%|█▌        | 3/20 [00:24<02:10,  7.67s/it]
Task 3, Epoch 4/20 => Loss 0.177, Train_accy 76.00:  15%|█▌        | 3/20 [00:31<02:10,  7.67s/it]
Task 3, Epoch 4/20 => Loss 0.177, Train_accy 76.00:  20%|██        | 4/20 [00:31<01:58,  7.42s/it]
Task 3, Epoch 5/20 => Loss 0.201, Train_accy 74.84:  20%|██        | 4/20 [00:38<01:58,  7.42s/it]
Task 3, Epoch 5/20 => Loss 0.201, Train_accy 74.84:  25%|██▌       | 5/20 [00:38<01:48,  7.26s/it]
Task 3, Epoch 6/20 => Loss 0.202, Train_accy 81.61, Test_accy 80.20:  25%|██▌       | 5/20 [00:48<01:48,  7.26s/it]
Task 3, Epoch 6/20 => Loss 0.202, Train_accy 81.61, Test_accy 80.20:  30%|███       | 6/20 [00:48<01:55,  8.24s/it]
Task 3, Epoch 7/20 => Loss 0.207, Train_accy 78.33:  30%|███       | 6/20 [00:55<01:55,  8.24s/it]                 
Task 3, Epoch 7/20 => Loss 0.207, Train_accy 78.33:  35%|███▌      | 7/20 [00:55<01:41,  7.81s/it]
Task 3, Epoch 8/20 => Loss 0.165, Train_accy 80.23:  35%|███▌      | 7/20 [01:01<01:41,  7.81s/it]
Task 3, Epoch 8/20 => Loss 0.165, Train_accy 80.23:  40%|████      | 8/20 [01:01<01:29,  7.49s/it]
Task 3, Epoch 9/20 => Loss 0.196, Train_accy 80.76:  40%|████      | 8/20 [01:08<01:29,  7.49s/it]
Task 3, Epoch 9/20 => Loss 0.196, Train_accy 80.76:  45%|████▌     | 9/20 [01:08<01:20,  7.30s/it]
Task 3, Epoch 10/20 => Loss 0.198, Train_accy 79.60:  45%|████▌     | 9/20 [01:15<01:20,  7.30s/it]
Task 3, Epoch 10/20 => Loss 0.198, Train_accy 79.60:  50%|█████     | 10/20 [01:15<01:12,  7.20s/it]
Task 3, Epoch 11/20 => Loss 0.200, Train_accy 82.03, Test_accy 80.41:  50%|█████     | 10/20 [01:25<01:12,  7.20s/it]
Task 3, Epoch 11/20 => Loss 0.200, Train_accy 82.03, Test_accy 80.41:  55%|█████▌    | 11/20 [01:25<01:12,  8.06s/it]
Task 3, Epoch 12/20 => Loss 0.152, Train_accy 83.83:  55%|█████▌    | 11/20 [01:32<01:12,  8.06s/it]                 
Task 3, Epoch 12/20 => Loss 0.152, Train_accy 83.83:  60%|██████    | 12/20 [01:32<01:01,  7.68s/it]
Task 3, Epoch 13/20 => Loss 0.121, Train_accy 82.98:  60%|██████    | 12/20 [01:39<01:01,  7.68s/it]
Task 3, Epoch 13/20 => Loss 0.121, Train_accy 82.98:  65%|██████▌   | 13/20 [01:39<00:51,  7.43s/it]
Task 3, Epoch 14/20 => Loss 0.156, Train_accy 84.57:  65%|██████▌   | 13/20 [01:46<00:51,  7.43s/it]
Task 3, Epoch 14/20 => Loss 0.156, Train_accy 84.57:  70%|███████   | 14/20 [01:46<00:43,  7.22s/it]
Task 3, Epoch 15/20 => Loss 0.187, Train_accy 83.19:  70%|███████   | 14/20 [01:53<00:43,  7.22s/it]
Task 3, Epoch 15/20 => Loss 0.187, Train_accy 83.19:  75%|███████▌  | 15/20 [01:53<00:35,  7.14s/it]
Task 3, Epoch 16/20 => Loss 0.158, Train_accy 84.36, Test_accy 80.30:  75%|███████▌  | 15/20 [02:03<00:35,  7.14s/it]
Task 3, Epoch 16/20 => Loss 0.158, Train_accy 84.36, Test_accy 80.30:  80%|████████  | 16/20 [02:03<00:31,  7.98s/it]
Task 3, Epoch 17/20 => Loss 0.169, Train_accy 86.79:  80%|████████  | 16/20 [02:09<00:31,  7.98s/it]                 
Task 3, Epoch 17/20 => Loss 0.169, Train_accy 86.79:  85%|████████▌ | 17/20 [02:09<00:22,  7.62s/it]
Task 3, Epoch 18/20 => Loss 0.146, Train_accy 86.89:  85%|████████▌ | 17/20 [02:16<00:22,  7.62s/it]
Task 3, Epoch 18/20 => Loss 0.146, Train_accy 86.89:  90%|█████████ | 18/20 [02:16<00:14,  7.38s/it]
Task 3, Epoch 19/20 => Loss 0.143, Train_accy 87.32:  90%|█████████ | 18/20 [02:23<00:14,  7.38s/it]
Task 3, Epoch 19/20 => Loss 0.143, Train_accy 87.32:  95%|█████████▌| 19/20 [02:23<00:07,  7.24s/it]
Task 3, Epoch 20/20 => Loss 0.149, Train_accy 86.79:  95%|█████████▌| 19/20 [02:30<00:07,  7.24s/it]
Task 3, Epoch 20/20 => Loss 0.149, Train_accy 86.79: 100%|██████████| 20/20 [02:30<00:00,  7.14s/it]
Task 3, Epoch 20/20 => Loss 0.149, Train_accy 86.79: 100%|██████████| 20/20 [02:30<00:00,  7.52s/it]
2024-04-19 15:51:59,786 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.149, Train_accy 86.79
2024-04-19 15:52:02,952 [trainer.py] => No NME accuracy.
2024-04-19 15:52:02,952 [trainer.py] => CNN: {'total': 81.07, '00-19': 78.95, '20-39': 71.98, '40-59': 82.57, '60-79': 89.47, 'old': 77.98, 'new': 89.47}
2024-04-19 15:52:02,953 [trainer.py] => CNN top1 curve: [95.55, 91.41, 85.27, 81.07]
2024-04-19 15:52:02,953 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.81, 97.5]

Average Accuracy (CNN): 88.32
2024-04-19 15:52:02,953 [trainer.py] => Average Accuracy (CNN): 88.32 

2024-04-19 15:52:02,953 [trainer.py] => Train Time: 731.28
2024-04-19 15:52:02,953 [trainer.py] => Test Time: 8.87 

2024-04-19 15:52:02,953 [trainer.py] => All params: 85860176
2024-04-19 15:52:02,954 [trainer.py] => Trainable params: 85860176
2024-04-19 15:52:02,955 [finetune.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.667, Train_accy 14.33, Test_accy 72.05:   0%|          | 0/20 [00:10<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.667, Train_accy 14.33, Test_accy 72.05:   5%|▌         | 1/20 [00:10<03:18, 10.43s/it]
Task 4, Epoch 2/20 => Loss 0.382, Train_accy 64.11:   5%|▌         | 1/20 [00:17<03:18, 10.43s/it]                 
Task 4, Epoch 2/20 => Loss 0.382, Train_accy 64.11:  10%|█         | 2/20 [00:17<02:28,  8.24s/it]
Task 4, Epoch 3/20 => Loss 0.523, Train_accy 72.10:  10%|█         | 2/20 [00:23<02:28,  8.24s/it]
Task 4, Epoch 3/20 => Loss 0.523, Train_accy 72.10:  15%|█▌        | 3/20 [00:23<02:07,  7.48s/it]
Task 4, Epoch 4/20 => Loss 0.520, Train_accy 68.82:  15%|█▌        | 3/20 [00:30<02:07,  7.48s/it]
Task 4, Epoch 4/20 => Loss 0.520, Train_accy 68.82:  20%|██        | 4/20 [00:30<01:55,  7.21s/it]
Task 4, Epoch 5/20 => Loss 0.297, Train_accy 76.37:  20%|██        | 4/20 [00:37<01:55,  7.21s/it]
Task 4, Epoch 5/20 => Loss 0.297, Train_accy 76.37:  25%|██▌       | 5/20 [00:37<01:44,  6.98s/it]
Task 4, Epoch 6/20 => Loss 0.271, Train_accy 77.57, Test_accy 69.87:  25%|██▌       | 5/20 [00:47<01:44,  6.98s/it]
Task 4, Epoch 6/20 => Loss 0.271, Train_accy 77.57, Test_accy 69.87:  30%|███       | 6/20 [00:47<01:54,  8.15s/it]
Task 4, Epoch 7/20 => Loss 0.318, Train_accy 78.34:  30%|███       | 6/20 [00:54<01:54,  8.15s/it]                 
Task 4, Epoch 7/20 => Loss 0.318, Train_accy 78.34:  35%|███▌      | 7/20 [00:54<01:39,  7.68s/it]
Task 4, Epoch 8/20 => Loss 0.488, Train_accy 77.02:  35%|███▌      | 7/20 [01:00<01:39,  7.68s/it]
Task 4, Epoch 8/20 => Loss 0.488, Train_accy 77.02:  40%|████      | 8/20 [01:00<01:27,  7.32s/it]
Task 4, Epoch 9/20 => Loss 0.807, Train_accy 68.05:  40%|████      | 8/20 [01:07<01:27,  7.32s/it]
Task 4, Epoch 9/20 => Loss 0.807, Train_accy 68.05:  45%|████▌     | 9/20 [01:07<01:18,  7.16s/it]
Task 4, Epoch 10/20 => Loss 0.400, Train_accy 73.30:  45%|████▌     | 9/20 [01:14<01:18,  7.16s/it]
Task 4, Epoch 10/20 => Loss 0.400, Train_accy 73.30:  50%|█████     | 10/20 [01:14<01:10,  7.05s/it]
Task 4, Epoch 11/20 => Loss 0.230, Train_accy 81.95, Test_accy 68.94:  50%|█████     | 10/20 [01:24<01:10,  7.05s/it]
Task 4, Epoch 11/20 => Loss 0.230, Train_accy 81.95, Test_accy 68.94:  55%|█████▌    | 11/20 [01:24<01:12,  8.09s/it]
Task 4, Epoch 12/20 => Loss 0.218, Train_accy 83.81:  55%|█████▌    | 11/20 [01:31<01:12,  8.09s/it]                 
Task 4, Epoch 12/20 => Loss 0.218, Train_accy 83.81:  60%|██████    | 12/20 [01:31<01:01,  7.65s/it]
Task 4, Epoch 13/20 => Loss 0.209, Train_accy 85.67:  60%|██████    | 12/20 [01:38<01:01,  7.65s/it]
Task 4, Epoch 13/20 => Loss 0.209, Train_accy 85.67:  65%|██████▌   | 13/20 [01:38<00:51,  7.36s/it]
Task 4, Epoch 14/20 => Loss 0.191, Train_accy 85.23:  65%|██████▌   | 13/20 [01:45<00:51,  7.36s/it]
Task 4, Epoch 14/20 => Loss 0.191, Train_accy 85.23:  70%|███████   | 14/20 [01:45<00:43,  7.22s/it]
Task 4, Epoch 15/20 => Loss 0.159, Train_accy 86.32:  70%|███████   | 14/20 [01:51<00:43,  7.22s/it]
Task 4, Epoch 15/20 => Loss 0.159, Train_accy 86.32:  75%|███████▌  | 15/20 [01:51<00:35,  7.02s/it]
Task 4, Epoch 16/20 => Loss 0.195, Train_accy 86.21, Test_accy 67.76:  75%|███████▌  | 15/20 [02:01<00:35,  7.02s/it]
Task 4, Epoch 16/20 => Loss 0.195, Train_accy 86.21, Test_accy 67.76:  80%|████████  | 16/20 [02:01<00:32,  8.02s/it]
Task 4, Epoch 17/20 => Loss 0.187, Train_accy 87.53:  80%|████████  | 16/20 [02:08<00:32,  8.02s/it]                 
Task 4, Epoch 17/20 => Loss 0.187, Train_accy 87.53:  85%|████████▌ | 17/20 [02:08<00:22,  7.65s/it]
Task 4, Epoch 18/20 => Loss 0.133, Train_accy 87.20:  85%|████████▌ | 17/20 [02:15<00:22,  7.65s/it]
Task 4, Epoch 18/20 => Loss 0.133, Train_accy 87.20:  90%|█████████ | 18/20 [02:15<00:14,  7.41s/it]
Task 4, Epoch 19/20 => Loss 0.161, Train_accy 88.29:  90%|█████████ | 18/20 [02:22<00:14,  7.41s/it]
Task 4, Epoch 19/20 => Loss 0.161, Train_accy 88.29:  95%|█████████▌| 19/20 [02:22<00:07,  7.21s/it]
Task 4, Epoch 20/20 => Loss 0.295, Train_accy 88.07:  95%|█████████▌| 19/20 [02:29<00:07,  7.21s/it]
Task 4, Epoch 20/20 => Loss 0.295, Train_accy 88.07: 100%|██████████| 20/20 [02:29<00:00,  7.07s/it]
Task 4, Epoch 20/20 => Loss 0.295, Train_accy 88.07: 100%|██████████| 20/20 [02:29<00:00,  7.45s/it]
2024-04-19 15:54:32,045 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.295, Train_accy 88.07
2024-04-19 15:54:35,680 [trainer.py] => No NME accuracy.
2024-04-19 15:54:35,680 [trainer.py] => CNN: {'total': 65.66, '00-19': 57.09, '20-39': 53.62, '40-59': 53.67, '60-79': 63.97, '80-99': 94.05, 'old': 57.34, 'new': 94.05}
2024-04-19 15:54:35,680 [trainer.py] => CNN top1 curve: [95.55, 91.41, 85.27, 81.07, 65.66]
2024-04-19 15:54:35,680 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.81, 97.5, 93.35]

Average Accuracy (CNN): 83.79
2024-04-19 15:54:35,680 [trainer.py] => Average Accuracy (CNN): 83.79 

2024-04-19 15:54:35,680 [trainer.py] => Train Time: 880.37
2024-04-19 15:54:35,680 [trainer.py] => Test Time: 12.5 

2024-04-19 15:54:35,681 [trainer.py] => All params: 85875556
2024-04-19 15:54:35,682 [trainer.py] => Trainable params: 85875556
2024-04-19 15:54:35,684 [finetune.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.710, Train_accy 5.67, Test_accy 63.56:   0%|          | 0/20 [00:11<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.710, Train_accy 5.67, Test_accy 63.56:   5%|▌         | 1/20 [00:11<03:36, 11.37s/it]
Task 5, Epoch 2/20 => Loss 0.319, Train_accy 51.58:   5%|▌         | 1/20 [00:18<03:36, 11.37s/it]                
Task 5, Epoch 2/20 => Loss 0.319, Train_accy 51.58:  10%|█         | 2/20 [00:18<02:38,  8.80s/it]
Task 5, Epoch 3/20 => Loss 0.200, Train_accy 70.80:  10%|█         | 2/20 [00:25<02:38,  8.80s/it]
Task 5, Epoch 3/20 => Loss 0.200, Train_accy 70.80:  15%|█▌        | 3/20 [00:25<02:15,  7.99s/it]
Task 5, Epoch 4/20 => Loss 0.187, Train_accy 71.95:  15%|█▌        | 3/20 [00:32<02:15,  7.99s/it]
Task 5, Epoch 4/20 => Loss 0.187, Train_accy 71.95:  20%|██        | 4/20 [00:32<02:01,  7.59s/it]
Task 5, Epoch 5/20 => Loss 0.196, Train_accy 73.74:  20%|██        | 4/20 [00:39<02:01,  7.59s/it]
Task 5, Epoch 5/20 => Loss 0.196, Train_accy 73.74:  25%|██▌       | 5/20 [00:39<01:50,  7.40s/it]
Task 5, Epoch 6/20 => Loss 0.173, Train_accy 73.21, Test_accy 66.53:  25%|██▌       | 5/20 [00:50<01:50,  7.40s/it]
Task 5, Epoch 6/20 => Loss 0.173, Train_accy 73.21, Test_accy 66.53:  30%|███       | 6/20 [00:50<02:01,  8.71s/it]
Task 5, Epoch 7/20 => Loss 0.173, Train_accy 72.58:  30%|███       | 6/20 [00:57<02:01,  8.71s/it]                 
Task 5, Epoch 7/20 => Loss 0.173, Train_accy 72.58:  35%|███▌      | 7/20 [00:57<01:46,  8.16s/it]
Task 5, Epoch 8/20 => Loss 0.145, Train_accy 77.00:  35%|███▌      | 7/20 [01:04<01:46,  8.16s/it]
Task 5, Epoch 8/20 => Loss 0.145, Train_accy 77.00:  40%|████      | 8/20 [01:04<01:33,  7.76s/it]
Task 5, Epoch 9/20 => Loss 0.166, Train_accy 76.05:  40%|████      | 8/20 [01:11<01:33,  7.76s/it]
Task 5, Epoch 9/20 => Loss 0.166, Train_accy 76.05:  45%|████▌     | 9/20 [01:11<01:22,  7.53s/it]
Task 5, Epoch 10/20 => Loss 0.160, Train_accy 79.73:  45%|████▌     | 9/20 [01:18<01:22,  7.53s/it]
Task 5, Epoch 10/20 => Loss 0.160, Train_accy 79.73:  50%|█████     | 10/20 [01:18<01:13,  7.35s/it]
Task 5, Epoch 11/20 => Loss 0.170, Train_accy 77.63, Test_accy 66.53:  50%|█████     | 10/20 [01:29<01:13,  7.35s/it]
Task 5, Epoch 11/20 => Loss 0.170, Train_accy 77.63, Test_accy 66.53:  55%|█████▌    | 11/20 [01:29<01:17,  8.59s/it]
Task 5, Epoch 12/20 => Loss 0.124, Train_accy 82.14:  55%|█████▌    | 11/20 [01:37<01:17,  8.59s/it]                 
Task 5, Epoch 12/20 => Loss 0.124, Train_accy 82.14:  60%|██████    | 12/20 [01:37<01:05,  8.15s/it]
Task 5, Epoch 13/20 => Loss 0.147, Train_accy 80.25:  60%|██████    | 12/20 [01:44<01:05,  8.15s/it]
Task 5, Epoch 13/20 => Loss 0.147, Train_accy 80.25:  65%|██████▌   | 13/20 [01:44<00:54,  7.78s/it]
Task 5, Epoch 14/20 => Loss 0.177, Train_accy 79.62:  65%|██████▌   | 13/20 [01:50<00:54,  7.78s/it]
Task 5, Epoch 14/20 => Loss 0.177, Train_accy 79.62:  70%|███████   | 14/20 [01:50<00:45,  7.52s/it]
Task 5, Epoch 15/20 => Loss 0.187, Train_accy 79.20:  70%|███████   | 14/20 [01:57<00:45,  7.52s/it]
Task 5, Epoch 15/20 => Loss 0.187, Train_accy 79.20:  75%|███████▌  | 15/20 [01:57<00:36,  7.35s/it]
Task 5, Epoch 16/20 => Loss 0.157, Train_accy 81.30, Test_accy 66.17:  75%|███████▌  | 15/20 [02:09<00:36,  7.35s/it]
Task 5, Epoch 16/20 => Loss 0.157, Train_accy 81.30, Test_accy 66.17:  80%|████████  | 16/20 [02:09<00:34,  8.62s/it]
Task 5, Epoch 17/20 => Loss 0.163, Train_accy 82.77:  80%|████████  | 16/20 [02:16<00:34,  8.62s/it]                 
Task 5, Epoch 17/20 => Loss 0.163, Train_accy 82.77:  85%|████████▌ | 17/20 [02:16<00:24,  8.12s/it]
Task 5, Epoch 18/20 => Loss 0.135, Train_accy 84.35:  85%|████████▌ | 17/20 [02:23<00:24,  8.12s/it]
Task 5, Epoch 18/20 => Loss 0.135, Train_accy 84.35:  90%|█████████ | 18/20 [02:23<00:15,  7.79s/it]
Task 5, Epoch 19/20 => Loss 0.169, Train_accy 81.72:  90%|█████████ | 18/20 [02:30<00:15,  7.79s/it]
Task 5, Epoch 19/20 => Loss 0.169, Train_accy 81.72:  95%|█████████▌| 19/20 [02:30<00:07,  7.55s/it]
Task 5, Epoch 20/20 => Loss 0.157, Train_accy 82.35:  95%|█████████▌| 19/20 [02:37<00:07,  7.55s/it]
Task 5, Epoch 20/20 => Loss 0.157, Train_accy 82.35: 100%|██████████| 20/20 [02:37<00:00,  7.37s/it]
Task 5, Epoch 20/20 => Loss 0.157, Train_accy 82.35: 100%|██████████| 20/20 [02:37<00:00,  7.87s/it]
2024-04-19 15:57:13,099 [finetune.py] => Task 5, Epoch 20/20 => Loss 0.157, Train_accy 82.35
2024-04-19 15:57:17,415 [trainer.py] => No NME accuracy.
2024-04-19 15:57:17,415 [trainer.py] => CNN: {'total': 64.83, '00-19': 50.61, '20-39': 43.0, '40-59': 52.75, '60-79': 59.92, '80-99': 89.22, '100-119': 88.16, 'old': 60.35, 'new': 88.16}
2024-04-19 15:57:17,415 [trainer.py] => CNN top1 curve: [95.55, 91.41, 85.27, 81.07, 65.66, 64.83]
2024-04-19 15:57:17,415 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.81, 97.5, 93.35, 93.15]

Average Accuracy (CNN): 80.63
2024-04-19 15:57:17,415 [trainer.py] => Average Accuracy (CNN): 80.63 

2024-04-19 15:57:17,416 [trainer.py] => Train Time: 1037.78
2024-04-19 15:57:17,416 [trainer.py] => Test Time: 16.81 

2024-04-19 15:57:17,417 [trainer.py] => All params: 85890936
2024-04-19 15:57:17,418 [trainer.py] => Trainable params: 85890936
2024-04-19 15:57:17,422 [finetune.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.623, Train_accy 5.56, Test_accy 60.94:   0%|          | 0/20 [00:11<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.623, Train_accy 5.56, Test_accy 60.94:   5%|▌         | 1/20 [00:11<03:43, 11.79s/it]
Task 6, Epoch 2/20 => Loss 0.499, Train_accy 48.32:   5%|▌         | 1/20 [00:18<03:43, 11.79s/it]                
Task 6, Epoch 2/20 => Loss 0.499, Train_accy 48.32:  10%|█         | 2/20 [00:18<02:40,  8.91s/it]
Task 6, Epoch 3/20 => Loss 0.360, Train_accy 66.46:  10%|█         | 2/20 [00:25<02:40,  8.91s/it]
Task 6, Epoch 3/20 => Loss 0.360, Train_accy 66.46:  15%|█▌        | 3/20 [00:25<02:17,  8.07s/it]
Task 6, Epoch 4/20 => Loss 0.316, Train_accy 74.21:  15%|█▌        | 3/20 [00:32<02:17,  8.07s/it]
Task 6, Epoch 4/20 => Loss 0.316, Train_accy 74.21:  20%|██        | 4/20 [00:32<02:03,  7.69s/it]
Task 6, Epoch 5/20 => Loss 0.327, Train_accy 74.00:  20%|██        | 4/20 [00:39<02:03,  7.69s/it]
Task 6, Epoch 5/20 => Loss 0.327, Train_accy 74.00:  25%|██▌       | 5/20 [00:39<01:51,  7.44s/it]
Task 6, Epoch 6/20 => Loss 0.228, Train_accy 80.40, Test_accy 65.39:  25%|██▌       | 5/20 [00:51<01:51,  7.44s/it]
Task 6, Epoch 6/20 => Loss 0.228, Train_accy 80.40, Test_accy 65.39:  30%|███       | 6/20 [00:51<02:05,  8.97s/it]
Task 6, Epoch 7/20 => Loss 0.285, Train_accy 77.67:  30%|███       | 6/20 [00:58<02:05,  8.97s/it]                 
Task 6, Epoch 7/20 => Loss 0.285, Train_accy 77.67:  35%|███▌      | 7/20 [00:58<01:48,  8.36s/it]
Task 6, Epoch 8/20 => Loss 0.274, Train_accy 76.62:  35%|███▌      | 7/20 [01:05<01:48,  8.36s/it]
Task 6, Epoch 8/20 => Loss 0.274, Train_accy 76.62:  40%|████      | 8/20 [01:05<01:34,  7.89s/it]
Task 6, Epoch 9/20 => Loss 0.356, Train_accy 76.52:  40%|████      | 8/20 [01:12<01:34,  7.89s/it]
Task 6, Epoch 9/20 => Loss 0.356, Train_accy 76.52:  45%|████▌     | 9/20 [01:12<01:23,  7.63s/it]
Task 6, Epoch 10/20 => Loss 0.252, Train_accy 81.13:  45%|████▌     | 9/20 [01:19<01:23,  7.63s/it]
Task 6, Epoch 10/20 => Loss 0.252, Train_accy 81.13:  50%|█████     | 10/20 [01:19<01:14,  7.43s/it]
Task 6, Epoch 11/20 => Loss 0.207, Train_accy 83.44, Test_accy 65.69:  50%|█████     | 10/20 [01:31<01:14,  7.43s/it]
Task 6, Epoch 11/20 => Loss 0.207, Train_accy 83.44, Test_accy 65.69:  55%|█████▌    | 11/20 [01:31<01:19,  8.80s/it]
Task 6, Epoch 12/20 => Loss 0.161, Train_accy 86.58:  55%|█████▌    | 11/20 [01:38<01:19,  8.80s/it]                 
Task 6, Epoch 12/20 => Loss 0.161, Train_accy 86.58:  60%|██████    | 12/20 [01:38<01:05,  8.24s/it]
Task 6, Epoch 13/20 => Loss 0.154, Train_accy 84.49:  60%|██████    | 12/20 [01:45<01:05,  8.24s/it]
Task 6, Epoch 13/20 => Loss 0.154, Train_accy 84.49:  65%|██████▌   | 13/20 [01:45<00:54,  7.85s/it]
Task 6, Epoch 14/20 => Loss 0.213, Train_accy 83.23:  65%|██████▌   | 13/20 [01:52<00:54,  7.85s/it]
Task 6, Epoch 14/20 => Loss 0.213, Train_accy 83.23:  70%|███████   | 14/20 [01:52<00:45,  7.54s/it]
Task 6, Epoch 15/20 => Loss 0.258, Train_accy 83.33:  70%|███████   | 14/20 [01:59<00:45,  7.54s/it]
Task 6, Epoch 15/20 => Loss 0.258, Train_accy 83.33:  75%|███████▌  | 15/20 [01:59<00:36,  7.35s/it]
Task 6, Epoch 16/20 => Loss 0.183, Train_accy 84.49, Test_accy 66.36:  75%|███████▌  | 15/20 [02:11<00:36,  7.35s/it]
Task 6, Epoch 16/20 => Loss 0.183, Train_accy 84.49, Test_accy 66.36:  80%|████████  | 16/20 [02:11<00:35,  8.84s/it]
Task 6, Epoch 17/20 => Loss 0.205, Train_accy 83.44:  80%|████████  | 16/20 [02:18<00:35,  8.84s/it]                 
Task 6, Epoch 17/20 => Loss 0.205, Train_accy 83.44:  85%|████████▌ | 17/20 [02:18<00:24,  8.29s/it]
Task 6, Epoch 18/20 => Loss 0.174, Train_accy 84.80:  85%|████████▌ | 17/20 [02:25<00:24,  8.29s/it]
Task 6, Epoch 18/20 => Loss 0.174, Train_accy 84.80:  90%|█████████ | 18/20 [02:25<00:15,  7.89s/it]
Task 6, Epoch 19/20 => Loss 0.182, Train_accy 84.80:  90%|█████████ | 18/20 [02:32<00:15,  7.89s/it]
Task 6, Epoch 19/20 => Loss 0.182, Train_accy 84.80:  95%|█████████▌| 19/20 [02:32<00:07,  7.65s/it]
Task 6, Epoch 20/20 => Loss 0.191, Train_accy 84.07:  95%|█████████▌| 19/20 [02:39<00:07,  7.65s/it]
Task 6, Epoch 20/20 => Loss 0.191, Train_accy 84.07: 100%|██████████| 20/20 [02:39<00:00,  7.42s/it]
Task 6, Epoch 20/20 => Loss 0.191, Train_accy 84.07: 100%|██████████| 20/20 [02:39<00:00,  7.98s/it]
2024-04-19 15:59:57,068 [finetune.py] => Task 6, Epoch 20/20 => Loss 0.191, Train_accy 84.07
2024-04-19 16:00:02,135 [trainer.py] => No NME accuracy.
2024-04-19 16:00:02,136 [trainer.py] => CNN: {'total': 65.33, '00-19': 49.8, '20-39': 39.61, '40-59': 57.34, '60-79': 58.7, '80-99': 84.39, '100-119': 77.19, '120-139': 86.22, 'old': 62.01, 'new': 86.22}
2024-04-19 16:00:02,136 [trainer.py] => CNN top1 curve: [95.55, 91.41, 85.27, 81.07, 65.66, 64.83, 65.33]
2024-04-19 16:00:02,136 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.81, 97.5, 93.35, 93.15, 94.03]

Average Accuracy (CNN): 78.45
2024-04-19 16:00:02,136 [trainer.py] => Average Accuracy (CNN): 78.45 

2024-04-19 16:00:02,136 [trainer.py] => Train Time: 1197.42
2024-04-19 16:00:02,136 [trainer.py] => Test Time: 21.88 

2024-04-19 16:00:02,137 [trainer.py] => All params: 85906316
2024-04-19 16:00:02,138 [trainer.py] => Trainable params: 85906316
2024-04-19 16:00:02,140 [finetune.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.598, Train_accy 5.76, Test_accy 57.96:   0%|          | 0/20 [00:12<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.598, Train_accy 5.76, Test_accy 57.96:   5%|▌         | 1/20 [00:12<03:56, 12.46s/it]
Task 7, Epoch 2/20 => Loss 0.414, Train_accy 48.04:   5%|▌         | 1/20 [00:19<03:56, 12.46s/it]                
Task 7, Epoch 2/20 => Loss 0.414, Train_accy 48.04:  10%|█         | 2/20 [00:19<02:45,  9.20s/it]
Task 7, Epoch 3/20 => Loss 0.342, Train_accy 57.07:  10%|█         | 2/20 [00:26<02:45,  9.20s/it]
Task 7, Epoch 3/20 => Loss 0.342, Train_accy 57.07:  15%|█▌        | 3/20 [00:26<02:17,  8.07s/it]
Task 7, Epoch 4/20 => Loss 0.316, Train_accy 63.70:  15%|█▌        | 3/20 [00:32<02:17,  8.07s/it]
Task 7, Epoch 4/20 => Loss 0.316, Train_accy 63.70:  20%|██        | 4/20 [00:32<02:01,  7.57s/it]
Task 7, Epoch 5/20 => Loss 0.231, Train_accy 66.96:  20%|██        | 4/20 [00:39<02:01,  7.57s/it]
Task 7, Epoch 5/20 => Loss 0.231, Train_accy 66.96:  25%|██▌       | 5/20 [00:39<01:48,  7.25s/it]
Task 7, Epoch 6/20 => Loss 0.202, Train_accy 72.61, Test_accy 66.10:  25%|██▌       | 5/20 [00:51<01:48,  7.25s/it]
Task 7, Epoch 6/20 => Loss 0.202, Train_accy 72.61, Test_accy 66.10:  30%|███       | 6/20 [00:51<02:05,  8.99s/it]
Task 7, Epoch 7/20 => Loss 0.218, Train_accy 75.43:  30%|███       | 6/20 [00:58<02:05,  8.99s/it]                 
Task 7, Epoch 7/20 => Loss 0.218, Train_accy 75.43:  35%|███▌      | 7/20 [00:58<01:46,  8.22s/it]
Task 7, Epoch 8/20 => Loss 0.184, Train_accy 76.74:  35%|███▌      | 7/20 [01:05<01:46,  8.22s/it]
Task 7, Epoch 8/20 => Loss 0.184, Train_accy 76.74:  40%|████      | 8/20 [01:05<01:33,  7.79s/it]
Task 7, Epoch 9/20 => Loss 0.205, Train_accy 75.00:  40%|████      | 8/20 [01:12<01:33,  7.79s/it]
Task 7, Epoch 9/20 => Loss 0.205, Train_accy 75.00:  45%|████▌     | 9/20 [01:12<01:21,  7.45s/it]
Task 7, Epoch 10/20 => Loss 0.215, Train_accy 79.67:  45%|████▌     | 9/20 [01:18<01:21,  7.45s/it]
Task 7, Epoch 10/20 => Loss 0.215, Train_accy 79.67:  50%|█████     | 10/20 [01:18<01:12,  7.21s/it]
Task 7, Epoch 11/20 => Loss 0.228, Train_accy 76.52, Test_accy 65.89:  50%|█████     | 10/20 [01:30<01:12,  7.21s/it]
Task 7, Epoch 11/20 => Loss 0.228, Train_accy 76.52, Test_accy 65.89:  55%|█████▌    | 11/20 [01:30<01:18,  8.70s/it]
Task 7, Epoch 12/20 => Loss 0.162, Train_accy 78.26:  55%|█████▌    | 11/20 [01:37<01:18,  8.70s/it]                 
Task 7, Epoch 12/20 => Loss 0.162, Train_accy 78.26:  60%|██████    | 12/20 [01:37<01:05,  8.15s/it]
Task 7, Epoch 13/20 => Loss 0.211, Train_accy 80.54:  60%|██████    | 12/20 [01:44<01:05,  8.15s/it]
Task 7, Epoch 13/20 => Loss 0.211, Train_accy 80.54:  65%|██████▌   | 13/20 [01:44<00:53,  7.68s/it]
Task 7, Epoch 14/20 => Loss 0.185, Train_accy 81.63:  65%|██████▌   | 13/20 [01:51<00:53,  7.68s/it]
Task 7, Epoch 14/20 => Loss 0.185, Train_accy 81.63:  70%|███████   | 14/20 [01:51<00:44,  7.38s/it]
Task 7, Epoch 15/20 => Loss 0.174, Train_accy 80.11:  70%|███████   | 14/20 [01:57<00:44,  7.38s/it]
Task 7, Epoch 15/20 => Loss 0.174, Train_accy 80.11:  75%|███████▌  | 15/20 [01:57<00:35,  7.19s/it]
Task 7, Epoch 16/20 => Loss 0.180, Train_accy 79.57, Test_accy 66.63:  75%|███████▌  | 15/20 [02:10<00:35,  7.19s/it]
Task 7, Epoch 16/20 => Loss 0.180, Train_accy 79.57, Test_accy 66.63:  80%|████████  | 16/20 [02:10<00:34,  8.72s/it]
Task 7, Epoch 17/20 => Loss 0.254, Train_accy 78.15:  80%|████████  | 16/20 [02:16<00:34,  8.72s/it]                 
Task 7, Epoch 17/20 => Loss 0.254, Train_accy 78.15:  85%|████████▌ | 17/20 [02:16<00:24,  8.11s/it]
Task 7, Epoch 18/20 => Loss 0.223, Train_accy 81.30:  85%|████████▌ | 17/20 [02:23<00:24,  8.11s/it]
Task 7, Epoch 18/20 => Loss 0.223, Train_accy 81.30:  90%|█████████ | 18/20 [02:23<00:15,  7.70s/it]
Task 7, Epoch 19/20 => Loss 0.196, Train_accy 79.89:  90%|█████████ | 18/20 [02:30<00:15,  7.70s/it]
Task 7, Epoch 19/20 => Loss 0.196, Train_accy 79.89:  95%|█████████▌| 19/20 [02:30<00:07,  7.39s/it]
Task 7, Epoch 20/20 => Loss 0.126, Train_accy 83.26:  95%|█████████▌| 19/20 [02:37<00:07,  7.39s/it]
Task 7, Epoch 20/20 => Loss 0.126, Train_accy 83.26: 100%|██████████| 20/20 [02:37<00:00,  7.22s/it]
Task 7, Epoch 20/20 => Loss 0.126, Train_accy 83.26: 100%|██████████| 20/20 [02:37<00:00,  7.85s/it]
2024-04-19 16:02:39,197 [finetune.py] => Task 7, Epoch 20/20 => Loss 0.126, Train_accy 83.26
2024-04-19 16:02:44,796 [trainer.py] => No NME accuracy.
2024-04-19 16:02:44,796 [trainer.py] => CNN: {'total': 65.68, '00-19': 48.99, '20-39': 37.68, '40-59': 58.26, '60-79': 58.3, '80-99': 78.07, '100-119': 71.49, '120-139': 80.89, '140-159': 86.8, 'old': 62.46, 'new': 86.8}
2024-04-19 16:02:44,797 [trainer.py] => CNN top1 curve: [95.55, 91.41, 85.27, 81.07, 65.66, 64.83, 65.33, 65.68]
2024-04-19 16:02:44,797 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.81, 97.5, 93.35, 93.15, 94.03, 94.34]

Average Accuracy (CNN): 76.85
2024-04-19 16:02:44,797 [trainer.py] => Average Accuracy (CNN): 76.85 

2024-04-19 16:02:44,797 [trainer.py] => Train Time: 1354.47
2024-04-19 16:02:44,797 [trainer.py] => Test Time: 27.479999999999997 

2024-04-19 16:02:44,798 [trainer.py] => All params: 85921696
2024-04-19 16:02:44,798 [trainer.py] => Trainable params: 85921696
2024-04-19 16:02:44,801 [finetune.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.755, Train_accy 5.53, Test_accy 57.66:   0%|          | 0/20 [00:13<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.755, Train_accy 5.53, Test_accy 57.66:   5%|▌         | 1/20 [00:13<04:07, 13.05s/it]
Task 8, Epoch 2/20 => Loss 0.404, Train_accy 50.63:   5%|▌         | 1/20 [00:20<04:07, 13.05s/it]                
Task 8, Epoch 2/20 => Loss 0.404, Train_accy 50.63:  10%|█         | 2/20 [00:20<02:50,  9.50s/it]
Task 8, Epoch 3/20 => Loss 0.315, Train_accy 67.85:  10%|█         | 2/20 [00:26<02:50,  9.50s/it]
Task 8, Epoch 3/20 => Loss 0.315, Train_accy 67.85:  15%|█▌        | 3/20 [00:26<02:21,  8.31s/it]
Task 8, Epoch 4/20 => Loss 0.236, Train_accy 72.86:  15%|█▌        | 3/20 [00:33<02:21,  8.31s/it]
Task 8, Epoch 4/20 => Loss 0.236, Train_accy 72.86:  20%|██        | 4/20 [00:33<02:04,  7.80s/it]
Task 8, Epoch 5/20 => Loss 0.268, Train_accy 72.03:  20%|██        | 4/20 [00:41<02:04,  7.80s/it]
Task 8, Epoch 5/20 => Loss 0.268, Train_accy 72.03:  25%|██▌       | 5/20 [00:41<01:52,  7.52s/it]
Task 8, Epoch 6/20 => Loss 0.214, Train_accy 75.05, Test_accy 63.86:  25%|██▌       | 5/20 [00:54<01:52,  7.52s/it]
Task 8, Epoch 6/20 => Loss 0.214, Train_accy 75.05, Test_accy 63.86:  30%|███       | 6/20 [00:54<02:12,  9.48s/it]
Task 8, Epoch 7/20 => Loss 0.196, Train_accy 75.37:  30%|███       | 6/20 [01:01<02:12,  9.48s/it]                 
Task 8, Epoch 7/20 => Loss 0.196, Train_accy 75.37:  35%|███▌      | 7/20 [01:01<01:52,  8.65s/it]
Task 8, Epoch 8/20 => Loss 0.192, Train_accy 81.11:  35%|███▌      | 7/20 [01:08<01:52,  8.65s/it]
Task 8, Epoch 8/20 => Loss 0.192, Train_accy 81.11:  40%|████      | 8/20 [01:08<01:37,  8.10s/it]
Task 8, Epoch 9/20 => Loss 0.219, Train_accy 80.90:  40%|████      | 8/20 [01:15<01:37,  8.10s/it]
Task 8, Epoch 9/20 => Loss 0.219, Train_accy 80.90:  45%|████▌     | 9/20 [01:15<01:25,  7.76s/it]
Task 8, Epoch 10/20 => Loss 0.177, Train_accy 77.97:  45%|████▌     | 9/20 [01:22<01:25,  7.76s/it]
Task 8, Epoch 10/20 => Loss 0.177, Train_accy 77.97:  50%|█████     | 10/20 [01:22<01:15,  7.53s/it]
Task 8, Epoch 11/20 => Loss 0.231, Train_accy 80.06, Test_accy 63.72:  50%|█████     | 10/20 [01:35<01:15,  7.53s/it]
Task 8, Epoch 11/20 => Loss 0.231, Train_accy 80.06, Test_accy 63.72:  55%|█████▌    | 11/20 [01:35<01:23,  9.28s/it]
Task 8, Epoch 12/20 => Loss 0.154, Train_accy 83.51:  55%|█████▌    | 11/20 [01:42<01:23,  9.28s/it]                 
Task 8, Epoch 12/20 => Loss 0.154, Train_accy 83.51:  60%|██████    | 12/20 [01:42<01:08,  8.53s/it]
Task 8, Epoch 13/20 => Loss 0.183, Train_accy 82.36:  60%|██████    | 12/20 [01:49<01:08,  8.53s/it]
Task 8, Epoch 13/20 => Loss 0.183, Train_accy 82.36:  65%|██████▌   | 13/20 [01:49<00:56,  8.06s/it]
Task 8, Epoch 14/20 => Loss 0.179, Train_accy 82.67:  65%|██████▌   | 13/20 [01:56<00:56,  8.06s/it]
Task 8, Epoch 14/20 => Loss 0.179, Train_accy 82.67:  70%|███████   | 14/20 [01:56<00:46,  7.75s/it]
Task 8, Epoch 15/20 => Loss 0.198, Train_accy 81.00:  70%|███████   | 14/20 [02:03<00:46,  7.75s/it]
Task 8, Epoch 15/20 => Loss 0.198, Train_accy 81.00:  75%|███████▌  | 15/20 [02:03<00:37,  7.56s/it]
Task 8, Epoch 16/20 => Loss 0.181, Train_accy 82.88, Test_accy 62.88:  75%|███████▌  | 15/20 [02:16<00:37,  7.56s/it]
Task 8, Epoch 16/20 => Loss 0.181, Train_accy 82.88, Test_accy 62.88:  80%|████████  | 16/20 [02:16<00:37,  9.32s/it]
Task 8, Epoch 17/20 => Loss 0.173, Train_accy 84.97:  80%|████████  | 16/20 [02:23<00:37,  9.32s/it]                 
Task 8, Epoch 17/20 => Loss 0.173, Train_accy 84.97:  85%|████████▌ | 17/20 [02:23<00:25,  8.61s/it]
Task 8, Epoch 18/20 => Loss 0.209, Train_accy 83.92:  85%|████████▌ | 17/20 [02:30<00:25,  8.61s/it]
Task 8, Epoch 18/20 => Loss 0.209, Train_accy 83.92:  90%|█████████ | 18/20 [02:30<00:16,  8.10s/it]
Task 8, Epoch 19/20 => Loss 0.157, Train_accy 86.43:  90%|█████████ | 18/20 [02:37<00:16,  8.10s/it]
Task 8, Epoch 19/20 => Loss 0.157, Train_accy 86.43:  95%|█████████▌| 19/20 [02:37<00:07,  7.77s/it]
Task 8, Epoch 20/20 => Loss 0.135, Train_accy 86.43:  95%|█████████▌| 19/20 [02:44<00:07,  7.77s/it]
Task 8, Epoch 20/20 => Loss 0.135, Train_accy 86.43: 100%|██████████| 20/20 [02:44<00:00,  7.55s/it]
Task 8, Epoch 20/20 => Loss 0.135, Train_accy 86.43: 100%|██████████| 20/20 [02:44<00:00,  8.24s/it]
2024-04-19 16:05:29,512 [finetune.py] => Task 8, Epoch 20/20 => Loss 0.135, Train_accy 86.43
2024-04-19 16:05:35,779 [trainer.py] => No NME accuracy.
2024-04-19 16:05:35,779 [trainer.py] => CNN: {'total': 62.64, '00-19': 47.37, '20-39': 32.37, '40-59': 49.54, '60-79': 50.61, '80-99': 71.75, '100-119': 64.91, '120-139': 71.56, '140-159': 76.8, '160-179': 93.67, 'old': 58.75, 'new': 93.67}
2024-04-19 16:05:35,779 [trainer.py] => CNN top1 curve: [95.55, 91.41, 85.27, 81.07, 65.66, 64.83, 65.33, 65.68, 62.64]
2024-04-19 16:05:35,779 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.81, 97.5, 93.35, 93.15, 94.03, 94.34, 92.43]

Average Accuracy (CNN): 75.27
2024-04-19 16:05:35,779 [trainer.py] => Average Accuracy (CNN): 75.27 

2024-04-19 16:05:35,779 [trainer.py] => Train Time: 1519.18
2024-04-19 16:05:35,779 [trainer.py] => Test Time: 33.75 

2024-04-19 16:05:35,780 [trainer.py] => All params: 85937076
2024-04-19 16:05:35,781 [trainer.py] => Trainable params: 85937076
2024-04-19 16:05:35,784 [finetune.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.484, Train_accy 5.78, Test_accy 55.94:   0%|          | 0/20 [00:13<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.484, Train_accy 5.78, Test_accy 55.94:   5%|▌         | 1/20 [00:13<04:25, 13.97s/it]
Task 9, Epoch 2/20 => Loss 0.361, Train_accy 54.83:   5%|▌         | 1/20 [00:20<04:25, 13.97s/it]                
Task 9, Epoch 2/20 => Loss 0.361, Train_accy 54.83:  10%|█         | 2/20 [00:20<02:57,  9.87s/it]
Task 9, Epoch 3/20 => Loss 0.289, Train_accy 66.70:  10%|█         | 2/20 [00:28<02:57,  9.87s/it]
Task 9, Epoch 3/20 => Loss 0.289, Train_accy 66.70:  15%|█▌        | 3/20 [00:28<02:25,  8.58s/it]
Task 9, Epoch 4/20 => Loss 0.239, Train_accy 74.05:  15%|█▌        | 3/20 [00:35<02:25,  8.58s/it]
Task 9, Epoch 4/20 => Loss 0.239, Train_accy 74.05:  20%|██        | 4/20 [00:35<02:07,  7.97s/it]
Task 9, Epoch 5/20 => Loss 0.253, Train_accy 76.16:  20%|██        | 4/20 [00:42<02:07,  7.97s/it]
Task 9, Epoch 5/20 => Loss 0.253, Train_accy 76.16:  25%|██▌       | 5/20 [00:42<01:54,  7.62s/it]
Task 9, Epoch 6/20 => Loss 0.258, Train_accy 76.26, Test_accy 59.63:  25%|██▌       | 5/20 [00:55<01:54,  7.62s/it]
Task 9, Epoch 6/20 => Loss 0.258, Train_accy 76.26, Test_accy 59.63:  30%|███       | 6/20 [00:55<02:16,  9.74s/it]
Task 9, Epoch 7/20 => Loss 0.204, Train_accy 76.58:  30%|███       | 6/20 [01:02<02:16,  9.74s/it]                 
Task 9, Epoch 7/20 => Loss 0.204, Train_accy 76.58:  35%|███▌      | 7/20 [01:02<01:54,  8.84s/it]
Task 9, Epoch 8/20 => Loss 0.195, Train_accy 77.52:  35%|███▌      | 7/20 [01:09<01:54,  8.84s/it]
Task 9, Epoch 8/20 => Loss 0.195, Train_accy 77.52:  40%|████      | 8/20 [01:09<01:38,  8.18s/it]
Task 9, Epoch 9/20 => Loss 0.215, Train_accy 79.73:  40%|████      | 8/20 [01:16<01:38,  8.18s/it]
Task 9, Epoch 9/20 => Loss 0.215, Train_accy 79.73:  45%|████▌     | 9/20 [01:16<01:25,  7.79s/it]
Task 9, Epoch 10/20 => Loss 0.150, Train_accy 79.41:  45%|████▌     | 9/20 [01:23<01:25,  7.79s/it]
Task 9, Epoch 10/20 => Loss 0.150, Train_accy 79.41:  50%|█████     | 10/20 [01:23<01:15,  7.55s/it]
Task 9, Epoch 11/20 => Loss 0.177, Train_accy 82.35, Test_accy 60.18:  50%|█████     | 10/20 [01:37<01:15,  7.55s/it]
Task 9, Epoch 11/20 => Loss 0.177, Train_accy 82.35, Test_accy 60.18:  55%|█████▌    | 11/20 [01:37<01:24,  9.41s/it]
Task 9, Epoch 12/20 => Loss 0.213, Train_accy 81.72:  55%|█████▌    | 11/20 [01:44<01:24,  9.41s/it]                 
Task 9, Epoch 12/20 => Loss 0.213, Train_accy 81.72:  60%|██████    | 12/20 [01:44<01:08,  8.61s/it]
Task 9, Epoch 13/20 => Loss 0.143, Train_accy 82.77:  60%|██████    | 12/20 [01:51<01:08,  8.61s/it]
Task 9, Epoch 13/20 => Loss 0.143, Train_accy 82.77:  65%|██████▌   | 13/20 [01:51<00:56,  8.12s/it]
Task 9, Epoch 14/20 => Loss 0.150, Train_accy 83.51:  65%|██████▌   | 13/20 [01:58<00:56,  8.12s/it]
Task 9, Epoch 14/20 => Loss 0.150, Train_accy 83.51:  70%|███████   | 14/20 [01:58<00:46,  7.79s/it]
Task 9, Epoch 15/20 => Loss 0.177, Train_accy 84.14:  70%|███████   | 14/20 [02:04<00:46,  7.79s/it]
Task 9, Epoch 15/20 => Loss 0.177, Train_accy 84.14:  75%|███████▌  | 15/20 [02:04<00:37,  7.51s/it]
Task 9, Epoch 16/20 => Loss 0.150, Train_accy 83.40, Test_accy 59.54:  75%|███████▌  | 15/20 [02:18<00:37,  7.51s/it]
Task 9, Epoch 16/20 => Loss 0.150, Train_accy 83.40, Test_accy 59.54:  80%|████████  | 16/20 [02:18<00:37,  9.34s/it]
Task 9, Epoch 17/20 => Loss 0.145, Train_accy 85.08:  80%|████████  | 16/20 [02:25<00:37,  9.34s/it]                 
Task 9, Epoch 17/20 => Loss 0.145, Train_accy 85.08:  85%|████████▌ | 17/20 [02:25<00:25,  8.59s/it]
Task 9, Epoch 18/20 => Loss 0.152, Train_accy 82.25:  85%|████████▌ | 17/20 [02:32<00:25,  8.59s/it]
Task 9, Epoch 18/20 => Loss 0.152, Train_accy 82.25:  90%|█████████ | 18/20 [02:32<00:16,  8.15s/it]
Task 9, Epoch 19/20 => Loss 0.161, Train_accy 85.08:  90%|█████████ | 18/20 [02:39<00:16,  8.15s/it]
Task 9, Epoch 19/20 => Loss 0.161, Train_accy 85.08:  95%|█████████▌| 19/20 [02:39<00:07,  7.79s/it]
Task 9, Epoch 20/20 => Loss 0.167, Train_accy 84.35:  95%|█████████▌| 19/20 [02:46<00:07,  7.79s/it]
Task 9, Epoch 20/20 => Loss 0.167, Train_accy 84.35: 100%|██████████| 20/20 [02:46<00:00,  7.54s/it]
Task 9, Epoch 20/20 => Loss 0.167, Train_accy 84.35: 100%|██████████| 20/20 [02:46<00:00,  8.32s/it]
2024-04-19 16:08:22,158 [finetune.py] => Task 9, Epoch 20/20 => Loss 0.167, Train_accy 84.35
2024-04-19 16:08:28,933 [trainer.py] => No NME accuracy.
2024-04-19 16:08:28,933 [trainer.py] => CNN: {'total': 60.43, '00-19': 43.72, '20-39': 26.09, '40-59': 44.95, '60-79': 51.42, '80-99': 67.29, '100-119': 67.54, '120-139': 63.56, '140-159': 67.2, '160-179': 79.75, '180-199': 88.26, 'old': 57.42, 'new': 88.26}
2024-04-19 16:08:28,933 [trainer.py] => CNN top1 curve: [95.55, 91.41, 85.27, 81.07, 65.66, 64.83, 65.33, 65.68, 62.64, 60.43]
2024-04-19 16:08:28,933 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.81, 97.5, 93.35, 93.15, 94.03, 94.34, 92.43, 89.82]

Average Accuracy (CNN): 73.79
2024-04-19 16:08:28,933 [trainer.py] => Average Accuracy (CNN): 73.79 

2024-04-19 16:08:28,933 [trainer.py] => Train Time: 1685.5500000000002
2024-04-19 16:08:28,933 [trainer.py] => Test Time: 40.519999999999996 

Accuracy Matrix (CNN):
[[95.55 93.12 84.21 78.95 57.09 50.61 49.8  48.99 47.37 43.72]
 [ 0.   89.37 76.81 71.98 53.62 43.   39.61 37.68 32.37 26.09]
 [ 0.    0.   94.5  82.57 53.67 52.75 57.34 58.26 49.54 44.95]
 [ 0.    0.    0.   89.47 63.97 59.92 58.7  58.3  50.61 51.42]
 [ 0.    0.    0.    0.   94.05 89.22 84.39 78.07 71.75 67.29]
 [ 0.    0.    0.    0.    0.   88.16 77.19 71.49 64.91 67.54]
 [ 0.    0.    0.    0.    0.    0.   86.22 80.89 71.56 63.56]
 [ 0.    0.    0.    0.    0.    0.    0.   86.8  76.8  67.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   93.67 79.75]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   88.26]]
2024-04-19 16:08:28,934 [trainer.py] => Forgetting (CNN): 34.03

2024-04-24 02:35:54,700 [trainer.py] => Forgetting (NME): 19.576206896551724
2024-04-24 02:35:57,381 [trainer.py] => config: ./exps/icarl_cub_B0.json
2024-04-24 02:35:57,381 [trainer.py] => prefix: reproduce
2024-04-24 02:35:57,381 [trainer.py] => dataset: cub
2024-04-24 02:35:57,381 [trainer.py] => memory_size: 4000
2024-04-24 02:35:57,381 [trainer.py] => memory_per_class: 20
2024-04-24 02:35:57,381 [trainer.py] => fixed_memory: True
2024-04-24 02:35:57,381 [trainer.py] => shuffle: True
2024-04-24 02:35:57,381 [trainer.py] => init_cls: 20
2024-04-24 02:35:57,381 [trainer.py] => increment: 20
2024-04-24 02:35:57,381 [trainer.py] => model_name: icarl
2024-04-24 02:35:57,381 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-24 02:35:57,381 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-24 02:35:57,382 [trainer.py] => seed: 1993
2024-04-24 02:35:57,382 [trainer.py] => init_epoch: 20
2024-04-24 02:35:57,382 [trainer.py] => init_lr: 0.001
2024-04-24 02:35:57,382 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-24 02:35:57,382 [trainer.py] => init_lr_decay: 0.1
2024-04-24 02:35:57,382 [trainer.py] => init_weight_decay: 0.0005
2024-04-24 02:35:57,382 [trainer.py] => epochs: 20
2024-04-24 02:35:57,382 [trainer.py] => lrate: 0.001
2024-04-24 02:35:57,382 [trainer.py] => milestones: [80, 120]
2024-04-24 02:35:57,382 [trainer.py] => lrate_decay: 0.1
2024-04-24 02:35:57,382 [trainer.py] => batch_size: 48
2024-04-24 02:35:57,382 [trainer.py] => weight_decay: 0.0002
2024-04-24 02:35:57,382 [trainer.py] => T: 2
2024-04-24 02:35:57,420 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-24 02:35:59,441 [trainer.py] => All params: 85798656
2024-04-24 02:35:59,442 [trainer.py] => Trainable params: 85798656
2024-04-24 02:35:59,442 [icarl.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.244, Train_accy 44.40, Test_accy 87.04:   0%|          | 0/20 [00:08<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.244, Train_accy 44.40, Test_accy 87.04:   5%|▌         | 1/20 [00:08<02:47,  8.81s/it]
Task 0, Epoch 2/20 => Loss 0.672, Train_accy 80.13:   5%|▌         | 1/20 [00:16<02:47,  8.81s/it]                 
Task 0, Epoch 2/20 => Loss 0.672, Train_accy 80.13:  10%|█         | 2/20 [00:16<02:23,  7.96s/it]
Task 0, Epoch 3/20 => Loss 0.431, Train_accy 86.05:  10%|█         | 2/20 [00:23<02:23,  7.96s/it]
Task 0, Epoch 3/20 => Loss 0.431, Train_accy 86.05:  15%|█▌        | 3/20 [00:23<02:10,  7.68s/it]
Task 0, Epoch 4/20 => Loss 0.272, Train_accy 90.91:  15%|█▌        | 3/20 [00:30<02:10,  7.68s/it]
Task 0, Epoch 4/20 => Loss 0.272, Train_accy 90.91:  20%|██        | 4/20 [00:30<02:01,  7.57s/it]
Task 0, Epoch 5/20 => Loss 0.276, Train_accy 91.97:  20%|██        | 4/20 [00:38<02:01,  7.57s/it]
Task 0, Epoch 5/20 => Loss 0.276, Train_accy 91.97:  25%|██▌       | 5/20 [00:38<01:52,  7.49s/it]
Task 0, Epoch 6/20 => Loss 0.288, Train_accy 90.80, Test_accy 93.52:  25%|██▌       | 5/20 [00:46<01:52,  7.49s/it]
Task 0, Epoch 6/20 => Loss 0.288, Train_accy 90.80, Test_accy 93.52:  30%|███       | 6/20 [00:46<01:49,  7.86s/it]
Task 0, Epoch 7/20 => Loss 0.241, Train_accy 92.81:  30%|███       | 6/20 [00:54<01:49,  7.86s/it]                 
Task 0, Epoch 7/20 => Loss 0.241, Train_accy 92.81:  35%|███▌      | 7/20 [00:54<01:40,  7.72s/it]
Task 0, Epoch 8/20 => Loss 0.274, Train_accy 91.97:  35%|███▌      | 7/20 [01:01<01:40,  7.72s/it]
Task 0, Epoch 8/20 => Loss 0.274, Train_accy 91.97:  40%|████      | 8/20 [01:01<01:31,  7.61s/it]
Task 0, Epoch 9/20 => Loss 0.236, Train_accy 93.13:  40%|████      | 8/20 [01:09<01:31,  7.61s/it]
Task 0, Epoch 9/20 => Loss 0.236, Train_accy 93.13:  45%|████▌     | 9/20 [01:09<01:22,  7.54s/it]
Task 0, Epoch 10/20 => Loss 0.241, Train_accy 92.28:  45%|████▌     | 9/20 [01:16<01:22,  7.54s/it]
Task 0, Epoch 10/20 => Loss 0.241, Train_accy 92.28:  50%|█████     | 10/20 [01:16<01:14,  7.48s/it]
Task 0, Epoch 11/20 => Loss 0.208, Train_accy 94.29, Test_accy 97.17:  50%|█████     | 10/20 [01:24<01:14,  7.48s/it]
Task 0, Epoch 11/20 => Loss 0.208, Train_accy 94.29, Test_accy 97.17:  55%|█████▌    | 11/20 [01:24<01:10,  7.80s/it]
Task 0, Epoch 12/20 => Loss 0.211, Train_accy 93.55:  55%|█████▌    | 11/20 [01:32<01:10,  7.80s/it]                 
Task 0, Epoch 12/20 => Loss 0.211, Train_accy 93.55:  60%|██████    | 12/20 [01:32<01:01,  7.66s/it]
Task 0, Epoch 13/20 => Loss 0.173, Train_accy 94.40:  60%|██████    | 12/20 [01:39<01:01,  7.66s/it]
Task 0, Epoch 13/20 => Loss 0.173, Train_accy 94.40:  65%|██████▌   | 13/20 [01:39<00:52,  7.57s/it]
Task 0, Epoch 14/20 => Loss 0.152, Train_accy 95.35:  65%|██████▌   | 13/20 [01:46<00:52,  7.57s/it]
Task 0, Epoch 14/20 => Loss 0.152, Train_accy 95.35:  70%|███████   | 14/20 [01:46<00:44,  7.49s/it]
Task 0, Epoch 15/20 => Loss 0.237, Train_accy 92.39:  70%|███████   | 14/20 [01:54<00:44,  7.49s/it]
Task 0, Epoch 15/20 => Loss 0.237, Train_accy 92.39:  75%|███████▌  | 15/20 [01:54<00:37,  7.46s/it]
Task 0, Epoch 16/20 => Loss 0.223, Train_accy 93.13, Test_accy 97.57:  75%|███████▌  | 15/20 [02:02<00:37,  7.46s/it]
Task 0, Epoch 16/20 => Loss 0.223, Train_accy 93.13, Test_accy 97.57:  80%|████████  | 16/20 [02:02<00:31,  7.76s/it]
Task 0, Epoch 17/20 => Loss 0.193, Train_accy 93.97:  80%|████████  | 16/20 [02:10<00:31,  7.76s/it]                 
Task 0, Epoch 17/20 => Loss 0.193, Train_accy 93.97:  85%|████████▌ | 17/20 [02:10<00:22,  7.65s/it]
Task 0, Epoch 18/20 => Loss 0.147, Train_accy 95.35:  85%|████████▌ | 17/20 [02:17<00:22,  7.65s/it]
Task 0, Epoch 18/20 => Loss 0.147, Train_accy 95.35:  90%|█████████ | 18/20 [02:17<00:15,  7.57s/it]
Task 0, Epoch 19/20 => Loss 0.154, Train_accy 95.14:  90%|█████████ | 18/20 [02:24<00:15,  7.57s/it]
Task 0, Epoch 19/20 => Loss 0.154, Train_accy 95.14:  95%|█████████▌| 19/20 [02:24<00:07,  7.49s/it]
Task 0, Epoch 20/20 => Loss 0.164, Train_accy 95.03:  95%|█████████▌| 19/20 [02:32<00:07,  7.49s/it]
Task 0, Epoch 20/20 => Loss 0.164, Train_accy 95.03: 100%|██████████| 20/20 [02:32<00:00,  7.45s/it]
Task 0, Epoch 20/20 => Loss 0.164, Train_accy 95.03: 100%|██████████| 20/20 [02:32<00:00,  7.61s/it]
2024-04-24 02:38:32,134 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.164, Train_accy 95.03
2024-04-24 02:38:32,134 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 02:38:51,112 [icarl.py] => Exemplar size: 400
2024-04-24 02:38:51,113 [trainer.py] => CNN: {'total': 95.95, '00-19': 95.95, 'old': 0, 'new': 95.95}
2024-04-24 02:38:51,113 [trainer.py] => NME: {'total': 96.76, '00-19': 96.76, 'old': 0, 'new': 96.76}
2024-04-24 02:38:51,113 [trainer.py] => CNN top1 curve: [95.95]
2024-04-24 02:38:51,113 [trainer.py] => CNN top5 curve: [99.6]
2024-04-24 02:38:51,113 [trainer.py] => NME top1 curve: [96.76]
2024-04-24 02:38:51,113 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 95.95
Average Accuracy (NME): 96.76
2024-04-24 02:38:51,113 [trainer.py] => Average Accuracy (CNN): 95.95
2024-04-24 02:38:51,113 [trainer.py] => Average Accuracy (NME): 96.76
2024-04-24 02:38:51,113 [trainer.py] => Train Time: 0
2024-04-24 02:38:51,113 [trainer.py] => Test Time: 2.28 

2024-04-24 02:38:51,113 [trainer.py] => All params: 85814036
2024-04-24 02:38:51,114 [trainer.py] => Trainable params: 85814036
2024-04-24 02:38:51,115 [icarl.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.525, Train_accy 52.04, Test_accy 88.11:   0%|          | 0/20 [00:15<?, ?it/s]
Task 1, Epoch 1/20 => Loss 3.525, Train_accy 52.04, Test_accy 88.11:   5%|▌         | 1/20 [00:15<04:56, 15.59s/it]
Task 1, Epoch 2/20 => Loss 1.489, Train_accy 86.10:   5%|▌         | 1/20 [00:29<04:56, 15.59s/it]                 
Task 1, Epoch 2/20 => Loss 1.489, Train_accy 86.10:  10%|█         | 2/20 [00:29<04:21, 14.53s/it]
Task 1, Epoch 3/20 => Loss 1.432, Train_accy 88.62:  10%|█         | 2/20 [00:43<04:21, 14.53s/it]
Task 1, Epoch 3/20 => Loss 1.432, Train_accy 88.62:  15%|█▌        | 3/20 [00:43<04:01, 14.19s/it]
Task 1, Epoch 4/20 => Loss 1.493, Train_accy 91.08:  15%|█▌        | 3/20 [00:57<04:01, 14.19s/it]
Task 1, Epoch 4/20 => Loss 1.493, Train_accy 91.08:  20%|██        | 4/20 [00:57<03:44, 14.06s/it]
Task 1, Epoch 5/20 => Loss 1.475, Train_accy 88.85:  20%|██        | 4/20 [01:10<03:44, 14.06s/it]
Task 1, Epoch 5/20 => Loss 1.475, Train_accy 88.85:  25%|██▌       | 5/20 [01:10<03:29, 13.99s/it]
Task 1, Epoch 6/20 => Loss 1.309, Train_accy 91.75, Test_accy 93.83:  25%|██▌       | 5/20 [01:26<03:29, 13.99s/it]
Task 1, Epoch 6/20 => Loss 1.309, Train_accy 91.75, Test_accy 93.83:  30%|███       | 6/20 [01:26<03:24, 14.60s/it]
Task 1, Epoch 7/20 => Loss 1.406, Train_accy 92.57:  30%|███       | 6/20 [01:40<03:24, 14.60s/it]                 
Task 1, Epoch 7/20 => Loss 1.406, Train_accy 92.57:  35%|███▌      | 7/20 [01:40<03:06, 14.34s/it]
Task 1, Epoch 8/20 => Loss 1.340, Train_accy 90.63:  35%|███▌      | 7/20 [01:54<03:06, 14.34s/it]
Task 1, Epoch 8/20 => Loss 1.340, Train_accy 90.63:  40%|████      | 8/20 [01:54<02:50, 14.17s/it]
Task 1, Epoch 9/20 => Loss 1.577, Train_accy 92.42:  40%|████      | 8/20 [02:08<02:50, 14.17s/it]
Task 1, Epoch 9/20 => Loss 1.577, Train_accy 92.42:  45%|████▌     | 9/20 [02:08<02:34, 14.09s/it]
Task 1, Epoch 10/20 => Loss 1.538, Train_accy 88.55:  45%|████▌     | 9/20 [02:22<02:34, 14.09s/it]
Task 1, Epoch 10/20 => Loss 1.538, Train_accy 88.55:  50%|█████     | 10/20 [02:22<02:20, 14.01s/it]
Task 1, Epoch 11/20 => Loss 1.322, Train_accy 92.71, Test_accy 94.27:  50%|█████     | 10/20 [02:37<02:20, 14.01s/it]
Task 1, Epoch 11/20 => Loss 1.322, Train_accy 92.71, Test_accy 94.27:  55%|█████▌    | 11/20 [02:37<02:10, 14.46s/it]
Task 1, Epoch 12/20 => Loss 1.234, Train_accy 94.80:  55%|█████▌    | 11/20 [02:51<02:10, 14.46s/it]                 
Task 1, Epoch 12/20 => Loss 1.234, Train_accy 94.80:  60%|██████    | 12/20 [02:51<01:54, 14.26s/it]
Task 1, Epoch 13/20 => Loss 1.275, Train_accy 92.64:  60%|██████    | 12/20 [03:05<01:54, 14.26s/it]
Task 1, Epoch 13/20 => Loss 1.275, Train_accy 92.64:  65%|██████▌   | 13/20 [03:05<01:39, 14.14s/it]
Task 1, Epoch 14/20 => Loss 1.305, Train_accy 92.64:  65%|██████▌   | 13/20 [03:19<01:39, 14.14s/it]
Task 1, Epoch 14/20 => Loss 1.305, Train_accy 92.64:  70%|███████   | 14/20 [03:19<01:24, 14.07s/it]
Task 1, Epoch 15/20 => Loss 1.185, Train_accy 94.50:  70%|███████   | 14/20 [03:32<01:24, 14.07s/it]
Task 1, Epoch 15/20 => Loss 1.185, Train_accy 94.50:  75%|███████▌  | 15/20 [03:32<01:10, 14.00s/it]
Task 1, Epoch 16/20 => Loss 1.223, Train_accy 93.83, Test_accy 94.71:  75%|███████▌  | 15/20 [03:48<01:10, 14.00s/it]
Task 1, Epoch 16/20 => Loss 1.223, Train_accy 93.83, Test_accy 94.71:  80%|████████  | 16/20 [03:48<00:57, 14.48s/it]
Task 1, Epoch 17/20 => Loss 1.310, Train_accy 94.13:  80%|████████  | 16/20 [04:02<00:57, 14.48s/it]                 
Task 1, Epoch 17/20 => Loss 1.310, Train_accy 94.13:  85%|████████▌ | 17/20 [04:02<00:42, 14.29s/it]
Task 1, Epoch 18/20 => Loss 1.236, Train_accy 94.65:  85%|████████▌ | 17/20 [04:16<00:42, 14.29s/it]
Task 1, Epoch 18/20 => Loss 1.236, Train_accy 94.65:  90%|█████████ | 18/20 [04:16<00:28, 14.16s/it]
Task 1, Epoch 19/20 => Loss 1.285, Train_accy 93.83:  90%|█████████ | 18/20 [04:30<00:28, 14.16s/it]
Task 1, Epoch 19/20 => Loss 1.285, Train_accy 93.83:  95%|█████████▌| 19/20 [04:30<00:14, 14.08s/it]
Task 1, Epoch 20/20 => Loss 1.283, Train_accy 93.98:  95%|█████████▌| 19/20 [04:43<00:14, 14.08s/it]
Task 1, Epoch 20/20 => Loss 1.283, Train_accy 93.98: 100%|██████████| 20/20 [04:43<00:00, 14.02s/it]
Task 1, Epoch 20/20 => Loss 1.283, Train_accy 93.98: 100%|██████████| 20/20 [04:43<00:00, 14.20s/it]
2024-04-24 02:43:35,112 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.283, Train_accy 93.98
2024-04-24 02:43:35,113 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 02:44:01,997 [icarl.py] => Exemplar size: 800
2024-04-24 02:44:01,997 [trainer.py] => CNN: {'total': 94.27, '00-19': 94.74, '20-39': 93.72, 'old': 94.74, 'new': 93.72}
2024-04-24 02:44:01,997 [trainer.py] => NME: {'total': 94.49, '00-19': 94.74, '20-39': 94.2, 'old': 94.74, 'new': 94.2}
2024-04-24 02:44:01,997 [trainer.py] => CNN top1 curve: [95.95, 94.27]
2024-04-24 02:44:01,997 [trainer.py] => CNN top5 curve: [99.6, 99.56]
2024-04-24 02:44:01,997 [trainer.py] => NME top1 curve: [96.76, 94.49]
2024-04-24 02:44:01,997 [trainer.py] => NME top5 curve: [100.0, 99.34]

Average Accuracy (CNN): 95.11
Average Accuracy (NME): 95.62
2024-04-24 02:44:01,997 [trainer.py] => Average Accuracy (CNN): 95.11
2024-04-24 02:44:01,997 [trainer.py] => Average Accuracy (NME): 95.62
2024-04-24 02:44:01,998 [trainer.py] => Train Time: 0
2024-04-24 02:44:01,998 [trainer.py] => Test Time: 5.82 

2024-04-24 02:44:01,998 [trainer.py] => All params: 85829416
2024-04-24 02:44:01,998 [trainer.py] => Trainable params: 85829416
2024-04-24 02:44:01,999 [icarl.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.154, Train_accy 67.81, Test_accy 87.50:   0%|          | 0/20 [00:20<?, ?it/s]
Task 2, Epoch 1/20 => Loss 3.154, Train_accy 67.81, Test_accy 87.50:   5%|▌         | 1/20 [00:20<06:24, 20.23s/it]
Task 2, Epoch 2/20 => Loss 1.890, Train_accy 87.84:   5%|▌         | 1/20 [00:38<06:24, 20.23s/it]                 
Task 2, Epoch 2/20 => Loss 1.890, Train_accy 87.84:  10%|█         | 2/20 [00:38<05:39, 18.84s/it]
Task 2, Epoch 3/20 => Loss 1.908, Train_accy 87.78:  10%|█         | 2/20 [00:56<05:39, 18.84s/it]
Task 2, Epoch 3/20 => Loss 1.908, Train_accy 87.78:  15%|█▌        | 3/20 [00:56<05:13, 18.43s/it]
Task 2, Epoch 4/20 => Loss 1.834, Train_accy 90.30:  15%|█▌        | 3/20 [01:13<05:13, 18.43s/it]
Task 2, Epoch 4/20 => Loss 1.834, Train_accy 90.30:  20%|██        | 4/20 [01:13<04:51, 18.19s/it]
Task 2, Epoch 5/20 => Loss 1.798, Train_accy 91.22:  20%|██        | 4/20 [01:31<04:51, 18.19s/it]
Task 2, Epoch 5/20 => Loss 1.798, Train_accy 91.22:  25%|██▌       | 5/20 [01:31<04:30, 18.04s/it]
Task 2, Epoch 6/20 => Loss 1.776, Train_accy 91.34, Test_accy 90.77:  25%|██▌       | 5/20 [01:51<04:30, 18.04s/it]
Task 2, Epoch 6/20 => Loss 1.776, Train_accy 91.34, Test_accy 90.77:  30%|███       | 6/20 [01:51<04:22, 18.73s/it]
Task 2, Epoch 7/20 => Loss 1.703, Train_accy 92.48:  30%|███       | 6/20 [02:09<04:22, 18.73s/it]                 
Task 2, Epoch 7/20 => Loss 1.703, Train_accy 92.48:  35%|███▌      | 7/20 [02:09<03:59, 18.42s/it]
Task 2, Epoch 8/20 => Loss 1.763, Train_accy 92.37:  35%|███▌      | 7/20 [02:27<03:59, 18.42s/it]
Task 2, Epoch 8/20 => Loss 1.763, Train_accy 92.37:  40%|████      | 8/20 [02:27<03:38, 18.22s/it]
Task 2, Epoch 9/20 => Loss 1.704, Train_accy 93.12:  40%|████      | 8/20 [02:45<03:38, 18.22s/it]
Task 2, Epoch 9/20 => Loss 1.704, Train_accy 93.12:  45%|████▌     | 9/20 [02:45<03:18, 18.08s/it]
Task 2, Epoch 10/20 => Loss 1.756, Train_accy 92.43:  45%|████▌     | 9/20 [03:02<03:18, 18.08s/it]
Task 2, Epoch 10/20 => Loss 1.756, Train_accy 92.43:  50%|█████     | 10/20 [03:02<02:59, 17.99s/it]
Task 2, Epoch 11/20 => Loss 1.686, Train_accy 93.12, Test_accy 89.88:  50%|█████     | 10/20 [03:22<02:59, 17.99s/it]
Task 2, Epoch 11/20 => Loss 1.686, Train_accy 93.12, Test_accy 89.88:  55%|█████▌    | 11/20 [03:22<02:47, 18.65s/it]
Task 2, Epoch 12/20 => Loss 1.664, Train_accy 93.75:  55%|█████▌    | 11/20 [03:40<02:47, 18.65s/it]                 
Task 2, Epoch 12/20 => Loss 1.664, Train_accy 93.75:  60%|██████    | 12/20 [03:40<02:27, 18.39s/it]
Task 2, Epoch 13/20 => Loss 1.697, Train_accy 92.94:  60%|██████    | 12/20 [03:58<02:27, 18.39s/it]
Task 2, Epoch 13/20 => Loss 1.697, Train_accy 92.94:  65%|██████▌   | 13/20 [03:58<02:07, 18.22s/it]
Task 2, Epoch 14/20 => Loss 1.690, Train_accy 94.26:  65%|██████▌   | 13/20 [04:16<02:07, 18.22s/it]
Task 2, Epoch 14/20 => Loss 1.690, Train_accy 94.26:  70%|███████   | 14/20 [04:16<01:48, 18.09s/it]
Task 2, Epoch 15/20 => Loss 1.715, Train_accy 93.69:  70%|███████   | 14/20 [04:34<01:48, 18.09s/it]
Task 2, Epoch 15/20 => Loss 1.715, Train_accy 93.69:  75%|███████▌  | 15/20 [04:34<01:30, 18.02s/it]
Task 2, Epoch 16/20 => Loss 1.685, Train_accy 93.46, Test_accy 92.71:  75%|███████▌  | 15/20 [04:54<01:30, 18.02s/it]
Task 2, Epoch 16/20 => Loss 1.685, Train_accy 93.46, Test_accy 92.71:  80%|████████  | 16/20 [04:54<01:14, 18.63s/it]
Task 2, Epoch 17/20 => Loss 1.705, Train_accy 93.69:  80%|████████  | 16/20 [05:12<01:14, 18.63s/it]                 
Task 2, Epoch 17/20 => Loss 1.705, Train_accy 93.69:  85%|████████▌ | 17/20 [05:12<00:55, 18.37s/it]
Task 2, Epoch 18/20 => Loss 1.618, Train_accy 94.89:  85%|████████▌ | 17/20 [05:29<00:55, 18.37s/it]
Task 2, Epoch 18/20 => Loss 1.618, Train_accy 94.89:  90%|█████████ | 18/20 [05:29<00:36, 18.21s/it]
Task 2, Epoch 19/20 => Loss 1.680, Train_accy 94.15:  90%|█████████ | 18/20 [05:47<00:36, 18.21s/it]
Task 2, Epoch 19/20 => Loss 1.680, Train_accy 94.15:  95%|█████████▌| 19/20 [05:47<00:18, 18.08s/it]
Task 2, Epoch 20/20 => Loss 1.690, Train_accy 94.21:  95%|█████████▌| 19/20 [06:05<00:18, 18.08s/it]
Task 2, Epoch 20/20 => Loss 1.690, Train_accy 94.21: 100%|██████████| 20/20 [06:05<00:00, 17.99s/it]
Task 2, Epoch 20/20 => Loss 1.690, Train_accy 94.21: 100%|██████████| 20/20 [06:05<00:00, 18.27s/it]
2024-04-24 02:50:07,460 [icarl.py] => Task 2, Epoch 20/20 => Loss 1.690, Train_accy 94.21
2024-04-24 02:50:07,462 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 02:50:41,574 [icarl.py] => Exemplar size: 1200
2024-04-24 02:50:41,574 [trainer.py] => CNN: {'total': 90.62, '00-19': 87.45, '20-39': 92.27, '40-59': 92.66, 'old': 89.65, 'new': 92.66}
2024-04-24 02:50:41,574 [trainer.py] => NME: {'total': 93.15, '00-19': 92.71, '20-39': 94.2, '40-59': 92.66, 'old': 93.39, 'new': 92.66}
2024-04-24 02:50:41,574 [trainer.py] => CNN top1 curve: [95.95, 94.27, 90.62]
2024-04-24 02:50:41,574 [trainer.py] => CNN top5 curve: [99.6, 99.56, 98.96]
2024-04-24 02:50:41,574 [trainer.py] => NME top1 curve: [96.76, 94.49, 93.15]
2024-04-24 02:50:41,574 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.4]

Average Accuracy (CNN): 93.61
Average Accuracy (NME): 94.8
2024-04-24 02:50:41,575 [trainer.py] => Average Accuracy (CNN): 93.61
2024-04-24 02:50:41,575 [trainer.py] => Average Accuracy (NME): 94.8
2024-04-24 02:50:41,575 [trainer.py] => Train Time: 0
2024-04-24 02:50:41,575 [trainer.py] => Test Time: 10.56 

2024-04-24 02:50:41,575 [trainer.py] => All params: 85844796
2024-04-24 02:50:41,576 [trainer.py] => Trainable params: 85844796
2024-04-24 02:50:41,577 [icarl.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.150, Train_accy 71.06, Test_accy 84.98:   0%|          | 0/20 [00:25<?, ?it/s]
Task 3, Epoch 1/20 => Loss 3.150, Train_accy 71.06, Test_accy 84.98:   5%|▌         | 1/20 [00:25<07:57, 25.11s/it]
Task 3, Epoch 2/20 => Loss 1.968, Train_accy 87.23:   5%|▌         | 1/20 [00:47<07:57, 25.11s/it]                 
Task 3, Epoch 2/20 => Loss 1.968, Train_accy 87.23:  10%|█         | 2/20 [00:47<06:58, 23.27s/it]
Task 3, Epoch 3/20 => Loss 1.921, Train_accy 89.84:  10%|█         | 2/20 [01:09<06:58, 23.27s/it]
Task 3, Epoch 3/20 => Loss 1.921, Train_accy 89.84:  15%|█▌        | 3/20 [01:09<06:25, 22.65s/it]
Task 3, Epoch 4/20 => Loss 1.849, Train_accy 90.77:  15%|█▌        | 3/20 [01:30<06:25, 22.65s/it]
Task 3, Epoch 4/20 => Loss 1.849, Train_accy 90.77:  20%|██        | 4/20 [01:30<05:58, 22.39s/it]
Task 3, Epoch 5/20 => Loss 1.853, Train_accy 91.10:  20%|██        | 4/20 [01:52<05:58, 22.39s/it]
Task 3, Epoch 5/20 => Loss 1.853, Train_accy 91.10:  25%|██▌       | 5/20 [01:52<05:32, 22.15s/it]
Task 3, Epoch 6/20 => Loss 1.772, Train_accy 92.68, Test_accy 89.23:  25%|██▌       | 5/20 [02:17<05:32, 22.15s/it]
Task 3, Epoch 6/20 => Loss 1.772, Train_accy 92.68, Test_accy 89.23:  30%|███       | 6/20 [02:17<05:23, 23.08s/it]
Task 3, Epoch 7/20 => Loss 1.749, Train_accy 93.20:  30%|███       | 6/20 [02:39<05:23, 23.08s/it]                 
Task 3, Epoch 7/20 => Loss 1.749, Train_accy 93.20:  35%|███▌      | 7/20 [02:39<04:54, 22.64s/it]
Task 3, Epoch 8/20 => Loss 1.773, Train_accy 93.15:  35%|███▌      | 7/20 [03:01<04:54, 22.64s/it]
Task 3, Epoch 8/20 => Loss 1.773, Train_accy 93.15:  40%|████      | 8/20 [03:01<04:28, 22.36s/it]
Task 3, Epoch 9/20 => Loss 1.779, Train_accy 92.50:  40%|████      | 8/20 [03:22<04:28, 22.36s/it]
Task 3, Epoch 9/20 => Loss 1.779, Train_accy 92.50:  45%|████▌     | 9/20 [03:22<04:03, 22.17s/it]
Task 3, Epoch 10/20 => Loss 1.790, Train_accy 93.01:  45%|████▌     | 9/20 [03:44<04:03, 22.17s/it]
Task 3, Epoch 10/20 => Loss 1.790, Train_accy 93.01:  50%|█████     | 10/20 [03:44<03:40, 22.07s/it]
Task 3, Epoch 11/20 => Loss 1.721, Train_accy 94.13, Test_accy 89.77:  50%|█████     | 10/20 [04:09<03:40, 22.07s/it]
Task 3, Epoch 11/20 => Loss 1.721, Train_accy 94.13, Test_accy 89.77:  55%|█████▌    | 11/20 [04:09<03:26, 22.91s/it]
Task 3, Epoch 12/20 => Loss 1.828, Train_accy 92.40:  55%|█████▌    | 11/20 [04:31<03:26, 22.91s/it]                 
Task 3, Epoch 12/20 => Loss 1.828, Train_accy 92.40:  60%|██████    | 12/20 [04:31<03:00, 22.54s/it]
Task 3, Epoch 13/20 => Loss 1.679, Train_accy 94.36:  60%|██████    | 12/20 [04:52<03:00, 22.54s/it]
Task 3, Epoch 13/20 => Loss 1.679, Train_accy 94.36:  65%|██████▌   | 13/20 [04:52<02:35, 22.28s/it]
Task 3, Epoch 14/20 => Loss 1.721, Train_accy 93.85:  65%|██████▌   | 13/20 [05:14<02:35, 22.28s/it]
Task 3, Epoch 14/20 => Loss 1.721, Train_accy 93.85:  70%|███████   | 14/20 [05:14<02:12, 22.11s/it]
Task 3, Epoch 15/20 => Loss 1.712, Train_accy 94.13:  70%|███████   | 14/20 [05:36<02:12, 22.11s/it]
Task 3, Epoch 15/20 => Loss 1.712, Train_accy 94.13:  75%|███████▌  | 15/20 [05:36<01:49, 22.00s/it]
Task 3, Epoch 16/20 => Loss 1.690, Train_accy 94.87, Test_accy 90.32:  75%|███████▌  | 15/20 [06:01<01:49, 22.00s/it]
Task 3, Epoch 16/20 => Loss 1.690, Train_accy 94.87, Test_accy 90.32:  80%|████████  | 16/20 [06:01<01:31, 22.84s/it]
Task 3, Epoch 17/20 => Loss 1.707, Train_accy 94.78:  80%|████████  | 16/20 [06:22<01:31, 22.84s/it]                 
Task 3, Epoch 17/20 => Loss 1.707, Train_accy 94.78:  85%|████████▌ | 17/20 [06:22<01:07, 22.51s/it]
Task 3, Epoch 18/20 => Loss 1.705, Train_accy 94.50:  85%|████████▌ | 17/20 [06:44<01:07, 22.51s/it]
Task 3, Epoch 18/20 => Loss 1.705, Train_accy 94.50:  90%|█████████ | 18/20 [06:44<00:44, 22.33s/it]
Task 3, Epoch 19/20 => Loss 1.737, Train_accy 94.22:  90%|█████████ | 18/20 [07:06<00:44, 22.33s/it]
Task 3, Epoch 19/20 => Loss 1.737, Train_accy 94.22:  95%|█████████▌| 19/20 [07:06<00:22, 22.17s/it]
Task 3, Epoch 20/20 => Loss 1.710, Train_accy 94.59:  95%|█████████▌| 19/20 [07:28<00:22, 22.17s/it]
Task 3, Epoch 20/20 => Loss 1.710, Train_accy 94.59: 100%|██████████| 20/20 [07:28<00:00, 22.05s/it]
Task 3, Epoch 20/20 => Loss 1.710, Train_accy 94.59: 100%|██████████| 20/20 [07:28<00:00, 22.42s/it]
2024-04-24 02:58:09,935 [icarl.py] => Task 3, Epoch 20/20 => Loss 1.710, Train_accy 94.59
2024-04-24 02:58:09,936 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 02:58:51,600 [icarl.py] => Exemplar size: 1600
2024-04-24 02:58:51,600 [trainer.py] => CNN: {'total': 90.32, '00-19': 85.83, '20-39': 90.82, '40-59': 89.45, '60-79': 95.14, 'old': 88.54, 'new': 95.14}
2024-04-24 02:58:51,600 [trainer.py] => NME: {'total': 90.97, '00-19': 88.66, '20-39': 92.27, '40-59': 90.37, '60-79': 92.71, 'old': 90.33, 'new': 92.71}
2024-04-24 02:58:51,600 [trainer.py] => CNN top1 curve: [95.95, 94.27, 90.62, 90.32]
2024-04-24 02:58:51,600 [trainer.py] => CNN top5 curve: [99.6, 99.56, 98.96, 98.15]
2024-04-24 02:58:51,600 [trainer.py] => NME top1 curve: [96.76, 94.49, 93.15, 90.97]
2024-04-24 02:58:51,600 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.4, 98.91]

Average Accuracy (CNN): 92.79
Average Accuracy (NME): 93.84
2024-04-24 02:58:51,600 [trainer.py] => Average Accuracy (CNN): 92.79
2024-04-24 02:58:51,600 [trainer.py] => Average Accuracy (NME): 93.84
2024-04-24 02:58:51,600 [trainer.py] => Train Time: 0
2024-04-24 02:58:51,601 [trainer.py] => Test Time: 16.95 

2024-04-24 02:58:51,601 [trainer.py] => All params: 85860176
2024-04-24 02:58:51,601 [trainer.py] => Trainable params: 85860176
2024-04-24 02:58:51,603 [icarl.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.833, Train_accy 77.53, Test_accy 87.29:   0%|          | 0/20 [00:29<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.833, Train_accy 77.53, Test_accy 87.29:   5%|▌         | 1/20 [00:29<09:17, 29.34s/it]
Task 4, Epoch 2/20 => Loss 1.926, Train_accy 88.74:   5%|▌         | 1/20 [00:54<09:17, 29.34s/it]                 
Task 4, Epoch 2/20 => Loss 1.926, Train_accy 88.74:  10%|█         | 2/20 [00:54<08:07, 27.06s/it]
Task 4, Epoch 3/20 => Loss 1.847, Train_accy 90.89:  10%|█         | 2/20 [01:20<08:07, 27.06s/it]
Task 4, Epoch 3/20 => Loss 1.847, Train_accy 90.89:  15%|█▌        | 3/20 [01:20<07:27, 26.32s/it]
Task 4, Epoch 4/20 => Loss 1.870, Train_accy 91.33:  15%|█▌        | 3/20 [01:45<07:27, 26.32s/it]
Task 4, Epoch 4/20 => Loss 1.870, Train_accy 91.33:  20%|██        | 4/20 [01:45<06:56, 26.02s/it]
Task 4, Epoch 5/20 => Loss 1.793, Train_accy 92.72:  20%|██        | 4/20 [02:11<06:56, 26.02s/it]
Task 4, Epoch 5/20 => Loss 1.793, Train_accy 92.72:  25%|██▌       | 5/20 [02:11<06:26, 25.79s/it]
Task 4, Epoch 6/20 => Loss 1.790, Train_accy 92.88, Test_accy 88.80:  25%|██▌       | 5/20 [02:40<06:26, 25.79s/it]
Task 4, Epoch 6/20 => Loss 1.790, Train_accy 92.88, Test_accy 88.80:  30%|███       | 6/20 [02:40<06:17, 26.94s/it]
Task 4, Epoch 7/20 => Loss 1.809, Train_accy 93.83:  30%|███       | 6/20 [03:05<06:17, 26.94s/it]                 
Task 4, Epoch 7/20 => Loss 1.809, Train_accy 93.83:  35%|███▌      | 7/20 [03:05<05:43, 26.43s/it]
Task 4, Epoch 8/20 => Loss 1.843, Train_accy 93.32:  35%|███▌      | 7/20 [03:31<05:43, 26.43s/it]
Task 4, Epoch 8/20 => Loss 1.843, Train_accy 93.32:  40%|████      | 8/20 [03:31<05:13, 26.12s/it]
Task 4, Epoch 9/20 => Loss 1.800, Train_accy 93.32:  40%|████      | 8/20 [03:56<05:13, 26.12s/it]
Task 4, Epoch 9/20 => Loss 1.800, Train_accy 93.32:  45%|████▌     | 9/20 [03:56<04:45, 25.93s/it]
Task 4, Epoch 10/20 => Loss 1.806, Train_accy 93.12:  45%|████▌     | 9/20 [04:22<04:45, 25.93s/it]
Task 4, Epoch 10/20 => Loss 1.806, Train_accy 93.12:  50%|█████     | 10/20 [04:22<04:17, 25.78s/it]
Task 4, Epoch 11/20 => Loss 1.784, Train_accy 93.75, Test_accy 89.06:  50%|█████     | 10/20 [04:51<04:17, 25.78s/it]
Task 4, Epoch 11/20 => Loss 1.784, Train_accy 93.75, Test_accy 89.06:  55%|█████▌    | 11/20 [04:51<04:01, 26.84s/it]
Task 4, Epoch 12/20 => Loss 1.760, Train_accy 94.51:  55%|█████▌    | 11/20 [05:16<04:01, 26.84s/it]                 
Task 4, Epoch 12/20 => Loss 1.760, Train_accy 94.51:  60%|██████    | 12/20 [05:16<03:31, 26.42s/it]
Task 4, Epoch 13/20 => Loss 1.753, Train_accy 94.19:  60%|██████    | 12/20 [05:42<03:31, 26.42s/it]
Task 4, Epoch 13/20 => Loss 1.753, Train_accy 94.19:  65%|██████▌   | 13/20 [05:42<03:02, 26.12s/it]
Task 4, Epoch 14/20 => Loss 1.758, Train_accy 94.55:  65%|██████▌   | 13/20 [06:07<03:02, 26.12s/it]
Task 4, Epoch 14/20 => Loss 1.758, Train_accy 94.55:  70%|███████   | 14/20 [06:07<02:35, 25.91s/it]
Task 4, Epoch 15/20 => Loss 1.716, Train_accy 95.31:  70%|███████   | 14/20 [06:33<02:35, 25.91s/it]
Task 4, Epoch 15/20 => Loss 1.716, Train_accy 95.31:  75%|███████▌  | 15/20 [06:33<02:08, 25.78s/it]
Task 4, Epoch 16/20 => Loss 1.721, Train_accy 94.79, Test_accy 89.48:  75%|███████▌  | 15/20 [07:02<02:08, 25.78s/it]
Task 4, Epoch 16/20 => Loss 1.721, Train_accy 94.79, Test_accy 89.48:  80%|████████  | 16/20 [07:02<01:47, 26.79s/it]
Task 4, Epoch 17/20 => Loss 1.762, Train_accy 94.27:  80%|████████  | 16/20 [07:27<01:47, 26.79s/it]                 
Task 4, Epoch 17/20 => Loss 1.762, Train_accy 94.27:  85%|████████▌ | 17/20 [07:27<01:19, 26.38s/it]
Task 4, Epoch 18/20 => Loss 1.792, Train_accy 94.31:  85%|████████▌ | 17/20 [07:53<01:19, 26.38s/it]
Task 4, Epoch 18/20 => Loss 1.792, Train_accy 94.31:  90%|█████████ | 18/20 [07:53<00:52, 26.17s/it]
Task 4, Epoch 19/20 => Loss 1.775, Train_accy 94.07:  90%|█████████ | 18/20 [08:19<00:52, 26.17s/it]
Task 4, Epoch 19/20 => Loss 1.775, Train_accy 94.07:  95%|█████████▌| 19/20 [08:19<00:25, 25.99s/it]
Task 4, Epoch 20/20 => Loss 1.714, Train_accy 95.58:  95%|█████████▌| 19/20 [08:44<00:25, 25.99s/it]
Task 4, Epoch 20/20 => Loss 1.714, Train_accy 95.58: 100%|██████████| 20/20 [08:44<00:00, 25.84s/it]
Task 4, Epoch 20/20 => Loss 1.714, Train_accy 95.58: 100%|██████████| 20/20 [08:44<00:00, 26.22s/it]
2024-04-24 03:07:36,094 [icarl.py] => Task 4, Epoch 20/20 => Loss 1.714, Train_accy 95.58
2024-04-24 03:07:36,096 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 03:08:26,147 [icarl.py] => Exemplar size: 2000
2024-04-24 03:08:26,147 [trainer.py] => CNN: {'total': 89.23, '00-19': 83.0, '20-39': 87.44, '40-59': 87.16, '60-79': 91.09, '80-99': 96.28, 'old': 87.16, 'new': 96.28}
2024-04-24 03:08:26,147 [trainer.py] => NME: {'total': 90.4, '00-19': 89.07, '20-39': 91.3, '40-59': 89.45, '60-79': 90.28, '80-99': 91.82, 'old': 89.99, 'new': 91.82}
2024-04-24 03:08:26,147 [trainer.py] => CNN top1 curve: [95.95, 94.27, 90.62, 90.32, 89.23]
2024-04-24 03:08:26,147 [trainer.py] => CNN top5 curve: [99.6, 99.56, 98.96, 98.15, 98.32]
2024-04-24 03:08:26,147 [trainer.py] => NME top1 curve: [96.76, 94.49, 93.15, 90.97, 90.4]
2024-04-24 03:08:26,147 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.4, 98.91, 98.74]

Average Accuracy (CNN): 92.08
Average Accuracy (NME): 93.15
2024-04-24 03:08:26,148 [trainer.py] => Average Accuracy (CNN): 92.08
2024-04-24 03:08:26,148 [trainer.py] => Average Accuracy (NME): 93.15
2024-04-24 03:08:26,148 [trainer.py] => Train Time: 0
2024-04-24 03:08:26,148 [trainer.py] => Test Time: 24.509999999999998 

2024-04-24 03:08:26,148 [trainer.py] => All params: 85875556
2024-04-24 03:08:26,149 [trainer.py] => Trainable params: 85875556
2024-04-24 03:08:26,150 [icarl.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.719, Train_accy 79.74, Test_accy 84.89:   0%|          | 0/20 [00:34<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.719, Train_accy 79.74, Test_accy 84.89:   5%|▌         | 1/20 [00:34<10:53, 34.38s/it]
Task 5, Epoch 2/20 => Loss 1.950, Train_accy 89.60:   5%|▌         | 1/20 [01:04<10:53, 34.38s/it]                 
Task 5, Epoch 2/20 => Loss 1.950, Train_accy 89.60:  10%|█         | 2/20 [01:04<09:29, 31.67s/it]
Task 5, Epoch 3/20 => Loss 1.905, Train_accy 91.26:  10%|█         | 2/20 [01:33<09:29, 31.67s/it]
Task 5, Epoch 3/20 => Loss 1.905, Train_accy 91.26:  15%|█▌        | 3/20 [01:33<08:43, 30.82s/it]
Task 5, Epoch 4/20 => Loss 1.828, Train_accy 92.92:  15%|█▌        | 3/20 [02:03<08:43, 30.82s/it]
Task 5, Epoch 4/20 => Loss 1.828, Train_accy 92.92:  20%|██        | 4/20 [02:03<08:06, 30.42s/it]
Task 5, Epoch 5/20 => Loss 1.851, Train_accy 92.68:  20%|██        | 4/20 [02:33<08:06, 30.42s/it]
Task 5, Epoch 5/20 => Loss 1.851, Train_accy 92.68:  25%|██▌       | 5/20 [02:33<07:32, 30.20s/it]
Task 5, Epoch 6/20 => Loss 1.837, Train_accy 93.53, Test_accy 87.08:  25%|██▌       | 5/20 [03:07<07:32, 30.20s/it]
Task 5, Epoch 6/20 => Loss 1.837, Train_accy 93.53, Test_accy 87.08:  30%|███       | 6/20 [03:07<07:21, 31.56s/it]
Task 5, Epoch 7/20 => Loss 1.844, Train_accy 93.50:  30%|███       | 6/20 [03:37<07:21, 31.56s/it]                 
Task 5, Epoch 7/20 => Loss 1.844, Train_accy 93.50:  35%|███▌      | 7/20 [03:37<06:42, 30.99s/it]
Task 5, Epoch 8/20 => Loss 1.796, Train_accy 93.87:  35%|███▌      | 7/20 [04:07<06:42, 30.99s/it]
Task 5, Epoch 8/20 => Loss 1.796, Train_accy 93.87:  40%|████      | 8/20 [04:07<06:07, 30.61s/it]
Task 5, Epoch 9/20 => Loss 1.822, Train_accy 94.04:  40%|████      | 8/20 [04:37<06:07, 30.61s/it]
Task 5, Epoch 9/20 => Loss 1.822, Train_accy 94.04:  45%|████▌     | 9/20 [04:37<05:33, 30.35s/it]
Task 5, Epoch 10/20 => Loss 1.851, Train_accy 93.80:  45%|████▌     | 9/20 [05:07<05:33, 30.35s/it]
Task 5, Epoch 10/20 => Loss 1.851, Train_accy 93.80:  50%|█████     | 10/20 [05:07<05:01, 30.19s/it]
Task 5, Epoch 11/20 => Loss 1.811, Train_accy 94.44, Test_accy 87.29:  50%|█████     | 10/20 [05:41<05:01, 30.19s/it]
Task 5, Epoch 11/20 => Loss 1.811, Train_accy 94.44, Test_accy 87.29:  55%|█████▌    | 11/20 [05:41<04:42, 31.42s/it]
Task 5, Epoch 12/20 => Loss 1.815, Train_accy 94.68:  55%|█████▌    | 11/20 [06:11<04:42, 31.42s/it]                 
Task 5, Epoch 12/20 => Loss 1.815, Train_accy 94.68:  60%|██████    | 12/20 [06:11<04:07, 30.94s/it]
Task 5, Epoch 13/20 => Loss 1.807, Train_accy 94.24:  60%|██████    | 12/20 [06:40<04:07, 30.94s/it]
Task 5, Epoch 13/20 => Loss 1.807, Train_accy 94.24:  65%|██████▌   | 13/20 [06:40<03:34, 30.59s/it]
Task 5, Epoch 14/20 => Loss 1.729, Train_accy 94.68:  65%|██████▌   | 13/20 [07:10<03:34, 30.59s/it]
Task 5, Epoch 14/20 => Loss 1.729, Train_accy 94.68:  70%|███████   | 14/20 [07:10<03:02, 30.35s/it]
Task 5, Epoch 15/20 => Loss 1.770, Train_accy 95.22:  70%|███████   | 14/20 [07:40<03:02, 30.35s/it]
Task 5, Epoch 15/20 => Loss 1.770, Train_accy 95.22:  75%|███████▌  | 15/20 [07:40<02:30, 30.18s/it]
Task 5, Epoch 16/20 => Loss 1.770, Train_accy 95.09, Test_accy 86.23:  75%|███████▌  | 15/20 [08:15<02:30, 30.18s/it]
Task 5, Epoch 16/20 => Loss 1.770, Train_accy 95.09, Test_accy 86.23:  80%|████████  | 16/20 [08:15<02:06, 31.52s/it]
Task 5, Epoch 17/20 => Loss 1.760, Train_accy 94.99:  80%|████████  | 16/20 [08:45<02:06, 31.52s/it]                 
Task 5, Epoch 17/20 => Loss 1.760, Train_accy 94.99:  85%|████████▌ | 17/20 [08:45<01:33, 31.06s/it]
Task 5, Epoch 18/20 => Loss 1.813, Train_accy 94.72:  85%|████████▌ | 17/20 [09:14<01:33, 31.06s/it]
Task 5, Epoch 18/20 => Loss 1.813, Train_accy 94.72:  90%|█████████ | 18/20 [09:14<01:01, 30.71s/it]
Task 5, Epoch 19/20 => Loss 1.762, Train_accy 94.72:  90%|█████████ | 18/20 [09:44<01:01, 30.71s/it]
Task 5, Epoch 19/20 => Loss 1.762, Train_accy 94.72:  95%|█████████▌| 19/20 [09:44<00:30, 30.45s/it]
Task 5, Epoch 20/20 => Loss 1.766, Train_accy 94.78:  95%|█████████▌| 19/20 [10:14<00:30, 30.45s/it]
Task 5, Epoch 20/20 => Loss 1.766, Train_accy 94.78: 100%|██████████| 20/20 [10:14<00:00, 30.25s/it]
Task 5, Epoch 20/20 => Loss 1.766, Train_accy 94.78: 100%|██████████| 20/20 [10:14<00:00, 30.73s/it]
2024-04-24 03:18:40,722 [icarl.py] => Task 5, Epoch 20/20 => Loss 1.766, Train_accy 94.78
2024-04-24 03:18:40,723 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 03:19:37,954 [icarl.py] => Exemplar size: 2400
2024-04-24 03:19:37,955 [trainer.py] => CNN: {'total': 86.79, '00-19': 82.19, '20-39': 85.02, '40-59': 83.49, '60-79': 87.04, '80-99': 92.19, '100-119': 89.91, 'old': 86.2, 'new': 89.91}
2024-04-24 03:19:37,955 [trainer.py] => NME: {'total': 88.56, '00-19': 85.02, '20-39': 87.92, '40-59': 89.45, '60-79': 89.07, '80-99': 92.19, '100-119': 87.28, 'old': 88.8, 'new': 87.28}
2024-04-24 03:19:37,955 [trainer.py] => CNN top1 curve: [95.95, 94.27, 90.62, 90.32, 89.23, 86.79]
2024-04-24 03:19:37,955 [trainer.py] => CNN top5 curve: [99.6, 99.56, 98.96, 98.15, 98.32, 97.95]
2024-04-24 03:19:37,955 [trainer.py] => NME top1 curve: [96.76, 94.49, 93.15, 90.97, 90.4, 88.56]
2024-04-24 03:19:37,955 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.4, 98.91, 98.74, 98.52]

Average Accuracy (CNN): 91.2
Average Accuracy (NME): 92.39
2024-04-24 03:19:37,955 [trainer.py] => Average Accuracy (CNN): 91.2
2024-04-24 03:19:37,955 [trainer.py] => Average Accuracy (NME): 92.39
2024-04-24 03:19:37,955 [trainer.py] => Train Time: 0
2024-04-24 03:19:37,955 [trainer.py] => Test Time: 33.48 

2024-04-24 03:19:37,955 [trainer.py] => All params: 85890936
2024-04-24 03:19:37,956 [trainer.py] => Trainable params: 85890936
2024-04-24 03:19:37,957 [icarl.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.691, Train_accy 81.45, Test_accy 85.50:   0%|          | 0/20 [00:38<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.691, Train_accy 81.45, Test_accy 85.50:   5%|▌         | 1/20 [00:38<12:18, 38.89s/it]
Task 6, Epoch 2/20 => Loss 2.098, Train_accy 89.27:   5%|▌         | 1/20 [01:12<12:18, 38.89s/it]                 
Task 6, Epoch 2/20 => Loss 2.098, Train_accy 89.27:  10%|█         | 2/20 [01:12<10:48, 36.02s/it]
Task 6, Epoch 3/20 => Loss 2.025, Train_accy 91.26:  10%|█         | 2/20 [01:46<10:48, 36.02s/it]
Task 6, Epoch 3/20 => Loss 2.025, Train_accy 91.26:  15%|█▌        | 3/20 [01:46<09:56, 35.12s/it]
Task 6, Epoch 4/20 => Loss 1.994, Train_accy 91.98:  15%|█▌        | 3/20 [02:20<09:56, 35.12s/it]
Task 6, Epoch 4/20 => Loss 1.994, Train_accy 91.98:  20%|██        | 4/20 [02:20<09:14, 34.64s/it]
Task 6, Epoch 5/20 => Loss 1.947, Train_accy 92.96:  20%|██        | 4/20 [02:54<09:14, 34.64s/it]
Task 6, Epoch 5/20 => Loss 1.947, Train_accy 92.96:  25%|██▌       | 5/20 [02:54<08:35, 34.37s/it]
Task 6, Epoch 6/20 => Loss 1.948, Train_accy 93.41, Test_accy 85.01:  25%|██▌       | 5/20 [03:33<08:35, 34.37s/it]
Task 6, Epoch 6/20 => Loss 1.948, Train_accy 93.41, Test_accy 85.01:  30%|███       | 6/20 [03:33<08:22, 35.88s/it]
Task 6, Epoch 7/20 => Loss 1.958, Train_accy 93.41:  30%|███       | 6/20 [04:07<08:22, 35.88s/it]                 
Task 6, Epoch 7/20 => Loss 1.958, Train_accy 93.41:  35%|███▌      | 7/20 [04:07<07:37, 35.20s/it]
Task 6, Epoch 8/20 => Loss 1.893, Train_accy 94.31:  35%|███▌      | 7/20 [04:41<07:37, 35.20s/it]
Task 6, Epoch 8/20 => Loss 1.893, Train_accy 94.31:  40%|████      | 8/20 [04:41<06:57, 34.78s/it]
Task 6, Epoch 9/20 => Loss 1.943, Train_accy 93.50:  40%|████      | 8/20 [05:15<06:57, 34.78s/it]
Task 6, Epoch 9/20 => Loss 1.943, Train_accy 93.50:  45%|████▌     | 9/20 [05:15<06:19, 34.51s/it]
Task 6, Epoch 10/20 => Loss 1.943, Train_accy 93.65:  45%|████▌     | 9/20 [05:49<06:19, 34.51s/it]
Task 6, Epoch 10/20 => Loss 1.943, Train_accy 93.65:  50%|█████     | 10/20 [05:49<05:43, 34.32s/it]
Task 6, Epoch 11/20 => Loss 1.911, Train_accy 93.98, Test_accy 85.37:  50%|█████     | 10/20 [06:28<05:43, 34.32s/it]
Task 6, Epoch 11/20 => Loss 1.911, Train_accy 93.98, Test_accy 85.37:  55%|█████▌    | 11/20 [06:28<05:21, 35.74s/it]
Task 6, Epoch 12/20 => Loss 1.928, Train_accy 94.16:  55%|█████▌    | 11/20 [07:01<05:21, 35.74s/it]                 
Task 6, Epoch 12/20 => Loss 1.928, Train_accy 94.16:  60%|██████    | 12/20 [07:01<04:41, 35.18s/it]
Task 6, Epoch 13/20 => Loss 1.923, Train_accy 94.57:  60%|██████    | 12/20 [07:36<04:41, 35.18s/it]
Task 6, Epoch 13/20 => Loss 1.923, Train_accy 94.57:  65%|██████▌   | 13/20 [07:36<04:03, 34.85s/it]
Task 6, Epoch 14/20 => Loss 1.934, Train_accy 94.13:  65%|██████▌   | 13/20 [08:09<04:03, 34.85s/it]
Task 6, Epoch 14/20 => Loss 1.934, Train_accy 94.13:  70%|███████   | 14/20 [08:09<03:27, 34.58s/it]
Task 6, Epoch 15/20 => Loss 1.923, Train_accy 94.63:  70%|███████   | 14/20 [08:43<03:27, 34.58s/it]
Task 6, Epoch 15/20 => Loss 1.923, Train_accy 94.63:  75%|███████▌  | 15/20 [08:43<02:51, 34.38s/it]
Task 6, Epoch 16/20 => Loss 1.848, Train_accy 95.23, Test_accy 85.44:  75%|███████▌  | 15/20 [09:22<02:51, 34.38s/it]
Task 6, Epoch 16/20 => Loss 1.848, Train_accy 95.23, Test_accy 85.44:  80%|████████  | 16/20 [09:22<02:23, 35.76s/it]
Task 6, Epoch 17/20 => Loss 1.966, Train_accy 94.10:  80%|████████  | 16/20 [09:56<02:23, 35.76s/it]                 
Task 6, Epoch 17/20 => Loss 1.966, Train_accy 94.10:  85%|████████▌ | 17/20 [09:56<01:45, 35.19s/it]
Task 6, Epoch 18/20 => Loss 1.894, Train_accy 94.93:  85%|████████▌ | 17/20 [10:30<01:45, 35.19s/it]
Task 6, Epoch 18/20 => Loss 1.894, Train_accy 94.93:  90%|█████████ | 18/20 [10:30<01:09, 34.77s/it]
Task 6, Epoch 19/20 => Loss 1.941, Train_accy 94.72:  90%|█████████ | 18/20 [11:04<01:09, 34.77s/it]
Task 6, Epoch 19/20 => Loss 1.941, Train_accy 94.72:  95%|█████████▌| 19/20 [11:04<00:34, 34.48s/it]
Task 6, Epoch 20/20 => Loss 1.911, Train_accy 94.60:  95%|█████████▌| 19/20 [11:38<00:34, 34.48s/it]
Task 6, Epoch 20/20 => Loss 1.911, Train_accy 94.60: 100%|██████████| 20/20 [11:38<00:00, 34.29s/it]
Task 6, Epoch 20/20 => Loss 1.911, Train_accy 94.60: 100%|██████████| 20/20 [11:38<00:00, 34.91s/it]
2024-04-24 03:31:16,116 [icarl.py] => Task 6, Epoch 20/20 => Loss 1.911, Train_accy 94.60
2024-04-24 03:31:16,118 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 03:32:22,412 [icarl.py] => Exemplar size: 2800
2024-04-24 03:32:22,413 [trainer.py] => CNN: {'total': 85.25, '00-19': 80.97, '20-39': 82.61, '40-59': 80.73, '60-79': 85.83, '80-99': 88.85, '100-119': 86.4, '120-139': 90.67, 'old': 84.39, 'new': 90.67}
2024-04-24 03:32:22,413 [trainer.py] => NME: {'total': 87.45, '00-19': 85.83, '20-39': 89.37, '40-59': 85.32, '60-79': 88.26, '80-99': 90.71, '100-119': 86.84, '120-139': 85.33, 'old': 87.78, 'new': 85.33}
2024-04-24 03:32:22,413 [trainer.py] => CNN top1 curve: [95.95, 94.27, 90.62, 90.32, 89.23, 86.79, 85.25]
2024-04-24 03:32:22,413 [trainer.py] => CNN top5 curve: [99.6, 99.56, 98.96, 98.15, 98.32, 97.95, 97.07]
2024-04-24 03:32:22,413 [trainer.py] => NME top1 curve: [96.76, 94.49, 93.15, 90.97, 90.4, 88.56, 87.45]
2024-04-24 03:32:22,413 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.4, 98.91, 98.74, 98.52, 98.23]

Average Accuracy (CNN): 90.35
Average Accuracy (NME): 91.68
2024-04-24 03:32:22,413 [trainer.py] => Average Accuracy (CNN): 90.35
2024-04-24 03:32:22,413 [trainer.py] => Average Accuracy (NME): 91.68
2024-04-24 03:32:22,413 [trainer.py] => Train Time: 0
2024-04-24 03:32:22,413 [trainer.py] => Test Time: 43.739999999999995 

2024-04-24 03:32:22,414 [trainer.py] => All params: 85906316
2024-04-24 03:32:22,414 [trainer.py] => Trainable params: 85906316
2024-04-24 03:32:22,416 [icarl.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.738, Train_accy 82.34, Test_accy 83.45:   0%|          | 0/20 [00:43<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.738, Train_accy 82.34, Test_accy 83.45:   5%|▌         | 1/20 [00:43<13:41, 43.26s/it]
Task 7, Epoch 2/20 => Loss 2.120, Train_accy 90.83:   5%|▌         | 1/20 [01:20<13:41, 43.26s/it]                 
Task 7, Epoch 2/20 => Loss 2.120, Train_accy 90.83:  10%|█         | 2/20 [01:20<11:57, 39.86s/it]
Task 7, Epoch 3/20 => Loss 2.000, Train_accy 92.96:  10%|█         | 2/20 [01:58<11:57, 39.86s/it]
Task 7, Epoch 3/20 => Loss 2.000, Train_accy 92.96:  15%|█▌        | 3/20 [01:58<10:59, 38.77s/it]
Task 7, Epoch 4/20 => Loss 1.982, Train_accy 93.04:  15%|█▌        | 3/20 [02:35<10:59, 38.77s/it]
Task 7, Epoch 4/20 => Loss 1.982, Train_accy 93.04:  20%|██        | 4/20 [02:35<10:11, 38.22s/it]
Task 7, Epoch 5/20 => Loss 2.025, Train_accy 93.20:  20%|██        | 4/20 [03:13<10:11, 38.22s/it]
Task 7, Epoch 5/20 => Loss 2.025, Train_accy 93.20:  25%|██▌       | 5/20 [03:13<09:29, 37.94s/it]
Task 7, Epoch 6/20 => Loss 1.968, Train_accy 94.22, Test_accy 84.29:  25%|██▌       | 5/20 [03:56<09:29, 37.94s/it]
Task 7, Epoch 6/20 => Loss 1.968, Train_accy 94.22, Test_accy 84.29:  30%|███       | 6/20 [03:56<09:15, 39.71s/it]
Task 7, Epoch 7/20 => Loss 2.004, Train_accy 93.74:  30%|███       | 6/20 [04:33<09:15, 39.71s/it]                 
Task 7, Epoch 7/20 => Loss 2.004, Train_accy 93.74:  35%|███▌      | 7/20 [04:33<08:26, 38.98s/it]
Task 7, Epoch 8/20 => Loss 1.929, Train_accy 94.52:  35%|███▌      | 7/20 [05:11<08:26, 38.98s/it]
Task 7, Epoch 8/20 => Loss 1.929, Train_accy 94.52:  40%|████      | 8/20 [05:11<07:42, 38.58s/it]
Task 7, Epoch 9/20 => Loss 1.983, Train_accy 94.57:  40%|████      | 8/20 [05:49<07:42, 38.58s/it]
Task 7, Epoch 9/20 => Loss 1.983, Train_accy 94.57:  45%|████▌     | 9/20 [05:49<07:01, 38.30s/it]
Task 7, Epoch 10/20 => Loss 2.000, Train_accy 94.01:  45%|████▌     | 9/20 [06:26<07:01, 38.30s/it]
Task 7, Epoch 10/20 => Loss 2.000, Train_accy 94.01:  50%|█████     | 10/20 [06:26<06:21, 38.11s/it]
Task 7, Epoch 11/20 => Loss 1.978, Train_accy 94.41, Test_accy 84.45:  50%|█████     | 10/20 [07:10<06:21, 38.11s/it]
Task 7, Epoch 11/20 => Loss 1.978, Train_accy 94.41, Test_accy 84.45:  55%|█████▌    | 11/20 [07:10<05:57, 39.72s/it]
Task 7, Epoch 12/20 => Loss 1.965, Train_accy 94.25:  55%|█████▌    | 11/20 [07:47<05:57, 39.72s/it]                 
Task 7, Epoch 12/20 => Loss 1.965, Train_accy 94.25:  60%|██████    | 12/20 [07:47<05:12, 39.05s/it]
Task 7, Epoch 13/20 => Loss 1.949, Train_accy 95.03:  60%|██████    | 12/20 [08:25<05:12, 39.05s/it]
Task 7, Epoch 13/20 => Loss 1.949, Train_accy 95.03:  65%|██████▌   | 13/20 [08:25<04:30, 38.59s/it]
Task 7, Epoch 14/20 => Loss 1.989, Train_accy 94.19:  65%|██████▌   | 13/20 [09:02<04:30, 38.59s/it]
Task 7, Epoch 14/20 => Loss 1.989, Train_accy 94.19:  70%|███████   | 14/20 [09:02<03:49, 38.26s/it]
Task 7, Epoch 15/20 => Loss 1.942, Train_accy 94.49:  70%|███████   | 14/20 [09:40<03:49, 38.26s/it]
Task 7, Epoch 15/20 => Loss 1.942, Train_accy 94.49:  75%|███████▌  | 15/20 [09:40<03:10, 38.06s/it]
Task 7, Epoch 16/20 => Loss 1.953, Train_accy 94.92, Test_accy 84.45:  75%|███████▌  | 15/20 [10:23<03:10, 38.06s/it]
Task 7, Epoch 16/20 => Loss 1.953, Train_accy 94.92, Test_accy 84.45:  80%|████████  | 16/20 [10:23<02:38, 39.62s/it]
Task 7, Epoch 17/20 => Loss 1.892, Train_accy 95.59:  80%|████████  | 16/20 [11:01<02:38, 39.62s/it]                 
Task 7, Epoch 17/20 => Loss 1.892, Train_accy 95.59:  85%|████████▌ | 17/20 [11:01<01:56, 38.99s/it]
Task 7, Epoch 18/20 => Loss 1.900, Train_accy 95.16:  85%|████████▌ | 17/20 [11:38<01:56, 38.99s/it]
Task 7, Epoch 18/20 => Loss 1.900, Train_accy 95.16:  90%|█████████ | 18/20 [11:38<01:17, 38.56s/it]
Task 7, Epoch 19/20 => Loss 1.916, Train_accy 95.51:  90%|█████████ | 18/20 [12:15<01:17, 38.56s/it]
Task 7, Epoch 19/20 => Loss 1.916, Train_accy 95.51:  95%|█████████▌| 19/20 [12:15<00:38, 38.21s/it]
Task 7, Epoch 20/20 => Loss 1.933, Train_accy 95.22:  95%|█████████▌| 19/20 [12:53<00:38, 38.21s/it]
Task 7, Epoch 20/20 => Loss 1.933, Train_accy 95.22: 100%|██████████| 20/20 [12:53<00:00, 37.98s/it]
Task 7, Epoch 20/20 => Loss 1.933, Train_accy 95.22: 100%|██████████| 20/20 [12:53<00:00, 38.67s/it]
2024-04-24 03:45:15,838 [icarl.py] => Task 7, Epoch 20/20 => Loss 1.933, Train_accy 95.22
2024-04-24 03:45:15,840 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 03:46:28,313 [icarl.py] => Exemplar size: 3200
2024-04-24 03:46:28,314 [trainer.py] => CNN: {'total': 84.14, '00-19': 76.52, '20-39': 82.61, '40-59': 74.77, '60-79': 83.81, '80-99': 84.76, '100-119': 85.53, '120-139': 88.0, '140-159': 96.0, 'old': 82.33, 'new': 96.0}
2024-04-24 03:46:28,314 [trainer.py] => NME: {'total': 87.31, '00-19': 84.62, '20-39': 88.41, '40-59': 85.78, '60-79': 85.83, '80-99': 90.33, '100-119': 87.28, '120-139': 84.44, '140-159': 91.2, 'old': 86.72, 'new': 91.2}
2024-04-24 03:46:28,314 [trainer.py] => CNN top1 curve: [95.95, 94.27, 90.62, 90.32, 89.23, 86.79, 85.25, 84.14]
2024-04-24 03:46:28,314 [trainer.py] => CNN top5 curve: [99.6, 99.56, 98.96, 98.15, 98.32, 97.95, 97.07, 96.99]
2024-04-24 03:46:28,314 [trainer.py] => NME top1 curve: [96.76, 94.49, 93.15, 90.97, 90.4, 88.56, 87.45, 87.31]
2024-04-24 03:46:28,314 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.4, 98.91, 98.74, 98.52, 98.23, 98.31]

Average Accuracy (CNN): 89.57
Average Accuracy (NME): 91.14
2024-04-24 03:46:28,314 [trainer.py] => Average Accuracy (CNN): 89.57
2024-04-24 03:46:28,314 [trainer.py] => Average Accuracy (NME): 91.14
2024-04-24 03:46:28,314 [trainer.py] => Train Time: 0
2024-04-24 03:46:28,314 [trainer.py] => Test Time: 55.379999999999995 

2024-04-24 03:46:28,315 [trainer.py] => All params: 85921696
2024-04-24 03:46:28,315 [trainer.py] => Trainable params: 85921696
2024-04-24 03:46:28,317 [icarl.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.636, Train_accy 84.27, Test_accy 80.83:   0%|          | 0/20 [00:48<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.636, Train_accy 84.27, Test_accy 80.83:   5%|▌         | 1/20 [00:48<15:22, 48.55s/it]
Task 8, Epoch 2/20 => Loss 2.131, Train_accy 91.77:   5%|▌         | 1/20 [01:30<15:22, 48.55s/it]                 
Task 8, Epoch 2/20 => Loss 2.131, Train_accy 91.77:  10%|█         | 2/20 [01:30<13:24, 44.67s/it]
Task 8, Epoch 3/20 => Loss 2.146, Train_accy 92.23:  10%|█         | 2/20 [02:12<13:24, 44.67s/it]
Task 8, Epoch 3/20 => Loss 2.146, Train_accy 92.23:  15%|█▌        | 3/20 [02:12<12:17, 43.36s/it]
Task 8, Epoch 4/20 => Loss 2.083, Train_accy 93.29:  15%|█▌        | 3/20 [02:54<12:17, 43.36s/it]
Task 8, Epoch 4/20 => Loss 2.083, Train_accy 93.29:  20%|██        | 4/20 [02:54<11:24, 42.79s/it]
Task 8, Epoch 5/20 => Loss 2.049, Train_accy 94.30:  20%|██        | 4/20 [03:35<11:24, 42.79s/it]
Task 8, Epoch 5/20 => Loss 2.049, Train_accy 94.30:  25%|██▌       | 5/20 [03:35<10:36, 42.42s/it]
Task 8, Epoch 6/20 => Loss 2.001, Train_accy 94.81, Test_accy 82.38:  25%|██▌       | 5/20 [04:24<10:36, 42.42s/it]
Task 8, Epoch 6/20 => Loss 2.001, Train_accy 94.81, Test_accy 82.38:  30%|███       | 6/20 [04:24<10:21, 44.38s/it]
Task 8, Epoch 7/20 => Loss 2.052, Train_accy 94.11:  30%|███       | 6/20 [05:06<10:21, 44.38s/it]                 
Task 8, Epoch 7/20 => Loss 2.052, Train_accy 94.11:  35%|███▌      | 7/20 [05:06<09:26, 43.59s/it]
Task 8, Epoch 8/20 => Loss 2.109, Train_accy 93.63:  35%|███▌      | 7/20 [05:48<09:26, 43.59s/it]
Task 8, Epoch 8/20 => Loss 2.109, Train_accy 93.63:  40%|████      | 8/20 [05:48<08:36, 43.04s/it]
Task 8, Epoch 9/20 => Loss 2.024, Train_accy 94.37:  40%|████      | 8/20 [06:29<08:36, 43.04s/it]
Task 8, Epoch 9/20 => Loss 2.024, Train_accy 94.37:  45%|████▌     | 9/20 [06:29<07:49, 42.65s/it]
Task 8, Epoch 10/20 => Loss 2.016, Train_accy 95.07:  45%|████▌     | 9/20 [07:11<07:49, 42.65s/it]
Task 8, Epoch 10/20 => Loss 2.016, Train_accy 95.07:  50%|█████     | 10/20 [07:11<07:03, 42.39s/it]
Task 8, Epoch 11/20 => Loss 1.993, Train_accy 95.09, Test_accy 81.67:  50%|█████     | 10/20 [08:00<07:03, 42.39s/it]
Task 8, Epoch 11/20 => Loss 1.993, Train_accy 95.09, Test_accy 81.67:  55%|█████▌    | 11/20 [08:00<06:38, 44.26s/it]
Task 8, Epoch 12/20 => Loss 2.010, Train_accy 94.95:  55%|█████▌    | 11/20 [08:41<06:38, 44.26s/it]                 
Task 8, Epoch 12/20 => Loss 2.010, Train_accy 94.95:  60%|██████    | 12/20 [08:41<05:48, 43.52s/it]
Task 8, Epoch 13/20 => Loss 2.033, Train_accy 94.61:  60%|██████    | 12/20 [09:23<05:48, 43.52s/it]
Task 8, Epoch 13/20 => Loss 2.033, Train_accy 94.61:  65%|██████▌   | 13/20 [09:23<05:01, 43.07s/it]
Task 8, Epoch 14/20 => Loss 1.999, Train_accy 94.85:  65%|██████▌   | 13/20 [10:05<05:01, 43.07s/it]
Task 8, Epoch 14/20 => Loss 1.999, Train_accy 94.85:  70%|███████   | 14/20 [10:05<04:16, 42.70s/it]
Task 8, Epoch 15/20 => Loss 1.997, Train_accy 95.24:  70%|███████   | 14/20 [10:47<04:16, 42.70s/it]
Task 8, Epoch 15/20 => Loss 1.997, Train_accy 95.24:  75%|███████▌  | 15/20 [10:47<03:32, 42.45s/it]
Task 8, Epoch 16/20 => Loss 2.020, Train_accy 95.07, Test_accy 82.99:  75%|███████▌  | 15/20 [11:35<03:32, 42.45s/it]
Task 8, Epoch 16/20 => Loss 2.020, Train_accy 95.07, Test_accy 82.99:  80%|████████  | 16/20 [11:35<02:56, 44.20s/it]
Task 8, Epoch 17/20 => Loss 1.964, Train_accy 95.62:  80%|████████  | 16/20 [12:17<02:56, 44.20s/it]                 
Task 8, Epoch 17/20 => Loss 1.964, Train_accy 95.62:  85%|████████▌ | 17/20 [12:17<02:10, 43.53s/it]
Task 8, Epoch 18/20 => Loss 1.982, Train_accy 95.65:  85%|████████▌ | 17/20 [12:59<02:10, 43.53s/it]
Task 8, Epoch 18/20 => Loss 1.982, Train_accy 95.65:  90%|█████████ | 18/20 [12:59<01:26, 43.06s/it]
Task 8, Epoch 19/20 => Loss 2.065, Train_accy 94.40:  90%|█████████ | 18/20 [13:41<01:26, 43.06s/it]
Task 8, Epoch 19/20 => Loss 2.065, Train_accy 94.40:  95%|█████████▌| 19/20 [13:41<00:42, 42.70s/it]
Task 8, Epoch 20/20 => Loss 1.992, Train_accy 95.43:  95%|█████████▌| 19/20 [14:23<00:42, 42.70s/it]
Task 8, Epoch 20/20 => Loss 1.992, Train_accy 95.43: 100%|██████████| 20/20 [14:23<00:00, 42.44s/it]
Task 8, Epoch 20/20 => Loss 1.992, Train_accy 95.43: 100%|██████████| 20/20 [14:23<00:00, 43.18s/it]
2024-04-24 04:00:51,888 [icarl.py] => Task 8, Epoch 20/20 => Loss 1.992, Train_accy 95.43
2024-04-24 04:00:51,890 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 04:02:11,158 [icarl.py] => Exemplar size: 3600
2024-04-24 04:02:11,159 [trainer.py] => CNN: {'total': 82.75, '00-19': 75.3, '20-39': 81.64, '40-59': 73.39, '60-79': 80.16, '80-99': 82.9, '100-119': 83.33, '120-139': 82.67, '140-159': 89.2, '160-179': 95.36, 'old': 81.17, 'new': 95.36}
2024-04-24 04:02:11,159 [trainer.py] => NME: {'total': 87.08, '00-19': 84.21, '20-39': 87.92, '40-59': 87.61, '60-79': 86.64, '80-99': 90.71, '100-119': 84.65, '120-139': 83.56, '140-159': 88.0, '160-179': 89.87, 'old': 86.73, 'new': 89.87}
2024-04-24 04:02:11,159 [trainer.py] => CNN top1 curve: [95.95, 94.27, 90.62, 90.32, 89.23, 86.79, 85.25, 84.14, 82.75]
2024-04-24 04:02:11,159 [trainer.py] => CNN top5 curve: [99.6, 99.56, 98.96, 98.15, 98.32, 97.95, 97.07, 96.99, 96.43]
2024-04-24 04:02:11,159 [trainer.py] => NME top1 curve: [96.76, 94.49, 93.15, 90.97, 90.4, 88.56, 87.45, 87.31, 87.08]
2024-04-24 04:02:11,159 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.4, 98.91, 98.74, 98.52, 98.23, 98.31, 98.17]

Average Accuracy (CNN): 88.81
Average Accuracy (NME): 90.69
2024-04-24 04:02:11,159 [trainer.py] => Average Accuracy (CNN): 88.81
2024-04-24 04:02:11,159 [trainer.py] => Average Accuracy (NME): 90.69
2024-04-24 04:02:11,159 [trainer.py] => Train Time: 0
2024-04-24 04:02:11,159 [trainer.py] => Test Time: 68.46 

2024-04-24 04:02:11,160 [trainer.py] => All params: 85937076
2024-04-24 04:02:11,160 [trainer.py] => Trainable params: 85937076
2024-04-24 04:02:11,162 [icarl.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.665, Train_accy 85.70, Test_accy 81.72:   0%|          | 0/20 [00:52<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.665, Train_accy 85.70, Test_accy 81.72:   5%|▌         | 1/20 [00:52<16:45, 52.94s/it]
Task 9, Epoch 2/20 => Loss 2.233, Train_accy 92.53:   5%|▌         | 1/20 [01:38<16:45, 52.94s/it]                 
Task 9, Epoch 2/20 => Loss 2.233, Train_accy 92.53:  10%|█         | 2/20 [01:38<14:37, 48.73s/it]
Task 9, Epoch 3/20 => Loss 2.190, Train_accy 93.08:  10%|█         | 2/20 [02:24<14:37, 48.73s/it]
Task 9, Epoch 3/20 => Loss 2.190, Train_accy 93.08:  15%|█▌        | 3/20 [02:24<13:24, 47.34s/it]
Task 9, Epoch 4/20 => Loss 2.172, Train_accy 93.72:  15%|█▌        | 3/20 [03:10<13:24, 47.34s/it]
Task 9, Epoch 4/20 => Loss 2.172, Train_accy 93.72:  20%|██        | 4/20 [03:10<12:27, 46.70s/it]
Task 9, Epoch 5/20 => Loss 2.130, Train_accy 94.05:  20%|██        | 4/20 [03:55<12:27, 46.70s/it]
Task 9, Epoch 5/20 => Loss 2.130, Train_accy 94.05:  25%|██▌       | 5/20 [03:55<11:35, 46.36s/it]
Task 9, Epoch 6/20 => Loss 2.123, Train_accy 94.99, Test_accy 81.89:  25%|██▌       | 5/20 [04:48<11:35, 46.36s/it]
Task 9, Epoch 6/20 => Loss 2.123, Train_accy 94.99, Test_accy 81.89:  30%|███       | 6/20 [04:48<11:19, 48.54s/it]
Task 9, Epoch 7/20 => Loss 2.100, Train_accy 95.23:  30%|███       | 6/20 [05:34<11:19, 48.54s/it]                 
Task 9, Epoch 7/20 => Loss 2.100, Train_accy 95.23:  35%|███▌      | 7/20 [05:34<10:18, 47.61s/it]
Task 9, Epoch 8/20 => Loss 2.172, Train_accy 94.51:  35%|███▌      | 7/20 [06:20<10:18, 47.61s/it]
Task 9, Epoch 8/20 => Loss 2.172, Train_accy 94.51:  40%|████      | 8/20 [06:20<09:24, 47.01s/it]
Task 9, Epoch 9/20 => Loss 2.150, Train_accy 94.40:  40%|████      | 8/20 [07:05<09:24, 47.01s/it]
Task 9, Epoch 9/20 => Loss 2.150, Train_accy 94.40:  45%|████▌     | 9/20 [07:05<08:32, 46.62s/it]
Task 9, Epoch 10/20 => Loss 2.140, Train_accy 95.19:  45%|████▌     | 9/20 [07:51<08:32, 46.62s/it]
Task 9, Epoch 10/20 => Loss 2.140, Train_accy 95.19:  50%|█████     | 10/20 [07:51<07:43, 46.34s/it]
Task 9, Epoch 11/20 => Loss 2.107, Train_accy 95.47, Test_accy 82.06:  50%|█████     | 10/20 [08:44<07:43, 46.34s/it]
Task 9, Epoch 11/20 => Loss 2.107, Train_accy 95.47, Test_accy 82.06:  55%|█████▌    | 11/20 [08:44<07:14, 48.31s/it]
Task 9, Epoch 12/20 => Loss 2.111, Train_accy 95.10:  55%|█████▌    | 11/20 [09:30<07:14, 48.31s/it]                 
Task 9, Epoch 12/20 => Loss 2.111, Train_accy 95.10:  60%|██████    | 12/20 [09:30<06:20, 47.54s/it]
Task 9, Epoch 13/20 => Loss 2.100, Train_accy 95.67:  60%|██████    | 12/20 [10:15<06:20, 47.54s/it]
Task 9, Epoch 13/20 => Loss 2.100, Train_accy 95.67:  65%|██████▌   | 13/20 [10:15<05:29, 47.02s/it]
Task 9, Epoch 14/20 => Loss 2.119, Train_accy 95.14:  65%|██████▌   | 13/20 [11:01<05:29, 47.02s/it]
Task 9, Epoch 14/20 => Loss 2.119, Train_accy 95.14:  70%|███████   | 14/20 [11:01<04:39, 46.65s/it]
Task 9, Epoch 15/20 => Loss 2.126, Train_accy 95.39:  70%|███████   | 14/20 [11:47<04:39, 46.65s/it]
Task 9, Epoch 15/20 => Loss 2.126, Train_accy 95.39:  75%|███████▌  | 15/20 [11:47<03:52, 46.42s/it]
Task 9, Epoch 16/20 => Loss 2.085, Train_accy 95.69, Test_accy 82.65:  75%|███████▌  | 15/20 [12:40<03:52, 46.42s/it]
Task 9, Epoch 16/20 => Loss 2.085, Train_accy 95.69, Test_accy 82.65:  80%|████████  | 16/20 [12:40<03:13, 48.34s/it]
Task 9, Epoch 17/20 => Loss 2.057, Train_accy 96.27:  80%|████████  | 16/20 [13:26<03:13, 48.34s/it]                 
Task 9, Epoch 17/20 => Loss 2.057, Train_accy 96.27:  85%|████████▌ | 17/20 [13:26<02:22, 47.59s/it]
Task 9, Epoch 18/20 => Loss 2.083, Train_accy 95.65:  85%|████████▌ | 17/20 [14:11<02:22, 47.59s/it]
Task 9, Epoch 18/20 => Loss 2.083, Train_accy 95.65:  90%|█████████ | 18/20 [14:11<01:34, 47.03s/it]
Task 9, Epoch 19/20 => Loss 2.068, Train_accy 95.80:  90%|█████████ | 18/20 [14:57<01:34, 47.03s/it]
Task 9, Epoch 19/20 => Loss 2.068, Train_accy 95.80:  95%|█████████▌| 19/20 [14:57<00:46, 46.69s/it]
Task 9, Epoch 20/20 => Loss 2.112, Train_accy 95.17:  95%|█████████▌| 19/20 [15:43<00:46, 46.69s/it]
Task 9, Epoch 20/20 => Loss 2.112, Train_accy 95.17: 100%|██████████| 20/20 [15:43<00:00, 46.40s/it]
Task 9, Epoch 20/20 => Loss 2.112, Train_accy 95.17: 100%|██████████| 20/20 [15:43<00:00, 47.18s/it]
2024-04-24 04:17:54,790 [icarl.py] => Task 9, Epoch 20/20 => Loss 2.112, Train_accy 95.17
2024-04-24 04:17:54,791 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-24 04:19:22,029 [icarl.py] => Exemplar size: 4000
2024-04-24 04:19:22,029 [trainer.py] => CNN: {'total': 83.38, '00-19': 76.11, '20-39': 78.26, '40-59': 80.28, '60-79': 80.16, '80-99': 81.78, '100-119': 85.09, '120-139': 79.56, '140-159': 90.8, '160-179': 91.98, '180-199': 89.13, 'old': 82.75, 'new': 89.13}
2024-04-24 04:19:22,029 [trainer.py] => NME: {'total': 86.47, '00-19': 84.62, '20-39': 86.47, '40-59': 86.24, '60-79': 84.21, '80-99': 88.85, '100-119': 86.84, '120-139': 81.78, '140-159': 88.4, '160-179': 90.72, '180-199': 86.09, 'old': 86.51, 'new': 86.09}
2024-04-24 04:19:22,029 [trainer.py] => CNN top1 curve: [95.95, 94.27, 90.62, 90.32, 89.23, 86.79, 85.25, 84.14, 82.75, 83.38]
2024-04-24 04:19:22,029 [trainer.py] => CNN top5 curve: [99.6, 99.56, 98.96, 98.15, 98.32, 97.95, 97.07, 96.99, 96.43, 95.93]
2024-04-24 04:19:22,029 [trainer.py] => NME top1 curve: [96.76, 94.49, 93.15, 90.97, 90.4, 88.56, 87.45, 87.31, 87.08, 86.47]
2024-04-24 04:19:22,029 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.4, 98.91, 98.74, 98.52, 98.23, 98.31, 98.17, 97.79]

Average Accuracy (CNN): 88.27
Average Accuracy (NME): 90.26
2024-04-24 04:19:22,030 [trainer.py] => Average Accuracy (CNN): 88.27
2024-04-24 04:19:22,030 [trainer.py] => Average Accuracy (NME): 90.26
2024-04-24 04:19:22,030 [trainer.py] => Train Time: 0
2024-04-24 04:19:22,030 [trainer.py] => Test Time: 82.72 

Accuracy Matrix (CNN):
[[95.95 94.74 87.45 85.83 83.   82.19 80.97 76.52 75.3  76.11]
 [ 0.   93.72 92.27 90.82 87.44 85.02 82.61 82.61 81.64 78.26]
 [ 0.    0.   92.66 89.45 87.16 83.49 80.73 74.77 73.39 80.28]
 [ 0.    0.    0.   95.14 91.09 87.04 85.83 83.81 80.16 80.16]
 [ 0.    0.    0.    0.   96.28 92.19 88.85 84.76 82.9  81.78]
 [ 0.    0.    0.    0.    0.   89.91 86.4  85.53 83.33 85.09]
 [ 0.    0.    0.    0.    0.    0.   90.67 88.   82.67 79.56]
 [ 0.    0.    0.    0.    0.    0.    0.   96.   89.2  90.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   95.36 91.98]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   89.13]]
2024-04-24 04:19:22,031 [trainer.py] => Forgetting (CNN): 11.296666666666665
Accuracy Matrix (NME):
[[96.76 94.74 92.71 88.66 89.07 85.02 85.83 84.62 84.21 84.62]
 [ 0.   94.2  94.2  92.27 91.3  87.92 89.37 88.41 87.92 86.47]
 [ 0.    0.   92.66 90.37 89.45 89.45 85.32 85.78 87.61 86.24]
 [ 0.    0.    0.   92.71 90.28 89.07 88.26 85.83 86.64 84.21]
 [ 0.    0.    0.    0.   91.82 92.19 90.71 90.33 90.71 88.85]
 [ 0.    0.    0.    0.    0.   87.28 86.84 87.28 84.65 86.84]
 [ 0.    0.    0.    0.    0.    0.   85.33 84.44 83.56 81.78]
 [ 0.    0.    0.    0.    0.    0.    0.   91.2  88.   88.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   89.87 90.72]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   86.09]]

nohup: 忽略输入
2024-04-22 21:30:37,872 [trainer.py] => config: ./exps/der_cub_B0.json
2024-04-22 21:30:37,873 [trainer.py] => prefix: reproduce
2024-04-22 21:30:37,873 [trainer.py] => dataset: cub
2024-04-22 21:30:37,873 [trainer.py] => memory_size: 4000
2024-04-22 21:30:37,873 [trainer.py] => memory_per_class: 20
2024-04-22 21:30:37,873 [trainer.py] => fixed_memory: True
2024-04-22 21:30:37,873 [trainer.py] => shuffle: True
2024-04-22 21:30:37,873 [trainer.py] => init_cls: 20
2024-04-22 21:30:37,873 [trainer.py] => increment: 20
2024-04-22 21:30:37,873 [trainer.py] => model_name: der
2024-04-22 21:30:37,873 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-22 21:30:37,873 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-22 21:30:37,873 [trainer.py] => seed: 1993
2024-04-22 21:30:37,873 [trainer.py] => init_epoch: 20
2024-04-22 21:30:37,873 [trainer.py] => init_lr: 0.001
2024-04-22 21:30:37,873 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-22 21:30:37,873 [trainer.py] => init_lr_decay: 0.1
2024-04-22 21:30:37,873 [trainer.py] => init_weight_decay: 0.0005
2024-04-22 21:30:37,874 [trainer.py] => epochs: 1
2024-04-22 21:30:37,874 [trainer.py] => lrate: 0.001
2024-04-22 21:30:37,874 [trainer.py] => milestones: [80, 120, 150]
2024-04-22 21:30:37,874 [trainer.py] => lrate_decay: 0.1
2024-04-22 21:30:37,874 [trainer.py] => batch_size: 48
2024-04-22 21:30:37,874 [trainer.py] => weight_decay: 0.0002
2024-04-22 21:30:37,874 [trainer.py] => T: 2
2024-04-22 21:30:37,931 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-22 21:30:38,318 [trainer.py] => All params: 0
2024-04-22 21:30:38,318 [trainer.py] => Trainable params: 0
2024-04-22 21:30:48,954 [der.py] => Learning on 0-20
2024-04-22 21:30:48,955 [der.py] => All params: 85830185
2024-04-22 21:30:48,956 [der.py] => Trainable params: 85830185

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.779, Train_accy 54.76, Test_accy 91.90:   0%|          | 0/20 [00:12<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.779, Train_accy 54.76, Test_accy 91.90:   5%|▌         | 1/20 [00:12<03:58, 12.55s/it]
Task 0, Epoch 2/20 => Loss 0.535, Train_accy 83.40:   5%|▌         | 1/20 [00:22<03:58, 12.55s/it]                 
Task 0, Epoch 2/20 => Loss 0.535, Train_accy 83.40:  10%|█         | 2/20 [00:22<03:21, 11.22s/it]
Task 0, Epoch 3/20 => Loss 0.366, Train_accy 88.48:  10%|█         | 2/20 [00:32<03:21, 11.22s/it]
Task 0, Epoch 3/20 => Loss 0.366, Train_accy 88.48:  15%|█▌        | 3/20 [00:32<02:59, 10.58s/it]
Task 0, Epoch 4/20 => Loss 0.281, Train_accy 91.44:  15%|█▌        | 3/20 [00:42<02:59, 10.58s/it]
Task 0, Epoch 4/20 => Loss 0.281, Train_accy 91.44:  20%|██        | 4/20 [00:42<02:45, 10.31s/it]
Task 0, Epoch 5/20 => Loss 0.253, Train_accy 92.39:  20%|██        | 4/20 [00:52<02:45, 10.31s/it]
Task 0, Epoch 5/20 => Loss 0.253, Train_accy 92.39:  25%|██▌       | 5/20 [00:52<02:32, 10.18s/it]
Task 0, Epoch 6/20 => Loss 0.229, Train_accy 93.02, Test_accy 95.95:  25%|██▌       | 5/20 [01:03<02:32, 10.18s/it]
Task 0, Epoch 6/20 => Loss 0.229, Train_accy 93.02, Test_accy 95.95:  30%|███       | 6/20 [01:03<02:27, 10.54s/it]
Task 0, Epoch 7/20 => Loss 0.194, Train_accy 93.45:  30%|███       | 6/20 [01:14<02:27, 10.54s/it]                 
Task 0, Epoch 7/20 => Loss 0.194, Train_accy 93.45:  35%|███▌      | 7/20 [01:14<02:18, 10.69s/it]
Task 0, Epoch 8/20 => Loss 0.155, Train_accy 95.03:  35%|███▌      | 7/20 [01:25<02:18, 10.69s/it]
Task 0, Epoch 8/20 => Loss 0.155, Train_accy 95.03:  40%|████      | 8/20 [01:25<02:09, 10.79s/it]
Task 0, Epoch 9/20 => Loss 0.140, Train_accy 96.30:  40%|████      | 8/20 [01:35<02:09, 10.79s/it]
Task 0, Epoch 9/20 => Loss 0.140, Train_accy 96.30:  45%|████▌     | 9/20 [01:35<01:56, 10.60s/it]
Task 0, Epoch 10/20 => Loss 0.170, Train_accy 95.03:  45%|████▌     | 9/20 [01:46<01:56, 10.60s/it]
Task 0, Epoch 10/20 => Loss 0.170, Train_accy 95.03:  50%|█████     | 10/20 [01:46<01:45, 10.57s/it]
Task 0, Epoch 11/20 => Loss 0.174, Train_accy 94.08, Test_accy 96.76:  50%|█████     | 10/20 [01:58<01:45, 10.57s/it]
Task 0, Epoch 11/20 => Loss 0.174, Train_accy 94.08, Test_accy 96.76:  55%|█████▌    | 11/20 [01:58<01:40, 11.16s/it]
Task 0, Epoch 12/20 => Loss 0.201, Train_accy 93.87:  55%|█████▌    | 11/20 [02:10<01:40, 11.16s/it]                 
Task 0, Epoch 12/20 => Loss 0.201, Train_accy 93.87:  60%|██████    | 12/20 [02:10<01:30, 11.27s/it]
Task 0, Epoch 13/20 => Loss 0.224, Train_accy 93.02:  60%|██████    | 12/20 [02:21<01:30, 11.27s/it]
Task 0, Epoch 13/20 => Loss 0.224, Train_accy 93.02:  65%|██████▌   | 13/20 [02:21<01:18, 11.19s/it]
Task 0, Epoch 14/20 => Loss 0.223, Train_accy 93.45:  65%|██████▌   | 13/20 [02:31<01:18, 11.19s/it]
Task 0, Epoch 14/20 => Loss 0.223, Train_accy 93.45:  70%|███████   | 14/20 [02:31<01:05, 10.87s/it]
Task 0, Epoch 15/20 => Loss 0.163, Train_accy 94.19:  70%|███████   | 14/20 [02:42<01:05, 10.87s/it]
Task 0, Epoch 15/20 => Loss 0.163, Train_accy 94.19:  75%|███████▌  | 15/20 [02:42<00:54, 10.83s/it]
Task 0, Epoch 16/20 => Loss 0.173, Train_accy 94.93, Test_accy 97.98:  75%|███████▌  | 15/20 [02:54<00:54, 10.83s/it]
Task 0, Epoch 16/20 => Loss 0.173, Train_accy 94.93, Test_accy 97.98:  80%|████████  | 16/20 [02:54<00:45, 11.35s/it]
Task 0, Epoch 17/20 => Loss 0.174, Train_accy 94.71:  80%|████████  | 16/20 [03:05<00:45, 11.35s/it]                 
Task 0, Epoch 17/20 => Loss 0.174, Train_accy 94.71:  85%|████████▌ | 17/20 [03:05<00:33, 11.06s/it]
Task 0, Epoch 18/20 => Loss 0.145, Train_accy 95.56:  85%|████████▌ | 17/20 [03:15<00:33, 11.06s/it]
Task 0, Epoch 18/20 => Loss 0.145, Train_accy 95.56:  90%|█████████ | 18/20 [03:15<00:21, 10.81s/it]
Task 0, Epoch 19/20 => Loss 0.162, Train_accy 95.03:  90%|█████████ | 18/20 [03:26<00:21, 10.81s/it]
Task 0, Epoch 19/20 => Loss 0.162, Train_accy 95.03:  95%|█████████▌| 19/20 [03:26<00:10, 10.76s/it]
Task 0, Epoch 20/20 => Loss 0.141, Train_accy 95.45:  95%|█████████▌| 19/20 [03:36<00:10, 10.76s/it]
Task 0, Epoch 20/20 => Loss 0.141, Train_accy 95.45: 100%|██████████| 20/20 [03:36<00:00, 10.60s/it]
Task 0, Epoch 20/20 => Loss 0.141, Train_accy 95.45: 100%|██████████| 20/20 [03:36<00:00, 10.82s/it]
2024-04-22 21:34:26,013 [der.py] => Task 0, Epoch 20/20 => Loss 0.141, Train_accy 95.45
2024-04-22 21:34:26,014 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 21:34:54,822 [der.py] => Exemplar size: 400
2024-04-22 21:34:54,822 [trainer.py] => CNN: {'total': 98.38, '00-19': 98.38, 'old': 0, 'new': 98.38}
2024-04-22 21:34:54,822 [trainer.py] => NME: {'total': 98.38, '00-19': 98.38, 'old': 0, 'new': 98.38}
2024-04-22 21:34:54,822 [trainer.py] => CNN top1 curve: [98.38]
2024-04-22 21:34:54,822 [trainer.py] => CNN top5 curve: [99.6]
2024-04-22 21:34:54,822 [trainer.py] => NME top1 curve: [98.38]
2024-04-22 21:34:54,823 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 98.38
Average Accuracy (NME): 98.38
2024-04-22 21:34:54,823 [trainer.py] => Average Accuracy (CNN): 98.38
2024-04-22 21:34:54,823 [trainer.py] => Average Accuracy (NME): 98.38
2024-04-22 21:34:54,823 [trainer.py] => Train Time: 217.06
2024-04-22 21:34:54,823 [trainer.py] => Test Time: 3.66 

2024-04-22 21:34:54,824 [trainer.py] => All params: 85830185
2024-04-22 21:34:54,825 [trainer.py] => Trainable params: 85830185
2024-04-22 21:35:05,442 [der.py] => Learning on 20-40
2024-04-22 21:35:05,445 [der.py] => All params: 171674941
2024-04-22 21:35:05,446 [der.py] => Trainable params: 85876285

  0%|          | 0/1 [00:00<?, ?it/s]
Task 1, Epoch 1/1 => Loss 3.708, Loss_clf 2.049, Loss_aux 1.660, Train_accy 57.10, Test_accy 82.60:   0%|          | 0/1 [00:23<?, ?it/s]
Task 1, Epoch 1/1 => Loss 3.708, Loss_clf 2.049, Loss_aux 1.660, Train_accy 57.10, Test_accy 82.60: 100%|██████████| 1/1 [00:23<00:00, 23.96s/it]
Task 1, Epoch 1/1 => Loss 3.708, Loss_clf 2.049, Loss_aux 1.660, Train_accy 57.10, Test_accy 82.60: 100%|██████████| 1/1 [00:23<00:00, 23.96s/it]
2024-04-22 21:35:29,467 [der.py] => Task 1, Epoch 1/1 => Loss 3.708, Loss_clf 2.049, Loss_aux 1.660, Train_accy 57.10, Test_accy 82.60
2024-04-22 21:35:29,468 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 21:36:21,605 [der.py] => Exemplar size: 800
2024-04-22 21:36:21,605 [trainer.py] => CNN: {'total': 82.6, '00-19': 86.23, '20-39': 78.26, 'old': 86.23, 'new': 78.26}
2024-04-22 21:36:21,605 [trainer.py] => NME: {'total': 96.7, '00-19': 97.17, '20-39': 96.14, 'old': 97.17, 'new': 96.14}
2024-04-22 21:36:21,605 [trainer.py] => CNN top1 curve: [98.38, 82.6]
2024-04-22 21:36:21,606 [trainer.py] => CNN top5 curve: [99.6, 98.24]
2024-04-22 21:36:21,606 [trainer.py] => NME top1 curve: [98.38, 96.7]
2024-04-22 21:36:21,606 [trainer.py] => NME top5 curve: [100.0, 99.34]

Average Accuracy (CNN): 90.49
Average Accuracy (NME): 97.54
2024-04-22 21:36:21,606 [trainer.py] => Average Accuracy (CNN): 90.49
2024-04-22 21:36:21,606 [trainer.py] => Average Accuracy (NME): 97.54
2024-04-22 21:36:21,606 [trainer.py] => Train Time: 241.08
2024-04-22 21:36:21,606 [trainer.py] => Test Time: 12.46 

2024-04-22 21:36:21,607 [trainer.py] => All params: 171674941
2024-04-22 21:36:21,609 [trainer.py] => Trainable params: 85876285
2024-04-22 21:36:31,742 [der.py] => Learning on 40-60
2024-04-22 21:36:31,745 [der.py] => All params: 257550417
2024-04-22 21:36:31,747 [der.py] => Trainable params: 85953105

  0%|          | 0/1 [00:00<?, ?it/s]
Task 2, Epoch 1/1 => Loss 3.433, Loss_clf 1.785, Loss_aux 1.648, Train_accy 59.72, Test_accy 84.82:   0%|          | 0/1 [00:41<?, ?it/s]
Task 2, Epoch 1/1 => Loss 3.433, Loss_clf 1.785, Loss_aux 1.648, Train_accy 59.72, Test_accy 84.82: 100%|██████████| 1/1 [00:41<00:00, 41.27s/it]
Task 2, Epoch 1/1 => Loss 3.433, Loss_clf 1.785, Loss_aux 1.648, Train_accy 59.72, Test_accy 84.82: 100%|██████████| 1/1 [00:41<00:00, 41.27s/it]
2024-04-22 21:37:13,133 [der.py] => Task 2, Epoch 1/1 => Loss 3.433, Loss_clf 1.785, Loss_aux 1.648, Train_accy 59.72, Test_accy 84.82
2024-04-22 21:37:13,135 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 21:38:35,445 [der.py] => Exemplar size: 1200
2024-04-22 21:38:35,445 [trainer.py] => CNN: {'total': 84.82, '00-19': 89.88, '20-39': 75.36, '40-59': 88.07, 'old': 83.26, 'new': 88.07}
2024-04-22 21:38:35,445 [trainer.py] => NME: {'total': 93.01, '00-19': 92.71, '20-39': 94.69, '40-59': 91.74, 'old': 93.61, 'new': 91.74}
2024-04-22 21:38:35,445 [trainer.py] => CNN top1 curve: [98.38, 82.6, 84.82]
2024-04-22 21:38:35,445 [trainer.py] => CNN top5 curve: [99.6, 98.24, 98.21]
2024-04-22 21:38:35,445 [trainer.py] => NME top1 curve: [98.38, 96.7, 93.01]
2024-04-22 21:38:35,445 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.11]

Average Accuracy (CNN): 88.6
Average Accuracy (NME): 96.03
2024-04-22 21:38:35,445 [trainer.py] => Average Accuracy (CNN): 88.6
2024-04-22 21:38:35,445 [trainer.py] => Average Accuracy (NME): 96.03
2024-04-22 21:38:35,445 [trainer.py] => Train Time: 282.47
2024-04-22 21:38:35,446 [trainer.py] => Test Time: 29.400000000000002 

2024-04-22 21:38:35,448 [trainer.py] => All params: 257550417
2024-04-22 21:38:35,450 [trainer.py] => Trainable params: 85953105
2024-04-22 21:38:45,248 [der.py] => Learning on 60-80
2024-04-22 21:38:45,253 [der.py] => All params: 343456613
2024-04-22 21:38:45,256 [der.py] => Trainable params: 86060645

  0%|          | 0/1 [00:00<?, ?it/s]
Task 3, Epoch 1/1 => Loss 3.003, Loss_clf 1.595, Loss_aux 1.408, Train_accy 63.56, Test_accy 82.37:   0%|          | 0/1 [01:00<?, ?it/s]
Task 3, Epoch 1/1 => Loss 3.003, Loss_clf 1.595, Loss_aux 1.408, Train_accy 63.56, Test_accy 82.37: 100%|██████████| 1/1 [01:00<00:00, 60.02s/it]
Task 3, Epoch 1/1 => Loss 3.003, Loss_clf 1.595, Loss_aux 1.408, Train_accy 63.56, Test_accy 82.37: 100%|██████████| 1/1 [01:00<00:00, 60.02s/it]
2024-04-22 21:39:45,424 [der.py] => Task 3, Epoch 1/1 => Loss 3.003, Loss_clf 1.595, Loss_aux 1.408, Train_accy 63.56, Test_accy 82.37
2024-04-22 21:39:45,425 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 21:41:45,939 [der.py] => Exemplar size: 1600
2024-04-22 21:41:45,939 [trainer.py] => CNN: {'total': 82.37, '00-19': 82.19, '20-39': 75.85, '40-59': 81.19, '60-79': 89.07, 'old': 79.91, 'new': 89.07}
2024-04-22 21:41:45,939 [trainer.py] => NME: {'total': 90.42, '00-19': 89.07, '20-39': 90.82, '40-59': 90.37, '60-79': 91.5, 'old': 90.03, 'new': 91.5}
2024-04-22 21:41:45,939 [trainer.py] => CNN top1 curve: [98.38, 82.6, 84.82, 82.37]
2024-04-22 21:41:45,939 [trainer.py] => CNN top5 curve: [99.6, 98.24, 98.21, 97.93]
2024-04-22 21:41:45,939 [trainer.py] => NME top1 curve: [98.38, 96.7, 93.01, 90.42]
2024-04-22 21:41:45,939 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.11, 98.91]

Average Accuracy (CNN): 87.04
Average Accuracy (NME): 94.63
2024-04-22 21:41:45,939 [trainer.py] => Average Accuracy (CNN): 87.04
2024-04-22 21:41:45,939 [trainer.py] => Average Accuracy (NME): 94.63
2024-04-22 21:41:45,939 [trainer.py] => Train Time: 342.64000000000004
2024-04-22 21:41:45,940 [trainer.py] => Test Time: 59.55 

2024-04-22 21:41:45,942 [trainer.py] => All params: 343456613
2024-04-22 21:41:45,945 [trainer.py] => Trainable params: 86060645
2024-04-22 21:41:54,768 [der.py] => Learning on 80-100
2024-04-22 21:41:54,773 [der.py] => All params: 429393529
2024-04-22 21:41:54,776 [der.py] => Trainable params: 86198905

  0%|          | 0/1 [00:00<?, ?it/s]
Task 4, Epoch 1/1 => Loss 2.726, Loss_clf 1.463, Loss_aux 1.263, Train_accy 66.47, Test_accy 82.58:   0%|          | 0/1 [01:30<?, ?it/s]
Task 4, Epoch 1/1 => Loss 2.726, Loss_clf 1.463, Loss_aux 1.263, Train_accy 66.47, Test_accy 82.58: 100%|██████████| 1/1 [01:30<00:00, 90.97s/it]
Task 4, Epoch 1/1 => Loss 2.726, Loss_clf 1.463, Loss_aux 1.263, Train_accy 66.47, Test_accy 82.58: 100%|██████████| 1/1 [01:30<00:00, 90.97s/it]
2024-04-22 21:43:25,870 [der.py] => Task 4, Epoch 1/1 => Loss 2.726, Loss_clf 1.463, Loss_aux 1.263, Train_accy 66.47, Test_accy 82.58
2024-04-22 21:43:25,872 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 21:46:13,677 [der.py] => Exemplar size: 2000
2024-04-22 21:46:13,677 [trainer.py] => CNN: {'total': 82.58, '00-19': 81.38, '20-39': 78.74, '40-59': 81.19, '60-79': 78.95, '80-99': 91.08, 'old': 80.09, 'new': 91.08}
2024-04-22 21:46:13,678 [trainer.py] => NME: {'total': 89.65, '00-19': 89.47, '20-39': 89.37, '40-59': 89.91, '60-79': 91.09, '80-99': 88.48, 'old': 89.99, 'new': 88.48}
2024-04-22 21:46:13,678 [trainer.py] => CNN top1 curve: [98.38, 82.6, 84.82, 82.37, 82.58]
2024-04-22 21:46:13,678 [trainer.py] => CNN top5 curve: [99.6, 98.24, 98.21, 97.93, 97.73]
2024-04-22 21:46:13,678 [trainer.py] => NME top1 curve: [98.38, 96.7, 93.01, 90.42, 89.65]
2024-04-22 21:46:13,678 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.11, 98.91, 98.82]

Average Accuracy (CNN): 86.15
Average Accuracy (NME): 93.63
2024-04-22 21:46:13,678 [trainer.py] => Average Accuracy (CNN): 86.15
2024-04-22 21:46:13,678 [trainer.py] => Average Accuracy (NME): 93.63
2024-04-22 21:46:13,678 [trainer.py] => Train Time: 433.73
2024-04-22 21:46:13,678 [trainer.py] => Test Time: 107.41999999999999 

2024-04-22 21:46:13,682 [trainer.py] => All params: 429393529
2024-04-22 21:46:13,685 [trainer.py] => Trainable params: 86198905
2024-04-22 21:46:22,816 [der.py] => Learning on 100-120
2024-04-22 21:46:22,824 [der.py] => All params: 515361165
2024-04-22 21:46:22,828 [der.py] => Trainable params: 86367885

  0%|          | 0/1 [00:00<?, ?it/s]
Task 5, Epoch 1/1 => Loss 2.440, Loss_clf 1.428, Loss_aux 1.012, Train_accy 66.16, Test_accy 80.51:   0%|          | 0/1 [02:01<?, ?it/s]
Task 5, Epoch 1/1 => Loss 2.440, Loss_clf 1.428, Loss_aux 1.012, Train_accy 66.16, Test_accy 80.51: 100%|██████████| 1/1 [02:01<00:00, 122.00s/it]
Task 5, Epoch 1/1 => Loss 2.440, Loss_clf 1.428, Loss_aux 1.012, Train_accy 66.16, Test_accy 80.51: 100%|██████████| 1/1 [02:01<00:00, 122.00s/it]
2024-04-22 21:48:24,973 [der.py] => Task 5, Epoch 1/1 => Loss 2.440, Loss_clf 1.428, Loss_aux 1.012, Train_accy 66.16, Test_accy 80.51
2024-04-22 21:48:24,974 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 21:52:05,885 [der.py] => Exemplar size: 2400
2024-04-22 21:52:05,886 [trainer.py] => CNN: {'total': 80.51, '00-19': 78.54, '20-39': 77.78, '40-59': 77.06, '60-79': 80.16, '80-99': 88.1, '100-119': 79.82, 'old': 80.64, 'new': 79.82}
2024-04-22 21:52:05,886 [trainer.py] => NME: {'total': 87.22, '00-19': 86.64, '20-39': 89.37, '40-59': 88.99, '60-79': 87.04, '80-99': 88.1, '100-119': 83.33, 'old': 87.96, 'new': 83.33}
2024-04-22 21:52:05,886 [trainer.py] => CNN top1 curve: [98.38, 82.6, 84.82, 82.37, 82.58, 80.51]
2024-04-22 21:52:05,886 [trainer.py] => CNN top5 curve: [99.6, 98.24, 98.21, 97.93, 97.73, 97.88]
2024-04-22 21:52:05,886 [trainer.py] => NME top1 curve: [98.38, 96.7, 93.01, 90.42, 89.65, 87.22]
2024-04-22 21:52:05,886 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.11, 98.91, 98.82, 97.95]

Average Accuracy (CNN): 85.21
Average Accuracy (NME): 92.56
2024-04-22 21:52:05,886 [trainer.py] => Average Accuracy (CNN): 85.21
2024-04-22 21:52:05,886 [trainer.py] => Average Accuracy (NME): 92.56
2024-04-22 21:52:05,886 [trainer.py] => Train Time: 555.87
2024-04-22 21:52:05,886 [trainer.py] => Test Time: 174.15999999999997 

2024-04-22 21:52:05,891 [trainer.py] => All params: 515361165
2024-04-22 21:52:05,895 [trainer.py] => Trainable params: 86367885
2024-04-22 21:52:15,224 [der.py] => Learning on 120-140
2024-04-22 21:52:15,233 [der.py] => All params: 601359521
2024-04-22 21:52:15,238 [der.py] => Trainable params: 86567585

  0%|          | 0/1 [00:00<?, ?it/s]
Task 6, Epoch 1/1 => Loss 2.348, Loss_clf 1.437, Loss_aux 0.912, Train_accy 65.15, Test_accy 80.87:   0%|          | 0/1 [02:40<?, ?it/s]
Task 6, Epoch 1/1 => Loss 2.348, Loss_clf 1.437, Loss_aux 0.912, Train_accy 65.15, Test_accy 80.87: 100%|██████████| 1/1 [02:40<00:00, 160.13s/it]
Task 6, Epoch 1/1 => Loss 2.348, Loss_clf 1.437, Loss_aux 0.912, Train_accy 65.15, Test_accy 80.87: 100%|██████████| 1/1 [02:40<00:00, 160.13s/it]
2024-04-22 21:54:55,512 [der.py] => Task 6, Epoch 1/1 => Loss 2.348, Loss_clf 1.437, Loss_aux 0.912, Train_accy 65.15, Test_accy 80.87
2024-04-22 21:54:55,513 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 21:59:38,897 [der.py] => Exemplar size: 2800
2024-04-22 21:59:38,897 [trainer.py] => CNN: {'total': 80.87, '00-19': 76.52, '20-39': 80.68, '40-59': 83.49, '60-79': 85.02, '80-99': 84.01, '100-119': 71.49, '120-139': 84.44, 'old': 80.3, 'new': 84.44}
2024-04-22 21:59:38,897 [trainer.py] => NME: {'total': 85.68, '00-19': 85.43, '20-39': 86.47, '40-59': 86.24, '60-79': 87.04, '80-99': 85.13, '100-119': 83.77, '120-139': 85.78, 'old': 85.66, 'new': 85.78}
2024-04-22 21:59:38,897 [trainer.py] => CNN top1 curve: [98.38, 82.6, 84.82, 82.37, 82.58, 80.51, 80.87]
2024-04-22 21:59:38,897 [trainer.py] => CNN top5 curve: [99.6, 98.24, 98.21, 97.93, 97.73, 97.88, 98.05]
2024-04-22 21:59:38,897 [trainer.py] => NME top1 curve: [98.38, 96.7, 93.01, 90.42, 89.65, 87.22, 85.68]
2024-04-22 21:59:38,898 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.11, 98.91, 98.82, 97.95, 98.05]

Average Accuracy (CNN): 84.59
Average Accuracy (NME): 91.58
2024-04-22 21:59:38,898 [trainer.py] => Average Accuracy (CNN): 84.59
2024-04-22 21:59:38,898 [trainer.py] => Average Accuracy (NME): 91.58
2024-04-22 21:59:38,898 [trainer.py] => Train Time: 716.14
2024-04-22 21:59:38,898 [trainer.py] => Test Time: 265.2 

2024-04-22 21:59:38,903 [trainer.py] => All params: 601359521
2024-04-22 21:59:38,908 [trainer.py] => Trainable params: 86567585
2024-04-22 21:59:47,844 [der.py] => Learning on 140-160
2024-04-22 21:59:47,855 [der.py] => All params: 687388597
2024-04-22 21:59:47,867 [der.py] => Trainable params: 86798005

  0%|          | 0/1 [00:00<?, ?it/s]
Task 7, Epoch 1/1 => Loss 2.227, Loss_clf 1.319, Loss_aux 0.908, Train_accy 67.98, Test_accy 78.37:   0%|          | 0/1 [03:14<?, ?it/s]
Task 7, Epoch 1/1 => Loss 2.227, Loss_clf 1.319, Loss_aux 0.908, Train_accy 67.98, Test_accy 78.37: 100%|██████████| 1/1 [03:14<00:00, 194.70s/it]
Task 7, Epoch 1/1 => Loss 2.227, Loss_clf 1.319, Loss_aux 0.908, Train_accy 67.98, Test_accy 78.37: 100%|██████████| 1/1 [03:14<00:00, 194.70s/it]
2024-04-22 22:03:02,679 [der.py] => Task 7, Epoch 1/1 => Loss 2.227, Loss_clf 1.319, Loss_aux 0.908, Train_accy 67.98, Test_accy 78.37
2024-04-22 22:03:02,681 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 22:08:54,602 [der.py] => Exemplar size: 3200
2024-04-22 22:08:54,603 [trainer.py] => CNN: {'total': 78.37, '00-19': 75.3, '20-39': 82.61, '40-59': 83.03, '60-79': 74.9, '80-99': 80.67, '100-119': 72.81, '120-139': 73.78, '140-159': 84.0, 'old': 77.51, 'new': 84.0}
2024-04-22 22:08:54,603 [trainer.py] => NME: {'total': 85.4, '00-19': 84.62, '20-39': 85.02, '40-59': 85.78, '60-79': 86.23, '80-99': 85.13, '100-119': 82.46, '120-139': 86.22, '140-159': 87.6, 'old': 85.07, 'new': 87.6}
2024-04-22 22:08:54,603 [trainer.py] => CNN top1 curve: [98.38, 82.6, 84.82, 82.37, 82.58, 80.51, 80.87, 78.37]
2024-04-22 22:08:54,603 [trainer.py] => CNN top5 curve: [99.6, 98.24, 98.21, 97.93, 97.73, 97.88, 98.05, 97.62]
2024-04-22 22:08:54,603 [trainer.py] => NME top1 curve: [98.38, 96.7, 93.01, 90.42, 89.65, 87.22, 85.68, 85.4]
2024-04-22 22:08:54,603 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.11, 98.91, 98.82, 97.95, 98.05, 97.88]

Average Accuracy (CNN): 83.81
Average Accuracy (NME): 90.81
2024-04-22 22:08:54,603 [trainer.py] => Average Accuracy (CNN): 83.81
2024-04-22 22:08:54,603 [trainer.py] => Average Accuracy (NME): 90.81
2024-04-22 22:08:54,603 [trainer.py] => Train Time: 910.95
2024-04-22 22:08:54,603 [trainer.py] => Test Time: 380.87 

2024-04-22 22:08:54,612 [trainer.py] => All params: 687388597
2024-04-22 22:08:54,618 [trainer.py] => Trainable params: 86798005
2024-04-22 22:09:04,866 [der.py] => Learning on 160-180
2024-04-22 22:09:04,882 [der.py] => All params: 773448393
2024-04-22 22:09:04,888 [der.py] => Trainable params: 87059145

  0%|          | 0/1 [00:00<?, ?it/s]
Task 8, Epoch 1/1 => Loss 2.232, Loss_clf 1.321, Loss_aux 0.910, Train_accy 67.80, Test_accy 77.87:   0%|          | 0/1 [04:01<?, ?it/s]
Task 8, Epoch 1/1 => Loss 2.232, Loss_clf 1.321, Loss_aux 0.910, Train_accy 67.80, Test_accy 77.87: 100%|██████████| 1/1 [04:01<00:00, 241.92s/it]
Task 8, Epoch 1/1 => Loss 2.232, Loss_clf 1.321, Loss_aux 0.910, Train_accy 67.80, Test_accy 77.87: 100%|██████████| 1/1 [04:01<00:00, 241.92s/it]
2024-04-22 22:13:06,917 [der.py] => Task 8, Epoch 1/1 => Loss 2.232, Loss_clf 1.321, Loss_aux 0.910, Train_accy 67.80, Test_accy 77.87
2024-04-22 22:13:06,919 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 22:20:29,971 [der.py] => Exemplar size: 3600
2024-04-22 22:20:29,972 [trainer.py] => CNN: {'total': 77.87, '00-19': 83.0, '20-39': 78.26, '40-59': 80.73, '60-79': 76.92, '80-99': 78.44, '100-119': 68.86, '120-139': 76.89, '140-159': 74.8, '160-179': 82.7, 'old': 77.26, 'new': 82.7}
2024-04-22 22:20:29,972 [trainer.py] => NME: {'total': 84.82, '00-19': 83.4, '20-39': 87.44, '40-59': 85.78, '60-79': 86.64, '80-99': 84.01, '100-119': 81.58, '120-139': 84.44, '140-159': 85.6, '160-179': 84.81, 'old': 84.82, 'new': 84.81}
2024-04-22 22:20:29,972 [trainer.py] => CNN top1 curve: [98.38, 82.6, 84.82, 82.37, 82.58, 80.51, 80.87, 78.37, 77.87]
2024-04-22 22:20:29,972 [trainer.py] => CNN top5 curve: [99.6, 98.24, 98.21, 97.93, 97.73, 97.88, 98.05, 97.62, 96.85]
2024-04-22 22:20:29,972 [trainer.py] => NME top1 curve: [98.38, 96.7, 93.01, 90.42, 89.65, 87.22, 85.68, 85.4, 84.82]
2024-04-22 22:20:29,972 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.11, 98.91, 98.82, 97.95, 98.05, 97.88, 97.56]

Average Accuracy (CNN): 83.15
Average Accuracy (NME): 90.14
2024-04-22 22:20:29,972 [trainer.py] => Average Accuracy (CNN): 83.15
2024-04-22 22:20:29,972 [trainer.py] => Average Accuracy (NME): 90.14
2024-04-22 22:20:29,972 [trainer.py] => Train Time: 1152.97
2024-04-22 22:20:29,972 [trainer.py] => Test Time: 533.21 

2024-04-22 22:20:29,979 [trainer.py] => All params: 773448393
2024-04-22 22:20:29,985 [trainer.py] => Trainable params: 87059145
2024-04-22 22:20:41,266 [der.py] => Learning on 180-200
2024-04-22 22:20:41,294 [der.py] => All params: 859538909
2024-04-22 22:20:41,301 [der.py] => Trainable params: 87351005

  0%|          | 0/1 [00:00<?, ?it/s]
Task 9, Epoch 1/1 => Loss 2.279, Loss_clf 1.358, Loss_aux 0.921, Train_accy 66.81, Test_accy 78.88:   0%|          | 0/1 [04:52<?, ?it/s]
Task 9, Epoch 1/1 => Loss 2.279, Loss_clf 1.358, Loss_aux 0.921, Train_accy 66.81, Test_accy 78.88: 100%|██████████| 1/1 [04:52<00:00, 292.85s/it]
Task 9, Epoch 1/1 => Loss 2.279, Loss_clf 1.358, Loss_aux 0.921, Train_accy 66.81, Test_accy 78.88: 100%|██████████| 1/1 [04:52<00:00, 292.85s/it]
2024-04-22 22:25:34,277 [der.py] => Task 9, Epoch 1/1 => Loss 2.279, Loss_clf 1.358, Loss_aux 0.921, Train_accy 66.81, Test_accy 78.88
2024-04-22 22:25:34,279 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 22:34:23,042 [der.py] => Exemplar size: 4000
2024-04-22 22:34:23,042 [trainer.py] => CNN: {'total': 78.88, '00-19': 75.71, '20-39': 72.46, '40-59': 83.94, '60-79': 81.38, '80-99': 82.16, '100-119': 76.75, '120-139': 76.0, '140-159': 83.2, '160-179': 76.37, '180-199': 79.57, 'old': 78.81, 'new': 79.57}
2024-04-22 22:34:23,042 [trainer.py] => NME: {'total': 83.55, '00-19': 82.19, '20-39': 84.06, '40-59': 84.86, '60-79': 83.81, '80-99': 84.01, '100-119': 81.14, '120-139': 82.67, '140-159': 86.0, '160-179': 84.39, '180-199': 82.17, 'old': 83.69, 'new': 82.17}
2024-04-22 22:34:23,042 [trainer.py] => CNN top1 curve: [98.38, 82.6, 84.82, 82.37, 82.58, 80.51, 80.87, 78.37, 77.87, 78.88]
2024-04-22 22:34:23,042 [trainer.py] => CNN top5 curve: [99.6, 98.24, 98.21, 97.93, 97.73, 97.88, 98.05, 97.62, 96.85, 96.56]
2024-04-22 22:34:23,043 [trainer.py] => NME top1 curve: [98.38, 96.7, 93.01, 90.42, 89.65, 87.22, 85.68, 85.4, 84.82, 83.55]
2024-04-22 22:34:23,043 [trainer.py] => NME top5 curve: [100.0, 99.34, 99.11, 98.91, 98.82, 97.95, 98.05, 97.88, 97.56, 96.99]

Average Accuracy (CNN): 82.72
Average Accuracy (NME): 89.48
2024-04-22 22:34:23,043 [trainer.py] => Average Accuracy (CNN): 82.72
2024-04-22 22:34:23,043 [trainer.py] => Average Accuracy (NME): 89.48
2024-04-22 22:34:23,043 [trainer.py] => Train Time: 1445.94
2024-04-22 22:34:23,043 [trainer.py] => Test Time: 717.07 

Accuracy Matrix (CNN):
[[98.38 86.23 89.88 82.19 81.38 78.54 76.52 75.3  83.   75.71]
 [ 0.   78.26 75.36 75.85 78.74 77.78 80.68 82.61 78.26 72.46]
 [ 0.    0.   88.07 81.19 81.19 77.06 83.49 83.03 80.73 83.94]
 [ 0.    0.    0.   89.07 78.95 80.16 85.02 74.9  76.92 81.38]
 [ 0.    0.    0.    0.   91.08 88.1  84.01 80.67 78.44 82.16]
 [ 0.    0.    0.    0.    0.   79.82 71.49 72.81 68.86 76.75]
 [ 0.    0.    0.    0.    0.    0.   84.44 73.78 76.89 76.  ]
 [ 0.    0.    0.    0.    0.    0.    0.   84.   74.8  83.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   82.7  76.37]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   79.57]]
2024-04-22 22:34:23,044 [trainer.py] => Forgetting (CNN): 8.02222222222222
Accuracy Matrix (NME):
[[98.38 97.17 92.71 89.07 89.47 86.64 85.43 84.62 83.4  82.19]
 [ 0.   96.14 94.69 90.82 89.37 89.37 86.47 85.02 87.44 84.06]
 [ 0.    0.   91.74 90.37 89.91 88.99 86.24 85.78 85.78 84.86]
 [ 0.    0.    0.   91.5  91.09 87.04 87.04 86.23 86.64 83.81]
 [ 0.    0.    0.    0.   88.48 88.1  85.13 85.13 84.01 84.01]
 [ 0.    0.    0.    0.    0.   83.33 83.77 82.46 81.58 81.14]
 [ 0.    0.    0.    0.    0.    0.   85.78 86.22 84.44 82.67]
 [ 0.    0.    0.    0.    0.    0.    0.   87.6  85.6  86.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   84.81 84.39]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   82.17]]
2024-04-22 22:34:23,045 [trainer.py] => Forgetting (NME): 6.167777777777776

nohup: 忽略输入
2024-04-22 08:18:35,094 [trainer.py] => config: ./exps/foster_cub_B0.json
2024-04-22 08:18:35,116 [trainer.py] => prefix: cil
2024-04-22 08:18:35,116 [trainer.py] => dataset: cub
2024-04-22 08:18:35,116 [trainer.py] => memory_size: 4000
2024-04-22 08:18:35,116 [trainer.py] => memory_per_class: 20
2024-04-22 08:18:35,116 [trainer.py] => fixed_memory: True
2024-04-22 08:18:35,116 [trainer.py] => shuffle: True
2024-04-22 08:18:35,116 [trainer.py] => init_cls: 20
2024-04-22 08:18:35,116 [trainer.py] => increment: 20
2024-04-22 08:18:35,116 [trainer.py] => model_name: foster
2024-04-22 08:18:35,116 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-22 08:18:35,116 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-22 08:18:35,116 [trainer.py] => seed: 1993
2024-04-22 08:18:35,116 [trainer.py] => beta1: 0.96
2024-04-22 08:18:35,116 [trainer.py] => beta2: 0.97
2024-04-22 08:18:35,116 [trainer.py] => oofc: ft
2024-04-22 08:18:35,116 [trainer.py] => is_teacher_wa: False
2024-04-22 08:18:35,116 [trainer.py] => is_student_wa: False
2024-04-22 08:18:35,116 [trainer.py] => lambda_okd: 1
2024-04-22 08:18:35,116 [trainer.py] => wa_value: 1
2024-04-22 08:18:35,116 [trainer.py] => init_epochs: 20
2024-04-22 08:18:35,117 [trainer.py] => init_lr: 0.001
2024-04-22 08:18:35,117 [trainer.py] => init_weight_decay: 0.0005
2024-04-22 08:18:35,117 [trainer.py] => boosting_epochs: 20
2024-04-22 08:18:35,117 [trainer.py] => compression_epochs: 20
2024-04-22 08:18:35,117 [trainer.py] => lr: 0.001
2024-04-22 08:18:35,117 [trainer.py] => batch_size: 48
2024-04-22 08:18:35,117 [trainer.py] => weight_decay: 0.0005
2024-04-22 08:18:35,117 [trainer.py] => num_workers: 8
2024-04-22 08:18:35,117 [trainer.py] => T: 2
2024-04-22 08:18:35,163 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-22 08:18:35,492 [trainer.py] => All params: 0
2024-04-22 08:18:35,492 [trainer.py] => Trainable params: 0
2024-04-22 08:18:37,719 [foster.py] => Learning on 0-20
2024-04-22 08:18:37,719 [foster.py] => All params: 85829416
2024-04-22 08:18:37,720 [foster.py] => Trainable params: 85829416

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.870, Train_accy 52.11, Test_accy 93.93:   0%|          | 0/20 [00:08<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.870, Train_accy 52.11, Test_accy 93.93:   5%|▌         | 1/20 [00:08<02:40,  8.43s/it]
Task 0, Epoch 2/20 => Loss 0.494, Train_accy 84.36:   5%|▌         | 1/20 [00:14<02:40,  8.43s/it]                 
Task 0, Epoch 2/20 => Loss 0.494, Train_accy 84.36:  10%|█         | 2/20 [00:14<02:10,  7.26s/it]
Task 0, Epoch 3/20 => Loss 0.349, Train_accy 89.53:  10%|█         | 2/20 [00:21<02:10,  7.26s/it]
Task 0, Epoch 3/20 => Loss 0.349, Train_accy 89.53:  15%|█▌        | 3/20 [00:21<01:56,  6.85s/it]
Task 0, Epoch 4/20 => Loss 0.289, Train_accy 91.23:  15%|█▌        | 3/20 [00:27<01:56,  6.85s/it]
Task 0, Epoch 4/20 => Loss 0.289, Train_accy 91.23:  20%|██        | 4/20 [00:27<01:46,  6.68s/it]
Task 0, Epoch 5/20 => Loss 0.233, Train_accy 92.60:  20%|██        | 4/20 [00:34<01:46,  6.68s/it]
Task 0, Epoch 5/20 => Loss 0.233, Train_accy 92.60:  25%|██▌       | 5/20 [00:34<01:39,  6.62s/it]
Task 0, Epoch 6/20 => Loss 0.253, Train_accy 92.18, Test_accy 95.95:  25%|██▌       | 5/20 [00:41<01:39,  6.62s/it]
Task 0, Epoch 6/20 => Loss 0.253, Train_accy 92.18, Test_accy 95.95:  30%|███       | 6/20 [00:41<01:37,  7.00s/it]
Task 0, Epoch 7/20 => Loss 0.243, Train_accy 92.49:  30%|███       | 6/20 [00:48<01:37,  7.00s/it]                 
Task 0, Epoch 7/20 => Loss 0.243, Train_accy 92.49:  35%|███▌      | 7/20 [00:48<01:28,  6.83s/it]
Task 0, Epoch 8/20 => Loss 0.188, Train_accy 94.08:  35%|███▌      | 7/20 [00:54<01:28,  6.83s/it]
Task 0, Epoch 8/20 => Loss 0.188, Train_accy 94.08:  40%|████      | 8/20 [00:54<01:20,  6.72s/it]
Task 0, Epoch 9/20 => Loss 0.178, Train_accy 93.97:  40%|████      | 8/20 [01:01<01:20,  6.72s/it]
Task 0, Epoch 9/20 => Loss 0.178, Train_accy 93.97:  45%|████▌     | 9/20 [01:01<01:13,  6.65s/it]
Task 0, Epoch 10/20 => Loss 0.194, Train_accy 94.19:  45%|████▌     | 9/20 [01:07<01:13,  6.65s/it]
Task 0, Epoch 10/20 => Loss 0.194, Train_accy 94.19:  50%|█████     | 10/20 [01:07<01:05,  6.59s/it]
Task 0, Epoch 11/20 => Loss 0.148, Train_accy 95.35, Test_accy 97.57:  50%|█████     | 10/20 [01:15<01:05,  6.59s/it]
Task 0, Epoch 11/20 => Loss 0.148, Train_accy 95.35, Test_accy 97.57:  55%|█████▌    | 11/20 [01:15<01:01,  6.86s/it]
Task 0, Epoch 12/20 => Loss 0.141, Train_accy 95.67:  55%|█████▌    | 11/20 [01:21<01:01,  6.86s/it]                 
Task 0, Epoch 12/20 => Loss 0.141, Train_accy 95.67:  60%|██████    | 12/20 [01:21<00:54,  6.75s/it]
Task 0, Epoch 13/20 => Loss 0.207, Train_accy 92.81:  60%|██████    | 12/20 [01:28<00:54,  6.75s/it]
Task 0, Epoch 13/20 => Loss 0.207, Train_accy 92.81:  65%|██████▌   | 13/20 [01:28<00:46,  6.68s/it]
Task 0, Epoch 14/20 => Loss 0.161, Train_accy 94.71:  65%|██████▌   | 13/20 [01:34<00:46,  6.68s/it]
Task 0, Epoch 14/20 => Loss 0.161, Train_accy 94.71:  70%|███████   | 14/20 [01:34<00:39,  6.64s/it]
Task 0, Epoch 15/20 => Loss 0.160, Train_accy 95.14:  70%|███████   | 14/20 [01:41<00:39,  6.64s/it]
Task 0, Epoch 15/20 => Loss 0.160, Train_accy 95.14:  75%|███████▌  | 15/20 [01:41<00:33,  6.63s/it]
Task 0, Epoch 16/20 => Loss 0.132, Train_accy 95.88, Test_accy 97.57:  75%|███████▌  | 15/20 [01:49<00:33,  6.63s/it]
Task 0, Epoch 16/20 => Loss 0.132, Train_accy 95.88, Test_accy 97.57:  80%|████████  | 16/20 [01:49<00:27,  6.93s/it]
Task 0, Epoch 17/20 => Loss 0.110, Train_accy 95.98:  80%|████████  | 16/20 [01:55<00:27,  6.93s/it]                 
Task 0, Epoch 17/20 => Loss 0.110, Train_accy 95.98:  85%|████████▌ | 17/20 [01:55<00:20,  6.80s/it]
Task 0, Epoch 18/20 => Loss 0.173, Train_accy 94.93:  85%|████████▌ | 17/20 [02:02<00:20,  6.80s/it]
Task 0, Epoch 18/20 => Loss 0.173, Train_accy 94.93:  90%|█████████ | 18/20 [02:02<00:13,  6.74s/it]
Task 0, Epoch 19/20 => Loss 0.118, Train_accy 95.77:  90%|█████████ | 18/20 [02:08<00:13,  6.74s/it]
Task 0, Epoch 19/20 => Loss 0.118, Train_accy 95.77:  95%|█████████▌| 19/20 [02:08<00:06,  6.70s/it]
Task 0, Epoch 20/20 => Loss 0.170, Train_accy 94.08:  95%|█████████▌| 19/20 [02:15<00:06,  6.70s/it]
Task 0, Epoch 20/20 => Loss 0.170, Train_accy 94.08: 100%|██████████| 20/20 [02:15<00:00,  6.67s/it]
Task 0, Epoch 20/20 => Loss 0.170, Train_accy 94.08: 100%|██████████| 20/20 [02:15<00:00,  6.77s/it]
2024-04-22 08:20:53,592 [foster.py] => Task 0, Epoch 20/20 => Loss 0.170, Train_accy 94.08
2024-04-22 08:20:53,594 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 08:21:12,808 [foster.py] => Exemplar size: 400
2024-04-22 08:21:12,808 [trainer.py] => CNN: {'total': 97.57, '00-19': 97.57, 'old': 0, 'new': 97.57}
2024-04-22 08:21:12,808 [trainer.py] => NME: {'total': 98.38, '00-19': 98.38, 'old': 0, 'new': 98.38}
2024-04-22 08:21:12,808 [trainer.py] => CNN top1 curve: [97.57]
2024-04-22 08:21:12,808 [trainer.py] => CNN top5 curve: [99.6]
2024-04-22 08:21:12,808 [trainer.py] => NME top1 curve: [98.38]
2024-04-22 08:21:12,808 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 97.57
Average Accuracy (NME): 98.38
2024-04-22 08:21:12,808 [trainer.py] => Average Accuracy (CNN): 97.57
2024-04-22 08:21:12,808 [trainer.py] => Average Accuracy (NME): 98.38
2024-04-22 08:21:12,808 [trainer.py] => Train Time: 135.87
2024-04-22 08:21:12,808 [trainer.py] => Test Time: 2.25 

2024-04-22 08:21:12,809 [trainer.py] => All params: 85829416
2024-04-22 08:21:12,811 [trainer.py] => Trainable params: 85829416
2024-04-22 08:21:15,355 [foster.py] => Learning on 20-40
2024-04-22 08:21:15,357 [foster.py] => All params: 171704932
2024-04-22 08:21:15,358 [foster.py] => Trainable params: 85890896
2024-04-22 08:21:15,403 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.185, Loss_clf 1.757, Loss_fe 2.348, Loss_kd 0.540, Train_accy 51.38, Test_accy 77.31:   0%|          | 0/20 [00:15<?, ?it/s]
Task 1, Epoch 1/20 => Loss 5.185, Loss_clf 1.757, Loss_fe 2.348, Loss_kd 0.540, Train_accy 51.38, Test_accy 77.31:   5%|▌         | 1/20 [00:15<04:50, 15.30s/it]
Task 1, Epoch 2/20 => Loss 3.026, Loss_clf 0.722, Loss_fe 1.288, Loss_kd 0.508, Train_accy 65.43:   5%|▌         | 1/20 [00:27<04:50, 15.30s/it]                 
Task 1, Epoch 2/20 => Loss 3.026, Loss_clf 0.722, Loss_fe 1.288, Loss_kd 0.508, Train_accy 65.43:  10%|█         | 2/20 [00:27<04:03, 13.50s/it]
Task 1, Epoch 3/20 => Loss 3.025, Loss_clf 0.857, Loss_fe 1.154, Loss_kd 0.507, Train_accy 66.32:  10%|█         | 2/20 [00:39<04:03, 13.50s/it]
Task 1, Epoch 3/20 => Loss 3.025, Loss_clf 0.857, Loss_fe 1.154, Loss_kd 0.507, Train_accy 66.32:  15%|█▌        | 3/20 [00:39<03:40, 12.95s/it]
Task 1, Epoch 4/20 => Loss 2.336, Loss_clf 0.546, Loss_fe 0.816, Loss_kd 0.487, Train_accy 65.58:  15%|█▌        | 3/20 [00:52<03:40, 12.95s/it]
Task 1, Epoch 4/20 => Loss 2.336, Loss_clf 0.546, Loss_fe 0.816, Loss_kd 0.487, Train_accy 65.58:  20%|██        | 4/20 [00:52<03:22, 12.69s/it]
Task 1, Epoch 5/20 => Loss 2.051, Loss_clf 0.422, Loss_fe 0.560, Loss_kd 0.534, Train_accy 71.38:  20%|██        | 4/20 [01:04<03:22, 12.69s/it]
Task 1, Epoch 5/20 => Loss 2.051, Loss_clf 0.422, Loss_fe 0.560, Loss_kd 0.534, Train_accy 71.38:  25%|██▌       | 5/20 [01:04<03:08, 12.55s/it]
Task 1, Epoch 6/20 => Loss 1.941, Loss_clf 0.354, Loss_fe 0.573, Loss_kd 0.507, Train_accy 67.88, Test_accy 81.94:  25%|██▌       | 5/20 [01:19<03:08, 12.55s/it]
Task 1, Epoch 6/20 => Loss 1.941, Loss_clf 0.354, Loss_fe 0.573, Loss_kd 0.507, Train_accy 67.88, Test_accy 81.94:  30%|███       | 6/20 [01:19<03:07, 13.38s/it]
Task 1, Epoch 7/20 => Loss 1.616, Loss_clf 0.258, Loss_fe 0.354, Loss_kd 0.502, Train_accy 72.57:  30%|███       | 6/20 [01:31<03:07, 13.38s/it]                 
Task 1, Epoch 7/20 => Loss 1.616, Loss_clf 0.258, Loss_fe 0.354, Loss_kd 0.502, Train_accy 72.57:  35%|███▌      | 7/20 [01:31<02:50, 13.09s/it]
Task 1, Epoch 8/20 => Loss 1.661, Loss_clf 0.255, Loss_fe 0.358, Loss_kd 0.525, Train_accy 74.72:  35%|███▌      | 7/20 [01:44<02:50, 13.09s/it]
Task 1, Epoch 8/20 => Loss 1.661, Loss_clf 0.255, Loss_fe 0.358, Loss_kd 0.525, Train_accy 74.72:  40%|████      | 8/20 [01:44<02:34, 12.90s/it]
Task 1, Epoch 9/20 => Loss 1.469, Loss_clf 0.211, Loss_fe 0.280, Loss_kd 0.489, Train_accy 76.06:  40%|████      | 8/20 [01:56<02:34, 12.90s/it]
Task 1, Epoch 9/20 => Loss 1.469, Loss_clf 0.211, Loss_fe 0.280, Loss_kd 0.489, Train_accy 76.06:  45%|████▌     | 9/20 [01:56<02:20, 12.74s/it]
Task 1, Epoch 10/20 => Loss 1.474, Loss_clf 0.210, Loss_fe 0.286, Loss_kd 0.489, Train_accy 75.54:  45%|████▌     | 9/20 [02:09<02:20, 12.74s/it]
Task 1, Epoch 10/20 => Loss 1.474, Loss_clf 0.210, Loss_fe 0.286, Loss_kd 0.489, Train_accy 75.54:  50%|█████     | 10/20 [02:09<02:06, 12.62s/it]
Task 1, Epoch 11/20 => Loss 1.419, Loss_clf 0.197, Loss_fe 0.243, Loss_kd 0.490, Train_accy 77.17, Test_accy 84.58:  50%|█████     | 10/20 [02:24<02:06, 12.62s/it]
Task 1, Epoch 11/20 => Loss 1.419, Loss_clf 0.197, Loss_fe 0.243, Loss_kd 0.490, Train_accy 77.17, Test_accy 84.58:  55%|█████▌    | 11/20 [02:24<02:00, 13.38s/it]
Task 1, Epoch 12/20 => Loss 1.514, Loss_clf 0.214, Loss_fe 0.257, Loss_kd 0.521, Train_accy 76.51:  55%|█████▌    | 11/20 [02:36<02:00, 13.38s/it]                 
Task 1, Epoch 12/20 => Loss 1.514, Loss_clf 0.214, Loss_fe 0.257, Loss_kd 0.521, Train_accy 76.51:  60%|██████    | 12/20 [02:36<01:44, 13.07s/it]
Task 1, Epoch 13/20 => Loss 1.410, Loss_clf 0.194, Loss_fe 0.227, Loss_kd 0.495, Train_accy 79.55:  60%|██████    | 12/20 [02:49<01:44, 13.07s/it]
Task 1, Epoch 13/20 => Loss 1.410, Loss_clf 0.194, Loss_fe 0.227, Loss_kd 0.495, Train_accy 79.55:  65%|██████▌   | 13/20 [02:49<01:30, 12.87s/it]
Task 1, Epoch 14/20 => Loss 1.441, Loss_clf 0.217, Loss_fe 0.233, Loss_kd 0.495, Train_accy 75.69:  65%|██████▌   | 13/20 [03:01<01:30, 12.87s/it]
Task 1, Epoch 14/20 => Loss 1.441, Loss_clf 0.217, Loss_fe 0.233, Loss_kd 0.495, Train_accy 75.69:  70%|███████   | 14/20 [03:01<01:16, 12.71s/it]
Task 1, Epoch 15/20 => Loss 1.449, Loss_clf 0.212, Loss_fe 0.231, Loss_kd 0.503, Train_accy 76.06:  70%|███████   | 14/20 [03:13<01:16, 12.71s/it]
Task 1, Epoch 15/20 => Loss 1.449, Loss_clf 0.212, Loss_fe 0.231, Loss_kd 0.503, Train_accy 76.06:  75%|███████▌  | 15/20 [03:13<01:03, 12.62s/it]
Task 1, Epoch 16/20 => Loss 1.429, Loss_clf 0.215, Loss_fe 0.221, Loss_kd 0.496, Train_accy 78.29, Test_accy 84.80:  75%|███████▌  | 15/20 [03:28<01:03, 12.62s/it]
Task 1, Epoch 16/20 => Loss 1.429, Loss_clf 0.215, Loss_fe 0.221, Loss_kd 0.496, Train_accy 78.29, Test_accy 84.80:  80%|████████  | 16/20 [03:28<00:53, 13.38s/it]
Task 1, Epoch 17/20 => Loss 1.381, Loss_clf 0.191, Loss_fe 0.201, Loss_kd 0.494, Train_accy 77.62:  80%|████████  | 16/20 [03:41<00:53, 13.38s/it]                 
Task 1, Epoch 17/20 => Loss 1.381, Loss_clf 0.191, Loss_fe 0.201, Loss_kd 0.494, Train_accy 77.62:  85%|████████▌ | 17/20 [03:41<00:39, 13.13s/it]
Task 1, Epoch 18/20 => Loss 1.579, Loss_clf 0.245, Loss_fe 0.275, Loss_kd 0.530, Train_accy 76.73:  85%|████████▌ | 17/20 [03:53<00:39, 13.13s/it]
Task 1, Epoch 18/20 => Loss 1.579, Loss_clf 0.245, Loss_fe 0.275, Loss_kd 0.530, Train_accy 76.73:  90%|█████████ | 18/20 [03:53<00:25, 12.91s/it]
Task 1, Epoch 19/20 => Loss 1.425, Loss_clf 0.186, Loss_fe 0.198, Loss_kd 0.520, Train_accy 78.07:  90%|█████████ | 18/20 [04:06<00:25, 12.91s/it]
Task 1, Epoch 19/20 => Loss 1.425, Loss_clf 0.186, Loss_fe 0.198, Loss_kd 0.520, Train_accy 78.07:  95%|█████████▌| 19/20 [04:06<00:12, 12.75s/it]
Task 1, Epoch 20/20 => Loss 1.362, Loss_clf 0.186, Loss_fe 0.195, Loss_kd 0.491, Train_accy 77.84:  95%|█████████▌| 19/20 [04:18<00:12, 12.75s/it]
Task 1, Epoch 20/20 => Loss 1.362, Loss_clf 0.186, Loss_fe 0.195, Loss_kd 0.491, Train_accy 77.84: 100%|██████████| 20/20 [04:18<00:00, 12.64s/it]
Task 1, Epoch 20/20 => Loss 1.362, Loss_clf 0.186, Loss_fe 0.195, Loss_kd 0.491, Train_accy 77.84: 100%|██████████| 20/20 [04:18<00:00, 12.93s/it]
2024-04-22 08:25:34,020 [foster.py] => Task 1, Epoch 20/20 => Loss 1.362, Loss_clf 0.186, Loss_fe 0.195, Loss_kd 0.491, Train_accy 77.84
2024-04-22 08:25:34,021 [foster.py] => do not weight align teacher!
2024-04-22 08:25:34,025 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.716,  Train_accy 44.68, Test_accy 75.33:   0%|          | 0/20 [00:17<?, ?it/s]
SNet: Task 1, Epoch 1/20 => Loss 1.716,  Train_accy 44.68, Test_accy 75.33:   5%|▌         | 1/20 [00:17<05:32, 17.49s/it]
SNet: Task 1, Epoch 2/20 => Loss 1.052,  Train_accy 63.79:   5%|▌         | 1/20 [00:32<05:32, 17.49s/it]                 
SNet: Task 1, Epoch 2/20 => Loss 1.052,  Train_accy 63.79:  10%|█         | 2/20 [00:32<04:53, 16.31s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.102,  Train_accy 64.83:  10%|█         | 2/20 [00:48<04:53, 16.31s/it]
SNet: Task 1, Epoch 3/20 => Loss 1.102,  Train_accy 64.83:  15%|█▌        | 3/20 [00:48<04:31, 15.97s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.971,  Train_accy 65.72:  15%|█▌        | 3/20 [01:04<04:31, 15.97s/it]
SNet: Task 1, Epoch 4/20 => Loss 0.971,  Train_accy 65.72:  20%|██        | 4/20 [01:04<04:12, 15.81s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.927,  Train_accy 66.47:  20%|██        | 4/20 [01:19<04:12, 15.81s/it]
SNet: Task 1, Epoch 5/20 => Loss 0.927,  Train_accy 66.47:  25%|██▌       | 5/20 [01:19<03:55, 15.72s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.013,  Train_accy 67.58, Test_accy 80.84:  25%|██▌       | 5/20 [01:36<03:55, 15.72s/it]
SNet: Task 1, Epoch 6/20 => Loss 1.013,  Train_accy 67.58, Test_accy 80.84:  30%|███       | 6/20 [01:36<03:47, 16.24s/it]
SNet: Task 1, Epoch 7/20 => Loss 0.929,  Train_accy 67.88:  30%|███       | 6/20 [01:52<03:47, 16.24s/it]                 
SNet: Task 1, Epoch 7/20 => Loss 0.929,  Train_accy 67.88:  35%|███▌      | 7/20 [01:52<03:28, 16.00s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.945,  Train_accy 67.58:  35%|███▌      | 7/20 [02:07<03:28, 16.00s/it]
SNet: Task 1, Epoch 8/20 => Loss 0.945,  Train_accy 67.58:  40%|████      | 8/20 [02:07<03:10, 15.86s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.939,  Train_accy 69.37:  40%|████      | 8/20 [02:23<03:10, 15.86s/it]
SNet: Task 1, Epoch 9/20 => Loss 0.939,  Train_accy 69.37:  45%|████▌     | 9/20 [02:23<02:53, 15.74s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.998,  Train_accy 67.66:  45%|████▌     | 9/20 [02:38<02:53, 15.74s/it]
SNet: Task 1, Epoch 10/20 => Loss 0.998,  Train_accy 67.66:  50%|█████     | 10/20 [02:38<02:36, 15.67s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.960,  Train_accy 67.58, Test_accy 80.84:  50%|█████     | 10/20 [02:56<02:36, 15.67s/it]
SNet: Task 1, Epoch 11/20 => Loss 0.960,  Train_accy 67.58, Test_accy 80.84:  55%|█████▌    | 11/20 [02:56<02:25, 16.13s/it]
SNet: Task 1, Epoch 12/20 => Loss 0.959,  Train_accy 66.84:  55%|█████▌    | 11/20 [03:11<02:25, 16.13s/it]                 
SNet: Task 1, Epoch 12/20 => Loss 0.959,  Train_accy 66.84:  60%|██████    | 12/20 [03:11<02:07, 15.94s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.910,  Train_accy 68.25:  60%|██████    | 12/20 [03:27<02:07, 15.94s/it]
SNet: Task 1, Epoch 13/20 => Loss 0.910,  Train_accy 68.25:  65%|██████▌   | 13/20 [03:27<01:50, 15.82s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.940,  Train_accy 68.03:  65%|██████▌   | 13/20 [03:42<01:50, 15.82s/it]
SNet: Task 1, Epoch 14/20 => Loss 0.940,  Train_accy 68.03:  70%|███████   | 14/20 [03:42<01:34, 15.75s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.884,  Train_accy 69.07:  70%|███████   | 14/20 [03:58<01:34, 15.75s/it]
SNet: Task 1, Epoch 15/20 => Loss 0.884,  Train_accy 69.07:  75%|███████▌  | 15/20 [03:58<01:18, 15.72s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.950,  Train_accy 67.58, Test_accy 81.06:  75%|███████▌  | 15/20 [04:15<01:18, 15.72s/it]
SNet: Task 1, Epoch 16/20 => Loss 0.950,  Train_accy 67.58, Test_accy 81.06:  80%|████████  | 16/20 [04:15<01:04, 16.20s/it]
SNet: Task 1, Epoch 17/20 => Loss 0.905,  Train_accy 67.51:  80%|████████  | 16/20 [04:31<01:04, 16.20s/it]                 
SNet: Task 1, Epoch 17/20 => Loss 0.905,  Train_accy 67.51:  85%|████████▌ | 17/20 [04:31<00:48, 16.02s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.943,  Train_accy 68.33:  85%|████████▌ | 17/20 [04:46<00:48, 16.02s/it]
SNet: Task 1, Epoch 18/20 => Loss 0.943,  Train_accy 68.33:  90%|█████████ | 18/20 [04:46<00:31, 15.85s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.939,  Train_accy 67.14:  90%|█████████ | 18/20 [05:02<00:31, 15.85s/it]
SNet: Task 1, Epoch 19/20 => Loss 0.939,  Train_accy 67.14:  95%|█████████▌| 19/20 [05:02<00:15, 15.78s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.927,  Train_accy 66.32:  95%|█████████▌| 19/20 [05:18<00:15, 15.78s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.927,  Train_accy 66.32: 100%|██████████| 20/20 [05:18<00:00, 15.72s/it]
SNet: Task 1, Epoch 20/20 => Loss 0.927,  Train_accy 66.32: 100%|██████████| 20/20 [05:18<00:00, 15.90s/it]
2024-04-22 08:30:54,540 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 0.927,  Train_accy 66.32
2024-04-22 08:30:54,541 [foster.py] => do not weight align student!
2024-04-22 08:30:56,237 [foster.py] => darknet eval: 
2024-04-22 08:30:56,237 [foster.py] => CNN top1 curve: 80.84
2024-04-22 08:30:56,237 [foster.py] => CNN top5 curve: 99.56
2024-04-22 08:30:56,239 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 08:31:31,426 [foster.py] => Exemplar size: 800
2024-04-22 08:31:31,426 [trainer.py] => CNN: {'total': 84.58, '00-19': 97.98, '20-39': 68.6, 'old': 97.98, 'new': 68.6}
2024-04-22 08:31:31,426 [trainer.py] => NME: {'total': 96.04, '00-19': 95.95, '20-39': 96.14, 'old': 95.95, 'new': 96.14}
2024-04-22 08:31:31,426 [trainer.py] => CNN top1 curve: [97.57, 84.58]
2024-04-22 08:31:31,426 [trainer.py] => CNN top5 curve: [99.6, 99.34]
2024-04-22 08:31:31,426 [trainer.py] => NME top1 curve: [98.38, 96.04]
2024-04-22 08:31:31,426 [trainer.py] => NME top5 curve: [100.0, 99.56]

Average Accuracy (CNN): 91.07
Average Accuracy (NME): 97.21
2024-04-22 08:31:31,427 [trainer.py] => Average Accuracy (CNN): 91.07
2024-04-22 08:31:31,427 [trainer.py] => Average Accuracy (NME): 97.21
2024-04-22 08:31:31,427 [trainer.py] => Train Time: 716.75
2024-04-22 08:31:31,427 [trainer.py] => Test Time: 7.88 

2024-04-22 08:31:31,428 [trainer.py] => All params: 171704932
2024-04-22 08:31:31,430 [trainer.py] => Trainable params: 85890896
2024-04-22 08:31:33,634 [foster.py] => Learning on 40-60
2024-04-22 08:31:33,636 [foster.py] => All params: 171766432
2024-04-22 08:31:33,637 [foster.py] => Trainable params: 85937016
2024-04-22 08:31:33,684 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.495, Loss_clf 1.616, Loss_fe 2.347, Loss_kd 1.022, Train_accy 58.41, Test_accy 78.57:   0%|          | 0/20 [00:19<?, ?it/s]
Task 2, Epoch 1/20 => Loss 5.495, Loss_clf 1.616, Loss_fe 2.347, Loss_kd 1.022, Train_accy 58.41, Test_accy 78.57:   5%|▌         | 1/20 [00:19<06:16, 19.80s/it]
Task 2, Epoch 2/20 => Loss 2.782, Loss_clf 0.613, Loss_fe 0.678, Loss_kd 0.994, Train_accy 69.25:   5%|▌         | 1/20 [00:35<06:16, 19.80s/it]                 
Task 2, Epoch 2/20 => Loss 2.782, Loss_clf 0.613, Loss_fe 0.678, Loss_kd 0.994, Train_accy 69.25:  10%|█         | 2/20 [00:35<05:15, 17.51s/it]
Task 2, Epoch 3/20 => Loss 2.548, Loss_clf 0.530, Loss_fe 0.537, Loss_kd 0.987, Train_accy 69.88:  10%|█         | 2/20 [00:51<05:15, 17.51s/it]
Task 2, Epoch 3/20 => Loss 2.548, Loss_clf 0.530, Loss_fe 0.537, Loss_kd 0.987, Train_accy 69.88:  15%|█▌        | 3/20 [00:51<04:45, 16.78s/it]
Task 2, Epoch 4/20 => Loss 2.417, Loss_clf 0.477, Loss_fe 0.470, Loss_kd 0.980, Train_accy 72.17:  15%|█▌        | 3/20 [01:07<04:45, 16.78s/it]
Task 2, Epoch 4/20 => Loss 2.417, Loss_clf 0.477, Loss_fe 0.470, Loss_kd 0.980, Train_accy 72.17:  20%|██        | 4/20 [01:07<04:23, 16.46s/it]
Task 2, Epoch 5/20 => Loss 2.219, Loss_clf 0.399, Loss_fe 0.382, Loss_kd 0.958, Train_accy 72.58:  20%|██        | 4/20 [01:23<04:23, 16.46s/it]
Task 2, Epoch 5/20 => Loss 2.219, Loss_clf 0.399, Loss_fe 0.382, Loss_kd 0.958, Train_accy 72.58:  25%|██▌       | 5/20 [01:23<04:03, 16.25s/it]
Task 2, Epoch 6/20 => Loss 2.299, Loss_clf 0.407, Loss_fe 0.406, Loss_kd 0.991, Train_accy 72.92, Test_accy 84.23:  25%|██▌       | 5/20 [01:43<04:03, 16.25s/it]
Task 2, Epoch 6/20 => Loss 2.299, Loss_clf 0.407, Loss_fe 0.406, Loss_kd 0.991, Train_accy 72.92, Test_accy 84.23:  30%|███       | 6/20 [01:43<04:05, 17.51s/it]
Task 2, Epoch 7/20 => Loss 2.212, Loss_clf 0.387, Loss_fe 0.360, Loss_kd 0.977, Train_accy 73.84:  30%|███       | 6/20 [01:59<04:05, 17.51s/it]                 
Task 2, Epoch 7/20 => Loss 2.212, Loss_clf 0.387, Loss_fe 0.360, Loss_kd 0.977, Train_accy 73.84:  35%|███▌      | 7/20 [01:59<03:40, 16.98s/it]
Task 2, Epoch 8/20 => Loss 2.133, Loss_clf 0.329, Loss_fe 0.316, Loss_kd 0.992, Train_accy 74.64:  35%|███▌      | 7/20 [02:15<03:40, 16.98s/it]
Task 2, Epoch 8/20 => Loss 2.133, Loss_clf 0.329, Loss_fe 0.316, Loss_kd 0.992, Train_accy 74.64:  40%|████      | 8/20 [02:15<03:20, 16.67s/it]
Task 2, Epoch 9/20 => Loss 2.074, Loss_clf 0.332, Loss_fe 0.295, Loss_kd 0.965, Train_accy 74.93:  40%|████      | 8/20 [02:31<03:20, 16.67s/it]
Task 2, Epoch 9/20 => Loss 2.074, Loss_clf 0.332, Loss_fe 0.295, Loss_kd 0.965, Train_accy 74.93:  45%|████▌     | 9/20 [02:31<03:00, 16.44s/it]
Task 2, Epoch 10/20 => Loss 2.109, Loss_clf 0.333, Loss_fe 0.301, Loss_kd 0.984, Train_accy 76.88:  45%|████▌     | 9/20 [02:47<03:00, 16.44s/it]
Task 2, Epoch 10/20 => Loss 2.109, Loss_clf 0.333, Loss_fe 0.301, Loss_kd 0.984, Train_accy 76.88:  50%|█████     | 10/20 [02:47<02:42, 16.29s/it]
Task 2, Epoch 11/20 => Loss 2.167, Loss_clf 0.348, Loss_fe 0.309, Loss_kd 1.006, Train_accy 76.42, Test_accy 82.89:  50%|█████     | 10/20 [03:06<02:42, 16.29s/it]
Task 2, Epoch 11/20 => Loss 2.167, Loss_clf 0.348, Loss_fe 0.309, Loss_kd 1.006, Train_accy 76.42, Test_accy 82.89:  55%|█████▌    | 11/20 [03:06<02:36, 17.35s/it]
Task 2, Epoch 12/20 => Loss 1.991, Loss_clf 0.303, Loss_fe 0.252, Loss_kd 0.957, Train_accy 77.05:  55%|█████▌    | 11/20 [03:22<02:36, 17.35s/it]                 
Task 2, Epoch 12/20 => Loss 1.991, Loss_clf 0.303, Loss_fe 0.252, Loss_kd 0.957, Train_accy 77.05:  60%|██████    | 12/20 [03:22<02:15, 16.90s/it]
Task 2, Epoch 13/20 => Loss 1.929, Loss_clf 0.277, Loss_fe 0.225, Loss_kd 0.952, Train_accy 78.08:  60%|██████    | 12/20 [03:38<02:15, 16.90s/it]
Task 2, Epoch 13/20 => Loss 1.929, Loss_clf 0.277, Loss_fe 0.225, Loss_kd 0.952, Train_accy 78.08:  65%|██████▌   | 13/20 [03:38<01:56, 16.61s/it]
Task 2, Epoch 14/20 => Loss 1.990, Loss_clf 0.283, Loss_fe 0.233, Loss_kd 0.983, Train_accy 77.85:  65%|██████▌   | 13/20 [03:54<01:56, 16.61s/it]
Task 2, Epoch 14/20 => Loss 1.990, Loss_clf 0.283, Loss_fe 0.233, Loss_kd 0.983, Train_accy 77.85:  70%|███████   | 14/20 [03:54<01:38, 16.38s/it]
Task 2, Epoch 15/20 => Loss 2.048, Loss_clf 0.305, Loss_fe 0.262, Loss_kd 0.987, Train_accy 77.11:  70%|███████   | 14/20 [04:10<01:38, 16.38s/it]
Task 2, Epoch 15/20 => Loss 2.048, Loss_clf 0.305, Loss_fe 0.262, Loss_kd 0.987, Train_accy 77.11:  75%|███████▌  | 15/20 [04:10<01:21, 16.21s/it]
Task 2, Epoch 16/20 => Loss 1.979, Loss_clf 0.278, Loss_fe 0.234, Loss_kd 0.978, Train_accy 78.31, Test_accy 84.38:  75%|███████▌  | 15/20 [04:30<01:21, 16.21s/it]
Task 2, Epoch 16/20 => Loss 1.979, Loss_clf 0.278, Loss_fe 0.234, Loss_kd 0.978, Train_accy 78.31, Test_accy 84.38:  80%|████████  | 16/20 [04:30<01:09, 17.35s/it]
Task 2, Epoch 17/20 => Loss 1.925, Loss_clf 0.270, Loss_fe 0.201, Loss_kd 0.969, Train_accy 79.06:  80%|████████  | 16/20 [04:46<01:09, 17.35s/it]                 
Task 2, Epoch 17/20 => Loss 1.925, Loss_clf 0.270, Loss_fe 0.201, Loss_kd 0.969, Train_accy 79.06:  85%|████████▌ | 17/20 [04:46<00:50, 16.92s/it]
Task 2, Epoch 18/20 => Loss 1.929, Loss_clf 0.263, Loss_fe 0.217, Loss_kd 0.966, Train_accy 78.66:  85%|████████▌ | 17/20 [05:02<00:50, 16.92s/it]
Task 2, Epoch 18/20 => Loss 1.929, Loss_clf 0.263, Loss_fe 0.217, Loss_kd 0.966, Train_accy 78.66:  90%|█████████ | 18/20 [05:02<00:33, 16.62s/it]
Task 2, Epoch 19/20 => Loss 1.949, Loss_clf 0.273, Loss_fe 0.216, Loss_kd 0.973, Train_accy 78.54:  90%|█████████ | 18/20 [05:18<00:33, 16.62s/it]
Task 2, Epoch 19/20 => Loss 1.949, Loss_clf 0.273, Loss_fe 0.216, Loss_kd 0.973, Train_accy 78.54:  95%|█████████▌| 19/20 [05:18<00:16, 16.40s/it]
Task 2, Epoch 20/20 => Loss 1.986, Loss_clf 0.286, Loss_fe 0.220, Loss_kd 0.987, Train_accy 78.37:  95%|█████████▌| 19/20 [05:33<00:16, 16.40s/it]
Task 2, Epoch 20/20 => Loss 1.986, Loss_clf 0.286, Loss_fe 0.220, Loss_kd 0.987, Train_accy 78.37: 100%|██████████| 20/20 [05:33<00:00, 16.23s/it]
Task 2, Epoch 20/20 => Loss 1.986, Loss_clf 0.286, Loss_fe 0.220, Loss_kd 0.987, Train_accy 78.37: 100%|██████████| 20/20 [05:33<00:00, 16.70s/it]
2024-04-22 08:37:07,680 [foster.py] => Task 2, Epoch 20/20 => Loss 1.986, Loss_clf 0.286, Loss_fe 0.220, Loss_kd 0.987, Train_accy 78.37
2024-04-22 08:37:07,681 [foster.py] => do not weight align teacher!
2024-04-22 08:37:07,682 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.679,  Train_accy 53.24, Test_accy 79.46:   0%|          | 0/20 [00:22<?, ?it/s]
SNet: Task 2, Epoch 1/20 => Loss 1.679,  Train_accy 53.24, Test_accy 79.46:   5%|▌         | 1/20 [00:22<07:06, 22.45s/it]
SNet: Task 2, Epoch 2/20 => Loss 1.343,  Train_accy 66.15:   5%|▌         | 1/20 [00:42<07:06, 22.45s/it]                 
SNet: Task 2, Epoch 2/20 => Loss 1.343,  Train_accy 66.15:  10%|█         | 2/20 [00:42<06:18, 21.00s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.309,  Train_accy 67.47:  10%|█         | 2/20 [01:02<06:18, 21.00s/it]
SNet: Task 2, Epoch 3/20 => Loss 1.309,  Train_accy 67.47:  15%|█▌        | 3/20 [01:02<05:49, 20.56s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.288,  Train_accy 68.04:  15%|█▌        | 3/20 [01:22<05:49, 20.56s/it]
SNet: Task 2, Epoch 4/20 => Loss 1.288,  Train_accy 68.04:  20%|██        | 4/20 [01:22<05:25, 20.37s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.267,  Train_accy 68.79:  20%|██        | 4/20 [01:42<05:25, 20.37s/it]
SNet: Task 2, Epoch 5/20 => Loss 1.267,  Train_accy 68.79:  25%|██▌       | 5/20 [01:42<05:04, 20.29s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.271,  Train_accy 69.08, Test_accy 81.10:  25%|██▌       | 5/20 [02:05<05:04, 20.29s/it]
SNet: Task 2, Epoch 6/20 => Loss 1.271,  Train_accy 69.08, Test_accy 81.10:  30%|███       | 6/20 [02:05<04:55, 21.08s/it]
SNet: Task 2, Epoch 7/20 => Loss 1.234,  Train_accy 69.76:  30%|███       | 6/20 [02:25<04:55, 21.08s/it]                 
SNet: Task 2, Epoch 7/20 => Loss 1.234,  Train_accy 69.76:  35%|███▌      | 7/20 [02:25<04:29, 20.73s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.290,  Train_accy 70.05:  35%|███▌      | 7/20 [02:45<04:29, 20.73s/it]
SNet: Task 2, Epoch 8/20 => Loss 1.290,  Train_accy 70.05:  40%|████      | 8/20 [02:45<04:06, 20.50s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.254,  Train_accy 70.28:  40%|████      | 8/20 [03:05<04:06, 20.50s/it]
SNet: Task 2, Epoch 9/20 => Loss 1.254,  Train_accy 70.28:  45%|████▌     | 9/20 [03:05<03:43, 20.34s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.252,  Train_accy 70.51:  45%|████▌     | 9/20 [03:25<03:43, 20.34s/it]
SNet: Task 2, Epoch 10/20 => Loss 1.252,  Train_accy 70.51:  50%|█████     | 10/20 [03:25<03:22, 20.24s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.256,  Train_accy 69.25, Test_accy 81.25:  50%|█████     | 10/20 [03:47<03:22, 20.24s/it]
SNet: Task 2, Epoch 11/20 => Loss 1.256,  Train_accy 69.25, Test_accy 81.25:  55%|█████▌    | 11/20 [03:47<03:07, 20.86s/it]
SNet: Task 2, Epoch 12/20 => Loss 1.232,  Train_accy 69.99:  55%|█████▌    | 11/20 [04:07<03:07, 20.86s/it]                 
SNet: Task 2, Epoch 12/20 => Loss 1.232,  Train_accy 69.99:  60%|██████    | 12/20 [04:07<02:45, 20.64s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.220,  Train_accy 70.91:  60%|██████    | 12/20 [04:27<02:45, 20.64s/it]
SNet: Task 2, Epoch 13/20 => Loss 1.220,  Train_accy 70.91:  65%|██████▌   | 13/20 [04:27<02:23, 20.46s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.241,  Train_accy 70.40:  65%|██████▌   | 13/20 [04:47<02:23, 20.46s/it]
SNet: Task 2, Epoch 14/20 => Loss 1.241,  Train_accy 70.40:  70%|███████   | 14/20 [04:47<02:01, 20.33s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.254,  Train_accy 69.31:  70%|███████   | 14/20 [05:07<02:01, 20.33s/it]
SNet: Task 2, Epoch 15/20 => Loss 1.254,  Train_accy 69.31:  75%|███████▌  | 15/20 [05:07<01:41, 20.26s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.267,  Train_accy 71.08, Test_accy 80.51:  75%|███████▌  | 15/20 [05:30<01:41, 20.26s/it]
SNet: Task 2, Epoch 16/20 => Loss 1.267,  Train_accy 71.08, Test_accy 80.51:  80%|████████  | 16/20 [05:30<01:23, 20.97s/it]
SNet: Task 2, Epoch 17/20 => Loss 1.235,  Train_accy 70.22:  80%|████████  | 16/20 [05:50<01:23, 20.97s/it]                 
SNet: Task 2, Epoch 17/20 => Loss 1.235,  Train_accy 70.22:  85%|████████▌ | 17/20 [05:50<01:02, 20.67s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.270,  Train_accy 69.76:  85%|████████▌ | 17/20 [06:10<01:02, 20.67s/it]
SNet: Task 2, Epoch 18/20 => Loss 1.270,  Train_accy 69.76:  90%|█████████ | 18/20 [06:10<00:40, 20.49s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.248,  Train_accy 71.08:  90%|█████████ | 18/20 [06:32<00:40, 20.49s/it]
SNet: Task 2, Epoch 19/20 => Loss 1.248,  Train_accy 71.08:  95%|█████████▌| 19/20 [06:32<00:20, 20.80s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.232,  Train_accy 71.37:  95%|█████████▌| 19/20 [06:53<00:20, 20.80s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.232,  Train_accy 71.37: 100%|██████████| 20/20 [06:53<00:00, 21.12s/it]
SNet: Task 2, Epoch 20/20 => Loss 1.232,  Train_accy 71.37: 100%|██████████| 20/20 [06:53<00:00, 20.70s/it]
2024-04-22 08:44:04,156 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.232,  Train_accy 71.37
2024-04-22 08:44:04,157 [foster.py] => do not weight align student!
2024-04-22 08:44:06,670 [foster.py] => darknet eval: 
2024-04-22 08:44:06,671 [foster.py] => CNN top1 curve: 80.21
2024-04-22 08:44:06,671 [foster.py] => CNN top5 curve: 98.81
2024-04-22 08:44:06,673 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 08:44:56,728 [foster.py] => Exemplar size: 1200
2024-04-22 08:44:56,728 [trainer.py] => CNN: {'total': 84.52, '00-19': 97.98, '20-39': 85.02, '40-59': 68.81, 'old': 92.07, 'new': 68.81}
2024-04-22 08:44:56,728 [trainer.py] => NME: {'total': 93.6, '00-19': 93.12, '20-39': 94.69, '40-59': 93.12, 'old': 93.83, 'new': 93.12}
2024-04-22 08:44:56,728 [trainer.py] => CNN top1 curve: [97.57, 84.58, 84.52]
2024-04-22 08:44:56,728 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.66]
2024-04-22 08:44:56,728 [trainer.py] => NME top1 curve: [98.38, 96.04, 93.6]
2024-04-22 08:44:56,728 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4]

Average Accuracy (CNN): 88.89
Average Accuracy (NME): 96.01
2024-04-22 08:44:56,728 [trainer.py] => Average Accuracy (CNN): 88.89
2024-04-22 08:44:56,728 [trainer.py] => Average Accuracy (NME): 96.01
2024-04-22 08:44:56,728 [trainer.py] => Train Time: 1469.78
2024-04-22 08:44:56,728 [trainer.py] => Test Time: 15.77 

2024-04-22 08:44:56,730 [trainer.py] => All params: 171766432
2024-04-22 08:44:56,731 [trainer.py] => Trainable params: 85937016
2024-04-22 08:44:59,363 [foster.py] => Learning on 60-80
2024-04-22 08:44:59,365 [foster.py] => All params: 171827932
2024-04-22 08:44:59,366 [foster.py] => Trainable params: 85983136
2024-04-22 08:44:59,414 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.957, Loss_clf 1.503, Loss_fe 2.912, Loss_kd 1.157, Train_accy 55.50, Test_accy 71.71:   0%|          | 0/20 [00:26<?, ?it/s]
Task 3, Epoch 1/20 => Loss 5.957, Loss_clf 1.503, Loss_fe 2.912, Loss_kd 1.157, Train_accy 55.50, Test_accy 71.71:   5%|▌         | 1/20 [00:26<08:21, 26.37s/it]
Task 3, Epoch 2/20 => Loss 3.076, Loss_clf 0.714, Loss_fe 0.857, Loss_kd 1.128, Train_accy 62.44:   5%|▌         | 1/20 [00:47<08:21, 26.37s/it]                 
Task 3, Epoch 2/20 => Loss 3.076, Loss_clf 0.714, Loss_fe 0.857, Loss_kd 1.128, Train_accy 62.44:  10%|█         | 2/20 [00:47<06:55, 23.11s/it]
Task 3, Epoch 3/20 => Loss 2.776, Loss_clf 0.583, Loss_fe 0.664, Loss_kd 1.147, Train_accy 63.51:  10%|█         | 2/20 [01:07<06:55, 23.11s/it]
Task 3, Epoch 3/20 => Loss 2.776, Loss_clf 0.583, Loss_fe 0.664, Loss_kd 1.147, Train_accy 63.51:  15%|█▌        | 3/20 [01:07<06:14, 22.03s/it]
Task 3, Epoch 4/20 => Loss 2.476, Loss_clf 0.509, Loss_fe 0.518, Loss_kd 1.087, Train_accy 64.49:  15%|█▌        | 3/20 [01:29<06:14, 22.03s/it]
Task 3, Epoch 4/20 => Loss 2.476, Loss_clf 0.509, Loss_fe 0.518, Loss_kd 1.087, Train_accy 64.49:  20%|██        | 4/20 [01:29<05:47, 21.72s/it]
Task 3, Epoch 5/20 => Loss 2.440, Loss_clf 0.475, Loss_fe 0.494, Loss_kd 1.104, Train_accy 65.52:  20%|██        | 4/20 [01:49<05:47, 21.72s/it]
Task 3, Epoch 5/20 => Loss 2.440, Loss_clf 0.475, Loss_fe 0.494, Loss_kd 1.104, Train_accy 65.52:  25%|██▌       | 5/20 [01:49<05:17, 21.18s/it]
Task 3, Epoch 6/20 => Loss 2.398, Loss_clf 0.451, Loss_fe 0.457, Loss_kd 1.118, Train_accy 65.33, Test_accy 75.19:  25%|██▌       | 5/20 [02:16<05:17, 21.18s/it]
Task 3, Epoch 6/20 => Loss 2.398, Loss_clf 0.451, Loss_fe 0.457, Loss_kd 1.118, Train_accy 65.33, Test_accy 75.19:  30%|███       | 6/20 [02:16<05:22, 23.04s/it]
Task 3, Epoch 7/20 => Loss 2.309, Loss_clf 0.429, Loss_fe 0.408, Loss_kd 1.105, Train_accy 67.43:  30%|███       | 6/20 [02:36<05:22, 23.04s/it]                 
Task 3, Epoch 7/20 => Loss 2.309, Loss_clf 0.429, Loss_fe 0.408, Loss_kd 1.105, Train_accy 67.43:  35%|███▌      | 7/20 [02:36<04:48, 22.17s/it]
Task 3, Epoch 8/20 => Loss 2.241, Loss_clf 0.385, Loss_fe 0.371, Loss_kd 1.113, Train_accy 67.43:  35%|███▌      | 7/20 [02:57<04:48, 22.17s/it]
Task 3, Epoch 8/20 => Loss 2.241, Loss_clf 0.385, Loss_fe 0.371, Loss_kd 1.113, Train_accy 67.43:  40%|████      | 8/20 [02:57<04:22, 21.87s/it]
Task 3, Epoch 9/20 => Loss 2.103, Loss_clf 0.339, Loss_fe 0.307, Loss_kd 1.093, Train_accy 68.59:  40%|████      | 8/20 [03:18<04:22, 21.87s/it]
Task 3, Epoch 9/20 => Loss 2.103, Loss_clf 0.339, Loss_fe 0.307, Loss_kd 1.093, Train_accy 68.59:  45%|████▌     | 9/20 [03:18<03:57, 21.60s/it]
Task 3, Epoch 10/20 => Loss 2.200, Loss_clf 0.379, Loss_fe 0.334, Loss_kd 1.116, Train_accy 68.03:  45%|████▌     | 9/20 [03:39<03:57, 21.60s/it]
Task 3, Epoch 10/20 => Loss 2.200, Loss_clf 0.379, Loss_fe 0.334, Loss_kd 1.116, Train_accy 68.03:  50%|█████     | 10/20 [03:39<03:33, 21.35s/it]
Task 3, Epoch 11/20 => Loss 2.178, Loss_clf 0.376, Loss_fe 0.336, Loss_kd 1.099, Train_accy 70.08, Test_accy 76.06:  50%|█████     | 10/20 [04:06<03:33, 21.35s/it]
Task 3, Epoch 11/20 => Loss 2.178, Loss_clf 0.376, Loss_fe 0.336, Loss_kd 1.099, Train_accy 70.08, Test_accy 76.06:  55%|█████▌    | 11/20 [04:06<03:26, 23.00s/it]
Task 3, Epoch 12/20 => Loss 2.183, Loss_clf 0.358, Loss_fe 0.330, Loss_kd 1.121, Train_accy 69.62:  55%|█████▌    | 11/20 [04:26<03:26, 23.00s/it]                 
Task 3, Epoch 12/20 => Loss 2.183, Loss_clf 0.358, Loss_fe 0.330, Loss_kd 1.121, Train_accy 69.62:  60%|██████    | 12/20 [04:26<02:58, 22.26s/it]
Task 3, Epoch 13/20 => Loss 2.046, Loss_clf 0.309, Loss_fe 0.267, Loss_kd 1.102, Train_accy 70.55:  60%|██████    | 12/20 [04:47<02:58, 22.26s/it]
Task 3, Epoch 13/20 => Loss 2.046, Loss_clf 0.309, Loss_fe 0.267, Loss_kd 1.102, Train_accy 70.55:  65%|██████▌   | 13/20 [04:47<02:33, 21.95s/it]
Task 3, Epoch 14/20 => Loss 2.051, Loss_clf 0.331, Loss_fe 0.278, Loss_kd 1.082, Train_accy 69.52:  65%|██████▌   | 13/20 [05:08<02:33, 21.95s/it]
Task 3, Epoch 14/20 => Loss 2.051, Loss_clf 0.331, Loss_fe 0.278, Loss_kd 1.082, Train_accy 69.52:  70%|███████   | 14/20 [05:08<02:08, 21.41s/it]
Task 3, Epoch 15/20 => Loss 2.048, Loss_clf 0.311, Loss_fe 0.252, Loss_kd 1.114, Train_accy 70.92:  70%|███████   | 14/20 [05:29<02:08, 21.41s/it]
Task 3, Epoch 15/20 => Loss 2.048, Loss_clf 0.311, Loss_fe 0.252, Loss_kd 1.114, Train_accy 70.92:  75%|███████▌  | 15/20 [05:29<01:46, 21.32s/it]
Task 3, Epoch 16/20 => Loss 2.125, Loss_clf 0.348, Loss_fe 0.289, Loss_kd 1.116, Train_accy 69.52, Test_accy 75.84:  75%|███████▌  | 15/20 [05:55<01:46, 21.32s/it]
Task 3, Epoch 16/20 => Loss 2.125, Loss_clf 0.348, Loss_fe 0.289, Loss_kd 1.116, Train_accy 69.52, Test_accy 75.84:  80%|████████  | 16/20 [05:55<01:30, 22.68s/it]
Task 3, Epoch 17/20 => Loss 1.930, Loss_clf 0.281, Loss_fe 0.213, Loss_kd 1.077, Train_accy 70.69:  80%|████████  | 16/20 [06:16<01:30, 22.68s/it]                 
Task 3, Epoch 17/20 => Loss 1.930, Loss_clf 0.281, Loss_fe 0.213, Loss_kd 1.077, Train_accy 70.69:  85%|████████▌ | 17/20 [06:16<01:06, 22.21s/it]
Task 3, Epoch 18/20 => Loss 2.054, Loss_clf 0.326, Loss_fe 0.247, Loss_kd 1.111, Train_accy 69.94:  85%|████████▌ | 17/20 [06:35<01:06, 22.21s/it]
Task 3, Epoch 18/20 => Loss 2.054, Loss_clf 0.326, Loss_fe 0.247, Loss_kd 1.111, Train_accy 69.94:  90%|█████████ | 18/20 [06:35<00:42, 21.40s/it]
Task 3, Epoch 19/20 => Loss 1.978, Loss_clf 0.281, Loss_fe 0.230, Loss_kd 1.100, Train_accy 71.44:  90%|█████████ | 18/20 [06:55<00:42, 21.40s/it]
Task 3, Epoch 19/20 => Loss 1.978, Loss_clf 0.281, Loss_fe 0.230, Loss_kd 1.100, Train_accy 71.44:  95%|█████████▌| 19/20 [06:55<00:20, 20.84s/it]
Task 3, Epoch 20/20 => Loss 2.064, Loss_clf 0.321, Loss_fe 0.259, Loss_kd 1.112, Train_accy 71.02:  95%|█████████▌| 19/20 [07:14<00:20, 20.84s/it]
Task 3, Epoch 20/20 => Loss 2.064, Loss_clf 0.321, Loss_fe 0.259, Loss_kd 1.112, Train_accy 71.02: 100%|██████████| 20/20 [07:14<00:00, 20.45s/it]
Task 3, Epoch 20/20 => Loss 2.064, Loss_clf 0.321, Loss_fe 0.259, Loss_kd 1.112, Train_accy 71.02: 100%|██████████| 20/20 [07:14<00:00, 21.74s/it]
2024-04-22 08:52:14,216 [foster.py] => Task 3, Epoch 20/20 => Loss 2.064, Loss_clf 0.321, Loss_fe 0.259, Loss_kd 1.112, Train_accy 71.02
2024-04-22 08:52:14,217 [foster.py] => do not weight align teacher!
2024-04-22 08:52:14,221 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.700,  Train_accy 52.42, Test_accy 72.03:   0%|          | 0/20 [00:27<?, ?it/s]
SNet: Task 3, Epoch 1/20 => Loss 1.700,  Train_accy 52.42, Test_accy 72.03:   5%|▌         | 1/20 [00:27<08:42, 27.50s/it]
SNet: Task 3, Epoch 2/20 => Loss 1.460,  Train_accy 60.25:   5%|▌         | 1/20 [00:52<08:42, 27.50s/it]                 
SNet: Task 3, Epoch 2/20 => Loss 1.460,  Train_accy 60.25:  10%|█         | 2/20 [00:52<07:44, 25.83s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.432,  Train_accy 61.28:  10%|█         | 2/20 [01:16<07:44, 25.83s/it]
SNet: Task 3, Epoch 3/20 => Loss 1.432,  Train_accy 61.28:  15%|█▌        | 3/20 [01:16<07:09, 25.26s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.416,  Train_accy 61.88:  15%|█▌        | 3/20 [01:41<07:09, 25.26s/it]
SNet: Task 3, Epoch 4/20 => Loss 1.416,  Train_accy 61.88:  20%|██        | 4/20 [01:41<06:39, 24.99s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.419,  Train_accy 62.26:  20%|██        | 4/20 [02:05<06:39, 24.99s/it]
SNet: Task 3, Epoch 5/20 => Loss 1.419,  Train_accy 62.26:  25%|██▌       | 5/20 [02:05<06:12, 24.81s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.420,  Train_accy 61.70, Test_accy 73.67:  25%|██▌       | 5/20 [02:33<06:12, 24.81s/it]
SNet: Task 3, Epoch 6/20 => Loss 1.420,  Train_accy 61.70, Test_accy 73.67:  30%|███       | 6/20 [02:33<06:00, 25.75s/it]
SNet: Task 3, Epoch 7/20 => Loss 1.424,  Train_accy 60.81:  30%|███       | 6/20 [02:57<06:00, 25.75s/it]                 
SNet: Task 3, Epoch 7/20 => Loss 1.424,  Train_accy 60.81:  35%|███▌      | 7/20 [02:57<05:29, 25.36s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.411,  Train_accy 62.30:  35%|███▌      | 7/20 [03:22<05:29, 25.36s/it]
SNet: Task 3, Epoch 8/20 => Loss 1.411,  Train_accy 62.30:  40%|████      | 8/20 [03:22<05:01, 25.11s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.397,  Train_accy 62.21:  40%|████      | 8/20 [03:47<05:01, 25.11s/it]
SNet: Task 3, Epoch 9/20 => Loss 1.397,  Train_accy 62.21:  45%|████▌     | 9/20 [03:47<04:34, 24.92s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.394,  Train_accy 62.49:  45%|████▌     | 9/20 [04:11<04:34, 24.92s/it]
SNet: Task 3, Epoch 10/20 => Loss 1.394,  Train_accy 62.49:  50%|█████     | 10/20 [04:11<04:07, 24.78s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.424,  Train_accy 62.40, Test_accy 73.78:  50%|█████     | 10/20 [04:38<04:07, 24.78s/it]
SNet: Task 3, Epoch 11/20 => Loss 1.424,  Train_accy 62.40, Test_accy 73.78:  55%|█████▌    | 11/20 [04:38<03:50, 25.61s/it]
SNet: Task 3, Epoch 12/20 => Loss 1.385,  Train_accy 62.81:  55%|█████▌    | 11/20 [05:03<03:50, 25.61s/it]                 
SNet: Task 3, Epoch 12/20 => Loss 1.385,  Train_accy 62.81:  60%|██████    | 12/20 [05:03<03:22, 25.32s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.387,  Train_accy 62.21:  60%|██████    | 12/20 [05:28<03:22, 25.32s/it]
SNet: Task 3, Epoch 13/20 => Loss 1.387,  Train_accy 62.21:  65%|██████▌   | 13/20 [05:28<02:55, 25.09s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.396,  Train_accy 62.49:  65%|██████▌   | 13/20 [05:52<02:55, 25.09s/it]
SNet: Task 3, Epoch 14/20 => Loss 1.396,  Train_accy 62.49:  70%|███████   | 14/20 [05:52<02:29, 24.98s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.411,  Train_accy 61.51:  70%|███████   | 14/20 [06:17<02:29, 24.98s/it]
SNet: Task 3, Epoch 15/20 => Loss 1.411,  Train_accy 61.51:  75%|███████▌  | 15/20 [06:17<02:04, 24.85s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.403,  Train_accy 63.00, Test_accy 73.99:  75%|███████▌  | 15/20 [06:44<02:04, 24.85s/it]
SNet: Task 3, Epoch 16/20 => Loss 1.403,  Train_accy 63.00, Test_accy 73.99:  80%|████████  | 16/20 [06:44<01:42, 25.65s/it]
SNet: Task 3, Epoch 17/20 => Loss 1.378,  Train_accy 63.28:  80%|████████  | 16/20 [07:09<01:42, 25.65s/it]                 
SNet: Task 3, Epoch 17/20 => Loss 1.378,  Train_accy 63.28:  85%|████████▌ | 17/20 [07:09<01:15, 25.32s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.374,  Train_accy 63.61:  85%|████████▌ | 17/20 [07:34<01:15, 25.32s/it]
SNet: Task 3, Epoch 18/20 => Loss 1.374,  Train_accy 63.61:  90%|█████████ | 18/20 [07:34<00:50, 25.10s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.412,  Train_accy 61.70:  90%|█████████ | 18/20 [07:58<00:50, 25.10s/it]
SNet: Task 3, Epoch 19/20 => Loss 1.412,  Train_accy 61.70:  95%|█████████▌| 19/20 [07:58<00:24, 24.94s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.395,  Train_accy 63.09:  95%|█████████▌| 19/20 [08:23<00:24, 24.94s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.395,  Train_accy 63.09: 100%|██████████| 20/20 [08:23<00:00, 24.86s/it]
SNet: Task 3, Epoch 20/20 => Loss 1.395,  Train_accy 63.09: 100%|██████████| 20/20 [08:23<00:00, 25.17s/it]
2024-04-22 09:00:40,233 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.395,  Train_accy 63.09
2024-04-22 09:00:40,233 [foster.py] => do not weight align student!
2024-04-22 09:00:43,240 [foster.py] => darknet eval: 
2024-04-22 09:00:43,240 [foster.py] => CNN top1 curve: 73.88
2024-04-22 09:00:43,240 [foster.py] => CNN top5 curve: 97.93
2024-04-22 09:00:43,243 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 09:01:44,889 [foster.py] => Exemplar size: 1600
2024-04-22 09:01:44,890 [trainer.py] => CNN: {'total': 76.17, '00-19': 95.95, '20-39': 91.3, '40-59': 79.36, '60-79': 40.89, 'old': 89.14, 'new': 40.89}
2024-04-22 09:01:44,890 [trainer.py] => NME: {'total': 92.38, '00-19': 91.5, '20-39': 90.34, '40-59': 91.74, '60-79': 95.55, 'old': 91.22, 'new': 95.55}
2024-04-22 09:01:44,890 [trainer.py] => CNN top1 curve: [97.57, 84.58, 84.52, 76.17]
2024-04-22 09:01:44,890 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.66, 98.26]
2024-04-22 09:01:44,890 [trainer.py] => NME top1 curve: [98.38, 96.04, 93.6, 92.38]
2024-04-22 09:01:44,890 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.02]

Average Accuracy (CNN): 85.71
Average Accuracy (NME): 95.1
2024-04-22 09:01:44,890 [trainer.py] => Average Accuracy (CNN): 85.71
2024-04-22 09:01:44,890 [trainer.py] => Average Accuracy (NME): 95.1
2024-04-22 09:01:44,890 [trainer.py] => Train Time: 2413.65
2024-04-22 09:01:44,890 [trainer.py] => Test Time: 26.119999999999997 

2024-04-22 09:01:44,892 [trainer.py] => All params: 171827932
2024-04-22 09:01:44,893 [trainer.py] => Trainable params: 85983136
2024-04-22 09:01:48,078 [foster.py] => Learning on 80-100
2024-04-22 09:01:48,080 [foster.py] => All params: 171889432
2024-04-22 09:01:48,082 [foster.py] => Trainable params: 86029256
2024-04-22 09:01:48,138 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 5.888, Loss_clf 1.346, Loss_fe 2.833, Loss_kd 1.367, Train_accy 60.94, Test_accy 74.33:   0%|          | 0/20 [00:28<?, ?it/s]
Task 4, Epoch 1/20 => Loss 5.888, Loss_clf 1.346, Loss_fe 2.833, Loss_kd 1.367, Train_accy 60.94, Test_accy 74.33:   5%|▌         | 1/20 [00:28<09:10, 28.97s/it]
Task 4, Epoch 2/20 => Loss 3.305, Loss_clf 0.700, Loss_fe 0.913, Loss_kd 1.353, Train_accy 66.03:   5%|▌         | 1/20 [00:51<09:10, 28.97s/it]                 
Task 4, Epoch 2/20 => Loss 3.305, Loss_clf 0.700, Loss_fe 0.913, Loss_kd 1.353, Train_accy 66.03:  10%|█         | 2/20 [00:51<07:35, 25.28s/it]
Task 4, Epoch 3/20 => Loss 2.959, Loss_clf 0.575, Loss_fe 0.710, Loss_kd 1.340, Train_accy 67.02:  10%|█         | 2/20 [01:14<07:35, 25.28s/it]
Task 4, Epoch 3/20 => Loss 2.959, Loss_clf 0.575, Loss_fe 0.710, Loss_kd 1.340, Train_accy 67.02:  15%|█▌        | 3/20 [01:14<06:50, 24.15s/it]
Task 4, Epoch 4/20 => Loss 2.846, Loss_clf 0.563, Loss_fe 0.609, Loss_kd 1.339, Train_accy 68.38:  15%|█▌        | 3/20 [01:37<06:50, 24.15s/it]
Task 4, Epoch 4/20 => Loss 2.846, Loss_clf 0.563, Loss_fe 0.609, Loss_kd 1.339, Train_accy 68.38:  20%|██        | 4/20 [01:37<06:18, 23.63s/it]
Task 4, Epoch 5/20 => Loss 2.699, Loss_clf 0.517, Loss_fe 0.539, Loss_kd 1.315, Train_accy 67.78:  20%|██        | 4/20 [02:00<06:18, 23.63s/it]
Task 4, Epoch 5/20 => Loss 2.699, Loss_clf 0.517, Loss_fe 0.539, Loss_kd 1.315, Train_accy 67.78:  25%|██▌       | 5/20 [02:00<05:50, 23.35s/it]
Task 4, Epoch 6/20 => Loss 2.568, Loss_clf 0.465, Loss_fe 0.441, Loss_kd 1.330, Train_accy 70.21, Test_accy 77.61:  25%|██▌       | 5/20 [02:29<05:50, 23.35s/it]
Task 4, Epoch 6/20 => Loss 2.568, Loss_clf 0.465, Loss_fe 0.441, Loss_kd 1.330, Train_accy 70.21, Test_accy 77.61:  30%|███       | 6/20 [02:29<05:55, 25.42s/it]
Task 4, Epoch 7/20 => Loss 2.569, Loss_clf 0.477, Loss_fe 0.443, Loss_kd 1.319, Train_accy 70.56:  30%|███       | 6/20 [02:52<05:55, 25.42s/it]                 
Task 4, Epoch 7/20 => Loss 2.569, Loss_clf 0.477, Loss_fe 0.443, Loss_kd 1.319, Train_accy 70.56:  35%|███▌      | 7/20 [02:52<05:19, 24.55s/it]
Task 4, Epoch 8/20 => Loss 2.532, Loss_clf 0.468, Loss_fe 0.425, Loss_kd 1.311, Train_accy 71.68:  35%|███▌      | 7/20 [03:15<05:19, 24.55s/it]
Task 4, Epoch 8/20 => Loss 2.532, Loss_clf 0.468, Loss_fe 0.425, Loss_kd 1.311, Train_accy 71.68:  40%|████      | 8/20 [03:15<04:47, 24.00s/it]
Task 4, Epoch 9/20 => Loss 2.541, Loss_clf 0.461, Loss_fe 0.404, Loss_kd 1.341, Train_accy 70.64:  40%|████      | 8/20 [03:37<04:47, 24.00s/it]
Task 4, Epoch 9/20 => Loss 2.541, Loss_clf 0.461, Loss_fe 0.404, Loss_kd 1.341, Train_accy 70.64:  45%|████▌     | 9/20 [03:37<04:19, 23.62s/it]
Task 4, Epoch 10/20 => Loss 2.360, Loss_clf 0.378, Loss_fe 0.335, Loss_kd 1.318, Train_accy 74.66:  45%|████▌     | 9/20 [04:00<04:19, 23.62s/it]
Task 4, Epoch 10/20 => Loss 2.360, Loss_clf 0.378, Loss_fe 0.335, Loss_kd 1.318, Train_accy 74.66:  50%|█████     | 10/20 [04:00<03:54, 23.41s/it]
Task 4, Epoch 11/20 => Loss 2.469, Loss_clf 0.428, Loss_fe 0.381, Loss_kd 1.328, Train_accy 73.83, Test_accy 78.70:  50%|█████     | 10/20 [04:30<03:54, 23.41s/it]
Task 4, Epoch 11/20 => Loss 2.469, Loss_clf 0.428, Loss_fe 0.381, Loss_kd 1.328, Train_accy 73.83, Test_accy 78.70:  55%|█████▌    | 11/20 [04:30<03:47, 25.26s/it]
Task 4, Epoch 12/20 => Loss 2.329, Loss_clf 0.372, Loss_fe 0.315, Loss_kd 1.314, Train_accy 74.94:  55%|█████▌    | 11/20 [04:53<03:47, 25.26s/it]                 
Task 4, Epoch 12/20 => Loss 2.329, Loss_clf 0.372, Loss_fe 0.315, Loss_kd 1.314, Train_accy 74.94:  60%|██████    | 12/20 [04:53<03:16, 24.53s/it]
Task 4, Epoch 13/20 => Loss 2.367, Loss_clf 0.393, Loss_fe 0.318, Loss_kd 1.324, Train_accy 73.15:  60%|██████    | 12/20 [05:15<03:16, 24.53s/it]
Task 4, Epoch 13/20 => Loss 2.367, Loss_clf 0.393, Loss_fe 0.318, Loss_kd 1.324, Train_accy 73.15:  65%|██████▌   | 13/20 [05:15<02:47, 23.99s/it]
Task 4, Epoch 14/20 => Loss 2.207, Loss_clf 0.332, Loss_fe 0.253, Loss_kd 1.298, Train_accy 75.97:  65%|██████▌   | 13/20 [05:38<02:47, 23.99s/it]
Task 4, Epoch 14/20 => Loss 2.207, Loss_clf 0.332, Loss_fe 0.253, Loss_kd 1.298, Train_accy 75.97:  70%|███████   | 14/20 [05:38<02:21, 23.63s/it]
Task 4, Epoch 15/20 => Loss 2.413, Loss_clf 0.408, Loss_fe 0.330, Loss_kd 1.340, Train_accy 73.31:  70%|███████   | 14/20 [06:01<02:21, 23.63s/it]
Task 4, Epoch 15/20 => Loss 2.413, Loss_clf 0.408, Loss_fe 0.330, Loss_kd 1.340, Train_accy 73.31:  75%|███████▌  | 15/20 [06:01<01:57, 23.42s/it]
Task 4, Epoch 16/20 => Loss 2.324, Loss_clf 0.370, Loss_fe 0.290, Loss_kd 1.332, Train_accy 75.82, Test_accy 77.10:  75%|███████▌  | 15/20 [06:30<01:57, 23.42s/it]
Task 4, Epoch 16/20 => Loss 2.324, Loss_clf 0.370, Loss_fe 0.290, Loss_kd 1.332, Train_accy 75.82, Test_accy 77.10:  80%|████████  | 16/20 [06:30<01:40, 25.19s/it]
Task 4, Epoch 17/20 => Loss 2.272, Loss_clf 0.355, Loss_fe 0.273, Loss_kd 1.316, Train_accy 74.54:  80%|████████  | 16/20 [06:53<01:40, 25.19s/it]                 
Task 4, Epoch 17/20 => Loss 2.272, Loss_clf 0.355, Loss_fe 0.273, Loss_kd 1.316, Train_accy 74.54:  85%|████████▌ | 17/20 [06:53<01:13, 24.48s/it]
Task 4, Epoch 18/20 => Loss 2.213, Loss_clf 0.319, Loss_fe 0.255, Loss_kd 1.311, Train_accy 74.94:  85%|████████▌ | 17/20 [07:16<01:13, 24.48s/it]
Task 4, Epoch 18/20 => Loss 2.213, Loss_clf 0.319, Loss_fe 0.255, Loss_kd 1.311, Train_accy 74.94:  90%|█████████ | 18/20 [07:16<00:47, 23.97s/it]
Task 4, Epoch 19/20 => Loss 2.211, Loss_clf 0.324, Loss_fe 0.258, Loss_kd 1.303, Train_accy 75.66:  90%|█████████ | 18/20 [07:39<00:47, 23.97s/it]
Task 4, Epoch 19/20 => Loss 2.211, Loss_clf 0.324, Loss_fe 0.258, Loss_kd 1.303, Train_accy 75.66:  95%|█████████▌| 19/20 [07:39<00:23, 23.61s/it]
Task 4, Epoch 20/20 => Loss 2.299, Loss_clf 0.361, Loss_fe 0.285, Loss_kd 1.323, Train_accy 74.58:  95%|█████████▌| 19/20 [08:02<00:23, 23.61s/it]
Task 4, Epoch 20/20 => Loss 2.299, Loss_clf 0.361, Loss_fe 0.285, Loss_kd 1.323, Train_accy 74.58: 100%|██████████| 20/20 [08:02<00:00, 23.41s/it]
Task 4, Epoch 20/20 => Loss 2.299, Loss_clf 0.361, Loss_fe 0.285, Loss_kd 1.323, Train_accy 74.58: 100%|██████████| 20/20 [08:02<00:00, 24.12s/it]
2024-04-22 09:09:50,478 [foster.py] => Task 4, Epoch 20/20 => Loss 2.299, Loss_clf 0.361, Loss_fe 0.285, Loss_kd 1.323, Train_accy 74.58
2024-04-22 09:09:50,480 [foster.py] => do not weight align teacher!
2024-04-22 09:09:50,484 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.685,  Train_accy 57.80, Test_accy 74.66:   0%|          | 0/20 [00:32<?, ?it/s]
SNet: Task 4, Epoch 1/20 => Loss 1.685,  Train_accy 57.80, Test_accy 74.66:   5%|▌         | 1/20 [00:32<10:17, 32.52s/it]
SNet: Task 4, Epoch 2/20 => Loss 1.537,  Train_accy 63.48:   5%|▌         | 1/20 [01:01<10:17, 32.52s/it]                 
SNet: Task 4, Epoch 2/20 => Loss 1.537,  Train_accy 63.48:  10%|█         | 2/20 [01:01<09:04, 30.23s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.450,  Train_accy 65.95:  10%|█         | 2/20 [01:29<09:04, 30.23s/it]
SNet: Task 4, Epoch 3/20 => Loss 1.450,  Train_accy 65.95:  15%|█▌        | 3/20 [01:29<08:21, 29.52s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.489,  Train_accy 66.19:  15%|█▌        | 3/20 [01:58<08:21, 29.52s/it]
SNet: Task 4, Epoch 4/20 => Loss 1.489,  Train_accy 66.19:  20%|██        | 4/20 [01:58<07:46, 29.18s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.461,  Train_accy 66.98:  20%|██        | 4/20 [02:27<07:46, 29.18s/it]
SNet: Task 4, Epoch 5/20 => Loss 1.461,  Train_accy 66.98:  25%|██▌       | 5/20 [02:27<07:14, 28.98s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.486,  Train_accy 66.11, Test_accy 76.68:  25%|██▌       | 5/20 [02:59<07:14, 28.98s/it]
SNet: Task 4, Epoch 6/20 => Loss 1.486,  Train_accy 66.11, Test_accy 76.68:  30%|███       | 6/20 [02:59<07:01, 30.14s/it]
SNet: Task 4, Epoch 7/20 => Loss 1.459,  Train_accy 67.38:  30%|███       | 6/20 [03:28<07:01, 30.14s/it]                 
SNet: Task 4, Epoch 7/20 => Loss 1.459,  Train_accy 67.38:  35%|███▌      | 7/20 [03:28<06:25, 29.64s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.439,  Train_accy 67.46:  35%|███▌      | 7/20 [03:56<06:25, 29.64s/it]
SNet: Task 4, Epoch 8/20 => Loss 1.439,  Train_accy 67.46:  40%|████      | 8/20 [03:56<05:51, 29.30s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.442,  Train_accy 67.26:  40%|████      | 8/20 [04:25<05:51, 29.30s/it]
SNet: Task 4, Epoch 9/20 => Loss 1.442,  Train_accy 67.26:  45%|████▌     | 9/20 [04:25<05:20, 29.14s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.467,  Train_accy 66.87:  45%|████▌     | 9/20 [04:54<05:20, 29.14s/it]
SNet: Task 4, Epoch 10/20 => Loss 1.467,  Train_accy 66.87:  50%|█████     | 10/20 [04:54<04:49, 28.99s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.483,  Train_accy 66.27, Test_accy 75.59:  50%|█████     | 10/20 [05:26<04:49, 28.99s/it]
SNet: Task 4, Epoch 11/20 => Loss 1.483,  Train_accy 66.27, Test_accy 75.59:  55%|█████▌    | 11/20 [05:26<04:30, 30.00s/it]
SNet: Task 4, Epoch 12/20 => Loss 1.451,  Train_accy 67.98:  55%|█████▌    | 11/20 [05:55<04:30, 30.00s/it]                 
SNet: Task 4, Epoch 12/20 => Loss 1.451,  Train_accy 67.98:  60%|██████    | 12/20 [05:55<03:56, 29.58s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.453,  Train_accy 67.18:  60%|██████    | 12/20 [06:23<03:56, 29.58s/it]
SNet: Task 4, Epoch 13/20 => Loss 1.453,  Train_accy 67.18:  65%|██████▌   | 13/20 [06:23<03:25, 29.29s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.410,  Train_accy 67.90:  65%|██████▌   | 13/20 [06:52<03:25, 29.29s/it]
SNet: Task 4, Epoch 14/20 => Loss 1.410,  Train_accy 67.90:  70%|███████   | 14/20 [06:52<02:54, 29.12s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.474,  Train_accy 66.51:  70%|███████   | 14/20 [07:21<02:54, 29.12s/it]
SNet: Task 4, Epoch 15/20 => Loss 1.474,  Train_accy 66.51:  75%|███████▌  | 15/20 [07:21<02:24, 28.98s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.445,  Train_accy 68.10, Test_accy 75.67:  75%|███████▌  | 15/20 [07:53<02:24, 28.98s/it]
SNet: Task 4, Epoch 16/20 => Loss 1.445,  Train_accy 68.10, Test_accy 75.67:  80%|████████  | 16/20 [07:53<02:00, 30.01s/it]
SNet: Task 4, Epoch 17/20 => Loss 1.472,  Train_accy 66.98:  80%|████████  | 16/20 [08:22<02:00, 30.01s/it]                 
SNet: Task 4, Epoch 17/20 => Loss 1.472,  Train_accy 66.98:  85%|████████▌ | 17/20 [08:22<01:28, 29.58s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.432,  Train_accy 68.18:  85%|████████▌ | 17/20 [08:50<01:28, 29.58s/it]
SNet: Task 4, Epoch 18/20 => Loss 1.432,  Train_accy 68.18:  90%|█████████ | 18/20 [08:50<00:58, 29.29s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.407,  Train_accy 68.50:  90%|█████████ | 18/20 [09:19<00:58, 29.29s/it]
SNet: Task 4, Epoch 19/20 => Loss 1.407,  Train_accy 68.50:  95%|█████████▌| 19/20 [09:19<00:29, 29.11s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.457,  Train_accy 67.70:  95%|█████████▌| 19/20 [09:47<00:29, 29.11s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.457,  Train_accy 67.70: 100%|██████████| 20/20 [09:47<00:00, 28.96s/it]
SNet: Task 4, Epoch 20/20 => Loss 1.457,  Train_accy 67.70: 100%|██████████| 20/20 [09:47<00:00, 29.40s/it]
2024-04-22 09:19:41,989 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.457,  Train_accy 67.70
2024-04-22 09:19:41,989 [foster.py] => do not weight align student!
2024-04-22 09:19:45,735 [foster.py] => darknet eval: 
2024-04-22 09:19:45,736 [foster.py] => CNN top1 curve: 75.76
2024-04-22 09:19:45,736 [foster.py] => CNN top5 curve: 97.39
2024-04-22 09:19:45,740 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 09:20:58,990 [foster.py] => Exemplar size: 2000
2024-04-22 09:20:58,990 [trainer.py] => CNN: {'total': 76.35, '00-19': 94.74, '20-39': 91.79, '40-59': 86.7, '60-79': 70.04, '80-99': 44.98, 'old': 85.53, 'new': 44.98}
2024-04-22 09:20:58,991 [trainer.py] => NME: {'total': 91.16, '00-19': 88.66, '20-39': 88.89, '40-59': 92.66, '60-79': 92.31, '80-99': 92.94, 'old': 90.64, 'new': 92.94}
2024-04-22 09:20:58,991 [trainer.py] => CNN top1 curve: [97.57, 84.58, 84.52, 76.17, 76.35]
2024-04-22 09:20:58,991 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.66, 98.26, 97.98]
2024-04-22 09:20:58,991 [trainer.py] => NME top1 curve: [98.38, 96.04, 93.6, 92.38, 91.16]
2024-04-22 09:20:58,991 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.02, 98.91]

Average Accuracy (CNN): 83.84
Average Accuracy (NME): 94.31
2024-04-22 09:20:58,991 [trainer.py] => Average Accuracy (CNN): 83.84
2024-04-22 09:20:58,991 [trainer.py] => Average Accuracy (NME): 94.31
2024-04-22 09:20:58,991 [trainer.py] => Train Time: 3491.3
2024-04-22 09:20:58,991 [trainer.py] => Test Time: 38.98 

2024-04-22 09:20:58,992 [trainer.py] => All params: 171889432
2024-04-22 09:20:58,993 [trainer.py] => Trainable params: 86029256
2024-04-22 09:21:01,104 [foster.py] => Learning on 100-120
2024-04-22 09:21:01,106 [foster.py] => All params: 171950932
2024-04-22 09:21:01,107 [foster.py] => Trainable params: 86075376
2024-04-22 09:21:01,160 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 5.885, Loss_clf 1.297, Loss_fe 2.900, Loss_kd 1.407, Train_accy 63.25, Test_accy 79.80:   0%|          | 0/20 [00:33<?, ?it/s]
Task 5, Epoch 1/20 => Loss 5.885, Loss_clf 1.297, Loss_fe 2.900, Loss_kd 1.407, Train_accy 63.25, Test_accy 79.80:   5%|▌         | 1/20 [00:33<10:44, 33.94s/it]
Task 5, Epoch 2/20 => Loss 3.320, Loss_clf 0.706, Loss_fe 0.926, Loss_kd 1.407, Train_accy 66.60:   5%|▌         | 1/20 [01:00<10:44, 33.94s/it]                 
Task 5, Epoch 2/20 => Loss 3.320, Loss_clf 0.706, Loss_fe 0.926, Loss_kd 1.407, Train_accy 66.60:  10%|█         | 2/20 [01:00<08:52, 29.59s/it]
Task 5, Epoch 3/20 => Loss 2.991, Loss_clf 0.602, Loss_fe 0.730, Loss_kd 1.382, Train_accy 68.67:  10%|█         | 2/20 [01:27<08:52, 29.59s/it]
Task 5, Epoch 3/20 => Loss 2.991, Loss_clf 0.602, Loss_fe 0.730, Loss_kd 1.382, Train_accy 68.67:  15%|█▌        | 3/20 [01:27<07:59, 28.23s/it]
Task 5, Epoch 4/20 => Loss 2.871, Loss_clf 0.569, Loss_fe 0.622, Loss_kd 1.400, Train_accy 68.83:  15%|█▌        | 3/20 [01:53<07:59, 28.23s/it]
Task 5, Epoch 4/20 => Loss 2.871, Loss_clf 0.569, Loss_fe 0.622, Loss_kd 1.400, Train_accy 68.83:  20%|██        | 4/20 [01:53<07:21, 27.60s/it]
Task 5, Epoch 5/20 => Loss 2.652, Loss_clf 0.479, Loss_fe 0.535, Loss_kd 1.366, Train_accy 71.21:  20%|██        | 4/20 [02:20<07:21, 27.60s/it]
Task 5, Epoch 5/20 => Loss 2.652, Loss_clf 0.479, Loss_fe 0.535, Loss_kd 1.366, Train_accy 71.21:  25%|██▌       | 5/20 [02:20<06:49, 27.28s/it]
Task 5, Epoch 6/20 => Loss 2.676, Loss_clf 0.515, Loss_fe 0.495, Loss_kd 1.388, Train_accy 69.92, Test_accy 80.23:  25%|██▌       | 5/20 [02:54<06:49, 27.28s/it]
Task 5, Epoch 6/20 => Loss 2.676, Loss_clf 0.515, Loss_fe 0.495, Loss_kd 1.388, Train_accy 69.92, Test_accy 80.23:  30%|███       | 6/20 [02:54<06:55, 29.67s/it]
Task 5, Epoch 7/20 => Loss 2.649, Loss_clf 0.488, Loss_fe 0.482, Loss_kd 1.399, Train_accy 70.83:  30%|███       | 6/20 [03:21<06:55, 29.67s/it]                 
Task 5, Epoch 7/20 => Loss 2.649, Loss_clf 0.488, Loss_fe 0.482, Loss_kd 1.399, Train_accy 70.83:  35%|███▌      | 7/20 [03:21<06:13, 28.70s/it]
Task 5, Epoch 8/20 => Loss 2.564, Loss_clf 0.468, Loss_fe 0.437, Loss_kd 1.382, Train_accy 70.80:  35%|███▌      | 7/20 [03:48<06:13, 28.70s/it]
Task 5, Epoch 8/20 => Loss 2.564, Loss_clf 0.468, Loss_fe 0.437, Loss_kd 1.382, Train_accy 70.80:  40%|████      | 8/20 [03:48<05:37, 28.12s/it]
Task 5, Epoch 9/20 => Loss 2.450, Loss_clf 0.416, Loss_fe 0.384, Loss_kd 1.375, Train_accy 72.53:  40%|████      | 8/20 [04:15<05:37, 28.12s/it]
Task 5, Epoch 9/20 => Loss 2.450, Loss_clf 0.416, Loss_fe 0.384, Loss_kd 1.375, Train_accy 72.53:  45%|████▌     | 9/20 [04:15<05:05, 27.76s/it]
Task 5, Epoch 10/20 => Loss 2.392, Loss_clf 0.410, Loss_fe 0.364, Loss_kd 1.349, Train_accy 73.24:  45%|████▌     | 9/20 [04:42<05:05, 27.76s/it]
Task 5, Epoch 10/20 => Loss 2.392, Loss_clf 0.410, Loss_fe 0.364, Loss_kd 1.349, Train_accy 73.24:  50%|█████     | 10/20 [04:42<04:35, 27.54s/it]
Task 5, Epoch 11/20 => Loss 2.484, Loss_clf 0.427, Loss_fe 0.386, Loss_kd 1.393, Train_accy 72.97, Test_accy 78.88:  50%|█████     | 10/20 [05:17<04:35, 27.54s/it]
Task 5, Epoch 11/20 => Loss 2.484, Loss_clf 0.427, Loss_fe 0.386, Loss_kd 1.393, Train_accy 72.97, Test_accy 78.88:  55%|█████▌    | 11/20 [05:17<04:27, 29.75s/it]
Task 5, Epoch 12/20 => Loss 2.383, Loss_clf 0.390, Loss_fe 0.351, Loss_kd 1.368, Train_accy 73.41:  55%|█████▌    | 11/20 [05:44<04:27, 29.75s/it]                 
Task 5, Epoch 12/20 => Loss 2.383, Loss_clf 0.390, Loss_fe 0.351, Loss_kd 1.368, Train_accy 73.41:  60%|██████    | 12/20 [05:44<03:51, 28.92s/it]
Task 5, Epoch 13/20 => Loss 2.371, Loss_clf 0.394, Loss_fe 0.330, Loss_kd 1.372, Train_accy 73.51:  60%|██████    | 12/20 [06:11<03:51, 28.92s/it]
Task 5, Epoch 13/20 => Loss 2.371, Loss_clf 0.394, Loss_fe 0.330, Loss_kd 1.372, Train_accy 73.51:  65%|██████▌   | 13/20 [06:11<03:18, 28.33s/it]
Task 5, Epoch 14/20 => Loss 2.366, Loss_clf 0.389, Loss_fe 0.322, Loss_kd 1.379, Train_accy 73.68:  65%|██████▌   | 13/20 [06:38<03:18, 28.33s/it]
Task 5, Epoch 14/20 => Loss 2.366, Loss_clf 0.389, Loss_fe 0.322, Loss_kd 1.379, Train_accy 73.68:  70%|███████   | 14/20 [06:38<02:47, 27.91s/it]
Task 5, Epoch 15/20 => Loss 2.253, Loss_clf 0.351, Loss_fe 0.281, Loss_kd 1.350, Train_accy 73.95:  70%|███████   | 14/20 [07:04<02:47, 27.91s/it]
Task 5, Epoch 15/20 => Loss 2.253, Loss_clf 0.351, Loss_fe 0.281, Loss_kd 1.350, Train_accy 73.95:  75%|███████▌  | 15/20 [07:04<02:18, 27.61s/it]
Task 5, Epoch 16/20 => Loss 2.312, Loss_clf 0.373, Loss_fe 0.300, Loss_kd 1.366, Train_accy 73.71, Test_accy 79.94:  75%|███████▌  | 15/20 [07:39<02:18, 27.61s/it]
Task 5, Epoch 16/20 => Loss 2.312, Loss_clf 0.373, Loss_fe 0.300, Loss_kd 1.366, Train_accy 73.71, Test_accy 79.94:  80%|████████  | 16/20 [07:39<01:58, 29.72s/it]
Task 5, Epoch 17/20 => Loss 2.279, Loss_clf 0.360, Loss_fe 0.291, Loss_kd 1.356, Train_accy 74.09:  80%|████████  | 16/20 [08:06<01:58, 29.72s/it]                 
Task 5, Epoch 17/20 => Loss 2.279, Loss_clf 0.360, Loss_fe 0.291, Loss_kd 1.356, Train_accy 74.09:  85%|████████▌ | 17/20 [08:06<01:26, 28.90s/it]
Task 5, Epoch 18/20 => Loss 2.304, Loss_clf 0.361, Loss_fe 0.298, Loss_kd 1.370, Train_accy 73.31:  85%|████████▌ | 17/20 [08:33<01:26, 28.90s/it]
Task 5, Epoch 18/20 => Loss 2.304, Loss_clf 0.361, Loss_fe 0.298, Loss_kd 1.370, Train_accy 73.31:  90%|█████████ | 18/20 [08:33<00:56, 28.35s/it]
Task 5, Epoch 19/20 => Loss 2.232, Loss_clf 0.344, Loss_fe 0.266, Loss_kd 1.351, Train_accy 73.85:  90%|█████████ | 18/20 [09:00<00:56, 28.35s/it]
Task 5, Epoch 19/20 => Loss 2.232, Loss_clf 0.344, Loss_fe 0.266, Loss_kd 1.351, Train_accy 73.85:  95%|█████████▌| 19/20 [09:00<00:27, 27.93s/it]
Task 5, Epoch 20/20 => Loss 2.271, Loss_clf 0.365, Loss_fe 0.278, Loss_kd 1.357, Train_accy 74.05:  95%|█████████▌| 19/20 [09:27<00:27, 27.93s/it]
Task 5, Epoch 20/20 => Loss 2.271, Loss_clf 0.365, Loss_fe 0.278, Loss_kd 1.357, Train_accy 74.05: 100%|██████████| 20/20 [09:27<00:00, 27.64s/it]
Task 5, Epoch 20/20 => Loss 2.271, Loss_clf 0.365, Loss_fe 0.278, Loss_kd 1.357, Train_accy 74.05: 100%|██████████| 20/20 [09:27<00:00, 28.38s/it]
2024-04-22 09:30:28,730 [foster.py] => Task 5, Epoch 20/20 => Loss 2.271, Loss_clf 0.365, Loss_fe 0.278, Loss_kd 1.357, Train_accy 74.05
2024-04-22 09:30:28,731 [foster.py] => do not weight align teacher!
2024-04-22 09:30:28,733 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.663,  Train_accy 61.62, Test_accy 77.12:   0%|          | 0/20 [00:38<?, ?it/s]
SNet: Task 5, Epoch 1/20 => Loss 1.663,  Train_accy 61.62, Test_accy 77.12:   5%|▌         | 1/20 [00:38<12:08, 38.33s/it]
SNet: Task 5, Epoch 2/20 => Loss 1.530,  Train_accy 65.01:   5%|▌         | 1/20 [01:12<12:08, 38.33s/it]                 
SNet: Task 5, Epoch 2/20 => Loss 1.530,  Train_accy 65.01:  10%|█         | 2/20 [01:12<10:42, 35.70s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.543,  Train_accy 65.82:  10%|█         | 2/20 [01:46<10:42, 35.70s/it]
SNet: Task 5, Epoch 3/20 => Loss 1.543,  Train_accy 65.82:  15%|█▌        | 3/20 [01:46<09:52, 34.86s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.534,  Train_accy 66.97:  15%|█▌        | 3/20 [02:20<09:52, 34.86s/it]
SNet: Task 5, Epoch 4/20 => Loss 1.534,  Train_accy 66.97:  20%|██        | 4/20 [02:20<09:12, 34.53s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.507,  Train_accy 66.84:  20%|██        | 4/20 [02:54<09:12, 34.53s/it]
SNet: Task 5, Epoch 5/20 => Loss 1.507,  Train_accy 66.84:  25%|██▌       | 5/20 [02:54<08:34, 34.32s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.529,  Train_accy 66.63, Test_accy 77.40:  25%|██▌       | 5/20 [03:32<08:34, 34.32s/it]
SNet: Task 5, Epoch 6/20 => Loss 1.529,  Train_accy 66.63, Test_accy 77.40:  30%|███       | 6/20 [03:32<08:19, 35.68s/it]
SNet: Task 5, Epoch 7/20 => Loss 1.473,  Train_accy 68.06:  30%|███       | 6/20 [04:06<08:19, 35.68s/it]                 
SNet: Task 5, Epoch 7/20 => Loss 1.473,  Train_accy 68.06:  35%|███▌      | 7/20 [04:06<07:36, 35.10s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.509,  Train_accy 67.38:  35%|███▌      | 7/20 [04:40<07:36, 35.10s/it]
SNet: Task 5, Epoch 8/20 => Loss 1.509,  Train_accy 67.38:  40%|████      | 8/20 [04:40<06:56, 34.71s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.504,  Train_accy 67.28:  40%|████      | 8/20 [05:14<06:56, 34.71s/it]
SNet: Task 5, Epoch 9/20 => Loss 1.504,  Train_accy 67.28:  45%|████▌     | 9/20 [05:14<06:19, 34.46s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.505,  Train_accy 68.56:  45%|████▌     | 9/20 [05:47<06:19, 34.46s/it]
SNet: Task 5, Epoch 10/20 => Loss 1.505,  Train_accy 68.56:  50%|█████     | 10/20 [05:47<05:42, 34.28s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.528,  Train_accy 66.80, Test_accy 78.32:  50%|█████     | 10/20 [06:26<05:42, 34.28s/it]
SNet: Task 5, Epoch 11/20 => Loss 1.528,  Train_accy 66.80, Test_accy 78.32:  55%|█████▌    | 11/20 [06:26<05:19, 35.46s/it]
SNet: Task 5, Epoch 12/20 => Loss 1.511,  Train_accy 68.43:  55%|█████▌    | 11/20 [06:59<05:19, 35.46s/it]                 
SNet: Task 5, Epoch 12/20 => Loss 1.511,  Train_accy 68.43:  60%|██████    | 12/20 [06:59<04:39, 34.96s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.501,  Train_accy 67.68:  60%|██████    | 12/20 [07:33<04:39, 34.96s/it]
SNet: Task 5, Epoch 13/20 => Loss 1.501,  Train_accy 67.68:  65%|██████▌   | 13/20 [07:33<04:02, 34.62s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.489,  Train_accy 67.99:  65%|██████▌   | 13/20 [08:07<04:02, 34.62s/it]
SNet: Task 5, Epoch 14/20 => Loss 1.489,  Train_accy 67.99:  70%|███████   | 14/20 [08:07<03:26, 34.40s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.531,  Train_accy 67.17:  70%|███████   | 14/20 [08:41<03:26, 34.40s/it]
SNet: Task 5, Epoch 15/20 => Loss 1.531,  Train_accy 67.17:  75%|███████▌  | 15/20 [08:41<02:51, 34.25s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.480,  Train_accy 68.70, Test_accy 77.61:  75%|███████▌  | 15/20 [09:19<02:51, 34.25s/it]
SNet: Task 5, Epoch 16/20 => Loss 1.480,  Train_accy 68.70, Test_accy 77.61:  80%|████████  | 16/20 [09:19<02:21, 35.46s/it]
SNet: Task 5, Epoch 17/20 => Loss 1.503,  Train_accy 68.09:  80%|████████  | 16/20 [09:53<02:21, 35.46s/it]                 
SNet: Task 5, Epoch 17/20 => Loss 1.503,  Train_accy 68.09:  85%|████████▌ | 17/20 [09:53<01:44, 35.00s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.481,  Train_accy 68.12:  85%|████████▌ | 17/20 [10:27<01:44, 35.00s/it]
SNet: Task 5, Epoch 18/20 => Loss 1.481,  Train_accy 68.12:  90%|█████████ | 18/20 [10:27<01:09, 34.65s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.499,  Train_accy 67.92:  90%|█████████ | 18/20 [11:01<01:09, 34.65s/it]
SNet: Task 5, Epoch 19/20 => Loss 1.499,  Train_accy 67.92:  95%|█████████▌| 19/20 [11:01<00:34, 34.45s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.495,  Train_accy 67.04:  95%|█████████▌| 19/20 [11:35<00:34, 34.45s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.495,  Train_accy 67.04: 100%|██████████| 20/20 [11:35<00:00, 34.27s/it]
SNet: Task 5, Epoch 20/20 => Loss 1.495,  Train_accy 67.04: 100%|██████████| 20/20 [11:35<00:00, 34.77s/it]
2024-04-22 09:42:06,651 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.495,  Train_accy 67.04
2024-04-22 09:42:06,652 [foster.py] => do not weight align student!
2024-04-22 09:42:10,943 [foster.py] => darknet eval: 
2024-04-22 09:42:10,944 [foster.py] => CNN top1 curve: 77.54
2024-04-22 09:42:10,944 [foster.py] => CNN top5 curve: 97.39
2024-04-22 09:42:10,947 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 09:43:39,013 [foster.py] => Exemplar size: 2400
2024-04-22 09:43:39,014 [trainer.py] => CNN: {'total': 79.66, '00-19': 94.33, '20-39': 92.75, '40-59': 87.61, '60-79': 85.02, '80-99': 73.23, '100-119': 46.05, 'old': 86.11, 'new': 46.05}
2024-04-22 09:43:39,014 [trainer.py] => NME: {'total': 89.55, '00-19': 87.04, '20-39': 89.86, '40-59': 89.45, '60-79': 88.26, '80-99': 90.33, '100-119': 92.54, 'old': 88.97, 'new': 92.54}
2024-04-22 09:43:39,014 [trainer.py] => CNN top1 curve: [97.57, 84.58, 84.52, 76.17, 76.35, 79.66]
2024-04-22 09:43:39,014 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.66, 98.26, 97.98, 97.67]
2024-04-22 09:43:39,014 [trainer.py] => NME top1 curve: [98.38, 96.04, 93.6, 92.38, 91.16, 89.55]
2024-04-22 09:43:39,014 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.02, 98.91, 98.73]

Average Accuracy (CNN): 83.14
Average Accuracy (NME): 93.52
2024-04-22 09:43:39,014 [trainer.py] => Average Accuracy (CNN): 83.14
2024-04-22 09:43:39,014 [trainer.py] => Average Accuracy (NME): 93.52
2024-04-22 09:43:39,014 [trainer.py] => Train Time: 4761.14
2024-04-22 09:43:39,014 [trainer.py] => Test Time: 54.339999999999996 

2024-04-22 09:43:39,016 [trainer.py] => All params: 171950932
2024-04-22 09:43:39,017 [trainer.py] => Trainable params: 86075376
2024-04-22 09:43:41,752 [foster.py] => Learning on 120-140
2024-04-22 09:43:41,755 [foster.py] => All params: 172012432
2024-04-22 09:43:41,757 [foster.py] => Trainable params: 86121496
2024-04-22 09:43:41,819 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 6.335, Loss_clf 1.326, Loss_fe 3.255, Loss_kd 1.504, Train_accy 64.37, Test_accy 76.72:   0%|          | 0/20 [00:39<?, ?it/s]
Task 6, Epoch 1/20 => Loss 6.335, Loss_clf 1.326, Loss_fe 3.255, Loss_kd 1.504, Train_accy 64.37, Test_accy 76.72:   5%|▌         | 1/20 [00:39<12:22, 39.10s/it]
Task 6, Epoch 2/20 => Loss 3.687, Loss_clf 0.844, Loss_fe 1.091, Loss_kd 1.502, Train_accy 67.08:   5%|▌         | 1/20 [01:09<12:22, 39.10s/it]                 
Task 6, Epoch 2/20 => Loss 3.687, Loss_clf 0.844, Loss_fe 1.091, Loss_kd 1.502, Train_accy 67.08:  10%|█         | 2/20 [01:09<10:08, 33.83s/it]
Task 6, Epoch 3/20 => Loss 3.265, Loss_clf 0.719, Loss_fe 0.810, Loss_kd 1.488, Train_accy 68.93:  10%|█         | 2/20 [01:39<10:08, 33.83s/it]
Task 6, Epoch 3/20 => Loss 3.265, Loss_clf 0.719, Loss_fe 0.810, Loss_kd 1.488, Train_accy 68.93:  15%|█▌        | 3/20 [01:39<09:07, 32.21s/it]
Task 6, Epoch 4/20 => Loss 3.050, Loss_clf 0.624, Loss_fe 0.691, Loss_kd 1.487, Train_accy 71.05:  15%|█▌        | 3/20 [02:09<09:07, 32.21s/it]
Task 6, Epoch 4/20 => Loss 3.050, Loss_clf 0.624, Loss_fe 0.691, Loss_kd 1.487, Train_accy 71.05:  20%|██        | 4/20 [02:09<08:23, 31.44s/it]
Task 6, Epoch 5/20 => Loss 2.824, Loss_clf 0.536, Loss_fe 0.568, Loss_kd 1.474, Train_accy 71.85:  20%|██        | 4/20 [02:40<08:23, 31.44s/it]
Task 6, Epoch 5/20 => Loss 2.824, Loss_clf 0.536, Loss_fe 0.568, Loss_kd 1.474, Train_accy 71.85:  25%|██▌       | 5/20 [02:40<07:45, 31.03s/it]
Task 6, Epoch 6/20 => Loss 2.786, Loss_clf 0.521, Loss_fe 0.546, Loss_kd 1.473, Train_accy 71.94, Test_accy 78.43:  25%|██▌       | 5/20 [03:21<07:45, 31.03s/it]
Task 6, Epoch 6/20 => Loss 2.786, Loss_clf 0.521, Loss_fe 0.546, Loss_kd 1.473, Train_accy 71.94, Test_accy 78.43:  30%|███       | 6/20 [03:21<08:01, 34.40s/it]
Task 6, Epoch 7/20 => Loss 2.623, Loss_clf 0.473, Loss_fe 0.470, Loss_kd 1.440, Train_accy 73.52:  30%|███       | 6/20 [03:53<08:01, 34.40s/it]                 
Task 6, Epoch 7/20 => Loss 2.623, Loss_clf 0.473, Loss_fe 0.470, Loss_kd 1.440, Train_accy 73.52:  35%|███▌      | 7/20 [03:53<07:20, 33.91s/it]
Task 6, Epoch 8/20 => Loss 2.649, Loss_clf 0.480, Loss_fe 0.468, Loss_kd 1.458, Train_accy 72.15:  35%|███▌      | 7/20 [04:27<07:20, 33.91s/it]
Task 6, Epoch 8/20 => Loss 2.649, Loss_clf 0.480, Loss_fe 0.468, Loss_kd 1.458, Train_accy 72.15:  40%|████      | 8/20 [04:27<06:43, 33.66s/it]
Task 6, Epoch 9/20 => Loss 2.686, Loss_clf 0.470, Loss_fe 0.467, Loss_kd 1.499, Train_accy 74.27:  40%|████      | 8/20 [04:59<06:43, 33.66s/it]
Task 6, Epoch 9/20 => Loss 2.686, Loss_clf 0.470, Loss_fe 0.467, Loss_kd 1.499, Train_accy 74.27:  45%|████▌     | 9/20 [04:59<06:07, 33.41s/it]
Task 6, Epoch 10/20 => Loss 2.597, Loss_clf 0.458, Loss_fe 0.417, Loss_kd 1.475, Train_accy 75.10:  45%|████▌     | 9/20 [05:30<06:07, 33.41s/it]
Task 6, Epoch 10/20 => Loss 2.597, Loss_clf 0.458, Loss_fe 0.417, Loss_kd 1.475, Train_accy 75.10:  50%|█████     | 10/20 [05:30<05:24, 32.42s/it]
Task 6, Epoch 11/20 => Loss 2.501, Loss_clf 0.422, Loss_fe 0.383, Loss_kd 1.455, Train_accy 75.28, Test_accy 78.73:  50%|█████     | 10/20 [06:09<05:24, 32.42s/it]
Task 6, Epoch 11/20 => Loss 2.501, Loss_clf 0.422, Loss_fe 0.383, Loss_kd 1.455, Train_accy 75.28, Test_accy 78.73:  55%|█████▌    | 11/20 [06:09<05:10, 34.55s/it]
Task 6, Epoch 12/20 => Loss 2.557, Loss_clf 0.424, Loss_fe 0.394, Loss_kd 1.490, Train_accy 74.30:  55%|█████▌    | 11/20 [06:39<05:10, 34.55s/it]                 
Task 6, Epoch 12/20 => Loss 2.557, Loss_clf 0.424, Loss_fe 0.394, Loss_kd 1.490, Train_accy 74.30:  60%|██████    | 12/20 [06:39<04:25, 33.25s/it]
Task 6, Epoch 13/20 => Loss 2.486, Loss_clf 0.420, Loss_fe 0.352, Loss_kd 1.470, Train_accy 74.72:  60%|██████    | 12/20 [07:10<04:25, 33.25s/it]
Task 6, Epoch 13/20 => Loss 2.486, Loss_clf 0.420, Loss_fe 0.352, Loss_kd 1.470, Train_accy 74.72:  65%|██████▌   | 13/20 [07:10<03:46, 32.35s/it]
Task 6, Epoch 14/20 => Loss 2.481, Loss_clf 0.406, Loss_fe 0.355, Loss_kd 1.475, Train_accy 76.30:  65%|██████▌   | 13/20 [07:40<03:46, 32.35s/it]
Task 6, Epoch 14/20 => Loss 2.481, Loss_clf 0.406, Loss_fe 0.355, Loss_kd 1.475, Train_accy 76.30:  70%|███████   | 14/20 [07:40<03:10, 31.68s/it]
Task 6, Epoch 15/20 => Loss 2.510, Loss_clf 0.418, Loss_fe 0.363, Loss_kd 1.482, Train_accy 76.89:  70%|███████   | 14/20 [08:10<03:10, 31.68s/it]
Task 6, Epoch 15/20 => Loss 2.510, Loss_clf 0.418, Loss_fe 0.363, Loss_kd 1.482, Train_accy 76.89:  75%|███████▌  | 15/20 [08:10<02:36, 31.24s/it]
Task 6, Epoch 16/20 => Loss 2.400, Loss_clf 0.367, Loss_fe 0.311, Loss_kd 1.476, Train_accy 76.36, Test_accy 78.43:  75%|███████▌  | 15/20 [08:49<02:36, 31.24s/it]
Task 6, Epoch 16/20 => Loss 2.400, Loss_clf 0.367, Loss_fe 0.311, Loss_kd 1.476, Train_accy 76.36, Test_accy 78.43:  80%|████████  | 16/20 [08:49<02:14, 33.61s/it]
Task 6, Epoch 17/20 => Loss 2.436, Loss_clf 0.390, Loss_fe 0.327, Loss_kd 1.473, Train_accy 75.97:  80%|████████  | 16/20 [09:19<02:14, 33.61s/it]                 
Task 6, Epoch 17/20 => Loss 2.436, Loss_clf 0.390, Loss_fe 0.327, Loss_kd 1.473, Train_accy 75.97:  85%|████████▌ | 17/20 [09:19<01:37, 32.63s/it]
Task 6, Epoch 18/20 => Loss 2.435, Loss_clf 0.390, Loss_fe 0.321, Loss_kd 1.478, Train_accy 75.64:  85%|████████▌ | 17/20 [09:50<01:37, 32.63s/it]
Task 6, Epoch 18/20 => Loss 2.435, Loss_clf 0.390, Loss_fe 0.321, Loss_kd 1.478, Train_accy 75.64:  90%|█████████ | 18/20 [09:50<01:03, 31.93s/it]
Task 6, Epoch 19/20 => Loss 2.395, Loss_clf 0.371, Loss_fe 0.302, Loss_kd 1.475, Train_accy 76.18:  90%|█████████ | 18/20 [10:20<01:03, 31.93s/it]
Task 6, Epoch 19/20 => Loss 2.395, Loss_clf 0.371, Loss_fe 0.302, Loss_kd 1.475, Train_accy 76.18:  95%|█████████▌| 19/20 [10:20<00:31, 31.43s/it]
Task 6, Epoch 20/20 => Loss 2.393, Loss_clf 0.380, Loss_fe 0.305, Loss_kd 1.464, Train_accy 75.94:  95%|█████████▌| 19/20 [10:50<00:31, 31.43s/it]
Task 6, Epoch 20/20 => Loss 2.393, Loss_clf 0.380, Loss_fe 0.305, Loss_kd 1.464, Train_accy 75.94: 100%|██████████| 20/20 [10:50<00:00, 31.07s/it]
Task 6, Epoch 20/20 => Loss 2.393, Loss_clf 0.380, Loss_fe 0.305, Loss_kd 1.464, Train_accy 75.94: 100%|██████████| 20/20 [10:50<00:00, 32.53s/it]
2024-04-22 09:54:32,465 [foster.py] => Task 6, Epoch 20/20 => Loss 2.393, Loss_clf 0.380, Loss_fe 0.305, Loss_kd 1.464, Train_accy 75.94
2024-04-22 09:54:32,465 [foster.py] => do not weight align teacher!
2024-04-22 09:54:32,468 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.727,  Train_accy 62.67, Test_accy 75.56:   0%|          | 0/20 [00:42<?, ?it/s]
SNet: Task 6, Epoch 1/20 => Loss 1.727,  Train_accy 62.67, Test_accy 75.56:   5%|▌         | 1/20 [00:42<13:35, 42.92s/it]
SNet: Task 6, Epoch 2/20 => Loss 1.606,  Train_accy 67.05:   5%|▌         | 1/20 [01:21<13:35, 42.92s/it]                 
SNet: Task 6, Epoch 2/20 => Loss 1.606,  Train_accy 67.05:  10%|█         | 2/20 [01:21<12:02, 40.14s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.562,  Train_accy 68.25:  10%|█         | 2/20 [01:59<12:02, 40.14s/it]
SNet: Task 6, Epoch 3/20 => Loss 1.562,  Train_accy 68.25:  15%|█▌        | 3/20 [01:59<11:06, 39.22s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.586,  Train_accy 68.13:  15%|█▌        | 3/20 [02:37<11:06, 39.22s/it]
SNet: Task 6, Epoch 4/20 => Loss 1.586,  Train_accy 68.13:  20%|██        | 4/20 [02:37<10:20, 38.76s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.604,  Train_accy 68.81:  20%|██        | 4/20 [03:15<10:20, 38.76s/it]
SNet: Task 6, Epoch 5/20 => Loss 1.604,  Train_accy 68.81:  25%|██▌       | 5/20 [03:15<09:37, 38.52s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.547,  Train_accy 68.99, Test_accy 77.21:  25%|██▌       | 5/20 [03:58<09:37, 38.52s/it]
SNet: Task 6, Epoch 6/20 => Loss 1.547,  Train_accy 68.99, Test_accy 77.21:  30%|███       | 6/20 [03:58<09:21, 40.09s/it]
SNet: Task 6, Epoch 7/20 => Loss 1.579,  Train_accy 68.19:  30%|███       | 6/20 [04:36<09:21, 40.09s/it]                 
SNet: Task 6, Epoch 7/20 => Loss 1.579,  Train_accy 68.19:  35%|███▌      | 7/20 [04:36<08:33, 39.47s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.569,  Train_accy 69.35:  35%|███▌      | 7/20 [05:14<08:33, 39.47s/it]
SNet: Task 6, Epoch 8/20 => Loss 1.569,  Train_accy 69.35:  40%|████      | 8/20 [05:14<07:48, 39.04s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.567,  Train_accy 69.80:  40%|████      | 8/20 [05:52<07:48, 39.04s/it]
SNet: Task 6, Epoch 9/20 => Loss 1.567,  Train_accy 69.80:  45%|████▌     | 9/20 [05:52<07:05, 38.73s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.556,  Train_accy 69.08:  45%|████▌     | 9/20 [06:30<07:05, 38.73s/it]
SNet: Task 6, Epoch 10/20 => Loss 1.556,  Train_accy 69.08:  50%|█████     | 10/20 [06:30<06:25, 38.52s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.561,  Train_accy 69.14, Test_accy 77.82:  50%|█████     | 10/20 [07:14<06:25, 38.52s/it]
SNet: Task 6, Epoch 11/20 => Loss 1.561,  Train_accy 69.14, Test_accy 77.82:  55%|█████▌    | 11/20 [07:14<05:59, 39.92s/it]
SNet: Task 6, Epoch 12/20 => Loss 1.560,  Train_accy 69.56:  55%|█████▌    | 11/20 [07:52<05:59, 39.92s/it]                 
SNet: Task 6, Epoch 12/20 => Loss 1.560,  Train_accy 69.56:  60%|██████    | 12/20 [07:52<05:14, 39.37s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.562,  Train_accy 70.72:  60%|██████    | 12/20 [08:30<05:14, 39.37s/it]
SNet: Task 6, Epoch 13/20 => Loss 1.562,  Train_accy 70.72:  65%|██████▌   | 13/20 [08:30<04:33, 39.03s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.569,  Train_accy 70.24:  65%|██████▌   | 13/20 [09:08<04:33, 39.03s/it]
SNet: Task 6, Epoch 14/20 => Loss 1.569,  Train_accy 70.24:  70%|███████   | 14/20 [09:08<03:52, 38.74s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.563,  Train_accy 70.36:  70%|███████   | 14/20 [09:46<03:52, 38.74s/it]
SNet: Task 6, Epoch 15/20 => Loss 1.563,  Train_accy 70.36:  75%|███████▌  | 15/20 [09:46<03:12, 38.54s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.528,  Train_accy 70.99, Test_accy 77.70:  75%|███████▌  | 15/20 [10:29<03:12, 38.54s/it]
SNet: Task 6, Epoch 16/20 => Loss 1.528,  Train_accy 70.99, Test_accy 77.70:  80%|████████  | 16/20 [10:29<02:39, 39.89s/it]
SNet: Task 6, Epoch 17/20 => Loss 1.540,  Train_accy 70.39:  80%|████████  | 16/20 [11:07<02:39, 39.89s/it]                 
SNet: Task 6, Epoch 17/20 => Loss 1.540,  Train_accy 70.39:  85%|████████▌ | 17/20 [11:07<01:57, 39.33s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.551,  Train_accy 70.75:  85%|████████▌ | 17/20 [11:45<01:57, 39.33s/it]
SNet: Task 6, Epoch 18/20 => Loss 1.551,  Train_accy 70.75:  90%|█████████ | 18/20 [11:45<01:17, 38.95s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.562,  Train_accy 71.14:  90%|█████████ | 18/20 [12:23<01:17, 38.95s/it]
SNet: Task 6, Epoch 19/20 => Loss 1.562,  Train_accy 71.14:  95%|█████████▌| 19/20 [12:23<00:38, 38.72s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.570,  Train_accy 69.86:  95%|█████████▌| 19/20 [13:01<00:38, 38.72s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.570,  Train_accy 69.86: 100%|██████████| 20/20 [13:01<00:00, 38.53s/it]
SNet: Task 6, Epoch 20/20 => Loss 1.570,  Train_accy 69.86: 100%|██████████| 20/20 [13:01<00:00, 39.10s/it]
2024-04-22 10:07:37,473 [foster.py] => SNet: Task 6, Epoch 20/20 => Loss 1.570,  Train_accy 69.86
2024-04-22 10:07:37,473 [foster.py] => do not weight align student!
2024-04-22 10:07:42,306 [foster.py] => darknet eval: 
2024-04-22 10:07:42,306 [foster.py] => CNN top1 curve: 77.82
2024-04-22 10:07:42,307 [foster.py] => CNN top5 curve: 96.47
2024-04-22 10:07:42,310 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 10:09:21,209 [foster.py] => Exemplar size: 2800
2024-04-22 10:09:21,209 [trainer.py] => CNN: {'total': 78.67, '00-19': 93.12, '20-39': 92.75, '40-59': 89.91, '60-79': 87.04, '80-99': 84.39, '100-119': 68.86, '120-139': 32.89, 'old': 85.95, 'new': 32.89}
2024-04-22 10:09:21,210 [trainer.py] => NME: {'total': 88.97, '00-19': 87.04, '20-39': 88.89, '40-59': 88.53, '60-79': 90.69, '80-99': 89.22, '100-119': 91.67, '120-139': 86.67, 'old': 89.34, 'new': 86.67}
2024-04-22 10:09:21,210 [trainer.py] => CNN top1 curve: [97.57, 84.58, 84.52, 76.17, 76.35, 79.66, 78.67]
2024-04-22 10:09:21,210 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.66, 98.26, 97.98, 97.67, 97.14]
2024-04-22 10:09:21,210 [trainer.py] => NME top1 curve: [98.38, 96.04, 93.6, 92.38, 91.16, 89.55, 88.97]
2024-04-22 10:09:21,210 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.02, 98.91, 98.73, 98.54]

Average Accuracy (CNN): 82.5
Average Accuracy (NME): 92.87
2024-04-22 10:09:21,210 [trainer.py] => Average Accuracy (CNN): 82.5
2024-04-22 10:09:21,210 [trainer.py] => Average Accuracy (NME): 92.87
2024-04-22 10:09:21,210 [trainer.py] => Train Time: 6201.68
2024-04-22 10:09:21,210 [trainer.py] => Test Time: 71.72999999999999 

2024-04-22 10:09:21,212 [trainer.py] => All params: 172012432
2024-04-22 10:09:21,214 [trainer.py] => Trainable params: 86121496
2024-04-22 10:09:25,516 [foster.py] => Learning on 140-160
2024-04-22 10:09:25,518 [foster.py] => All params: 172073932
2024-04-22 10:09:25,520 [foster.py] => Trainable params: 86167616
2024-04-22 10:09:25,585 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 6.291, Loss_clf 1.231, Loss_fe 3.273, Loss_kd 1.563, Train_accy 65.91, Test_accy 74.88:   0%|          | 0/20 [00:43<?, ?it/s]
Task 7, Epoch 1/20 => Loss 6.291, Loss_clf 1.231, Loss_fe 3.273, Loss_kd 1.563, Train_accy 65.91, Test_accy 74.88:   5%|▌         | 1/20 [00:43<13:39, 43.14s/it]
Task 7, Epoch 2/20 => Loss 3.661, Loss_clf 0.744, Loss_fe 1.150, Loss_kd 1.546, Train_accy 68.92:   5%|▌         | 1/20 [01:16<13:39, 43.14s/it]                 
Task 7, Epoch 2/20 => Loss 3.661, Loss_clf 0.744, Loss_fe 1.150, Loss_kd 1.546, Train_accy 68.92:  10%|█         | 2/20 [01:16<11:12, 37.35s/it]
Task 7, Epoch 3/20 => Loss 3.172, Loss_clf 0.617, Loss_fe 0.811, Loss_kd 1.526, Train_accy 70.75:  10%|█         | 2/20 [01:49<11:12, 37.35s/it]
Task 7, Epoch 3/20 => Loss 3.172, Loss_clf 0.617, Loss_fe 0.811, Loss_kd 1.526, Train_accy 70.75:  15%|█▌        | 3/20 [01:49<10:05, 35.62s/it]
Task 7, Epoch 4/20 => Loss 3.121, Loss_clf 0.618, Loss_fe 0.745, Loss_kd 1.538, Train_accy 70.00:  15%|█▌        | 3/20 [02:23<10:05, 35.62s/it]
Task 7, Epoch 4/20 => Loss 3.121, Loss_clf 0.618, Loss_fe 0.745, Loss_kd 1.538, Train_accy 70.00:  20%|██        | 4/20 [02:23<09:16, 34.79s/it]
Task 7, Epoch 5/20 => Loss 2.948, Loss_clf 0.550, Loss_fe 0.658, Loss_kd 1.522, Train_accy 71.85:  20%|██        | 4/20 [02:57<09:16, 34.79s/it]
Task 7, Epoch 5/20 => Loss 2.948, Loss_clf 0.550, Loss_fe 0.658, Loss_kd 1.522, Train_accy 71.85:  25%|██▌       | 5/20 [02:57<08:34, 34.33s/it]
Task 7, Epoch 6/20 => Loss 2.867, Loss_clf 0.519, Loss_fe 0.596, Loss_kd 1.534, Train_accy 72.47, Test_accy 77.26:  25%|██▌       | 5/20 [03:40<08:34, 34.33s/it]
Task 7, Epoch 6/20 => Loss 2.867, Loss_clf 0.519, Loss_fe 0.596, Loss_kd 1.534, Train_accy 72.47, Test_accy 77.26:  30%|███       | 6/20 [03:40<08:44, 37.45s/it]
Task 7, Epoch 7/20 => Loss 2.852, Loss_clf 0.538, Loss_fe 0.561, Loss_kd 1.534, Train_accy 72.39:  30%|███       | 6/20 [04:14<08:44, 37.45s/it]                 
Task 7, Epoch 7/20 => Loss 2.852, Loss_clf 0.538, Loss_fe 0.561, Loss_kd 1.534, Train_accy 72.39:  35%|███▌      | 7/20 [04:14<07:50, 36.17s/it]
Task 7, Epoch 8/20 => Loss 2.727, Loss_clf 0.493, Loss_fe 0.497, Loss_kd 1.520, Train_accy 73.17:  35%|███▌      | 7/20 [04:47<07:50, 36.17s/it]
Task 7, Epoch 8/20 => Loss 2.727, Loss_clf 0.493, Loss_fe 0.497, Loss_kd 1.520, Train_accy 73.17:  40%|████      | 8/20 [04:47<07:04, 35.34s/it]
Task 7, Epoch 9/20 => Loss 2.658, Loss_clf 0.469, Loss_fe 0.458, Loss_kd 1.514, Train_accy 73.28:  40%|████      | 8/20 [05:21<07:04, 35.34s/it]
Task 7, Epoch 9/20 => Loss 2.658, Loss_clf 0.469, Loss_fe 0.458, Loss_kd 1.514, Train_accy 73.28:  45%|████▌     | 9/20 [05:21<06:22, 34.77s/it]
Task 7, Epoch 10/20 => Loss 2.607, Loss_clf 0.447, Loss_fe 0.424, Loss_kd 1.519, Train_accy 73.36:  45%|████▌     | 9/20 [05:54<06:22, 34.77s/it]
Task 7, Epoch 10/20 => Loss 2.607, Loss_clf 0.447, Loss_fe 0.424, Loss_kd 1.519, Train_accy 73.36:  50%|█████     | 10/20 [05:54<05:44, 34.42s/it]
Task 7, Epoch 11/20 => Loss 2.594, Loss_clf 0.437, Loss_fe 0.414, Loss_kd 1.525, Train_accy 74.44, Test_accy 76.41:  50%|█████     | 10/20 [06:38<05:44, 34.42s/it]
Task 7, Epoch 11/20 => Loss 2.594, Loss_clf 0.437, Loss_fe 0.414, Loss_kd 1.525, Train_accy 74.44, Test_accy 76.41:  55%|█████▌    | 11/20 [06:38<05:35, 37.27s/it]
Task 7, Epoch 12/20 => Loss 2.495, Loss_clf 0.409, Loss_fe 0.373, Loss_kd 1.499, Train_accy 74.73:  55%|█████▌    | 11/20 [07:12<05:35, 37.27s/it]                 
Task 7, Epoch 12/20 => Loss 2.495, Loss_clf 0.409, Loss_fe 0.373, Loss_kd 1.499, Train_accy 74.73:  60%|██████    | 12/20 [07:12<04:49, 36.13s/it]
Task 7, Epoch 13/20 => Loss 2.435, Loss_clf 0.396, Loss_fe 0.350, Loss_kd 1.478, Train_accy 74.68:  60%|██████    | 12/20 [07:45<04:49, 36.13s/it]
Task 7, Epoch 13/20 => Loss 2.435, Loss_clf 0.396, Loss_fe 0.350, Loss_kd 1.478, Train_accy 74.68:  65%|██████▌   | 13/20 [07:45<04:07, 35.36s/it]
Task 7, Epoch 14/20 => Loss 2.436, Loss_clf 0.393, Loss_fe 0.343, Loss_kd 1.488, Train_accy 75.38:  65%|██████▌   | 13/20 [08:19<04:07, 35.36s/it]
Task 7, Epoch 14/20 => Loss 2.436, Loss_clf 0.393, Loss_fe 0.343, Loss_kd 1.488, Train_accy 75.38:  70%|███████   | 14/20 [08:19<03:28, 34.79s/it]
Task 7, Epoch 15/20 => Loss 2.493, Loss_clf 0.409, Loss_fe 0.349, Loss_kd 1.518, Train_accy 74.92:  70%|███████   | 14/20 [08:52<03:28, 34.79s/it]
Task 7, Epoch 15/20 => Loss 2.493, Loss_clf 0.409, Loss_fe 0.349, Loss_kd 1.518, Train_accy 74.92:  75%|███████▌  | 15/20 [08:52<02:52, 34.42s/it]
Task 7, Epoch 16/20 => Loss 2.516, Loss_clf 0.414, Loss_fe 0.354, Loss_kd 1.530, Train_accy 74.68, Test_accy 77.26:  75%|███████▌  | 15/20 [09:36<02:52, 34.42s/it]
Task 7, Epoch 16/20 => Loss 2.516, Loss_clf 0.414, Loss_fe 0.354, Loss_kd 1.530, Train_accy 74.68, Test_accy 77.26:  80%|████████  | 16/20 [09:36<02:28, 37.16s/it]
Task 7, Epoch 17/20 => Loss 2.431, Loss_clf 0.391, Loss_fe 0.324, Loss_kd 1.502, Train_accy 75.48:  80%|████████  | 16/20 [10:09<02:28, 37.16s/it]                 
Task 7, Epoch 17/20 => Loss 2.431, Loss_clf 0.391, Loss_fe 0.324, Loss_kd 1.502, Train_accy 75.48:  85%|████████▌ | 17/20 [10:09<01:48, 36.06s/it]
Task 7, Epoch 18/20 => Loss 2.377, Loss_clf 0.362, Loss_fe 0.303, Loss_kd 1.499, Train_accy 75.05:  85%|████████▌ | 17/20 [10:43<01:48, 36.06s/it]
Task 7, Epoch 18/20 => Loss 2.377, Loss_clf 0.362, Loss_fe 0.303, Loss_kd 1.499, Train_accy 75.05:  90%|█████████ | 18/20 [10:43<01:10, 35.29s/it]
Task 7, Epoch 19/20 => Loss 2.491, Loss_clf 0.410, Loss_fe 0.350, Loss_kd 1.514, Train_accy 75.43:  90%|█████████ | 18/20 [11:16<01:10, 35.29s/it]
Task 7, Epoch 19/20 => Loss 2.491, Loss_clf 0.410, Loss_fe 0.350, Loss_kd 1.514, Train_accy 75.43:  95%|█████████▌| 19/20 [11:16<00:34, 34.77s/it]
Task 7, Epoch 20/20 => Loss 2.514, Loss_clf 0.432, Loss_fe 0.340, Loss_kd 1.524, Train_accy 74.52:  95%|█████████▌| 19/20 [11:50<00:34, 34.77s/it]
Task 7, Epoch 20/20 => Loss 2.514, Loss_clf 0.432, Loss_fe 0.340, Loss_kd 1.524, Train_accy 74.52: 100%|██████████| 20/20 [11:50<00:00, 34.38s/it]
Task 7, Epoch 20/20 => Loss 2.514, Loss_clf 0.432, Loss_fe 0.340, Loss_kd 1.524, Train_accy 74.52: 100%|██████████| 20/20 [11:50<00:00, 35.51s/it]
2024-04-22 10:21:15,804 [foster.py] => Task 7, Epoch 20/20 => Loss 2.514, Loss_clf 0.432, Loss_fe 0.340, Loss_kd 1.524, Train_accy 74.52
2024-04-22 10:21:15,806 [foster.py] => do not weight align teacher!
2024-04-22 10:21:15,813 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.698,  Train_accy 65.94, Test_accy 74.35:   0%|          | 0/20 [00:47<?, ?it/s]
SNet: Task 7, Epoch 1/20 => Loss 1.698,  Train_accy 65.94, Test_accy 74.35:   5%|▌         | 1/20 [00:47<15:06, 47.71s/it]
SNet: Task 7, Epoch 2/20 => Loss 1.600,  Train_accy 69.09:   5%|▌         | 1/20 [01:29<15:06, 47.71s/it]                 
SNet: Task 7, Epoch 2/20 => Loss 1.600,  Train_accy 69.09:  10%|█         | 2/20 [01:29<13:20, 44.50s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.609,  Train_accy 69.44:  10%|█         | 2/20 [02:12<13:20, 44.50s/it]
SNet: Task 7, Epoch 3/20 => Loss 1.609,  Train_accy 69.44:  15%|█▌        | 3/20 [02:12<12:18, 43.43s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.578,  Train_accy 69.57:  15%|█▌        | 3/20 [02:54<12:18, 43.43s/it]
SNet: Task 7, Epoch 4/20 => Loss 1.578,  Train_accy 69.57:  20%|██        | 4/20 [02:54<11:27, 42.94s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.592,  Train_accy 70.08:  20%|██        | 4/20 [03:36<11:27, 42.94s/it]
SNet: Task 7, Epoch 5/20 => Loss 1.592,  Train_accy 70.08:  25%|██▌       | 5/20 [03:36<10:40, 42.69s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.571,  Train_accy 70.99, Test_accy 75.94:  25%|██▌       | 5/20 [04:24<10:40, 42.69s/it]
SNet: Task 7, Epoch 6/20 => Loss 1.571,  Train_accy 70.99, Test_accy 75.94:  30%|███       | 6/20 [04:24<10:22, 44.43s/it]
SNet: Task 7, Epoch 7/20 => Loss 1.596,  Train_accy 69.81:  30%|███       | 6/20 [05:06<10:22, 44.43s/it]                 
SNet: Task 7, Epoch 7/20 => Loss 1.596,  Train_accy 69.81:  35%|███▌      | 7/20 [05:06<09:28, 43.72s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.589,  Train_accy 69.68:  35%|███▌      | 7/20 [05:48<09:28, 43.72s/it]
SNet: Task 7, Epoch 8/20 => Loss 1.589,  Train_accy 69.68:  40%|████      | 8/20 [05:48<08:39, 43.25s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.581,  Train_accy 70.00:  40%|████      | 8/20 [06:31<08:39, 43.25s/it]
SNet: Task 7, Epoch 9/20 => Loss 1.581,  Train_accy 70.00:  45%|████▌     | 9/20 [06:31<07:52, 42.93s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.566,  Train_accy 70.54:  45%|████▌     | 9/20 [07:13<07:52, 42.93s/it]
SNet: Task 7, Epoch 10/20 => Loss 1.566,  Train_accy 70.54:  50%|█████     | 10/20 [07:13<07:07, 42.71s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.574,  Train_accy 70.99, Test_accy 75.52:  50%|█████     | 10/20 [08:01<07:07, 42.71s/it]
SNet: Task 7, Epoch 11/20 => Loss 1.574,  Train_accy 70.99, Test_accy 75.52:  55%|█████▌    | 11/20 [08:01<06:38, 44.32s/it]
SNet: Task 7, Epoch 12/20 => Loss 1.539,  Train_accy 71.45:  55%|█████▌    | 11/20 [08:43<06:38, 44.32s/it]                 
SNet: Task 7, Epoch 12/20 => Loss 1.539,  Train_accy 71.45:  60%|██████    | 12/20 [08:43<05:49, 43.64s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.587,  Train_accy 70.94:  60%|██████    | 12/20 [09:25<05:49, 43.64s/it]
SNet: Task 7, Epoch 13/20 => Loss 1.587,  Train_accy 70.94:  65%|██████▌   | 13/20 [09:25<05:02, 43.19s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.595,  Train_accy 70.62:  65%|██████▌   | 13/20 [10:07<05:02, 43.19s/it]
SNet: Task 7, Epoch 14/20 => Loss 1.595,  Train_accy 70.62:  70%|███████   | 14/20 [10:07<04:17, 42.97s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.545,  Train_accy 71.85:  70%|███████   | 14/20 [10:50<04:17, 42.97s/it]
SNet: Task 7, Epoch 15/20 => Loss 1.545,  Train_accy 71.85:  75%|███████▌  | 15/20 [10:50<03:33, 42.75s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.571,  Train_accy 71.64, Test_accy 75.41:  75%|███████▌  | 15/20 [11:37<03:33, 42.75s/it]
SNet: Task 7, Epoch 16/20 => Loss 1.571,  Train_accy 71.64, Test_accy 75.41:  80%|████████  | 16/20 [11:38<02:57, 44.27s/it]
SNet: Task 7, Epoch 17/20 => Loss 1.572,  Train_accy 70.59:  80%|████████  | 16/20 [12:20<02:57, 44.27s/it]                 
SNet: Task 7, Epoch 17/20 => Loss 1.572,  Train_accy 70.59:  85%|████████▌ | 17/20 [12:20<02:10, 43.66s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.582,  Train_accy 70.91:  85%|████████▌ | 17/20 [13:02<02:10, 43.66s/it]
SNet: Task 7, Epoch 18/20 => Loss 1.582,  Train_accy 70.91:  90%|█████████ | 18/20 [13:02<01:26, 43.23s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.559,  Train_accy 71.10:  90%|█████████ | 18/20 [13:44<01:26, 43.23s/it]
SNet: Task 7, Epoch 19/20 => Loss 1.559,  Train_accy 71.10:  95%|█████████▌| 19/20 [13:44<00:42, 42.92s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.531,  Train_accy 71.40:  95%|█████████▌| 19/20 [14:26<00:42, 42.92s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.531,  Train_accy 71.40: 100%|██████████| 20/20 [14:26<00:00, 42.72s/it]
SNet: Task 7, Epoch 20/20 => Loss 1.531,  Train_accy 71.40: 100%|██████████| 20/20 [14:26<00:00, 43.35s/it]
2024-04-22 10:35:45,763 [foster.py] => SNet: Task 7, Epoch 20/20 => Loss 1.531,  Train_accy 71.40
2024-04-22 10:35:45,764 [foster.py] => do not weight align student!
2024-04-22 10:35:51,500 [foster.py] => darknet eval: 
2024-04-22 10:35:51,500 [foster.py] => CNN top1 curve: 75.36
2024-04-22 10:35:51,500 [foster.py] => CNN top5 curve: 95.93
2024-04-22 10:35:51,502 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 10:37:43,706 [foster.py] => Exemplar size: 3200
2024-04-22 10:37:43,706 [trainer.py] => CNN: {'total': 77.31, '00-19': 90.28, '20-39': 90.82, '40-59': 91.28, '60-79': 87.04, '80-99': 86.25, '100-119': 82.02, '120-139': 64.89, '140-159': 28.8, 'old': 84.7, 'new': 28.8}
2024-04-22 10:37:43,706 [trainer.py] => NME: {'total': 88.15, '00-19': 85.83, '20-39': 89.37, '40-59': 86.7, '60-79': 87.45, '80-99': 90.33, '100-119': 89.04, '120-139': 84.89, '140-159': 91.2, 'old': 87.69, 'new': 91.2}
2024-04-22 10:37:43,706 [trainer.py] => CNN top1 curve: [97.57, 84.58, 84.52, 76.17, 76.35, 79.66, 78.67, 77.31]
2024-04-22 10:37:43,706 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.66, 98.26, 97.98, 97.67, 97.14, 96.46]
2024-04-22 10:37:43,706 [trainer.py] => NME top1 curve: [98.38, 96.04, 93.6, 92.38, 91.16, 89.55, 88.97, 88.15]
2024-04-22 10:37:43,706 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.02, 98.91, 98.73, 98.54, 98.52]

Average Accuracy (CNN): 81.85
Average Accuracy (NME): 92.28
2024-04-22 10:37:43,706 [trainer.py] => Average Accuracy (CNN): 81.85
2024-04-22 10:37:43,706 [trainer.py] => Average Accuracy (NME): 92.28
2024-04-22 10:37:43,706 [trainer.py] => Train Time: 7787.650000000001
2024-04-22 10:37:43,706 [trainer.py] => Test Time: 91.63 

2024-04-22 10:37:43,708 [trainer.py] => All params: 172073932
2024-04-22 10:37:43,709 [trainer.py] => Trainable params: 86167616
2024-04-22 10:37:45,995 [foster.py] => Learning on 160-180
2024-04-22 10:37:45,997 [foster.py] => All params: 172135432
2024-04-22 10:37:45,998 [foster.py] => Trainable params: 86213736
2024-04-22 10:37:46,058 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 6.559, Loss_clf 1.206, Loss_fe 3.514, Loss_kd 1.634, Train_accy 67.15, Test_accy 78.67:   0%|          | 0/20 [00:48<?, ?it/s]
Task 8, Epoch 1/20 => Loss 6.559, Loss_clf 1.206, Loss_fe 3.514, Loss_kd 1.634, Train_accy 67.15, Test_accy 78.67:   5%|▌         | 1/20 [00:48<15:18, 48.33s/it]
Task 8, Epoch 2/20 => Loss 3.776, Loss_clf 0.766, Loss_fe 1.179, Loss_kd 1.628, Train_accy 70.80:   5%|▌         | 1/20 [01:25<15:18, 48.33s/it]                 
Task 8, Epoch 2/20 => Loss 3.776, Loss_clf 0.766, Loss_fe 1.179, Loss_kd 1.628, Train_accy 70.80:  10%|█         | 2/20 [01:25<12:31, 41.74s/it]
Task 8, Epoch 3/20 => Loss 3.437, Loss_clf 0.674, Loss_fe 0.907, Loss_kd 1.649, Train_accy 71.69:  10%|█         | 2/20 [02:02<12:31, 41.74s/it]
Task 8, Epoch 3/20 => Loss 3.437, Loss_clf 0.674, Loss_fe 0.907, Loss_kd 1.649, Train_accy 71.69:  15%|█▌        | 3/20 [02:02<11:15, 39.71s/it]
Task 8, Epoch 4/20 => Loss 3.192, Loss_clf 0.634, Loss_fe 0.748, Loss_kd 1.608, Train_accy 73.06:  15%|█▌        | 3/20 [02:40<11:15, 39.71s/it]
Task 8, Epoch 4/20 => Loss 3.192, Loss_clf 0.634, Loss_fe 0.748, Loss_kd 1.608, Train_accy 73.06:  20%|██        | 4/20 [02:40<10:20, 38.76s/it]
Task 8, Epoch 5/20 => Loss 3.065, Loss_clf 0.562, Loss_fe 0.669, Loss_kd 1.631, Train_accy 72.90:  20%|██        | 4/20 [03:17<10:20, 38.76s/it]
Task 8, Epoch 5/20 => Loss 3.065, Loss_clf 0.562, Loss_fe 0.669, Loss_kd 1.631, Train_accy 72.90:  25%|██▌       | 5/20 [03:17<09:33, 38.24s/it]
Task 8, Epoch 6/20 => Loss 2.956, Loss_clf 0.540, Loss_fe 0.602, Loss_kd 1.613, Train_accy 73.50, Test_accy 78.24:  25%|██▌       | 5/20 [04:06<09:33, 38.24s/it]
Task 8, Epoch 6/20 => Loss 2.956, Loss_clf 0.540, Loss_fe 0.602, Loss_kd 1.613, Train_accy 73.50, Test_accy 78.24:  30%|███       | 6/20 [04:06<09:44, 41.78s/it]
Task 8, Epoch 7/20 => Loss 2.890, Loss_clf 0.534, Loss_fe 0.557, Loss_kd 1.600, Train_accy 73.69:  30%|███       | 6/20 [04:43<09:44, 41.78s/it]                 
Task 8, Epoch 7/20 => Loss 2.890, Loss_clf 0.534, Loss_fe 0.557, Loss_kd 1.600, Train_accy 73.69:  35%|███▌      | 7/20 [04:43<08:43, 40.31s/it]
Task 8, Epoch 8/20 => Loss 2.772, Loss_clf 0.476, Loss_fe 0.492, Loss_kd 1.603, Train_accy 74.65:  35%|███▌      | 7/20 [05:20<08:43, 40.31s/it]
Task 8, Epoch 8/20 => Loss 2.772, Loss_clf 0.476, Loss_fe 0.492, Loss_kd 1.603, Train_accy 74.65:  40%|████      | 8/20 [05:20<07:52, 39.35s/it]
Task 8, Epoch 9/20 => Loss 2.677, Loss_clf 0.454, Loss_fe 0.445, Loss_kd 1.581, Train_accy 75.64:  40%|████      | 8/20 [05:57<07:52, 39.35s/it]
Task 8, Epoch 9/20 => Loss 2.677, Loss_clf 0.454, Loss_fe 0.445, Loss_kd 1.581, Train_accy 75.64:  45%|████▌     | 9/20 [05:57<07:05, 38.72s/it]
Task 8, Epoch 10/20 => Loss 2.724, Loss_clf 0.474, Loss_fe 0.462, Loss_kd 1.590, Train_accy 75.59:  45%|████▌     | 9/20 [06:35<07:05, 38.72s/it]
Task 8, Epoch 10/20 => Loss 2.724, Loss_clf 0.474, Loss_fe 0.462, Loss_kd 1.590, Train_accy 75.59:  50%|█████     | 10/20 [06:35<06:22, 38.29s/it]
Task 8, Epoch 11/20 => Loss 2.713, Loss_clf 0.470, Loss_fe 0.437, Loss_kd 1.605, Train_accy 75.06, Test_accy 77.30:  50%|█████     | 10/20 [07:23<06:22, 38.29s/it]
Task 8, Epoch 11/20 => Loss 2.713, Loss_clf 0.470, Loss_fe 0.437, Loss_kd 1.605, Train_accy 75.06, Test_accy 77.30:  55%|█████▌    | 11/20 [07:23<06:12, 41.41s/it]
Task 8, Epoch 12/20 => Loss 2.722, Loss_clf 0.471, Loss_fe 0.427, Loss_kd 1.622, Train_accy 75.16:  55%|█████▌    | 11/20 [08:00<06:12, 41.41s/it]                 
Task 8, Epoch 12/20 => Loss 2.722, Loss_clf 0.471, Loss_fe 0.427, Loss_kd 1.622, Train_accy 75.16:  60%|██████    | 12/20 [08:00<05:21, 40.14s/it]
Task 8, Epoch 13/20 => Loss 2.684, Loss_clf 0.467, Loss_fe 0.411, Loss_kd 1.605, Train_accy 75.64:  60%|██████    | 12/20 [08:38<05:21, 40.14s/it]
Task 8, Epoch 13/20 => Loss 2.684, Loss_clf 0.467, Loss_fe 0.411, Loss_kd 1.605, Train_accy 75.64:  65%|██████▌   | 13/20 [08:38<04:34, 39.27s/it]
Task 8, Epoch 14/20 => Loss 2.607, Loss_clf 0.437, Loss_fe 0.381, Loss_kd 1.590, Train_accy 75.69:  65%|██████▌   | 13/20 [09:15<04:34, 39.27s/it]
Task 8, Epoch 14/20 => Loss 2.607, Loss_clf 0.437, Loss_fe 0.381, Loss_kd 1.590, Train_accy 75.69:  70%|███████   | 14/20 [09:15<03:52, 38.72s/it]
Task 8, Epoch 15/20 => Loss 2.531, Loss_clf 0.397, Loss_fe 0.342, Loss_kd 1.592, Train_accy 76.84:  70%|███████   | 14/20 [09:53<03:52, 38.72s/it]
Task 8, Epoch 15/20 => Loss 2.531, Loss_clf 0.397, Loss_fe 0.342, Loss_kd 1.592, Train_accy 76.84:  75%|███████▌  | 15/20 [09:53<03:11, 38.32s/it]
Task 8, Epoch 16/20 => Loss 2.589, Loss_clf 0.438, Loss_fe 0.357, Loss_kd 1.595, Train_accy 75.35, Test_accy 79.14:  75%|███████▌  | 15/20 [10:41<03:11, 38.32s/it]
Task 8, Epoch 16/20 => Loss 2.589, Loss_clf 0.438, Loss_fe 0.357, Loss_kd 1.595, Train_accy 75.35, Test_accy 79.14:  80%|████████  | 16/20 [10:41<02:45, 41.43s/it]
Task 8, Epoch 17/20 => Loss 2.483, Loss_clf 0.381, Loss_fe 0.327, Loss_kd 1.578, Train_accy 77.13:  80%|████████  | 16/20 [11:19<02:45, 41.43s/it]                 
Task 8, Epoch 17/20 => Loss 2.483, Loss_clf 0.381, Loss_fe 0.327, Loss_kd 1.578, Train_accy 77.13:  85%|████████▌ | 17/20 [11:19<02:00, 40.20s/it]
Task 8, Epoch 18/20 => Loss 2.468, Loss_clf 0.380, Loss_fe 0.318, Loss_kd 1.574, Train_accy 78.19:  85%|████████▌ | 17/20 [11:56<02:00, 40.20s/it]
Task 8, Epoch 18/20 => Loss 2.468, Loss_clf 0.380, Loss_fe 0.318, Loss_kd 1.574, Train_accy 78.19:  90%|█████████ | 18/20 [11:56<01:18, 39.37s/it]
Task 8, Epoch 19/20 => Loss 2.532, Loss_clf 0.405, Loss_fe 0.335, Loss_kd 1.593, Train_accy 76.94:  90%|█████████ | 18/20 [12:33<01:18, 39.37s/it]
Task 8, Epoch 19/20 => Loss 2.532, Loss_clf 0.405, Loss_fe 0.335, Loss_kd 1.593, Train_accy 76.94:  95%|█████████▌| 19/20 [12:33<00:38, 38.77s/it]
Task 8, Epoch 20/20 => Loss 2.501, Loss_clf 0.396, Loss_fe 0.320, Loss_kd 1.586, Train_accy 76.82:  95%|█████████▌| 19/20 [13:11<00:38, 38.77s/it]
Task 8, Epoch 20/20 => Loss 2.501, Loss_clf 0.396, Loss_fe 0.320, Loss_kd 1.586, Train_accy 76.82: 100%|██████████| 20/20 [13:11<00:00, 38.34s/it]
Task 8, Epoch 20/20 => Loss 2.501, Loss_clf 0.396, Loss_fe 0.320, Loss_kd 1.586, Train_accy 76.82: 100%|██████████| 20/20 [13:11<00:00, 39.56s/it]
2024-04-22 10:50:57,268 [foster.py] => Task 8, Epoch 20/20 => Loss 2.501, Loss_clf 0.396, Loss_fe 0.320, Loss_kd 1.586, Train_accy 76.82
2024-04-22 10:50:57,270 [foster.py] => do not weight align teacher!
2024-04-22 10:50:57,274 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.699,  Train_accy 68.16, Test_accy 77.26:   0%|          | 0/20 [00:53<?, ?it/s]
SNet: Task 8, Epoch 1/20 => Loss 1.699,  Train_accy 68.16, Test_accy 77.26:   5%|▌         | 1/20 [00:53<16:53, 53.34s/it]
SNet: Task 8, Epoch 2/20 => Loss 1.635,  Train_accy 70.47:   5%|▌         | 1/20 [01:40<16:53, 53.34s/it]                 
SNet: Task 8, Epoch 2/20 => Loss 1.635,  Train_accy 70.47:  10%|█         | 2/20 [01:40<14:53, 49.62s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.619,  Train_accy 70.92:  10%|█         | 2/20 [02:33<14:53, 49.62s/it]
SNet: Task 8, Epoch 3/20 => Loss 1.619,  Train_accy 70.92:  15%|█▌        | 3/20 [02:33<14:33, 51.39s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.635,  Train_accy 71.69:  15%|█▌        | 3/20 [03:53<14:33, 51.39s/it]
SNet: Task 8, Epoch 4/20 => Loss 1.635,  Train_accy 71.69:  20%|██        | 4/20 [03:53<16:40, 62.52s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.622,  Train_accy 71.38:  20%|██        | 4/20 [05:13<16:40, 62.52s/it]
SNet: Task 8, Epoch 5/20 => Loss 1.622,  Train_accy 71.38:  25%|██▌       | 5/20 [05:13<17:13, 68.90s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.592,  Train_accy 72.51, Test_accy 77.58:  25%|██▌       | 5/20 [06:10<17:13, 68.90s/it]
SNet: Task 8, Epoch 6/20 => Loss 1.592,  Train_accy 72.51, Test_accy 77.58:  30%|███       | 6/20 [06:10<15:07, 64.84s/it]
SNet: Task 8, Epoch 7/20 => Loss 1.632,  Train_accy 72.10:  30%|███       | 6/20 [06:57<15:07, 64.84s/it]                 
SNet: Task 8, Epoch 7/20 => Loss 1.632,  Train_accy 72.10:  35%|███▌      | 7/20 [06:57<12:47, 59.03s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.579,  Train_accy 73.09:  35%|███▌      | 7/20 [07:44<12:47, 59.03s/it]
SNet: Task 8, Epoch 8/20 => Loss 1.579,  Train_accy 73.09:  40%|████      | 8/20 [07:44<11:02, 55.24s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.629,  Train_accy 72.27:  40%|████      | 8/20 [08:31<11:02, 55.24s/it]
SNet: Task 8, Epoch 9/20 => Loss 1.629,  Train_accy 72.27:  45%|████▌     | 9/20 [08:31<09:39, 52.68s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.594,  Train_accy 73.11:  45%|████▌     | 9/20 [09:18<09:39, 52.68s/it]
SNet: Task 8, Epoch 10/20 => Loss 1.594,  Train_accy 73.11:  50%|█████     | 10/20 [09:18<08:29, 50.96s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.597,  Train_accy 72.63, Test_accy 77.77:  50%|█████     | 10/20 [10:12<08:29, 50.96s/it]
SNet: Task 8, Epoch 11/20 => Loss 1.597,  Train_accy 72.63, Test_accy 77.77:  55%|█████▌    | 11/20 [10:12<07:45, 51.69s/it]
SNet: Task 8, Epoch 12/20 => Loss 1.642,  Train_accy 71.65:  55%|█████▌    | 11/20 [10:59<07:45, 51.69s/it]                 
SNet: Task 8, Epoch 12/20 => Loss 1.642,  Train_accy 71.65:  60%|██████    | 12/20 [10:59<06:42, 50.30s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.599,  Train_accy 72.85:  60%|██████    | 12/20 [11:46<06:42, 50.30s/it]
SNet: Task 8, Epoch 13/20 => Loss 1.599,  Train_accy 72.85:  65%|██████▌   | 13/20 [11:46<05:45, 49.41s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.589,  Train_accy 73.23:  65%|██████▌   | 13/20 [12:33<05:45, 49.41s/it]
SNet: Task 8, Epoch 14/20 => Loss 1.589,  Train_accy 73.23:  70%|███████   | 14/20 [12:33<04:52, 48.73s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.615,  Train_accy 73.06:  70%|███████   | 14/20 [13:21<04:52, 48.73s/it]
SNet: Task 8, Epoch 15/20 => Loss 1.615,  Train_accy 73.06:  75%|███████▌  | 15/20 [13:21<04:01, 48.23s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.597,  Train_accy 73.26, Test_accy 77.68:  75%|███████▌  | 15/20 [14:14<04:01, 48.23s/it]
SNet: Task 8, Epoch 16/20 => Loss 1.597,  Train_accy 73.26, Test_accy 77.68:  80%|████████  | 16/20 [14:14<03:18, 49.74s/it]
SNet: Task 8, Epoch 17/20 => Loss 1.602,  Train_accy 72.20:  80%|████████  | 16/20 [15:01<03:18, 49.74s/it]                 
SNet: Task 8, Epoch 17/20 => Loss 1.602,  Train_accy 72.20:  85%|████████▌ | 17/20 [15:01<02:26, 48.95s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.595,  Train_accy 73.26:  85%|████████▌ | 17/20 [15:48<02:26, 48.95s/it]
SNet: Task 8, Epoch 18/20 => Loss 1.595,  Train_accy 73.26:  90%|█████████ | 18/20 [15:48<01:36, 48.37s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.631,  Train_accy 72.27:  90%|█████████ | 18/20 [16:35<01:36, 48.37s/it]
SNet: Task 8, Epoch 19/20 => Loss 1.631,  Train_accy 72.27:  95%|█████████▌| 19/20 [16:35<00:48, 48.00s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.606,  Train_accy 72.87:  95%|█████████▌| 19/20 [17:22<00:48, 48.00s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.606,  Train_accy 72.87: 100%|██████████| 20/20 [17:22<00:00, 47.74s/it]
SNet: Task 8, Epoch 20/20 => Loss 1.606,  Train_accy 72.87: 100%|██████████| 20/20 [17:22<00:00, 52.13s/it]
2024-04-22 11:08:22,349 [foster.py] => SNet: Task 8, Epoch 20/20 => Loss 1.606,  Train_accy 72.87
2024-04-22 11:08:22,349 [foster.py] => do not weight align student!
2024-04-22 11:08:28,538 [foster.py] => darknet eval: 
2024-04-22 11:08:28,539 [foster.py] => CNN top1 curve: 77.73
2024-04-22 11:08:28,539 [foster.py] => CNN top5 curve: 95.35
2024-04-22 11:08:28,541 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 11:10:33,350 [foster.py] => Exemplar size: 3600
2024-04-22 11:10:33,350 [trainer.py] => CNN: {'total': 77.91, '00-19': 89.47, '20-39': 89.37, '40-59': 88.99, '60-79': 85.83, '80-99': 88.48, '100-119': 85.09, '120-139': 74.67, '140-159': 66.8, '160-179': 33.33, 'old': 83.5, 'new': 33.33}
2024-04-22 11:10:33,350 [trainer.py] => NME: {'total': 88.06, '00-19': 87.45, '20-39': 89.86, '40-59': 88.07, '60-79': 87.45, '80-99': 89.22, '100-119': 89.91, '120-139': 83.56, '140-159': 88.4, '160-179': 88.61, 'old': 88.0, 'new': 88.61}
2024-04-22 11:10:33,350 [trainer.py] => CNN top1 curve: [97.57, 84.58, 84.52, 76.17, 76.35, 79.66, 78.67, 77.31, 77.91]
2024-04-22 11:10:33,350 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.66, 98.26, 97.98, 97.67, 97.14, 96.46, 96.52]
2024-04-22 11:10:33,350 [trainer.py] => NME top1 curve: [98.38, 96.04, 93.6, 92.38, 91.16, 89.55, 88.97, 88.15, 88.06]
2024-04-22 11:10:33,350 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.02, 98.91, 98.73, 98.54, 98.52, 98.68]

Average Accuracy (CNN): 81.42
Average Accuracy (NME): 91.81
2024-04-22 11:10:33,350 [trainer.py] => Average Accuracy (CNN): 81.42
2024-04-22 11:10:33,350 [trainer.py] => Average Accuracy (NME): 91.81
2024-04-22 11:10:33,350 [trainer.py] => Train Time: 9630.18
2024-04-22 11:10:33,350 [trainer.py] => Test Time: 114.17999999999999 

2024-04-22 11:10:33,352 [trainer.py] => All params: 172135432
2024-04-22 11:10:33,353 [trainer.py] => Trainable params: 86213736
2024-04-22 11:10:36,910 [foster.py] => Learning on 180-200
2024-04-22 11:10:36,912 [foster.py] => All params: 172196932
2024-04-22 11:10:36,913 [foster.py] => Trainable params: 86259856
2024-04-22 11:10:36,977 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175]

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 6.433, Loss_clf 1.153, Loss_fe 3.514, Loss_kd 1.589, Train_accy 68.83, Test_accy 77.40:   0%|          | 0/20 [00:52<?, ?it/s]
Task 9, Epoch 1/20 => Loss 6.433, Loss_clf 1.153, Loss_fe 3.514, Loss_kd 1.589, Train_accy 68.83, Test_accy 77.40:   5%|▌         | 1/20 [00:52<16:40, 52.65s/it]
Task 9, Epoch 2/20 => Loss 3.667, Loss_clf 0.716, Loss_fe 1.199, Loss_kd 1.577, Train_accy 71.22:   5%|▌         | 1/20 [01:33<16:40, 52.65s/it]                 
Task 9, Epoch 2/20 => Loss 3.667, Loss_clf 0.716, Loss_fe 1.199, Loss_kd 1.577, Train_accy 71.22:  10%|█         | 2/20 [01:33<13:41, 45.66s/it]
Task 9, Epoch 3/20 => Loss 3.389, Loss_clf 0.682, Loss_fe 0.945, Loss_kd 1.585, Train_accy 71.77:  10%|█         | 2/20 [02:14<13:41, 45.66s/it]
Task 9, Epoch 3/20 => Loss 3.389, Loss_clf 0.682, Loss_fe 0.945, Loss_kd 1.585, Train_accy 71.77:  15%|█▌        | 3/20 [02:14<12:18, 43.44s/it]
Task 9, Epoch 4/20 => Loss 3.109, Loss_clf 0.628, Loss_fe 0.763, Loss_kd 1.546, Train_accy 72.85:  15%|█▌        | 3/20 [02:55<12:18, 43.44s/it]
Task 9, Epoch 4/20 => Loss 3.109, Loss_clf 0.628, Loss_fe 0.763, Loss_kd 1.546, Train_accy 72.85:  20%|██        | 4/20 [02:55<11:19, 42.44s/it]
Task 9, Epoch 5/20 => Loss 3.039, Loss_clf 0.597, Loss_fe 0.698, Loss_kd 1.569, Train_accy 72.50:  20%|██        | 4/20 [03:36<11:19, 42.44s/it]
Task 9, Epoch 5/20 => Loss 3.039, Loss_clf 0.597, Loss_fe 0.698, Loss_kd 1.569, Train_accy 72.50:  25%|██▌       | 5/20 [03:36<10:28, 41.88s/it]
Task 9, Epoch 6/20 => Loss 2.882, Loss_clf 0.546, Loss_fe 0.631, Loss_kd 1.535, Train_accy 73.29, Test_accy 78.88:  25%|██▌       | 5/20 [04:29<10:28, 41.88s/it]
Task 9, Epoch 6/20 => Loss 2.882, Loss_clf 0.546, Loss_fe 0.631, Loss_kd 1.535, Train_accy 73.29, Test_accy 78.88:  30%|███       | 6/20 [04:29<10:40, 45.77s/it]
Task 9, Epoch 7/20 => Loss 2.838, Loss_clf 0.540, Loss_fe 0.565, Loss_kd 1.560, Train_accy 73.95:  30%|███       | 6/20 [05:10<10:40, 45.77s/it]                 
Task 9, Epoch 7/20 => Loss 2.838, Loss_clf 0.540, Loss_fe 0.565, Loss_kd 1.560, Train_accy 73.95:  35%|███▌      | 7/20 [05:10<09:34, 44.18s/it]
Task 9, Epoch 8/20 => Loss 2.795, Loss_clf 0.526, Loss_fe 0.536, Loss_kd 1.559, Train_accy 73.95:  35%|███▌      | 7/20 [05:51<09:34, 44.18s/it]
Task 9, Epoch 8/20 => Loss 2.795, Loss_clf 0.526, Loss_fe 0.536, Loss_kd 1.559, Train_accy 73.95:  40%|████      | 8/20 [05:51<08:38, 43.18s/it]
Task 9, Epoch 9/20 => Loss 2.747, Loss_clf 0.499, Loss_fe 0.514, Loss_kd 1.560, Train_accy 73.92:  40%|████      | 8/20 [06:32<08:38, 43.18s/it]
Task 9, Epoch 9/20 => Loss 2.747, Loss_clf 0.499, Loss_fe 0.514, Loss_kd 1.560, Train_accy 73.92:  45%|████▌     | 9/20 [06:32<07:46, 42.44s/it]
Task 9, Epoch 10/20 => Loss 2.681, Loss_clf 0.475, Loss_fe 0.461, Loss_kd 1.570, Train_accy 74.56:  45%|████▌     | 9/20 [07:12<07:46, 42.44s/it]
Task 9, Epoch 10/20 => Loss 2.681, Loss_clf 0.475, Loss_fe 0.461, Loss_kd 1.570, Train_accy 74.56:  50%|█████     | 10/20 [07:12<06:59, 41.94s/it]
Task 9, Epoch 11/20 => Loss 2.592, Loss_clf 0.449, Loss_fe 0.432, Loss_kd 1.539, Train_accy 75.26, Test_accy 77.86:  50%|█████     | 10/20 [08:06<06:59, 41.94s/it]
Task 9, Epoch 11/20 => Loss 2.592, Loss_clf 0.449, Loss_fe 0.432, Loss_kd 1.539, Train_accy 75.26, Test_accy 77.86:  55%|█████▌    | 11/20 [08:06<06:48, 45.42s/it]
Task 9, Epoch 12/20 => Loss 2.650, Loss_clf 0.466, Loss_fe 0.443, Loss_kd 1.567, Train_accy 74.87:  55%|█████▌    | 11/20 [08:47<06:48, 45.42s/it]                 
Task 9, Epoch 12/20 => Loss 2.650, Loss_clf 0.466, Loss_fe 0.443, Loss_kd 1.567, Train_accy 74.87:  60%|██████    | 12/20 [08:47<05:52, 44.06s/it]
Task 9, Epoch 13/20 => Loss 2.530, Loss_clf 0.427, Loss_fe 0.387, Loss_kd 1.544, Train_accy 75.92:  60%|██████    | 12/20 [09:28<05:52, 44.06s/it]
Task 9, Epoch 13/20 => Loss 2.530, Loss_clf 0.427, Loss_fe 0.387, Loss_kd 1.544, Train_accy 75.92:  65%|██████▌   | 13/20 [09:28<05:01, 43.12s/it]
Task 9, Epoch 14/20 => Loss 2.554, Loss_clf 0.433, Loss_fe 0.414, Loss_kd 1.536, Train_accy 75.68:  65%|██████▌   | 13/20 [10:09<05:01, 43.12s/it]
Task 9, Epoch 14/20 => Loss 2.554, Loss_clf 0.433, Loss_fe 0.414, Loss_kd 1.536, Train_accy 75.68:  70%|███████   | 14/20 [10:09<04:14, 42.45s/it]
Task 9, Epoch 15/20 => Loss 2.558, Loss_clf 0.438, Loss_fe 0.378, Loss_kd 1.568, Train_accy 75.66:  70%|███████   | 14/20 [10:50<04:14, 42.45s/it]
Task 9, Epoch 15/20 => Loss 2.558, Loss_clf 0.438, Loss_fe 0.378, Loss_kd 1.568, Train_accy 75.66:  75%|███████▌  | 15/20 [10:50<03:30, 42.02s/it]
Task 9, Epoch 16/20 => Loss 2.610, Loss_clf 0.457, Loss_fe 0.395, Loss_kd 1.582, Train_accy 75.09, Test_accy 77.78:  75%|███████▌  | 15/20 [11:43<03:30, 42.02s/it]
Task 9, Epoch 16/20 => Loss 2.610, Loss_clf 0.457, Loss_fe 0.395, Loss_kd 1.582, Train_accy 75.09, Test_accy 77.78:  80%|████████  | 16/20 [11:43<03:01, 45.39s/it]
Task 9, Epoch 17/20 => Loss 2.521, Loss_clf 0.427, Loss_fe 0.372, Loss_kd 1.550, Train_accy 75.02:  80%|████████  | 16/20 [12:24<03:01, 45.39s/it]                 
Task 9, Epoch 17/20 => Loss 2.521, Loss_clf 0.427, Loss_fe 0.372, Loss_kd 1.550, Train_accy 75.02:  85%|████████▌ | 17/20 [12:24<02:12, 44.04s/it]
Task 9, Epoch 18/20 => Loss 2.484, Loss_clf 0.411, Loss_fe 0.349, Loss_kd 1.551, Train_accy 76.03:  85%|████████▌ | 17/20 [13:05<02:12, 44.04s/it]
Task 9, Epoch 18/20 => Loss 2.484, Loss_clf 0.411, Loss_fe 0.349, Loss_kd 1.551, Train_accy 76.03:  90%|█████████ | 18/20 [13:05<01:26, 43.12s/it]
Task 9, Epoch 19/20 => Loss 2.467, Loss_clf 0.414, Loss_fe 0.344, Loss_kd 1.538, Train_accy 76.58:  90%|█████████ | 18/20 [13:46<01:26, 43.12s/it]
Task 9, Epoch 19/20 => Loss 2.467, Loss_clf 0.414, Loss_fe 0.344, Loss_kd 1.538, Train_accy 76.58:  95%|█████████▌| 19/20 [13:46<00:42, 42.46s/it]
Task 9, Epoch 20/20 => Loss 2.415, Loss_clf 0.393, Loss_fe 0.333, Loss_kd 1.520, Train_accy 75.62:  95%|█████████▌| 19/20 [14:26<00:42, 42.46s/it]
Task 9, Epoch 20/20 => Loss 2.415, Loss_clf 0.393, Loss_fe 0.333, Loss_kd 1.520, Train_accy 75.62: 100%|██████████| 20/20 [14:26<00:00, 41.96s/it]
Task 9, Epoch 20/20 => Loss 2.415, Loss_clf 0.393, Loss_fe 0.333, Loss_kd 1.520, Train_accy 75.62: 100%|██████████| 20/20 [14:26<00:00, 43.34s/it]
2024-04-22 11:25:03,855 [foster.py] => Task 9, Epoch 20/20 => Loss 2.415, Loss_clf 0.393, Loss_fe 0.333, Loss_kd 1.520, Train_accy 75.62
2024-04-22 11:25:03,856 [foster.py] => do not weight align teacher!
2024-04-22 11:25:03,858 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.682,  Train_accy 68.50, Test_accy 76.93:   0%|          | 0/20 [00:58<?, ?it/s]
SNet: Task 9, Epoch 1/20 => Loss 1.682,  Train_accy 68.50, Test_accy 76.93:   5%|▌         | 1/20 [00:58<18:22, 58.03s/it]
SNet: Task 9, Epoch 2/20 => Loss 1.626,  Train_accy 70.12:   5%|▌         | 1/20 [01:49<18:22, 58.03s/it]                 
SNet: Task 9, Epoch 2/20 => Loss 1.626,  Train_accy 70.12:  10%|█         | 2/20 [01:49<16:14, 54.14s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.598,  Train_accy 70.76:  10%|█         | 2/20 [02:41<16:14, 54.14s/it]
SNet: Task 9, Epoch 3/20 => Loss 1.598,  Train_accy 70.76:  15%|█▌        | 3/20 [02:41<15:00, 52.98s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.578,  Train_accy 71.11:  15%|█▌        | 3/20 [03:32<15:00, 52.98s/it]
SNet: Task 9, Epoch 4/20 => Loss 1.578,  Train_accy 71.11:  20%|██        | 4/20 [03:32<13:58, 52.38s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.584,  Train_accy 71.16:  20%|██        | 4/20 [04:24<13:58, 52.38s/it]
SNet: Task 9, Epoch 5/20 => Loss 1.584,  Train_accy 71.16:  25%|██▌       | 5/20 [04:24<13:01, 52.10s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.589,  Train_accy 71.33, Test_accy 77.86:  25%|██▌       | 5/20 [05:22<13:01, 52.10s/it]
SNet: Task 9, Epoch 6/20 => Loss 1.589,  Train_accy 71.33, Test_accy 77.86:  30%|███       | 6/20 [05:22<12:39, 54.25s/it]
SNet: Task 9, Epoch 7/20 => Loss 1.559,  Train_accy 72.45:  30%|███       | 6/20 [06:14<12:39, 54.25s/it]                 
SNet: Task 9, Epoch 7/20 => Loss 1.559,  Train_accy 72.45:  35%|███▌      | 7/20 [06:14<11:33, 53.38s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.560,  Train_accy 71.92:  35%|███▌      | 7/20 [07:05<11:33, 53.38s/it]
SNet: Task 9, Epoch 8/20 => Loss 1.560,  Train_accy 71.92:  40%|████      | 8/20 [07:05<10:33, 52.83s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.580,  Train_accy 72.41:  40%|████      | 8/20 [07:57<10:33, 52.83s/it]
SNet: Task 9, Epoch 9/20 => Loss 1.580,  Train_accy 72.41:  45%|████▌     | 9/20 [07:57<09:36, 52.42s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.563,  Train_accy 72.30:  45%|████▌     | 9/20 [08:48<09:36, 52.42s/it]
SNet: Task 9, Epoch 10/20 => Loss 1.563,  Train_accy 72.30:  50%|█████     | 10/20 [08:48<08:41, 52.16s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.576,  Train_accy 72.21, Test_accy 77.48:  50%|█████     | 10/20 [09:47<08:41, 52.16s/it]
SNet: Task 9, Epoch 11/20 => Loss 1.576,  Train_accy 72.21, Test_accy 77.48:  55%|█████▌    | 11/20 [09:47<08:06, 54.06s/it]
SNet: Task 9, Epoch 12/20 => Loss 1.566,  Train_accy 72.14:  55%|█████▌    | 11/20 [10:38<08:06, 54.06s/it]                 
SNet: Task 9, Epoch 12/20 => Loss 1.566,  Train_accy 72.14:  60%|██████    | 12/20 [10:38<07:06, 53.33s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.544,  Train_accy 72.30:  60%|██████    | 12/20 [11:30<07:06, 53.33s/it]
SNet: Task 9, Epoch 13/20 => Loss 1.544,  Train_accy 72.30:  65%|██████▌   | 13/20 [11:30<06:09, 52.84s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.529,  Train_accy 72.83:  65%|██████▌   | 13/20 [12:22<06:09, 52.84s/it]
SNet: Task 9, Epoch 14/20 => Loss 1.529,  Train_accy 72.83:  70%|███████   | 14/20 [12:22<05:14, 52.49s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.542,  Train_accy 72.96:  70%|███████   | 14/20 [13:13<05:14, 52.49s/it]
SNet: Task 9, Epoch 15/20 => Loss 1.542,  Train_accy 72.96:  75%|███████▌  | 15/20 [13:13<04:20, 52.19s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.556,  Train_accy 72.61, Test_accy 77.69:  75%|███████▌  | 15/20 [14:12<04:20, 52.19s/it]
SNet: Task 9, Epoch 16/20 => Loss 1.556,  Train_accy 72.61, Test_accy 77.69:  80%|████████  | 16/20 [14:12<03:36, 54.03s/it]
SNet: Task 9, Epoch 17/20 => Loss 1.564,  Train_accy 72.87:  80%|████████  | 16/20 [15:03<03:36, 54.03s/it]                 
SNet: Task 9, Epoch 17/20 => Loss 1.564,  Train_accy 72.87:  85%|████████▌ | 17/20 [15:03<02:39, 53.26s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.566,  Train_accy 72.63:  85%|████████▌ | 17/20 [15:55<02:39, 53.26s/it]
SNet: Task 9, Epoch 18/20 => Loss 1.566,  Train_accy 72.63:  90%|█████████ | 18/20 [15:55<01:45, 52.73s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.534,  Train_accy 72.41:  90%|█████████ | 18/20 [16:46<01:45, 52.73s/it]
SNet: Task 9, Epoch 19/20 => Loss 1.534,  Train_accy 72.41:  95%|█████████▌| 19/20 [16:46<00:52, 52.40s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.573,  Train_accy 72.28:  95%|█████████▌| 19/20 [17:38<00:52, 52.40s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.573,  Train_accy 72.28: 100%|██████████| 20/20 [17:38<00:00, 52.15s/it]
SNet: Task 9, Epoch 20/20 => Loss 1.573,  Train_accy 72.28: 100%|██████████| 20/20 [17:38<00:00, 52.91s/it]
2024-04-22 11:42:45,479 [foster.py] => SNet: Task 9, Epoch 20/20 => Loss 1.573,  Train_accy 72.28
2024-04-22 11:42:45,480 [foster.py] => do not weight align student!
2024-04-22 11:42:52,313 [foster.py] => darknet eval: 
2024-04-22 11:42:52,314 [foster.py] => CNN top1 curve: 77.61
2024-04-22 11:42:52,314 [foster.py] => CNN top5 curve: 94.78
2024-04-22 11:42:52,318 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-22 11:45:08,393 [foster.py] => Exemplar size: 4000
2024-04-22 11:45:08,393 [trainer.py] => CNN: {'total': 77.74, '00-19': 89.07, '20-39': 88.89, '40-59': 90.83, '60-79': 86.64, '80-99': 88.1, '100-119': 87.28, '120-139': 79.56, '140-159': 78.0, '160-179': 65.82, '180-199': 22.17, 'old': 83.74, 'new': 22.17}
2024-04-22 11:45:08,394 [trainer.py] => NME: {'total': 87.07, '00-19': 85.02, '20-39': 87.44, '40-59': 88.99, '60-79': 85.02, '80-99': 89.59, '100-119': 89.47, '120-139': 84.0, '140-159': 88.4, '160-179': 86.92, '180-199': 85.65, 'old': 87.22, 'new': 85.65}
2024-04-22 11:45:08,394 [trainer.py] => CNN top1 curve: [97.57, 84.58, 84.52, 76.17, 76.35, 79.66, 78.67, 77.31, 77.91, 77.74]
2024-04-22 11:45:08,394 [trainer.py] => CNN top5 curve: [99.6, 99.34, 98.66, 98.26, 97.98, 97.67, 97.14, 96.46, 96.52, 95.8]
2024-04-22 11:45:08,394 [trainer.py] => NME top1 curve: [98.38, 96.04, 93.6, 92.38, 91.16, 89.55, 88.97, 88.15, 88.06, 87.07]
2024-04-22 11:45:08,394 [trainer.py] => NME top5 curve: [100.0, 99.56, 99.4, 99.02, 98.91, 98.73, 98.54, 98.52, 98.68, 98.05]

Average Accuracy (CNN): 81.05
Average Accuracy (NME): 91.34
2024-04-22 11:45:08,394 [trainer.py] => Average Accuracy (CNN): 81.05
2024-04-22 11:45:08,394 [trainer.py] => Average Accuracy (NME): 91.34
2024-04-22 11:45:08,394 [trainer.py] => Train Time: 11565.57
2024-04-22 11:45:08,394 [trainer.py] => Test Time: 139.20999999999998 

Accuracy Matrix (CNN):
[[97.57 97.98 97.98 95.95 94.74 94.33 93.12 90.28 89.47 89.07]
 [ 0.   68.6  85.02 91.3  91.79 92.75 92.75 90.82 89.37 88.89]
 [ 0.    0.   68.81 79.36 86.7  87.61 89.91 91.28 88.99 90.83]
 [ 0.    0.    0.   40.89 70.04 85.02 87.04 87.04 85.83 86.64]
 [ 0.    0.    0.    0.   44.98 73.23 84.39 86.25 88.48 88.1 ]
 [ 0.    0.    0.    0.    0.   46.05 68.86 82.02 85.09 87.28]
 [ 0.    0.    0.    0.    0.    0.   32.89 64.89 74.67 79.56]
 [ 0.    0.    0.    0.    0.    0.    0.   28.8  66.8  78.  ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   33.33 65.82]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   22.17]]
2024-04-22 11:45:08,395 [trainer.py] => Forgetting (CNN): 1.5555555555555587
Accuracy Matrix (NME):
[[98.38 95.95 93.12 91.5  88.66 87.04 87.04 85.83 87.45 85.02]
 [ 0.   96.14 94.69 90.34 88.89 89.86 88.89 89.37 89.86 87.44]
 [ 0.    0.   93.12 91.74 92.66 89.45 88.53 86.7  88.07 88.99]
 [ 0.    0.    0.   95.55 92.31 88.26 90.69 87.45 87.45 85.02]
 [ 0.    0.    0.    0.   92.94 90.33 89.22 90.33 89.22 89.59]
 [ 0.    0.    0.    0.    0.   92.54 91.67 89.04 89.91 89.47]
 [ 0.    0.    0.    0.    0.    0.   86.67 84.89 83.56 84.  ]
 [ 0.    0.    0.    0.    0.    0.    0.   91.2  88.4  88.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   88.61 86.92]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   85.65]]

2024-04-22 11:45:08,396 [trainer.py] => Forgetting (NME): 5.58888888888889

2024-04-18 21:20:53,471 [trainer.py] => config: ./exps/l2p_cub_B0.json
2024-04-18 21:20:53,471 [trainer.py] => prefix:  
2024-04-18 21:20:53,471 [trainer.py] => dataset: cub
2024-04-18 21:20:53,471 [trainer.py] => memory_size: 0
2024-04-18 21:20:53,471 [trainer.py] => memory_per_class: 0
2024-04-18 21:20:53,471 [trainer.py] => fixed_memory: False
2024-04-18 21:20:53,471 [trainer.py] => shuffle: True
2024-04-18 21:20:53,471 [trainer.py] => init_cls: 20
2024-04-18 21:20:53,471 [trainer.py] => increment: 20
2024-04-18 21:20:53,472 [trainer.py] => model_name: l2p
2024-04-18 21:20:53,472 [trainer.py] => backbone_type: vit_base_patch16_224_l2p
2024-04-18 21:20:53,472 [trainer.py] => get_original_backbone: True
2024-04-18 21:20:53,472 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-18 21:20:53,472 [trainer.py] => seed: 1993
2024-04-18 21:20:53,472 [trainer.py] => tuned_epoch: 20
2024-04-18 21:20:53,472 [trainer.py] => init_lr: 0.001875
2024-04-18 21:20:53,472 [trainer.py] => batch_size: 48
2024-04-18 21:20:53,472 [trainer.py] => weight_decay: 0
2024-04-18 21:20:53,472 [trainer.py] => min_lr: 1e-05
2024-04-18 21:20:53,472 [trainer.py] => optimizer: adam
2024-04-18 21:20:53,472 [trainer.py] => scheduler: constant
2024-04-18 21:20:53,472 [trainer.py] => reinit_optimizer: True
2024-04-18 21:20:53,472 [trainer.py] => global_pool: token
2024-04-18 21:20:53,472 [trainer.py] => head_type: prompt
2024-04-18 21:20:53,472 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-18 21:20:53,472 [trainer.py] => pretrained: True
2024-04-18 21:20:53,472 [trainer.py] => drop: 0.0
2024-04-18 21:20:53,472 [trainer.py] => drop_path: 0.0
2024-04-18 21:20:53,472 [trainer.py] => prompt_pool: True
2024-04-18 21:20:53,472 [trainer.py] => size: 10
2024-04-18 21:20:53,472 [trainer.py] => length: 5
2024-04-18 21:20:53,472 [trainer.py] => top_k: 5
2024-04-18 21:20:53,472 [trainer.py] => initializer: uniform
2024-04-18 21:20:53,472 [trainer.py] => prompt_key: True
2024-04-18 21:20:53,472 [trainer.py] => prompt_key_init: uniform
2024-04-18 21:20:53,472 [trainer.py] => use_prompt_mask: False
2024-04-18 21:20:53,472 [trainer.py] => shared_prompt_pool: False
2024-04-18 21:20:53,472 [trainer.py] => shared_prompt_key: False
2024-04-18 21:20:53,472 [trainer.py] => batchwise_prompt: True
2024-04-18 21:20:53,473 [trainer.py] => embedding_key: cls
2024-04-18 21:20:53,473 [trainer.py] => predefined_key: 
2024-04-18 21:20:53,473 [trainer.py] => pull_constraint: True
2024-04-18 21:20:53,473 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-18 21:20:53,785 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-18 21:20:55,905 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-04-18 21:20:55,905 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-04-18 21:20:59,136 [l2p.py] => 86,017,736 model total parameters.
2024-04-18 21:20:59,137 [l2p.py] => 199,880 model training parameters.
2024-04-18 21:20:59,137 [l2p.py] => prompt.prompt: 38400
2024-04-18 21:20:59,137 [l2p.py] => prompt.prompt_key: 7680
2024-04-18 21:20:59,137 [l2p.py] => head.weight: 153600
2024-04-18 21:20:59,137 [l2p.py] => head.bias: 200
2024-04-18 21:20:59,138 [trainer.py] => All params: 171970192
2024-04-18 21:20:59,139 [trainer.py] => Trainable params: 199880
2024-04-18 21:20:59,139 [l2p.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.247, Train_accy 60.25:   0%|          | 0/20 [00:14<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.247, Train_accy 60.25:   5%|▌         | 1/20 [00:14<04:28, 14.15s/it]
Task 0, Epoch 2/20 => Loss 0.377, Train_accy 88.27:   5%|▌         | 1/20 [00:28<04:28, 14.15s/it]
Task 0, Epoch 2/20 => Loss 0.377, Train_accy 88.27:  10%|█         | 2/20 [00:28<04:11, 14.00s/it]
Task 0, Epoch 3/20 => Loss 0.267, Train_accy 91.01:  10%|█         | 2/20 [00:41<04:11, 14.00s/it]
Task 0, Epoch 3/20 => Loss 0.267, Train_accy 91.01:  15%|█▌        | 3/20 [00:41<03:55, 13.85s/it]
Task 0, Epoch 4/20 => Loss 0.286, Train_accy 90.17:  15%|█▌        | 3/20 [00:54<03:55, 13.85s/it]
Task 0, Epoch 4/20 => Loss 0.286, Train_accy 90.17:  20%|██        | 4/20 [00:54<03:34, 13.41s/it]
Task 0, Epoch 5/20 => Loss 0.245, Train_accy 90.91, Test_accy 97.98:  20%|██        | 4/20 [01:11<03:34, 13.41s/it]
Task 0, Epoch 5/20 => Loss 0.245, Train_accy 90.91, Test_accy 97.98:  25%|██▌       | 5/20 [01:11<03:38, 14.55s/it]
Task 0, Epoch 6/20 => Loss 0.196, Train_accy 92.28:  25%|██▌       | 5/20 [01:24<03:38, 14.55s/it]                 
Task 0, Epoch 6/20 => Loss 0.196, Train_accy 92.28:  30%|███       | 6/20 [01:24<03:20, 14.31s/it]
Task 0, Epoch 7/20 => Loss 0.181, Train_accy 92.81:  30%|███       | 6/20 [01:37<03:20, 14.31s/it]
Task 0, Epoch 7/20 => Loss 0.181, Train_accy 92.81:  35%|███▌      | 7/20 [01:37<02:59, 13.84s/it]
Task 0, Epoch 8/20 => Loss 0.154, Train_accy 92.07:  35%|███▌      | 7/20 [01:52<02:59, 13.84s/it]
Task 0, Epoch 8/20 => Loss 0.154, Train_accy 92.07:  40%|████      | 8/20 [01:52<02:47, 13.99s/it]
Task 0, Epoch 9/20 => Loss 0.125, Train_accy 93.76:  40%|████      | 8/20 [02:06<02:47, 13.99s/it]
Task 0, Epoch 9/20 => Loss 0.125, Train_accy 93.76:  45%|████▌     | 9/20 [02:06<02:34, 14.03s/it]
Task 0, Epoch 10/20 => Loss 0.147, Train_accy 92.39, Test_accy 98.38:  45%|████▌     | 9/20 [02:22<02:34, 14.03s/it]
Task 0, Epoch 10/20 => Loss 0.147, Train_accy 92.39, Test_accy 98.38:  50%|█████     | 10/20 [02:22<02:26, 14.66s/it]
Task 0, Epoch 11/20 => Loss 0.123, Train_accy 92.71:  50%|█████     | 10/20 [02:36<02:26, 14.66s/it]                 
Task 0, Epoch 11/20 => Loss 0.123, Train_accy 92.71:  55%|█████▌    | 11/20 [02:36<02:10, 14.50s/it]
Task 0, Epoch 12/20 => Loss 0.129, Train_accy 93.13:  55%|█████▌    | 11/20 [02:50<02:10, 14.50s/it]
Task 0, Epoch 12/20 => Loss 0.129, Train_accy 93.13:  60%|██████    | 12/20 [02:50<01:54, 14.32s/it]
Task 0, Epoch 13/20 => Loss 0.085, Train_accy 93.13:  60%|██████    | 12/20 [03:03<01:54, 14.32s/it]
Task 0, Epoch 13/20 => Loss 0.085, Train_accy 93.13:  65%|██████▌   | 13/20 [03:03<01:38, 14.05s/it]
Task 0, Epoch 14/20 => Loss 0.076, Train_accy 93.97:  65%|██████▌   | 13/20 [03:18<01:38, 14.05s/it]
Task 0, Epoch 14/20 => Loss 0.076, Train_accy 93.97:  70%|███████   | 14/20 [03:18<01:25, 14.26s/it]
Task 0, Epoch 15/20 => Loss 0.098, Train_accy 93.45, Test_accy 97.98:  70%|███████   | 14/20 [03:35<01:25, 14.26s/it]
Task 0, Epoch 15/20 => Loss 0.098, Train_accy 93.45, Test_accy 97.98:  75%|███████▌  | 15/20 [03:35<01:14, 14.98s/it]
Task 0, Epoch 16/20 => Loss 0.060, Train_accy 93.87:  75%|███████▌  | 15/20 [03:48<01:14, 14.98s/it]                 
Task 0, Epoch 16/20 => Loss 0.060, Train_accy 93.87:  80%|████████  | 16/20 [03:48<00:58, 14.58s/it]
Task 0, Epoch 17/20 => Loss -0.016, Train_accy 94.93:  80%|████████  | 16/20 [04:03<00:58, 14.58s/it]
Task 0, Epoch 17/20 => Loss -0.016, Train_accy 94.93:  85%|████████▌ | 17/20 [04:03<00:43, 14.61s/it]
Task 0, Epoch 18/20 => Loss -0.002, Train_accy 94.82:  85%|████████▌ | 17/20 [04:17<00:43, 14.61s/it]
Task 0, Epoch 18/20 => Loss -0.002, Train_accy 94.82:  90%|█████████ | 18/20 [04:17<00:28, 14.32s/it]
Task 0, Epoch 19/20 => Loss 0.029, Train_accy 94.08:  90%|█████████ | 18/20 [04:30<00:28, 14.32s/it] 
Task 0, Epoch 19/20 => Loss 0.029, Train_accy 94.08:  95%|█████████▌| 19/20 [04:30<00:14, 14.08s/it]
Task 0, Epoch 20/20 => Loss 0.001, Train_accy 94.19, Test_accy 98.79:  95%|█████████▌| 19/20 [04:46<00:14, 14.08s/it]
Task 0, Epoch 20/20 => Loss 0.001, Train_accy 94.19, Test_accy 98.79: 100%|██████████| 20/20 [04:46<00:00, 14.60s/it]
Task 0, Epoch 20/20 => Loss 0.001, Train_accy 94.19, Test_accy 98.79: 100%|██████████| 20/20 [04:46<00:00, 14.32s/it]
2024-04-18 21:25:46,712 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.001, Train_accy 94.19, Test_accy 98.79
2024-04-18 21:25:50,189 [trainer.py] => No NME accuracy.
2024-04-18 21:25:50,190 [trainer.py] => CNN: {'total': 98.79, '00-19': 98.79, 'old': 0, 'new': 98.79}
2024-04-18 21:25:50,190 [trainer.py] => CNN top1 curve: [98.79]
2024-04-18 21:25:50,190 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 98.79
2024-04-18 21:25:50,190 [trainer.py] => Average Accuracy (CNN): 98.79 

2024-04-18 21:25:50,190 [trainer.py] => Train Time: 573.98
2024-04-18 21:25:50,190 [trainer.py] => Test Time: 3.48 

2024-04-18 21:25:50,192 [trainer.py] => All params: 171970192
2024-04-18 21:25:50,194 [trainer.py] => Trainable params: 199880
2024-04-18 21:25:50,194 [l2p.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.890, Train_accy 68.36:   0%|          | 0/20 [00:12<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.890, Train_accy 68.36:   5%|▌         | 1/20 [00:12<04:03, 12.80s/it]
Task 1, Epoch 2/20 => Loss 0.143, Train_accy 90.58:   5%|▌         | 1/20 [00:27<04:03, 12.80s/it]
Task 1, Epoch 2/20 => Loss 0.143, Train_accy 90.58:  10%|█         | 2/20 [00:27<04:11, 13.99s/it]
Task 1, Epoch 3/20 => Loss 0.055, Train_accy 92.91:  10%|█         | 2/20 [00:41<04:11, 13.99s/it]
Task 1, Epoch 3/20 => Loss 0.055, Train_accy 92.91:  15%|█▌        | 3/20 [00:41<03:56, 13.89s/it]
Task 1, Epoch 4/20 => Loss 0.037, Train_accy 92.49:  15%|█▌        | 3/20 [00:55<03:56, 13.89s/it]
Task 1, Epoch 4/20 => Loss 0.037, Train_accy 92.49:  20%|██        | 4/20 [00:55<03:41, 13.84s/it]
Task 1, Epoch 5/20 => Loss 0.055, Train_accy 91.85, Test_accy 85.46:  20%|██        | 4/20 [01:14<03:41, 13.84s/it]
Task 1, Epoch 5/20 => Loss 0.055, Train_accy 91.85, Test_accy 85.46:  25%|██▌       | 5/20 [01:14<03:55, 15.71s/it]
Task 1, Epoch 6/20 => Loss 0.052, Train_accy 93.44:  25%|██▌       | 5/20 [01:26<03:55, 15.71s/it]                 
Task 1, Epoch 6/20 => Loss 0.052, Train_accy 93.44:  30%|███       | 6/20 [01:26<03:25, 14.68s/it]
Task 1, Epoch 7/20 => Loss -0.014, Train_accy 93.12:  30%|███       | 6/20 [01:40<03:25, 14.68s/it]
Task 1, Epoch 7/20 => Loss -0.014, Train_accy 93.12:  35%|███▌      | 7/20 [01:40<03:04, 14.18s/it]
Task 1, Epoch 8/20 => Loss -0.010, Train_accy 94.07:  35%|███▌      | 7/20 [01:53<03:04, 14.18s/it]
Task 1, Epoch 8/20 => Loss -0.010, Train_accy 94.07:  40%|████      | 8/20 [01:53<02:48, 14.00s/it]
Task 1, Epoch 9/20 => Loss 0.004, Train_accy 93.33:  40%|████      | 8/20 [02:08<02:48, 14.00s/it] 
Task 1, Epoch 9/20 => Loss 0.004, Train_accy 93.33:  45%|████▌     | 9/20 [02:08<02:35, 14.17s/it]
Task 1, Epoch 10/20 => Loss -0.065, Train_accy 95.56, Test_accy 87.89:  45%|████▌     | 9/20 [02:27<02:35, 14.17s/it]
Task 1, Epoch 10/20 => Loss -0.065, Train_accy 95.56, Test_accy 87.89:  50%|█████     | 10/20 [02:27<02:36, 15.70s/it]
Task 1, Epoch 11/20 => Loss -0.055, Train_accy 94.39:  50%|█████     | 10/20 [02:40<02:36, 15.70s/it]                 
Task 1, Epoch 11/20 => Loss -0.055, Train_accy 94.39:  55%|█████▌    | 11/20 [02:40<02:13, 14.88s/it]
Task 1, Epoch 12/20 => Loss -0.038, Train_accy 94.29:  55%|█████▌    | 11/20 [02:55<02:13, 14.88s/it]
Task 1, Epoch 12/20 => Loss -0.038, Train_accy 94.29:  60%|██████    | 12/20 [02:55<01:59, 14.89s/it]
Task 1, Epoch 13/20 => Loss -0.054, Train_accy 95.34:  60%|██████    | 12/20 [03:07<01:59, 14.89s/it]
Task 1, Epoch 13/20 => Loss -0.054, Train_accy 95.34:  65%|██████▌   | 13/20 [03:07<01:39, 14.20s/it]
Task 1, Epoch 14/20 => Loss -0.058, Train_accy 94.39:  65%|██████▌   | 13/20 [03:21<01:39, 14.20s/it]
Task 1, Epoch 14/20 => Loss -0.058, Train_accy 94.39:  70%|███████   | 14/20 [03:21<01:24, 14.08s/it]
Task 1, Epoch 15/20 => Loss -0.080, Train_accy 95.24, Test_accy 88.77:  70%|███████   | 14/20 [03:39<01:24, 14.08s/it]
Task 1, Epoch 15/20 => Loss -0.080, Train_accy 95.24, Test_accy 88.77:  75%|███████▌  | 15/20 [03:39<01:16, 15.34s/it]
Task 1, Epoch 16/20 => Loss -0.086, Train_accy 95.24:  75%|███████▌  | 15/20 [03:54<01:16, 15.34s/it]                 
Task 1, Epoch 16/20 => Loss -0.086, Train_accy 95.24:  80%|████████  | 16/20 [03:54<01:00, 15.25s/it]
Task 1, Epoch 17/20 => Loss -0.091, Train_accy 95.03:  80%|████████  | 16/20 [04:09<01:00, 15.25s/it]
Task 1, Epoch 17/20 => Loss -0.091, Train_accy 95.03:  85%|████████▌ | 17/20 [04:09<00:44, 14.94s/it]
Task 1, Epoch 18/20 => Loss -0.064, Train_accy 93.65:  85%|████████▌ | 17/20 [04:22<00:44, 14.94s/it]
Task 1, Epoch 18/20 => Loss -0.064, Train_accy 93.65:  90%|█████████ | 18/20 [04:22<00:28, 14.43s/it]
Task 1, Epoch 19/20 => Loss -0.068, Train_accy 95.03:  90%|█████████ | 18/20 [04:35<00:28, 14.43s/it]
Task 1, Epoch 19/20 => Loss -0.068, Train_accy 95.03:  95%|█████████▌| 19/20 [04:35<00:14, 14.10s/it]
Task 1, Epoch 20/20 => Loss -0.029, Train_accy 94.29, Test_accy 89.65:  95%|█████████▌| 19/20 [04:54<00:14, 14.10s/it]
Task 1, Epoch 20/20 => Loss -0.029, Train_accy 94.29, Test_accy 89.65: 100%|██████████| 20/20 [04:54<00:00, 15.37s/it]
Task 1, Epoch 20/20 => Loss -0.029, Train_accy 94.29, Test_accy 89.65: 100%|██████████| 20/20 [04:54<00:00, 14.70s/it]
2024-04-18 21:30:44,271 [l2p.py] => Task 1, Epoch 20/20 => Loss -0.029, Train_accy 94.29, Test_accy 89.65
2024-04-18 21:30:48,769 [trainer.py] => No NME accuracy.
2024-04-18 21:30:48,769 [trainer.py] => CNN: {'total': 89.65, '00-19': 96.36, '20-39': 81.64, 'old': 96.36, 'new': 81.64}
2024-04-18 21:30:48,769 [trainer.py] => CNN top1 curve: [98.79, 89.65]
2024-04-18 21:30:48,770 [trainer.py] => CNN top5 curve: [100.0, 99.34]

Average Accuracy (CNN): 94.22
2024-04-18 21:30:48,770 [trainer.py] => Average Accuracy (CNN): 94.22 

2024-04-18 21:30:48,770 [trainer.py] => Train Time: 1162.11
2024-04-18 21:30:48,770 [trainer.py] => Test Time: 7.98 

2024-04-18 21:30:48,772 [trainer.py] => All params: 171970192
2024-04-18 21:30:48,774 [trainer.py] => Trainable params: 199880
2024-04-18 21:30:48,774 [l2p.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.737, Train_accy 71.58:   0%|          | 0/20 [00:12<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.737, Train_accy 71.58:   5%|▌         | 1/20 [00:12<04:05, 12.93s/it]
Task 2, Epoch 2/20 => Loss 0.019, Train_accy 91.20:   5%|▌         | 1/20 [00:26<04:05, 12.93s/it]
Task 2, Epoch 2/20 => Loss 0.019, Train_accy 91.20:  10%|█         | 2/20 [00:26<03:57, 13.18s/it]
Task 2, Epoch 3/20 => Loss 0.008, Train_accy 91.09:  10%|█         | 2/20 [00:39<03:57, 13.18s/it]
Task 2, Epoch 3/20 => Loss 0.008, Train_accy 91.09:  15%|█▌        | 3/20 [00:39<03:44, 13.18s/it]
Task 2, Epoch 4/20 => Loss -0.030, Train_accy 93.00:  15%|█▌        | 3/20 [00:53<03:44, 13.18s/it]
Task 2, Epoch 4/20 => Loss -0.030, Train_accy 93.00:  20%|██        | 4/20 [00:53<03:36, 13.56s/it]
Task 2, Epoch 5/20 => Loss -0.038, Train_accy 93.53, Test_accy 82.89:  20%|██        | 4/20 [01:13<03:36, 13.56s/it]
Task 2, Epoch 5/20 => Loss -0.038, Train_accy 93.53, Test_accy 82.89:  25%|██▌       | 5/20 [01:13<03:55, 15.71s/it]
Task 2, Epoch 6/20 => Loss -0.009, Train_accy 92.05:  25%|██▌       | 5/20 [01:25<03:55, 15.71s/it]                 
Task 2, Epoch 6/20 => Loss -0.009, Train_accy 92.05:  30%|███       | 6/20 [01:25<03:26, 14.71s/it]
Task 2, Epoch 7/20 => Loss -0.042, Train_accy 93.32:  30%|███       | 6/20 [01:39<03:26, 14.71s/it]
Task 2, Epoch 7/20 => Loss -0.042, Train_accy 93.32:  35%|███▌      | 7/20 [01:39<03:07, 14.44s/it]
Task 2, Epoch 8/20 => Loss -0.066, Train_accy 93.96:  35%|███▌      | 7/20 [01:54<03:07, 14.44s/it]
Task 2, Epoch 8/20 => Loss -0.066, Train_accy 93.96:  40%|████      | 8/20 [01:54<02:52, 14.38s/it]
Task 2, Epoch 9/20 => Loss -0.086, Train_accy 94.06:  40%|████      | 8/20 [02:07<02:52, 14.38s/it]
Task 2, Epoch 9/20 => Loss -0.086, Train_accy 94.06:  45%|████▌     | 9/20 [02:07<02:35, 14.13s/it]
Task 2, Epoch 10/20 => Loss -0.067, Train_accy 93.32, Test_accy 85.12:  45%|████▌     | 9/20 [02:22<02:35, 14.13s/it]
Task 2, Epoch 10/20 => Loss -0.067, Train_accy 93.32, Test_accy 85.12:  50%|█████     | 10/20 [02:22<02:25, 14.51s/it]
Task 2, Epoch 11/20 => Loss -0.046, Train_accy 93.21:  50%|█████     | 10/20 [02:33<02:25, 14.51s/it]                 
Task 2, Epoch 11/20 => Loss -0.046, Train_accy 93.21:  55%|█████▌    | 11/20 [02:33<01:58, 13.15s/it]
Task 2, Epoch 12/20 => Loss -0.081, Train_accy 94.27:  55%|█████▌    | 11/20 [02:43<01:58, 13.15s/it]
Task 2, Epoch 12/20 => Loss -0.081, Train_accy 94.27:  60%|██████    | 12/20 [02:43<01:38, 12.27s/it]
Task 2, Epoch 13/20 => Loss -0.049, Train_accy 93.32:  60%|██████    | 12/20 [02:53<01:38, 12.27s/it]
Task 2, Epoch 13/20 => Loss -0.049, Train_accy 93.32:  65%|██████▌   | 13/20 [02:53<01:21, 11.64s/it]
Task 2, Epoch 14/20 => Loss -0.114, Train_accy 95.02:  65%|██████▌   | 13/20 [03:03<01:21, 11.64s/it]
Task 2, Epoch 14/20 => Loss -0.114, Train_accy 95.02:  70%|███████   | 14/20 [03:03<01:07, 11.25s/it]
Task 2, Epoch 15/20 => Loss -0.066, Train_accy 94.27, Test_accy 86.46:  70%|███████   | 14/20 [03:18<01:07, 11.25s/it]
Task 2, Epoch 15/20 => Loss -0.066, Train_accy 94.27, Test_accy 86.46:  75%|███████▌  | 15/20 [03:18<01:01, 12.40s/it]
Task 2, Epoch 16/20 => Loss -0.123, Train_accy 95.65:  75%|███████▌  | 15/20 [03:29<01:01, 12.40s/it]                 
Task 2, Epoch 16/20 => Loss -0.123, Train_accy 95.65:  80%|████████  | 16/20 [03:29<00:47, 11.82s/it]
Task 2, Epoch 17/20 => Loss -0.125, Train_accy 95.86:  80%|████████  | 16/20 [03:39<00:47, 11.82s/it]
Task 2, Epoch 17/20 => Loss -0.125, Train_accy 95.86:  85%|████████▌ | 17/20 [03:39<00:34, 11.36s/it]
Task 2, Epoch 18/20 => Loss -0.066, Train_accy 94.38:  85%|████████▌ | 17/20 [03:49<00:34, 11.36s/it]
Task 2, Epoch 18/20 => Loss -0.066, Train_accy 94.38:  90%|█████████ | 18/20 [03:49<00:21, 10.96s/it]
Task 2, Epoch 19/20 => Loss -0.143, Train_accy 96.82:  90%|█████████ | 18/20 [03:59<00:21, 10.96s/it]
Task 2, Epoch 19/20 => Loss -0.143, Train_accy 96.82:  95%|█████████▌| 19/20 [03:59<00:10, 10.72s/it]
Task 2, Epoch 20/20 => Loss -0.105, Train_accy 94.80, Test_accy 87.95:  95%|█████████▌| 19/20 [04:14<00:10, 10.72s/it]
Task 2, Epoch 20/20 => Loss -0.105, Train_accy 94.80, Test_accy 87.95: 100%|██████████| 20/20 [04:14<00:00, 12.02s/it]
Task 2, Epoch 20/20 => Loss -0.105, Train_accy 94.80, Test_accy 87.95: 100%|██████████| 20/20 [04:14<00:00, 12.74s/it]
2024-04-18 21:35:03,678 [l2p.py] => Task 2, Epoch 20/20 => Loss -0.105, Train_accy 94.80, Test_accy 87.95
2024-04-18 21:35:09,126 [trainer.py] => No NME accuracy.
2024-04-18 21:35:09,127 [trainer.py] => CNN: {'total': 87.95, '00-19': 92.71, '20-39': 80.68, '40-59': 89.45, 'old': 87.22, 'new': 89.45}
2024-04-18 21:35:09,127 [trainer.py] => CNN top1 curve: [98.79, 89.65, 87.95]
2024-04-18 21:35:09,127 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.96]

Average Accuracy (CNN): 92.13
2024-04-18 21:35:09,127 [trainer.py] => Average Accuracy (CNN): 92.13 

2024-04-18 21:35:09,127 [trainer.py] => Train Time: 1671.9
2024-04-18 21:35:09,127 [trainer.py] => Test Time: 13.43 

2024-04-18 21:35:09,129 [trainer.py] => All params: 171970192
2024-04-18 21:35:09,131 [trainer.py] => Trainable params: 199880
2024-04-18 21:35:09,131 [l2p.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.735, Train_accy 72.62:   0%|          | 0/20 [00:10<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.735, Train_accy 72.62:   5%|▌         | 1/20 [00:10<03:12, 10.12s/it]
Task 3, Epoch 2/20 => Loss -0.007, Train_accy 91.97:   5%|▌         | 1/20 [00:20<03:12, 10.12s/it]
Task 3, Epoch 2/20 => Loss -0.007, Train_accy 91.97:  10%|█         | 2/20 [00:20<03:02, 10.17s/it]
Task 3, Epoch 3/20 => Loss -0.025, Train_accy 91.97:  10%|█         | 2/20 [00:30<03:02, 10.17s/it]
Task 3, Epoch 3/20 => Loss -0.025, Train_accy 91.97:  15%|█▌        | 3/20 [00:30<02:51, 10.11s/it]
Task 3, Epoch 4/20 => Loss -0.049, Train_accy 93.23:  15%|█▌        | 3/20 [00:40<02:51, 10.11s/it]
Task 3, Epoch 4/20 => Loss -0.049, Train_accy 93.23:  20%|██        | 4/20 [00:40<02:41, 10.09s/it]
Task 3, Epoch 5/20 => Loss -0.106, Train_accy 94.50, Test_accy 81.61:  20%|██        | 4/20 [00:57<02:41, 10.09s/it]
Task 3, Epoch 5/20 => Loss -0.106, Train_accy 94.50, Test_accy 81.61:  25%|██▌       | 5/20 [00:57<03:07, 12.53s/it]
Task 3, Epoch 6/20 => Loss -0.046, Train_accy 93.45:  25%|██▌       | 5/20 [01:07<03:07, 12.53s/it]                 
Task 3, Epoch 6/20 => Loss -0.046, Train_accy 93.45:  30%|███       | 6/20 [01:07<02:43, 11.71s/it]
Task 3, Epoch 7/20 => Loss -0.059, Train_accy 93.45:  30%|███       | 6/20 [01:17<02:43, 11.71s/it]
Task 3, Epoch 7/20 => Loss -0.059, Train_accy 93.45:  35%|███▌      | 7/20 [01:17<02:25, 11.20s/it]
Task 3, Epoch 8/20 => Loss -0.092, Train_accy 93.97:  35%|███▌      | 7/20 [01:27<02:25, 11.20s/it]
Task 3, Epoch 8/20 => Loss -0.092, Train_accy 93.97:  40%|████      | 8/20 [01:27<02:10, 10.87s/it]
Task 3, Epoch 9/20 => Loss -0.098, Train_accy 94.08:  40%|████      | 8/20 [01:38<02:10, 10.87s/it]
Task 3, Epoch 9/20 => Loss -0.098, Train_accy 94.08:  45%|████▌     | 9/20 [01:38<01:57, 10.73s/it]
Task 3, Epoch 10/20 => Loss -0.075, Train_accy 95.24, Test_accy 82.92:  45%|████▌     | 9/20 [01:55<01:57, 10.73s/it]
Task 3, Epoch 10/20 => Loss -0.075, Train_accy 95.24, Test_accy 82.92:  50%|█████     | 10/20 [01:55<02:06, 12.69s/it]
Task 3, Epoch 11/20 => Loss -0.108, Train_accy 95.24:  50%|█████     | 10/20 [02:05<02:06, 12.69s/it]                 
Task 3, Epoch 11/20 => Loss -0.108, Train_accy 95.24:  55%|█████▌    | 11/20 [02:05<01:47, 11.89s/it]
Task 3, Epoch 12/20 => Loss -0.110, Train_accy 95.56:  55%|█████▌    | 11/20 [02:15<01:47, 11.89s/it]
Task 3, Epoch 12/20 => Loss -0.110, Train_accy 95.56:  60%|██████    | 12/20 [02:15<01:31, 11.40s/it]
Task 3, Epoch 13/20 => Loss -0.075, Train_accy 94.40:  60%|██████    | 12/20 [02:25<01:31, 11.40s/it]
Task 3, Epoch 13/20 => Loss -0.075, Train_accy 94.40:  65%|██████▌   | 13/20 [02:25<01:17, 11.03s/it]
Task 3, Epoch 14/20 => Loss -0.089, Train_accy 94.71:  65%|██████▌   | 13/20 [02:35<01:17, 11.03s/it]
Task 3, Epoch 14/20 => Loss -0.089, Train_accy 94.71:  70%|███████   | 14/20 [02:35<01:04, 10.77s/it]
Task 3, Epoch 15/20 => Loss -0.103, Train_accy 94.50, Test_accy 84.11:  70%|███████   | 14/20 [02:56<01:04, 10.77s/it]
Task 3, Epoch 15/20 => Loss -0.103, Train_accy 94.50, Test_accy 84.11:  75%|███████▌  | 15/20 [02:56<01:08, 13.62s/it]
Task 3, Epoch 16/20 => Loss -0.117, Train_accy 95.35:  75%|███████▌  | 15/20 [03:10<01:08, 13.62s/it]                 
Task 3, Epoch 16/20 => Loss -0.117, Train_accy 95.35:  80%|████████  | 16/20 [03:10<00:55, 13.80s/it]
Task 3, Epoch 17/20 => Loss -0.150, Train_accy 96.30:  80%|████████  | 16/20 [03:24<00:55, 13.80s/it]
Task 3, Epoch 17/20 => Loss -0.150, Train_accy 96.30:  85%|████████▌ | 17/20 [03:24<00:41, 13.80s/it]
Task 3, Epoch 18/20 => Loss -0.135, Train_accy 95.88:  85%|████████▌ | 17/20 [03:37<00:41, 13.80s/it]
Task 3, Epoch 18/20 => Loss -0.135, Train_accy 95.88:  90%|█████████ | 18/20 [03:37<00:27, 13.78s/it]
Task 3, Epoch 19/20 => Loss -0.113, Train_accy 95.56:  90%|█████████ | 18/20 [03:51<00:27, 13.78s/it]
Task 3, Epoch 19/20 => Loss -0.113, Train_accy 95.56:  95%|█████████▌| 19/20 [03:51<00:13, 13.69s/it]
Task 3, Epoch 20/20 => Loss -0.095, Train_accy 95.45, Test_accy 82.70:  95%|█████████▌| 19/20 [04:15<00:13, 13.69s/it]
Task 3, Epoch 20/20 => Loss -0.095, Train_accy 95.45, Test_accy 82.70: 100%|██████████| 20/20 [04:15<00:00, 16.70s/it]
Task 3, Epoch 20/20 => Loss -0.095, Train_accy 95.45, Test_accy 82.70: 100%|██████████| 20/20 [04:15<00:00, 12.75s/it]
2024-04-18 21:39:24,214 [l2p.py] => Task 3, Epoch 20/20 => Loss -0.095, Train_accy 95.45, Test_accy 82.70
2024-04-18 21:39:32,663 [trainer.py] => No NME accuracy.
2024-04-18 21:39:32,664 [trainer.py] => CNN: {'total': 82.7, '00-19': 85.02, '20-39': 74.88, '40-59': 88.07, '60-79': 82.19, 'old': 82.89, 'new': 82.19}
2024-04-18 21:39:32,664 [trainer.py] => CNN top1 curve: [98.79, 89.65, 87.95, 82.7]
2024-04-18 21:39:32,664 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.96, 98.8]

Average Accuracy (CNN): 89.7725
2024-04-18 21:39:32,665 [trainer.py] => Average Accuracy (CNN): 89.7725 

2024-04-18 21:39:32,665 [trainer.py] => Train Time: 2182.05
2024-04-18 21:39:32,665 [trainer.py] => Test Time: 21.88 

2024-04-18 21:39:32,668 [trainer.py] => All params: 171970192
2024-04-18 21:39:32,670 [trainer.py] => Trainable params: 199880
2024-04-18 21:39:32,670 [l2p.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.558, Train_accy 77.02:   0%|          | 0/20 [00:13<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.558, Train_accy 77.02:   5%|▌         | 1/20 [00:13<04:19, 13.65s/it]
Task 4, Epoch 2/20 => Loss 0.018, Train_accy 89.72:   5%|▌         | 1/20 [00:26<04:19, 13.65s/it]
Task 4, Epoch 2/20 => Loss 0.018, Train_accy 89.72:  10%|█         | 2/20 [00:26<04:01, 13.44s/it]
Task 4, Epoch 3/20 => Loss -0.037, Train_accy 91.68:  10%|█         | 2/20 [00:40<04:01, 13.44s/it]
Task 4, Epoch 3/20 => Loss -0.037, Train_accy 91.68:  15%|█▌        | 3/20 [00:40<03:51, 13.63s/it]
Task 4, Epoch 4/20 => Loss -0.033, Train_accy 92.45:  15%|█▌        | 3/20 [00:52<03:51, 13.63s/it]
Task 4, Epoch 4/20 => Loss -0.033, Train_accy 92.45:  20%|██        | 4/20 [00:52<03:28, 13.05s/it]
Task 4, Epoch 5/20 => Loss -0.045, Train_accy 92.34, Test_accy 74.24:  20%|██        | 4/20 [01:17<03:28, 13.05s/it]
Task 4, Epoch 5/20 => Loss -0.045, Train_accy 92.34, Test_accy 74.24:  25%|██▌       | 5/20 [01:17<04:15, 17.04s/it]
Task 4, Epoch 6/20 => Loss -0.093, Train_accy 93.54:  25%|██▌       | 5/20 [01:31<04:15, 17.04s/it]                 
Task 4, Epoch 6/20 => Loss -0.093, Train_accy 93.54:  30%|███       | 6/20 [01:31<03:48, 16.32s/it]
Task 4, Epoch 7/20 => Loss -0.058, Train_accy 93.54:  30%|███       | 6/20 [01:44<03:48, 16.32s/it]
Task 4, Epoch 7/20 => Loss -0.058, Train_accy 93.54:  35%|███▌      | 7/20 [01:44<03:16, 15.15s/it]
Task 4, Epoch 8/20 => Loss -0.057, Train_accy 93.11:  35%|███▌      | 7/20 [01:58<03:16, 15.15s/it]
Task 4, Epoch 8/20 => Loss -0.057, Train_accy 93.11:  40%|████      | 8/20 [01:58<02:56, 14.68s/it]
Task 4, Epoch 9/20 => Loss -0.059, Train_accy 93.98:  40%|████      | 8/20 [02:12<02:56, 14.68s/it]
Task 4, Epoch 9/20 => Loss -0.059, Train_accy 93.98:  45%|████▌     | 9/20 [02:12<02:38, 14.39s/it]
Task 4, Epoch 10/20 => Loss 0.057, Train_accy 94.31, Test_accy 76.77:  45%|████▌     | 9/20 [02:36<02:38, 14.39s/it]
Task 4, Epoch 10/20 => Loss 0.057, Train_accy 94.31, Test_accy 76.77:  50%|█████     | 10/20 [02:36<02:53, 17.34s/it]
Task 4, Epoch 11/20 => Loss -0.027, Train_accy 93.44:  50%|█████     | 10/20 [02:49<02:53, 17.34s/it]                
Task 4, Epoch 11/20 => Loss -0.027, Train_accy 93.44:  55%|█████▌    | 11/20 [02:49<02:25, 16.16s/it]
Task 4, Epoch 12/20 => Loss 0.056, Train_accy 90.81:  55%|█████▌    | 11/20 [03:02<02:25, 16.16s/it] 
Task 4, Epoch 12/20 => Loss 0.056, Train_accy 90.81:  60%|██████    | 12/20 [03:02<02:00, 15.12s/it]
Task 4, Epoch 13/20 => Loss 0.001, Train_accy 92.78:  60%|██████    | 12/20 [03:15<02:00, 15.12s/it]
Task 4, Epoch 13/20 => Loss 0.001, Train_accy 92.78:  65%|██████▌   | 13/20 [03:15<01:41, 14.55s/it]
Task 4, Epoch 14/20 => Loss -0.044, Train_accy 92.78:  65%|██████▌   | 13/20 [03:29<01:41, 14.55s/it]
Task 4, Epoch 14/20 => Loss -0.044, Train_accy 92.78:  70%|███████   | 14/20 [03:29<01:25, 14.29s/it]
Task 4, Epoch 15/20 => Loss -0.077, Train_accy 93.98, Test_accy 76.60:  70%|███████   | 14/20 [03:52<01:25, 14.29s/it]
Task 4, Epoch 15/20 => Loss -0.077, Train_accy 93.98, Test_accy 76.60:  75%|███████▌  | 15/20 [03:52<01:25, 17.14s/it]
Task 4, Epoch 16/20 => Loss -0.123, Train_accy 94.86:  75%|███████▌  | 15/20 [04:07<01:25, 17.14s/it]                 
Task 4, Epoch 16/20 => Loss -0.123, Train_accy 94.86:  80%|████████  | 16/20 [04:07<01:05, 16.25s/it]
Task 4, Epoch 17/20 => Loss -0.053, Train_accy 95.40:  80%|████████  | 16/20 [04:20<01:05, 16.25s/it]
Task 4, Epoch 17/20 => Loss -0.053, Train_accy 95.40:  85%|████████▌ | 17/20 [04:20<00:46, 15.39s/it]
Task 4, Epoch 18/20 => Loss -0.108, Train_accy 94.75:  85%|████████▌ | 17/20 [04:32<00:46, 15.39s/it]
Task 4, Epoch 18/20 => Loss -0.108, Train_accy 94.75:  90%|█████████ | 18/20 [04:32<00:28, 14.46s/it]
Task 4, Epoch 19/20 => Loss -0.114, Train_accy 96.17:  90%|█████████ | 18/20 [04:46<00:28, 14.46s/it]
Task 4, Epoch 19/20 => Loss -0.114, Train_accy 96.17:  95%|█████████▌| 19/20 [04:46<00:14, 14.23s/it]
Task 4, Epoch 20/20 => Loss -0.088, Train_accy 94.31, Test_accy 77.27:  95%|█████████▌| 19/20 [05:10<00:14, 14.23s/it]
Task 4, Epoch 20/20 => Loss -0.088, Train_accy 94.31, Test_accy 77.27: 100%|██████████| 20/20 [05:10<00:00, 17.12s/it]
Task 4, Epoch 20/20 => Loss -0.088, Train_accy 94.31, Test_accy 77.27: 100%|██████████| 20/20 [05:10<00:00, 15.52s/it]
2024-04-18 21:44:43,084 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.088, Train_accy 94.31, Test_accy 77.27
2024-04-18 21:44:54,222 [trainer.py] => No NME accuracy.
2024-04-18 21:44:54,222 [trainer.py] => CNN: {'total': 77.27, '00-19': 83.81, '20-39': 71.01, '40-59': 87.16, '60-79': 79.76, '80-99': 65.8, 'old': 80.63, 'new': 65.8}
2024-04-18 21:44:54,223 [trainer.py] => CNN top1 curve: [98.79, 89.65, 87.95, 82.7, 77.27]
2024-04-18 21:44:54,223 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.96, 98.8, 98.4]

Average Accuracy (CNN): 87.27199999999999
2024-04-18 21:44:54,223 [trainer.py] => Average Accuracy (CNN): 87.27199999999999 

2024-04-18 21:44:54,223 [trainer.py] => Train Time: 2802.86
2024-04-18 21:44:54,223 [trainer.py] => Test Time: 33.019999999999996 

2024-04-18 21:44:54,225 [trainer.py] => All params: 171970192
2024-04-18 21:44:54,227 [trainer.py] => Trainable params: 199880
2024-04-18 21:44:54,227 [l2p.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.623, Train_accy 76.16:   0%|          | 0/20 [00:14<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.623, Train_accy 76.16:   5%|▌         | 1/20 [00:14<04:33, 14.39s/it]
Task 5, Epoch 2/20 => Loss -0.070, Train_accy 93.70:   5%|▌         | 1/20 [00:27<04:33, 14.39s/it]
Task 5, Epoch 2/20 => Loss -0.070, Train_accy 93.70:  10%|█         | 2/20 [00:27<04:08, 13.82s/it]
Task 5, Epoch 3/20 => Loss -0.120, Train_accy 95.69:  10%|█         | 2/20 [00:41<04:08, 13.82s/it]
Task 5, Epoch 3/20 => Loss -0.120, Train_accy 95.69:  15%|█▌        | 3/20 [00:41<03:56, 13.91s/it]
Task 5, Epoch 4/20 => Loss -0.099, Train_accy 94.96:  15%|█▌        | 3/20 [00:55<03:56, 13.91s/it]
Task 5, Epoch 4/20 => Loss -0.099, Train_accy 94.96:  20%|██        | 4/20 [00:55<03:39, 13.70s/it]
Task 5, Epoch 5/20 => Loss -0.101, Train_accy 94.54, Test_accy 74.44:  20%|██        | 4/20 [01:24<03:39, 13.70s/it]
Task 5, Epoch 5/20 => Loss -0.101, Train_accy 94.54, Test_accy 74.44:  25%|██▌       | 5/20 [01:24<04:47, 19.18s/it]
Task 5, Epoch 6/20 => Loss -0.134, Train_accy 96.32:  25%|██▌       | 5/20 [01:38<04:47, 19.18s/it]                 
Task 5, Epoch 6/20 => Loss -0.134, Train_accy 96.32:  30%|███       | 6/20 [01:38<04:06, 17.64s/it]
Task 5, Epoch 7/20 => Loss -0.163, Train_accy 96.53:  30%|███       | 6/20 [01:52<04:06, 17.64s/it]
Task 5, Epoch 7/20 => Loss -0.163, Train_accy 96.53:  35%|███▌      | 7/20 [01:52<03:34, 16.52s/it]
Task 5, Epoch 8/20 => Loss -0.136, Train_accy 95.48:  35%|███▌      | 7/20 [02:06<03:34, 16.52s/it]
Task 5, Epoch 8/20 => Loss -0.136, Train_accy 95.48:  40%|████      | 8/20 [02:06<03:06, 15.54s/it]
Task 5, Epoch 9/20 => Loss -0.127, Train_accy 95.38:  40%|████      | 8/20 [02:20<03:06, 15.54s/it]
Task 5, Epoch 9/20 => Loss -0.127, Train_accy 95.38:  45%|████▌     | 9/20 [02:20<02:46, 15.16s/it]
Task 5, Epoch 10/20 => Loss -0.157, Train_accy 96.01, Test_accy 74.65:  45%|████▌     | 9/20 [02:47<02:46, 15.16s/it]
Task 5, Epoch 10/20 => Loss -0.157, Train_accy 96.01, Test_accy 74.65:  50%|█████     | 10/20 [02:47<03:07, 18.77s/it]
Task 5, Epoch 11/20 => Loss -0.096, Train_accy 95.27:  50%|█████     | 10/20 [03:00<03:07, 18.77s/it]                 
Task 5, Epoch 11/20 => Loss -0.096, Train_accy 95.27:  55%|█████▌    | 11/20 [03:00<02:33, 17.03s/it]
Task 5, Epoch 12/20 => Loss -0.151, Train_accy 96.11:  55%|█████▌    | 11/20 [03:13<02:33, 17.03s/it]
Task 5, Epoch 12/20 => Loss -0.151, Train_accy 96.11:  60%|██████    | 12/20 [03:13<02:05, 15.69s/it]
Task 5, Epoch 13/20 => Loss -0.133, Train_accy 96.11:  60%|██████    | 12/20 [03:27<02:05, 15.69s/it]
Task 5, Epoch 13/20 => Loss -0.133, Train_accy 96.11:  65%|██████▌   | 13/20 [03:27<01:45, 15.12s/it]
Task 5, Epoch 14/20 => Loss -0.126, Train_accy 95.80:  65%|██████▌   | 13/20 [03:39<01:45, 15.12s/it]
Task 5, Epoch 14/20 => Loss -0.126, Train_accy 95.80:  70%|███████   | 14/20 [03:39<01:26, 14.39s/it]
Task 5, Epoch 15/20 => Loss -0.147, Train_accy 95.80, Test_accy 76.27:  70%|███████   | 14/20 [04:07<01:26, 14.39s/it]
Task 5, Epoch 15/20 => Loss -0.147, Train_accy 95.80, Test_accy 76.27:  75%|███████▌  | 15/20 [04:07<01:32, 18.54s/it]
Task 5, Epoch 16/20 => Loss -0.117, Train_accy 95.06:  75%|███████▌  | 15/20 [04:21<01:32, 18.54s/it]                 
Task 5, Epoch 16/20 => Loss -0.117, Train_accy 95.06:  80%|████████  | 16/20 [04:21<01:08, 17.13s/it]
Task 5, Epoch 17/20 => Loss -0.110, Train_accy 95.06:  80%|████████  | 16/20 [04:34<01:08, 17.13s/it]
Task 5, Epoch 17/20 => Loss -0.110, Train_accy 95.06:  85%|████████▌ | 17/20 [04:34<00:47, 15.88s/it]
Task 5, Epoch 18/20 => Loss -0.131, Train_accy 96.11:  85%|████████▌ | 17/20 [04:48<00:47, 15.88s/it]
Task 5, Epoch 18/20 => Loss -0.131, Train_accy 96.11:  90%|█████████ | 18/20 [04:48<00:30, 15.21s/it]
Task 5, Epoch 19/20 => Loss -0.080, Train_accy 94.64:  90%|█████████ | 18/20 [05:01<00:30, 15.21s/it]
Task 5, Epoch 19/20 => Loss -0.080, Train_accy 94.64:  95%|█████████▌| 19/20 [05:01<00:14, 14.62s/it]
Task 5, Epoch 20/20 => Loss -0.156, Train_accy 96.32, Test_accy 75.00:  95%|█████████▌| 19/20 [05:28<00:14, 14.62s/it]
Task 5, Epoch 20/20 => Loss -0.156, Train_accy 96.32, Test_accy 75.00: 100%|██████████| 20/20 [05:28<00:00, 18.34s/it]
Task 5, Epoch 20/20 => Loss -0.156, Train_accy 96.32, Test_accy 75.00: 100%|██████████| 20/20 [05:28<00:00, 16.43s/it]
2024-04-18 21:50:22,938 [l2p.py] => Task 5, Epoch 20/20 => Loss -0.156, Train_accy 96.32, Test_accy 75.00
2024-04-18 21:50:36,612 [trainer.py] => No NME accuracy.
2024-04-18 21:50:36,612 [trainer.py] => CNN: {'total': 75.0, '00-19': 79.35, '20-39': 69.08, '40-59': 80.73, '60-79': 79.76, '80-99': 64.68, '100-119': 77.19, 'old': 74.58, 'new': 77.19}
2024-04-18 21:50:36,612 [trainer.py] => CNN top1 curve: [98.79, 89.65, 87.95, 82.7, 77.27, 75.0]
2024-04-18 21:50:36,612 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.96, 98.8, 98.4, 98.31]

Average Accuracy (CNN): 85.22666666666666
2024-04-18 21:50:36,612 [trainer.py] => Average Accuracy (CNN): 85.22666666666666 

2024-04-18 21:50:36,613 [trainer.py] => Train Time: 3460.25
2024-04-18 21:50:36,613 [trainer.py] => Test Time: 46.69 

2024-04-18 21:50:36,614 [trainer.py] => All params: 171970192
2024-04-18 21:50:36,614 [trainer.py] => Trainable params: 199880
2024-04-18 21:50:36,614 [l2p.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.859, Train_accy 65.72:   0%|          | 0/20 [00:14<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.859, Train_accy 65.72:   5%|▌         | 1/20 [00:14<04:26, 14.02s/it]
Task 6, Epoch 2/20 => Loss 0.104, Train_accy 84.49:   5%|▌         | 1/20 [00:28<04:26, 14.02s/it]
Task 6, Epoch 2/20 => Loss 0.104, Train_accy 84.49:  10%|█         | 2/20 [00:28<04:14, 14.13s/it]
Task 6, Epoch 3/20 => Loss 0.029, Train_accy 88.99:  10%|█         | 2/20 [00:42<04:14, 14.13s/it]
Task 6, Epoch 3/20 => Loss 0.029, Train_accy 88.99:  15%|█▌        | 3/20 [00:42<03:59, 14.09s/it]
Task 6, Epoch 4/20 => Loss 0.027, Train_accy 89.62:  15%|█▌        | 3/20 [00:56<03:59, 14.09s/it]
Task 6, Epoch 4/20 => Loss 0.027, Train_accy 89.62:  20%|██        | 4/20 [00:56<03:43, 13.98s/it]
Task 6, Epoch 5/20 => Loss 0.047, Train_accy 88.57, Test_accy 71.72:  20%|██        | 4/20 [01:26<03:43, 13.98s/it]
Task 6, Epoch 5/20 => Loss 0.047, Train_accy 88.57, Test_accy 71.72:  25%|██▌       | 5/20 [01:26<04:58, 19.87s/it]
Task 6, Epoch 6/20 => Loss -0.022, Train_accy 90.67:  25%|██▌       | 5/20 [01:39<04:58, 19.87s/it]                
Task 6, Epoch 6/20 => Loss -0.022, Train_accy 90.67:  30%|███       | 6/20 [01:39<04:05, 17.55s/it]
Task 6, Epoch 7/20 => Loss -0.001, Train_accy 90.04:  30%|███       | 6/20 [01:52<04:05, 17.55s/it]
Task 6, Epoch 7/20 => Loss -0.001, Train_accy 90.04:  35%|███▌      | 7/20 [01:52<03:30, 16.16s/it]
Task 6, Epoch 8/20 => Loss -0.003, Train_accy 90.78:  35%|███▌      | 7/20 [02:05<03:30, 16.16s/it]
Task 6, Epoch 8/20 => Loss -0.003, Train_accy 90.78:  40%|████      | 8/20 [02:05<03:02, 15.18s/it]
Task 6, Epoch 9/20 => Loss -0.050, Train_accy 91.93:  40%|████      | 8/20 [02:19<03:02, 15.18s/it]
Task 6, Epoch 9/20 => Loss -0.050, Train_accy 91.93:  45%|████▌     | 9/20 [02:19<02:42, 14.78s/it]
Task 6, Epoch 10/20 => Loss -0.044, Train_accy 92.24, Test_accy 72.82:  45%|████▌     | 9/20 [02:49<02:42, 14.78s/it]
Task 6, Epoch 10/20 => Loss -0.044, Train_accy 92.24, Test_accy 72.82:  50%|█████     | 10/20 [02:49<03:13, 19.40s/it]
Task 6, Epoch 11/20 => Loss -0.059, Train_accy 92.56:  50%|█████     | 10/20 [03:03<03:13, 19.40s/it]                 
Task 6, Epoch 11/20 => Loss -0.059, Train_accy 92.56:  55%|█████▌    | 11/20 [03:03<02:39, 17.71s/it]
Task 6, Epoch 12/20 => Loss -0.072, Train_accy 92.98:  55%|█████▌    | 11/20 [03:15<02:39, 17.71s/it]
Task 6, Epoch 12/20 => Loss -0.072, Train_accy 92.98:  60%|██████    | 12/20 [03:15<02:09, 16.13s/it]
Task 6, Epoch 13/20 => Loss -0.050, Train_accy 92.56:  60%|██████    | 12/20 [03:30<02:09, 16.13s/it]
Task 6, Epoch 13/20 => Loss -0.050, Train_accy 92.56:  65%|██████▌   | 13/20 [03:30<01:48, 15.55s/it]
Task 6, Epoch 14/20 => Loss -0.091, Train_accy 93.61:  65%|██████▌   | 13/20 [03:45<01:48, 15.55s/it]
Task 6, Epoch 14/20 => Loss -0.091, Train_accy 93.61:  70%|███████   | 14/20 [03:45<01:33, 15.52s/it]
Task 6, Epoch 15/20 => Loss -0.095, Train_accy 93.92, Test_accy 73.67:  70%|███████   | 14/20 [04:14<01:33, 15.52s/it]
Task 6, Epoch 15/20 => Loss -0.095, Train_accy 93.92, Test_accy 73.67:  75%|███████▌  | 15/20 [04:14<01:37, 19.59s/it]
Task 6, Epoch 16/20 => Loss -0.051, Train_accy 92.98:  75%|███████▌  | 15/20 [04:29<01:37, 19.59s/it]                 
Task 6, Epoch 16/20 => Loss -0.051, Train_accy 92.98:  80%|████████  | 16/20 [04:29<01:12, 18.06s/it]
Task 6, Epoch 17/20 => Loss -0.062, Train_accy 92.56:  80%|████████  | 16/20 [04:42<01:12, 18.06s/it]
Task 6, Epoch 17/20 => Loss -0.062, Train_accy 92.56:  85%|████████▌ | 17/20 [04:42<00:50, 16.80s/it]
Task 6, Epoch 18/20 => Loss -0.060, Train_accy 92.56:  85%|████████▌ | 17/20 [04:56<00:50, 16.80s/it]
Task 6, Epoch 18/20 => Loss -0.060, Train_accy 92.56:  90%|█████████ | 18/20 [04:56<00:31, 15.73s/it]
Task 6, Epoch 19/20 => Loss -0.106, Train_accy 94.55:  90%|█████████ | 18/20 [05:11<00:31, 15.73s/it]
Task 6, Epoch 19/20 => Loss -0.106, Train_accy 94.55:  95%|█████████▌| 19/20 [05:11<00:15, 15.47s/it]
Task 6, Epoch 20/20 => Loss -0.142, Train_accy 94.97, Test_accy 74.10:  95%|█████████▌| 19/20 [05:37<00:15, 15.47s/it]
Task 6, Epoch 20/20 => Loss -0.142, Train_accy 94.97, Test_accy 74.10: 100%|██████████| 20/20 [05:37<00:00, 18.92s/it]
Task 6, Epoch 20/20 => Loss -0.142, Train_accy 94.97, Test_accy 74.10: 100%|██████████| 20/20 [05:37<00:00, 16.90s/it]
2024-04-18 21:56:14,601 [l2p.py] => Task 6, Epoch 20/20 => Loss -0.142, Train_accy 94.97, Test_accy 74.10
2024-04-18 21:56:25,861 [trainer.py] => No NME accuracy.
2024-04-18 21:56:25,861 [trainer.py] => CNN: {'total': 74.1, '00-19': 77.33, '20-39': 67.63, '40-59': 78.9, '60-79': 80.16, '80-99': 64.31, '100-119': 76.32, '120-139': 74.67, 'old': 74.01, 'new': 74.67}
2024-04-18 21:56:25,862 [trainer.py] => CNN top1 curve: [98.79, 89.65, 87.95, 82.7, 77.27, 75.0, 74.1]
2024-04-18 21:56:25,862 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.96, 98.8, 98.4, 98.31, 97.93]

Average Accuracy (CNN): 83.63714285714285
2024-04-18 21:56:25,862 [trainer.py] => Average Accuracy (CNN): 83.63714285714285 

2024-04-18 21:56:25,862 [trainer.py] => Train Time: 4136.21
2024-04-18 21:56:25,862 [trainer.py] => Test Time: 57.949999999999996 

2024-04-18 21:56:25,865 [trainer.py] => All params: 171970192
2024-04-18 21:56:25,867 [trainer.py] => Trainable params: 199880
2024-04-18 21:56:25,867 [l2p.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.717, Train_accy 72.28:   0%|          | 0/20 [00:09<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.717, Train_accy 72.28:   5%|▌         | 1/20 [00:09<03:06,  9.81s/it]
Task 7, Epoch 2/20 => Loss 0.007, Train_accy 90.43:   5%|▌         | 1/20 [00:19<03:06,  9.81s/it]
Task 7, Epoch 2/20 => Loss 0.007, Train_accy 90.43:  10%|█         | 2/20 [00:19<02:57,  9.89s/it]
Task 7, Epoch 3/20 => Loss -0.029, Train_accy 93.04:  10%|█         | 2/20 [00:29<02:57,  9.89s/it]
Task 7, Epoch 3/20 => Loss -0.029, Train_accy 93.04:  15%|█▌        | 3/20 [00:29<02:49,  9.95s/it]
Task 7, Epoch 4/20 => Loss -0.057, Train_accy 92.17:  15%|█▌        | 3/20 [00:39<02:49,  9.95s/it]
Task 7, Epoch 4/20 => Loss -0.057, Train_accy 92.17:  20%|██        | 4/20 [00:39<02:39,  9.98s/it]
Task 7, Epoch 5/20 => Loss -0.069, Train_accy 93.48, Test_accy 71.07:  20%|██        | 4/20 [01:03<02:39,  9.98s/it]
Task 7, Epoch 5/20 => Loss -0.069, Train_accy 93.48, Test_accy 71.07:  25%|██▌       | 5/20 [01:03<03:43, 14.87s/it]
Task 7, Epoch 6/20 => Loss -0.042, Train_accy 93.15:  25%|██▌       | 5/20 [01:13<03:43, 14.87s/it]                 
Task 7, Epoch 6/20 => Loss -0.042, Train_accy 93.15:  30%|███       | 6/20 [01:13<03:05, 13.23s/it]
Task 7, Epoch 7/20 => Loss -0.059, Train_accy 93.48:  30%|███       | 6/20 [01:23<03:05, 13.23s/it]
Task 7, Epoch 7/20 => Loss -0.059, Train_accy 93.48:  35%|███▌      | 7/20 [01:23<02:38, 12.18s/it]
Task 7, Epoch 8/20 => Loss -0.040, Train_accy 92.72:  35%|███▌      | 7/20 [01:33<02:38, 12.18s/it]
Task 7, Epoch 8/20 => Loss -0.040, Train_accy 92.72:  40%|████      | 8/20 [01:33<02:17, 11.42s/it]
Task 7, Epoch 9/20 => Loss -0.083, Train_accy 93.48:  40%|████      | 8/20 [01:43<02:17, 11.42s/it]
Task 7, Epoch 9/20 => Loss -0.083, Train_accy 93.48:  45%|████▌     | 9/20 [01:43<02:00, 10.97s/it]
Task 7, Epoch 10/20 => Loss -0.110, Train_accy 94.57, Test_accy 71.81:  45%|████▌     | 9/20 [02:06<02:00, 10.97s/it]
Task 7, Epoch 10/20 => Loss -0.110, Train_accy 94.57, Test_accy 71.81:  50%|█████     | 10/20 [02:06<02:26, 14.68s/it]
Task 7, Epoch 11/20 => Loss -0.085, Train_accy 94.46:  50%|█████     | 10/20 [02:15<02:26, 14.68s/it]                 
Task 7, Epoch 11/20 => Loss -0.085, Train_accy 94.46:  55%|█████▌    | 11/20 [02:15<01:58, 13.19s/it]
Task 7, Epoch 12/20 => Loss -0.039, Train_accy 93.59:  55%|█████▌    | 11/20 [02:25<01:58, 13.19s/it]
Task 7, Epoch 12/20 => Loss -0.039, Train_accy 93.59:  60%|██████    | 12/20 [02:25<01:37, 12.20s/it]
Task 7, Epoch 13/20 => Loss -0.107, Train_accy 94.57:  60%|██████    | 12/20 [02:35<01:37, 12.20s/it]
Task 7, Epoch 13/20 => Loss -0.107, Train_accy 94.57:  65%|██████▌   | 13/20 [02:35<01:20, 11.48s/it]
Task 7, Epoch 14/20 => Loss -0.102, Train_accy 94.57:  65%|██████▌   | 13/20 [02:45<01:20, 11.48s/it]
Task 7, Epoch 14/20 => Loss -0.102, Train_accy 94.57:  70%|███████   | 14/20 [02:45<01:06, 11.07s/it]
Task 7, Epoch 15/20 => Loss -0.063, Train_accy 95.11, Test_accy 71.39:  70%|███████   | 14/20 [03:08<01:06, 11.07s/it]
Task 7, Epoch 15/20 => Loss -0.063, Train_accy 95.11, Test_accy 71.39:  75%|███████▌  | 15/20 [03:08<01:12, 14.58s/it]
Task 7, Epoch 16/20 => Loss -0.055, Train_accy 93.59:  75%|███████▌  | 15/20 [03:18<01:12, 14.58s/it]                 
Task 7, Epoch 16/20 => Loss -0.055, Train_accy 93.59:  80%|████████  | 16/20 [03:18<00:52, 13.24s/it]
Task 7, Epoch 17/20 => Loss -0.108, Train_accy 94.89:  80%|████████  | 16/20 [03:28<00:52, 13.24s/it]
Task 7, Epoch 17/20 => Loss -0.108, Train_accy 94.89:  85%|████████▌ | 17/20 [03:28<00:36, 12.25s/it]
Task 7, Epoch 18/20 => Loss -0.100, Train_accy 94.35:  85%|████████▌ | 17/20 [03:38<00:36, 12.25s/it]
Task 7, Epoch 18/20 => Loss -0.100, Train_accy 94.35:  90%|█████████ | 18/20 [03:38<00:22, 11.49s/it]
Task 7, Epoch 19/20 => Loss -0.145, Train_accy 96.52:  90%|█████████ | 18/20 [03:48<00:22, 11.49s/it]
Task 7, Epoch 19/20 => Loss -0.145, Train_accy 96.52:  95%|█████████▌| 19/20 [03:48<00:11, 11.06s/it]
Task 7, Epoch 20/20 => Loss -0.107, Train_accy 95.43, Test_accy 71.18:  95%|█████████▌| 19/20 [04:11<00:11, 11.06s/it]
Task 7, Epoch 20/20 => Loss -0.107, Train_accy 95.43, Test_accy 71.18: 100%|██████████| 20/20 [04:11<00:00, 14.69s/it]
Task 7, Epoch 20/20 => Loss -0.107, Train_accy 95.43, Test_accy 71.18: 100%|██████████| 20/20 [04:11<00:00, 12.58s/it]
2024-04-18 22:00:37,475 [l2p.py] => Task 7, Epoch 20/20 => Loss -0.107, Train_accy 95.43, Test_accy 71.18
2024-04-18 22:00:50,715 [trainer.py] => No NME accuracy.
2024-04-18 22:00:50,716 [trainer.py] => CNN: {'total': 71.18, '00-19': 75.71, '20-39': 63.77, '40-59': 77.98, '60-79': 72.87, '80-99': 61.71, '100-119': 74.12, '120-139': 68.44, '140-159': 75.2, 'old': 70.57, 'new': 75.2}
2024-04-18 22:00:50,716 [trainer.py] => CNN top1 curve: [98.79, 89.65, 87.95, 82.7, 77.27, 75.0, 74.1, 71.18]
2024-04-18 22:00:50,716 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.96, 98.8, 98.4, 98.31, 97.93, 97.67]

Average Accuracy (CNN): 82.07999999999998
2024-04-18 22:00:50,716 [trainer.py] => Average Accuracy (CNN): 82.07999999999998 

2024-04-18 22:00:50,716 [trainer.py] => Train Time: 4639.400000000001
2024-04-18 22:00:50,716 [trainer.py] => Test Time: 71.19 

2024-04-18 22:00:50,717 [trainer.py] => All params: 171970192
2024-04-18 22:00:50,719 [trainer.py] => Trainable params: 199880
2024-04-18 22:00:50,719 [l2p.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.640, Train_accy 73.59:   0%|          | 0/20 [00:12<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.640, Train_accy 73.59:   5%|▌         | 1/20 [00:12<03:50, 12.13s/it]
Task 8, Epoch 2/20 => Loss -0.044, Train_accy 93.01:   5%|▌         | 1/20 [00:26<03:50, 12.13s/it]
Task 8, Epoch 2/20 => Loss -0.044, Train_accy 93.01:  10%|█         | 2/20 [00:26<04:01, 13.44s/it]
Task 8, Epoch 3/20 => Loss -0.068, Train_accy 93.42:  10%|█         | 2/20 [00:40<04:01, 13.44s/it]
Task 8, Epoch 3/20 => Loss -0.068, Train_accy 93.42:  15%|█▌        | 3/20 [00:40<03:53, 13.74s/it]
Task 8, Epoch 4/20 => Loss -0.115, Train_accy 95.41:  15%|█▌        | 3/20 [00:54<03:53, 13.74s/it]
Task 8, Epoch 4/20 => Loss -0.115, Train_accy 95.41:  20%|██        | 4/20 [00:54<03:40, 13.78s/it]
Task 8, Epoch 5/20 => Loss -0.082, Train_accy 92.80, Test_accy 68.37:  20%|██        | 4/20 [01:28<03:40, 13.78s/it]
Task 8, Epoch 5/20 => Loss -0.082, Train_accy 92.80, Test_accy 68.37:  25%|██▌       | 5/20 [01:28<05:15, 21.06s/it]
Task 8, Epoch 6/20 => Loss -0.139, Train_accy 95.09:  25%|██▌       | 5/20 [01:41<05:15, 21.06s/it]                 
Task 8, Epoch 6/20 => Loss -0.139, Train_accy 95.09:  30%|███       | 6/20 [01:41<04:16, 18.30s/it]
Task 8, Epoch 7/20 => Loss -0.093, Train_accy 93.74:  30%|███       | 6/20 [01:55<04:16, 18.30s/it]
Task 8, Epoch 7/20 => Loss -0.093, Train_accy 93.74:  35%|███▌      | 7/20 [01:55<03:40, 16.99s/it]
Task 8, Epoch 8/20 => Loss -0.097, Train_accy 93.63:  35%|███▌      | 7/20 [02:10<03:40, 16.99s/it]
Task 8, Epoch 8/20 => Loss -0.097, Train_accy 93.63:  40%|████      | 8/20 [02:10<03:17, 16.44s/it]
Task 8, Epoch 9/20 => Loss -0.131, Train_accy 94.89:  40%|████      | 8/20 [02:24<03:17, 16.44s/it]
Task 8, Epoch 9/20 => Loss -0.131, Train_accy 94.89:  45%|████▌     | 9/20 [02:24<02:52, 15.66s/it]
Task 8, Epoch 10/20 => Loss -0.096, Train_accy 93.84, Test_accy 69.78:  45%|████▌     | 9/20 [02:58<02:52, 15.66s/it]
Task 8, Epoch 10/20 => Loss -0.096, Train_accy 93.84, Test_accy 69.78:  50%|█████     | 10/20 [02:58<03:31, 21.19s/it]
Task 8, Epoch 11/20 => Loss -0.147, Train_accy 95.62:  50%|█████     | 10/20 [03:11<03:31, 21.19s/it]                 
Task 8, Epoch 11/20 => Loss -0.147, Train_accy 95.62:  55%|█████▌    | 11/20 [03:11<02:49, 18.82s/it]
Task 8, Epoch 12/20 => Loss -0.124, Train_accy 94.47:  55%|█████▌    | 11/20 [03:25<02:49, 18.82s/it]
Task 8, Epoch 12/20 => Loss -0.124, Train_accy 94.47:  60%|██████    | 12/20 [03:25<02:18, 17.35s/it]
Task 8, Epoch 13/20 => Loss -0.128, Train_accy 94.36:  60%|██████    | 12/20 [03:38<02:18, 17.35s/it]
Task 8, Epoch 13/20 => Loss -0.128, Train_accy 94.36:  65%|██████▌   | 13/20 [03:38<01:52, 16.02s/it]
Task 8, Epoch 14/20 => Loss -0.130, Train_accy 94.47:  65%|██████▌   | 13/20 [03:52<01:52, 16.02s/it]
Task 8, Epoch 14/20 => Loss -0.130, Train_accy 94.47:  70%|███████   | 14/20 [03:52<01:31, 15.24s/it]
Task 8, Epoch 15/20 => Loss -0.088, Train_accy 93.84, Test_accy 70.02:  70%|███████   | 14/20 [04:25<01:31, 15.24s/it]
Task 8, Epoch 15/20 => Loss -0.088, Train_accy 93.84, Test_accy 70.02:  75%|███████▌  | 15/20 [04:25<01:42, 20.56s/it]
Task 8, Epoch 16/20 => Loss -0.141, Train_accy 96.14:  75%|███████▌  | 15/20 [04:38<01:42, 20.56s/it]                 
Task 8, Epoch 16/20 => Loss -0.141, Train_accy 96.14:  80%|████████  | 16/20 [04:38<01:13, 18.45s/it]
Task 8, Epoch 17/20 => Loss -0.131, Train_accy 94.89:  80%|████████  | 16/20 [04:54<01:13, 18.45s/it]
Task 8, Epoch 17/20 => Loss -0.131, Train_accy 94.89:  85%|████████▌ | 17/20 [04:54<00:52, 17.53s/it]
Task 8, Epoch 18/20 => Loss -0.144, Train_accy 95.62:  85%|████████▌ | 17/20 [05:07<00:52, 17.53s/it]
Task 8, Epoch 18/20 => Loss -0.144, Train_accy 95.62:  90%|█████████ | 18/20 [05:07<00:32, 16.19s/it]
Task 8, Epoch 19/20 => Loss -0.162, Train_accy 95.62:  90%|█████████ | 18/20 [05:20<00:32, 16.19s/it]
Task 8, Epoch 19/20 => Loss -0.162, Train_accy 95.62:  95%|█████████▌| 19/20 [05:20<00:15, 15.36s/it]
Task 8, Epoch 20/20 => Loss -0.130, Train_accy 94.89, Test_accy 69.97:  95%|█████████▌| 19/20 [05:53<00:15, 15.36s/it]
Task 8, Epoch 20/20 => Loss -0.130, Train_accy 94.89, Test_accy 69.97: 100%|██████████| 20/20 [05:53<00:00, 20.76s/it]
Task 8, Epoch 20/20 => Loss -0.130, Train_accy 94.89, Test_accy 69.97: 100%|██████████| 20/20 [05:53<00:00, 17.70s/it]
2024-04-18 22:06:44,638 [l2p.py] => Task 8, Epoch 20/20 => Loss -0.130, Train_accy 94.89, Test_accy 69.97
2024-04-18 22:07:04,071 [trainer.py] => No NME accuracy.
2024-04-18 22:07:04,071 [trainer.py] => CNN: {'total': 69.97, '00-19': 72.87, '20-39': 62.8, '40-59': 77.98, '60-79': 71.26, '80-99': 62.08, '100-119': 71.93, '120-139': 68.89, '140-159': 74.0, '160-179': 68.35, 'old': 70.17, 'new': 68.35}
2024-04-18 22:07:04,071 [trainer.py] => CNN top1 curve: [98.79, 89.65, 87.95, 82.7, 77.27, 75.0, 74.1, 71.18, 69.97]
2024-04-18 22:07:04,071 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.96, 98.8, 98.4, 98.31, 97.93, 97.67, 97.13]

Average Accuracy (CNN): 80.73444444444443
2024-04-18 22:07:04,072 [trainer.py] => Average Accuracy (CNN): 80.73444444444443 

2024-04-18 22:07:04,072 [trainer.py] => Train Time: 5347.22
2024-04-18 22:07:04,072 [trainer.py] => Test Time: 90.62 

2024-04-18 22:07:04,073 [trainer.py] => All params: 171970192
2024-04-18 22:07:04,074 [trainer.py] => Trainable params: 199880
2024-04-18 22:07:04,074 [l2p.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.581, Train_accy 75.32:   0%|          | 0/20 [00:13<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.581, Train_accy 75.32:   5%|▌         | 1/20 [00:13<04:21, 13.75s/it]
Task 9, Epoch 2/20 => Loss -0.081, Train_accy 93.59:   5%|▌         | 1/20 [00:26<04:21, 13.75s/it]
Task 9, Epoch 2/20 => Loss -0.081, Train_accy 93.59:  10%|█         | 2/20 [00:26<03:58, 13.23s/it]
Task 9, Epoch 3/20 => Loss -0.090, Train_accy 94.54:  10%|█         | 2/20 [00:40<03:58, 13.23s/it]
Task 9, Epoch 3/20 => Loss -0.090, Train_accy 94.54:  15%|█▌        | 3/20 [00:40<03:50, 13.53s/it]
Task 9, Epoch 4/20 => Loss -0.077, Train_accy 94.33:  15%|█▌        | 3/20 [00:54<03:50, 13.53s/it]
Task 9, Epoch 4/20 => Loss -0.077, Train_accy 94.33:  20%|██        | 4/20 [00:54<03:36, 13.55s/it]
Task 9, Epoch 5/20 => Loss -0.102, Train_accy 94.43, Test_accy 66.67:  20%|██        | 4/20 [01:29<03:36, 13.55s/it]
Task 9, Epoch 5/20 => Loss -0.102, Train_accy 94.43, Test_accy 66.67:  25%|██▌       | 5/20 [01:29<05:20, 21.39s/it]
Task 9, Epoch 6/20 => Loss -0.086, Train_accy 94.22:  25%|██▌       | 5/20 [01:42<05:20, 21.39s/it]                 
Task 9, Epoch 6/20 => Loss -0.086, Train_accy 94.22:  30%|███       | 6/20 [01:42<04:21, 18.65s/it]
Task 9, Epoch 7/20 => Loss -0.082, Train_accy 93.91:  30%|███       | 6/20 [01:57<04:21, 18.65s/it]
Task 9, Epoch 7/20 => Loss -0.082, Train_accy 93.91:  35%|███▌      | 7/20 [01:57<03:45, 17.34s/it]
Task 9, Epoch 8/20 => Loss -0.094, Train_accy 94.43:  35%|███▌      | 7/20 [02:10<03:45, 17.34s/it]
Task 9, Epoch 8/20 => Loss -0.094, Train_accy 94.43:  40%|████      | 8/20 [02:10<03:11, 15.97s/it]
Task 9, Epoch 9/20 => Loss -0.123, Train_accy 95.48:  40%|████      | 8/20 [02:24<03:11, 15.97s/it]
Task 9, Epoch 9/20 => Loss -0.123, Train_accy 95.48:  45%|████▌     | 9/20 [02:24<02:47, 15.25s/it]
Task 9, Epoch 10/20 => Loss -0.116, Train_accy 95.27, Test_accy 67.18:  45%|████▌     | 9/20 [02:59<02:47, 15.25s/it]
Task 9, Epoch 10/20 => Loss -0.116, Train_accy 95.27, Test_accy 67.18:  50%|█████     | 10/20 [02:59<03:35, 21.50s/it]
Task 9, Epoch 11/20 => Loss -0.079, Train_accy 93.07:  50%|█████     | 10/20 [03:12<03:35, 21.50s/it]                 
Task 9, Epoch 11/20 => Loss -0.079, Train_accy 93.07:  55%|█████▌    | 11/20 [03:12<02:49, 18.87s/it]
Task 9, Epoch 12/20 => Loss -0.100, Train_accy 94.96:  55%|█████▌    | 11/20 [03:27<02:49, 18.87s/it]
Task 9, Epoch 12/20 => Loss -0.100, Train_accy 94.96:  60%|██████    | 12/20 [03:27<02:22, 17.83s/it]
Task 9, Epoch 13/20 => Loss -0.126, Train_accy 94.75:  60%|██████    | 12/20 [03:41<02:22, 17.83s/it]
Task 9, Epoch 13/20 => Loss -0.126, Train_accy 94.75:  65%|██████▌   | 13/20 [03:41<01:56, 16.69s/it]
Task 9, Epoch 14/20 => Loss -0.107, Train_accy 94.75:  65%|██████▌   | 13/20 [03:55<01:56, 16.69s/it]
Task 9, Epoch 14/20 => Loss -0.107, Train_accy 94.75:  70%|███████   | 14/20 [03:55<01:33, 15.66s/it]
Task 9, Epoch 15/20 => Loss -0.116, Train_accy 95.06, Test_accy 67.73:  70%|███████   | 14/20 [04:31<01:33, 15.66s/it]
Task 9, Epoch 15/20 => Loss -0.116, Train_accy 95.06, Test_accy 67.73:  75%|███████▌  | 15/20 [04:31<01:48, 21.73s/it]
Task 9, Epoch 16/20 => Loss -0.105, Train_accy 95.06:  75%|███████▌  | 15/20 [04:44<01:48, 21.73s/it]                 
Task 9, Epoch 16/20 => Loss -0.105, Train_accy 95.06:  80%|████████  | 16/20 [04:44<01:17, 19.27s/it]
Task 9, Epoch 17/20 => Loss -0.128, Train_accy 95.06:  80%|████████  | 16/20 [04:58<01:17, 19.27s/it]
Task 9, Epoch 17/20 => Loss -0.128, Train_accy 95.06:  85%|████████▌ | 17/20 [04:58<00:52, 17.60s/it]
Task 9, Epoch 18/20 => Loss -0.144, Train_accy 95.80:  85%|████████▌ | 17/20 [05:12<00:52, 17.60s/it]
Task 9, Epoch 18/20 => Loss -0.144, Train_accy 95.80:  90%|█████████ | 18/20 [05:12<00:33, 16.58s/it]
Task 9, Epoch 19/20 => Loss -0.083, Train_accy 93.91:  90%|█████████ | 18/20 [05:26<00:33, 16.58s/it]
Task 9, Epoch 19/20 => Loss -0.083, Train_accy 93.91:  95%|█████████▌| 19/20 [05:26<00:15, 15.85s/it]
Task 9, Epoch 20/20 => Loss -0.117, Train_accy 95.38, Test_accy 68.45:  95%|█████████▌| 19/20 [06:00<00:15, 15.85s/it]
Task 9, Epoch 20/20 => Loss -0.117, Train_accy 95.38, Test_accy 68.45: 100%|██████████| 20/20 [06:00<00:00, 21.23s/it]
Task 9, Epoch 20/20 => Loss -0.117, Train_accy 95.38, Test_accy 68.45: 100%|██████████| 20/20 [06:00<00:00, 18.02s/it]
2024-04-18 22:13:04,553 [l2p.py] => Task 9, Epoch 20/20 => Loss -0.117, Train_accy 95.38, Test_accy 68.45
2024-04-18 22:13:27,831 [trainer.py] => No NME accuracy.
2024-04-18 22:13:27,831 [trainer.py] => CNN: {'total': 68.45, '00-19': 69.23, '20-39': 57.0, '40-59': 79.36, '60-79': 71.26, '80-99': 57.99, '100-119': 69.74, '120-139': 64.0, '140-159': 73.2, '160-179': 67.93, '180-199': 75.22, 'old': 67.72, 'new': 75.22}
2024-04-18 22:13:27,831 [trainer.py] => CNN top1 curve: [98.79, 89.65, 87.95, 82.7, 77.27, 75.0, 74.1, 71.18, 69.97, 68.45]
2024-04-18 22:13:27,831 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.96, 98.8, 98.4, 98.31, 97.93, 97.67, 97.13, 96.82]

Average Accuracy (CNN): 79.506
2024-04-18 22:13:27,831 [trainer.py] => Average Accuracy (CNN): 79.506 

2024-04-18 22:13:27,832 [trainer.py] => Train Time: 6068.160000000001
2024-04-18 22:13:27,832 [trainer.py] => Test Time: 113.9 

Accuracy Matrix (CNN):
[[98.79 96.36 92.71 85.02 83.81 79.35 77.33 75.71 72.87 69.23]
 [ 0.   81.64 80.68 74.88 71.01 69.08 67.63 63.77 62.8  57.  ]
 [ 0.    0.   89.45 88.07 87.16 80.73 78.9  77.98 77.98 79.36]
 [ 0.    0.    0.   82.19 79.76 79.76 80.16 72.87 71.26 71.26]
 [ 0.    0.    0.    0.   65.8  64.68 64.31 61.71 62.08 57.99]
 [ 0.    0.    0.    0.    0.   77.19 76.32 74.12 71.93 69.74]
 [ 0.    0.    0.    0.    0.    0.   74.67 68.44 68.89 64.  ]
 [ 0.    0.    0.    0.    0.    0.    0.   75.2  74.   73.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   68.35 67.93]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   75.22]]
2024-04-18 22:13:27,834 [trainer.py] => Forgetting (CNN): 11.507777777777777
2024-04-18 22:13:30,861 [trainer.py] => config: ./exps/dualprompt_cub_B0.json
2024-04-18 22:13:30,861 [trainer.py] => prefix:  
2024-04-18 22:13:30,861 [trainer.py] => dataset: cub
2024-04-18 22:13:30,861 [trainer.py] => memory_size: 0
2024-04-18 22:13:30,862 [trainer.py] => memory_per_class: 0
2024-04-18 22:13:30,862 [trainer.py] => fixed_memory: False
2024-04-18 22:13:30,862 [trainer.py] => shuffle: True
2024-04-18 22:13:30,862 [trainer.py] => init_cls: 20
2024-04-18 22:13:30,862 [trainer.py] => increment: 20
2024-04-18 22:13:30,862 [trainer.py] => model_name: dualprompt
2024-04-18 22:13:30,862 [trainer.py] => backbone_type: vit_base_patch16_224_dualprompt
2024-04-18 22:13:30,862 [trainer.py] => get_original_backbone: True
2024-04-18 22:13:30,862 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-18 22:13:30,862 [trainer.py] => seed: 1993
2024-04-18 22:13:30,862 [trainer.py] => tuned_epoch: 20
2024-04-18 22:13:30,862 [trainer.py] => init_lr: 0.001
2024-04-18 22:13:30,862 [trainer.py] => batch_size: 48
2024-04-18 22:13:30,862 [trainer.py] => weight_decay: 0
2024-04-18 22:13:30,862 [trainer.py] => min_lr: 1e-05
2024-04-18 22:13:30,862 [trainer.py] => optimizer: adam
2024-04-18 22:13:30,862 [trainer.py] => scheduler: constant
2024-04-18 22:13:30,862 [trainer.py] => reinit_optimizer: True
2024-04-18 22:13:30,862 [trainer.py] => global_pool: token
2024-04-18 22:13:30,862 [trainer.py] => head_type: token
2024-04-18 22:13:30,862 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-18 22:13:30,862 [trainer.py] => pretrained: True
2024-04-18 22:13:30,863 [trainer.py] => drop: 0.0
2024-04-18 22:13:30,863 [trainer.py] => drop_path: 0.0
2024-04-18 22:13:30,863 [trainer.py] => use_g_prompt: True
2024-04-18 22:13:30,863 [trainer.py] => g_prompt_length: 5
2024-04-18 22:13:30,863 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-04-18 22:13:30,863 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-04-18 22:13:30,863 [trainer.py] => use_e_prompt: True
2024-04-18 22:13:30,863 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-04-18 22:13:30,863 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-04-18 22:13:30,863 [trainer.py] => prompt_pool: True
2024-04-18 22:13:30,863 [trainer.py] => size: 10
2024-04-18 22:13:30,863 [trainer.py] => length: 5
2024-04-18 22:13:30,863 [trainer.py] => top_k: 1
2024-04-18 22:13:30,863 [trainer.py] => initializer: uniform
2024-04-18 22:13:30,863 [trainer.py] => prompt_key: True
2024-04-18 22:13:30,863 [trainer.py] => prompt_key_init: uniform
2024-04-18 22:13:30,863 [trainer.py] => use_prompt_mask: True
2024-04-18 22:13:30,863 [trainer.py] => shared_prompt_pool: True
2024-04-18 22:13:30,863 [trainer.py] => shared_prompt_key: False
2024-04-18 22:13:30,863 [trainer.py] => batchwise_prompt: True
2024-04-18 22:13:30,863 [trainer.py] => embedding_key: cls
2024-04-18 22:13:30,863 [trainer.py] => predefined_key: 
2024-04-18 22:13:30,863 [trainer.py] => pull_constraint: True
2024-04-18 22:13:30,864 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-18 22:13:30,864 [trainer.py] => same_key_value: False
2024-04-18 22:13:31,053 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-18 22:13:36,716 [dualprompt.py] => 86,205,896 model total parameters.
2024-04-18 22:13:36,717 [dualprompt.py] => 407,240 model training parameters.
2024-04-18 22:13:36,717 [dualprompt.py] => g_prompt: 15360
2024-04-18 22:13:36,717 [dualprompt.py] => e_prompt.prompt: 230400
2024-04-18 22:13:36,717 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-04-18 22:13:36,718 [dualprompt.py] => head.weight: 153600
2024-04-18 22:13:36,718 [dualprompt.py] => head.bias: 200
2024-04-18 22:13:36,719 [trainer.py] => All params: 172158352
2024-04-18 22:13:36,719 [trainer.py] => Trainable params: 407240
2024-04-18 22:13:36,720 [dualprompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.333, Train_accy 61.42:   0%|          | 0/20 [00:13<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.333, Train_accy 61.42:   5%|▌         | 1/20 [00:13<04:09, 13.14s/it]
Task 0, Epoch 2/20 => Loss 0.329, Train_accy 89.53:   5%|▌         | 1/20 [00:27<04:09, 13.14s/it]
Task 0, Epoch 2/20 => Loss 0.329, Train_accy 89.53:  10%|█         | 2/20 [00:27<04:06, 13.69s/it]
Task 0, Epoch 3/20 => Loss 0.257, Train_accy 92.18:  10%|█         | 2/20 [00:40<04:06, 13.69s/it]
Task 0, Epoch 3/20 => Loss 0.257, Train_accy 92.18:  15%|█▌        | 3/20 [00:40<03:46, 13.35s/it]
Task 0, Epoch 4/20 => Loss 0.226, Train_accy 93.87:  15%|█▌        | 3/20 [00:51<03:46, 13.35s/it]
Task 0, Epoch 4/20 => Loss 0.226, Train_accy 93.87:  20%|██        | 4/20 [00:51<03:21, 12.62s/it]
Task 0, Epoch 5/20 => Loss 0.198, Train_accy 93.66, Test_accy 97.98:  20%|██        | 4/20 [01:05<03:21, 12.62s/it]
Task 0, Epoch 5/20 => Loss 0.198, Train_accy 93.66, Test_accy 97.98:  25%|██▌       | 5/20 [01:05<03:18, 13.20s/it]
Task 0, Epoch 6/20 => Loss 0.179, Train_accy 94.40:  25%|██▌       | 5/20 [01:18<03:18, 13.20s/it]                 
Task 0, Epoch 6/20 => Loss 0.179, Train_accy 94.40:  30%|███       | 6/20 [01:18<03:00, 12.86s/it]
Task 0, Epoch 7/20 => Loss 0.188, Train_accy 94.71:  30%|███       | 6/20 [01:32<03:00, 12.86s/it]
Task 0, Epoch 7/20 => Loss 0.188, Train_accy 94.71:  35%|███▌      | 7/20 [01:32<02:52, 13.24s/it]
Task 0, Epoch 8/20 => Loss 0.170, Train_accy 94.82:  35%|███▌      | 7/20 [01:44<02:52, 13.24s/it]
Task 0, Epoch 8/20 => Loss 0.170, Train_accy 94.82:  40%|████      | 8/20 [01:44<02:35, 12.96s/it]
Task 0, Epoch 9/20 => Loss 0.131, Train_accy 95.77:  40%|████      | 8/20 [01:57<02:35, 12.96s/it]
Task 0, Epoch 9/20 => Loss 0.131, Train_accy 95.77:  45%|████▌     | 9/20 [01:57<02:22, 12.94s/it]
Task 0, Epoch 10/20 => Loss 0.164, Train_accy 95.24, Test_accy 97.98:  45%|████▌     | 9/20 [02:12<02:22, 12.94s/it]
Task 0, Epoch 10/20 => Loss 0.164, Train_accy 95.24, Test_accy 97.98:  50%|█████     | 10/20 [02:12<02:17, 13.75s/it]
Task 0, Epoch 11/20 => Loss 0.146, Train_accy 95.24:  50%|█████     | 10/20 [02:25<02:17, 13.75s/it]                 
Task 0, Epoch 11/20 => Loss 0.146, Train_accy 95.24:  55%|█████▌    | 11/20 [02:25<02:00, 13.43s/it]
Task 0, Epoch 12/20 => Loss 0.116, Train_accy 96.30:  55%|█████▌    | 11/20 [02:37<02:00, 13.43s/it]
Task 0, Epoch 12/20 => Loss 0.116, Train_accy 96.30:  60%|██████    | 12/20 [02:37<01:44, 13.07s/it]
Task 0, Epoch 13/20 => Loss 0.146, Train_accy 95.35:  60%|██████    | 12/20 [02:50<01:44, 13.07s/it]
Task 0, Epoch 13/20 => Loss 0.146, Train_accy 95.35:  65%|██████▌   | 13/20 [02:50<01:30, 12.88s/it]
Task 0, Epoch 14/20 => Loss 0.142, Train_accy 95.56:  65%|██████▌   | 13/20 [03:02<01:30, 12.88s/it]
Task 0, Epoch 14/20 => Loss 0.142, Train_accy 95.56:  70%|███████   | 14/20 [03:02<01:16, 12.73s/it]
Task 0, Epoch 15/20 => Loss 0.129, Train_accy 95.98, Test_accy 98.38:  70%|███████   | 14/20 [03:20<01:16, 12.73s/it]
Task 0, Epoch 15/20 => Loss 0.129, Train_accy 95.98, Test_accy 98.38:  75%|███████▌  | 15/20 [03:20<01:10, 14.12s/it]
Task 0, Epoch 16/20 => Loss 0.121, Train_accy 96.19:  75%|███████▌  | 15/20 [03:32<01:10, 14.12s/it]                 
Task 0, Epoch 16/20 => Loss 0.121, Train_accy 96.19:  80%|████████  | 16/20 [03:32<00:54, 13.56s/it]
Task 0, Epoch 17/20 => Loss 0.145, Train_accy 95.56:  80%|████████  | 16/20 [03:46<00:54, 13.56s/it]
Task 0, Epoch 17/20 => Loss 0.145, Train_accy 95.56:  85%|████████▌ | 17/20 [03:46<00:41, 13.69s/it]
Task 0, Epoch 18/20 => Loss 0.106, Train_accy 96.19:  85%|████████▌ | 17/20 [03:58<00:41, 13.69s/it]
Task 0, Epoch 18/20 => Loss 0.106, Train_accy 96.19:  90%|█████████ | 18/20 [03:58<00:26, 13.36s/it]
Task 0, Epoch 19/20 => Loss 0.126, Train_accy 95.98:  90%|█████████ | 18/20 [04:11<00:26, 13.36s/it]
Task 0, Epoch 19/20 => Loss 0.126, Train_accy 95.98:  95%|█████████▌| 19/20 [04:11<00:13, 13.25s/it]
Task 0, Epoch 20/20 => Loss 0.128, Train_accy 95.77, Test_accy 97.98:  95%|█████████▌| 19/20 [04:27<00:13, 13.25s/it]
Task 0, Epoch 20/20 => Loss 0.128, Train_accy 95.77, Test_accy 97.98: 100%|██████████| 20/20 [04:27<00:00, 13.95s/it]
Task 0, Epoch 20/20 => Loss 0.128, Train_accy 95.77, Test_accy 97.98: 100%|██████████| 20/20 [04:27<00:00, 13.37s/it]
2024-04-18 22:18:04,993 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.128, Train_accy 95.77, Test_accy 97.98
2024-04-18 22:18:08,003 [trainer.py] => No NME accuracy.
2024-04-18 22:18:08,004 [trainer.py] => CNN: {'total': 97.98, '00-19': 97.98, 'old': 0, 'new': 97.98}
2024-04-18 22:18:08,004 [trainer.py] => CNN top1 curve: [97.98]
2024-04-18 22:18:08,004 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.98
2024-04-18 22:18:08,004 [trainer.py] => Average Accuracy (CNN): 97.98 

2024-04-18 22:18:08,004 [trainer.py] => Train Time: 535.73
2024-04-18 22:18:08,004 [trainer.py] => Test Time: 3.01 

2024-04-18 22:18:08,006 [trainer.py] => All params: 172158352
2024-04-18 22:18:08,007 [trainer.py] => Trainable params: 407240
2024-04-18 22:18:08,007 [dualprompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.272, Train_accy 62.86:   0%|          | 0/20 [00:12<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.272, Train_accy 62.86:   5%|▌         | 1/20 [00:12<03:57, 12.49s/it]
Task 1, Epoch 2/20 => Loss 0.294, Train_accy 90.69:   5%|▌         | 1/20 [00:25<03:57, 12.49s/it]
Task 1, Epoch 2/20 => Loss 0.294, Train_accy 90.69:  10%|█         | 2/20 [00:25<03:50, 12.78s/it]
Task 1, Epoch 3/20 => Loss 0.248, Train_accy 91.53:  10%|█         | 2/20 [00:37<03:50, 12.78s/it]
Task 1, Epoch 3/20 => Loss 0.248, Train_accy 91.53:  15%|█▌        | 3/20 [00:37<03:29, 12.30s/it]
Task 1, Epoch 4/20 => Loss 0.207, Train_accy 93.23:  15%|█▌        | 3/20 [00:50<03:29, 12.30s/it]
Task 1, Epoch 4/20 => Loss 0.207, Train_accy 93.23:  20%|██        | 4/20 [00:50<03:25, 12.87s/it]
Task 1, Epoch 5/20 => Loss 0.167, Train_accy 95.13, Test_accy 86.78:  20%|██        | 4/20 [01:03<03:25, 12.87s/it]
Task 1, Epoch 5/20 => Loss 0.167, Train_accy 95.13, Test_accy 86.78:  25%|██▌       | 5/20 [01:03<03:13, 12.93s/it]
Task 1, Epoch 6/20 => Loss 0.143, Train_accy 95.87:  25%|██▌       | 5/20 [01:13<03:13, 12.93s/it]                 
Task 1, Epoch 6/20 => Loss 0.143, Train_accy 95.87:  30%|███       | 6/20 [01:13<02:43, 11.69s/it]
Task 1, Epoch 7/20 => Loss 0.164, Train_accy 94.29:  30%|███       | 6/20 [01:22<02:43, 11.69s/it]
Task 1, Epoch 7/20 => Loss 0.164, Train_accy 94.29:  35%|███▌      | 7/20 [01:22<02:22, 10.95s/it]
Task 1, Epoch 8/20 => Loss 0.136, Train_accy 96.40:  35%|███▌      | 7/20 [01:32<02:22, 10.95s/it]
Task 1, Epoch 8/20 => Loss 0.136, Train_accy 96.40:  40%|████      | 8/20 [01:32<02:05, 10.45s/it]
Task 1, Epoch 9/20 => Loss 0.155, Train_accy 94.92:  40%|████      | 8/20 [01:41<02:05, 10.45s/it]
Task 1, Epoch 9/20 => Loss 0.155, Train_accy 94.92:  45%|████▌     | 9/20 [01:41<01:50, 10.08s/it]
Task 1, Epoch 10/20 => Loss 0.141, Train_accy 95.24, Test_accy 89.21:  45%|████▌     | 9/20 [01:54<01:50, 10.08s/it]
Task 1, Epoch 10/20 => Loss 0.141, Train_accy 95.24, Test_accy 89.21:  50%|█████     | 10/20 [01:54<01:49, 10.95s/it]
Task 1, Epoch 11/20 => Loss 0.114, Train_accy 96.19:  50%|█████     | 10/20 [02:03<01:49, 10.95s/it]                 
Task 1, Epoch 11/20 => Loss 0.114, Train_accy 96.19:  55%|█████▌    | 11/20 [02:03<01:34, 10.47s/it]
Task 1, Epoch 12/20 => Loss 0.121, Train_accy 95.45:  55%|█████▌    | 11/20 [02:13<01:34, 10.47s/it]
Task 1, Epoch 12/20 => Loss 0.121, Train_accy 95.45:  60%|██████    | 12/20 [02:13<01:21, 10.18s/it]
Task 1, Epoch 13/20 => Loss 0.099, Train_accy 96.40:  60%|██████    | 12/20 [02:22<01:21, 10.18s/it]
Task 1, Epoch 13/20 => Loss 0.099, Train_accy 96.40:  65%|██████▌   | 13/20 [02:22<01:10, 10.00s/it]
Task 1, Epoch 14/20 => Loss 0.137, Train_accy 95.66:  65%|██████▌   | 13/20 [02:31<01:10, 10.00s/it]
Task 1, Epoch 14/20 => Loss 0.137, Train_accy 95.66:  70%|███████   | 14/20 [02:31<00:58,  9.77s/it]
Task 1, Epoch 15/20 => Loss 0.151, Train_accy 95.03, Test_accy 90.31:  70%|███████   | 14/20 [02:44<00:58,  9.77s/it]
Task 1, Epoch 15/20 => Loss 0.151, Train_accy 95.03, Test_accy 90.31:  75%|███████▌  | 15/20 [02:44<00:53, 10.69s/it]
Task 1, Epoch 16/20 => Loss 0.101, Train_accy 96.61:  75%|███████▌  | 15/20 [02:54<00:53, 10.69s/it]                 
Task 1, Epoch 16/20 => Loss 0.101, Train_accy 96.61:  80%|████████  | 16/20 [02:54<00:41, 10.34s/it]
Task 1, Epoch 17/20 => Loss 0.100, Train_accy 96.19:  80%|████████  | 16/20 [03:03<00:41, 10.34s/it]
Task 1, Epoch 17/20 => Loss 0.100, Train_accy 96.19:  85%|████████▌ | 17/20 [03:03<00:30, 10.13s/it]
Task 1, Epoch 18/20 => Loss 0.118, Train_accy 96.72:  85%|████████▌ | 17/20 [03:13<00:30, 10.13s/it]
Task 1, Epoch 18/20 => Loss 0.118, Train_accy 96.72:  90%|█████████ | 18/20 [03:13<00:19,  9.88s/it]
Task 1, Epoch 19/20 => Loss 0.079, Train_accy 97.46:  90%|█████████ | 18/20 [03:22<00:19,  9.88s/it]
Task 1, Epoch 19/20 => Loss 0.079, Train_accy 97.46:  95%|█████████▌| 19/20 [03:22<00:09,  9.74s/it]
Task 1, Epoch 20/20 => Loss 0.120, Train_accy 95.56, Test_accy 90.75:  95%|█████████▌| 19/20 [03:35<00:09,  9.74s/it]
Task 1, Epoch 20/20 => Loss 0.120, Train_accy 95.56, Test_accy 90.75: 100%|██████████| 20/20 [03:35<00:00, 10.70s/it]
Task 1, Epoch 20/20 => Loss 0.120, Train_accy 95.56, Test_accy 90.75: 100%|██████████| 20/20 [03:35<00:00, 10.78s/it]
2024-04-18 22:21:43,605 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.120, Train_accy 95.56, Test_accy 90.75
2024-04-18 22:21:47,098 [trainer.py] => No NME accuracy.
2024-04-18 22:21:47,098 [trainer.py] => CNN: {'total': 90.75, '00-19': 95.14, '20-39': 85.51, 'old': 95.14, 'new': 85.51}
2024-04-18 22:21:47,098 [trainer.py] => CNN top1 curve: [97.98, 90.75]
2024-04-18 22:21:47,099 [trainer.py] => CNN top5 curve: [100.0, 99.34]

Average Accuracy (CNN): 94.36500000000001
2024-04-18 22:21:47,099 [trainer.py] => Average Accuracy (CNN): 94.36500000000001 

2024-04-18 22:21:47,099 [trainer.py] => Train Time: 966.9200000000001
2024-04-18 22:21:47,099 [trainer.py] => Test Time: 6.5 

2024-04-18 22:21:47,102 [trainer.py] => All params: 172158352
2024-04-18 22:21:47,105 [trainer.py] => Trainable params: 407240
2024-04-18 22:21:47,105 [dualprompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.292, Train_accy 67.34:   0%|          | 0/20 [00:09<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.292, Train_accy 67.34:   5%|▌         | 1/20 [00:09<03:02,  9.61s/it]
Task 2, Epoch 2/20 => Loss 0.337, Train_accy 90.35:   5%|▌         | 1/20 [00:19<03:02,  9.61s/it]
Task 2, Epoch 2/20 => Loss 0.337, Train_accy 90.35:  10%|█         | 2/20 [00:19<02:50,  9.49s/it]
Task 2, Epoch 3/20 => Loss 0.242, Train_accy 92.79:  10%|█         | 2/20 [00:28<02:50,  9.49s/it]
Task 2, Epoch 3/20 => Loss 0.242, Train_accy 92.79:  15%|█▌        | 3/20 [00:28<02:39,  9.40s/it]
Task 2, Epoch 4/20 => Loss 0.233, Train_accy 93.00:  15%|█▌        | 3/20 [00:37<02:39,  9.40s/it]
Task 2, Epoch 4/20 => Loss 0.233, Train_accy 93.00:  20%|██        | 4/20 [00:37<02:30,  9.43s/it]
Task 2, Epoch 5/20 => Loss 0.177, Train_accy 94.80, Test_accy 85.27:  20%|██        | 4/20 [00:52<02:30,  9.43s/it]
Task 2, Epoch 5/20 => Loss 0.177, Train_accy 94.80, Test_accy 85.27:  25%|██▌       | 5/20 [00:52<02:47, 11.17s/it]
Task 2, Epoch 6/20 => Loss 0.229, Train_accy 93.00:  25%|██▌       | 5/20 [01:01<02:47, 11.17s/it]                 
Task 2, Epoch 6/20 => Loss 0.229, Train_accy 93.00:  30%|███       | 6/20 [01:01<02:27, 10.54s/it]
Task 2, Epoch 7/20 => Loss 0.202, Train_accy 94.70:  30%|███       | 6/20 [01:10<02:27, 10.54s/it]
Task 2, Epoch 7/20 => Loss 0.202, Train_accy 94.70:  35%|███▌      | 7/20 [01:10<02:12, 10.18s/it]
Task 2, Epoch 8/20 => Loss 0.151, Train_accy 94.49:  35%|███▌      | 7/20 [01:20<02:12, 10.18s/it]
Task 2, Epoch 8/20 => Loss 0.151, Train_accy 94.49:  40%|████      | 8/20 [01:20<01:59,  9.95s/it]
Task 2, Epoch 9/20 => Loss 0.198, Train_accy 93.96:  40%|████      | 8/20 [01:29<01:59,  9.95s/it]
Task 2, Epoch 9/20 => Loss 0.198, Train_accy 93.96:  45%|████▌     | 9/20 [01:29<01:46,  9.73s/it]
Task 2, Epoch 10/20 => Loss 0.145, Train_accy 95.55, Test_accy 85.71:  45%|████▌     | 9/20 [01:44<01:46,  9.73s/it]
Task 2, Epoch 10/20 => Loss 0.145, Train_accy 95.55, Test_accy 85.71:  50%|█████     | 10/20 [01:44<01:52, 11.22s/it]
Task 2, Epoch 11/20 => Loss 0.113, Train_accy 96.82:  50%|█████     | 10/20 [01:53<01:52, 11.22s/it]                 
Task 2, Epoch 11/20 => Loss 0.113, Train_accy 96.82:  55%|█████▌    | 11/20 [01:53<01:35, 10.61s/it]
Task 2, Epoch 12/20 => Loss 0.168, Train_accy 94.38:  55%|█████▌    | 11/20 [02:04<01:35, 10.61s/it]
Task 2, Epoch 12/20 => Loss 0.168, Train_accy 94.38:  60%|██████    | 12/20 [02:04<01:25, 10.71s/it]
Task 2, Epoch 13/20 => Loss 0.163, Train_accy 95.44:  60%|██████    | 12/20 [02:15<01:25, 10.71s/it]
Task 2, Epoch 13/20 => Loss 0.163, Train_accy 95.44:  65%|██████▌   | 13/20 [02:15<01:17, 11.03s/it]
Task 2, Epoch 14/20 => Loss 0.133, Train_accy 95.76:  65%|██████▌   | 13/20 [02:28<01:17, 11.03s/it]
Task 2, Epoch 14/20 => Loss 0.133, Train_accy 95.76:  70%|███████   | 14/20 [02:28<01:08, 11.46s/it]
Task 2, Epoch 15/20 => Loss 0.178, Train_accy 94.17, Test_accy 86.61:  70%|███████   | 14/20 [02:47<01:08, 11.46s/it]
Task 2, Epoch 15/20 => Loss 0.178, Train_accy 94.17, Test_accy 86.61:  75%|███████▌  | 15/20 [02:47<01:08, 13.75s/it]
Task 2, Epoch 16/20 => Loss 0.152, Train_accy 95.55:  75%|███████▌  | 15/20 [02:58<01:08, 13.75s/it]                 
Task 2, Epoch 16/20 => Loss 0.152, Train_accy 95.55:  80%|████████  | 16/20 [02:58<00:52, 13.07s/it]
Task 2, Epoch 17/20 => Loss 0.128, Train_accy 95.44:  80%|████████  | 16/20 [03:11<00:52, 13.07s/it]
Task 2, Epoch 17/20 => Loss 0.128, Train_accy 95.44:  85%|████████▌ | 17/20 [03:11<00:38, 12.94s/it]
Task 2, Epoch 18/20 => Loss 0.121, Train_accy 95.97:  85%|████████▌ | 17/20 [03:24<00:38, 12.94s/it]
Task 2, Epoch 18/20 => Loss 0.121, Train_accy 95.97:  90%|█████████ | 18/20 [03:24<00:26, 13.04s/it]
Task 2, Epoch 19/20 => Loss 0.126, Train_accy 95.55:  90%|█████████ | 18/20 [03:37<00:26, 13.04s/it]
Task 2, Epoch 19/20 => Loss 0.126, Train_accy 95.55:  95%|█████████▌| 19/20 [03:37<00:12, 12.87s/it]
Task 2, Epoch 20/20 => Loss 0.123, Train_accy 95.65, Test_accy 87.50:  95%|█████████▌| 19/20 [03:56<00:12, 12.87s/it]
Task 2, Epoch 20/20 => Loss 0.123, Train_accy 95.65, Test_accy 87.50: 100%|██████████| 20/20 [03:56<00:00, 14.82s/it]
Task 2, Epoch 20/20 => Loss 0.123, Train_accy 95.65, Test_accy 87.50: 100%|██████████| 20/20 [03:56<00:00, 11.84s/it]
2024-04-18 22:25:43,855 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.123, Train_accy 95.65, Test_accy 87.50
2024-04-18 22:25:49,802 [trainer.py] => No NME accuracy.
2024-04-18 22:25:49,802 [trainer.py] => CNN: {'total': 87.5, '00-19': 88.66, '20-39': 83.09, '40-59': 90.37, 'old': 86.12, 'new': 90.37}
2024-04-18 22:25:49,802 [trainer.py] => CNN top1 curve: [97.98, 90.75, 87.5]
2024-04-18 22:25:49,802 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81]

Average Accuracy (CNN): 92.07666666666667
2024-04-18 22:25:49,803 [trainer.py] => Average Accuracy (CNN): 92.07666666666667 

2024-04-18 22:25:49,803 [trainer.py] => Train Time: 1440.41
2024-04-18 22:25:49,803 [trainer.py] => Test Time: 12.440000000000001 

2024-04-18 22:25:49,804 [trainer.py] => All params: 172158352
2024-04-18 22:25:49,805 [trainer.py] => Trainable params: 407240
2024-04-18 22:25:49,805 [dualprompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.170, Train_accy 67.02:   0%|          | 0/20 [00:13<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.170, Train_accy 67.02:   5%|▌         | 1/20 [00:13<04:10, 13.19s/it]
Task 3, Epoch 2/20 => Loss 0.285, Train_accy 91.44:   5%|▌         | 1/20 [00:25<04:10, 13.19s/it]
Task 3, Epoch 2/20 => Loss 0.285, Train_accy 91.44:  10%|█         | 2/20 [00:25<03:51, 12.87s/it]
Task 3, Epoch 3/20 => Loss 0.235, Train_accy 93.34:  10%|█         | 2/20 [00:38<03:51, 12.87s/it]
Task 3, Epoch 3/20 => Loss 0.235, Train_accy 93.34:  15%|█▌        | 3/20 [00:38<03:36, 12.75s/it]
Task 3, Epoch 4/20 => Loss 0.178, Train_accy 93.97:  15%|█▌        | 3/20 [00:51<03:36, 12.75s/it]
Task 3, Epoch 4/20 => Loss 0.178, Train_accy 93.97:  20%|██        | 4/20 [00:51<03:24, 12.77s/it]
Task 3, Epoch 5/20 => Loss 0.219, Train_accy 92.60, Test_accy 82.26:  20%|██        | 4/20 [01:11<03:24, 12.77s/it]
Task 3, Epoch 5/20 => Loss 0.219, Train_accy 92.60, Test_accy 82.26:  25%|██▌       | 5/20 [01:11<03:52, 15.51s/it]
Task 3, Epoch 6/20 => Loss 0.202, Train_accy 94.19:  25%|██▌       | 5/20 [01:25<03:52, 15.51s/it]                 
Task 3, Epoch 6/20 => Loss 0.202, Train_accy 94.19:  30%|███       | 6/20 [01:25<03:30, 15.04s/it]
Task 3, Epoch 7/20 => Loss 0.184, Train_accy 95.14:  30%|███       | 6/20 [01:38<03:30, 15.04s/it]
Task 3, Epoch 7/20 => Loss 0.184, Train_accy 95.14:  35%|███▌      | 7/20 [01:38<03:05, 14.30s/it]
Task 3, Epoch 8/20 => Loss 0.135, Train_accy 95.56:  35%|███▌      | 7/20 [01:50<03:05, 14.30s/it]
Task 3, Epoch 8/20 => Loss 0.135, Train_accy 95.56:  40%|████      | 8/20 [01:50<02:44, 13.69s/it]
Task 3, Epoch 9/20 => Loss 0.151, Train_accy 94.82:  40%|████      | 8/20 [02:02<02:44, 13.69s/it]
Task 3, Epoch 9/20 => Loss 0.151, Train_accy 94.82:  45%|████▌     | 9/20 [02:02<02:24, 13.13s/it]
Task 3, Epoch 10/20 => Loss 0.151, Train_accy 94.71, Test_accy 83.03:  45%|████▌     | 9/20 [02:26<02:24, 13.13s/it]
Task 3, Epoch 10/20 => Loss 0.151, Train_accy 94.71, Test_accy 83.03:  50%|█████     | 10/20 [02:26<02:42, 16.24s/it]
Task 3, Epoch 11/20 => Loss 0.134, Train_accy 95.77:  50%|█████     | 10/20 [02:38<02:42, 16.24s/it]                 
Task 3, Epoch 11/20 => Loss 0.134, Train_accy 95.77:  55%|█████▌    | 11/20 [02:38<02:15, 15.11s/it]
Task 3, Epoch 12/20 => Loss 0.147, Train_accy 94.71:  55%|█████▌    | 11/20 [02:52<02:15, 15.11s/it]
Task 3, Epoch 12/20 => Loss 0.147, Train_accy 94.71:  60%|██████    | 12/20 [02:52<01:58, 14.84s/it]
Task 3, Epoch 13/20 => Loss 0.137, Train_accy 95.56:  60%|██████    | 12/20 [03:05<01:58, 14.84s/it]
Task 3, Epoch 13/20 => Loss 0.137, Train_accy 95.56:  65%|██████▌   | 13/20 [03:05<01:39, 14.19s/it]
Task 3, Epoch 14/20 => Loss 0.123, Train_accy 95.35:  65%|██████▌   | 13/20 [03:18<01:39, 14.19s/it]
Task 3, Epoch 14/20 => Loss 0.123, Train_accy 95.35:  70%|███████   | 14/20 [03:18<01:22, 13.73s/it]
Task 3, Epoch 15/20 => Loss 0.154, Train_accy 94.40, Test_accy 83.90:  70%|███████   | 14/20 [03:38<01:22, 13.73s/it]
Task 3, Epoch 15/20 => Loss 0.154, Train_accy 94.40, Test_accy 83.90:  75%|███████▌  | 15/20 [03:38<01:19, 15.82s/it]
Task 3, Epoch 16/20 => Loss 0.115, Train_accy 95.35:  75%|███████▌  | 15/20 [03:51<01:19, 15.82s/it]                 
Task 3, Epoch 16/20 => Loss 0.115, Train_accy 95.35:  80%|████████  | 16/20 [03:51<00:59, 14.90s/it]
Task 3, Epoch 17/20 => Loss 0.145, Train_accy 94.71:  80%|████████  | 16/20 [04:03<00:59, 14.90s/it]
Task 3, Epoch 17/20 => Loss 0.145, Train_accy 94.71:  85%|████████▌ | 17/20 [04:03<00:42, 14.06s/it]
Task 3, Epoch 18/20 => Loss 0.097, Train_accy 96.72:  85%|████████▌ | 17/20 [04:18<00:42, 14.06s/it]
Task 3, Epoch 18/20 => Loss 0.097, Train_accy 96.72:  90%|█████████ | 18/20 [04:18<00:28, 14.16s/it]
Task 3, Epoch 19/20 => Loss 0.121, Train_accy 95.77:  90%|█████████ | 18/20 [04:31<00:28, 14.16s/it]
Task 3, Epoch 19/20 => Loss 0.121, Train_accy 95.77:  95%|█████████▌| 19/20 [04:31<00:14, 14.08s/it]
Task 3, Epoch 20/20 => Loss 0.122, Train_accy 95.35, Test_accy 82.59:  95%|█████████▌| 19/20 [04:53<00:14, 14.08s/it]
Task 3, Epoch 20/20 => Loss 0.122, Train_accy 95.35, Test_accy 82.59: 100%|██████████| 20/20 [04:53<00:00, 16.27s/it]
Task 3, Epoch 20/20 => Loss 0.122, Train_accy 95.35, Test_accy 82.59: 100%|██████████| 20/20 [04:53<00:00, 14.67s/it]
2024-04-18 22:30:43,138 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.122, Train_accy 95.35, Test_accy 82.59
2024-04-18 22:30:51,963 [trainer.py] => No NME accuracy.
2024-04-18 22:30:51,964 [trainer.py] => CNN: {'total': 82.59, '00-19': 74.9, '20-39': 80.68, '40-59': 88.07, '60-79': 87.04, 'old': 80.95, 'new': 87.04}
2024-04-18 22:30:51,964 [trainer.py] => CNN top1 curve: [97.98, 90.75, 87.5, 82.59]
2024-04-18 22:30:51,964 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 99.13]

Average Accuracy (CNN): 89.70500000000001
2024-04-18 22:30:51,964 [trainer.py] => Average Accuracy (CNN): 89.70500000000001 

2024-04-18 22:30:51,964 [trainer.py] => Train Time: 2027.06
2024-04-18 22:30:51,964 [trainer.py] => Test Time: 21.26 

2024-04-18 22:30:51,965 [trainer.py] => All params: 172158352
2024-04-18 22:30:51,967 [trainer.py] => Trainable params: 407240
2024-04-18 22:30:51,967 [dualprompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.245, Train_accy 66.63:   0%|          | 0/20 [00:12<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.245, Train_accy 66.63:   5%|▌         | 1/20 [00:12<03:54, 12.33s/it]
Task 4, Epoch 2/20 => Loss 0.395, Train_accy 87.86:   5%|▌         | 1/20 [00:24<03:54, 12.33s/it]
Task 4, Epoch 2/20 => Loss 0.395, Train_accy 87.86:  10%|█         | 2/20 [00:24<03:40, 12.25s/it]
Task 4, Epoch 3/20 => Loss 0.299, Train_accy 90.15:  10%|█         | 2/20 [00:36<03:40, 12.25s/it]
Task 4, Epoch 3/20 => Loss 0.299, Train_accy 90.15:  15%|█▌        | 3/20 [00:36<03:22, 11.92s/it]
Task 4, Epoch 4/20 => Loss 0.236, Train_accy 92.12:  15%|█▌        | 3/20 [00:48<03:22, 11.92s/it]
Task 4, Epoch 4/20 => Loss 0.236, Train_accy 92.12:  20%|██        | 4/20 [00:48<03:13, 12.12s/it]
Task 4, Epoch 5/20 => Loss 0.180, Train_accy 93.87, Test_accy 76.35:  20%|██        | 4/20 [01:11<03:13, 12.12s/it]
Task 4, Epoch 5/20 => Loss 0.180, Train_accy 93.87, Test_accy 76.35:  25%|██▌       | 5/20 [01:11<04:00, 16.00s/it]
Task 4, Epoch 6/20 => Loss 0.161, Train_accy 93.33:  25%|██▌       | 5/20 [01:24<04:00, 16.00s/it]                 
Task 4, Epoch 6/20 => Loss 0.161, Train_accy 93.33:  30%|███       | 6/20 [01:24<03:28, 14.92s/it]
Task 4, Epoch 7/20 => Loss 0.166, Train_accy 93.65:  30%|███       | 6/20 [01:36<03:28, 14.92s/it]
Task 4, Epoch 7/20 => Loss 0.166, Train_accy 93.65:  35%|███▌      | 7/20 [01:36<03:03, 14.08s/it]
Task 4, Epoch 8/20 => Loss 0.223, Train_accy 92.67:  35%|███▌      | 7/20 [01:48<03:03, 14.08s/it]
Task 4, Epoch 8/20 => Loss 0.223, Train_accy 92.67:  40%|████      | 8/20 [01:48<02:40, 13.38s/it]
Task 4, Epoch 9/20 => Loss 0.193, Train_accy 93.98:  40%|████      | 8/20 [02:02<02:40, 13.38s/it]
Task 4, Epoch 9/20 => Loss 0.193, Train_accy 93.98:  45%|████▌     | 9/20 [02:02<02:29, 13.57s/it]
Task 4, Epoch 10/20 => Loss 0.172, Train_accy 93.76, Test_accy 77.10:  45%|████▌     | 9/20 [02:26<02:29, 13.57s/it]
Task 4, Epoch 10/20 => Loss 0.172, Train_accy 93.76, Test_accy 77.10:  50%|█████     | 10/20 [02:26<02:48, 16.85s/it]
Task 4, Epoch 11/20 => Loss 0.147, Train_accy 94.86:  50%|█████     | 10/20 [02:38<02:48, 16.85s/it]                 
Task 4, Epoch 11/20 => Loss 0.147, Train_accy 94.86:  55%|█████▌    | 11/20 [02:38<02:19, 15.48s/it]
Task 4, Epoch 12/20 => Loss 0.161, Train_accy 93.98:  55%|█████▌    | 11/20 [02:51<02:19, 15.48s/it]
Task 4, Epoch 12/20 => Loss 0.161, Train_accy 93.98:  60%|██████    | 12/20 [02:51<01:57, 14.69s/it]
Task 4, Epoch 13/20 => Loss 0.162, Train_accy 94.64:  60%|██████    | 12/20 [03:03<01:57, 14.69s/it]
Task 4, Epoch 13/20 => Loss 0.162, Train_accy 94.64:  65%|██████▌   | 13/20 [03:03<01:36, 13.79s/it]
Task 4, Epoch 14/20 => Loss 0.291, Train_accy 93.00:  65%|██████▌   | 13/20 [03:16<01:36, 13.79s/it]
Task 4, Epoch 14/20 => Loss 0.291, Train_accy 93.00:  70%|███████   | 14/20 [03:16<01:20, 13.39s/it]
Task 4, Epoch 15/20 => Loss 0.153, Train_accy 94.97, Test_accy 77.27:  70%|███████   | 14/20 [03:39<01:20, 13.39s/it]
Task 4, Epoch 15/20 => Loss 0.153, Train_accy 94.97, Test_accy 77.27:  75%|███████▌  | 15/20 [03:39<01:22, 16.52s/it]
Task 4, Epoch 16/20 => Loss 0.159, Train_accy 94.75:  75%|███████▌  | 15/20 [03:53<01:22, 16.52s/it]                 
Task 4, Epoch 16/20 => Loss 0.159, Train_accy 94.75:  80%|████████  | 16/20 [03:53<01:03, 15.78s/it]
Task 4, Epoch 17/20 => Loss 0.128, Train_accy 95.73:  80%|████████  | 16/20 [04:05<01:03, 15.78s/it]
Task 4, Epoch 17/20 => Loss 0.128, Train_accy 95.73:  85%|████████▌ | 17/20 [04:05<00:43, 14.64s/it]
Task 4, Epoch 18/20 => Loss 0.131, Train_accy 95.51:  85%|████████▌ | 17/20 [04:17<00:43, 14.64s/it]
Task 4, Epoch 18/20 => Loss 0.131, Train_accy 95.51:  90%|█████████ | 18/20 [04:17<00:27, 13.64s/it]
Task 4, Epoch 19/20 => Loss 0.156, Train_accy 95.08:  90%|█████████ | 18/20 [04:30<00:27, 13.64s/it]
Task 4, Epoch 19/20 => Loss 0.156, Train_accy 95.08:  95%|█████████▌| 19/20 [04:30<00:13, 13.58s/it]
Task 4, Epoch 20/20 => Loss 0.192, Train_accy 94.09, Test_accy 78.45:  95%|█████████▌| 19/20 [04:53<00:13, 13.58s/it]
Task 4, Epoch 20/20 => Loss 0.192, Train_accy 94.09, Test_accy 78.45: 100%|██████████| 20/20 [04:53<00:00, 16.46s/it]
Task 4, Epoch 20/20 => Loss 0.192, Train_accy 94.09, Test_accy 78.45: 100%|██████████| 20/20 [04:53<00:00, 14.69s/it]
2024-04-18 22:35:45,765 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.192, Train_accy 94.09, Test_accy 78.45
2024-04-18 22:35:56,872 [trainer.py] => No NME accuracy.
2024-04-18 22:35:56,872 [trainer.py] => CNN: {'total': 78.45, '00-19': 66.4, '20-39': 81.16, '40-59': 86.24, '60-79': 85.43, '80-99': 74.72, 'old': 79.54, 'new': 74.72}
2024-04-18 22:35:56,872 [trainer.py] => CNN top1 curve: [97.98, 90.75, 87.5, 82.59, 78.45]
2024-04-18 22:35:56,872 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 99.13, 99.16]

Average Accuracy (CNN): 87.45400000000001
2024-04-18 22:35:56,872 [trainer.py] => Average Accuracy (CNN): 87.45400000000001 

2024-04-18 22:35:56,872 [trainer.py] => Train Time: 2614.65
2024-04-18 22:35:56,872 [trainer.py] => Test Time: 32.36 

2024-04-18 22:35:56,874 [trainer.py] => All params: 172158352
2024-04-18 22:35:56,875 [trainer.py] => Trainable params: 407240
2024-04-18 22:35:56,875 [dualprompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.029, Train_accy 73.21:   0%|          | 0/20 [00:12<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.029, Train_accy 73.21:   5%|▌         | 1/20 [00:12<03:59, 12.58s/it]
Task 5, Epoch 2/20 => Loss 0.252, Train_accy 92.44:   5%|▌         | 1/20 [00:26<03:59, 12.58s/it]
Task 5, Epoch 2/20 => Loss 0.252, Train_accy 92.44:  10%|█         | 2/20 [00:26<04:01, 13.40s/it]
Task 5, Epoch 3/20 => Loss 0.173, Train_accy 94.85:  10%|█         | 2/20 [00:38<04:01, 13.40s/it]
Task 5, Epoch 3/20 => Loss 0.173, Train_accy 94.85:  15%|█▌        | 3/20 [00:38<03:39, 12.94s/it]
Task 5, Epoch 4/20 => Loss 0.152, Train_accy 95.17:  15%|█▌        | 3/20 [00:51<03:39, 12.94s/it]
Task 5, Epoch 4/20 => Loss 0.152, Train_accy 95.17:  20%|██        | 4/20 [00:51<03:23, 12.74s/it]
Task 5, Epoch 5/20 => Loss 0.150, Train_accy 95.38, Test_accy 74.86:  20%|██        | 4/20 [01:16<03:23, 12.74s/it]
Task 5, Epoch 5/20 => Loss 0.150, Train_accy 95.38, Test_accy 74.86:  25%|██▌       | 5/20 [01:16<04:20, 17.37s/it]
Task 5, Epoch 6/20 => Loss 0.126, Train_accy 96.32:  25%|██▌       | 5/20 [01:29<04:20, 17.37s/it]                 
Task 5, Epoch 6/20 => Loss 0.126, Train_accy 96.32:  30%|███       | 6/20 [01:29<03:38, 15.57s/it]
Task 5, Epoch 7/20 => Loss 0.141, Train_accy 95.90:  30%|███       | 6/20 [01:42<03:38, 15.57s/it]
Task 5, Epoch 7/20 => Loss 0.141, Train_accy 95.90:  35%|███▌      | 7/20 [01:42<03:11, 14.75s/it]
Task 5, Epoch 8/20 => Loss 0.158, Train_accy 94.85:  35%|███▌      | 7/20 [01:55<03:11, 14.75s/it]
Task 5, Epoch 8/20 => Loss 0.158, Train_accy 94.85:  40%|████      | 8/20 [01:55<02:50, 14.20s/it]
Task 5, Epoch 9/20 => Loss 0.150, Train_accy 94.96:  40%|████      | 8/20 [02:08<02:50, 14.20s/it]
Task 5, Epoch 9/20 => Loss 0.150, Train_accy 94.96:  45%|████▌     | 9/20 [02:08<02:32, 13.84s/it]
Task 5, Epoch 10/20 => Loss 0.107, Train_accy 96.95, Test_accy 75.42:  45%|████▌     | 9/20 [02:36<02:32, 13.84s/it]
Task 5, Epoch 10/20 => Loss 0.107, Train_accy 96.95, Test_accy 75.42:  50%|█████     | 10/20 [02:36<03:03, 18.36s/it]
Task 5, Epoch 11/20 => Loss 0.099, Train_accy 97.06:  50%|█████     | 10/20 [02:49<03:03, 18.36s/it]                 
Task 5, Epoch 11/20 => Loss 0.099, Train_accy 97.06:  55%|█████▌    | 11/20 [02:49<02:29, 16.65s/it]
Task 5, Epoch 12/20 => Loss 0.109, Train_accy 96.01:  55%|█████▌    | 11/20 [03:01<02:29, 16.65s/it]
Task 5, Epoch 12/20 => Loss 0.109, Train_accy 96.01:  60%|██████    | 12/20 [03:01<02:02, 15.33s/it]
Task 5, Epoch 13/20 => Loss 0.121, Train_accy 96.22:  60%|██████    | 12/20 [03:14<02:02, 15.33s/it]
Task 5, Epoch 13/20 => Loss 0.121, Train_accy 96.22:  65%|██████▌   | 13/20 [03:14<01:41, 14.56s/it]
Task 5, Epoch 14/20 => Loss 0.096, Train_accy 96.43:  65%|██████▌   | 13/20 [03:26<01:41, 14.56s/it]
Task 5, Epoch 14/20 => Loss 0.096, Train_accy 96.43:  70%|███████   | 14/20 [03:26<01:23, 13.88s/it]
Task 5, Epoch 15/20 => Loss 0.121, Train_accy 95.80, Test_accy 74.51:  70%|███████   | 14/20 [03:51<01:23, 13.88s/it]
Task 5, Epoch 15/20 => Loss 0.121, Train_accy 95.80, Test_accy 74.51:  75%|███████▌  | 15/20 [03:51<01:25, 17.12s/it]
Task 5, Epoch 16/20 => Loss 0.103, Train_accy 96.43:  75%|███████▌  | 15/20 [04:05<01:25, 17.12s/it]                 
Task 5, Epoch 16/20 => Loss 0.103, Train_accy 96.43:  80%|████████  | 16/20 [04:05<01:04, 16.17s/it]
Task 5, Epoch 17/20 => Loss 0.146, Train_accy 95.80:  80%|████████  | 16/20 [04:20<01:04, 16.17s/it]
Task 5, Epoch 17/20 => Loss 0.146, Train_accy 95.80:  85%|████████▌ | 17/20 [04:20<00:47, 15.70s/it]
Task 5, Epoch 18/20 => Loss 0.063, Train_accy 97.48:  85%|████████▌ | 17/20 [04:32<00:47, 15.70s/it]
Task 5, Epoch 18/20 => Loss 0.063, Train_accy 97.48:  90%|█████████ | 18/20 [04:32<00:29, 14.58s/it]
Task 5, Epoch 19/20 => Loss 0.081, Train_accy 96.64:  90%|█████████ | 18/20 [04:44<00:29, 14.58s/it]
Task 5, Epoch 19/20 => Loss 0.081, Train_accy 96.64:  95%|█████████▌| 19/20 [04:44<00:14, 14.02s/it]
Task 5, Epoch 20/20 => Loss 0.106, Train_accy 96.11, Test_accy 75.00:  95%|█████████▌| 19/20 [05:10<00:14, 14.02s/it]
Task 5, Epoch 20/20 => Loss 0.106, Train_accy 96.11, Test_accy 75.00: 100%|██████████| 20/20 [05:10<00:00, 17.69s/it]
Task 5, Epoch 20/20 => Loss 0.106, Train_accy 96.11, Test_accy 75.00: 100%|██████████| 20/20 [05:10<00:00, 15.55s/it]
2024-04-18 22:41:07,849 [dualprompt.py] => Task 5, Epoch 20/20 => Loss 0.106, Train_accy 96.11, Test_accy 75.00
2024-04-18 22:41:20,033 [trainer.py] => No NME accuracy.
2024-04-18 22:41:20,033 [trainer.py] => CNN: {'total': 75.0, '00-19': 63.97, '20-39': 76.33, '40-59': 82.57, '60-79': 79.76, '80-99': 71.75, '100-119': 77.19, 'old': 74.58, 'new': 77.19}
2024-04-18 22:41:20,033 [trainer.py] => CNN top1 curve: [97.98, 90.75, 87.5, 82.59, 78.45, 75.0]
2024-04-18 22:41:20,033 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 99.13, 99.16, 98.73]

Average Accuracy (CNN): 85.37833333333333
2024-04-18 22:41:20,033 [trainer.py] => Average Accuracy (CNN): 85.37833333333333 

2024-04-18 22:41:20,033 [trainer.py] => Train Time: 3236.58
2024-04-18 22:41:20,033 [trainer.py] => Test Time: 44.54 

2024-04-18 22:41:20,035 [trainer.py] => All params: 172158352
2024-04-18 22:41:20,036 [trainer.py] => Trainable params: 407240
2024-04-18 22:41:20,036 [dualprompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.423, Train_accy 59.43:   0%|          | 0/20 [00:13<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.423, Train_accy 59.43:   5%|▌         | 1/20 [00:13<04:13, 13.35s/it]
Task 6, Epoch 2/20 => Loss 0.464, Train_accy 84.70:   5%|▌         | 1/20 [00:23<04:13, 13.35s/it]
Task 6, Epoch 2/20 => Loss 0.464, Train_accy 84.70:  10%|█         | 2/20 [00:23<03:21, 11.18s/it]
Task 6, Epoch 3/20 => Loss 0.326, Train_accy 88.47:  10%|█         | 2/20 [00:32<03:21, 11.18s/it]
Task 6, Epoch 3/20 => Loss 0.326, Train_accy 88.47:  15%|█▌        | 3/20 [00:32<02:58, 10.52s/it]
Task 6, Epoch 4/20 => Loss 0.339, Train_accy 88.57:  15%|█▌        | 3/20 [00:42<02:58, 10.52s/it]
Task 6, Epoch 4/20 => Loss 0.339, Train_accy 88.57:  20%|██        | 4/20 [00:42<02:41, 10.08s/it]
Task 6, Epoch 5/20 => Loss 0.256, Train_accy 91.72, Test_accy 72.03:  20%|██        | 4/20 [01:02<02:41, 10.08s/it]
Task 6, Epoch 5/20 => Loss 0.256, Train_accy 91.72, Test_accy 72.03:  25%|██▌       | 5/20 [01:02<03:28, 13.91s/it]
Task 6, Epoch 6/20 => Loss 0.267, Train_accy 92.03:  25%|██▌       | 5/20 [01:12<03:28, 13.91s/it]                 
Task 6, Epoch 6/20 => Loss 0.267, Train_accy 92.03:  30%|███       | 6/20 [01:12<02:54, 12.45s/it]
Task 6, Epoch 7/20 => Loss 0.259, Train_accy 92.35:  30%|███       | 6/20 [01:22<02:54, 12.45s/it]
Task 6, Epoch 7/20 => Loss 0.259, Train_accy 92.35:  35%|███▌      | 7/20 [01:22<02:30, 11.59s/it]
Task 6, Epoch 8/20 => Loss 0.254, Train_accy 90.99:  35%|███▌      | 7/20 [01:32<02:30, 11.59s/it]
Task 6, Epoch 8/20 => Loss 0.254, Train_accy 90.99:  40%|████      | 8/20 [01:32<02:12, 11.02s/it]
Task 6, Epoch 9/20 => Loss 0.205, Train_accy 93.08:  40%|████      | 8/20 [01:41<02:12, 11.02s/it]
Task 6, Epoch 9/20 => Loss 0.205, Train_accy 93.08:  45%|████▌     | 9/20 [01:41<01:56, 10.61s/it]
Task 6, Epoch 10/20 => Loss 0.206, Train_accy 91.93, Test_accy 73.67:  45%|████▌     | 9/20 [02:02<01:56, 10.61s/it]
Task 6, Epoch 10/20 => Loss 0.206, Train_accy 91.93, Test_accy 73.67:  50%|█████     | 10/20 [02:02<02:15, 13.58s/it]
Task 6, Epoch 11/20 => Loss 0.209, Train_accy 92.56:  50%|█████     | 10/20 [02:11<02:15, 13.58s/it]                 
Task 6, Epoch 11/20 => Loss 0.209, Train_accy 92.56:  55%|█████▌    | 11/20 [02:11<01:51, 12.37s/it]
Task 6, Epoch 12/20 => Loss 0.194, Train_accy 93.82:  55%|█████▌    | 11/20 [02:21<01:51, 12.37s/it]
Task 6, Epoch 12/20 => Loss 0.194, Train_accy 93.82:  60%|██████    | 12/20 [02:21<01:31, 11.46s/it]
Task 6, Epoch 13/20 => Loss 0.194, Train_accy 93.71:  60%|██████    | 12/20 [02:30<01:31, 11.46s/it]
Task 6, Epoch 13/20 => Loss 0.194, Train_accy 93.71:  65%|██████▌   | 13/20 [02:30<01:15, 10.86s/it]
Task 6, Epoch 14/20 => Loss 0.179, Train_accy 94.03:  65%|██████▌   | 13/20 [02:40<01:15, 10.86s/it]
Task 6, Epoch 14/20 => Loss 0.179, Train_accy 94.03:  70%|███████   | 14/20 [02:40<01:03, 10.51s/it]
Task 6, Epoch 15/20 => Loss 0.196, Train_accy 93.82, Test_accy 73.25:  70%|███████   | 14/20 [03:00<01:03, 10.51s/it]
Task 6, Epoch 15/20 => Loss 0.196, Train_accy 93.82, Test_accy 73.25:  75%|███████▌  | 15/20 [03:00<01:07, 13.42s/it]
Task 6, Epoch 16/20 => Loss 0.166, Train_accy 94.86:  75%|███████▌  | 15/20 [03:10<01:07, 13.42s/it]                 
Task 6, Epoch 16/20 => Loss 0.166, Train_accy 94.86:  80%|████████  | 16/20 [03:10<00:49, 12.30s/it]
Task 6, Epoch 17/20 => Loss 0.187, Train_accy 93.71:  80%|████████  | 16/20 [03:19<00:49, 12.30s/it]
Task 6, Epoch 17/20 => Loss 0.187, Train_accy 93.71:  85%|████████▌ | 17/20 [03:19<00:34, 11.44s/it]
Task 6, Epoch 18/20 => Loss 0.136, Train_accy 94.86:  85%|████████▌ | 17/20 [03:29<00:34, 11.44s/it]
Task 6, Epoch 18/20 => Loss 0.136, Train_accy 94.86:  90%|█████████ | 18/20 [03:29<00:21, 10.89s/it]
Task 6, Epoch 19/20 => Loss 0.192, Train_accy 94.34:  90%|█████████ | 18/20 [03:38<00:21, 10.89s/it]
Task 6, Epoch 19/20 => Loss 0.192, Train_accy 94.34:  95%|█████████▌| 19/20 [03:38<00:10, 10.52s/it]
Task 6, Epoch 20/20 => Loss 0.148, Train_accy 95.49, Test_accy 74.53:  95%|█████████▌| 19/20 [03:59<00:10, 10.52s/it]
Task 6, Epoch 20/20 => Loss 0.148, Train_accy 95.49, Test_accy 74.53: 100%|██████████| 20/20 [03:59<00:00, 13.44s/it]
Task 6, Epoch 20/20 => Loss 0.148, Train_accy 95.49, Test_accy 74.53: 100%|██████████| 20/20 [03:59<00:00, 11.95s/it]
2024-04-18 22:45:19,065 [dualprompt.py] => Task 6, Epoch 20/20 => Loss 0.148, Train_accy 95.49, Test_accy 74.53
2024-04-18 22:45:29,902 [trainer.py] => No NME accuracy.
2024-04-18 22:45:29,903 [trainer.py] => CNN: {'total': 74.53, '00-19': 61.94, '20-39': 77.29, '40-59': 80.73, '60-79': 79.76, '80-99': 70.26, '100-119': 76.75, '120-139': 76.89, 'old': 74.15, 'new': 76.89}
2024-04-18 22:45:29,903 [trainer.py] => CNN top1 curve: [97.98, 90.75, 87.5, 82.59, 78.45, 75.0, 74.53]
2024-04-18 22:45:29,903 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 99.13, 99.16, 98.73, 98.6]

Average Accuracy (CNN): 83.82857142857142
2024-04-18 22:45:29,903 [trainer.py] => Average Accuracy (CNN): 83.82857142857142 

2024-04-18 22:45:29,903 [trainer.py] => Train Time: 3714.63
2024-04-18 22:45:29,903 [trainer.py] => Test Time: 55.379999999999995 

2024-04-18 22:45:29,906 [trainer.py] => All params: 172158352
2024-04-18 22:45:29,909 [trainer.py] => Trainable params: 407240
2024-04-18 22:45:29,909 [dualprompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.225, Train_accy 63.70:   0%|          | 0/20 [00:09<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.225, Train_accy 63.70:   5%|▌         | 1/20 [00:09<02:56,  9.29s/it]
Task 7, Epoch 2/20 => Loss 0.390, Train_accy 90.11:   5%|▌         | 1/20 [00:18<02:56,  9.29s/it]
Task 7, Epoch 2/20 => Loss 0.390, Train_accy 90.11:  10%|█         | 2/20 [00:18<02:46,  9.23s/it]
Task 7, Epoch 3/20 => Loss 0.311, Train_accy 91.41:  10%|█         | 2/20 [00:27<02:46,  9.23s/it]
Task 7, Epoch 3/20 => Loss 0.311, Train_accy 91.41:  15%|█▌        | 3/20 [00:27<02:35,  9.17s/it]
Task 7, Epoch 4/20 => Loss 0.241, Train_accy 93.37:  15%|█▌        | 3/20 [00:36<02:35,  9.17s/it]
Task 7, Epoch 4/20 => Loss 0.241, Train_accy 93.37:  20%|██        | 4/20 [00:36<02:27,  9.23s/it]
Task 7, Epoch 5/20 => Loss 0.176, Train_accy 94.57, Test_accy 72.03:  20%|██        | 4/20 [01:02<02:27,  9.23s/it]
Task 7, Epoch 5/20 => Loss 0.176, Train_accy 94.57, Test_accy 72.03:  25%|██▌       | 5/20 [01:02<03:45, 15.05s/it]
Task 7, Epoch 6/20 => Loss 0.230, Train_accy 93.48:  25%|██▌       | 5/20 [01:14<03:45, 15.05s/it]                 
Task 7, Epoch 6/20 => Loss 0.230, Train_accy 93.48:  30%|███       | 6/20 [01:14<03:15, 13.99s/it]
Task 7, Epoch 7/20 => Loss 0.181, Train_accy 94.35:  30%|███       | 6/20 [01:27<03:15, 13.99s/it]
Task 7, Epoch 7/20 => Loss 0.181, Train_accy 94.35:  35%|███▌      | 7/20 [01:27<02:57, 13.68s/it]
Task 7, Epoch 8/20 => Loss 0.170, Train_accy 94.89:  35%|███▌      | 7/20 [01:38<02:57, 13.68s/it]
Task 7, Epoch 8/20 => Loss 0.170, Train_accy 94.89:  40%|████      | 8/20 [01:38<02:35, 12.96s/it]
Task 7, Epoch 9/20 => Loss 0.137, Train_accy 95.76:  40%|████      | 8/20 [01:50<02:35, 12.96s/it]
Task 7, Epoch 9/20 => Loss 0.137, Train_accy 95.76:  45%|████▌     | 9/20 [01:50<02:18, 12.59s/it]
Task 7, Epoch 10/20 => Loss 0.141, Train_accy 95.76, Test_accy 72.77:  45%|████▌     | 9/20 [02:18<02:18, 12.59s/it]
Task 7, Epoch 10/20 => Loss 0.141, Train_accy 95.76, Test_accy 72.77:  50%|█████     | 10/20 [02:18<02:54, 17.48s/it]
Task 7, Epoch 11/20 => Loss 0.165, Train_accy 94.57:  50%|█████     | 10/20 [02:31<02:54, 17.48s/it]                 
Task 7, Epoch 11/20 => Loss 0.165, Train_accy 94.57:  55%|█████▌    | 11/20 [02:31<02:22, 15.89s/it]
Task 7, Epoch 12/20 => Loss 0.190, Train_accy 94.89:  55%|█████▌    | 11/20 [02:43<02:22, 15.89s/it]
Task 7, Epoch 12/20 => Loss 0.190, Train_accy 94.89:  60%|██████    | 12/20 [02:43<01:58, 14.75s/it]
Task 7, Epoch 13/20 => Loss 0.154, Train_accy 95.33:  60%|██████    | 12/20 [02:56<01:58, 14.75s/it]
Task 7, Epoch 13/20 => Loss 0.154, Train_accy 95.33:  65%|██████▌   | 13/20 [02:56<01:40, 14.38s/it]
Task 7, Epoch 14/20 => Loss 0.161, Train_accy 94.89:  65%|██████▌   | 13/20 [03:08<01:40, 14.38s/it]
Task 7, Epoch 14/20 => Loss 0.161, Train_accy 94.89:  70%|███████   | 14/20 [03:08<01:22, 13.71s/it]
Task 7, Epoch 15/20 => Loss 0.183, Train_accy 95.54, Test_accy 72.77:  70%|███████   | 14/20 [03:37<01:22, 13.71s/it]
Task 7, Epoch 15/20 => Loss 0.183, Train_accy 95.54, Test_accy 72.77:  75%|███████▌  | 15/20 [03:37<01:31, 18.28s/it]
Task 7, Epoch 16/20 => Loss 0.127, Train_accy 95.33:  75%|███████▌  | 15/20 [03:50<01:31, 18.28s/it]                 
Task 7, Epoch 16/20 => Loss 0.127, Train_accy 95.33:  80%|████████  | 16/20 [03:50<01:06, 16.59s/it]
Task 7, Epoch 17/20 => Loss 0.139, Train_accy 95.22:  80%|████████  | 16/20 [04:02<01:06, 16.59s/it]
Task 7, Epoch 17/20 => Loss 0.139, Train_accy 95.22:  85%|████████▌ | 17/20 [04:02<00:45, 15.22s/it]
Task 7, Epoch 18/20 => Loss 0.127, Train_accy 95.33:  85%|████████▌ | 17/20 [04:14<00:45, 15.22s/it]
Task 7, Epoch 18/20 => Loss 0.127, Train_accy 95.33:  90%|█████████ | 18/20 [04:14<00:28, 14.16s/it]
Task 7, Epoch 19/20 => Loss 0.130, Train_accy 95.98:  90%|█████████ | 18/20 [04:27<00:28, 14.16s/it]
Task 7, Epoch 19/20 => Loss 0.130, Train_accy 95.98:  95%|█████████▌| 19/20 [04:27<00:14, 14.04s/it]
Task 7, Epoch 20/20 => Loss 0.144, Train_accy 96.20, Test_accy 73.03:  95%|█████████▌| 19/20 [05:14<00:14, 14.04s/it]
Task 7, Epoch 20/20 => Loss 0.144, Train_accy 96.20, Test_accy 73.03: 100%|██████████| 20/20 [05:14<00:00, 23.79s/it]
Task 7, Epoch 20/20 => Loss 0.144, Train_accy 96.20, Test_accy 73.03: 100%|██████████| 20/20 [05:14<00:00, 15.73s/it]
2024-04-18 22:50:44,437 [dualprompt.py] => Task 7, Epoch 20/20 => Loss 0.144, Train_accy 96.20, Test_accy 73.03
2024-04-18 22:51:02,523 [trainer.py] => No NME accuracy.
2024-04-18 22:51:02,524 [trainer.py] => CNN: {'total': 73.03, '00-19': 61.54, '20-39': 72.46, '40-59': 79.82, '60-79': 78.14, '80-99': 69.52, '100-119': 75.44, '120-139': 76.0, '140-159': 72.8, 'old': 73.07, 'new': 72.8}
2024-04-18 22:51:02,524 [trainer.py] => CNN top1 curve: [97.98, 90.75, 87.5, 82.59, 78.45, 75.0, 74.53, 73.03]
2024-04-18 22:51:02,524 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 99.13, 99.16, 98.73, 98.6, 98.31]

Average Accuracy (CNN): 82.47874999999999
2024-04-18 22:51:02,524 [trainer.py] => Average Accuracy (CNN): 82.47874999999999 

2024-04-18 22:51:02,524 [trainer.py] => Train Time: 4343.66
2024-04-18 22:51:02,524 [trainer.py] => Test Time: 73.46 

2024-04-18 22:51:02,525 [trainer.py] => All params: 172158352
2024-04-18 22:51:02,527 [trainer.py] => Trainable params: 407240
2024-04-18 22:51:02,527 [dualprompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.158, Train_accy 68.27:   0%|          | 0/20 [00:14<?, ?it/s]
Task 8, Epoch 1/20 => Loss 1.158, Train_accy 68.27:   5%|▌         | 1/20 [00:14<04:28, 14.15s/it]
Task 8, Epoch 2/20 => Loss 0.303, Train_accy 91.02:   5%|▌         | 1/20 [00:28<04:28, 14.15s/it]
Task 8, Epoch 2/20 => Loss 0.303, Train_accy 91.02:  10%|█         | 2/20 [00:28<04:17, 14.30s/it]
Task 8, Epoch 3/20 => Loss 0.239, Train_accy 92.69:  10%|█         | 2/20 [00:41<04:17, 14.30s/it]
Task 8, Epoch 3/20 => Loss 0.239, Train_accy 92.69:  15%|█▌        | 3/20 [00:41<03:54, 13.81s/it]
Task 8, Epoch 4/20 => Loss 0.215, Train_accy 92.80:  15%|█▌        | 3/20 [00:54<03:54, 13.81s/it]
Task 8, Epoch 4/20 => Loss 0.215, Train_accy 92.80:  20%|██        | 4/20 [00:54<03:36, 13.53s/it]
Task 8, Epoch 5/20 => Loss 0.165, Train_accy 95.51, Test_accy 71.33:  20%|██        | 4/20 [01:25<03:36, 13.53s/it]
Task 8, Epoch 5/20 => Loss 0.165, Train_accy 95.51, Test_accy 71.33:  25%|██▌       | 5/20 [01:25<04:56, 19.78s/it]
Task 8, Epoch 6/20 => Loss 0.162, Train_accy 94.78:  25%|██▌       | 5/20 [01:38<04:56, 19.78s/it]                 
Task 8, Epoch 6/20 => Loss 0.162, Train_accy 94.78:  30%|███       | 6/20 [01:38<04:04, 17.48s/it]
Task 8, Epoch 7/20 => Loss 0.176, Train_accy 94.78:  30%|███       | 6/20 [01:51<04:04, 17.48s/it]
Task 8, Epoch 7/20 => Loss 0.176, Train_accy 94.78:  35%|███▌      | 7/20 [01:51<03:28, 16.04s/it]
Task 8, Epoch 8/20 => Loss 0.195, Train_accy 93.95:  35%|███▌      | 7/20 [02:05<03:28, 16.04s/it]
Task 8, Epoch 8/20 => Loss 0.195, Train_accy 93.95:  40%|████      | 8/20 [02:05<03:02, 15.18s/it]
Task 8, Epoch 9/20 => Loss 0.149, Train_accy 94.36:  40%|████      | 8/20 [02:17<03:02, 15.18s/it]
Task 8, Epoch 9/20 => Loss 0.149, Train_accy 94.36:  45%|████▌     | 9/20 [02:17<02:37, 14.36s/it]
Task 8, Epoch 10/20 => Loss 0.130, Train_accy 95.20, Test_accy 71.80:  45%|████▌     | 9/20 [02:49<02:37, 14.36s/it]
Task 8, Epoch 10/20 => Loss 0.130, Train_accy 95.20, Test_accy 71.80:  50%|█████     | 10/20 [02:49<03:16, 19.61s/it]
Task 8, Epoch 11/20 => Loss 0.185, Train_accy 94.26:  50%|█████     | 10/20 [03:02<03:16, 19.61s/it]                 
Task 8, Epoch 11/20 => Loss 0.185, Train_accy 94.26:  55%|█████▌    | 11/20 [03:02<02:40, 17.84s/it]
Task 8, Epoch 12/20 => Loss 0.141, Train_accy 95.30:  55%|█████▌    | 11/20 [03:15<02:40, 17.84s/it]
Task 8, Epoch 12/20 => Loss 0.141, Train_accy 95.30:  60%|██████    | 12/20 [03:15<02:10, 16.30s/it]
Task 8, Epoch 13/20 => Loss 0.125, Train_accy 95.41:  60%|██████    | 12/20 [03:29<02:10, 16.30s/it]
Task 8, Epoch 13/20 => Loss 0.125, Train_accy 95.41:  65%|██████▌   | 13/20 [03:29<01:49, 15.66s/it]
Task 8, Epoch 14/20 => Loss 0.123, Train_accy 96.24:  65%|██████▌   | 13/20 [03:43<01:49, 15.66s/it]
Task 8, Epoch 14/20 => Loss 0.123, Train_accy 96.24:  70%|███████   | 14/20 [03:43<01:29, 14.98s/it]
Task 8, Epoch 15/20 => Loss 0.139, Train_accy 95.82, Test_accy 71.33:  70%|███████   | 14/20 [04:14<01:29, 14.98s/it]
Task 8, Epoch 15/20 => Loss 0.139, Train_accy 95.82, Test_accy 71.33:  75%|███████▌  | 15/20 [04:14<01:39, 19.84s/it]
Task 8, Epoch 16/20 => Loss 0.178, Train_accy 95.09:  75%|███████▌  | 15/20 [04:29<01:39, 19.84s/it]                 
Task 8, Epoch 16/20 => Loss 0.178, Train_accy 95.09:  80%|████████  | 16/20 [04:29<01:13, 18.30s/it]
Task 8, Epoch 17/20 => Loss 0.115, Train_accy 95.82:  80%|████████  | 16/20 [04:42<01:13, 18.30s/it]
Task 8, Epoch 17/20 => Loss 0.115, Train_accy 95.82:  85%|████████▌ | 17/20 [04:42<00:50, 16.79s/it]
Task 8, Epoch 18/20 => Loss 0.125, Train_accy 95.41:  85%|████████▌ | 17/20 [04:54<00:50, 16.79s/it]
Task 8, Epoch 18/20 => Loss 0.125, Train_accy 95.41:  90%|█████████ | 18/20 [04:54<00:30, 15.40s/it]
Task 8, Epoch 19/20 => Loss 0.116, Train_accy 96.35:  90%|█████████ | 18/20 [05:07<00:30, 15.40s/it]
Task 8, Epoch 19/20 => Loss 0.116, Train_accy 96.35:  95%|█████████▌| 19/20 [05:07<00:14, 14.74s/it]
Task 8, Epoch 20/20 => Loss 0.146, Train_accy 94.78, Test_accy 71.90:  95%|█████████▌| 19/20 [05:39<00:14, 14.74s/it]
Task 8, Epoch 20/20 => Loss 0.146, Train_accy 94.78, Test_accy 71.90: 100%|██████████| 20/20 [05:39<00:00, 19.79s/it]
Task 8, Epoch 20/20 => Loss 0.146, Train_accy 94.78, Test_accy 71.90: 100%|██████████| 20/20 [05:39<00:00, 16.97s/it]
2024-04-18 22:56:41,849 [dualprompt.py] => Task 8, Epoch 20/20 => Loss 0.146, Train_accy 94.78, Test_accy 71.90
2024-04-18 22:57:00,665 [trainer.py] => No NME accuracy.
2024-04-18 22:57:00,666 [trainer.py] => CNN: {'total': 71.9, '00-19': 60.73, '20-39': 71.01, '40-59': 77.06, '60-79': 72.47, '80-99': 69.14, '100-119': 76.75, '120-139': 71.56, '140-159': 72.4, '160-179': 77.22, 'old': 71.23, 'new': 77.22}
2024-04-18 22:57:00,666 [trainer.py] => CNN top1 curve: [97.98, 90.75, 87.5, 82.59, 78.45, 75.0, 74.53, 73.03, 71.9]
2024-04-18 22:57:00,666 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 99.13, 99.16, 98.73, 98.6, 98.31, 97.56]

Average Accuracy (CNN): 81.30333333333333
2024-04-18 22:57:00,666 [trainer.py] => Average Accuracy (CNN): 81.30333333333333 

2024-04-18 22:57:00,666 [trainer.py] => Train Time: 5022.29
2024-04-18 22:57:00,666 [trainer.py] => Test Time: 92.27 

2024-04-18 22:57:00,667 [trainer.py] => All params: 172158352
2024-04-18 22:57:00,669 [trainer.py] => Trainable params: 407240
2024-04-18 22:57:00,669 [dualprompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.181, Train_accy 68.59:   0%|          | 0/20 [00:12<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.181, Train_accy 68.59:   5%|▌         | 1/20 [00:12<04:01, 12.73s/it]
Task 9, Epoch 2/20 => Loss 0.266, Train_accy 92.12:   5%|▌         | 1/20 [00:24<04:01, 12.73s/it]
Task 9, Epoch 2/20 => Loss 0.266, Train_accy 92.12:  10%|█         | 2/20 [00:24<03:37, 12.09s/it]
Task 9, Epoch 3/20 => Loss 0.263, Train_accy 91.70:  10%|█         | 2/20 [00:37<03:37, 12.09s/it]
Task 9, Epoch 3/20 => Loss 0.263, Train_accy 91.70:  15%|█▌        | 3/20 [00:37<03:30, 12.40s/it]
Task 9, Epoch 4/20 => Loss 0.209, Train_accy 94.01:  15%|█▌        | 3/20 [00:49<03:30, 12.40s/it]
Task 9, Epoch 4/20 => Loss 0.209, Train_accy 94.01:  20%|██        | 4/20 [00:49<03:16, 12.31s/it]
Task 9, Epoch 5/20 => Loss 0.187, Train_accy 93.59, Test_accy 69.30:  20%|██        | 4/20 [01:22<03:16, 12.31s/it]
Task 9, Epoch 5/20 => Loss 0.187, Train_accy 93.59, Test_accy 69.30:  25%|██▌       | 5/20 [01:22<04:55, 19.69s/it]
Task 9, Epoch 6/20 => Loss 0.184, Train_accy 94.01:  25%|██▌       | 5/20 [01:35<04:55, 19.69s/it]                 
Task 9, Epoch 6/20 => Loss 0.184, Train_accy 94.01:  30%|███       | 6/20 [01:35<04:06, 17.63s/it]
Task 9, Epoch 7/20 => Loss 0.148, Train_accy 95.59:  30%|███       | 6/20 [01:47<04:06, 17.63s/it]
Task 9, Epoch 7/20 => Loss 0.148, Train_accy 95.59:  35%|███▌      | 7/20 [01:47<03:26, 15.85s/it]
Task 9, Epoch 8/20 => Loss 0.190, Train_accy 94.12:  35%|███▌      | 7/20 [02:00<03:26, 15.85s/it]
Task 9, Epoch 8/20 => Loss 0.190, Train_accy 94.12:  40%|████      | 8/20 [02:00<02:58, 14.86s/it]
Task 9, Epoch 9/20 => Loss 0.169, Train_accy 94.64:  40%|████      | 8/20 [02:13<02:58, 14.86s/it]
Task 9, Epoch 9/20 => Loss 0.169, Train_accy 94.64:  45%|████▌     | 9/20 [02:13<02:36, 14.22s/it]
Task 9, Epoch 10/20 => Loss 0.166, Train_accy 94.96, Test_accy 69.68:  45%|████▌     | 9/20 [02:48<02:36, 14.22s/it]
Task 9, Epoch 10/20 => Loss 0.166, Train_accy 94.96, Test_accy 69.68:  50%|█████     | 10/20 [02:48<03:26, 20.70s/it]
Task 9, Epoch 11/20 => Loss 0.172, Train_accy 94.33:  50%|█████     | 10/20 [03:03<03:26, 20.70s/it]                 
Task 9, Epoch 11/20 => Loss 0.172, Train_accy 94.33:  55%|█████▌    | 11/20 [03:03<02:48, 18.77s/it]
Task 9, Epoch 12/20 => Loss 0.133, Train_accy 95.38:  55%|█████▌    | 11/20 [03:15<02:48, 18.77s/it]
Task 9, Epoch 12/20 => Loss 0.133, Train_accy 95.38:  60%|██████    | 12/20 [03:15<02:15, 16.91s/it]
Task 9, Epoch 13/20 => Loss 0.125, Train_accy 95.38:  60%|██████    | 12/20 [03:28<02:15, 16.91s/it]
Task 9, Epoch 13/20 => Loss 0.125, Train_accy 95.38:  65%|██████▌   | 13/20 [03:28<01:50, 15.72s/it]
Task 9, Epoch 14/20 => Loss 0.167, Train_accy 94.12:  65%|██████▌   | 13/20 [03:40<01:50, 15.72s/it]
Task 9, Epoch 14/20 => Loss 0.167, Train_accy 94.12:  70%|███████   | 14/20 [03:40<01:27, 14.55s/it]
Task 9, Epoch 15/20 => Loss 0.123, Train_accy 95.48, Test_accy 70.70:  70%|███████   | 14/20 [04:12<01:27, 14.55s/it]
Task 9, Epoch 15/20 => Loss 0.123, Train_accy 95.48, Test_accy 70.70:  75%|███████▌  | 15/20 [04:12<01:39, 19.87s/it]
Task 9, Epoch 16/20 => Loss 0.129, Train_accy 94.75:  75%|███████▌  | 15/20 [04:26<01:39, 19.87s/it]                 
Task 9, Epoch 16/20 => Loss 0.129, Train_accy 94.75:  80%|████████  | 16/20 [04:26<01:12, 18.16s/it]
Task 9, Epoch 17/20 => Loss 0.172, Train_accy 94.85:  80%|████████  | 16/20 [04:39<01:12, 18.16s/it]
Task 9, Epoch 17/20 => Loss 0.172, Train_accy 94.85:  85%|████████▌ | 17/20 [04:39<00:49, 16.48s/it]
Task 9, Epoch 18/20 => Loss 0.132, Train_accy 95.38:  85%|████████▌ | 17/20 [04:51<00:49, 16.48s/it]
Task 9, Epoch 18/20 => Loss 0.132, Train_accy 95.38:  90%|█████████ | 18/20 [04:51<00:30, 15.26s/it]
Task 9, Epoch 19/20 => Loss 0.097, Train_accy 96.32:  90%|█████████ | 18/20 [05:04<00:30, 15.26s/it]
Task 9, Epoch 19/20 => Loss 0.097, Train_accy 96.32:  95%|█████████▌| 19/20 [05:04<00:14, 14.41s/it]
Task 9, Epoch 20/20 => Loss 0.114, Train_accy 95.90, Test_accy 70.02:  95%|█████████▌| 19/20 [05:36<00:14, 14.41s/it]
Task 9, Epoch 20/20 => Loss 0.114, Train_accy 95.90, Test_accy 70.02: 100%|██████████| 20/20 [05:36<00:00, 19.74s/it]
Task 9, Epoch 20/20 => Loss 0.114, Train_accy 95.90, Test_accy 70.02: 100%|██████████| 20/20 [05:36<00:00, 16.83s/it]
2024-04-18 23:02:37,195 [dualprompt.py] => Task 9, Epoch 20/20 => Loss 0.114, Train_accy 95.90, Test_accy 70.02
2024-04-18 23:02:58,013 [trainer.py] => No NME accuracy.
2024-04-18 23:02:58,013 [trainer.py] => CNN: {'total': 70.02, '00-19': 59.92, '20-39': 64.25, '40-59': 77.06, '60-79': 68.42, '80-99': 66.17, '100-119': 76.32, '120-139': 69.78, '140-159': 71.6, '160-179': 75.53, '180-199': 72.17, 'old': 69.78, 'new': 72.17}
2024-04-18 23:02:58,013 [trainer.py] => CNN top1 curve: [97.98, 90.75, 87.5, 82.59, 78.45, 75.0, 74.53, 73.03, 71.9, 70.02]
2024-04-18 23:02:58,013 [trainer.py] => CNN top5 curve: [100.0, 99.34, 98.81, 99.13, 99.16, 98.73, 98.6, 98.31, 97.56, 97.2]

Average Accuracy (CNN): 80.17499999999998
2024-04-18 23:02:58,013 [trainer.py] => Average Accuracy (CNN): 80.17499999999998 

2024-04-18 23:02:58,013 [trainer.py] => Train Time: 5695.32
2024-04-18 23:02:58,013 [trainer.py] => Test Time: 113.09 

Accuracy Matrix (CNN):
[[97.98 95.14 88.66 74.9  66.4  63.97 61.94 61.54 60.73 59.92]
 [ 0.   85.51 83.09 80.68 81.16 76.33 77.29 72.46 71.01 64.25]
 [ 0.    0.   90.37 88.07 86.24 82.57 80.73 79.82 77.06 77.06]
 [ 0.    0.    0.   87.04 85.43 79.76 79.76 78.14 72.47 68.42]
 [ 0.    0.    0.    0.   74.72 71.75 70.26 69.52 69.14 66.17]
 [ 0.    0.    0.    0.    0.   77.19 76.75 75.44 76.75 76.32]
 [ 0.    0.    0.    0.    0.    0.   76.89 76.   71.56 69.78]
 [ 0.    0.    0.    0.    0.    0.    0.   72.8  72.4  71.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   77.22 75.53]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   72.17]]
2024-04-18 23:02:58,015 [trainer.py] => Forgetting (CNN): 12.296666666666669
2024-04-18 23:03:03,326 [trainer.py] => config: ./exps/coda_prompt_cub_B0.json
2024-04-18 23:03:03,326 [trainer.py] => prefix:  
2024-04-18 23:03:03,326 [trainer.py] => dataset: cub
2024-04-18 23:03:03,326 [trainer.py] => memory_size: 0
2024-04-18 23:03:03,326 [trainer.py] => memory_per_class: 0
2024-04-18 23:03:03,326 [trainer.py] => fixed_memory: False
2024-04-18 23:03:03,326 [trainer.py] => shuffle: False
2024-04-18 23:03:03,326 [trainer.py] => init_cls: 20
2024-04-18 23:03:03,326 [trainer.py] => increment: 20
2024-04-18 23:03:03,326 [trainer.py] => model_name: coda_prompt
2024-04-18 23:03:03,326 [trainer.py] => backbone_type: vit_base_patch16_224_coda_prompt
2024-04-18 23:03:03,326 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-18 23:03:03,327 [trainer.py] => seed: 1993
2024-04-18 23:03:03,327 [trainer.py] => tuned_epoch: 20
2024-04-18 23:03:03,327 [trainer.py] => init_lr: 0.001
2024-04-18 23:03:03,327 [trainer.py] => batch_size: 48
2024-04-18 23:03:03,327 [trainer.py] => weight_decay: 0
2024-04-18 23:03:03,327 [trainer.py] => min_lr: 1e-05
2024-04-18 23:03:03,327 [trainer.py] => optimizer: adam
2024-04-18 23:03:03,327 [trainer.py] => scheduler: cosine
2024-04-18 23:03:03,327 [trainer.py] => reinit_optimizer: True
2024-04-18 23:03:03,327 [trainer.py] => pretrained: True
2024-04-18 23:03:03,327 [trainer.py] => drop: 0.0
2024-04-18 23:03:03,327 [trainer.py] => drop_path: 0.0
2024-04-18 23:03:03,327 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-04-18 23:03:03,382 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2024-04-18 23:03:07,931 [coda_prompt.py] => 89,792,456 total parameters.
2024-04-18 23:03:07,931 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-04-18 23:03:07,932 [trainer.py] => All params: 89792456
2024-04-18 23:03:07,932 [trainer.py] => Trainable params: 89792456
2024-04-18 23:03:07,932 [coda_prompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.434, Train_accy 56.83:   0%|          | 0/20 [00:15<?, ?it/s]
Task 0, Epoch 1/20 => Loss 1.434, Train_accy 56.83:   5%|▌         | 1/20 [00:15<04:57, 15.64s/it]
Task 0, Epoch 2/20 => Loss 0.437, Train_accy 86.46:   5%|▌         | 1/20 [00:29<04:57, 15.64s/it]
Task 0, Epoch 2/20 => Loss 0.437, Train_accy 86.46:  10%|█         | 2/20 [00:29<04:22, 14.57s/it]
Task 0, Epoch 3/20 => Loss 0.345, Train_accy 88.66:  10%|█         | 2/20 [00:40<04:22, 14.57s/it]
Task 0, Epoch 3/20 => Loss 0.345, Train_accy 88.66:  15%|█▌        | 3/20 [00:40<03:37, 12.78s/it]
Task 0, Epoch 4/20 => Loss 0.347, Train_accy 89.24:  15%|█▌        | 3/20 [00:51<03:37, 12.78s/it]
Task 0, Epoch 4/20 => Loss 0.347, Train_accy 89.24:  20%|██        | 4/20 [00:51<03:12, 12.05s/it]
Task 0, Epoch 5/20 => Loss 0.273, Train_accy 90.97, Test_accy 95.67:  20%|██        | 4/20 [01:03<03:12, 12.05s/it]
Task 0, Epoch 5/20 => Loss 0.273, Train_accy 90.97, Test_accy 95.67:  25%|██▌       | 5/20 [01:03<03:04, 12.32s/it]
Task 0, Epoch 6/20 => Loss 0.254, Train_accy 92.48:  25%|██▌       | 5/20 [01:14<03:04, 12.32s/it]                 
Task 0, Epoch 6/20 => Loss 0.254, Train_accy 92.48:  30%|███       | 6/20 [01:14<02:45, 11.85s/it]
Task 0, Epoch 7/20 => Loss 0.280, Train_accy 92.01:  30%|███       | 6/20 [01:25<02:45, 11.85s/it]
Task 0, Epoch 7/20 => Loss 0.280, Train_accy 92.01:  35%|███▌      | 7/20 [01:25<02:30, 11.54s/it]
Task 0, Epoch 8/20 => Loss 0.203, Train_accy 92.36:  35%|███▌      | 7/20 [01:36<02:30, 11.54s/it]
Task 0, Epoch 8/20 => Loss 0.203, Train_accy 92.36:  40%|████      | 8/20 [01:36<02:16, 11.34s/it]
Task 0, Epoch 9/20 => Loss 0.230, Train_accy 93.17:  40%|████      | 8/20 [01:47<02:16, 11.34s/it]
Task 0, Epoch 9/20 => Loss 0.230, Train_accy 93.17:  45%|████▌     | 9/20 [01:47<02:03, 11.18s/it]
Task 0, Epoch 10/20 => Loss 0.171, Train_accy 95.60, Test_accy 96.10:  45%|████▌     | 9/20 [02:00<02:03, 11.18s/it]
Task 0, Epoch 10/20 => Loss 0.171, Train_accy 95.60, Test_accy 96.10:  50%|█████     | 10/20 [02:00<01:56, 11.61s/it]
Task 0, Epoch 11/20 => Loss 0.211, Train_accy 93.52:  50%|█████     | 10/20 [02:10<01:56, 11.61s/it]                 
Task 0, Epoch 11/20 => Loss 0.211, Train_accy 93.52:  55%|█████▌    | 11/20 [02:10<01:42, 11.42s/it]
Task 0, Epoch 12/20 => Loss 0.168, Train_accy 94.56:  55%|█████▌    | 11/20 [02:21<01:42, 11.42s/it]
Task 0, Epoch 12/20 => Loss 0.168, Train_accy 94.56:  60%|██████    | 12/20 [02:21<01:29, 11.20s/it]
Task 0, Epoch 13/20 => Loss 0.201, Train_accy 94.33:  60%|██████    | 12/20 [02:32<01:29, 11.20s/it]
Task 0, Epoch 13/20 => Loss 0.201, Train_accy 94.33:  65%|██████▌   | 13/20 [02:32<01:17, 11.10s/it]
Task 0, Epoch 14/20 => Loss 0.184, Train_accy 94.21:  65%|██████▌   | 13/20 [02:43<01:17, 11.10s/it]
Task 0, Epoch 14/20 => Loss 0.184, Train_accy 94.21:  70%|███████   | 14/20 [02:43<01:06, 11.07s/it]
Task 0, Epoch 15/20 => Loss 0.199, Train_accy 93.87, Test_accy 97.84:  70%|███████   | 14/20 [02:56<01:06, 11.07s/it]
Task 0, Epoch 15/20 => Loss 0.199, Train_accy 93.87, Test_accy 97.84:  75%|███████▌  | 15/20 [02:56<00:57, 11.50s/it]
Task 0, Epoch 16/20 => Loss 0.195, Train_accy 94.21:  75%|███████▌  | 15/20 [03:06<00:57, 11.50s/it]                 
Task 0, Epoch 16/20 => Loss 0.195, Train_accy 94.21:  80%|████████  | 16/20 [03:06<00:45, 11.28s/it]
Task 0, Epoch 17/20 => Loss 0.179, Train_accy 95.02:  80%|████████  | 16/20 [03:17<00:45, 11.28s/it]
Task 0, Epoch 17/20 => Loss 0.179, Train_accy 95.02:  85%|████████▌ | 17/20 [03:17<00:33, 11.17s/it]
Task 0, Epoch 18/20 => Loss 0.184, Train_accy 94.21:  85%|████████▌ | 17/20 [03:28<00:33, 11.17s/it]
Task 0, Epoch 18/20 => Loss 0.184, Train_accy 94.21:  90%|█████████ | 18/20 [03:28<00:22, 11.09s/it]
Task 0, Epoch 19/20 => Loss 0.159, Train_accy 95.02:  90%|█████████ | 18/20 [03:39<00:22, 11.09s/it]
Task 0, Epoch 19/20 => Loss 0.159, Train_accy 95.02:  95%|█████████▌| 19/20 [03:39<00:10, 10.97s/it]
Task 0, Epoch 20/20 => Loss 0.158, Train_accy 94.91, Test_accy 97.40:  95%|█████████▌| 19/20 [03:52<00:10, 10.97s/it]
Task 0, Epoch 20/20 => Loss 0.158, Train_accy 94.91, Test_accy 97.40: 100%|██████████| 20/20 [03:52<00:00, 11.53s/it]
Task 0, Epoch 20/20 => Loss 0.158, Train_accy 94.91, Test_accy 97.40: 100%|██████████| 20/20 [03:52<00:00, 11.61s/it]
2024-04-18 23:07:01,082 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.158, Train_accy 94.91, Test_accy 97.40
2024-04-18 23:07:03,121 [trainer.py] => No NME accuracy.
2024-04-18 23:07:03,122 [trainer.py] => CNN: {'total': 97.4, '00-19': 97.4, 'old': 0, 'new': 97.4}
2024-04-18 23:07:03,122 [trainer.py] => CNN top1 curve: [97.4]
2024-04-18 23:07:03,122 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.4
2024-04-18 23:07:03,122 [trainer.py] => Average Accuracy (CNN): 97.4 

2024-04-18 23:07:03,122 [trainer.py] => Train Time: 465.28999999999996
2024-04-18 23:07:03,122 [trainer.py] => Test Time: 2.04 

2024-04-18 23:07:03,124 [trainer.py] => All params: 89792456
2024-04-18 23:07:03,125 [trainer.py] => Trainable params: 89792456
2024-04-18 23:07:03,788 [coda_prompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.617, Train_accy 49.78:   0%|          | 0/20 [00:11<?, ?it/s]
Task 1, Epoch 1/20 => Loss 1.617, Train_accy 49.78:   5%|▌         | 1/20 [00:11<03:33, 11.22s/it]
Task 1, Epoch 2/20 => Loss 0.593, Train_accy 77.74:   5%|▌         | 1/20 [00:22<03:33, 11.22s/it]
Task 1, Epoch 2/20 => Loss 0.593, Train_accy 77.74:  10%|█         | 2/20 [00:22<03:24, 11.39s/it]
Task 1, Epoch 3/20 => Loss 0.468, Train_accy 82.68:  10%|█         | 2/20 [00:34<03:24, 11.39s/it]
Task 1, Epoch 3/20 => Loss 0.468, Train_accy 82.68:  15%|█▌        | 3/20 [00:34<03:14, 11.46s/it]
Task 1, Epoch 4/20 => Loss 0.405, Train_accy 86.18:  15%|█▌        | 3/20 [00:45<03:14, 11.46s/it]
Task 1, Epoch 4/20 => Loss 0.405, Train_accy 86.18:  20%|██        | 4/20 [00:45<03:03, 11.50s/it]
Task 1, Epoch 5/20 => Loss 0.394, Train_accy 87.17, Test_accy 88.49:  20%|██        | 4/20 [01:00<03:03, 11.50s/it]
Task 1, Epoch 5/20 => Loss 0.394, Train_accy 87.17, Test_accy 88.49:  25%|██▌       | 5/20 [01:00<03:10, 12.71s/it]
Task 1, Epoch 6/20 => Loss 0.325, Train_accy 88.71:  25%|██▌       | 5/20 [01:12<03:10, 12.71s/it]                 
Task 1, Epoch 6/20 => Loss 0.325, Train_accy 88.71:  30%|███       | 6/20 [01:12<02:52, 12.33s/it]
Task 1, Epoch 7/20 => Loss 0.282, Train_accy 90.24:  30%|███       | 6/20 [01:26<02:52, 12.33s/it]
Task 1, Epoch 7/20 => Loss 0.282, Train_accy 90.24:  35%|███▌      | 7/20 [01:26<02:47, 12.89s/it]
Task 1, Epoch 8/20 => Loss 0.269, Train_accy 91.78:  35%|███▌      | 7/20 [01:43<02:47, 12.89s/it]
Task 1, Epoch 8/20 => Loss 0.269, Train_accy 91.78:  40%|████      | 8/20 [01:43<02:49, 14.16s/it]
Task 1, Epoch 9/20 => Loss 0.259, Train_accy 90.46:  40%|████      | 8/20 [01:59<02:49, 14.16s/it]
Task 1, Epoch 9/20 => Loss 0.259, Train_accy 90.46:  45%|████▌     | 9/20 [01:59<02:41, 14.71s/it]
Task 1, Epoch 10/20 => Loss 0.231, Train_accy 92.43, Test_accy 89.55:  45%|████▌     | 9/20 [02:19<02:41, 14.71s/it]
Task 1, Epoch 10/20 => Loss 0.231, Train_accy 92.43, Test_accy 89.55:  50%|█████     | 10/20 [02:19<02:45, 16.57s/it]
Task 1, Epoch 11/20 => Loss 0.226, Train_accy 93.31:  50%|█████     | 10/20 [02:35<02:45, 16.57s/it]                 
Task 1, Epoch 11/20 => Loss 0.226, Train_accy 93.31:  55%|█████▌    | 11/20 [02:35<02:27, 16.40s/it]
Task 1, Epoch 12/20 => Loss 0.251, Train_accy 91.34:  55%|█████▌    | 11/20 [02:51<02:27, 16.40s/it]
Task 1, Epoch 12/20 => Loss 0.251, Train_accy 91.34:  60%|██████    | 12/20 [02:51<02:08, 16.03s/it]
Task 1, Epoch 13/20 => Loss 0.263, Train_accy 91.45:  60%|██████    | 12/20 [03:05<02:08, 16.03s/it]
Task 1, Epoch 13/20 => Loss 0.263, Train_accy 91.45:  65%|██████▌   | 13/20 [03:05<01:49, 15.65s/it]
Task 1, Epoch 14/20 => Loss 0.225, Train_accy 92.87:  65%|██████▌   | 13/20 [03:21<01:49, 15.65s/it]
Task 1, Epoch 14/20 => Loss 0.225, Train_accy 92.87:  70%|███████   | 14/20 [03:21<01:34, 15.71s/it]
Task 1, Epoch 15/20 => Loss 0.195, Train_accy 93.64, Test_accy 90.62:  70%|███████   | 14/20 [03:42<01:34, 15.71s/it]
Task 1, Epoch 15/20 => Loss 0.195, Train_accy 93.64, Test_accy 90.62:  75%|███████▌  | 15/20 [03:42<01:26, 17.30s/it]
Task 1, Epoch 16/20 => Loss 0.237, Train_accy 92.21:  75%|███████▌  | 15/20 [03:59<01:26, 17.30s/it]                 
Task 1, Epoch 16/20 => Loss 0.237, Train_accy 92.21:  80%|████████  | 16/20 [03:59<01:08, 17.17s/it]
Task 1, Epoch 17/20 => Loss 0.188, Train_accy 94.08:  80%|████████  | 16/20 [04:14<01:08, 17.17s/it]
Task 1, Epoch 17/20 => Loss 0.188, Train_accy 94.08:  85%|████████▌ | 17/20 [04:14<00:49, 16.52s/it]
Task 1, Epoch 18/20 => Loss 0.194, Train_accy 94.19:  85%|████████▌ | 17/20 [04:30<00:49, 16.52s/it]
Task 1, Epoch 18/20 => Loss 0.194, Train_accy 94.19:  90%|█████████ | 18/20 [04:30<00:32, 16.21s/it]
Task 1, Epoch 19/20 => Loss 0.202, Train_accy 92.98:  90%|█████████ | 18/20 [04:45<00:32, 16.21s/it]
Task 1, Epoch 19/20 => Loss 0.202, Train_accy 92.98:  95%|█████████▌| 19/20 [04:45<00:15, 16.00s/it]
Task 1, Epoch 20/20 => Loss 0.201, Train_accy 93.31, Test_accy 90.83:  95%|█████████▌| 19/20 [05:06<00:15, 16.00s/it]
Task 1, Epoch 20/20 => Loss 0.201, Train_accy 93.31, Test_accy 90.83: 100%|██████████| 20/20 [05:06<00:00, 17.48s/it]
Task 1, Epoch 20/20 => Loss 0.201, Train_accy 93.31, Test_accy 90.83: 100%|██████████| 20/20 [05:06<00:00, 15.32s/it]
2024-04-18 23:12:10,251 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.201, Train_accy 93.31, Test_accy 90.83
2024-04-18 23:12:14,086 [trainer.py] => No NME accuracy.
2024-04-18 23:12:14,087 [trainer.py] => CNN: {'total': 90.83, '00-19': 96.1, '20-39': 85.71, 'old': 96.1, 'new': 85.71}
2024-04-18 23:12:14,087 [trainer.py] => CNN top1 curve: [97.4, 90.83]
2024-04-18 23:12:14,087 [trainer.py] => CNN top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 94.11500000000001
2024-04-18 23:12:14,087 [trainer.py] => Average Accuracy (CNN): 94.11500000000001 

2024-04-18 23:12:14,087 [trainer.py] => Train Time: 1078.21
2024-04-18 23:12:14,087 [trainer.py] => Test Time: 5.87 

2024-04-18 23:12:14,088 [trainer.py] => All params: 89792456
2024-04-18 23:12:14,088 [trainer.py] => Trainable params: 89792456
2024-04-18 23:12:18,691 [coda_prompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.270, Train_accy 65.83:   0%|          | 0/20 [00:17<?, ?it/s]
Task 2, Epoch 1/20 => Loss 1.270, Train_accy 65.83:   5%|▌         | 1/20 [00:17<05:31, 17.46s/it]
Task 2, Epoch 2/20 => Loss 0.341, Train_accy 88.54:   5%|▌         | 1/20 [00:33<05:31, 17.46s/it]
Task 2, Epoch 2/20 => Loss 0.341, Train_accy 88.54:  10%|█         | 2/20 [00:33<05:01, 16.77s/it]
Task 2, Epoch 3/20 => Loss 0.262, Train_accy 90.83:  10%|█         | 2/20 [00:49<05:01, 16.77s/it]
Task 2, Epoch 3/20 => Loss 0.262, Train_accy 90.83:  15%|█▌        | 3/20 [00:49<04:40, 16.48s/it]
Task 2, Epoch 4/20 => Loss 0.220, Train_accy 92.19:  15%|█▌        | 3/20 [01:05<04:40, 16.48s/it]
Task 2, Epoch 4/20 => Loss 0.220, Train_accy 92.19:  20%|██        | 4/20 [01:05<04:15, 16.00s/it]
Task 2, Epoch 5/20 => Loss 0.228, Train_accy 92.08, Test_accy 82.95:  20%|██        | 4/20 [01:27<04:15, 16.00s/it]
Task 2, Epoch 5/20 => Loss 0.228, Train_accy 92.08, Test_accy 82.95:  25%|██▌       | 5/20 [01:27<04:36, 18.45s/it]
Task 2, Epoch 6/20 => Loss 0.248, Train_accy 91.98:  25%|██▌       | 5/20 [01:44<04:36, 18.45s/it]                 
Task 2, Epoch 6/20 => Loss 0.248, Train_accy 91.98:  30%|███       | 6/20 [01:44<04:09, 17.80s/it]
Task 2, Epoch 7/20 => Loss 0.226, Train_accy 92.81:  30%|███       | 6/20 [02:00<04:09, 17.80s/it]
Task 2, Epoch 7/20 => Loss 0.226, Train_accy 92.81:  35%|███▌      | 7/20 [02:00<03:45, 17.36s/it]
Task 2, Epoch 8/20 => Loss 0.209, Train_accy 94.06:  35%|███▌      | 7/20 [02:17<03:45, 17.36s/it]
Task 2, Epoch 8/20 => Loss 0.209, Train_accy 94.06:  40%|████      | 8/20 [02:17<03:25, 17.16s/it]
Task 2, Epoch 9/20 => Loss 0.144, Train_accy 95.00:  40%|████      | 8/20 [02:33<03:25, 17.16s/it]
Task 2, Epoch 9/20 => Loss 0.144, Train_accy 95.00:  45%|████▌     | 9/20 [02:33<03:05, 16.83s/it]
Task 2, Epoch 10/20 => Loss 0.174, Train_accy 94.48, Test_accy 82.53:  45%|████▌     | 9/20 [02:56<03:05, 16.83s/it]
Task 2, Epoch 10/20 => Loss 0.174, Train_accy 94.48, Test_accy 82.53:  50%|█████     | 10/20 [02:56<03:06, 18.69s/it]
Task 2, Epoch 11/20 => Loss 0.162, Train_accy 95.31:  50%|█████     | 10/20 [03:13<03:06, 18.69s/it]                 
Task 2, Epoch 11/20 => Loss 0.162, Train_accy 95.31:  55%|█████▌    | 11/20 [03:13<02:43, 18.19s/it]
Task 2, Epoch 12/20 => Loss 0.170, Train_accy 94.27:  55%|█████▌    | 11/20 [03:28<02:43, 18.19s/it]
Task 2, Epoch 12/20 => Loss 0.170, Train_accy 94.27:  60%|██████    | 12/20 [03:28<02:18, 17.25s/it]
Task 2, Epoch 13/20 => Loss 0.159, Train_accy 94.58:  60%|██████    | 12/20 [03:44<02:18, 17.25s/it]
Task 2, Epoch 13/20 => Loss 0.159, Train_accy 94.58:  65%|██████▌   | 13/20 [03:44<01:58, 16.91s/it]
Task 2, Epoch 14/20 => Loss 0.133, Train_accy 95.52:  65%|██████▌   | 13/20 [04:01<01:58, 16.91s/it]
Task 2, Epoch 14/20 => Loss 0.133, Train_accy 95.52:  70%|███████   | 14/20 [04:01<01:40, 16.71s/it]
Task 2, Epoch 15/20 => Loss 0.134, Train_accy 95.42, Test_accy 81.82:  70%|███████   | 14/20 [04:22<01:40, 16.71s/it]
Task 2, Epoch 15/20 => Loss 0.134, Train_accy 95.42, Test_accy 81.82:  75%|███████▌  | 15/20 [04:22<01:30, 18.19s/it]
Task 2, Epoch 16/20 => Loss 0.133, Train_accy 96.15:  75%|███████▌  | 15/20 [04:40<01:30, 18.19s/it]                 
Task 2, Epoch 16/20 => Loss 0.133, Train_accy 96.15:  80%|████████  | 16/20 [04:40<01:11, 17.90s/it]
Task 2, Epoch 17/20 => Loss 0.112, Train_accy 96.67:  80%|████████  | 16/20 [04:57<01:11, 17.90s/it]
Task 2, Epoch 17/20 => Loss 0.112, Train_accy 96.67:  85%|████████▌ | 17/20 [04:57<00:53, 17.72s/it]
Task 2, Epoch 18/20 => Loss 0.143, Train_accy 95.62:  85%|████████▌ | 17/20 [05:14<00:53, 17.72s/it]
Task 2, Epoch 18/20 => Loss 0.143, Train_accy 95.62:  90%|█████████ | 18/20 [05:14<00:35, 17.51s/it]
Task 2, Epoch 19/20 => Loss 0.115, Train_accy 95.83:  90%|█████████ | 18/20 [05:30<00:35, 17.51s/it]
Task 2, Epoch 19/20 => Loss 0.115, Train_accy 95.83:  95%|█████████▌| 19/20 [05:30<00:17, 17.06s/it]
Task 2, Epoch 20/20 => Loss 0.167, Train_accy 94.48, Test_accy 81.68:  95%|█████████▌| 19/20 [05:53<00:17, 17.06s/it]
Task 2, Epoch 20/20 => Loss 0.167, Train_accy 94.48, Test_accy 81.68: 100%|██████████| 20/20 [05:53<00:00, 18.84s/it]
Task 2, Epoch 20/20 => Loss 0.167, Train_accy 94.48, Test_accy 81.68: 100%|██████████| 20/20 [05:53<00:00, 17.67s/it]
2024-04-18 23:18:12,042 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.167, Train_accy 94.48, Test_accy 81.68
2024-04-18 23:18:18,407 [trainer.py] => No NME accuracy.
2024-04-18 23:18:18,407 [trainer.py] => CNN: {'total': 81.68, '00-19': 81.82, '20-39': 68.49, '40-59': 94.89, 'old': 75.05, 'new': 94.89}
2024-04-18 23:18:18,408 [trainer.py] => CNN top1 curve: [97.4, 90.83, 81.68]
2024-04-18 23:18:18,408 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.57]

Average Accuracy (CNN): 89.97000000000001
2024-04-18 23:18:18,408 [trainer.py] => Average Accuracy (CNN): 89.97000000000001 

2024-04-18 23:18:18,408 [trainer.py] => Train Time: 1784.9
2024-04-18 23:18:18,408 [trainer.py] => Test Time: 12.23 

2024-04-18 23:18:18,410 [trainer.py] => All params: 89792456
2024-04-18 23:18:18,411 [trainer.py] => Trainable params: 89792456
2024-04-18 23:18:21,610 [coda_prompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.519, Train_accy 53.84:   0%|          | 0/20 [00:16<?, ?it/s]
Task 3, Epoch 1/20 => Loss 1.519, Train_accy 53.84:   5%|▌         | 1/20 [00:16<05:20, 16.85s/it]
Task 3, Epoch 2/20 => Loss 0.615, Train_accy 79.61:   5%|▌         | 1/20 [00:33<05:20, 16.85s/it]
Task 3, Epoch 2/20 => Loss 0.615, Train_accy 79.61:  10%|█         | 2/20 [00:33<04:56, 16.48s/it]
Task 3, Epoch 3/20 => Loss 0.483, Train_accy 82.79:  10%|█         | 2/20 [00:48<04:56, 16.48s/it]
Task 3, Epoch 3/20 => Loss 0.483, Train_accy 82.79:  15%|█▌        | 3/20 [00:48<04:30, 15.92s/it]
Task 3, Epoch 4/20 => Loss 0.426, Train_accy 85.20:  15%|█▌        | 3/20 [01:03<04:30, 15.92s/it]
Task 3, Epoch 4/20 => Loss 0.426, Train_accy 85.20:  20%|██        | 4/20 [01:03<04:06, 15.43s/it]
Task 3, Epoch 5/20 => Loss 0.432, Train_accy 85.75, Test_accy 78.53:  20%|██        | 4/20 [01:25<04:06, 15.43s/it]
Task 3, Epoch 5/20 => Loss 0.432, Train_accy 85.75, Test_accy 78.53:  25%|██▌       | 5/20 [01:25<04:32, 18.16s/it]
Task 3, Epoch 6/20 => Loss 0.356, Train_accy 88.05:  25%|██▌       | 5/20 [01:41<04:32, 18.16s/it]                 
Task 3, Epoch 6/20 => Loss 0.356, Train_accy 88.05:  30%|███       | 6/20 [01:41<03:59, 17.14s/it]
Task 3, Epoch 7/20 => Loss 0.321, Train_accy 89.58:  30%|███       | 6/20 [01:57<03:59, 17.14s/it]
Task 3, Epoch 7/20 => Loss 0.321, Train_accy 89.58:  35%|███▌      | 7/20 [01:57<03:40, 16.98s/it]
Task 3, Epoch 8/20 => Loss 0.263, Train_accy 91.34:  35%|███▌      | 7/20 [02:12<03:40, 16.98s/it]
Task 3, Epoch 8/20 => Loss 0.263, Train_accy 91.34:  40%|████      | 8/20 [02:12<03:15, 16.30s/it]
Task 3, Epoch 9/20 => Loss 0.290, Train_accy 92.00:  40%|████      | 8/20 [02:27<03:15, 16.30s/it]
Task 3, Epoch 9/20 => Loss 0.290, Train_accy 92.00:  45%|████▌     | 9/20 [02:27<02:55, 15.98s/it]
Task 3, Epoch 10/20 => Loss 0.284, Train_accy 90.35, Test_accy 79.16:  45%|████▌     | 9/20 [02:52<02:55, 15.98s/it]
Task 3, Epoch 10/20 => Loss 0.284, Train_accy 90.35, Test_accy 79.16:  50%|█████     | 10/20 [02:52<03:06, 18.69s/it]
Task 3, Epoch 11/20 => Loss 0.298, Train_accy 89.91:  50%|█████     | 10/20 [03:07<03:06, 18.69s/it]                 
Task 3, Epoch 11/20 => Loss 0.298, Train_accy 89.91:  55%|█████▌    | 11/20 [03:07<02:38, 17.64s/it]
Task 3, Epoch 12/20 => Loss 0.259, Train_accy 91.89:  55%|█████▌    | 11/20 [03:24<02:38, 17.64s/it]
Task 3, Epoch 12/20 => Loss 0.259, Train_accy 91.89:  60%|██████    | 12/20 [03:24<02:18, 17.28s/it]
Task 3, Epoch 13/20 => Loss 0.244, Train_accy 92.76:  60%|██████    | 12/20 [03:40<02:18, 17.28s/it]
Task 3, Epoch 13/20 => Loss 0.244, Train_accy 92.76:  65%|██████▌   | 13/20 [03:40<01:58, 16.96s/it]
Task 3, Epoch 14/20 => Loss 0.237, Train_accy 92.54:  65%|██████▌   | 13/20 [03:56<01:58, 16.96s/it]
Task 3, Epoch 14/20 => Loss 0.237, Train_accy 92.54:  70%|███████   | 14/20 [03:56<01:39, 16.54s/it]
Task 3, Epoch 15/20 => Loss 0.199, Train_accy 93.64, Test_accy 79.68:  70%|███████   | 14/20 [04:20<01:39, 16.54s/it]
Task 3, Epoch 15/20 => Loss 0.199, Train_accy 93.64, Test_accy 79.68:  75%|███████▌  | 15/20 [04:20<01:34, 18.90s/it]
Task 3, Epoch 16/20 => Loss 0.192, Train_accy 93.31:  75%|███████▌  | 15/20 [04:35<01:34, 18.90s/it]                 
Task 3, Epoch 16/20 => Loss 0.192, Train_accy 93.31:  80%|████████  | 16/20 [04:35<01:10, 17.67s/it]
Task 3, Epoch 17/20 => Loss 0.204, Train_accy 94.52:  80%|████████  | 16/20 [04:50<01:10, 17.67s/it]
Task 3, Epoch 17/20 => Loss 0.204, Train_accy 94.52:  85%|████████▌ | 17/20 [04:50<00:50, 16.98s/it]
Task 3, Epoch 18/20 => Loss 0.199, Train_accy 94.19:  85%|████████▌ | 17/20 [05:05<00:50, 16.98s/it]
Task 3, Epoch 18/20 => Loss 0.199, Train_accy 94.19:  90%|█████████ | 18/20 [05:05<00:32, 16.38s/it]
Task 3, Epoch 19/20 => Loss 0.195, Train_accy 94.74:  90%|█████████ | 18/20 [05:21<00:32, 16.38s/it]
Task 3, Epoch 19/20 => Loss 0.195, Train_accy 94.74:  95%|█████████▌| 19/20 [05:21<00:16, 16.33s/it]
Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.96, Test_accy 80.63:  95%|█████████▌| 19/20 [05:46<00:16, 16.33s/it]
Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.96, Test_accy 80.63: 100%|██████████| 20/20 [05:46<00:00, 18.83s/it]
Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.96, Test_accy 80.63: 100%|██████████| 20/20 [05:46<00:00, 17.33s/it]
2024-04-18 23:24:08,234 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.173, Train_accy 94.96, Test_accy 80.63
2024-04-18 23:24:15,953 [trainer.py] => No NME accuracy.
2024-04-18 23:24:15,953 [trainer.py] => CNN: {'total': 80.63, '00-19': 80.95, '20-39': 66.81, '40-59': 94.47, '60-79': 80.49, 'old': 80.68, 'new': 80.49}
2024-04-18 23:24:15,953 [trainer.py] => CNN top1 curve: [97.4, 90.83, 81.68, 80.63]
2024-04-18 23:24:15,953 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.57, 98.74]

Average Accuracy (CNN): 87.635
2024-04-18 23:24:15,953 [trainer.py] => Average Accuracy (CNN): 87.635 

2024-04-18 23:24:15,954 [trainer.py] => Train Time: 2478.13
2024-04-18 23:24:15,954 [trainer.py] => Test Time: 19.95 

2024-04-18 23:24:15,955 [trainer.py] => All params: 89792456
2024-04-18 23:24:15,955 [trainer.py] => Trainable params: 89792456
2024-04-18 23:24:21,008 [coda_prompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.153, Train_accy 68.75:   0%|          | 0/20 [00:16<?, ?it/s]
Task 4, Epoch 1/20 => Loss 1.153, Train_accy 68.75:   5%|▌         | 1/20 [00:16<05:22, 16.96s/it]
Task 4, Epoch 2/20 => Loss 0.278, Train_accy 91.98:   5%|▌         | 1/20 [00:32<05:22, 16.96s/it]
Task 4, Epoch 2/20 => Loss 0.278, Train_accy 91.98:  10%|█         | 2/20 [00:32<04:48, 16.02s/it]
Task 4, Epoch 3/20 => Loss 0.228, Train_accy 92.60:  10%|█         | 2/20 [00:49<04:48, 16.02s/it]
Task 4, Epoch 3/20 => Loss 0.228, Train_accy 92.60:  15%|█▌        | 3/20 [00:49<04:42, 16.64s/it]
Task 4, Epoch 4/20 => Loss 0.195, Train_accy 93.65:  15%|█▌        | 3/20 [01:04<04:42, 16.64s/it]
Task 4, Epoch 4/20 => Loss 0.195, Train_accy 93.65:  20%|██        | 4/20 [01:04<04:16, 16.06s/it]
Task 4, Epoch 5/20 => Loss 0.146, Train_accy 95.52, Test_accy 81.98:  20%|██        | 4/20 [01:31<04:16, 16.06s/it]
Task 4, Epoch 5/20 => Loss 0.146, Train_accy 95.52, Test_accy 81.98:  25%|██▌       | 5/20 [01:31<04:59, 19.94s/it]
Task 4, Epoch 6/20 => Loss 0.190, Train_accy 94.58:  25%|██▌       | 5/20 [01:46<04:59, 19.94s/it]                 
Task 4, Epoch 6/20 => Loss 0.190, Train_accy 94.58:  30%|███       | 6/20 [01:46<04:16, 18.34s/it]
Task 4, Epoch 7/20 => Loss 0.139, Train_accy 95.21:  30%|███       | 6/20 [01:58<04:16, 18.34s/it]
Task 4, Epoch 7/20 => Loss 0.139, Train_accy 95.21:  35%|███▌      | 7/20 [01:58<03:30, 16.21s/it]
Task 4, Epoch 8/20 => Loss 0.135, Train_accy 95.73:  35%|███▌      | 7/20 [02:10<03:30, 16.21s/it]
Task 4, Epoch 8/20 => Loss 0.135, Train_accy 95.73:  40%|████      | 8/20 [02:10<02:58, 14.88s/it]
Task 4, Epoch 9/20 => Loss 0.145, Train_accy 95.52:  40%|████      | 8/20 [02:22<02:58, 14.88s/it]
Task 4, Epoch 9/20 => Loss 0.145, Train_accy 95.52:  45%|████▌     | 9/20 [02:22<02:34, 14.00s/it]
Task 4, Epoch 10/20 => Loss 0.140, Train_accy 95.62, Test_accy 81.13:  45%|████▌     | 9/20 [02:42<02:34, 14.00s/it]
Task 4, Epoch 10/20 => Loss 0.140, Train_accy 95.62, Test_accy 81.13:  50%|█████     | 10/20 [02:42<02:38, 15.88s/it]
Task 4, Epoch 11/20 => Loss 0.154, Train_accy 95.31:  50%|█████     | 10/20 [02:54<02:38, 15.88s/it]                 
Task 4, Epoch 11/20 => Loss 0.154, Train_accy 95.31:  55%|█████▌    | 11/20 [02:54<02:12, 14.71s/it]
Task 4, Epoch 12/20 => Loss 0.130, Train_accy 96.46:  55%|█████▌    | 11/20 [03:07<02:12, 14.71s/it]
Task 4, Epoch 12/20 => Loss 0.130, Train_accy 96.46:  60%|██████    | 12/20 [03:07<01:51, 13.94s/it]
Task 4, Epoch 13/20 => Loss 0.114, Train_accy 95.94:  60%|██████    | 12/20 [03:19<01:51, 13.94s/it]
Task 4, Epoch 13/20 => Loss 0.114, Train_accy 95.94:  65%|██████▌   | 13/20 [03:19<01:33, 13.36s/it]
Task 4, Epoch 14/20 => Loss 0.095, Train_accy 96.88:  65%|██████▌   | 13/20 [03:31<01:33, 13.36s/it]
Task 4, Epoch 14/20 => Loss 0.095, Train_accy 96.88:  70%|███████   | 14/20 [03:31<01:18, 13.02s/it]
Task 4, Epoch 15/20 => Loss 0.123, Train_accy 96.56, Test_accy 79.25:  70%|███████   | 14/20 [03:51<01:18, 13.02s/it]
Task 4, Epoch 15/20 => Loss 0.123, Train_accy 96.56, Test_accy 79.25:  75%|███████▌  | 15/20 [03:51<01:15, 15.07s/it]
Task 4, Epoch 16/20 => Loss 0.075, Train_accy 98.02:  75%|███████▌  | 15/20 [04:03<01:15, 15.07s/it]                 
Task 4, Epoch 16/20 => Loss 0.075, Train_accy 98.02:  80%|████████  | 16/20 [04:03<00:56, 14.18s/it]
Task 4, Epoch 17/20 => Loss 0.099, Train_accy 97.19:  80%|████████  | 16/20 [04:15<00:56, 14.18s/it]
Task 4, Epoch 17/20 => Loss 0.099, Train_accy 97.19:  85%|████████▌ | 17/20 [04:15<00:40, 13.49s/it]
Task 4, Epoch 18/20 => Loss 0.116, Train_accy 96.35:  85%|████████▌ | 17/20 [04:27<00:40, 13.49s/it]
Task 4, Epoch 18/20 => Loss 0.116, Train_accy 96.35:  90%|█████████ | 18/20 [04:27<00:26, 13.04s/it]
Task 4, Epoch 19/20 => Loss 0.117, Train_accy 96.15:  90%|█████████ | 18/20 [04:39<00:26, 13.04s/it]
Task 4, Epoch 19/20 => Loss 0.117, Train_accy 96.15:  95%|█████████▌| 19/20 [04:39<00:12, 12.75s/it]
Task 4, Epoch 20/20 => Loss 0.107, Train_accy 96.35, Test_accy 79.42:  95%|█████████▌| 19/20 [04:59<00:12, 12.75s/it]
Task 4, Epoch 20/20 => Loss 0.107, Train_accy 96.35, Test_accy 79.42: 100%|██████████| 20/20 [04:59<00:00, 14.95s/it]
Task 4, Epoch 20/20 => Loss 0.107, Train_accy 96.35, Test_accy 79.42: 100%|██████████| 20/20 [04:59<00:00, 14.97s/it]
2024-04-18 23:29:20,385 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.107, Train_accy 96.35, Test_accy 79.42
2024-04-18 23:29:28,145 [trainer.py] => No NME accuracy.
2024-04-18 23:29:28,146 [trainer.py] => CNN: {'total': 79.42, '00-19': 78.35, '20-39': 65.97, '40-59': 86.81, '60-79': 74.8, '80-99': 92.31, 'old': 76.42, 'new': 92.31}
2024-04-18 23:29:28,146 [trainer.py] => CNN top1 curve: [97.4, 90.83, 81.68, 80.63, 79.42]
2024-04-18 23:29:28,146 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.57, 98.74, 98.38]

Average Accuracy (CNN): 85.992
2024-04-18 23:29:28,146 [trainer.py] => Average Accuracy (CNN): 85.992 

2024-04-18 23:29:28,146 [trainer.py] => Train Time: 3076.86
2024-04-18 23:29:28,147 [trainer.py] => Test Time: 27.71 

2024-04-18 23:29:28,148 [trainer.py] => All params: 89792456
2024-04-18 23:29:28,149 [trainer.py] => Trainable params: 89792456
2024-04-18 23:29:30,037 [coda_prompt.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.394, Train_accy 58.33:   0%|          | 0/20 [00:11<?, ?it/s]
Task 5, Epoch 1/20 => Loss 1.394, Train_accy 58.33:   5%|▌         | 1/20 [00:11<03:39, 11.54s/it]
Task 5, Epoch 2/20 => Loss 0.447, Train_accy 84.10:   5%|▌         | 1/20 [00:22<03:39, 11.54s/it]
Task 5, Epoch 2/20 => Loss 0.447, Train_accy 84.10:  10%|█         | 2/20 [00:22<03:25, 11.41s/it]
Task 5, Epoch 3/20 => Loss 0.400, Train_accy 86.95:  10%|█         | 2/20 [00:34<03:25, 11.41s/it]
Task 5, Epoch 3/20 => Loss 0.400, Train_accy 86.95:  15%|█▌        | 3/20 [00:34<03:15, 11.48s/it]
Task 5, Epoch 4/20 => Loss 0.318, Train_accy 89.25:  15%|█▌        | 3/20 [00:46<03:15, 11.48s/it]
Task 5, Epoch 4/20 => Loss 0.318, Train_accy 89.25:  20%|██        | 4/20 [00:46<03:04, 11.54s/it]
Task 5, Epoch 5/20 => Loss 0.286, Train_accy 90.24, Test_accy 77.96:  20%|██        | 4/20 [01:06<03:04, 11.54s/it]
Task 5, Epoch 5/20 => Loss 0.286, Train_accy 90.24, Test_accy 77.96:  25%|██▌       | 5/20 [01:06<03:43, 14.91s/it]
Task 5, Epoch 6/20 => Loss 0.263, Train_accy 91.34:  25%|██▌       | 5/20 [01:20<03:43, 14.91s/it]                 
Task 5, Epoch 6/20 => Loss 0.263, Train_accy 91.34:  30%|███       | 6/20 [01:20<03:20, 14.30s/it]
Task 5, Epoch 7/20 => Loss 0.250, Train_accy 92.32:  30%|███       | 6/20 [01:35<03:20, 14.30s/it]
Task 5, Epoch 7/20 => Loss 0.250, Train_accy 92.32:  35%|███▌      | 7/20 [01:35<03:10, 14.67s/it]
Task 5, Epoch 8/20 => Loss 0.235, Train_accy 92.76:  35%|███▌      | 7/20 [01:51<03:10, 14.67s/it]
Task 5, Epoch 8/20 => Loss 0.235, Train_accy 92.76:  40%|████      | 8/20 [01:51<02:59, 14.96s/it]
Task 5, Epoch 9/20 => Loss 0.232, Train_accy 93.09:  40%|████      | 8/20 [02:06<02:59, 14.96s/it]
Task 5, Epoch 9/20 => Loss 0.232, Train_accy 93.09:  45%|████▌     | 9/20 [02:06<02:46, 15.11s/it]
Task 5, Epoch 10/20 => Loss 0.224, Train_accy 93.20, Test_accy 78.32:  45%|████▌     | 9/20 [02:34<02:46, 15.11s/it]
Task 5, Epoch 10/20 => Loss 0.224, Train_accy 93.20, Test_accy 78.32:  50%|█████     | 10/20 [02:34<03:10, 19.08s/it]
Task 5, Epoch 11/20 => Loss 0.265, Train_accy 91.78:  50%|█████     | 10/20 [02:49<03:10, 19.08s/it]                 
Task 5, Epoch 11/20 => Loss 0.265, Train_accy 91.78:  55%|█████▌    | 11/20 [02:49<02:40, 17.88s/it]
Task 5, Epoch 12/20 => Loss 0.180, Train_accy 94.74:  55%|█████▌    | 11/20 [03:06<02:40, 17.88s/it]
Task 5, Epoch 12/20 => Loss 0.180, Train_accy 94.74:  60%|██████    | 12/20 [03:06<02:19, 17.47s/it]
Task 5, Epoch 13/20 => Loss 0.206, Train_accy 93.97:  60%|██████    | 12/20 [03:21<02:19, 17.47s/it]
Task 5, Epoch 13/20 => Loss 0.206, Train_accy 93.97:  65%|██████▌   | 13/20 [03:21<01:58, 16.97s/it]
Task 5, Epoch 14/20 => Loss 0.180, Train_accy 94.96:  65%|██████▌   | 13/20 [03:36<01:58, 16.97s/it]
Task 5, Epoch 14/20 => Loss 0.180, Train_accy 94.96:  70%|███████   | 14/20 [03:36<01:38, 16.35s/it]
Task 5, Epoch 15/20 => Loss 0.186, Train_accy 93.75, Test_accy 78.89:  70%|███████   | 14/20 [04:04<01:38, 16.35s/it]
Task 5, Epoch 15/20 => Loss 0.186, Train_accy 93.75, Test_accy 78.89:  75%|███████▌  | 15/20 [04:04<01:38, 19.67s/it]
Task 5, Epoch 16/20 => Loss 0.176, Train_accy 94.85:  75%|███████▌  | 15/20 [04:19<01:38, 19.67s/it]                 
Task 5, Epoch 16/20 => Loss 0.176, Train_accy 94.85:  80%|████████  | 16/20 [04:19<01:13, 18.27s/it]
Task 5, Epoch 17/20 => Loss 0.187, Train_accy 94.74:  80%|████████  | 16/20 [04:34<01:13, 18.27s/it]
Task 5, Epoch 17/20 => Loss 0.187, Train_accy 94.74:  85%|████████▌ | 17/20 [04:34<00:52, 17.49s/it]
Task 5, Epoch 18/20 => Loss 0.150, Train_accy 94.74:  85%|████████▌ | 17/20 [04:48<00:52, 17.49s/it]
Task 5, Epoch 18/20 => Loss 0.150, Train_accy 94.74:  90%|█████████ | 18/20 [04:48<00:32, 16.44s/it]
Task 5, Epoch 19/20 => Loss 0.208, Train_accy 93.64:  90%|█████████ | 18/20 [05:03<00:32, 16.44s/it]
Task 5, Epoch 19/20 => Loss 0.208, Train_accy 93.64:  95%|█████████▌| 19/20 [05:03<00:15, 15.86s/it]
Task 5, Epoch 20/20 => Loss 0.160, Train_accy 94.96, Test_accy 78.82:  95%|█████████▌| 19/20 [05:32<00:15, 15.86s/it]
Task 5, Epoch 20/20 => Loss 0.160, Train_accy 94.96, Test_accy 78.82: 100%|██████████| 20/20 [05:32<00:00, 19.83s/it]
Task 5, Epoch 20/20 => Loss 0.160, Train_accy 94.96, Test_accy 78.82: 100%|██████████| 20/20 [05:32<00:00, 16.63s/it]
2024-04-18 23:35:02,571 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.160, Train_accy 94.96, Test_accy 78.82
2024-04-18 23:35:14,705 [trainer.py] => No NME accuracy.
2024-04-18 23:35:14,705 [trainer.py] => CNN: {'total': 78.82, '00-19': 77.49, '20-39': 62.18, '40-59': 86.81, '60-79': 73.98, '80-99': 91.4, '100-119': 82.43, 'old': 78.14, 'new': 82.43}
2024-04-18 23:35:14,706 [trainer.py] => CNN top1 curve: [97.4, 90.83, 81.68, 80.63, 79.42, 78.82]
2024-04-18 23:35:14,706 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.57, 98.74, 98.38, 97.42]

Average Accuracy (CNN): 84.79666666666667
2024-04-18 23:35:14,706 [trainer.py] => Average Accuracy (CNN): 84.79666666666667 

2024-04-18 23:35:14,706 [trainer.py] => Train Time: 3741.92
2024-04-18 23:35:14,706 [trainer.py] => Test Time: 39.84 

2024-04-18 23:35:14,708 [trainer.py] => All params: 89792456
2024-04-18 23:35:14,709 [trainer.py] => Trainable params: 89792456
2024-04-18 23:35:21,056 [coda_prompt.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.736, Train_accy 50.00:   0%|          | 0/20 [00:17<?, ?it/s]
Task 6, Epoch 1/20 => Loss 1.736, Train_accy 50.00:   5%|▌         | 1/20 [00:17<05:30, 17.39s/it]
Task 6, Epoch 2/20 => Loss 0.693, Train_accy 80.26:   5%|▌         | 1/20 [00:32<05:30, 17.39s/it]
Task 6, Epoch 2/20 => Loss 0.693, Train_accy 80.26:  10%|█         | 2/20 [00:32<04:48, 16.06s/it]
Task 6, Epoch 3/20 => Loss 0.525, Train_accy 83.55:  10%|█         | 2/20 [00:48<04:48, 16.06s/it]
Task 6, Epoch 3/20 => Loss 0.525, Train_accy 83.55:  15%|█▌        | 3/20 [00:48<04:32, 16.01s/it]
Task 6, Epoch 4/20 => Loss 0.437, Train_accy 87.50:  15%|█▌        | 3/20 [01:03<04:32, 16.01s/it]
Task 6, Epoch 4/20 => Loss 0.437, Train_accy 87.50:  20%|██        | 4/20 [01:03<04:07, 15.45s/it]
Task 6, Epoch 5/20 => Loss 0.442, Train_accy 85.86, Test_accy 74.31:  20%|██        | 4/20 [01:33<04:07, 15.45s/it]
Task 6, Epoch 5/20 => Loss 0.442, Train_accy 85.86, Test_accy 74.31:  25%|██▌       | 5/20 [01:33<05:14, 20.95s/it]
Task 6, Epoch 6/20 => Loss 0.347, Train_accy 89.58:  25%|██▌       | 5/20 [01:48<05:14, 20.95s/it]                 
Task 6, Epoch 6/20 => Loss 0.347, Train_accy 89.58:  30%|███       | 6/20 [01:48<04:25, 19.00s/it]
Task 6, Epoch 7/20 => Loss 0.352, Train_accy 88.38:  30%|███       | 6/20 [02:03<04:25, 19.00s/it]
Task 6, Epoch 7/20 => Loss 0.352, Train_accy 88.38:  35%|███▌      | 7/20 [02:03<03:48, 17.57s/it]
Task 6, Epoch 8/20 => Loss 0.317, Train_accy 90.35:  35%|███▌      | 7/20 [02:19<03:48, 17.57s/it]
Task 6, Epoch 8/20 => Loss 0.317, Train_accy 90.35:  40%|████      | 8/20 [02:19<03:24, 17.07s/it]
Task 6, Epoch 9/20 => Loss 0.301, Train_accy 89.91:  40%|████      | 8/20 [02:34<03:24, 17.07s/it]
Task 6, Epoch 9/20 => Loss 0.301, Train_accy 89.91:  45%|████▌     | 9/20 [02:34<03:00, 16.44s/it]
Task 6, Epoch 10/20 => Loss 0.295, Train_accy 90.02, Test_accy 75.05:  45%|████▌     | 9/20 [03:05<03:00, 16.44s/it]
Task 6, Epoch 10/20 => Loss 0.295, Train_accy 90.02, Test_accy 75.05:  50%|█████     | 10/20 [03:05<03:27, 20.80s/it]
Task 6, Epoch 11/20 => Loss 0.308, Train_accy 90.68:  50%|█████     | 10/20 [03:21<03:27, 20.80s/it]                 
Task 6, Epoch 11/20 => Loss 0.308, Train_accy 90.68:  55%|█████▌    | 11/20 [03:21<02:54, 19.36s/it]
Task 6, Epoch 12/20 => Loss 0.263, Train_accy 92.21:  55%|█████▌    | 11/20 [03:35<02:54, 19.36s/it]
Task 6, Epoch 12/20 => Loss 0.263, Train_accy 92.21:  60%|██████    | 12/20 [03:35<02:22, 17.79s/it]
Task 6, Epoch 13/20 => Loss 0.259, Train_accy 91.67:  60%|██████    | 12/20 [03:52<02:22, 17.79s/it]
Task 6, Epoch 13/20 => Loss 0.259, Train_accy 91.67:  65%|██████▌   | 13/20 [03:52<02:02, 17.48s/it]
Task 6, Epoch 14/20 => Loss 0.256, Train_accy 91.12:  65%|██████▌   | 13/20 [04:08<02:02, 17.48s/it]
Task 6, Epoch 14/20 => Loss 0.256, Train_accy 91.12:  70%|███████   | 14/20 [04:08<01:41, 16.97s/it]
Task 6, Epoch 15/20 => Loss 0.301, Train_accy 90.90, Test_accy 76.64:  70%|███████   | 14/20 [04:37<01:41, 16.97s/it]
Task 6, Epoch 15/20 => Loss 0.301, Train_accy 90.90, Test_accy 76.64:  75%|███████▌  | 15/20 [04:37<01:43, 20.76s/it]
Task 6, Epoch 16/20 => Loss 0.246, Train_accy 92.98:  75%|███████▌  | 15/20 [04:54<01:43, 20.76s/it]                 
Task 6, Epoch 16/20 => Loss 0.246, Train_accy 92.98:  80%|████████  | 16/20 [04:54<01:17, 19.49s/it]
Task 6, Epoch 17/20 => Loss 0.268, Train_accy 91.89:  80%|████████  | 16/20 [05:09<01:17, 19.49s/it]
Task 6, Epoch 17/20 => Loss 0.268, Train_accy 91.89:  85%|████████▌ | 17/20 [05:09<00:54, 18.22s/it]
Task 6, Epoch 18/20 => Loss 0.249, Train_accy 91.89:  85%|████████▌ | 17/20 [05:24<00:54, 18.22s/it]
Task 6, Epoch 18/20 => Loss 0.249, Train_accy 91.89:  90%|█████████ | 18/20 [05:24<00:34, 17.28s/it]
Task 6, Epoch 19/20 => Loss 0.274, Train_accy 91.45:  90%|█████████ | 18/20 [05:39<00:34, 17.28s/it]
Task 6, Epoch 19/20 => Loss 0.274, Train_accy 91.45:  95%|█████████▌| 19/20 [05:39<00:16, 16.68s/it]
Task 6, Epoch 20/20 => Loss 0.237, Train_accy 91.89, Test_accy 76.70:  95%|█████████▌| 19/20 [06:08<00:16, 16.68s/it]
Task 6, Epoch 20/20 => Loss 0.237, Train_accy 91.89, Test_accy 76.70: 100%|██████████| 20/20 [06:08<00:00, 20.37s/it]
Task 6, Epoch 20/20 => Loss 0.237, Train_accy 91.89, Test_accy 76.70: 100%|██████████| 20/20 [06:08<00:00, 18.44s/it]
2024-04-18 23:41:29,831 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.237, Train_accy 91.89, Test_accy 76.70
2024-04-18 23:41:43,752 [trainer.py] => No NME accuracy.
2024-04-18 23:41:43,752 [trainer.py] => CNN: {'total': 76.7, '00-19': 78.35, '20-39': 62.18, '40-59': 87.23, '60-79': 73.98, '80-99': 91.4, '100-119': 81.98, '120-139': 63.64, 'old': 78.97, 'new': 63.64}
2024-04-18 23:41:43,753 [trainer.py] => CNN top1 curve: [97.4, 90.83, 81.68, 80.63, 79.42, 78.82, 76.7]
2024-04-18 23:41:43,753 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.57, 98.74, 98.38, 97.42, 96.76]

Average Accuracy (CNN): 83.64
2024-04-18 23:41:43,753 [trainer.py] => Average Accuracy (CNN): 83.64 

2024-04-18 23:41:43,753 [trainer.py] => Train Time: 4479.450000000001
2024-04-18 23:41:43,753 [trainer.py] => Test Time: 53.760000000000005 

2024-04-18 23:41:43,755 [trainer.py] => All params: 89792456
2024-04-18 23:41:43,756 [trainer.py] => Trainable params: 89792456
2024-04-18 23:41:51,403 [coda_prompt.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.931, Train_accy 44.69:   0%|          | 0/20 [00:16<?, ?it/s]
Task 7, Epoch 1/20 => Loss 1.931, Train_accy 44.69:   5%|▌         | 1/20 [00:16<05:16, 16.67s/it]
Task 7, Epoch 2/20 => Loss 0.778, Train_accy 73.54:   5%|▌         | 1/20 [00:33<05:16, 16.67s/it]
Task 7, Epoch 2/20 => Loss 0.778, Train_accy 73.54:  10%|█         | 2/20 [00:33<05:02, 16.79s/it]
Task 7, Epoch 3/20 => Loss 0.679, Train_accy 77.19:  10%|█         | 2/20 [00:49<05:02, 16.79s/it]
Task 7, Epoch 3/20 => Loss 0.679, Train_accy 77.19:  15%|█▌        | 3/20 [00:49<04:41, 16.57s/it]
Task 7, Epoch 4/20 => Loss 0.577, Train_accy 80.73:  15%|█▌        | 3/20 [01:06<04:41, 16.57s/it]
Task 7, Epoch 4/20 => Loss 0.577, Train_accy 80.73:  20%|██        | 4/20 [01:06<04:26, 16.68s/it]
Task 7, Epoch 5/20 => Loss 0.494, Train_accy 84.58, Test_accy 74.66:  20%|██        | 4/20 [01:38<04:26, 16.68s/it]
Task 7, Epoch 5/20 => Loss 0.494, Train_accy 84.58, Test_accy 74.66:  25%|██▌       | 5/20 [01:38<05:29, 21.95s/it]
Task 7, Epoch 6/20 => Loss 0.450, Train_accy 86.15:  25%|██▌       | 5/20 [01:54<05:29, 21.95s/it]                 
Task 7, Epoch 6/20 => Loss 0.450, Train_accy 86.15:  30%|███       | 6/20 [01:54<04:40, 20.07s/it]
Task 7, Epoch 7/20 => Loss 0.421, Train_accy 86.67:  30%|███       | 6/20 [02:11<04:40, 20.07s/it]
Task 7, Epoch 7/20 => Loss 0.421, Train_accy 86.67:  35%|███▌      | 7/20 [02:11<04:06, 18.95s/it]
Task 7, Epoch 8/20 => Loss 0.425, Train_accy 85.94:  35%|███▌      | 7/20 [02:26<04:06, 18.95s/it]
Task 7, Epoch 8/20 => Loss 0.425, Train_accy 85.94:  40%|████      | 8/20 [02:26<03:34, 17.86s/it]
Task 7, Epoch 9/20 => Loss 0.394, Train_accy 87.19:  40%|████      | 8/20 [02:43<03:34, 17.86s/it]
Task 7, Epoch 9/20 => Loss 0.394, Train_accy 87.19:  45%|████▌     | 9/20 [02:43<03:13, 17.61s/it]
Task 7, Epoch 10/20 => Loss 0.377, Train_accy 87.81, Test_accy 75.47:  45%|████▌     | 9/20 [03:16<03:13, 17.61s/it]
Task 7, Epoch 10/20 => Loss 0.377, Train_accy 87.81, Test_accy 75.47:  50%|█████     | 10/20 [03:16<03:43, 22.37s/it]
Task 7, Epoch 11/20 => Loss 0.330, Train_accy 89.90:  50%|█████     | 10/20 [03:32<03:43, 22.37s/it]                 
Task 7, Epoch 11/20 => Loss 0.330, Train_accy 89.90:  55%|█████▌    | 11/20 [03:32<03:02, 20.23s/it]
Task 7, Epoch 12/20 => Loss 0.352, Train_accy 88.65:  55%|█████▌    | 11/20 [03:48<03:02, 20.23s/it]
Task 7, Epoch 12/20 => Loss 0.352, Train_accy 88.65:  60%|██████    | 12/20 [03:48<02:32, 19.06s/it]
Task 7, Epoch 13/20 => Loss 0.343, Train_accy 89.17:  60%|██████    | 12/20 [04:05<02:32, 19.06s/it]
Task 7, Epoch 13/20 => Loss 0.343, Train_accy 89.17:  65%|██████▌   | 13/20 [04:05<02:08, 18.31s/it]
Task 7, Epoch 14/20 => Loss 0.337, Train_accy 88.33:  65%|██████▌   | 13/20 [04:22<02:08, 18.31s/it]
Task 7, Epoch 14/20 => Loss 0.337, Train_accy 88.33:  70%|███████   | 14/20 [04:22<01:48, 18.13s/it]
Task 7, Epoch 15/20 => Loss 0.329, Train_accy 89.48, Test_accy 76.01:  70%|███████   | 14/20 [04:54<01:48, 18.13s/it]
Task 7, Epoch 15/20 => Loss 0.329, Train_accy 89.48, Test_accy 76.01:  75%|███████▌  | 15/20 [04:54<01:51, 22.30s/it]
Task 7, Epoch 16/20 => Loss 0.301, Train_accy 90.21:  75%|███████▌  | 15/20 [05:09<01:51, 22.30s/it]                 
Task 7, Epoch 16/20 => Loss 0.301, Train_accy 90.21:  80%|████████  | 16/20 [05:09<01:20, 20.03s/it]
Task 7, Epoch 17/20 => Loss 0.263, Train_accy 92.60:  80%|████████  | 16/20 [05:26<01:20, 20.03s/it]
Task 7, Epoch 17/20 => Loss 0.263, Train_accy 92.60:  85%|████████▌ | 17/20 [05:26<00:57, 19.24s/it]
Task 7, Epoch 18/20 => Loss 0.308, Train_accy 91.04:  85%|████████▌ | 17/20 [05:43<00:57, 19.24s/it]
Task 7, Epoch 18/20 => Loss 0.308, Train_accy 91.04:  90%|█████████ | 18/20 [05:43<00:36, 18.48s/it]
Task 7, Epoch 19/20 => Loss 0.269, Train_accy 91.88:  90%|█████████ | 18/20 [06:00<00:36, 18.48s/it]
Task 7, Epoch 19/20 => Loss 0.269, Train_accy 91.88:  95%|█████████▌| 19/20 [06:00<00:18, 18.11s/it]
Task 7, Epoch 20/20 => Loss 0.250, Train_accy 92.08, Test_accy 75.95:  95%|█████████▌| 19/20 [06:33<00:18, 18.11s/it]
Task 7, Epoch 20/20 => Loss 0.250, Train_accy 92.08, Test_accy 75.95: 100%|██████████| 20/20 [06:33<00:00, 22.38s/it]
Task 7, Epoch 20/20 => Loss 0.250, Train_accy 92.08, Test_accy 75.95: 100%|██████████| 20/20 [06:33<00:00, 19.66s/it]
2024-04-18 23:48:24,582 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.250, Train_accy 92.08, Test_accy 75.95
2024-04-18 23:48:41,562 [trainer.py] => No NME accuracy.
2024-04-18 23:48:41,563 [trainer.py] => CNN: {'total': 75.95, '00-19': 77.49, '20-39': 62.61, '40-59': 87.23, '60-79': 74.8, '80-99': 90.95, '100-119': 80.63, '120-139': 63.64, '140-159': 71.88, 'old': 76.51, 'new': 71.88}
2024-04-18 23:48:41,563 [trainer.py] => CNN top1 curve: [97.4, 90.83, 81.68, 80.63, 79.42, 78.82, 76.7, 75.95]
2024-04-18 23:48:41,563 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.57, 98.74, 98.38, 97.42, 96.76, 96.18]

Average Accuracy (CNN): 82.67875000000001
2024-04-18 23:48:41,563 [trainer.py] => Average Accuracy (CNN): 82.67875000000001 

2024-04-18 23:48:41,564 [trainer.py] => Train Time: 5265.800000000001
2024-04-18 23:48:41,564 [trainer.py] => Test Time: 70.74000000000001 

2024-04-18 23:48:41,565 [trainer.py] => All params: 89792456
2024-04-18 23:48:41,566 [trainer.py] => Trainable params: 89792456
2024-04-18 23:48:44,150 [coda_prompt.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.280, Train_accy 35.86:   0%|          | 0/20 [00:11<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.280, Train_accy 35.86:   5%|▌         | 1/20 [00:11<03:38, 11.51s/it]
Task 8, Epoch 2/20 => Loss 0.765, Train_accy 77.52:   5%|▌         | 1/20 [00:22<03:38, 11.51s/it]
Task 8, Epoch 2/20 => Loss 0.765, Train_accy 77.52:  10%|█         | 2/20 [00:22<03:24, 11.37s/it]
Task 8, Epoch 3/20 => Loss 0.588, Train_accy 83.55:  10%|█         | 2/20 [00:34<03:24, 11.37s/it]
Task 8, Epoch 3/20 => Loss 0.588, Train_accy 83.55:  15%|█▌        | 3/20 [00:34<03:13, 11.37s/it]
Task 8, Epoch 4/20 => Loss 0.525, Train_accy 85.31:  15%|█▌        | 3/20 [00:45<03:13, 11.37s/it]
Task 8, Epoch 4/20 => Loss 0.525, Train_accy 85.31:  20%|██        | 4/20 [00:45<03:01, 11.36s/it]
Task 8, Epoch 5/20 => Loss 0.417, Train_accy 88.49, Test_accy 71.98:  20%|██        | 4/20 [01:10<03:01, 11.36s/it]
Task 8, Epoch 5/20 => Loss 0.417, Train_accy 88.49, Test_accy 71.98:  25%|██▌       | 5/20 [01:10<04:05, 16.37s/it]
Task 8, Epoch 6/20 => Loss 0.431, Train_accy 88.38:  25%|██▌       | 5/20 [01:22<04:05, 16.37s/it]                 
Task 8, Epoch 6/20 => Loss 0.431, Train_accy 88.38:  30%|███       | 6/20 [01:22<03:25, 14.70s/it]
Task 8, Epoch 7/20 => Loss 0.468, Train_accy 86.62:  30%|███       | 6/20 [01:33<03:25, 14.70s/it]
Task 8, Epoch 7/20 => Loss 0.468, Train_accy 86.62:  35%|███▌      | 7/20 [01:33<02:57, 13.63s/it]
Task 8, Epoch 8/20 => Loss 0.427, Train_accy 88.38:  35%|███▌      | 7/20 [01:45<02:57, 13.63s/it]
Task 8, Epoch 8/20 => Loss 0.427, Train_accy 88.38:  40%|████      | 8/20 [01:45<02:35, 12.98s/it]
Task 8, Epoch 9/20 => Loss 0.361, Train_accy 90.13:  40%|████      | 8/20 [01:56<02:35, 12.98s/it]
Task 8, Epoch 9/20 => Loss 0.361, Train_accy 90.13:  45%|████▌     | 9/20 [01:56<02:17, 12.47s/it]
Task 8, Epoch 10/20 => Loss 0.360, Train_accy 88.93, Test_accy 73.69:  45%|████▌     | 9/20 [02:21<02:17, 12.47s/it]
Task 8, Epoch 10/20 => Loss 0.360, Train_accy 88.93, Test_accy 73.69:  50%|█████     | 10/20 [02:21<02:43, 16.39s/it]
Task 8, Epoch 11/20 => Loss 0.345, Train_accy 89.69:  50%|█████     | 10/20 [02:32<02:43, 16.39s/it]                 
Task 8, Epoch 11/20 => Loss 0.345, Train_accy 89.69:  55%|█████▌    | 11/20 [02:32<02:13, 14.82s/it]
Task 8, Epoch 12/20 => Loss 0.347, Train_accy 90.79:  55%|█████▌    | 11/20 [02:44<02:13, 14.82s/it]
Task 8, Epoch 12/20 => Loss 0.347, Train_accy 90.79:  60%|██████    | 12/20 [02:44<01:50, 13.81s/it]
Task 8, Epoch 13/20 => Loss 0.367, Train_accy 88.93:  60%|██████    | 12/20 [02:55<01:50, 13.81s/it]
Task 8, Epoch 13/20 => Loss 0.367, Train_accy 88.93:  65%|██████▌   | 13/20 [02:55<01:31, 13.06s/it]
Task 8, Epoch 14/20 => Loss 0.271, Train_accy 91.78:  65%|██████▌   | 13/20 [03:07<01:31, 13.06s/it]
Task 8, Epoch 14/20 => Loss 0.271, Train_accy 91.78:  70%|███████   | 14/20 [03:07<01:15, 12.60s/it]
Task 8, Epoch 15/20 => Loss 0.292, Train_accy 90.90, Test_accy 74.44:  70%|███████   | 14/20 [03:32<01:15, 12.60s/it]
Task 8, Epoch 15/20 => Loss 0.292, Train_accy 90.90, Test_accy 74.44:  75%|███████▌  | 15/20 [03:32<01:22, 16.44s/it]
Task 8, Epoch 16/20 => Loss 0.319, Train_accy 90.35:  75%|███████▌  | 15/20 [03:43<01:22, 16.44s/it]                 
Task 8, Epoch 16/20 => Loss 0.319, Train_accy 90.35:  80%|████████  | 16/20 [03:43<00:59, 14.87s/it]
Task 8, Epoch 17/20 => Loss 0.257, Train_accy 92.98:  80%|████████  | 16/20 [03:55<00:59, 14.87s/it]
Task 8, Epoch 17/20 => Loss 0.257, Train_accy 92.98:  85%|████████▌ | 17/20 [03:55<00:41, 13.90s/it]
Task 8, Epoch 18/20 => Loss 0.292, Train_accy 91.89:  85%|████████▌ | 17/20 [04:07<00:41, 13.90s/it]
Task 8, Epoch 18/20 => Loss 0.292, Train_accy 91.89:  90%|█████████ | 18/20 [04:07<00:26, 13.18s/it]
Task 8, Epoch 19/20 => Loss 0.342, Train_accy 89.25:  90%|█████████ | 18/20 [04:18<00:26, 13.18s/it]
Task 8, Epoch 19/20 => Loss 0.342, Train_accy 89.25:  95%|█████████▌| 19/20 [04:18<00:12, 12.74s/it]
Task 8, Epoch 20/20 => Loss 0.258, Train_accy 92.76, Test_accy 74.78:  95%|█████████▌| 19/20 [04:49<00:12, 12.74s/it]
Task 8, Epoch 20/20 => Loss 0.258, Train_accy 92.76, Test_accy 74.78: 100%|██████████| 20/20 [04:49<00:00, 18.19s/it]
Task 8, Epoch 20/20 => Loss 0.258, Train_accy 92.76, Test_accy 74.78: 100%|██████████| 20/20 [04:49<00:00, 14.48s/it]
2024-04-18 23:53:33,834 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.258, Train_accy 92.76, Test_accy 74.78
2024-04-18 23:53:52,374 [trainer.py] => No NME accuracy.
2024-04-18 23:53:52,374 [trainer.py] => CNN: {'total': 74.78, '00-19': 77.49, '20-39': 62.61, '40-59': 86.81, '60-79': 74.8, '80-99': 91.4, '100-119': 80.63, '120-139': 64.46, '140-159': 73.21, '160-179': 64.17, 'old': 76.22, 'new': 64.17}
2024-04-18 23:53:52,374 [trainer.py] => CNN top1 curve: [97.4, 90.83, 81.68, 80.63, 79.42, 78.82, 76.7, 75.95, 74.78]
2024-04-18 23:53:52,374 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.57, 98.74, 98.38, 97.42, 96.76, 96.18, 95.46]

Average Accuracy (CNN): 81.80111111111111
2024-04-18 23:53:52,374 [trainer.py] => Average Accuracy (CNN): 81.80111111111111 

2024-04-18 23:53:52,374 [trainer.py] => Train Time: 5845.1500000000015
2024-04-18 23:53:52,374 [trainer.py] => Test Time: 89.28 

2024-04-18 23:53:52,375 [trainer.py] => All params: 89792456
2024-04-18 23:53:52,376 [trainer.py] => Trainable params: 89792456
2024-04-18 23:54:02,063 [coda_prompt.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.420, Train_accy 57.35:   0%|          | 0/20 [00:15<?, ?it/s]
Task 9, Epoch 1/20 => Loss 1.420, Train_accy 57.35:   5%|▌         | 1/20 [00:15<04:47, 15.13s/it]
Task 9, Epoch 2/20 => Loss 0.437, Train_accy 87.50:   5%|▌         | 1/20 [00:30<04:47, 15.13s/it]
Task 9, Epoch 2/20 => Loss 0.437, Train_accy 87.50:  10%|█         | 2/20 [00:30<04:35, 15.29s/it]
Task 9, Epoch 3/20 => Loss 0.375, Train_accy 88.16:  10%|█         | 2/20 [00:46<04:35, 15.29s/it]
Task 9, Epoch 3/20 => Loss 0.375, Train_accy 88.16:  15%|█▌        | 3/20 [00:46<04:26, 15.70s/it]
Task 9, Epoch 4/20 => Loss 0.333, Train_accy 89.25:  15%|█▌        | 3/20 [01:02<04:26, 15.70s/it]
Task 9, Epoch 4/20 => Loss 0.333, Train_accy 89.25:  20%|██        | 4/20 [01:02<04:12, 15.79s/it]
Task 9, Epoch 5/20 => Loss 0.310, Train_accy 90.68, Test_accy 75.23:  20%|██        | 4/20 [01:38<04:12, 15.79s/it]
Task 9, Epoch 5/20 => Loss 0.310, Train_accy 90.68, Test_accy 75.23:  25%|██▌       | 5/20 [01:38<05:43, 22.89s/it]
Task 9, Epoch 6/20 => Loss 0.304, Train_accy 90.68:  25%|██▌       | 5/20 [01:53<05:43, 22.89s/it]                 
Task 9, Epoch 6/20 => Loss 0.304, Train_accy 90.68:  30%|███       | 6/20 [01:53<04:44, 20.34s/it]
Task 9, Epoch 7/20 => Loss 0.291, Train_accy 90.79:  30%|███       | 6/20 [02:08<04:44, 20.34s/it]
Task 9, Epoch 7/20 => Loss 0.291, Train_accy 90.79:  35%|███▌      | 7/20 [02:08<04:01, 18.57s/it]
Task 9, Epoch 8/20 => Loss 0.272, Train_accy 91.78:  35%|███▌      | 7/20 [02:24<04:01, 18.57s/it]
Task 9, Epoch 8/20 => Loss 0.272, Train_accy 91.78:  40%|████      | 8/20 [02:24<03:35, 17.92s/it]
Task 9, Epoch 9/20 => Loss 0.217, Train_accy 92.65:  40%|████      | 8/20 [02:41<03:35, 17.92s/it]
Task 9, Epoch 9/20 => Loss 0.217, Train_accy 92.65:  45%|████▌     | 9/20 [02:41<03:10, 17.34s/it]
Task 9, Epoch 10/20 => Loss 0.205, Train_accy 94.19, Test_accy 75.02:  45%|████▌     | 9/20 [03:18<03:10, 17.34s/it]
Task 9, Epoch 10/20 => Loss 0.205, Train_accy 94.19, Test_accy 75.02:  50%|█████     | 10/20 [03:18<03:56, 23.67s/it]
Task 9, Epoch 11/20 => Loss 0.207, Train_accy 93.75:  50%|█████     | 10/20 [03:33<03:56, 23.67s/it]                 
Task 9, Epoch 11/20 => Loss 0.207, Train_accy 93.75:  55%|█████▌    | 11/20 [03:33<03:07, 20.87s/it]
Task 9, Epoch 12/20 => Loss 0.208, Train_accy 94.08:  55%|█████▌    | 11/20 [03:49<03:07, 20.87s/it]
Task 9, Epoch 12/20 => Loss 0.208, Train_accy 94.08:  60%|██████    | 12/20 [03:49<02:34, 19.31s/it]
Task 9, Epoch 13/20 => Loss 0.196, Train_accy 93.64:  60%|██████    | 12/20 [04:05<02:34, 19.31s/it]
Task 9, Epoch 13/20 => Loss 0.196, Train_accy 93.64:  65%|██████▌   | 13/20 [04:05<02:08, 18.33s/it]
Task 9, Epoch 14/20 => Loss 0.159, Train_accy 95.29:  65%|██████▌   | 13/20 [04:20<02:08, 18.33s/it]
Task 9, Epoch 14/20 => Loss 0.159, Train_accy 95.29:  70%|███████   | 14/20 [04:20<01:45, 17.53s/it]
Task 9, Epoch 15/20 => Loss 0.161, Train_accy 94.85, Test_accy 74.81:  70%|███████   | 14/20 [04:55<01:45, 17.53s/it]
Task 9, Epoch 15/20 => Loss 0.161, Train_accy 94.85, Test_accy 74.81:  75%|███████▌  | 15/20 [04:55<01:53, 22.65s/it]
Task 9, Epoch 16/20 => Loss 0.176, Train_accy 95.07:  75%|███████▌  | 15/20 [05:11<01:53, 22.65s/it]                 
Task 9, Epoch 16/20 => Loss 0.176, Train_accy 95.07:  80%|████████  | 16/20 [05:11<01:22, 20.73s/it]
Task 9, Epoch 17/20 => Loss 0.175, Train_accy 94.41:  80%|████████  | 16/20 [05:27<01:22, 20.73s/it]
Task 9, Epoch 17/20 => Loss 0.175, Train_accy 94.41:  85%|████████▌ | 17/20 [05:27<00:57, 19.22s/it]
Task 9, Epoch 18/20 => Loss 0.157, Train_accy 95.39:  85%|████████▌ | 17/20 [05:42<00:57, 19.22s/it]
Task 9, Epoch 18/20 => Loss 0.157, Train_accy 95.39:  90%|█████████ | 18/20 [05:42<00:36, 18.12s/it]
Task 9, Epoch 19/20 => Loss 0.197, Train_accy 94.19:  90%|█████████ | 18/20 [05:58<00:36, 18.12s/it]
Task 9, Epoch 19/20 => Loss 0.197, Train_accy 94.19:  95%|█████████▌| 19/20 [05:58<00:17, 17.42s/it]
Task 9, Epoch 20/20 => Loss 0.151, Train_accy 95.50, Test_accy 74.64:  95%|█████████▌| 19/20 [06:34<00:17, 17.42s/it]
Task 9, Epoch 20/20 => Loss 0.151, Train_accy 95.50, Test_accy 74.64: 100%|██████████| 20/20 [06:34<00:00, 23.07s/it]
Task 9, Epoch 20/20 => Loss 0.151, Train_accy 95.50, Test_accy 74.64: 100%|██████████| 20/20 [06:34<00:00, 19.75s/it]
2024-04-19 00:00:37,057 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.151, Train_accy 95.50, Test_accy 74.64
2024-04-19 00:00:56,979 [trainer.py] => No NME accuracy.
2024-04-19 00:00:56,979 [trainer.py] => CNN: {'total': 74.64, '00-19': 77.49, '20-39': 62.61, '40-59': 86.38, '60-79': 73.98, '80-99': 91.4, '100-119': 79.28, '120-139': 63.64, '140-159': 73.21, '160-179': 46.46, '180-199': 95.1, 'old': 72.27, 'new': 95.1}
2024-04-19 00:00:56,979 [trainer.py] => CNN top1 curve: [97.4, 90.83, 81.68, 80.63, 79.42, 78.82, 76.7, 75.95, 74.78, 74.64]
2024-04-19 00:00:56,979 [trainer.py] => CNN top5 curve: [100.0, 100.0, 99.57, 98.74, 98.38, 97.42, 96.76, 96.18, 95.46, 95.21]

Average Accuracy (CNN): 81.08500000000001
2024-04-19 00:00:56,979 [trainer.py] => Average Accuracy (CNN): 81.08500000000001 

2024-04-19 00:00:56,979 [trainer.py] => Train Time: 6635.120000000001
2024-04-19 00:00:56,979 [trainer.py] => Test Time: 109.2 

Accuracy Matrix (CNN):
[[97.4  96.1  81.82 80.95 78.35 77.49 78.35 77.49 77.49 77.49]
 [ 0.   85.71 68.49 66.81 65.97 62.18 62.18 62.61 62.61 62.61]
 [ 0.    0.   94.89 94.47 86.81 86.81 87.23 87.23 86.81 86.38]
 [ 0.    0.    0.   80.49 74.8  73.98 73.98 74.8  74.8  73.98]
 [ 0.    0.    0.    0.   92.31 91.4  91.4  90.95 91.4  91.4 ]
 [ 0.    0.    0.    0.    0.   82.43 81.98 80.63 80.63 79.28]
 [ 0.    0.    0.    0.    0.    0.   63.64 63.64 64.46 63.64]
 [ 0.    0.    0.    0.    0.    0.    0.   71.88 73.21 73.21]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   64.17 46.46]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   95.1 ]]
2024-04-19 00:00:56,981 [trainer.py] => Forgetting (CNN): 8.957777777777778


2024-04-19 16:08:32,157 [trainer.py] => config: ./exps/simplecil_cub_B0.json
2024-04-19 16:08:32,175 [trainer.py] => prefix:  
2024-04-19 16:08:32,175 [trainer.py] => dataset: cub
2024-04-19 16:08:32,175 [trainer.py] => memory_size: 0
2024-04-19 16:08:32,175 [trainer.py] => memory_per_class: 0
2024-04-19 16:08:32,176 [trainer.py] => fixed_memory: False
2024-04-19 16:08:32,176 [trainer.py] => shuffle: True
2024-04-19 16:08:32,176 [trainer.py] => init_cls: 20
2024-04-19 16:08:32,176 [trainer.py] => increment: 20
2024-04-19 16:08:32,176 [trainer.py] => model_name: simplecil
2024-04-19 16:08:32,176 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-04-19 16:08:32,176 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-19 16:08:32,176 [trainer.py] => seed: 1993
2024-04-19 16:08:32,176 [trainer.py] => tuned_epoch: 0
2024-04-19 16:08:32,176 [trainer.py] => init_lr: 0.01
2024-04-19 16:08:32,176 [trainer.py] => batch_size: 48
2024-04-19 16:08:32,176 [trainer.py] => weight_decay: 0.05
2024-04-19 16:08:32,176 [trainer.py] => min_lr: 1e-08
2024-04-19 16:08:32,176 [trainer.py] => optimizer: sgd
2024-04-19 16:08:32,176 [trainer.py] => vpt_type: shallow
2024-04-19 16:08:32,176 [trainer.py] => prompt_token_num: 3
2024-04-19 16:08:32,267 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-19 16:08:38,687 [trainer.py] => All params: 85798656
2024-04-19 16:08:38,688 [trainer.py] => Trainable params: 85798656
2024-04-19 16:08:39,103 [simplecil.py] => Learning on 0-20
2024-04-19 16:08:45,802 [trainer.py] => No NME accuracy.
2024-04-19 16:08:45,802 [trainer.py] => CNN: {'total': 97.98, '00-19': 97.98, 'old': 0, 'new': 97.98}
2024-04-19 16:08:45,802 [trainer.py] => CNN top1 curve: [97.98]
2024-04-19 16:08:45,802 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.98
2024-04-19 16:08:45,802 [trainer.py] => Average Accuracy (CNN): 97.98 

2024-04-19 16:08:45,802 [trainer.py] => Train Time: 0.09
2024-04-19 16:08:45,802 [trainer.py] => Test Time: 1.74 

2024-04-19 16:08:45,803 [trainer.py] => All params: 85814017
2024-04-19 16:08:45,804 [trainer.py] => Trainable params: 85814017
2024-04-19 16:08:45,805 [simplecil.py] => Learning on 20-40
2024-04-19 16:08:52,415 [trainer.py] => No NME accuracy.
2024-04-19 16:08:52,415 [trainer.py] => CNN: {'total': 96.92, '00-19': 97.17, '20-39': 96.62, 'old': 97.17, 'new': 96.62}
2024-04-19 16:08:52,415 [trainer.py] => CNN top1 curve: [97.98, 96.92]
2024-04-19 16:08:52,415 [trainer.py] => CNN top5 curve: [100.0, 99.78]

Average Accuracy (CNN): 97.45
2024-04-19 16:08:52,415 [trainer.py] => Average Accuracy (CNN): 97.45 

2024-04-19 16:08:52,415 [trainer.py] => Train Time: 0.09
2024-04-19 16:08:52,415 [trainer.py] => Test Time: 4.08 

2024-04-19 16:08:52,416 [trainer.py] => All params: 85829377
2024-04-19 16:08:52,417 [trainer.py] => Trainable params: 85829377
2024-04-19 16:08:52,418 [simplecil.py] => Learning on 40-60
2024-04-19 16:08:59,247 [trainer.py] => No NME accuracy.
2024-04-19 16:08:59,247 [trainer.py] => CNN: {'total': 93.6, '00-19': 93.52, '20-39': 96.14, '40-59': 91.28, 'old': 94.71, 'new': 91.28}
2024-04-19 16:08:59,247 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6]
2024-04-19 16:08:59,247 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55]

Average Accuracy (CNN): 96.17
2024-04-19 16:08:59,247 [trainer.py] => Average Accuracy (CNN): 96.17 

2024-04-19 16:08:59,247 [trainer.py] => Train Time: 0.09
2024-04-19 16:08:59,247 [trainer.py] => Test Time: 6.9 

2024-04-19 16:08:59,248 [trainer.py] => All params: 85844737
2024-04-19 16:08:59,249 [trainer.py] => Trainable params: 85844737
2024-04-19 16:08:59,251 [simplecil.py] => Learning on 60-80
2024-04-19 16:09:06,476 [trainer.py] => No NME accuracy.
2024-04-19 16:09:06,476 [trainer.py] => CNN: {'total': 91.95, '00-19': 91.9, '20-39': 95.17, '40-59': 89.91, '60-79': 91.09, 'old': 92.26, 'new': 91.09}
2024-04-19 16:09:06,476 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95]
2024-04-19 16:09:06,476 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02]

Average Accuracy (CNN): 95.11
2024-04-19 16:09:06,476 [trainer.py] => Average Accuracy (CNN): 95.11 

2024-04-19 16:09:06,476 [trainer.py] => Train Time: 0.09
2024-04-19 16:09:06,476 [trainer.py] => Test Time: 10.38 

2024-04-19 16:09:06,477 [trainer.py] => All params: 85860097
2024-04-19 16:09:06,478 [trainer.py] => Trainable params: 85860097
2024-04-19 16:09:06,480 [simplecil.py] => Learning on 80-100
2024-04-19 16:09:14,643 [trainer.py] => No NME accuracy.
2024-04-19 16:09:14,643 [trainer.py] => CNN: {'total': 91.16, '00-19': 90.69, '20-39': 93.24, '40-59': 89.91, '60-79': 89.88, '80-99': 92.19, 'old': 90.86, 'new': 92.19}
2024-04-19 16:09:14,643 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16]
2024-04-19 16:09:14,643 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99]

Average Accuracy (CNN): 94.32
2024-04-19 16:09:14,643 [trainer.py] => Average Accuracy (CNN): 94.32 

2024-04-19 16:09:14,644 [trainer.py] => Train Time: 0.09
2024-04-19 16:09:14,644 [trainer.py] => Test Time: 14.75 

2024-04-19 16:09:14,644 [trainer.py] => All params: 85875457
2024-04-19 16:09:14,645 [trainer.py] => Trainable params: 85875457
2024-04-19 16:09:14,646 [simplecil.py] => Learning on 100-120
2024-04-19 16:09:24,354 [trainer.py] => No NME accuracy.
2024-04-19 16:09:24,354 [trainer.py] => CNN: {'total': 88.91, '00-19': 89.47, '20-39': 92.75, '40-59': 89.45, '60-79': 85.43, '80-99': 91.08, '100-119': 85.53, 'old': 89.56, 'new': 85.53}
2024-04-19 16:09:24,354 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91]
2024-04-19 16:09:24,355 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73]

Average Accuracy (CNN): 93.42
2024-04-19 16:09:24,355 [trainer.py] => Average Accuracy (CNN): 93.42 

2024-04-19 16:09:24,355 [trainer.py] => Train Time: 0.09
2024-04-19 16:09:24,355 [trainer.py] => Test Time: 19.47 

2024-04-19 16:09:24,356 [trainer.py] => All params: 85890817
2024-04-19 16:09:24,357 [trainer.py] => Trainable params: 85890817
2024-04-19 16:09:24,359 [simplecil.py] => Learning on 120-140
2024-04-19 16:09:34,490 [trainer.py] => No NME accuracy.
2024-04-19 16:09:34,490 [trainer.py] => CNN: {'total': 87.2, '00-19': 87.85, '20-39': 92.27, '40-59': 88.07, '60-79': 84.62, '80-99': 90.71, '100-119': 84.65, '120-139': 82.22, 'old': 87.99, 'new': 82.22}
2024-04-19 16:09:34,490 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91, 87.2]
2024-04-19 16:09:34,490 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73, 98.6]

Average Accuracy (CNN): 92.53
2024-04-19 16:09:34,490 [trainer.py] => Average Accuracy (CNN): 92.53 

2024-04-19 16:09:34,490 [trainer.py] => Train Time: 0.09
2024-04-19 16:09:34,490 [trainer.py] => Test Time: 24.619999999999997 

2024-04-19 16:09:34,491 [trainer.py] => All params: 85906177
2024-04-19 16:09:34,492 [trainer.py] => Trainable params: 85906177
2024-04-19 16:09:34,494 [simplecil.py] => Learning on 140-160
2024-04-19 16:09:44,737 [trainer.py] => No NME accuracy.
2024-04-19 16:09:44,737 [trainer.py] => CNN: {'total': 86.62, '00-19': 86.64, '20-39': 90.82, '40-59': 86.7, '60-79': 84.21, '80-99': 88.48, '100-119': 83.77, '120-139': 82.22, '140-159': 90.0, 'old': 86.11, 'new': 90.0}
2024-04-19 16:09:44,737 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91, 87.2, 86.62]
2024-04-19 16:09:44,737 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73, 98.6, 98.41]

Average Accuracy (CNN): 91.79
2024-04-19 16:09:44,737 [trainer.py] => Average Accuracy (CNN): 91.79 

2024-04-19 16:09:44,737 [trainer.py] => Train Time: 0.09
2024-04-19 16:09:44,737 [trainer.py] => Test Time: 30.709999999999997 

2024-04-19 16:09:44,738 [trainer.py] => All params: 85921537
2024-04-19 16:09:44,739 [trainer.py] => Trainable params: 85921537
2024-04-19 16:09:44,742 [simplecil.py] => Learning on 160-180
2024-04-19 16:09:56,005 [trainer.py] => No NME accuracy.
2024-04-19 16:09:56,005 [trainer.py] => CNN: {'total': 86.23, '00-19': 85.43, '20-39': 90.34, '40-59': 86.24, '60-79': 84.21, '80-99': 86.99, '100-119': 83.33, '120-139': 82.22, '140-159': 88.8, '160-179': 88.61, 'old': 85.93, 'new': 88.61}
2024-04-19 16:09:56,006 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91, 87.2, 86.62, 86.23]
2024-04-19 16:09:56,006 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73, 98.6, 98.41, 98.17]

Average Accuracy (CNN): 91.17
2024-04-19 16:09:56,006 [trainer.py] => Average Accuracy (CNN): 91.17 

2024-04-19 16:09:56,006 [trainer.py] => Train Time: 0.09
2024-04-19 16:09:56,006 [trainer.py] => Test Time: 37.23 

2024-04-19 16:09:56,007 [trainer.py] => All params: 85936897
2024-04-19 16:09:56,008 [trainer.py] => Trainable params: 85936897
2024-04-19 16:09:56,011 [simplecil.py] => Learning on 180-200
2024-04-19 16:10:08,647 [trainer.py] => No NME accuracy.
2024-04-19 16:10:08,647 [trainer.py] => CNN: {'total': 85.24, '00-19': 85.43, '20-39': 88.89, '40-59': 85.32, '60-79': 82.19, '80-99': 86.62, '100-119': 83.33, '120-139': 81.78, '140-159': 88.8, '160-179': 86.92, '180-199': 83.04, 'old': 85.48, 'new': 83.04}
2024-04-19 16:10:08,647 [trainer.py] => CNN top1 curve: [97.98, 96.92, 93.6, 91.95, 91.16, 88.91, 87.2, 86.62, 86.23, 85.24]
2024-04-19 16:10:08,647 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.55, 99.02, 98.99, 98.73, 98.6, 98.41, 98.17, 97.79]

Average Accuracy (CNN): 90.58
2024-04-19 16:10:08,647 [trainer.py] => Average Accuracy (CNN): 90.58 

2024-04-19 16:10:08,647 [trainer.py] => Train Time: 0.09
2024-04-19 16:10:08,647 [trainer.py] => Test Time: 44.86 

2024-04-19 00:01:01,581 [trainer.py] => config: ./exps/ease_cub_B0.json
2024-04-19 00:01:01,581 [trainer.py] => prefix:  
2024-04-19 00:01:01,581 [trainer.py] => dataset: cub
2024-04-19 00:01:01,581 [trainer.py] => memory_size: 0
2024-04-19 00:01:01,581 [trainer.py] => memory_per_class: 0
2024-04-19 00:01:01,581 [trainer.py] => fixed_memory: False
2024-04-19 00:01:01,582 [trainer.py] => shuffle: True
2024-04-19 00:01:01,582 [trainer.py] => init_cls: 20
2024-04-19 00:01:01,582 [trainer.py] => increment: 20
2024-04-19 00:01:01,582 [trainer.py] => model_name: ease
2024-04-19 00:01:01,582 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2024-04-19 00:01:01,582 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-19 00:01:01,582 [trainer.py] => seed: 1993
2024-04-19 00:01:01,582 [trainer.py] => init_epochs: 20
2024-04-19 00:01:01,582 [trainer.py] => init_lr: 0.025
2024-04-19 00:01:01,582 [trainer.py] => later_epochs: 20
2024-04-19 00:01:01,582 [trainer.py] => later_lr: 0.025
2024-04-19 00:01:01,582 [trainer.py] => batch_size: 48
2024-04-19 00:01:01,582 [trainer.py] => weight_decay: 0.0005
2024-04-19 00:01:01,582 [trainer.py] => min_lr: 0
2024-04-19 00:01:01,582 [trainer.py] => optimizer: sgd
2024-04-19 00:01:01,582 [trainer.py] => scheduler: cosine
2024-04-19 00:01:01,582 [trainer.py] => pretrained: True
2024-04-19 00:01:01,582 [trainer.py] => vpt_type: Deep
2024-04-19 00:01:01,582 [trainer.py] => prompt_token_num: 5
2024-04-19 00:01:01,582 [trainer.py] => ffn_num: 64
2024-04-19 00:01:01,582 [trainer.py] => use_diagonal: False
2024-04-19 00:01:01,582 [trainer.py] => recalc_sim: True
2024-04-19 00:01:01,582 [trainer.py] => alpha: 0.1
2024-04-19 00:01:01,582 [trainer.py] => use_init_ptm: False
2024-04-19 00:01:01,583 [trainer.py] => beta: 0
2024-04-19 00:01:01,583 [trainer.py] => use_old_data: False
2024-04-19 00:01:01,583 [trainer.py] => use_reweight: True
2024-04-19 00:01:01,583 [trainer.py] => moni_adam: False
2024-04-19 00:01:01,583 [trainer.py] => adapter_num: -1
2024-04-19 00:01:01,638 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
_IncompatibleKeys(missing_keys=['cur_adapter.0.down_proj.weight', 'cur_adapter.0.down_proj.bias', 'cur_adapter.0.up_proj.weight', 'cur_adapter.0.up_proj.bias', 'cur_adapter.1.down_proj.weight', 'cur_adapter.1.down_proj.bias', 'cur_adapter.1.up_proj.weight', 'cur_adapter.1.up_proj.bias', 'cur_adapter.2.down_proj.weight', 'cur_adapter.2.down_proj.bias', 'cur_adapter.2.up_proj.weight', 'cur_adapter.2.up_proj.bias', 'cur_adapter.3.down_proj.weight', 'cur_adapter.3.down_proj.bias', 'cur_adapter.3.up_proj.weight', 'cur_adapter.3.up_proj.bias', 'cur_adapter.4.down_proj.weight', 'cur_adapter.4.down_proj.bias', 'cur_adapter.4.up_proj.weight', 'cur_adapter.4.up_proj.bias', 'cur_adapter.5.down_proj.weight', 'cur_adapter.5.down_proj.bias', 'cur_adapter.5.up_proj.weight', 'cur_adapter.5.up_proj.bias', 'cur_adapter.6.down_proj.weight', 'cur_adapter.6.down_proj.bias', 'cur_adapter.6.up_proj.weight', 'cur_adapter.6.up_proj.bias', 'cur_adapter.7.down_proj.weight', 'cur_adapter.7.down_proj.bias', 'cur_adapter.7.up_proj.weight', 'cur_adapter.7.up_proj.bias', 'cur_adapter.8.down_proj.weight', 'cur_adapter.8.down_proj.bias', 'cur_adapter.8.up_proj.weight', 'cur_adapter.8.up_proj.bias', 'cur_adapter.9.down_proj.weight', 'cur_adapter.9.down_proj.bias', 'cur_adapter.9.up_proj.weight', 'cur_adapter.9.up_proj.bias', 'cur_adapter.10.down_proj.weight', 'cur_adapter.10.down_proj.bias', 'cur_adapter.10.up_proj.weight', 'cur_adapter.10.up_proj.bias', 'cur_adapter.11.down_proj.weight', 'cur_adapter.11.down_proj.bias', 'cur_adapter.11.up_proj.weight', 'cur_adapter.11.up_proj.bias'], unexpected_keys=[])
After BaseNet initialization.
2024-04-19 00:01:11,684 [trainer.py] => All params: 86988288
2024-04-19 00:01:11,685 [trainer.py] => Trainable params: 1189632
2024-04-19 00:01:11,707 [ease.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.943, Train_accy 31.92:   0%|          | 0/20 [00:09<?, ?it/s]
Task 0, Epoch 1/20 => Loss 2.943, Train_accy 31.92:   5%|▌         | 1/20 [00:09<03:08,  9.93s/it]
Task 0, Epoch 2/20 => Loss 2.673, Train_accy 74.42:   5%|▌         | 1/20 [00:19<03:08,  9.93s/it]
Task 0, Epoch 2/20 => Loss 2.673, Train_accy 74.42:  10%|█         | 2/20 [00:19<02:58,  9.89s/it]
Task 0, Epoch 3/20 => Loss 2.053, Train_accy 83.83:  10%|█         | 2/20 [00:28<02:58,  9.89s/it]
Task 0, Epoch 3/20 => Loss 2.053, Train_accy 83.83:  15%|█▌        | 3/20 [00:28<02:35,  9.14s/it]
Task 0, Epoch 4/20 => Loss 1.249, Train_accy 91.54:  15%|█▌        | 3/20 [00:37<02:35,  9.14s/it]
Task 0, Epoch 4/20 => Loss 1.249, Train_accy 91.54:  20%|██        | 4/20 [00:37<02:26,  9.14s/it]
Task 0, Epoch 5/20 => Loss 0.773, Train_accy 92.28:  20%|██        | 4/20 [00:52<02:26,  9.14s/it]
Task 0, Epoch 5/20 => Loss 0.773, Train_accy 92.28:  25%|██▌       | 5/20 [00:52<02:51, 11.46s/it]
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 92.39:  25%|██▌       | 5/20 [01:01<02:51, 11.46s/it]
Task 0, Epoch 6/20 => Loss 0.569, Train_accy 92.39:  30%|███       | 6/20 [01:01<02:27, 10.52s/it]
Task 0, Epoch 7/20 => Loss 0.508, Train_accy 91.23:  30%|███       | 6/20 [01:10<02:27, 10.52s/it]
Task 0, Epoch 7/20 => Loss 0.508, Train_accy 91.23:  35%|███▌      | 7/20 [01:10<02:10, 10.07s/it]
Task 0, Epoch 8/20 => Loss 0.421, Train_accy 93.87:  35%|███▌      | 7/20 [01:19<02:10, 10.07s/it]
Task 0, Epoch 8/20 => Loss 0.421, Train_accy 93.87:  40%|████      | 8/20 [01:19<01:55,  9.66s/it]
Task 0, Epoch 9/20 => Loss 0.435, Train_accy 92.07:  40%|████      | 8/20 [01:29<01:55,  9.66s/it]
Task 0, Epoch 9/20 => Loss 0.435, Train_accy 92.07:  45%|████▌     | 9/20 [01:29<01:46,  9.69s/it]
Task 0, Epoch 10/20 => Loss 0.357, Train_accy 93.76:  45%|████▌     | 9/20 [01:38<01:46,  9.69s/it]
Task 0, Epoch 10/20 => Loss 0.357, Train_accy 93.76:  50%|█████     | 10/20 [01:38<01:35,  9.50s/it]
Task 0, Epoch 11/20 => Loss 0.352, Train_accy 93.97:  50%|█████     | 10/20 [01:46<01:35,  9.50s/it]
Task 0, Epoch 11/20 => Loss 0.352, Train_accy 93.97:  55%|█████▌    | 11/20 [01:46<01:21,  9.02s/it]
Task 0, Epoch 12/20 => Loss 0.352, Train_accy 92.71:  55%|█████▌    | 11/20 [01:55<01:21,  9.02s/it]
Task 0, Epoch 12/20 => Loss 0.352, Train_accy 92.71:  60%|██████    | 12/20 [01:55<01:13,  9.17s/it]
Task 0, Epoch 13/20 => Loss 0.328, Train_accy 93.66:  60%|██████    | 12/20 [02:03<01:13,  9.17s/it]
Task 0, Epoch 13/20 => Loss 0.328, Train_accy 93.66:  65%|██████▌   | 13/20 [02:03<01:01,  8.83s/it]
Task 0, Epoch 14/20 => Loss 0.324, Train_accy 94.08:  65%|██████▌   | 13/20 [02:12<01:01,  8.83s/it]
Task 0, Epoch 14/20 => Loss 0.324, Train_accy 94.08:  70%|███████   | 14/20 [02:12<00:53,  8.91s/it]
Task 0, Epoch 15/20 => Loss 0.336, Train_accy 93.34:  70%|███████   | 14/20 [02:22<00:53,  8.91s/it]
Task 0, Epoch 15/20 => Loss 0.336, Train_accy 93.34:  75%|███████▌  | 15/20 [02:22<00:46,  9.21s/it]
Task 0, Epoch 16/20 => Loss 0.321, Train_accy 94.50:  75%|███████▌  | 15/20 [02:31<00:46,  9.21s/it]
Task 0, Epoch 16/20 => Loss 0.321, Train_accy 94.50:  80%|████████  | 16/20 [02:31<00:36,  9.03s/it]
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 92.60:  80%|████████  | 16/20 [02:39<00:36,  9.03s/it]
Task 0, Epoch 17/20 => Loss 0.331, Train_accy 92.60:  85%|████████▌ | 17/20 [02:39<00:26,  8.92s/it]
Task 0, Epoch 18/20 => Loss 0.335, Train_accy 93.97:  85%|████████▌ | 17/20 [02:48<00:26,  8.92s/it]
Task 0, Epoch 18/20 => Loss 0.335, Train_accy 93.97:  90%|█████████ | 18/20 [02:48<00:17,  8.94s/it]
Task 0, Epoch 19/20 => Loss 0.307, Train_accy 94.29:  90%|█████████ | 18/20 [02:59<00:17,  8.94s/it]
Task 0, Epoch 19/20 => Loss 0.307, Train_accy 94.29:  95%|█████████▌| 19/20 [02:59<00:09,  9.33s/it]
Task 0, Epoch 20/20 => Loss 0.308, Train_accy 94.19:  95%|█████████▌| 19/20 [03:07<00:09,  9.33s/it]
Task 0, Epoch 20/20 => Loss 0.308, Train_accy 94.19: 100%|██████████| 20/20 [03:07<00:00,  9.13s/it]
Task 0, Epoch 20/20 => Loss 0.308, Train_accy 94.19: 100%|██████████| 20/20 [03:07<00:00,  9.39s/it]
2024-04-19 00:04:20,012 [ease.py] => Task 0, Epoch 20/20 => Loss 0.308, Train_accy 94.19
2024-04-19 00:04:27,090 [ease.py] => Task correct: 100.0
2024-04-19 00:04:27,090 [ease.py] => Task acc: 97.97570850202429
2024-04-19 00:04:27,325 [trainer.py] => No NME accuracy.
2024-04-19 00:04:27,325 [trainer.py] => CNN: {'total': 97.98, '00-19': 97.98, 'old': 0, 'new': 97.98}
2024-04-19 00:04:27,325 [trainer.py] => CNN top1 curve: [97.98]
2024-04-19 00:04:27,325 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 97.98
2024-04-19 00:04:27,325 [trainer.py] => Average Accuracy (CNN): 97.98 

2024-04-19 00:04:27,325 [trainer.py] => Train Time: 376.18
2024-04-19 00:04:27,325 [trainer.py] => Test Time: 2.03 

2024-04-19 00:04:27,326 [trainer.py] => All params: 87019010
2024-04-19 00:04:27,327 [trainer.py] => Trainable params: 1189632
2024-04-19 00:04:27,329 [ease.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.943, Train_accy 35.56:   0%|          | 0/20 [00:09<?, ?it/s]
Task 1, Epoch 1/20 => Loss 2.943, Train_accy 35.56:   5%|▌         | 1/20 [00:09<03:04,  9.71s/it]
Task 1, Epoch 2/20 => Loss 2.650, Train_accy 81.69:   5%|▌         | 1/20 [00:18<03:04,  9.71s/it]
Task 1, Epoch 2/20 => Loss 2.650, Train_accy 81.69:  10%|█         | 2/20 [00:18<02:43,  9.11s/it]
Task 1, Epoch 3/20 => Loss 1.977, Train_accy 86.56:  10%|█         | 2/20 [00:27<02:43,  9.11s/it]
Task 1, Epoch 3/20 => Loss 1.977, Train_accy 86.56:  15%|█▌        | 3/20 [00:27<02:36,  9.19s/it]
Task 1, Epoch 4/20 => Loss 1.164, Train_accy 91.11:  15%|█▌        | 3/20 [00:37<02:36,  9.19s/it]
Task 1, Epoch 4/20 => Loss 1.164, Train_accy 91.11:  20%|██        | 4/20 [00:37<02:32,  9.51s/it]
Task 1, Epoch 5/20 => Loss 0.708, Train_accy 92.38:  20%|██        | 4/20 [00:46<02:32,  9.51s/it]
Task 1, Epoch 5/20 => Loss 0.708, Train_accy 92.38:  25%|██▌       | 5/20 [00:46<02:18,  9.25s/it]
Task 1, Epoch 6/20 => Loss 0.523, Train_accy 93.86:  25%|██▌       | 5/20 [00:55<02:18,  9.25s/it]
Task 1, Epoch 6/20 => Loss 0.523, Train_accy 93.86:  30%|███       | 6/20 [00:55<02:08,  9.18s/it]
Task 1, Epoch 7/20 => Loss 0.472, Train_accy 93.02:  30%|███       | 6/20 [01:03<02:08,  9.18s/it]
Task 1, Epoch 7/20 => Loss 0.472, Train_accy 93.02:  35%|███▌      | 7/20 [01:03<01:55,  8.91s/it]
Task 1, Epoch 8/20 => Loss 0.395, Train_accy 93.65:  35%|███▌      | 7/20 [01:13<01:55,  8.91s/it]
Task 1, Epoch 8/20 => Loss 0.395, Train_accy 93.65:  40%|████      | 8/20 [01:13<01:47,  8.99s/it]
Task 1, Epoch 9/20 => Loss 0.365, Train_accy 93.86:  40%|████      | 8/20 [01:22<01:47,  8.99s/it]
Task 1, Epoch 9/20 => Loss 0.365, Train_accy 93.86:  45%|████▌     | 9/20 [01:22<01:40,  9.14s/it]
Task 1, Epoch 10/20 => Loss 0.359, Train_accy 93.44:  45%|████▌     | 9/20 [01:32<01:40,  9.14s/it]
Task 1, Epoch 10/20 => Loss 0.359, Train_accy 93.44:  50%|█████     | 10/20 [01:32<01:33,  9.31s/it]
Task 1, Epoch 11/20 => Loss 0.311, Train_accy 94.29:  50%|█████     | 10/20 [01:41<01:33,  9.31s/it]
Task 1, Epoch 11/20 => Loss 0.311, Train_accy 94.29:  55%|█████▌    | 11/20 [01:41<01:24,  9.36s/it]
Task 1, Epoch 12/20 => Loss 0.347, Train_accy 93.54:  55%|█████▌    | 11/20 [01:50<01:24,  9.36s/it]
Task 1, Epoch 12/20 => Loss 0.347, Train_accy 93.54:  60%|██████    | 12/20 [01:50<01:14,  9.34s/it]
Task 1, Epoch 13/20 => Loss 0.320, Train_accy 93.65:  60%|██████    | 12/20 [01:59<01:14,  9.34s/it]
Task 1, Epoch 13/20 => Loss 0.320, Train_accy 93.65:  65%|██████▌   | 13/20 [01:59<01:03,  9.14s/it]
Task 1, Epoch 14/20 => Loss 0.315, Train_accy 94.81:  65%|██████▌   | 13/20 [02:08<01:03,  9.14s/it]
Task 1, Epoch 14/20 => Loss 0.315, Train_accy 94.81:  70%|███████   | 14/20 [02:08<00:53,  8.99s/it]
Task 1, Epoch 15/20 => Loss 0.300, Train_accy 94.50:  70%|███████   | 14/20 [02:17<00:53,  8.99s/it]
Task 1, Epoch 15/20 => Loss 0.300, Train_accy 94.50:  75%|███████▌  | 15/20 [02:17<00:45,  9.09s/it]
Task 1, Epoch 16/20 => Loss 0.329, Train_accy 92.59:  75%|███████▌  | 15/20 [02:26<00:45,  9.09s/it]
Task 1, Epoch 16/20 => Loss 0.329, Train_accy 92.59:  80%|████████  | 16/20 [02:26<00:36,  9.01s/it]
Task 1, Epoch 17/20 => Loss 0.303, Train_accy 94.07:  80%|████████  | 16/20 [02:35<00:36,  9.01s/it]
Task 1, Epoch 17/20 => Loss 0.303, Train_accy 94.07:  85%|████████▌ | 17/20 [02:35<00:27,  9.05s/it]
Task 1, Epoch 18/20 => Loss 0.280, Train_accy 94.39:  85%|████████▌ | 17/20 [02:45<00:27,  9.05s/it]
Task 1, Epoch 18/20 => Loss 0.280, Train_accy 94.39:  90%|█████████ | 18/20 [02:45<00:18,  9.27s/it]
Task 1, Epoch 19/20 => Loss 0.277, Train_accy 94.39:  90%|█████████ | 18/20 [02:54<00:18,  9.27s/it]
Task 1, Epoch 19/20 => Loss 0.277, Train_accy 94.39:  95%|█████████▌| 19/20 [02:54<00:09,  9.29s/it]
Task 1, Epoch 20/20 => Loss 0.299, Train_accy 94.71:  95%|█████████▌| 19/20 [03:03<00:09,  9.29s/it]
Task 1, Epoch 20/20 => Loss 0.299, Train_accy 94.71: 100%|██████████| 20/20 [03:03<00:00,  9.11s/it]
Task 1, Epoch 20/20 => Loss 0.299, Train_accy 94.71: 100%|██████████| 20/20 [03:03<00:00,  9.17s/it]
2024-04-19 00:07:30,714 [ease.py] => Task 1, Epoch 20/20 => Loss 0.299, Train_accy 94.71
2024-04-19 00:07:45,732 [ease.py] => Task correct: 97.57709251101322
2024-04-19 00:07:45,732 [ease.py] => Task acc: 98.23788546255507
2024-04-19 00:07:45,806 [trainer.py] => No NME accuracy.
2024-04-19 00:07:45,806 [trainer.py] => CNN: {'total': 96.04, '00-19': 94.74, '20-39': 97.58, 'old': 94.74, 'new': 97.58}
2024-04-19 00:07:45,806 [trainer.py] => CNN top1 curve: [97.98, 96.04]
2024-04-19 00:07:45,806 [trainer.py] => CNN top5 curve: [100.0, 99.78]

Average Accuracy (CNN): 97.01
2024-04-19 00:07:45,807 [trainer.py] => Average Accuracy (CNN): 97.01 

2024-04-19 00:07:45,807 [trainer.py] => Train Time: 742.9399999999999
2024-04-19 00:07:45,807 [trainer.py] => Test Time: 6.73 

2024-04-19 00:07:45,808 [trainer.py] => All params: 87065090
2024-04-19 00:07:45,808 [trainer.py] => Trainable params: 1189632
2024-04-19 00:07:45,812 [ease.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.954, Train_accy 28.53:   0%|          | 0/20 [00:09<?, ?it/s]
Task 2, Epoch 1/20 => Loss 2.954, Train_accy 28.53:   5%|▌         | 1/20 [00:09<02:53,  9.16s/it]
Task 2, Epoch 2/20 => Loss 2.718, Train_accy 80.38:   5%|▌         | 1/20 [00:18<02:53,  9.16s/it]
Task 2, Epoch 2/20 => Loss 2.718, Train_accy 80.38:  10%|█         | 2/20 [00:18<02:46,  9.27s/it]
Task 2, Epoch 3/20 => Loss 2.161, Train_accy 88.44:  10%|█         | 2/20 [00:28<02:46,  9.27s/it]
Task 2, Epoch 3/20 => Loss 2.161, Train_accy 88.44:  15%|█▌        | 3/20 [00:28<02:40,  9.43s/it]
Task 2, Epoch 4/20 => Loss 1.372, Train_accy 91.83:  15%|█▌        | 3/20 [00:37<02:40,  9.43s/it]
Task 2, Epoch 4/20 => Loss 1.372, Train_accy 91.83:  20%|██        | 4/20 [00:37<02:28,  9.31s/it]
Task 2, Epoch 5/20 => Loss 0.812, Train_accy 91.94:  20%|██        | 4/20 [00:45<02:28,  9.31s/it]
Task 2, Epoch 5/20 => Loss 0.812, Train_accy 91.94:  25%|██▌       | 5/20 [00:45<02:15,  9.05s/it]
Task 2, Epoch 6/20 => Loss 0.624, Train_accy 91.41:  25%|██▌       | 5/20 [00:55<02:15,  9.05s/it]
Task 2, Epoch 6/20 => Loss 0.624, Train_accy 91.41:  30%|███       | 6/20 [00:55<02:09,  9.25s/it]
Task 2, Epoch 7/20 => Loss 0.492, Train_accy 92.26:  30%|███       | 6/20 [01:03<02:09,  9.25s/it]
Task 2, Epoch 7/20 => Loss 0.492, Train_accy 92.26:  35%|███▌      | 7/20 [01:03<01:57,  9.00s/it]
Task 2, Epoch 8/20 => Loss 0.419, Train_accy 93.43:  35%|███▌      | 7/20 [01:13<01:57,  9.00s/it]
Task 2, Epoch 8/20 => Loss 0.419, Train_accy 93.43:  40%|████      | 8/20 [01:13<01:48,  9.03s/it]
Task 2, Epoch 9/20 => Loss 0.370, Train_accy 93.64:  40%|████      | 8/20 [01:22<01:48,  9.03s/it]
Task 2, Epoch 9/20 => Loss 0.370, Train_accy 93.64:  45%|████▌     | 9/20 [01:22<01:41,  9.25s/it]
Task 2, Epoch 10/20 => Loss 0.368, Train_accy 93.64:  45%|████▌     | 9/20 [01:32<01:41,  9.25s/it]
Task 2, Epoch 10/20 => Loss 0.368, Train_accy 93.64:  50%|█████     | 10/20 [01:32<01:32,  9.25s/it]
Task 2, Epoch 11/20 => Loss 0.311, Train_accy 95.02:  50%|█████     | 10/20 [01:41<01:32,  9.25s/it]
Task 2, Epoch 11/20 => Loss 0.311, Train_accy 95.02:  55%|█████▌    | 11/20 [01:41<01:23,  9.30s/it]
Task 2, Epoch 12/20 => Loss 0.360, Train_accy 92.90:  55%|█████▌    | 11/20 [01:50<01:23,  9.30s/it]
Task 2, Epoch 12/20 => Loss 0.360, Train_accy 92.90:  60%|██████    | 12/20 [01:50<01:13,  9.21s/it]
Task 2, Epoch 13/20 => Loss 0.313, Train_accy 94.59:  60%|██████    | 12/20 [02:00<01:13,  9.21s/it]
Task 2, Epoch 13/20 => Loss 0.313, Train_accy 94.59:  65%|██████▌   | 13/20 [02:00<01:05,  9.36s/it]
Task 2, Epoch 14/20 => Loss 0.341, Train_accy 92.90:  65%|██████▌   | 13/20 [02:09<01:05,  9.36s/it]
Task 2, Epoch 14/20 => Loss 0.341, Train_accy 92.90:  70%|███████   | 14/20 [02:09<00:55,  9.25s/it]
Task 2, Epoch 15/20 => Loss 0.363, Train_accy 91.73:  70%|███████   | 14/20 [02:17<00:55,  9.25s/it]
Task 2, Epoch 15/20 => Loss 0.363, Train_accy 91.73:  75%|███████▌  | 15/20 [02:17<00:45,  9.06s/it]
Task 2, Epoch 16/20 => Loss 0.308, Train_accy 93.74:  75%|███████▌  | 15/20 [02:26<00:45,  9.06s/it]
Task 2, Epoch 16/20 => Loss 0.308, Train_accy 93.74:  80%|████████  | 16/20 [02:26<00:35,  8.98s/it]
Task 2, Epoch 17/20 => Loss 0.278, Train_accy 94.17:  80%|████████  | 16/20 [02:35<00:35,  8.98s/it]
Task 2, Epoch 17/20 => Loss 0.278, Train_accy 94.17:  85%|████████▌ | 17/20 [02:35<00:26,  8.97s/it]
Task 2, Epoch 18/20 => Loss 0.302, Train_accy 94.80:  85%|████████▌ | 17/20 [02:42<00:26,  8.97s/it]
Task 2, Epoch 18/20 => Loss 0.302, Train_accy 94.80:  90%|█████████ | 18/20 [02:42<00:16,  8.44s/it]
Task 2, Epoch 19/20 => Loss 0.312, Train_accy 93.53:  90%|█████████ | 18/20 [02:49<00:16,  8.44s/it]
Task 2, Epoch 19/20 => Loss 0.312, Train_accy 93.53:  95%|█████████▌| 19/20 [02:49<00:07,  7.88s/it]
Task 2, Epoch 20/20 => Loss 0.297, Train_accy 94.17:  95%|█████████▌| 19/20 [02:56<00:07,  7.88s/it]
Task 2, Epoch 20/20 => Loss 0.297, Train_accy 94.17: 100%|██████████| 20/20 [02:56<00:00,  7.54s/it]
Task 2, Epoch 20/20 => Loss 0.297, Train_accy 94.17: 100%|██████████| 20/20 [02:56<00:00,  8.80s/it]
2024-04-19 00:10:41,845 [ease.py] => Task 2, Epoch 20/20 => Loss 0.297, Train_accy 94.17
2024-04-19 00:11:00,420 [ease.py] => Task correct: 94.04761904761905
2024-04-19 00:11:00,421 [ease.py] => Task acc: 98.21428571428571
2024-04-19 00:11:00,596 [trainer.py] => No NME accuracy.
2024-04-19 00:11:00,596 [trainer.py] => CNN: {'total': 92.71, '00-19': 88.26, '20-39': 96.14, '40-59': 94.5, 'old': 91.85, 'new': 94.5}
2024-04-19 00:11:00,596 [trainer.py] => CNN top1 curve: [97.98, 96.04, 92.71]
2024-04-19 00:11:00,597 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.7]

Average Accuracy (CNN): 95.57666666666667
2024-04-19 00:11:00,597 [trainer.py] => Average Accuracy (CNN): 95.57666666666667 

2024-04-19 00:11:00,597 [trainer.py] => Train Time: 1094.99
2024-04-19 00:11:00,597 [trainer.py] => Test Time: 13.73 

2024-04-19 00:11:00,597 [trainer.py] => All params: 87141890
2024-04-19 00:11:00,598 [trainer.py] => Trainable params: 1189632
2024-04-19 00:11:00,603 [ease.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.943, Train_accy 31.92:   0%|          | 0/20 [00:06<?, ?it/s]
Task 3, Epoch 1/20 => Loss 2.943, Train_accy 31.92:   5%|▌         | 1/20 [00:06<02:10,  6.88s/it]
Task 3, Epoch 2/20 => Loss 2.660, Train_accy 85.31:   5%|▌         | 1/20 [00:13<02:10,  6.88s/it]
Task 3, Epoch 2/20 => Loss 2.660, Train_accy 85.31:  10%|█         | 2/20 [00:13<02:02,  6.79s/it]
Task 3, Epoch 3/20 => Loss 1.973, Train_accy 92.60:  10%|█         | 2/20 [00:20<02:02,  6.79s/it]
Task 3, Epoch 3/20 => Loss 1.973, Train_accy 92.60:  15%|█▌        | 3/20 [00:20<01:53,  6.68s/it]
Task 3, Epoch 4/20 => Loss 1.145, Train_accy 93.55:  15%|█▌        | 3/20 [00:26<01:53,  6.68s/it]
Task 3, Epoch 4/20 => Loss 1.145, Train_accy 93.55:  20%|██        | 4/20 [00:26<01:47,  6.72s/it]
Task 3, Epoch 5/20 => Loss 0.692, Train_accy 93.45:  20%|██        | 4/20 [00:33<01:47,  6.72s/it]
Task 3, Epoch 5/20 => Loss 0.692, Train_accy 93.45:  25%|██▌       | 5/20 [00:33<01:40,  6.71s/it]
Task 3, Epoch 6/20 => Loss 0.470, Train_accy 93.76:  25%|██▌       | 5/20 [00:40<01:40,  6.71s/it]
Task 3, Epoch 6/20 => Loss 0.470, Train_accy 93.76:  30%|███       | 6/20 [00:40<01:34,  6.78s/it]
Task 3, Epoch 7/20 => Loss 0.411, Train_accy 93.87:  30%|███       | 6/20 [00:47<01:34,  6.78s/it]
Task 3, Epoch 7/20 => Loss 0.411, Train_accy 93.87:  35%|███▌      | 7/20 [00:47<01:27,  6.72s/it]
Task 3, Epoch 8/20 => Loss 0.368, Train_accy 94.08:  35%|███▌      | 7/20 [00:53<01:27,  6.72s/it]
Task 3, Epoch 8/20 => Loss 0.368, Train_accy 94.08:  40%|████      | 8/20 [00:53<01:21,  6.75s/it]
Task 3, Epoch 9/20 => Loss 0.317, Train_accy 94.29:  40%|████      | 8/20 [01:00<01:21,  6.75s/it]
Task 3, Epoch 9/20 => Loss 0.317, Train_accy 94.29:  45%|████▌     | 9/20 [01:00<01:13,  6.69s/it]
Task 3, Epoch 10/20 => Loss 0.323, Train_accy 93.34:  45%|████▌     | 9/20 [01:07<01:13,  6.69s/it]
Task 3, Epoch 10/20 => Loss 0.323, Train_accy 93.34:  50%|█████     | 10/20 [01:07<01:07,  6.73s/it]
Task 3, Epoch 11/20 => Loss 0.308, Train_accy 93.87:  50%|█████     | 10/20 [01:13<01:07,  6.73s/it]
Task 3, Epoch 11/20 => Loss 0.308, Train_accy 93.87:  55%|█████▌    | 11/20 [01:13<01:00,  6.68s/it]
Task 3, Epoch 12/20 => Loss 0.270, Train_accy 95.45:  55%|█████▌    | 11/20 [01:20<01:00,  6.68s/it]
Task 3, Epoch 12/20 => Loss 0.270, Train_accy 95.45:  60%|██████    | 12/20 [01:20<00:53,  6.71s/it]
Task 3, Epoch 13/20 => Loss 0.274, Train_accy 95.03:  60%|██████    | 12/20 [01:27<00:53,  6.71s/it]
Task 3, Epoch 13/20 => Loss 0.274, Train_accy 95.03:  65%|██████▌   | 13/20 [01:27<00:46,  6.69s/it]
Task 3, Epoch 14/20 => Loss 0.274, Train_accy 94.40:  65%|██████▌   | 13/20 [01:34<00:46,  6.69s/it]
Task 3, Epoch 14/20 => Loss 0.274, Train_accy 94.40:  70%|███████   | 14/20 [01:34<00:40,  6.71s/it]
Task 3, Epoch 15/20 => Loss 0.286, Train_accy 93.87:  70%|███████   | 14/20 [01:40<00:40,  6.71s/it]
Task 3, Epoch 15/20 => Loss 0.286, Train_accy 93.87:  75%|███████▌  | 15/20 [01:40<00:33,  6.69s/it]
Task 3, Epoch 16/20 => Loss 0.228, Train_accy 95.88:  75%|███████▌  | 15/20 [01:47<00:33,  6.69s/it]
Task 3, Epoch 16/20 => Loss 0.228, Train_accy 95.88:  80%|████████  | 16/20 [01:47<00:26,  6.74s/it]
Task 3, Epoch 17/20 => Loss 0.245, Train_accy 94.93:  80%|████████  | 16/20 [01:54<00:26,  6.74s/it]
Task 3, Epoch 17/20 => Loss 0.245, Train_accy 94.93:  85%|████████▌ | 17/20 [01:54<00:20,  6.69s/it]
Task 3, Epoch 18/20 => Loss 0.236, Train_accy 95.45:  85%|████████▌ | 17/20 [02:01<00:20,  6.69s/it]
Task 3, Epoch 18/20 => Loss 0.236, Train_accy 95.45:  90%|█████████ | 18/20 [02:01<00:13,  6.76s/it]
Task 3, Epoch 19/20 => Loss 0.249, Train_accy 95.14:  90%|█████████ | 18/20 [02:07<00:13,  6.76s/it]
Task 3, Epoch 19/20 => Loss 0.249, Train_accy 95.14:  95%|█████████▌| 19/20 [02:07<00:06,  6.80s/it]
Task 3, Epoch 20/20 => Loss 0.257, Train_accy 95.03:  95%|█████████▌| 19/20 [02:14<00:06,  6.80s/it]
Task 3, Epoch 20/20 => Loss 0.257, Train_accy 95.03: 100%|██████████| 20/20 [02:14<00:00,  6.77s/it]
Task 3, Epoch 20/20 => Loss 0.257, Train_accy 95.03: 100%|██████████| 20/20 [02:14<00:00,  6.73s/it]
2024-04-19 00:13:15,286 [ease.py] => Task 3, Epoch 20/20 => Loss 0.257, Train_accy 95.03
2024-04-19 00:13:43,247 [ease.py] => Task correct: 91.83895538628944
2024-04-19 00:13:43,247 [ease.py] => Task acc: 98.25897714907508
2024-04-19 00:13:43,423 [trainer.py] => No NME accuracy.
2024-04-19 00:13:43,423 [trainer.py] => CNN: {'total': 91.08, '00-19': 84.62, '20-39': 92.75, '40-59': 92.2, '60-79': 95.14, 'old': 89.58, 'new': 95.14}
2024-04-19 00:13:43,423 [trainer.py] => CNN top1 curve: [97.98, 96.04, 92.71, 91.08]
2024-04-19 00:13:43,423 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.7, 99.24]

Average Accuracy (CNN): 94.4525
2024-04-19 00:13:43,423 [trainer.py] => Average Accuracy (CNN): 94.4525 

2024-04-19 00:13:43,423 [trainer.py] => Train Time: 1364.3500000000001
2024-04-19 00:13:43,423 [trainer.py] => Test Time: 26.21 

2024-04-19 00:13:43,424 [trainer.py] => All params: 87249410
2024-04-19 00:13:43,425 [trainer.py] => Trainable params: 1189632
2024-04-19 00:13:43,431 [ease.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.943, Train_accy 33.26:   0%|          | 0/20 [00:06<?, ?it/s]
Task 4, Epoch 1/20 => Loss 2.943, Train_accy 33.26:   5%|▌         | 1/20 [00:06<02:07,  6.69s/it]
Task 4, Epoch 2/20 => Loss 2.649, Train_accy 82.82:   5%|▌         | 1/20 [00:13<02:07,  6.69s/it]
Task 4, Epoch 2/20 => Loss 2.649, Train_accy 82.82:  10%|█         | 2/20 [00:13<01:57,  6.53s/it]
Task 4, Epoch 3/20 => Loss 1.936, Train_accy 88.51:  10%|█         | 2/20 [00:19<01:57,  6.53s/it]
Task 4, Epoch 3/20 => Loss 1.936, Train_accy 88.51:  15%|█▌        | 3/20 [00:19<01:51,  6.57s/it]
Task 4, Epoch 4/20 => Loss 1.076, Train_accy 90.37:  15%|█▌        | 3/20 [00:26<01:51,  6.57s/it]
Task 4, Epoch 4/20 => Loss 1.076, Train_accy 90.37:  20%|██        | 4/20 [00:26<01:43,  6.48s/it]
Task 4, Epoch 5/20 => Loss 0.627, Train_accy 92.23:  20%|██        | 4/20 [00:32<01:43,  6.48s/it]
Task 4, Epoch 5/20 => Loss 0.627, Train_accy 92.23:  25%|██▌       | 5/20 [00:32<01:37,  6.47s/it]
Task 4, Epoch 6/20 => Loss 0.515, Train_accy 93.00:  25%|██▌       | 5/20 [00:38<01:37,  6.47s/it]
Task 4, Epoch 6/20 => Loss 0.515, Train_accy 93.00:  30%|███       | 6/20 [00:38<01:29,  6.39s/it]
Task 4, Epoch 7/20 => Loss 0.430, Train_accy 90.15:  30%|███       | 6/20 [00:48<01:29,  6.39s/it]
Task 4, Epoch 7/20 => Loss 0.430, Train_accy 90.15:  35%|███▌      | 7/20 [00:48<01:38,  7.57s/it]
Task 4, Epoch 8/20 => Loss 0.355, Train_accy 93.11:  35%|███▌      | 7/20 [00:57<01:38,  7.57s/it]
Task 4, Epoch 8/20 => Loss 0.355, Train_accy 93.11:  40%|████      | 8/20 [00:57<01:33,  7.80s/it]
Task 4, Epoch 9/20 => Loss 0.353, Train_accy 91.79:  40%|████      | 8/20 [01:06<01:33,  7.80s/it]
Task 4, Epoch 9/20 => Loss 0.353, Train_accy 91.79:  45%|████▌     | 9/20 [01:06<01:29,  8.17s/it]
Task 4, Epoch 10/20 => Loss 0.397, Train_accy 93.00:  45%|████▌     | 9/20 [01:15<01:29,  8.17s/it]
Task 4, Epoch 10/20 => Loss 0.397, Train_accy 93.00:  50%|█████     | 10/20 [01:15<01:24,  8.44s/it]
Task 4, Epoch 11/20 => Loss 0.282, Train_accy 93.76:  50%|█████     | 10/20 [01:23<01:24,  8.44s/it]
Task 4, Epoch 11/20 => Loss 0.282, Train_accy 93.76:  55%|█████▌    | 11/20 [01:23<01:17,  8.57s/it]
Task 4, Epoch 12/20 => Loss 0.291, Train_accy 92.56:  55%|█████▌    | 11/20 [01:32<01:17,  8.57s/it]
Task 4, Epoch 12/20 => Loss 0.291, Train_accy 92.56:  60%|██████    | 12/20 [01:32<01:08,  8.53s/it]
Task 4, Epoch 13/20 => Loss 0.300, Train_accy 92.12:  60%|██████    | 12/20 [01:40<01:08,  8.53s/it]
Task 4, Epoch 13/20 => Loss 0.300, Train_accy 92.12:  65%|██████▌   | 13/20 [01:40<00:58,  8.41s/it]
Task 4, Epoch 14/20 => Loss 0.305, Train_accy 92.45:  65%|██████▌   | 13/20 [01:48<00:58,  8.41s/it]
Task 4, Epoch 14/20 => Loss 0.305, Train_accy 92.45:  70%|███████   | 14/20 [01:48<00:50,  8.43s/it]
Task 4, Epoch 15/20 => Loss 0.241, Train_accy 94.97:  70%|███████   | 14/20 [01:57<00:50,  8.43s/it]
Task 4, Epoch 15/20 => Loss 0.241, Train_accy 94.97:  75%|███████▌  | 15/20 [01:57<00:42,  8.60s/it]
Task 4, Epoch 16/20 => Loss 0.273, Train_accy 93.22:  75%|███████▌  | 15/20 [02:05<00:42,  8.60s/it]
Task 4, Epoch 16/20 => Loss 0.273, Train_accy 93.22:  80%|████████  | 16/20 [02:05<00:33,  8.37s/it]
Task 4, Epoch 17/20 => Loss 0.267, Train_accy 93.00:  80%|████████  | 16/20 [02:14<00:33,  8.37s/it]
Task 4, Epoch 17/20 => Loss 0.267, Train_accy 93.00:  85%|████████▌ | 17/20 [02:14<00:25,  8.59s/it]
Task 4, Epoch 18/20 => Loss 0.251, Train_accy 94.64:  85%|████████▌ | 17/20 [02:22<00:25,  8.59s/it]
Task 4, Epoch 18/20 => Loss 0.251, Train_accy 94.64:  90%|█████████ | 18/20 [02:22<00:16,  8.42s/it]
Task 4, Epoch 19/20 => Loss 0.282, Train_accy 93.00:  90%|█████████ | 18/20 [02:32<00:16,  8.42s/it]
Task 4, Epoch 19/20 => Loss 0.282, Train_accy 93.00:  95%|█████████▌| 19/20 [02:32<00:08,  8.70s/it]
Task 4, Epoch 20/20 => Loss 0.279, Train_accy 93.00:  95%|█████████▌| 19/20 [02:41<00:08,  8.70s/it]
Task 4, Epoch 20/20 => Loss 0.279, Train_accy 93.00: 100%|██████████| 20/20 [02:41<00:00,  8.75s/it]
Task 4, Epoch 20/20 => Loss 0.279, Train_accy 93.00: 100%|██████████| 20/20 [02:41<00:00,  8.06s/it]
2024-04-19 00:16:24,560 [ease.py] => Task 4, Epoch 20/20 => Loss 0.279, Train_accy 93.00
2024-04-19 00:17:15,532 [ease.py] => Task correct: 90.31986531986531
2024-04-19 00:17:15,533 [ease.py] => Task acc: 98.23232323232324
2024-04-19 00:17:15,641 [trainer.py] => No NME accuracy.
2024-04-19 00:17:15,641 [trainer.py] => CNN: {'total': 89.39, '00-19': 78.14, '20-39': 87.44, '40-59': 92.2, '60-79': 93.93, '80-99': 94.8, 'old': 87.81, 'new': 94.8}
2024-04-19 00:17:15,642 [trainer.py] => CNN top1 curve: [97.98, 96.04, 92.71, 91.08, 89.39]
2024-04-19 00:17:15,642 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.7, 99.24, 99.24]

Average Accuracy (CNN): 93.44
2024-04-19 00:17:15,642 [trainer.py] => Average Accuracy (CNN): 93.44 

2024-04-19 00:17:15,642 [trainer.py] => Train Time: 1686.6000000000004
2024-04-19 00:17:15,642 [trainer.py] => Test Time: 52.09 

2024-04-19 00:17:15,642 [trainer.py] => All params: 87387650
2024-04-19 00:17:15,643 [trainer.py] => Trainable params: 1189632
2024-04-19 00:17:15,653 [ease.py] => Learning on 100-120

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.951, Train_accy 25.32:   0%|          | 0/20 [00:09<?, ?it/s]
Task 5, Epoch 1/20 => Loss 2.951, Train_accy 25.32:   5%|▌         | 1/20 [00:09<03:01,  9.55s/it]
Task 5, Epoch 2/20 => Loss 2.689, Train_accy 83.09:   5%|▌         | 1/20 [00:19<03:01,  9.55s/it]
Task 5, Epoch 2/20 => Loss 2.689, Train_accy 83.09:  10%|█         | 2/20 [00:19<02:53,  9.65s/it]
Task 5, Epoch 3/20 => Loss 2.068, Train_accy 91.18:  10%|█         | 2/20 [00:29<02:53,  9.65s/it]
Task 5, Epoch 3/20 => Loss 2.068, Train_accy 91.18:  15%|█▌        | 3/20 [00:29<02:49,  9.95s/it]
Task 5, Epoch 4/20 => Loss 1.218, Train_accy 93.80:  15%|█▌        | 3/20 [00:39<02:49,  9.95s/it]
Task 5, Epoch 4/20 => Loss 1.218, Train_accy 93.80:  20%|██        | 4/20 [00:39<02:38,  9.92s/it]
Task 5, Epoch 5/20 => Loss 0.673, Train_accy 95.38:  20%|██        | 4/20 [00:49<02:38,  9.92s/it]
Task 5, Epoch 5/20 => Loss 0.673, Train_accy 95.38:  25%|██▌       | 5/20 [00:49<02:26,  9.79s/it]
Task 5, Epoch 6/20 => Loss 0.495, Train_accy 94.22:  25%|██▌       | 5/20 [00:58<02:26,  9.79s/it]
Task 5, Epoch 6/20 => Loss 0.495, Train_accy 94.22:  30%|███       | 6/20 [00:58<02:14,  9.58s/it]
Task 5, Epoch 7/20 => Loss 0.366, Train_accy 95.38:  30%|███       | 6/20 [01:07<02:14,  9.58s/it]
Task 5, Epoch 7/20 => Loss 0.366, Train_accy 95.38:  35%|███▌      | 7/20 [01:07<02:01,  9.34s/it]
Task 5, Epoch 8/20 => Loss 0.328, Train_accy 94.64:  35%|███▌      | 7/20 [01:15<02:01,  9.34s/it]
Task 5, Epoch 8/20 => Loss 0.328, Train_accy 94.64:  40%|████      | 8/20 [01:15<01:47,  8.97s/it]
Task 5, Epoch 9/20 => Loss 0.281, Train_accy 95.27:  40%|████      | 8/20 [01:24<01:47,  8.97s/it]
Task 5, Epoch 9/20 => Loss 0.281, Train_accy 95.27:  45%|████▌     | 9/20 [01:24<01:40,  9.11s/it]
Task 5, Epoch 10/20 => Loss 0.279, Train_accy 94.54:  45%|████▌     | 9/20 [01:33<01:40,  9.11s/it]
Task 5, Epoch 10/20 => Loss 0.279, Train_accy 94.54:  50%|█████     | 10/20 [01:33<01:31,  9.17s/it]
Task 5, Epoch 11/20 => Loss 0.271, Train_accy 95.48:  50%|█████     | 10/20 [01:43<01:31,  9.17s/it]
Task 5, Epoch 11/20 => Loss 0.271, Train_accy 95.48:  55%|█████▌    | 11/20 [01:43<01:23,  9.26s/it]
Task 5, Epoch 12/20 => Loss 0.243, Train_accy 96.32:  55%|█████▌    | 11/20 [01:52<01:23,  9.26s/it]
Task 5, Epoch 12/20 => Loss 0.243, Train_accy 96.32:  60%|██████    | 12/20 [01:52<01:13,  9.22s/it]
Task 5, Epoch 13/20 => Loss 0.267, Train_accy 95.38:  60%|██████    | 12/20 [02:02<01:13,  9.22s/it]
Task 5, Epoch 13/20 => Loss 0.267, Train_accy 95.38:  65%|██████▌   | 13/20 [02:02<01:05,  9.35s/it]
Task 5, Epoch 14/20 => Loss 0.221, Train_accy 96.22:  65%|██████▌   | 13/20 [02:11<01:05,  9.35s/it]
Task 5, Epoch 14/20 => Loss 0.221, Train_accy 96.22:  70%|███████   | 14/20 [02:11<00:56,  9.39s/it]
Task 5, Epoch 15/20 => Loss 0.243, Train_accy 95.06:  70%|███████   | 14/20 [02:20<00:56,  9.39s/it]
Task 5, Epoch 15/20 => Loss 0.243, Train_accy 95.06:  75%|███████▌  | 15/20 [02:20<00:45,  9.11s/it]
Task 5, Epoch 16/20 => Loss 0.248, Train_accy 94.85:  75%|███████▌  | 15/20 [02:29<00:45,  9.11s/it]
Task 5, Epoch 16/20 => Loss 0.248, Train_accy 94.85:  80%|████████  | 16/20 [02:29<00:36,  9.07s/it]
Task 5, Epoch 17/20 => Loss 0.233, Train_accy 95.59:  80%|████████  | 16/20 [02:37<00:36,  9.07s/it]
Task 5, Epoch 17/20 => Loss 0.233, Train_accy 95.59:  85%|████████▌ | 17/20 [02:37<00:26,  8.93s/it]
Task 5, Epoch 18/20 => Loss 0.231, Train_accy 95.80:  85%|████████▌ | 17/20 [02:47<00:26,  8.93s/it]
Task 5, Epoch 18/20 => Loss 0.231, Train_accy 95.80:  90%|█████████ | 18/20 [02:47<00:18,  9.23s/it]
Task 5, Epoch 19/20 => Loss 0.246, Train_accy 94.85:  90%|█████████ | 18/20 [02:56<00:18,  9.23s/it]
Task 5, Epoch 19/20 => Loss 0.246, Train_accy 94.85:  95%|█████████▌| 19/20 [02:56<00:08,  8.99s/it]
Task 5, Epoch 20/20 => Loss 0.229, Train_accy 95.59:  95%|█████████▌| 19/20 [03:06<00:08,  8.99s/it]
Task 5, Epoch 20/20 => Loss 0.229, Train_accy 95.59: 100%|██████████| 20/20 [03:06<00:00,  9.28s/it]
Task 5, Epoch 20/20 => Loss 0.229, Train_accy 95.59: 100%|██████████| 20/20 [03:06<00:00,  9.30s/it]
2024-04-19 00:20:21,686 [ease.py] => Task 5, Epoch 20/20 => Loss 0.229, Train_accy 95.59
2024-04-19 00:21:28,541 [ease.py] => Task correct: 87.57062146892656
2024-04-19 00:21:28,542 [ease.py] => Task acc: 98.1638418079096
2024-04-19 00:21:28,592 [trainer.py] => No NME accuracy.
2024-04-19 00:21:28,592 [trainer.py] => CNN: {'total': 86.86, '00-19': 76.52, '20-39': 87.92, '40-59': 87.61, '60-79': 87.85, '80-99': 92.19, '100-119': 89.04, 'old': 86.45, 'new': 89.04}
2024-04-19 00:21:28,592 [trainer.py] => CNN top1 curve: [97.98, 96.04, 92.71, 91.08, 89.39, 86.86]
2024-04-19 00:21:28,592 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.7, 99.24, 99.24, 99.01]

Average Accuracy (CNN): 92.34333333333332
2024-04-19 00:21:28,592 [trainer.py] => Average Accuracy (CNN): 92.34333333333332 

2024-04-19 00:21:28,592 [trainer.py] => Train Time: 2058.6600000000003
2024-04-19 00:21:28,592 [trainer.py] => Test Time: 88.14 

2024-04-19 00:21:28,593 [trainer.py] => All params: 87556610
2024-04-19 00:21:28,594 [trainer.py] => Trainable params: 1189632
2024-04-19 00:21:28,607 [ease.py] => Learning on 120-140

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.952, Train_accy 25.58:   0%|          | 0/20 [00:10<?, ?it/s]
Task 6, Epoch 1/20 => Loss 2.952, Train_accy 25.58:   5%|▌         | 1/20 [00:10<03:12, 10.11s/it]
Task 6, Epoch 2/20 => Loss 2.717, Train_accy 67.19:   5%|▌         | 1/20 [00:18<03:12, 10.11s/it]
Task 6, Epoch 2/20 => Loss 2.717, Train_accy 67.19:  10%|█         | 2/20 [00:18<02:46,  9.25s/it]
Task 6, Epoch 3/20 => Loss 2.177, Train_accy 80.50:  10%|█         | 2/20 [00:28<02:46,  9.25s/it]
Task 6, Epoch 3/20 => Loss 2.177, Train_accy 80.50:  15%|█▌        | 3/20 [00:28<02:38,  9.31s/it]
Task 6, Epoch 4/20 => Loss 1.472, Train_accy 83.12:  15%|█▌        | 3/20 [00:37<02:38,  9.31s/it]
Task 6, Epoch 4/20 => Loss 1.472, Train_accy 83.12:  20%|██        | 4/20 [00:37<02:31,  9.45s/it]
Task 6, Epoch 5/20 => Loss 0.985, Train_accy 86.90:  20%|██        | 4/20 [00:46<02:31,  9.45s/it]
Task 6, Epoch 5/20 => Loss 0.985, Train_accy 86.90:  25%|██▌       | 5/20 [00:46<02:19,  9.29s/it]
Task 6, Epoch 6/20 => Loss 0.772, Train_accy 87.11:  25%|██▌       | 5/20 [00:56<02:19,  9.29s/it]
Task 6, Epoch 6/20 => Loss 0.772, Train_accy 87.11:  30%|███       | 6/20 [00:56<02:11,  9.42s/it]
Task 6, Epoch 7/20 => Loss 0.626, Train_accy 89.20:  30%|███       | 6/20 [01:05<02:11,  9.42s/it]
Task 6, Epoch 7/20 => Loss 0.626, Train_accy 89.20:  35%|███▌      | 7/20 [01:05<01:59,  9.17s/it]
Task 6, Epoch 8/20 => Loss 0.578, Train_accy 88.05:  35%|███▌      | 7/20 [01:13<01:59,  9.17s/it]
Task 6, Epoch 8/20 => Loss 0.578, Train_accy 88.05:  40%|████      | 8/20 [01:13<01:46,  8.91s/it]
Task 6, Epoch 9/20 => Loss 0.497, Train_accy 90.15:  40%|████      | 8/20 [01:22<01:46,  8.91s/it]
Task 6, Epoch 9/20 => Loss 0.497, Train_accy 90.15:  45%|████▌     | 9/20 [01:22<01:39,  9.08s/it]
Task 6, Epoch 10/20 => Loss 0.507, Train_accy 89.41:  45%|████▌     | 9/20 [01:32<01:39,  9.08s/it]
Task 6, Epoch 10/20 => Loss 0.507, Train_accy 89.41:  50%|█████     | 10/20 [01:32<01:31,  9.13s/it]
Task 6, Epoch 11/20 => Loss 0.481, Train_accy 90.25:  50%|█████     | 10/20 [01:42<01:31,  9.13s/it]
Task 6, Epoch 11/20 => Loss 0.481, Train_accy 90.25:  55%|█████▌    | 11/20 [01:42<01:24,  9.44s/it]
Task 6, Epoch 12/20 => Loss 0.431, Train_accy 91.30:  55%|█████▌    | 11/20 [01:50<01:24,  9.44s/it]
Task 6, Epoch 12/20 => Loss 0.431, Train_accy 91.30:  60%|██████    | 12/20 [01:50<01:13,  9.18s/it]
Task 6, Epoch 13/20 => Loss 0.428, Train_accy 90.99:  60%|██████    | 12/20 [02:00<01:13,  9.18s/it]
Task 6, Epoch 13/20 => Loss 0.428, Train_accy 90.99:  65%|██████▌   | 13/20 [02:00<01:04,  9.18s/it]
Task 6, Epoch 14/20 => Loss 0.422, Train_accy 90.88:  65%|██████▌   | 13/20 [02:09<01:04,  9.18s/it]
Task 6, Epoch 14/20 => Loss 0.422, Train_accy 90.88:  70%|███████   | 14/20 [02:09<00:55,  9.18s/it]
Task 6, Epoch 15/20 => Loss 0.428, Train_accy 90.57:  70%|███████   | 14/20 [02:19<00:55,  9.18s/it]
Task 6, Epoch 15/20 => Loss 0.428, Train_accy 90.57:  75%|███████▌  | 15/20 [02:19<00:47,  9.40s/it]
Task 6, Epoch 16/20 => Loss 0.432, Train_accy 90.57:  75%|███████▌  | 15/20 [02:28<00:47,  9.40s/it]
Task 6, Epoch 16/20 => Loss 0.432, Train_accy 90.57:  80%|████████  | 16/20 [02:28<00:37,  9.36s/it]
Task 6, Epoch 17/20 => Loss 0.406, Train_accy 91.51:  80%|████████  | 16/20 [02:37<00:37,  9.36s/it]
Task 6, Epoch 17/20 => Loss 0.406, Train_accy 91.51:  85%|████████▌ | 17/20 [02:37<00:28,  9.34s/it]
Task 6, Epoch 18/20 => Loss 0.394, Train_accy 92.03:  85%|████████▌ | 17/20 [02:46<00:28,  9.34s/it]
Task 6, Epoch 18/20 => Loss 0.394, Train_accy 92.03:  90%|█████████ | 18/20 [02:46<00:18,  9.19s/it]
Task 6, Epoch 19/20 => Loss 0.385, Train_accy 91.93:  90%|█████████ | 18/20 [02:55<00:18,  9.19s/it]
Task 6, Epoch 19/20 => Loss 0.385, Train_accy 91.93:  95%|█████████▌| 19/20 [02:55<00:09,  9.21s/it]
Task 6, Epoch 20/20 => Loss 0.440, Train_accy 90.04:  95%|█████████▌| 19/20 [03:05<00:09,  9.21s/it]
Task 6, Epoch 20/20 => Loss 0.440, Train_accy 90.04: 100%|██████████| 20/20 [03:05<00:00,  9.22s/it]
Task 6, Epoch 20/20 => Loss 0.440, Train_accy 90.04: 100%|██████████| 20/20 [03:05<00:00,  9.25s/it]
2024-04-19 00:24:33,714 [ease.py] => Task 6, Epoch 20/20 => Loss 0.440, Train_accy 90.04
2024-04-19 00:26:04,778 [ease.py] => Task correct: 86.89823278488727
2024-04-19 00:26:04,778 [ease.py] => Task acc: 97.19683120048751
2024-04-19 00:26:04,867 [trainer.py] => No NME accuracy.
2024-04-19 00:26:04,867 [trainer.py] => CNN: {'total': 85.62, '00-19': 75.71, '20-39': 88.41, '40-59': 86.24, '60-79': 87.04, '80-99': 91.82, '100-119': 89.04, '120-139': 80.89, 'old': 86.37, 'new': 80.89}
2024-04-19 00:26:04,867 [trainer.py] => CNN top1 curve: [97.98, 96.04, 92.71, 91.08, 89.39, 86.86, 85.62]
2024-04-19 00:26:04,867 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.7, 99.24, 99.24, 99.01, 98.72]

Average Accuracy (CNN): 91.38285714285713
2024-04-19 00:26:04,867 [trainer.py] => Average Accuracy (CNN): 91.38285714285713 

2024-04-19 00:26:04,867 [trainer.py] => Train Time: 2428.86
2024-04-19 00:26:04,867 [trainer.py] => Test Time: 139.32 

2024-04-19 00:26:04,868 [trainer.py] => All params: 87756290
2024-04-19 00:26:04,869 [trainer.py] => Trainable params: 1189632
2024-04-19 00:26:04,905 [ease.py] => Learning on 140-160

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.958, Train_accy 24.13:   0%|          | 0/20 [00:08<?, ?it/s]
Task 7, Epoch 1/20 => Loss 2.958, Train_accy 24.13:   5%|▌         | 1/20 [00:08<02:41,  8.47s/it]
Task 7, Epoch 2/20 => Loss 2.740, Train_accy 78.48:   5%|▌         | 1/20 [00:17<02:41,  8.47s/it]
Task 7, Epoch 2/20 => Loss 2.740, Train_accy 78.48:  10%|█         | 2/20 [00:17<02:38,  8.78s/it]
Task 7, Epoch 3/20 => Loss 2.229, Train_accy 86.20:  10%|█         | 2/20 [00:26<02:38,  8.78s/it]
Task 7, Epoch 3/20 => Loss 2.229, Train_accy 86.20:  15%|█▌        | 3/20 [00:26<02:33,  9.01s/it]
Task 7, Epoch 4/20 => Loss 1.454, Train_accy 89.35:  15%|█▌        | 3/20 [00:35<02:33,  9.01s/it]
Task 7, Epoch 4/20 => Loss 1.454, Train_accy 89.35:  20%|██        | 4/20 [00:35<02:23,  8.95s/it]
Task 7, Epoch 5/20 => Loss 0.894, Train_accy 91.85:  20%|██        | 4/20 [00:44<02:23,  8.95s/it]
Task 7, Epoch 5/20 => Loss 0.894, Train_accy 91.85:  25%|██▌       | 5/20 [00:44<02:12,  8.83s/it]
Task 7, Epoch 6/20 => Loss 0.582, Train_accy 93.04:  25%|██▌       | 5/20 [00:52<02:12,  8.83s/it]
Task 7, Epoch 6/20 => Loss 0.582, Train_accy 93.04:  30%|███       | 6/20 [00:52<02:01,  8.67s/it]
Task 7, Epoch 7/20 => Loss 0.492, Train_accy 92.50:  30%|███       | 6/20 [01:01<02:01,  8.67s/it]
Task 7, Epoch 7/20 => Loss 0.492, Train_accy 92.50:  35%|███▌      | 7/20 [01:01<01:52,  8.66s/it]
Task 7, Epoch 8/20 => Loss 0.471, Train_accy 92.07:  35%|███▌      | 7/20 [01:09<01:52,  8.66s/it]
Task 7, Epoch 8/20 => Loss 0.471, Train_accy 92.07:  40%|████      | 8/20 [01:09<01:41,  8.46s/it]
Task 7, Epoch 9/20 => Loss 0.414, Train_accy 92.61:  40%|████      | 8/20 [01:17<01:41,  8.46s/it]
Task 7, Epoch 9/20 => Loss 0.414, Train_accy 92.61:  45%|████▌     | 9/20 [01:17<01:34,  8.55s/it]
Task 7, Epoch 10/20 => Loss 0.370, Train_accy 93.48:  45%|████▌     | 9/20 [01:25<01:34,  8.55s/it]
Task 7, Epoch 10/20 => Loss 0.370, Train_accy 93.48:  50%|█████     | 10/20 [01:25<01:23,  8.35s/it]
Task 7, Epoch 11/20 => Loss 0.360, Train_accy 95.22:  50%|█████     | 10/20 [01:34<01:23,  8.35s/it]
Task 7, Epoch 11/20 => Loss 0.360, Train_accy 95.22:  55%|█████▌    | 11/20 [01:34<01:16,  8.53s/it]
Task 7, Epoch 12/20 => Loss 0.349, Train_accy 93.70:  55%|█████▌    | 11/20 [01:44<01:16,  8.53s/it]
Task 7, Epoch 12/20 => Loss 0.349, Train_accy 93.70:  60%|██████    | 12/20 [01:44<01:10,  8.79s/it]
Task 7, Epoch 13/20 => Loss 0.340, Train_accy 93.37:  60%|██████    | 12/20 [01:52<01:10,  8.79s/it]
Task 7, Epoch 13/20 => Loss 0.340, Train_accy 93.37:  65%|██████▌   | 13/20 [01:52<01:00,  8.64s/it]
Task 7, Epoch 14/20 => Loss 0.319, Train_accy 93.15:  65%|██████▌   | 13/20 [02:00<01:00,  8.64s/it]
Task 7, Epoch 14/20 => Loss 0.319, Train_accy 93.15:  70%|███████   | 14/20 [02:00<00:51,  8.59s/it]
Task 7, Epoch 15/20 => Loss 0.343, Train_accy 92.93:  70%|███████   | 14/20 [02:09<00:51,  8.59s/it]
Task 7, Epoch 15/20 => Loss 0.343, Train_accy 92.93:  75%|███████▌  | 15/20 [02:09<00:42,  8.49s/it]
Task 7, Epoch 16/20 => Loss 0.340, Train_accy 93.37:  75%|███████▌  | 15/20 [02:17<00:42,  8.49s/it]
Task 7, Epoch 16/20 => Loss 0.340, Train_accy 93.37:  80%|████████  | 16/20 [02:17<00:33,  8.41s/it]
Task 7, Epoch 17/20 => Loss 0.311, Train_accy 94.89:  80%|████████  | 16/20 [02:25<00:33,  8.41s/it]
Task 7, Epoch 17/20 => Loss 0.311, Train_accy 94.89:  85%|████████▌ | 17/20 [02:25<00:24,  8.24s/it]
Task 7, Epoch 18/20 => Loss 0.314, Train_accy 92.93:  85%|████████▌ | 17/20 [02:34<00:24,  8.24s/it]
Task 7, Epoch 18/20 => Loss 0.314, Train_accy 92.93:  90%|█████████ | 18/20 [02:34<00:16,  8.44s/it]
Task 7, Epoch 19/20 => Loss 0.277, Train_accy 94.46:  90%|█████████ | 18/20 [02:43<00:16,  8.44s/it]
Task 7, Epoch 19/20 => Loss 0.277, Train_accy 94.46:  95%|█████████▌| 19/20 [02:43<00:08,  8.63s/it]
Task 7, Epoch 20/20 => Loss 0.328, Train_accy 93.91:  95%|█████████▌| 19/20 [02:53<00:08,  8.63s/it]
Task 7, Epoch 20/20 => Loss 0.328, Train_accy 93.91: 100%|██████████| 20/20 [02:53<00:00,  9.11s/it]
Task 7, Epoch 20/20 => Loss 0.328, Train_accy 93.91: 100%|██████████| 20/20 [02:53<00:00,  8.68s/it]
2024-04-19 00:28:58,432 [ease.py] => Task 7, Epoch 20/20 => Loss 0.328, Train_accy 93.91
2024-04-19 00:30:43,831 [ease.py] => Task correct: 85.77472236911687
2024-04-19 00:30:43,832 [ease.py] => Task acc: 97.40877842411423
2024-04-19 00:30:43,993 [trainer.py] => No NME accuracy.
2024-04-19 00:30:43,994 [trainer.py] => CNN: {'total': 84.61, '00-19': 73.28, '20-39': 86.47, '40-59': 80.73, '60-79': 86.23, '80-99': 90.33, '100-119': 86.84, '120-139': 80.44, '140-159': 91.6, 'old': 83.55, 'new': 91.6}
2024-04-19 00:30:43,994 [trainer.py] => CNN top1 curve: [97.98, 96.04, 92.71, 91.08, 89.39, 86.86, 85.62, 84.61]
2024-04-19 00:30:43,994 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.7, 99.24, 99.24, 99.01, 98.72, 98.73]

Average Accuracy (CNN): 90.53625
2024-04-19 00:30:43,994 [trainer.py] => Average Accuracy (CNN): 90.53625 

2024-04-19 00:30:43,994 [trainer.py] => Train Time: 2775.89
2024-04-19 00:30:43,994 [trainer.py] => Test Time: 203.95 

2024-04-19 00:30:43,995 [trainer.py] => All params: 87986690
2024-04-19 00:30:43,996 [trainer.py] => Trainable params: 1189632
2024-04-19 00:30:44,011 [ease.py] => Learning on 160-180

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.952, Train_accy 28.29:   0%|          | 0/20 [00:08<?, ?it/s]
Task 8, Epoch 1/20 => Loss 2.952, Train_accy 28.29:   5%|▌         | 1/20 [00:08<02:46,  8.78s/it]
Task 8, Epoch 2/20 => Loss 2.729, Train_accy 73.49:   5%|▌         | 1/20 [00:18<02:46,  8.78s/it]
Task 8, Epoch 2/20 => Loss 2.729, Train_accy 73.49:  10%|█         | 2/20 [00:18<02:47,  9.30s/it]
Task 8, Epoch 3/20 => Loss 2.184, Train_accy 85.28:  10%|█         | 2/20 [00:28<02:47,  9.30s/it]
Task 8, Epoch 3/20 => Loss 2.184, Train_accy 85.28:  15%|█▌        | 3/20 [00:28<02:40,  9.44s/it]
Task 8, Epoch 4/20 => Loss 1.412, Train_accy 90.81:  15%|█▌        | 3/20 [00:37<02:40,  9.44s/it]
Task 8, Epoch 4/20 => Loss 1.412, Train_accy 90.81:  20%|██        | 4/20 [00:37<02:33,  9.59s/it]
Task 8, Epoch 5/20 => Loss 0.850, Train_accy 91.44:  20%|██        | 4/20 [00:47<02:33,  9.59s/it]
Task 8, Epoch 5/20 => Loss 0.850, Train_accy 91.44:  25%|██▌       | 5/20 [00:47<02:24,  9.64s/it]
Task 8, Epoch 6/20 => Loss 0.627, Train_accy 91.13:  25%|██▌       | 5/20 [00:57<02:24,  9.64s/it]
Task 8, Epoch 6/20 => Loss 0.627, Train_accy 91.13:  30%|███       | 6/20 [00:57<02:16,  9.72s/it]
Task 8, Epoch 7/20 => Loss 0.486, Train_accy 93.22:  30%|███       | 6/20 [01:05<02:16,  9.72s/it]
Task 8, Epoch 7/20 => Loss 0.486, Train_accy 93.22:  35%|███▌      | 7/20 [01:05<01:57,  9.06s/it]
Task 8, Epoch 8/20 => Loss 0.419, Train_accy 93.32:  35%|███▌      | 7/20 [01:11<01:57,  9.06s/it]
Task 8, Epoch 8/20 => Loss 0.419, Train_accy 93.32:  40%|████      | 8/20 [01:11<01:39,  8.33s/it]
Task 8, Epoch 9/20 => Loss 0.367, Train_accy 94.15:  40%|████      | 8/20 [01:18<01:39,  8.33s/it]
Task 8, Epoch 9/20 => Loss 0.367, Train_accy 94.15:  45%|████▌     | 9/20 [01:18<01:26,  7.91s/it]
Task 8, Epoch 10/20 => Loss 0.366, Train_accy 93.74:  45%|████▌     | 9/20 [01:25<01:26,  7.91s/it]
Task 8, Epoch 10/20 => Loss 0.366, Train_accy 93.74:  50%|█████     | 10/20 [01:25<01:15,  7.57s/it]
Task 8, Epoch 11/20 => Loss 0.390, Train_accy 92.17:  50%|█████     | 10/20 [01:32<01:15,  7.57s/it]
Task 8, Epoch 11/20 => Loss 0.390, Train_accy 92.17:  55%|█████▌    | 11/20 [01:32<01:06,  7.41s/it]
Task 8, Epoch 12/20 => Loss 0.335, Train_accy 93.01:  55%|█████▌    | 11/20 [01:39<01:06,  7.41s/it]
Task 8, Epoch 12/20 => Loss 0.335, Train_accy 93.01:  60%|██████    | 12/20 [01:39<00:57,  7.23s/it]
Task 8, Epoch 13/20 => Loss 0.322, Train_accy 93.84:  60%|██████    | 12/20 [01:46<00:57,  7.23s/it]
Task 8, Epoch 13/20 => Loss 0.322, Train_accy 93.84:  65%|██████▌   | 13/20 [01:46<00:49,  7.09s/it]
Task 8, Epoch 14/20 => Loss 0.317, Train_accy 94.15:  65%|██████▌   | 13/20 [01:53<00:49,  7.09s/it]
Task 8, Epoch 14/20 => Loss 0.317, Train_accy 94.15:  70%|███████   | 14/20 [01:53<00:42,  7.11s/it]
Task 8, Epoch 15/20 => Loss 0.346, Train_accy 93.42:  70%|███████   | 14/20 [02:00<00:42,  7.11s/it]
Task 8, Epoch 15/20 => Loss 0.346, Train_accy 93.42:  75%|███████▌  | 15/20 [02:00<00:35,  7.07s/it]
Task 8, Epoch 16/20 => Loss 0.300, Train_accy 94.26:  75%|███████▌  | 15/20 [02:07<00:35,  7.07s/it]
Task 8, Epoch 16/20 => Loss 0.300, Train_accy 94.26:  80%|████████  | 16/20 [02:07<00:27,  6.97s/it]
Task 8, Epoch 17/20 => Loss 0.321, Train_accy 93.22:  80%|████████  | 16/20 [02:14<00:27,  6.97s/it]
Task 8, Epoch 17/20 => Loss 0.321, Train_accy 93.22:  85%|████████▌ | 17/20 [02:14<00:20,  6.97s/it]
Task 8, Epoch 18/20 => Loss 0.305, Train_accy 93.74:  85%|████████▌ | 17/20 [02:21<00:20,  6.97s/it]
Task 8, Epoch 18/20 => Loss 0.305, Train_accy 93.74:  90%|█████████ | 18/20 [02:21<00:13,  6.92s/it]
Task 8, Epoch 19/20 => Loss 0.325, Train_accy 93.22:  90%|█████████ | 18/20 [02:27<00:13,  6.92s/it]
Task 8, Epoch 19/20 => Loss 0.325, Train_accy 93.22:  95%|█████████▌| 19/20 [02:27<00:06,  6.83s/it]
Task 8, Epoch 20/20 => Loss 0.316, Train_accy 92.59:  95%|█████████▌| 19/20 [02:34<00:06,  6.83s/it]
Task 8, Epoch 20/20 => Loss 0.316, Train_accy 92.59: 100%|██████████| 20/20 [02:34<00:00,  6.83s/it]
Task 8, Epoch 20/20 => Loss 0.316, Train_accy 92.59: 100%|██████████| 20/20 [02:34<00:00,  7.72s/it]
2024-04-19 00:33:18,485 [ease.py] => Task 8, Epoch 20/20 => Loss 0.316, Train_accy 92.59
2024-04-19 00:34:56,212 [ease.py] => Task correct: 85.85526315789474
2024-04-19 00:34:56,212 [ease.py] => Task acc: 97.41541353383458
2024-04-19 00:34:56,399 [trainer.py] => No NME accuracy.
2024-04-19 00:34:56,399 [trainer.py] => CNN: {'total': 84.73, '00-19': 74.49, '20-39': 86.47, '40-59': 81.65, '60-79': 85.02, '80-99': 89.96, '100-119': 87.28, '120-139': 80.0, '140-159': 90.0, '160-179': 86.92, 'old': 84.45, 'new': 86.92}
2024-04-19 00:34:56,399 [trainer.py] => CNN top1 curve: [97.98, 96.04, 92.71, 91.08, 89.39, 86.86, 85.62, 84.61, 84.73]
2024-04-19 00:34:56,399 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.7, 99.24, 99.24, 99.01, 98.72, 98.73, 98.4]

Average Accuracy (CNN): 89.89111111111112
2024-04-19 00:34:56,399 [trainer.py] => Average Accuracy (CNN): 89.89111111111112 

2024-04-19 00:34:56,399 [trainer.py] => Train Time: 3084.8199999999997
2024-04-19 00:34:56,399 [trainer.py] => Test Time: 264.71999999999997 

2024-04-19 00:34:56,400 [trainer.py] => All params: 88247810
2024-04-19 00:34:56,401 [trainer.py] => Trainable params: 1189632
2024-04-19 00:34:56,414 [ease.py] => Learning on 180-200

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.943, Train_accy 32.77:   0%|          | 0/20 [00:07<?, ?it/s]
Task 9, Epoch 1/20 => Loss 2.943, Train_accy 32.77:   5%|▌         | 1/20 [00:07<02:16,  7.19s/it]
Task 9, Epoch 2/20 => Loss 2.684, Train_accy 84.03:   5%|▌         | 1/20 [00:13<02:16,  7.19s/it]
Task 9, Epoch 2/20 => Loss 2.684, Train_accy 84.03:  10%|█         | 2/20 [00:13<02:05,  6.96s/it]
Task 9, Epoch 3/20 => Loss 2.073, Train_accy 87.82:  10%|█         | 2/20 [00:21<02:05,  6.96s/it]
Task 9, Epoch 3/20 => Loss 2.073, Train_accy 87.82:  15%|█▌        | 3/20 [00:21<01:58,  6.99s/it]
Task 9, Epoch 4/20 => Loss 1.263, Train_accy 90.65:  15%|█▌        | 3/20 [00:27<01:58,  6.99s/it]
Task 9, Epoch 4/20 => Loss 1.263, Train_accy 90.65:  20%|██        | 4/20 [00:27<01:49,  6.83s/it]
Task 9, Epoch 5/20 => Loss 0.794, Train_accy 89.81:  20%|██        | 4/20 [00:34<01:49,  6.83s/it]
Task 9, Epoch 5/20 => Loss 0.794, Train_accy 89.81:  25%|██▌       | 5/20 [00:34<01:43,  6.88s/it]
Task 9, Epoch 6/20 => Loss 0.519, Train_accy 93.70:  25%|██▌       | 5/20 [00:41<01:43,  6.88s/it]
Task 9, Epoch 6/20 => Loss 0.519, Train_accy 93.70:  30%|███       | 6/20 [00:41<01:35,  6.83s/it]
Task 9, Epoch 7/20 => Loss 0.473, Train_accy 91.49:  30%|███       | 6/20 [00:47<01:35,  6.83s/it]
Task 9, Epoch 7/20 => Loss 0.473, Train_accy 91.49:  35%|███▌      | 7/20 [00:47<01:28,  6.79s/it]
Task 9, Epoch 8/20 => Loss 0.383, Train_accy 93.49:  35%|███▌      | 7/20 [00:54<01:28,  6.79s/it]
Task 9, Epoch 8/20 => Loss 0.383, Train_accy 93.49:  40%|████      | 8/20 [00:54<01:21,  6.80s/it]
Task 9, Epoch 9/20 => Loss 0.386, Train_accy 92.23:  40%|████      | 8/20 [01:01<01:21,  6.80s/it]
Task 9, Epoch 9/20 => Loss 0.386, Train_accy 92.23:  45%|████▌     | 9/20 [01:01<01:14,  6.79s/it]
Task 9, Epoch 10/20 => Loss 0.341, Train_accy 93.59:  45%|████▌     | 9/20 [01:09<01:14,  6.79s/it]
Task 9, Epoch 10/20 => Loss 0.341, Train_accy 93.59:  50%|█████     | 10/20 [01:09<01:10,  7.05s/it]
Task 9, Epoch 11/20 => Loss 0.337, Train_accy 93.38:  50%|█████     | 10/20 [01:18<01:10,  7.05s/it]
Task 9, Epoch 11/20 => Loss 0.337, Train_accy 93.38:  55%|█████▌    | 11/20 [01:18<01:10,  7.81s/it]
Task 9, Epoch 12/20 => Loss 0.361, Train_accy 92.23:  55%|█████▌    | 11/20 [01:27<01:10,  7.81s/it]
Task 9, Epoch 12/20 => Loss 0.361, Train_accy 92.23:  60%|██████    | 12/20 [01:27<01:04,  8.07s/it]
Task 9, Epoch 13/20 => Loss 0.318, Train_accy 94.12:  60%|██████    | 12/20 [01:36<01:04,  8.07s/it]
Task 9, Epoch 13/20 => Loss 0.318, Train_accy 94.12:  65%|██████▌   | 13/20 [01:36<00:59,  8.51s/it]
Task 9, Epoch 14/20 => Loss 0.321, Train_accy 93.17:  65%|██████▌   | 13/20 [01:46<00:59,  8.51s/it]
Task 9, Epoch 14/20 => Loss 0.321, Train_accy 93.17:  70%|███████   | 14/20 [01:46<00:52,  8.75s/it]
Task 9, Epoch 15/20 => Loss 0.325, Train_accy 93.49:  70%|███████   | 14/20 [01:55<00:52,  8.75s/it]
Task 9, Epoch 15/20 => Loss 0.325, Train_accy 93.49:  75%|███████▌  | 15/20 [01:55<00:44,  8.88s/it]
Task 9, Epoch 16/20 => Loss 0.315, Train_accy 93.17:  75%|███████▌  | 15/20 [02:03<00:44,  8.88s/it]
Task 9, Epoch 16/20 => Loss 0.315, Train_accy 93.17:  80%|████████  | 16/20 [02:03<00:35,  8.77s/it]
Task 9, Epoch 17/20 => Loss 0.314, Train_accy 93.70:  80%|████████  | 16/20 [02:14<00:35,  8.77s/it]
Task 9, Epoch 17/20 => Loss 0.314, Train_accy 93.70:  85%|████████▌ | 17/20 [02:14<00:27,  9.31s/it]
Task 9, Epoch 18/20 => Loss 0.262, Train_accy 94.96:  85%|████████▌ | 17/20 [02:24<00:27,  9.31s/it]
Task 9, Epoch 18/20 => Loss 0.262, Train_accy 94.96:  90%|█████████ | 18/20 [02:24<00:18,  9.39s/it]
Task 9, Epoch 19/20 => Loss 0.313, Train_accy 93.49:  90%|█████████ | 18/20 [02:32<00:18,  9.39s/it]
Task 9, Epoch 19/20 => Loss 0.313, Train_accy 93.49:  95%|█████████▌| 19/20 [02:32<00:09,  9.20s/it]
Task 9, Epoch 20/20 => Loss 0.292, Train_accy 94.01:  95%|█████████▌| 19/20 [02:42<00:09,  9.20s/it]
Task 9, Epoch 20/20 => Loss 0.292, Train_accy 94.01: 100%|██████████| 20/20 [02:42<00:00,  9.39s/it]
Task 9, Epoch 20/20 => Loss 0.292, Train_accy 94.01: 100%|██████████| 20/20 [02:42<00:00,  8.13s/it]
2024-04-19 00:37:39,096 [ease.py] => Task 9, Epoch 20/20 => Loss 0.292, Train_accy 94.01
2024-04-19 00:40:15,024 [ease.py] => Task correct: 83.96946564885496
2024-04-19 00:40:15,025 [ease.py] => Task acc: 97.32824427480917
2024-04-19 00:40:15,377 [trainer.py] => No NME accuracy.
2024-04-19 00:40:15,377 [trainer.py] => CNN: {'total': 83.04, '00-19': 73.28, '20-39': 82.13, '40-59': 81.65, '60-79': 78.54, '80-99': 87.36, '100-119': 87.28, '120-139': 75.56, '140-159': 89.6, '160-179': 85.23, '180-199': 89.13, 'old': 82.38, 'new': 89.13}
2024-04-19 00:40:15,377 [trainer.py] => CNN top1 curve: [97.98, 96.04, 92.71, 91.08, 89.39, 86.86, 85.62, 84.61, 84.73, 83.04]
2024-04-19 00:40:15,378 [trainer.py] => CNN top5 curve: [100.0, 99.78, 99.7, 99.24, 99.24, 99.01, 98.72, 98.73, 98.4, 98.22]

Average Accuracy (CNN): 89.20599999999999
2024-04-19 00:40:15,378 [trainer.py] => Average Accuracy (CNN): 89.20599999999999 

2024-04-19 00:40:15,378 [trainer.py] => Train Time: 3410.1699999999996
2024-04-19 00:40:15,378 [trainer.py] => Test Time: 364.79999999999995 

Accuracy Matrix (CNN):
[[97.98 94.74 88.26 84.62 78.14 76.52 75.71 73.28 74.49 73.28]
 [ 0.   97.58 96.14 92.75 87.44 87.92 88.41 86.47 86.47 82.13]
 [ 0.    0.   94.5  92.2  92.2  87.61 86.24 80.73 81.65 81.65]
 [ 0.    0.    0.   95.14 93.93 87.85 87.04 86.23 85.02 78.54]
 [ 0.    0.    0.    0.   94.8  92.19 91.82 90.33 89.96 87.36]
 [ 0.    0.    0.    0.    0.   89.04 89.04 86.84 87.28 87.28]
 [ 0.    0.    0.    0.    0.    0.   80.89 80.44 80.   75.56]
 [ 0.    0.    0.    0.    0.    0.    0.   91.6  90.   89.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   86.92 85.23]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   89.13]]
2024-04-19 00:40:15,379 [trainer.py] => Forgetting (CNN): 9.757777777777777


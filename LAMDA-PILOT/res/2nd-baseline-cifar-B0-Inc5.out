nohup: 忽略输入
2024-04-26 19:38:43,923 [trainer.py] => config: ./exps/finetune_cifar_B0_Inc5.json
2024-04-26 19:38:43,923 [trainer.py] => prefix: reproduce
2024-04-26 19:38:43,923 [trainer.py] => dataset: cifar224
2024-04-26 19:38:43,923 [trainer.py] => memory_size: 0
2024-04-26 19:38:43,923 [trainer.py] => memory_per_class: 0
2024-04-26 19:38:43,923 [trainer.py] => fixed_memory: False
2024-04-26 19:38:43,923 [trainer.py] => shuffle: True
2024-04-26 19:38:43,923 [trainer.py] => init_cls: 20
2024-04-26 19:38:43,923 [trainer.py] => increment: 20
2024-04-26 19:38:43,923 [trainer.py] => model_name: finetune
2024-04-26 19:38:43,923 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-26 19:38:43,923 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-26 19:38:43,924 [trainer.py] => seed: 1993
2024-04-26 19:38:43,924 [trainer.py] => init_epoch: 20
2024-04-26 19:38:43,924 [trainer.py] => init_lr: 0.001
2024-04-26 19:38:43,924 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-26 19:38:43,924 [trainer.py] => init_lr_decay: 0.1
2024-04-26 19:38:43,924 [trainer.py] => init_weight_decay: 0.0005
2024-04-26 19:38:43,924 [trainer.py] => epochs: 20
2024-04-26 19:38:43,924 [trainer.py] => lrate: 0.001
2024-04-26 19:38:43,924 [trainer.py] => milestones: [40, 70]
2024-04-26 19:38:43,924 [trainer.py] => lrate_decay: 0.1
2024-04-26 19:38:43,924 [trainer.py] => batch_size: 48
2024-04-26 19:38:43,924 [trainer.py] => weight_decay: 0.0002
Files already downloaded and verified
Files already downloaded and verified
2024-04-26 19:38:45,711 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-26 19:38:47,484 [trainer.py] => All params: 85798656
2024-04-26 19:38:47,485 [trainer.py] => Trainable params: 85798656
2024-04-26 19:38:47,485 [finetune.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.766, Train_accy 16.23, Test_accy 64.45:   0%|          | 0/20 [01:11<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.766, Train_accy 16.23, Test_accy 64.45:   5%|▌         | 1/20 [01:11<22:42, 71.70s/it]Task 0, Epoch 2/20 => Loss 0.851, Train_accy 74.68:   5%|▌         | 1/20 [02:18<22:42, 71.70s/it]                 Task 0, Epoch 2/20 => Loss 0.851, Train_accy 74.68:  10%|█         | 2/20 [02:18<20:40, 68.91s/it]Task 0, Epoch 3/20 => Loss 0.566, Train_accy 83.02:  10%|█         | 2/20 [03:25<20:40, 68.91s/it]Task 0, Epoch 3/20 => Loss 0.566, Train_accy 83.02:  15%|█▌        | 3/20 [03:25<19:17, 68.09s/it]Task 0, Epoch 4/20 => Loss 0.493, Train_accy 85.22:  15%|█▌        | 3/20 [04:33<19:17, 68.09s/it]Task 0, Epoch 4/20 => Loss 0.493, Train_accy 85.22:  20%|██        | 4/20 [04:33<18:04, 67.76s/it]Task 0, Epoch 5/20 => Loss 0.423, Train_accy 87.47:  20%|██        | 4/20 [05:40<18:04, 67.76s/it]Task 0, Epoch 5/20 => Loss 0.423, Train_accy 87.47:  25%|██▌       | 5/20 [05:40<16:53, 67.59s/it]Task 0, Epoch 6/20 => Loss 0.433, Train_accy 86.91, Test_accy 95.40:  25%|██▌       | 5/20 [06:53<16:53, 67.59s/it]Task 0, Epoch 6/20 => Loss 0.433, Train_accy 86.91, Test_accy 95.40:  30%|███       | 6/20 [06:53<16:10, 69.33s/it]Task 0, Epoch 7/20 => Loss 0.398, Train_accy 88.01:  30%|███       | 6/20 [08:00<16:10, 69.33s/it]                 Task 0, Epoch 7/20 => Loss 0.398, Train_accy 88.01:  35%|███▌      | 7/20 [08:00<14:52, 68.67s/it]Task 0, Epoch 8/20 => Loss 0.374, Train_accy 88.76:  35%|███▌      | 7/20 [09:07<14:52, 68.67s/it]Task 0, Epoch 8/20 => Loss 0.374, Train_accy 88.76:  40%|████      | 8/20 [09:07<13:38, 68.23s/it]Task 0, Epoch 9/20 => Loss 0.359, Train_accy 89.34:  40%|████      | 8/20 [10:15<13:38, 68.23s/it]Task 0, Epoch 9/20 => Loss 0.359, Train_accy 89.34:  45%|████▌     | 9/20 [10:15<12:27, 67.98s/it]Task 0, Epoch 10/20 => Loss 0.334, Train_accy 89.84:  45%|████▌     | 9/20 [11:22<12:27, 67.98s/it]Task 0, Epoch 10/20 => Loss 0.334, Train_accy 89.84:  50%|█████     | 10/20 [11:22<11:17, 67.78s/it]Task 0, Epoch 11/20 => Loss 0.318, Train_accy 90.33, Test_accy 97.00:  50%|█████     | 10/20 [12:35<11:17, 67.78s/it]Task 0, Epoch 11/20 => Loss 0.318, Train_accy 90.33, Test_accy 97.00:  55%|█████▌    | 11/20 [12:35<10:23, 69.27s/it]Task 0, Epoch 12/20 => Loss 0.314, Train_accy 90.61:  55%|█████▌    | 11/20 [13:42<10:23, 69.27s/it]                 Task 0, Epoch 12/20 => Loss 0.314, Train_accy 90.61:  60%|██████    | 12/20 [13:42<09:08, 68.62s/it]Task 0, Epoch 13/20 => Loss 0.296, Train_accy 91.21:  60%|██████    | 12/20 [14:49<09:08, 68.62s/it]Task 0, Epoch 13/20 => Loss 0.296, Train_accy 91.21:  65%|██████▌   | 13/20 [14:49<07:57, 68.17s/it]Task 0, Epoch 14/20 => Loss 0.298, Train_accy 90.98:  65%|██████▌   | 13/20 [15:56<07:57, 68.17s/it]Task 0, Epoch 14/20 => Loss 0.298, Train_accy 90.98:  70%|███████   | 14/20 [15:56<06:47, 67.94s/it]Task 0, Epoch 15/20 => Loss 0.300, Train_accy 91.03:  70%|███████   | 14/20 [17:03<06:47, 67.94s/it]Task 0, Epoch 15/20 => Loss 0.300, Train_accy 91.03:  75%|███████▌  | 15/20 [17:03<05:38, 67.69s/it]Task 0, Epoch 16/20 => Loss 0.291, Train_accy 91.20, Test_accy 95.85:  75%|███████▌  | 15/20 [18:16<05:38, 67.69s/it]Task 0, Epoch 16/20 => Loss 0.291, Train_accy 91.20, Test_accy 95.85:  80%|████████  | 16/20 [18:16<04:36, 69.15s/it]Task 0, Epoch 17/20 => Loss 0.284, Train_accy 91.67:  80%|████████  | 16/20 [19:23<04:36, 69.15s/it]                 Task 0, Epoch 17/20 => Loss 0.284, Train_accy 91.67:  85%|████████▌ | 17/20 [19:23<03:25, 68.59s/it]Task 0, Epoch 18/20 => Loss 0.275, Train_accy 91.59:  85%|████████▌ | 17/20 [20:30<03:25, 68.59s/it]Task 0, Epoch 18/20 => Loss 0.275, Train_accy 91.59:  90%|█████████ | 18/20 [20:30<02:16, 68.15s/it]Task 0, Epoch 19/20 => Loss 0.264, Train_accy 92.03:  90%|█████████ | 18/20 [21:37<02:16, 68.15s/it]Task 0, Epoch 19/20 => Loss 0.264, Train_accy 92.03:  95%|█████████▌| 19/20 [21:37<01:07, 67.84s/it]Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.75:  95%|█████████▌| 19/20 [22:45<01:07, 67.84s/it]Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.75: 100%|██████████| 20/20 [22:45<00:00, 67.63s/it]Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.75: 100%|██████████| 20/20 [22:45<00:00, 68.25s/it]
2024-04-26 20:01:33,024 [finetune.py] => Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.75
2024-04-26 20:01:38,389 [trainer.py] => No NME accuracy.
2024-04-26 20:01:38,390 [trainer.py] => CNN: {'total': 95.1, '00-19': 95.1, 'old': 0, 'new': 95.1}
2024-04-26 20:01:38,390 [trainer.py] => CNN top1 curve: [95.1]
2024-04-26 20:01:38,390 [trainer.py] => CNN top5 curve: [99.7]

Average Accuracy (CNN): 95.1
2024-04-26 20:01:38,390 [trainer.py] => Average Accuracy (CNN): 95.1 

2024-04-26 20:01:38,390 [trainer.py] => Train Time: 2730.55
2024-04-26 20:01:38,391 [trainer.py] => Test Time: 5.36 

2024-04-26 20:01:38,392 [trainer.py] => All params: 85814036
2024-04-26 20:01:38,393 [trainer.py] => Trainable params: 85814036
2024-04-26 20:01:38,394 [finetune.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.666, Train_accy 54.75, Test_accy 87.30:   0%|          | 0/20 [01:17<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.666, Train_accy 54.75, Test_accy 87.30:   5%|▌         | 1/20 [01:17<24:34, 77.59s/it]Task 1, Epoch 2/20 => Loss 0.371, Train_accy 75.75:   5%|▌         | 1/20 [02:24<24:34, 77.59s/it]                 Task 1, Epoch 2/20 => Loss 0.371, Train_accy 75.75:  10%|█         | 2/20 [02:24<21:24, 71.39s/it]Task 1, Epoch 3/20 => Loss 0.346, Train_accy 81.82:  10%|█         | 2/20 [03:31<21:24, 71.39s/it]Task 1, Epoch 3/20 => Loss 0.346, Train_accy 81.82:  15%|█▌        | 3/20 [03:31<19:40, 69.43s/it]Task 1, Epoch 4/20 => Loss 0.299, Train_accy 84.56:  15%|█▌        | 3/20 [04:38<19:40, 69.43s/it]Task 1, Epoch 4/20 => Loss 0.299, Train_accy 84.56:  20%|██        | 4/20 [04:38<18:16, 68.52s/it]Task 1, Epoch 5/20 => Loss 0.303, Train_accy 86.38:  20%|██        | 4/20 [05:46<18:16, 68.52s/it]Task 1, Epoch 5/20 => Loss 0.303, Train_accy 86.38:  25%|██▌       | 5/20 [05:46<17:03, 68.23s/it]Task 1, Epoch 6/20 => Loss 0.278, Train_accy 88.01, Test_accy 90.75:  25%|██▌       | 5/20 [07:04<17:03, 68.23s/it]Task 1, Epoch 6/20 => Loss 0.278, Train_accy 88.01, Test_accy 90.75:  30%|███       | 6/20 [07:04<16:42, 71.62s/it]Task 1, Epoch 7/20 => Loss 0.276, Train_accy 88.44:  30%|███       | 6/20 [08:12<16:42, 71.62s/it]                 Task 1, Epoch 7/20 => Loss 0.276, Train_accy 88.44:  35%|███▌      | 7/20 [08:12<15:14, 70.37s/it]Task 1, Epoch 8/20 => Loss 0.267, Train_accy 88.42:  35%|███▌      | 7/20 [09:20<15:14, 70.37s/it]Task 1, Epoch 8/20 => Loss 0.267, Train_accy 88.42:  40%|████      | 8/20 [09:20<13:53, 69.47s/it]Task 1, Epoch 9/20 => Loss 0.257, Train_accy 89.52:  40%|████      | 8/20 [10:27<13:53, 69.47s/it]Task 1, Epoch 9/20 => Loss 0.257, Train_accy 89.52:  45%|████▌     | 9/20 [10:27<12:36, 68.82s/it]Task 1, Epoch 10/20 => Loss 0.234, Train_accy 90.39:  45%|████▌     | 9/20 [11:34<12:36, 68.82s/it]Task 1, Epoch 10/20 => Loss 0.234, Train_accy 90.39:  50%|█████     | 10/20 [11:34<11:23, 68.31s/it]Task 1, Epoch 11/20 => Loss 0.240, Train_accy 90.31, Test_accy 88.02:  50%|█████     | 10/20 [12:52<11:23, 68.31s/it]Task 1, Epoch 11/20 => Loss 0.240, Train_accy 90.31, Test_accy 88.02:  55%|█████▌    | 11/20 [12:52<10:41, 71.23s/it]Task 1, Epoch 12/20 => Loss 0.243, Train_accy 90.48:  55%|█████▌    | 11/20 [13:59<10:41, 71.23s/it]                 Task 1, Epoch 12/20 => Loss 0.243, Train_accy 90.48:  60%|██████    | 12/20 [13:59<09:20, 70.09s/it]Task 1, Epoch 13/20 => Loss 0.228, Train_accy 91.47:  60%|██████    | 12/20 [15:07<09:20, 70.09s/it]Task 1, Epoch 13/20 => Loss 0.228, Train_accy 91.47:  65%|██████▌   | 13/20 [15:07<08:05, 69.38s/it]Task 1, Epoch 14/20 => Loss 0.217, Train_accy 91.56:  65%|██████▌   | 13/20 [16:15<08:05, 69.38s/it]Task 1, Epoch 14/20 => Loss 0.217, Train_accy 91.56:  70%|███████   | 14/20 [16:15<06:52, 68.79s/it]Task 1, Epoch 15/20 => Loss 0.212, Train_accy 91.88:  70%|███████   | 14/20 [17:22<06:52, 68.79s/it]Task 1, Epoch 15/20 => Loss 0.212, Train_accy 91.88:  75%|███████▌  | 15/20 [17:22<05:42, 68.43s/it]Task 1, Epoch 16/20 => Loss 0.218, Train_accy 92.02, Test_accy 86.18:  75%|███████▌  | 15/20 [18:40<05:42, 68.43s/it]Task 1, Epoch 16/20 => Loss 0.218, Train_accy 92.02, Test_accy 86.18:  80%|████████  | 16/20 [18:40<04:45, 71.27s/it]Task 1, Epoch 17/20 => Loss 0.216, Train_accy 92.04:  80%|████████  | 16/20 [19:48<04:45, 71.27s/it]                 Task 1, Epoch 17/20 => Loss 0.216, Train_accy 92.04:  85%|████████▌ | 17/20 [19:48<03:30, 70.22s/it]Task 1, Epoch 18/20 => Loss 0.205, Train_accy 92.49:  85%|████████▌ | 17/20 [20:55<03:30, 70.22s/it]Task 1, Epoch 18/20 => Loss 0.205, Train_accy 92.49:  90%|█████████ | 18/20 [20:55<02:18, 69.38s/it]Task 1, Epoch 19/20 => Loss 0.202, Train_accy 92.65:  90%|█████████ | 18/20 [22:03<02:18, 69.38s/it]Task 1, Epoch 19/20 => Loss 0.202, Train_accy 92.65:  95%|█████████▌| 19/20 [22:03<01:08, 68.78s/it]Task 1, Epoch 20/20 => Loss 0.217, Train_accy 92.84:  95%|█████████▌| 19/20 [23:10<01:08, 68.78s/it]Task 1, Epoch 20/20 => Loss 0.217, Train_accy 92.84: 100%|██████████| 20/20 [23:10<00:00, 68.37s/it]Task 1, Epoch 20/20 => Loss 0.217, Train_accy 92.84: 100%|██████████| 20/20 [23:10<00:00, 69.53s/it]
2024-04-26 20:24:49,045 [finetune.py] => Task 1, Epoch 20/20 => Loss 0.217, Train_accy 92.84
2024-04-26 20:24:59,515 [trainer.py] => No NME accuracy.
2024-04-26 20:24:59,516 [trainer.py] => CNN: {'total': 83.85, '00-19': 70.4, '20-39': 97.3, 'old': 70.4, 'new': 97.3}
2024-04-26 20:24:59,516 [trainer.py] => CNN top1 curve: [95.1, 83.85]
2024-04-26 20:24:59,516 [trainer.py] => CNN top5 curve: [99.7, 98.68]

Average Accuracy (CNN): 89.48
2024-04-26 20:24:59,516 [trainer.py] => Average Accuracy (CNN): 89.48 

2024-04-26 20:24:59,517 [trainer.py] => Train Time: 4121.17
2024-04-26 20:24:59,517 [trainer.py] => Test Time: 15.830000000000002 

2024-04-26 20:24:59,518 [trainer.py] => All params: 85829416
2024-04-26 20:24:59,520 [trainer.py] => Trainable params: 85829416
2024-04-26 20:24:59,522 [finetune.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.718, Train_accy 45.80, Test_accy 82.10:   0%|          | 0/20 [01:22<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.718, Train_accy 45.80, Test_accy 82.10:   5%|▌         | 1/20 [01:22<26:14, 82.88s/it]Task 2, Epoch 2/20 => Loss 0.403, Train_accy 67.48:   5%|▌         | 1/20 [02:30<26:14, 82.88s/it]                 Task 2, Epoch 2/20 => Loss 0.403, Train_accy 67.48:  10%|█         | 2/20 [02:30<22:06, 73.72s/it]Task 2, Epoch 3/20 => Loss 0.339, Train_accy 75.26:  10%|█         | 2/20 [03:37<22:06, 73.72s/it]Task 2, Epoch 3/20 => Loss 0.339, Train_accy 75.26:  15%|█▌        | 3/20 [03:37<20:03, 70.78s/it]Task 2, Epoch 4/20 => Loss 0.329, Train_accy 78.73:  15%|█▌        | 3/20 [04:44<20:03, 70.78s/it]Task 2, Epoch 4/20 => Loss 0.329, Train_accy 78.73:  20%|██        | 4/20 [04:44<18:29, 69.33s/it]Task 2, Epoch 5/20 => Loss 0.325, Train_accy 81.48:  20%|██        | 4/20 [05:51<18:29, 69.33s/it]Task 2, Epoch 5/20 => Loss 0.325, Train_accy 81.48:  25%|██▌       | 5/20 [05:51<17:07, 68.53s/it]Task 2, Epoch 6/20 => Loss 0.294, Train_accy 83.48, Test_accy 83.87:  25%|██▌       | 5/20 [07:14<17:07, 68.53s/it]Task 2, Epoch 6/20 => Loss 0.294, Train_accy 83.48, Test_accy 83.87:  30%|███       | 6/20 [07:14<17:07, 73.42s/it]Task 2, Epoch 7/20 => Loss 0.284, Train_accy 84.44:  30%|███       | 6/20 [08:22<17:07, 73.42s/it]                 Task 2, Epoch 7/20 => Loss 0.284, Train_accy 84.44:  35%|███▌      | 7/20 [08:22<15:29, 71.53s/it]Task 2, Epoch 8/20 => Loss 0.281, Train_accy 85.51:  35%|███▌      | 7/20 [09:29<15:29, 71.53s/it]Task 2, Epoch 8/20 => Loss 0.281, Train_accy 85.51:  40%|████      | 8/20 [09:29<14:01, 70.16s/it]Task 2, Epoch 9/20 => Loss 0.281, Train_accy 86.35:  40%|████      | 8/20 [10:36<14:01, 70.16s/it]Task 2, Epoch 9/20 => Loss 0.281, Train_accy 86.35:  45%|████▌     | 9/20 [10:36<12:42, 69.28s/it]Task 2, Epoch 10/20 => Loss 0.255, Train_accy 88.34:  45%|████▌     | 9/20 [11:44<12:42, 69.28s/it]Task 2, Epoch 10/20 => Loss 0.255, Train_accy 88.34:  50%|█████     | 10/20 [11:44<11:26, 68.66s/it]Task 2, Epoch 11/20 => Loss 0.262, Train_accy 88.27, Test_accy 81.23:  50%|█████     | 10/20 [13:06<11:26, 68.66s/it]Task 2, Epoch 11/20 => Loss 0.262, Train_accy 88.27, Test_accy 81.23:  55%|█████▌    | 11/20 [13:06<10:56, 72.98s/it]Task 2, Epoch 12/20 => Loss 0.245, Train_accy 89.26:  55%|█████▌    | 11/20 [14:14<10:56, 72.98s/it]                 Task 2, Epoch 12/20 => Loss 0.245, Train_accy 89.26:  60%|██████    | 12/20 [14:14<09:30, 71.27s/it]Task 2, Epoch 13/20 => Loss 0.236, Train_accy 89.43:  60%|██████    | 12/20 [15:21<09:30, 71.27s/it]Task 2, Epoch 13/20 => Loss 0.236, Train_accy 89.43:  65%|██████▌   | 13/20 [15:21<08:11, 70.15s/it]Task 2, Epoch 14/20 => Loss 0.232, Train_accy 89.59:  65%|██████▌   | 13/20 [16:28<08:11, 70.15s/it]Task 2, Epoch 14/20 => Loss 0.232, Train_accy 89.59:  70%|███████   | 14/20 [16:28<06:55, 69.25s/it]Task 2, Epoch 15/20 => Loss 0.228, Train_accy 89.69:  70%|███████   | 14/20 [17:36<06:55, 69.25s/it]Task 2, Epoch 15/20 => Loss 0.228, Train_accy 89.69:  75%|███████▌  | 15/20 [17:36<05:43, 68.65s/it]Task 2, Epoch 16/20 => Loss 0.232, Train_accy 89.94, Test_accy 81.87:  75%|███████▌  | 15/20 [18:58<05:43, 68.65s/it]Task 2, Epoch 16/20 => Loss 0.232, Train_accy 89.94, Test_accy 81.87:  80%|████████  | 16/20 [18:58<04:51, 72.87s/it]Task 2, Epoch 17/20 => Loss 0.220, Train_accy 90.61:  80%|████████  | 16/20 [20:06<04:51, 72.87s/it]                 Task 2, Epoch 17/20 => Loss 0.220, Train_accy 90.61:  85%|████████▌ | 17/20 [20:06<03:33, 71.15s/it]Task 2, Epoch 18/20 => Loss 0.215, Train_accy 90.78:  85%|████████▌ | 17/20 [21:13<03:33, 71.15s/it]Task 2, Epoch 18/20 => Loss 0.215, Train_accy 90.78:  90%|█████████ | 18/20 [21:13<02:20, 70.08s/it]Task 2, Epoch 19/20 => Loss 0.222, Train_accy 90.70:  90%|█████████ | 18/20 [22:20<02:20, 70.08s/it]Task 2, Epoch 19/20 => Loss 0.222, Train_accy 90.70:  95%|█████████▌| 19/20 [22:20<01:09, 69.25s/it]Task 2, Epoch 20/20 => Loss 0.231, Train_accy 90.85:  95%|█████████▌| 19/20 [23:28<01:09, 69.25s/it]Task 2, Epoch 20/20 => Loss 0.231, Train_accy 90.85: 100%|██████████| 20/20 [23:28<00:00, 68.63s/it]Task 2, Epoch 20/20 => Loss 0.231, Train_accy 90.85: 100%|██████████| 20/20 [23:28<00:00, 70.41s/it]
2024-04-26 20:48:27,742 [finetune.py] => Task 2, Epoch 20/20 => Loss 0.231, Train_accy 90.85
2024-04-26 20:48:43,301 [trainer.py] => No NME accuracy.
2024-04-26 20:48:43,301 [trainer.py] => CNN: {'total': 80.45, '00-19': 62.3, '20-39': 84.5, '40-59': 94.55, 'old': 73.4, 'new': 94.55}
2024-04-26 20:48:43,301 [trainer.py] => CNN top1 curve: [95.1, 83.85, 80.45]
2024-04-26 20:48:43,301 [trainer.py] => CNN top5 curve: [99.7, 98.68, 98.12]

Average Accuracy (CNN): 86.47
2024-04-26 20:48:43,302 [trainer.py] => Average Accuracy (CNN): 86.47 

2024-04-26 20:48:43,302 [trainer.py] => Train Time: 5529.3
2024-04-26 20:48:43,302 [trainer.py] => Test Time: 31.39 

2024-04-26 20:48:43,303 [trainer.py] => All params: 85844796
2024-04-26 20:48:43,304 [trainer.py] => Trainable params: 85844796
2024-04-26 20:48:43,306 [finetune.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.665, Train_accy 40.52, Test_accy 78.01:   0%|          | 0/20 [01:27<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.665, Train_accy 40.52, Test_accy 78.01:   5%|▌         | 1/20 [01:27<27:51, 87.97s/it]Task 3, Epoch 2/20 => Loss 0.392, Train_accy 64.92:   5%|▌         | 1/20 [02:35<27:51, 87.97s/it]                 Task 3, Epoch 2/20 => Loss 0.392, Train_accy 64.92:  10%|█         | 2/20 [02:35<22:45, 75.88s/it]Task 3, Epoch 3/20 => Loss 0.340, Train_accy 71.75:  10%|█         | 2/20 [03:42<22:45, 75.88s/it]Task 3, Epoch 3/20 => Loss 0.340, Train_accy 71.75:  15%|█▌        | 3/20 [03:42<20:23, 71.95s/it]Task 3, Epoch 4/20 => Loss 0.299, Train_accy 75.54:  15%|█▌        | 3/20 [04:49<20:23, 71.95s/it]Task 3, Epoch 4/20 => Loss 0.299, Train_accy 75.54:  20%|██        | 4/20 [04:49<18:41, 70.11s/it]Task 3, Epoch 5/20 => Loss 0.295, Train_accy 78.09:  20%|██        | 4/20 [05:57<18:41, 70.11s/it]Task 3, Epoch 5/20 => Loss 0.295, Train_accy 78.09:  25%|██▌       | 5/20 [05:57<17:17, 69.15s/it]Task 3, Epoch 6/20 => Loss 0.270, Train_accy 80.46, Test_accy 79.38:  25%|██▌       | 5/20 [07:25<17:17, 69.15s/it]Task 3, Epoch 6/20 => Loss 0.270, Train_accy 80.46, Test_accy 79.38:  30%|███       | 6/20 [07:25<17:40, 75.76s/it]Task 3, Epoch 7/20 => Loss 0.280, Train_accy 81.37:  30%|███       | 6/20 [08:33<17:40, 75.76s/it]                 Task 3, Epoch 7/20 => Loss 0.280, Train_accy 81.37:  35%|███▌      | 7/20 [08:33<15:50, 73.08s/it]Task 3, Epoch 8/20 => Loss 0.255, Train_accy 83.28:  35%|███▌      | 7/20 [09:41<15:50, 73.08s/it]Task 3, Epoch 8/20 => Loss 0.255, Train_accy 83.28:  40%|████      | 8/20 [09:41<14:15, 71.32s/it]Task 3, Epoch 9/20 => Loss 0.249, Train_accy 84.26:  40%|████      | 8/20 [10:48<14:15, 71.32s/it]Task 3, Epoch 9/20 => Loss 0.249, Train_accy 84.26:  45%|████▌     | 9/20 [10:48<12:50, 70.08s/it]Task 3, Epoch 10/20 => Loss 0.235, Train_accy 85.45:  45%|████▌     | 9/20 [11:55<12:50, 70.08s/it]Task 3, Epoch 10/20 => Loss 0.235, Train_accy 85.45:  50%|█████     | 10/20 [11:55<11:32, 69.26s/it]Task 3, Epoch 11/20 => Loss 0.254, Train_accy 84.89, Test_accy 78.64:  50%|█████     | 10/20 [13:23<11:32, 69.26s/it]Task 3, Epoch 11/20 => Loss 0.254, Train_accy 84.89, Test_accy 78.64:  55%|█████▌    | 11/20 [13:23<11:14, 74.98s/it]Task 3, Epoch 12/20 => Loss 0.245, Train_accy 86.18:  55%|█████▌    | 11/20 [14:31<11:14, 74.98s/it]                 Task 3, Epoch 12/20 => Loss 0.245, Train_accy 86.18:  60%|██████    | 12/20 [14:31<09:41, 72.65s/it]Task 3, Epoch 13/20 => Loss 0.218, Train_accy 86.93:  60%|██████    | 12/20 [15:38<09:41, 72.65s/it]Task 3, Epoch 13/20 => Loss 0.218, Train_accy 86.93:  65%|██████▌   | 13/20 [15:38<08:17, 71.05s/it]Task 3, Epoch 14/20 => Loss 0.216, Train_accy 87.80:  65%|██████▌   | 13/20 [16:46<08:17, 71.05s/it]Task 3, Epoch 14/20 => Loss 0.216, Train_accy 87.80:  70%|███████   | 14/20 [16:46<07:00, 70.13s/it]Task 3, Epoch 15/20 => Loss 0.215, Train_accy 87.78:  70%|███████   | 14/20 [17:53<07:00, 70.13s/it]Task 3, Epoch 15/20 => Loss 0.215, Train_accy 87.78:  75%|███████▌  | 15/20 [17:53<05:46, 69.29s/it]Task 3, Epoch 16/20 => Loss 0.215, Train_accy 87.99, Test_accy 76.71:  75%|███████▌  | 15/20 [19:21<05:46, 69.29s/it]Task 3, Epoch 16/20 => Loss 0.215, Train_accy 87.99, Test_accy 76.71:  80%|████████  | 16/20 [19:21<04:59, 74.89s/it]Task 3, Epoch 17/20 => Loss 0.217, Train_accy 88.66:  80%|████████  | 16/20 [20:28<04:59, 74.89s/it]                 Task 3, Epoch 17/20 => Loss 0.217, Train_accy 88.66:  85%|████████▌ | 17/20 [20:28<03:37, 72.58s/it]Task 3, Epoch 18/20 => Loss 0.200, Train_accy 88.95:  85%|████████▌ | 17/20 [21:36<03:37, 72.58s/it]Task 3, Epoch 18/20 => Loss 0.200, Train_accy 88.95:  90%|█████████ | 18/20 [21:36<02:21, 70.99s/it]Task 3, Epoch 19/20 => Loss 0.202, Train_accy 89.04:  90%|█████████ | 18/20 [22:43<02:21, 70.99s/it]Task 3, Epoch 19/20 => Loss 0.202, Train_accy 89.04:  95%|█████████▌| 19/20 [22:43<01:09, 69.95s/it]Task 3, Epoch 20/20 => Loss 0.192, Train_accy 89.71:  95%|█████████▌| 19/20 [23:51<01:09, 69.95s/it]Task 3, Epoch 20/20 => Loss 0.192, Train_accy 89.71: 100%|██████████| 20/20 [23:51<00:00, 69.21s/it]Task 3, Epoch 20/20 => Loss 0.192, Train_accy 89.71: 100%|██████████| 20/20 [23:51<00:00, 71.56s/it]
2024-04-26 21:12:34,596 [finetune.py] => Task 3, Epoch 20/20 => Loss 0.192, Train_accy 89.71
2024-04-26 21:12:55,516 [trainer.py] => No NME accuracy.
2024-04-26 21:12:55,517 [trainer.py] => CNN: {'total': 76.14, '00-19': 58.5, '20-39': 76.35, '40-59': 78.15, '60-79': 91.55, 'old': 71.0, 'new': 91.55}
2024-04-26 21:12:55,517 [trainer.py] => CNN top1 curve: [95.1, 83.85, 80.45, 76.14]
2024-04-26 21:12:55,517 [trainer.py] => CNN top5 curve: [99.7, 98.68, 98.12, 97.09]

Average Accuracy (CNN): 83.88
2024-04-26 21:12:55,517 [trainer.py] => Average Accuracy (CNN): 83.88 

2024-04-26 21:12:55,517 [trainer.py] => Train Time: 6960.55
2024-04-26 21:12:55,517 [trainer.py] => Test Time: 52.31 

2024-04-26 21:12:55,519 [trainer.py] => All params: 85860176
2024-04-26 21:12:55,520 [trainer.py] => Trainable params: 85860176
2024-04-26 21:12:55,522 [finetune.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.690, Train_accy 46.65, Test_accy 76.04:   0%|          | 0/20 [01:33<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.690, Train_accy 46.65, Test_accy 76.04:   5%|▌         | 1/20 [01:33<29:29, 93.14s/it]Task 4, Epoch 2/20 => Loss 0.379, Train_accy 68.18:   5%|▌         | 1/20 [02:40<29:29, 93.14s/it]                 Task 4, Epoch 2/20 => Loss 0.379, Train_accy 68.18:  10%|█         | 2/20 [02:40<23:22, 77.93s/it]Task 4, Epoch 3/20 => Loss 0.327, Train_accy 75.66:  10%|█         | 2/20 [03:47<23:22, 77.93s/it]Task 4, Epoch 3/20 => Loss 0.327, Train_accy 75.66:  15%|█▌        | 3/20 [03:47<20:41, 73.05s/it]Task 4, Epoch 4/20 => Loss 0.320, Train_accy 78.92:  15%|█▌        | 3/20 [04:54<20:41, 73.05s/it]Task 4, Epoch 4/20 => Loss 0.320, Train_accy 78.92:  20%|██        | 4/20 [04:54<18:52, 70.78s/it]Task 4, Epoch 5/20 => Loss 0.297, Train_accy 81.24:  20%|██        | 4/20 [06:02<18:52, 70.78s/it]Task 4, Epoch 5/20 => Loss 0.297, Train_accy 81.24:  25%|██▌       | 5/20 [06:02<17:23, 69.60s/it]Task 4, Epoch 6/20 => Loss 0.269, Train_accy 83.09, Test_accy 75.77:  25%|██▌       | 5/20 [07:36<17:23, 69.60s/it]Task 4, Epoch 6/20 => Loss 0.269, Train_accy 83.09, Test_accy 75.77:  30%|███       | 6/20 [07:36<18:08, 77.78s/it]Task 4, Epoch 7/20 => Loss 0.255, Train_accy 84.02:  30%|███       | 6/20 [08:43<18:08, 77.78s/it]                 Task 4, Epoch 7/20 => Loss 0.255, Train_accy 84.02:  35%|███▌      | 7/20 [08:43<16:08, 74.48s/it]Task 4, Epoch 8/20 => Loss 0.259, Train_accy 85.21:  35%|███▌      | 7/20 [09:51<16:08, 74.48s/it]Task 4, Epoch 8/20 => Loss 0.259, Train_accy 85.21:  40%|████      | 8/20 [09:51<14:27, 72.27s/it]Task 4, Epoch 9/20 => Loss 0.245, Train_accy 85.82:  40%|████      | 8/20 [10:58<14:27, 72.27s/it]Task 4, Epoch 9/20 => Loss 0.245, Train_accy 85.82:  45%|████▌     | 9/20 [10:58<12:57, 70.72s/it]Task 4, Epoch 10/20 => Loss 0.238, Train_accy 87.08:  45%|████▌     | 9/20 [12:05<12:57, 70.72s/it]Task 4, Epoch 10/20 => Loss 0.238, Train_accy 87.08:  50%|█████     | 10/20 [12:05<11:36, 69.67s/it]Task 4, Epoch 11/20 => Loss 0.232, Train_accy 86.98, Test_accy 73.66:  50%|█████     | 10/20 [13:39<11:36, 69.67s/it]Task 4, Epoch 11/20 => Loss 0.232, Train_accy 86.98, Test_accy 73.66:  55%|█████▌    | 11/20 [13:39<11:32, 76.94s/it]Task 4, Epoch 12/20 => Loss 0.221, Train_accy 88.47:  55%|█████▌    | 11/20 [14:47<11:32, 76.94s/it]                 Task 4, Epoch 12/20 => Loss 0.221, Train_accy 88.47:  60%|██████    | 12/20 [14:47<09:53, 74.19s/it]Task 4, Epoch 13/20 => Loss 0.219, Train_accy 88.91:  60%|██████    | 12/20 [15:54<09:53, 74.19s/it]Task 4, Epoch 13/20 => Loss 0.219, Train_accy 88.91:  65%|██████▌   | 13/20 [15:54<08:25, 72.18s/it]Task 4, Epoch 14/20 => Loss 0.228, Train_accy 88.87:  65%|██████▌   | 13/20 [17:02<08:25, 72.18s/it]Task 4, Epoch 14/20 => Loss 0.228, Train_accy 88.87:  70%|███████   | 14/20 [17:02<07:04, 70.75s/it]Task 4, Epoch 15/20 => Loss 0.207, Train_accy 89.12:  70%|███████   | 14/20 [18:09<07:04, 70.75s/it]Task 4, Epoch 15/20 => Loss 0.207, Train_accy 89.12:  75%|███████▌  | 15/20 [18:09<05:48, 69.76s/it]Task 4, Epoch 16/20 => Loss 0.215, Train_accy 89.73, Test_accy 71.83:  75%|███████▌  | 15/20 [19:43<05:48, 69.76s/it]Task 4, Epoch 16/20 => Loss 0.215, Train_accy 89.73, Test_accy 71.83:  80%|████████  | 16/20 [19:43<05:07, 76.97s/it]Task 4, Epoch 17/20 => Loss 0.216, Train_accy 89.66:  80%|████████  | 16/20 [20:50<05:07, 76.97s/it]                 Task 4, Epoch 17/20 => Loss 0.216, Train_accy 89.66:  85%|████████▌ | 17/20 [20:50<03:42, 74.10s/it]Task 4, Epoch 18/20 => Loss 0.208, Train_accy 89.65:  85%|████████▌ | 17/20 [21:58<03:42, 74.10s/it]Task 4, Epoch 18/20 => Loss 0.208, Train_accy 89.65:  90%|█████████ | 18/20 [21:58<02:24, 72.19s/it]Task 4, Epoch 19/20 => Loss 0.214, Train_accy 89.83:  90%|█████████ | 18/20 [23:06<02:24, 72.19s/it]Task 4, Epoch 19/20 => Loss 0.214, Train_accy 89.83:  95%|█████████▌| 19/20 [23:06<01:10, 70.95s/it]Task 4, Epoch 20/20 => Loss 0.201, Train_accy 90.25:  95%|█████████▌| 19/20 [24:14<01:10, 70.95s/it]Task 4, Epoch 20/20 => Loss 0.201, Train_accy 90.25: 100%|██████████| 20/20 [24:14<00:00, 69.88s/it]Task 4, Epoch 20/20 => Loss 0.201, Train_accy 90.25: 100%|██████████| 20/20 [24:14<00:00, 72.70s/it]
2024-04-26 21:37:09,659 [finetune.py] => Task 4, Epoch 20/20 => Loss 0.201, Train_accy 90.25
2024-04-26 21:37:35,531 [trainer.py] => No NME accuracy.
2024-04-26 21:37:35,531 [trainer.py] => CNN: {'total': 70.94, '00-19': 45.4, '20-39': 69.45, '40-59': 68.85, '60-79': 76.55, '80-99': 94.45, 'old': 65.06, 'new': 94.45}
2024-04-26 21:37:35,532 [trainer.py] => CNN top1 curve: [95.1, 83.85, 80.45, 76.14, 70.94]
2024-04-26 21:37:35,532 [trainer.py] => CNN top5 curve: [99.7, 98.68, 98.12, 97.09, 95.46]

Average Accuracy (CNN): 81.3
2024-04-26 21:37:35,532 [trainer.py] => Average Accuracy (CNN): 81.3 

2024-04-26 21:37:35,532 [trainer.py] => Train Time: 8414.64
2024-04-26 21:37:35,532 [trainer.py] => Test Time: 78.18 

Accuracy Matrix (CNN):
[[95.1  70.4  62.3  58.5  45.4 ]
 [ 0.   97.3  84.5  76.35 69.45]
 [ 0.    0.   94.55 78.15 68.85]
 [ 0.    0.    0.   91.55 76.55]
 [ 0.    0.    0.    0.   94.45]]
2024-04-26 21:37:35,533 [trainer.py] => Forgetting (CNN): 29.562499999999996
2024-04-26 21:37:38,142 [trainer.py] => config: ./exps/icarl_cifar_B0_Inc5.json
2024-04-26 21:37:38,142 [trainer.py] => prefix: reproduce
2024-04-26 21:37:38,142 [trainer.py] => dataset: cifar224
2024-04-26 21:37:38,142 [trainer.py] => memory_size: 2000
2024-04-26 21:37:38,142 [trainer.py] => memory_per_class: 20
2024-04-26 21:37:38,142 [trainer.py] => fixed_memory: True
2024-04-26 21:37:38,142 [trainer.py] => shuffle: True
2024-04-26 21:37:38,142 [trainer.py] => init_cls: 20
2024-04-26 21:37:38,142 [trainer.py] => increment: 20
2024-04-26 21:37:38,142 [trainer.py] => model_name: icarl
2024-04-26 21:37:38,142 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-26 21:37:38,142 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-26 21:37:38,142 [trainer.py] => seed: 1993
2024-04-26 21:37:38,142 [trainer.py] => init_epoch: 20
2024-04-26 21:37:38,142 [trainer.py] => init_lr: 0.001
2024-04-26 21:37:38,142 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-26 21:37:38,142 [trainer.py] => init_lr_decay: 0.1
2024-04-26 21:37:38,142 [trainer.py] => init_weight_decay: 0.0005
2024-04-26 21:37:38,142 [trainer.py] => epochs: 20
2024-04-26 21:37:38,142 [trainer.py] => lrate: 0.001
2024-04-26 21:37:38,142 [trainer.py] => milestones: [80, 120]
2024-04-26 21:37:38,142 [trainer.py] => lrate_decay: 0.1
2024-04-26 21:37:38,142 [trainer.py] => batch_size: 48
2024-04-26 21:37:38,142 [trainer.py] => weight_decay: 0.0002
2024-04-26 21:37:38,142 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-04-26 21:37:39,933 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-26 21:37:41,832 [trainer.py] => All params: 85798656
2024-04-26 21:37:41,832 [trainer.py] => Trainable params: 85798656
2024-04-26 21:37:41,833 [icarl.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.766, Train_accy 16.23, Test_accy 64.45:   0%|          | 0/20 [01:12<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.766, Train_accy 16.23, Test_accy 64.45:   5%|▌         | 1/20 [01:12<22:58, 72.54s/it]Task 0, Epoch 2/20 => Loss 0.851, Train_accy 74.68:   5%|▌         | 1/20 [02:19<22:58, 72.54s/it]                 Task 0, Epoch 2/20 => Loss 0.851, Train_accy 74.68:  10%|█         | 2/20 [02:19<20:49, 69.44s/it]Task 0, Epoch 3/20 => Loss 0.566, Train_accy 83.02:  10%|█         | 2/20 [03:27<20:49, 69.44s/it]Task 0, Epoch 3/20 => Loss 0.566, Train_accy 83.02:  15%|█▌        | 3/20 [03:27<19:24, 68.51s/it]Task 0, Epoch 4/20 => Loss 0.493, Train_accy 85.22:  15%|█▌        | 3/20 [04:34<19:24, 68.51s/it]Task 0, Epoch 4/20 => Loss 0.493, Train_accy 85.22:  20%|██        | 4/20 [04:34<18:09, 68.11s/it]Task 0, Epoch 5/20 => Loss 0.423, Train_accy 87.47:  20%|██        | 4/20 [05:42<18:09, 68.11s/it]Task 0, Epoch 5/20 => Loss 0.423, Train_accy 87.47:  25%|██▌       | 5/20 [05:42<16:57, 67.84s/it]Task 0, Epoch 6/20 => Loss 0.433, Train_accy 86.91, Test_accy 95.40:  25%|██▌       | 5/20 [06:54<16:57, 67.84s/it]Task 0, Epoch 6/20 => Loss 0.433, Train_accy 86.91, Test_accy 95.40:  30%|███       | 6/20 [06:54<16:13, 69.56s/it]Task 0, Epoch 7/20 => Loss 0.398, Train_accy 88.01:  30%|███       | 6/20 [08:02<16:13, 69.56s/it]                 Task 0, Epoch 7/20 => Loss 0.398, Train_accy 88.01:  35%|███▌      | 7/20 [08:02<14:54, 68.84s/it]Task 0, Epoch 8/20 => Loss 0.374, Train_accy 88.76:  35%|███▌      | 7/20 [09:09<14:54, 68.84s/it]Task 0, Epoch 8/20 => Loss 0.374, Train_accy 88.76:  40%|████      | 8/20 [09:09<13:39, 68.32s/it]Task 0, Epoch 9/20 => Loss 0.359, Train_accy 89.34:  40%|████      | 8/20 [10:16<13:39, 68.32s/it]Task 0, Epoch 9/20 => Loss 0.359, Train_accy 89.34:  45%|████▌     | 9/20 [10:16<12:27, 68.00s/it]Task 0, Epoch 10/20 => Loss 0.334, Train_accy 89.84:  45%|████▌     | 9/20 [11:24<12:27, 68.00s/it]Task 0, Epoch 10/20 => Loss 0.334, Train_accy 89.84:  50%|█████     | 10/20 [11:24<11:17, 67.75s/it]Task 0, Epoch 11/20 => Loss 0.318, Train_accy 90.33, Test_accy 97.00:  50%|█████     | 10/20 [12:36<11:17, 67.75s/it]Task 0, Epoch 11/20 => Loss 0.318, Train_accy 90.33, Test_accy 97.00:  55%|█████▌    | 11/20 [12:36<10:23, 69.26s/it]Task 0, Epoch 12/20 => Loss 0.314, Train_accy 90.61:  55%|█████▌    | 11/20 [13:44<10:23, 69.26s/it]                 Task 0, Epoch 12/20 => Loss 0.314, Train_accy 90.61:  60%|██████    | 12/20 [13:44<09:10, 68.80s/it]Task 0, Epoch 13/20 => Loss 0.296, Train_accy 91.21:  60%|██████    | 12/20 [14:51<09:10, 68.80s/it]Task 0, Epoch 13/20 => Loss 0.296, Train_accy 91.21:  65%|██████▌   | 13/20 [14:51<07:58, 68.36s/it]Task 0, Epoch 14/20 => Loss 0.298, Train_accy 90.98:  65%|██████▌   | 13/20 [15:58<07:58, 68.36s/it]Task 0, Epoch 14/20 => Loss 0.298, Train_accy 90.98:  70%|███████   | 14/20 [15:58<06:48, 68.01s/it]Task 0, Epoch 15/20 => Loss 0.300, Train_accy 91.03:  70%|███████   | 14/20 [17:06<06:48, 68.01s/it]Task 0, Epoch 15/20 => Loss 0.300, Train_accy 91.03:  75%|███████▌  | 15/20 [17:06<05:38, 67.75s/it]Task 0, Epoch 16/20 => Loss 0.291, Train_accy 91.20, Test_accy 95.85:  75%|███████▌  | 15/20 [18:18<05:38, 67.75s/it]Task 0, Epoch 16/20 => Loss 0.291, Train_accy 91.20, Test_accy 95.85:  80%|████████  | 16/20 [18:18<04:36, 69.21s/it]Task 0, Epoch 17/20 => Loss 0.284, Train_accy 91.67:  80%|████████  | 16/20 [19:26<04:36, 69.21s/it]                 Task 0, Epoch 17/20 => Loss 0.284, Train_accy 91.67:  85%|████████▌ | 17/20 [19:26<03:25, 68.65s/it]Task 0, Epoch 18/20 => Loss 0.275, Train_accy 91.59:  85%|████████▌ | 17/20 [20:33<03:25, 68.65s/it]Task 0, Epoch 18/20 => Loss 0.275, Train_accy 91.59:  90%|█████████ | 18/20 [20:33<02:16, 68.27s/it]Task 0, Epoch 19/20 => Loss 0.264, Train_accy 92.03:  90%|█████████ | 18/20 [21:40<02:16, 68.27s/it]Task 0, Epoch 19/20 => Loss 0.264, Train_accy 92.03:  95%|█████████▌| 19/20 [21:40<01:07, 67.99s/it]Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.75:  95%|█████████▌| 19/20 [22:48<01:07, 67.99s/it]Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.75: 100%|██████████| 20/20 [22:48<00:00, 67.78s/it]Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.75: 100%|██████████| 20/20 [22:48<00:00, 68.41s/it]
2024-04-26 22:00:30,419 [icarl.py] => Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.75
2024-04-26 22:00:30,421 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 22:01:17,024 [icarl.py] => Exemplar size: 400
2024-04-26 22:01:17,024 [trainer.py] => CNN: {'total': 95.1, '00-19': 95.1, 'old': 0, 'new': 95.1}
2024-04-26 22:01:17,024 [trainer.py] => NME: {'total': 95.4, '00-19': 95.4, 'old': 0, 'new': 95.4}
2024-04-26 22:01:17,024 [trainer.py] => CNN top1 curve: [95.1]
2024-04-26 22:01:17,024 [trainer.py] => CNN top5 curve: [99.7]
2024-04-26 22:01:17,024 [trainer.py] => NME top1 curve: [95.4]
2024-04-26 22:01:17,024 [trainer.py] => NME top5 curve: [99.6]

Average Accuracy (CNN): 95.1
Average Accuracy (NME): 95.4
2024-04-26 22:01:17,024 [trainer.py] => Average Accuracy (CNN): 95.1
2024-04-26 22:01:17,024 [trainer.py] => Average Accuracy (NME): 95.4
2024-04-26 22:01:17,024 [trainer.py] => Train Time: 0
2024-04-26 22:01:17,024 [trainer.py] => Test Time: 10.78 

2024-04-26 22:01:17,025 [trainer.py] => All params: 85814036
2024-04-26 22:01:17,025 [trainer.py] => Trainable params: 85814036
2024-04-26 22:01:17,026 [icarl.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.396, Train_accy 75.60, Test_accy 86.42:   0%|          | 0/20 [01:44<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.396, Train_accy 75.60, Test_accy 86.42:   5%|▌         | 1/20 [01:44<33:10, 104.75s/it]Task 1, Epoch 2/20 => Loss 1.795, Train_accy 87.45:   5%|▌         | 1/20 [03:18<33:10, 104.75s/it]                 Task 1, Epoch 2/20 => Loss 1.795, Train_accy 87.45:  10%|█         | 2/20 [03:18<29:33, 98.54s/it] Task 1, Epoch 3/20 => Loss 1.749, Train_accy 88.48:  10%|█         | 2/20 [04:53<29:33, 98.54s/it]Task 1, Epoch 3/20 => Loss 1.749, Train_accy 88.48:  15%|█▌        | 3/20 [04:53<27:21, 96.57s/it]Task 1, Epoch 4/20 => Loss 1.712, Train_accy 89.78:  15%|█▌        | 3/20 [06:27<27:21, 96.57s/it]Task 1, Epoch 4/20 => Loss 1.712, Train_accy 89.78:  20%|██        | 4/20 [06:27<25:32, 95.77s/it]Task 1, Epoch 5/20 => Loss 1.684, Train_accy 90.05:  20%|██        | 4/20 [08:02<25:32, 95.77s/it]Task 1, Epoch 5/20 => Loss 1.684, Train_accy 90.05:  25%|██▌       | 5/20 [08:02<23:50, 95.36s/it]Task 1, Epoch 6/20 => Loss 1.648, Train_accy 91.30, Test_accy 89.52:  25%|██▌       | 5/20 [09:47<23:50, 95.36s/it]Task 1, Epoch 6/20 => Loss 1.648, Train_accy 91.30, Test_accy 89.52:  30%|███       | 6/20 [09:47<23:02, 98.73s/it]Task 1, Epoch 7/20 => Loss 1.649, Train_accy 91.22:  30%|███       | 6/20 [11:22<23:02, 98.73s/it]                 Task 1, Epoch 7/20 => Loss 1.649, Train_accy 91.22:  35%|███▌      | 7/20 [11:22<21:05, 97.38s/it]Task 1, Epoch 8/20 => Loss 1.613, Train_accy 91.65:  35%|███▌      | 7/20 [12:56<21:05, 97.38s/it]Task 1, Epoch 8/20 => Loss 1.613, Train_accy 91.65:  40%|████      | 8/20 [12:56<19:18, 96.54s/it]Task 1, Epoch 9/20 => Loss 1.647, Train_accy 91.45:  40%|████      | 8/20 [14:31<19:18, 96.54s/it]Task 1, Epoch 9/20 => Loss 1.647, Train_accy 91.45:  45%|████▌     | 9/20 [14:31<17:35, 95.93s/it]Task 1, Epoch 10/20 => Loss 1.592, Train_accy 92.37:  45%|████▌     | 9/20 [16:06<17:35, 95.93s/it]Task 1, Epoch 10/20 => Loss 1.592, Train_accy 92.37:  50%|█████     | 10/20 [16:06<15:55, 95.56s/it]Task 1, Epoch 11/20 => Loss 1.602, Train_accy 92.39, Test_accy 88.28:  50%|█████     | 10/20 [17:51<15:55, 95.56s/it]Task 1, Epoch 11/20 => Loss 1.602, Train_accy 92.39, Test_accy 88.28:  55%|█████▌    | 11/20 [17:51<14:47, 98.57s/it]Task 1, Epoch 12/20 => Loss 1.592, Train_accy 92.12:  55%|█████▌    | 11/20 [19:26<14:47, 98.57s/it]                 Task 1, Epoch 12/20 => Loss 1.592, Train_accy 92.12:  60%|██████    | 12/20 [19:26<12:59, 97.43s/it]Task 1, Epoch 13/20 => Loss 1.582, Train_accy 92.73:  60%|██████    | 12/20 [21:01<12:59, 97.43s/it]Task 1, Epoch 13/20 => Loss 1.582, Train_accy 92.73:  65%|██████▌   | 13/20 [21:01<11:16, 96.63s/it]Task 1, Epoch 14/20 => Loss 1.592, Train_accy 92.50:  65%|██████▌   | 13/20 [22:35<11:16, 96.63s/it]Task 1, Epoch 14/20 => Loss 1.592, Train_accy 92.50:  70%|███████   | 14/20 [22:35<09:36, 96.03s/it]Task 1, Epoch 15/20 => Loss 1.598, Train_accy 92.56:  70%|███████   | 14/20 [24:10<09:36, 96.03s/it]Task 1, Epoch 15/20 => Loss 1.598, Train_accy 92.56:  75%|███████▌  | 15/20 [24:10<07:57, 95.55s/it]Task 1, Epoch 16/20 => Loss 1.561, Train_accy 93.14, Test_accy 88.88:  75%|███████▌  | 15/20 [25:56<07:57, 95.55s/it]Task 1, Epoch 16/20 => Loss 1.561, Train_accy 93.14, Test_accy 88.88:  80%|████████  | 16/20 [25:56<06:34, 98.62s/it]Task 1, Epoch 17/20 => Loss 1.584, Train_accy 92.70:  80%|████████  | 16/20 [27:30<06:34, 98.62s/it]                 Task 1, Epoch 17/20 => Loss 1.584, Train_accy 92.70:  85%|████████▌ | 17/20 [27:30<04:52, 97.46s/it]Task 1, Epoch 18/20 => Loss 1.546, Train_accy 93.29:  85%|████████▌ | 17/20 [29:05<04:52, 97.46s/it]Task 1, Epoch 18/20 => Loss 1.546, Train_accy 93.29:  90%|█████████ | 18/20 [29:05<03:13, 96.53s/it]Task 1, Epoch 19/20 => Loss 1.540, Train_accy 93.87:  90%|█████████ | 18/20 [30:39<03:13, 96.53s/it]Task 1, Epoch 19/20 => Loss 1.540, Train_accy 93.87:  95%|█████████▌| 19/20 [30:39<01:35, 95.94s/it]Task 1, Epoch 20/20 => Loss 1.573, Train_accy 93.11:  95%|█████████▌| 19/20 [32:14<01:35, 95.94s/it]Task 1, Epoch 20/20 => Loss 1.573, Train_accy 93.11: 100%|██████████| 20/20 [32:14<00:00, 95.45s/it]Task 1, Epoch 20/20 => Loss 1.573, Train_accy 93.11: 100%|██████████| 20/20 [32:14<00:00, 96.71s/it]
2024-04-26 22:33:31,246 [icarl.py] => Task 1, Epoch 20/20 => Loss 1.573, Train_accy 93.11
2024-04-26 22:33:31,247 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 22:34:33,614 [icarl.py] => Exemplar size: 800
2024-04-26 22:34:33,614 [trainer.py] => CNN: {'total': 88.02, '00-19': 79.35, '20-39': 96.7, 'old': 79.35, 'new': 96.7}
2024-04-26 22:34:33,614 [trainer.py] => NME: {'total': 92.8, '00-19': 90.4, '20-39': 95.2, 'old': 90.4, 'new': 95.2}
2024-04-26 22:34:33,614 [trainer.py] => CNN top1 curve: [95.1, 88.02]
2024-04-26 22:34:33,614 [trainer.py] => CNN top5 curve: [99.7, 98.3]
2024-04-26 22:34:33,614 [trainer.py] => NME top1 curve: [95.4, 92.8]
2024-04-26 22:34:33,614 [trainer.py] => NME top5 curve: [99.6, 99.32]

Average Accuracy (CNN): 91.56
Average Accuracy (NME): 94.1
2024-04-26 22:34:33,614 [trainer.py] => Average Accuracy (CNN): 91.56
2024-04-26 22:34:33,615 [trainer.py] => Average Accuracy (NME): 94.1
2024-04-26 22:34:33,615 [trainer.py] => Train Time: 0
2024-04-26 22:34:33,615 [trainer.py] => Test Time: 31.83 

2024-04-26 22:34:33,615 [trainer.py] => All params: 85829416
2024-04-26 22:34:33,616 [trainer.py] => Trainable params: 85829416
2024-04-26 22:34:33,617 [icarl.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.136, Train_accy 72.38, Test_accy 83.25:   0%|          | 0/20 [01:53<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.136, Train_accy 72.38, Test_accy 83.25:   5%|▌         | 1/20 [01:53<35:56, 113.48s/it]Task 2, Epoch 2/20 => Loss 2.365, Train_accy 86.30:   5%|▌         | 1/20 [03:31<35:56, 113.48s/it]                 Task 2, Epoch 2/20 => Loss 2.365, Train_accy 86.30:  10%|█         | 2/20 [03:31<31:21, 104.55s/it]Task 2, Epoch 3/20 => Loss 2.321, Train_accy 87.86:  10%|█         | 2/20 [05:10<31:21, 104.55s/it]Task 2, Epoch 3/20 => Loss 2.321, Train_accy 87.86:  15%|█▌        | 3/20 [05:10<28:49, 101.72s/it]Task 2, Epoch 4/20 => Loss 2.251, Train_accy 89.08:  15%|█▌        | 3/20 [06:48<28:49, 101.72s/it]Task 2, Epoch 4/20 => Loss 2.251, Train_accy 89.08:  20%|██        | 4/20 [06:48<26:46, 100.40s/it]Task 2, Epoch 5/20 => Loss 2.255, Train_accy 89.61:  20%|██        | 4/20 [08:26<26:46, 100.40s/it]Task 2, Epoch 5/20 => Loss 2.255, Train_accy 89.61:  25%|██▌       | 5/20 [08:26<24:55, 99.70s/it] Task 2, Epoch 6/20 => Loss 2.232, Train_accy 90.31, Test_accy 81.65:  25%|██▌       | 5/20 [10:21<24:55, 99.70s/it]Task 2, Epoch 6/20 => Loss 2.232, Train_accy 90.31, Test_accy 81.65:  30%|███       | 6/20 [10:21<24:24, 104.61s/it]Task 2, Epoch 7/20 => Loss 2.211, Train_accy 90.41:  30%|███       | 6/20 [11:59<24:24, 104.61s/it]                 Task 2, Epoch 7/20 => Loss 2.211, Train_accy 90.41:  35%|███▌      | 7/20 [11:59<22:11, 102.44s/it]Task 2, Epoch 8/20 => Loss 2.175, Train_accy 90.97:  35%|███▌      | 7/20 [13:37<22:11, 102.44s/it]Task 2, Epoch 8/20 => Loss 2.175, Train_accy 90.97:  40%|████      | 8/20 [13:37<20:14, 101.23s/it]Task 2, Epoch 9/20 => Loss 2.191, Train_accy 91.56:  40%|████      | 8/20 [15:15<20:14, 101.23s/it]Task 2, Epoch 9/20 => Loss 2.191, Train_accy 91.56:  45%|████▌     | 9/20 [15:15<18:23, 100.28s/it]Task 2, Epoch 10/20 => Loss 2.165, Train_accy 91.62:  45%|████▌     | 9/20 [16:54<18:23, 100.28s/it]Task 2, Epoch 10/20 => Loss 2.165, Train_accy 91.62:  50%|█████     | 10/20 [16:54<16:36, 99.69s/it]Task 2, Epoch 11/20 => Loss 2.152, Train_accy 91.86, Test_accy 83.52:  50%|█████     | 10/20 [18:48<16:36, 99.69s/it]Task 2, Epoch 11/20 => Loss 2.152, Train_accy 91.86, Test_accy 83.52:  55%|█████▌    | 11/20 [18:48<15:36, 104.03s/it]Task 2, Epoch 12/20 => Loss 2.150, Train_accy 91.94:  55%|█████▌    | 11/20 [20:26<15:36, 104.03s/it]                 Task 2, Epoch 12/20 => Loss 2.150, Train_accy 91.94:  60%|██████    | 12/20 [20:26<13:38, 102.32s/it]Task 2, Epoch 13/20 => Loss 2.133, Train_accy 92.12:  60%|██████    | 12/20 [22:04<13:38, 102.32s/it]Task 2, Epoch 13/20 => Loss 2.133, Train_accy 92.12:  65%|██████▌   | 13/20 [22:04<11:47, 101.03s/it]Task 2, Epoch 14/20 => Loss 2.145, Train_accy 91.94:  65%|██████▌   | 13/20 [23:42<11:47, 101.03s/it]Task 2, Epoch 14/20 => Loss 2.145, Train_accy 91.94:  70%|███████   | 14/20 [23:42<10:00, 100.10s/it]Task 2, Epoch 15/20 => Loss 2.133, Train_accy 92.31:  70%|███████   | 14/20 [25:20<10:00, 100.10s/it]Task 2, Epoch 15/20 => Loss 2.133, Train_accy 92.31:  75%|███████▌  | 15/20 [25:20<08:17, 99.44s/it] Task 2, Epoch 16/20 => Loss 2.148, Train_accy 92.24, Test_accy 83.10:  75%|███████▌  | 15/20 [27:14<08:17, 99.44s/it]Task 2, Epoch 16/20 => Loss 2.148, Train_accy 92.24, Test_accy 83.10:  80%|████████  | 16/20 [27:14<06:54, 103.72s/it]Task 2, Epoch 17/20 => Loss 2.143, Train_accy 92.69:  80%|████████  | 16/20 [28:52<06:54, 103.72s/it]                 Task 2, Epoch 17/20 => Loss 2.143, Train_accy 92.69:  85%|████████▌ | 17/20 [28:52<05:06, 102.12s/it]Task 2, Epoch 18/20 => Loss 2.123, Train_accy 93.13:  85%|████████▌ | 17/20 [30:30<05:06, 102.12s/it]Task 2, Epoch 18/20 => Loss 2.123, Train_accy 93.13:  90%|█████████ | 18/20 [30:30<03:22, 101.01s/it]Task 2, Epoch 19/20 => Loss 2.109, Train_accy 92.91:  90%|█████████ | 18/20 [32:09<03:22, 101.01s/it]Task 2, Epoch 19/20 => Loss 2.109, Train_accy 92.91:  95%|█████████▌| 19/20 [32:09<01:40, 100.13s/it]Task 2, Epoch 20/20 => Loss 2.085, Train_accy 93.54:  95%|█████████▌| 19/20 [33:47<01:40, 100.13s/it]Task 2, Epoch 20/20 => Loss 2.085, Train_accy 93.54: 100%|██████████| 20/20 [33:47<00:00, 99.73s/it] Task 2, Epoch 20/20 => Loss 2.085, Train_accy 93.54: 100%|██████████| 20/20 [33:47<00:00, 101.39s/it]
2024-04-26 23:08:21,587 [icarl.py] => Task 2, Epoch 20/20 => Loss 2.085, Train_accy 93.54
2024-04-26 23:08:21,589 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 23:09:37,605 [icarl.py] => Exemplar size: 1200
2024-04-26 23:09:37,605 [trainer.py] => CNN: {'total': 82.22, '00-19': 67.7, '20-39': 83.1, '40-59': 95.85, 'old': 75.4, 'new': 95.85}
2024-04-26 23:09:37,605 [trainer.py] => NME: {'total': 89.88, '00-19': 86.25, '20-39': 90.55, '40-59': 92.85, 'old': 88.4, 'new': 92.85}
2024-04-26 23:09:37,605 [trainer.py] => CNN top1 curve: [95.1, 88.02, 82.22]
2024-04-26 23:09:37,605 [trainer.py] => CNN top5 curve: [99.7, 98.3, 96.65]
2024-04-26 23:09:37,605 [trainer.py] => NME top1 curve: [95.4, 92.8, 89.88]
2024-04-26 23:09:37,605 [trainer.py] => NME top5 curve: [99.6, 99.32, 98.87]

Average Accuracy (CNN): 88.45
Average Accuracy (NME): 92.69
2024-04-26 23:09:37,605 [trainer.py] => Average Accuracy (CNN): 88.45
2024-04-26 23:09:37,605 [trainer.py] => Average Accuracy (NME): 92.69
2024-04-26 23:09:37,605 [trainer.py] => Train Time: 0
2024-04-26 23:09:37,606 [trainer.py] => Test Time: 63.06999999999999 

2024-04-26 23:09:37,606 [trainer.py] => All params: 85844796
2024-04-26 23:09:37,606 [trainer.py] => Trainable params: 85844796
2024-04-26 23:09:37,607 [icarl.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.121, Train_accy 72.61, Test_accy 75.76:   0%|          | 0/20 [02:03<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.121, Train_accy 72.61, Test_accy 75.76:   5%|▌         | 1/20 [02:03<38:58, 123.09s/it]Task 3, Epoch 2/20 => Loss 2.307, Train_accy 85.54:   5%|▌         | 1/20 [03:44<38:58, 123.09s/it]                 Task 3, Epoch 2/20 => Loss 2.307, Train_accy 85.54:  10%|█         | 2/20 [03:44<33:09, 110.52s/it]Task 3, Epoch 3/20 => Loss 2.229, Train_accy 87.79:  10%|█         | 2/20 [05:26<33:09, 110.52s/it]Task 3, Epoch 3/20 => Loss 2.229, Train_accy 87.79:  15%|█▌        | 3/20 [05:26<30:08, 106.38s/it]Task 3, Epoch 4/20 => Loss 2.203, Train_accy 88.34:  15%|█▌        | 3/20 [07:07<30:08, 106.38s/it]Task 3, Epoch 4/20 => Loss 2.203, Train_accy 88.34:  20%|██        | 4/20 [07:07<27:50, 104.41s/it]Task 3, Epoch 5/20 => Loss 2.164, Train_accy 89.30:  20%|██        | 4/20 [08:49<27:50, 104.41s/it]Task 3, Epoch 5/20 => Loss 2.164, Train_accy 89.30:  25%|██▌       | 5/20 [08:49<25:50, 103.37s/it]Task 3, Epoch 6/20 => Loss 2.123, Train_accy 90.49, Test_accy 76.65:  25%|██▌       | 5/20 [10:51<25:50, 103.37s/it]Task 3, Epoch 6/20 => Loss 2.123, Train_accy 90.49, Test_accy 76.65:  30%|███       | 6/20 [10:51<25:37, 109.81s/it]Task 3, Epoch 7/20 => Loss 2.120, Train_accy 90.64:  30%|███       | 6/20 [12:33<25:37, 109.81s/it]                 Task 3, Epoch 7/20 => Loss 2.120, Train_accy 90.64:  35%|███▌      | 7/20 [12:33<23:13, 107.18s/it]Task 3, Epoch 8/20 => Loss 2.122, Train_accy 90.58:  35%|███▌      | 7/20 [14:14<23:13, 107.18s/it]Task 3, Epoch 8/20 => Loss 2.122, Train_accy 90.58:  40%|████      | 8/20 [14:14<21:05, 105.43s/it]Task 3, Epoch 9/20 => Loss 2.085, Train_accy 91.46:  40%|████      | 8/20 [15:56<21:05, 105.43s/it]Task 3, Epoch 9/20 => Loss 2.085, Train_accy 91.46:  45%|████▌     | 9/20 [15:56<19:06, 104.21s/it]Task 3, Epoch 10/20 => Loss 2.085, Train_accy 91.88:  45%|████▌     | 9/20 [17:38<19:06, 104.21s/it]Task 3, Epoch 10/20 => Loss 2.085, Train_accy 91.88:  50%|█████     | 10/20 [17:38<17:13, 103.40s/it]Task 3, Epoch 11/20 => Loss 2.071, Train_accy 92.01, Test_accy 76.41:  50%|█████     | 10/20 [19:40<17:13, 103.40s/it]Task 3, Epoch 11/20 => Loss 2.071, Train_accy 92.01, Test_accy 76.41:  55%|█████▌    | 11/20 [19:40<16:21, 109.10s/it]Task 3, Epoch 12/20 => Loss 2.068, Train_accy 92.16:  55%|█████▌    | 11/20 [21:21<16:21, 109.10s/it]                 Task 3, Epoch 12/20 => Loss 2.068, Train_accy 92.16:  60%|██████    | 12/20 [21:21<14:14, 106.78s/it]Task 3, Epoch 13/20 => Loss 2.071, Train_accy 91.99:  60%|██████    | 12/20 [23:03<14:14, 106.78s/it]Task 3, Epoch 13/20 => Loss 2.071, Train_accy 91.99:  65%|██████▌   | 13/20 [23:03<12:16, 105.22s/it]Task 3, Epoch 14/20 => Loss 2.051, Train_accy 92.63:  65%|██████▌   | 13/20 [24:45<12:16, 105.22s/it]Task 3, Epoch 14/20 => Loss 2.051, Train_accy 92.63:  70%|███████   | 14/20 [24:45<10:25, 104.20s/it]Task 3, Epoch 15/20 => Loss 2.051, Train_accy 92.73:  70%|███████   | 14/20 [26:26<10:25, 104.20s/it]Task 3, Epoch 15/20 => Loss 2.051, Train_accy 92.73:  75%|███████▌  | 15/20 [26:26<08:37, 103.47s/it]Task 3, Epoch 16/20 => Loss 2.019, Train_accy 93.18, Test_accy 75.99:  75%|███████▌  | 15/20 [28:29<08:37, 103.47s/it]Task 3, Epoch 16/20 => Loss 2.019, Train_accy 93.18, Test_accy 75.99:  80%|████████  | 16/20 [28:29<07:16, 109.20s/it]Task 3, Epoch 17/20 => Loss 2.059, Train_accy 92.79:  80%|████████  | 16/20 [30:11<07:16, 109.20s/it]                 Task 3, Epoch 17/20 => Loss 2.059, Train_accy 92.79:  85%|████████▌ | 17/20 [30:11<05:20, 106.95s/it]Task 3, Epoch 18/20 => Loss 2.039, Train_accy 92.83:  85%|████████▌ | 17/20 [31:52<05:20, 106.95s/it]Task 3, Epoch 18/20 => Loss 2.039, Train_accy 92.83:  90%|█████████ | 18/20 [31:52<03:30, 105.40s/it]Task 3, Epoch 19/20 => Loss 2.046, Train_accy 92.46:  90%|█████████ | 18/20 [33:34<03:30, 105.40s/it]Task 3, Epoch 19/20 => Loss 2.046, Train_accy 92.46:  95%|█████████▌| 19/20 [33:34<01:44, 104.27s/it]Task 3, Epoch 20/20 => Loss 2.032, Train_accy 93.05:  95%|█████████▌| 19/20 [35:16<01:44, 104.27s/it]Task 3, Epoch 20/20 => Loss 2.032, Train_accy 93.05: 100%|██████████| 20/20 [35:16<00:00, 103.51s/it]Task 3, Epoch 20/20 => Loss 2.032, Train_accy 93.05: 100%|██████████| 20/20 [35:16<00:00, 105.81s/it]
2024-04-26 23:44:53,917 [icarl.py] => Task 3, Epoch 20/20 => Loss 2.032, Train_accy 93.05
2024-04-26 23:44:53,919 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-26 23:46:24,878 [icarl.py] => Exemplar size: 1600
2024-04-26 23:46:24,878 [trainer.py] => CNN: {'total': 76.99, '00-19': 60.35, '20-39': 77.9, '40-59': 75.3, '60-79': 94.4, 'old': 71.18, 'new': 94.4}
2024-04-26 23:46:24,878 [trainer.py] => NME: {'total': 86.51, '00-19': 82.55, '20-39': 88.3, '40-59': 84.25, '60-79': 90.95, 'old': 85.03, 'new': 90.95}
2024-04-26 23:46:24,878 [trainer.py] => CNN top1 curve: [95.1, 88.02, 82.22, 76.99]
2024-04-26 23:46:24,878 [trainer.py] => CNN top5 curve: [99.7, 98.3, 96.65, 94.51]
2024-04-26 23:46:24,878 [trainer.py] => NME top1 curve: [95.4, 92.8, 89.88, 86.51]
2024-04-26 23:46:24,878 [trainer.py] => NME top5 curve: [99.6, 99.32, 98.87, 98.6]

Average Accuracy (CNN): 85.58
Average Accuracy (NME): 91.15
2024-04-26 23:46:24,878 [trainer.py] => Average Accuracy (CNN): 85.58
2024-04-26 23:46:24,878 [trainer.py] => Average Accuracy (NME): 91.15
2024-04-26 23:46:24,878 [trainer.py] => Train Time: 0
2024-04-26 23:46:24,878 [trainer.py] => Test Time: 104.6 

2024-04-26 23:46:24,879 [trainer.py] => All params: 85860176
2024-04-26 23:46:24,879 [trainer.py] => Trainable params: 85860176
2024-04-26 23:46:24,881 [icarl.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.430, Train_accy 73.57, Test_accy 74.85:   0%|          | 0/20 [02:10<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.430, Train_accy 73.57, Test_accy 74.85:   5%|▌         | 1/20 [02:10<41:24, 130.78s/it]Task 4, Epoch 2/20 => Loss 2.637, Train_accy 85.96:   5%|▌         | 1/20 [03:56<41:24, 130.78s/it]                 Task 4, Epoch 2/20 => Loss 2.637, Train_accy 85.96:  10%|█         | 2/20 [03:56<34:44, 115.81s/it]Task 4, Epoch 3/20 => Loss 2.562, Train_accy 87.91:  10%|█         | 2/20 [05:41<34:44, 115.81s/it]Task 4, Epoch 3/20 => Loss 2.562, Train_accy 87.91:  15%|█▌        | 3/20 [05:41<31:27, 111.02s/it]Task 4, Epoch 4/20 => Loss 2.535, Train_accy 88.70:  15%|█▌        | 3/20 [07:26<31:27, 111.02s/it]Task 4, Epoch 4/20 => Loss 2.535, Train_accy 88.70:  20%|██        | 4/20 [07:26<28:59, 108.73s/it]Task 4, Epoch 5/20 => Loss 2.503, Train_accy 89.64:  20%|██        | 4/20 [09:12<28:59, 108.73s/it]Task 4, Epoch 5/20 => Loss 2.503, Train_accy 89.64:  25%|██▌       | 5/20 [09:12<26:53, 107.53s/it]Task 4, Epoch 6/20 => Loss 2.463, Train_accy 90.45, Test_accy 73.02:  25%|██▌       | 5/20 [11:23<26:53, 107.53s/it]Task 4, Epoch 6/20 => Loss 2.463, Train_accy 90.45, Test_accy 73.02:  30%|███       | 6/20 [11:23<26:57, 115.50s/it]Task 4, Epoch 7/20 => Loss 2.459, Train_accy 90.58:  30%|███       | 6/20 [13:08<26:57, 115.50s/it]                 Task 4, Epoch 7/20 => Loss 2.459, Train_accy 90.58:  35%|███▌      | 7/20 [13:08<24:18, 112.19s/it]Task 4, Epoch 8/20 => Loss 2.424, Train_accy 91.22:  35%|███▌      | 7/20 [14:54<24:18, 112.19s/it]Task 4, Epoch 8/20 => Loss 2.424, Train_accy 91.22:  40%|████      | 8/20 [14:54<22:01, 110.09s/it]Task 4, Epoch 9/20 => Loss 2.413, Train_accy 91.62:  40%|████      | 8/20 [16:39<22:01, 110.09s/it]Task 4, Epoch 9/20 => Loss 2.413, Train_accy 91.62:  45%|████▌     | 9/20 [16:39<19:55, 108.72s/it]Task 4, Epoch 10/20 => Loss 2.391, Train_accy 92.17:  45%|████▌     | 9/20 [18:25<19:55, 108.72s/it]Task 4, Epoch 10/20 => Loss 2.391, Train_accy 92.17:  50%|█████     | 10/20 [18:25<17:57, 107.75s/it]Task 4, Epoch 11/20 => Loss 2.381, Train_accy 91.98, Test_accy 73.18:  50%|█████     | 10/20 [20:36<17:57, 107.75s/it]Task 4, Epoch 11/20 => Loss 2.381, Train_accy 91.98, Test_accy 73.18:  55%|█████▌    | 11/20 [20:36<17:13, 114.81s/it]Task 4, Epoch 12/20 => Loss 2.393, Train_accy 92.27:  55%|█████▌    | 11/20 [22:21<17:13, 114.81s/it]                 Task 4, Epoch 12/20 => Loss 2.393, Train_accy 92.27:  60%|██████    | 12/20 [22:21<14:55, 111.88s/it]Task 4, Epoch 13/20 => Loss 2.401, Train_accy 91.95:  60%|██████    | 12/20 [24:06<14:55, 111.88s/it]Task 4, Epoch 13/20 => Loss 2.401, Train_accy 91.95:  65%|██████▌   | 13/20 [24:06<12:49, 109.97s/it]Task 4, Epoch 14/20 => Loss 2.372, Train_accy 92.66:  65%|██████▌   | 13/20 [25:52<12:49, 109.97s/it]Task 4, Epoch 14/20 => Loss 2.372, Train_accy 92.66:  70%|███████   | 14/20 [25:52<10:51, 108.54s/it]Task 4, Epoch 15/20 => Loss 2.380, Train_accy 92.59:  70%|███████   | 14/20 [27:37<10:51, 108.54s/it]Task 4, Epoch 15/20 => Loss 2.380, Train_accy 92.59:  75%|███████▌  | 15/20 [27:37<08:57, 107.54s/it]Task 4, Epoch 16/20 => Loss 2.375, Train_accy 92.53, Test_accy 73.46:  75%|███████▌  | 15/20 [29:48<08:57, 107.54s/it]Task 4, Epoch 16/20 => Loss 2.375, Train_accy 92.53, Test_accy 73.46:  80%|████████  | 16/20 [29:48<07:38, 114.63s/it]Task 4, Epoch 17/20 => Loss 2.357, Train_accy 92.95:  80%|████████  | 16/20 [31:33<07:38, 114.63s/it]                 Task 4, Epoch 17/20 => Loss 2.357, Train_accy 92.95:  85%|████████▌ | 17/20 [31:33<05:35, 111.79s/it]Task 4, Epoch 18/20 => Loss 2.350, Train_accy 93.03:  85%|████████▌ | 17/20 [33:18<05:35, 111.79s/it]Task 4, Epoch 18/20 => Loss 2.350, Train_accy 93.03:  90%|█████████ | 18/20 [33:18<03:39, 109.78s/it]Task 4, Epoch 19/20 => Loss 2.359, Train_accy 92.98:  90%|█████████ | 18/20 [35:03<03:39, 109.78s/it]Task 4, Epoch 19/20 => Loss 2.359, Train_accy 92.98:  95%|█████████▌| 19/20 [35:03<01:48, 108.41s/it]Task 4, Epoch 20/20 => Loss 2.352, Train_accy 93.19:  95%|█████████▌| 19/20 [36:49<01:48, 108.41s/it]Task 4, Epoch 20/20 => Loss 2.352, Train_accy 93.19: 100%|██████████| 20/20 [36:49<00:00, 107.57s/it]Task 4, Epoch 20/20 => Loss 2.352, Train_accy 93.19: 100%|██████████| 20/20 [36:49<00:00, 110.48s/it]
2024-04-27 00:23:14,507 [icarl.py] => Task 4, Epoch 20/20 => Loss 2.352, Train_accy 93.19
2024-04-27 00:23:14,509 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 00:25:01,518 [icarl.py] => Exemplar size: 2000
2024-04-27 00:25:01,518 [trainer.py] => CNN: {'total': 74.28, '00-19': 56.35, '20-39': 69.95, '40-59': 67.5, '60-79': 81.95, '80-99': 95.65, 'old': 68.94, 'new': 95.65}
2024-04-27 00:25:01,518 [trainer.py] => NME: {'total': 84.96, '00-19': 79.1, '20-39': 86.45, '40-59': 81.85, '60-79': 86.25, '80-99': 91.15, 'old': 83.41, 'new': 91.15}
2024-04-27 00:25:01,518 [trainer.py] => CNN top1 curve: [95.1, 88.02, 82.22, 76.99, 74.28]
2024-04-27 00:25:01,518 [trainer.py] => CNN top5 curve: [99.7, 98.3, 96.65, 94.51, 92.94]
2024-04-27 00:25:01,518 [trainer.py] => NME top1 curve: [95.4, 92.8, 89.88, 86.51, 84.96]
2024-04-27 00:25:01,518 [trainer.py] => NME top5 curve: [99.6, 99.32, 98.87, 98.6, 97.82]

Average Accuracy (CNN): 83.32
Average Accuracy (NME): 89.91
2024-04-27 00:25:01,518 [trainer.py] => Average Accuracy (CNN): 83.32
2024-04-27 00:25:01,518 [trainer.py] => Average Accuracy (NME): 89.91
2024-04-27 00:25:01,518 [trainer.py] => Train Time: 0
2024-04-27 00:25:01,518 [trainer.py] => Test Time: 156.39 

Accuracy Matrix (CNN):
[[95.1  79.35 67.7  60.35 56.35]
 [ 0.   96.7  83.1  77.9  69.95]
 [ 0.    0.   95.85 75.3  67.5 ]
 [ 0.    0.    0.   94.4  81.95]
 [ 0.    0.    0.    0.   95.65]]
2024-04-27 00:25:01,519 [trainer.py] => Forgetting (CNN): 26.575
Accuracy Matrix (NME):
[[95.4  90.4  86.25 82.55 79.1 ]
 [ 0.   95.2  90.55 88.3  86.45]
 [ 0.    0.   92.85 84.25 81.85]
 [ 0.    0.    0.   90.95 86.25]
 [ 0.    0.    0.    0.   91.15]]
2024-04-27 00:25:01,519 [trainer.py] => Forgetting (NME): 10.187500000000004
2024-04-27 00:25:04,346 [trainer.py] => config: ./exps/der_cifar_B0_Inc5.json
2024-04-27 00:25:04,347 [trainer.py] => prefix: reproduce
2024-04-27 00:25:04,347 [trainer.py] => dataset: cifar224
2024-04-27 00:25:04,347 [trainer.py] => memory_size: 2000
2024-04-27 00:25:04,347 [trainer.py] => memory_per_class: 20
2024-04-27 00:25:04,347 [trainer.py] => fixed_memory: False
2024-04-27 00:25:04,347 [trainer.py] => shuffle: True
2024-04-27 00:25:04,347 [trainer.py] => init_cls: 20
2024-04-27 00:25:04,347 [trainer.py] => increment: 20
2024-04-27 00:25:04,347 [trainer.py] => model_name: der
2024-04-27 00:25:04,347 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-27 00:25:04,347 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-27 00:25:04,347 [trainer.py] => seed: 1993
2024-04-27 00:25:04,347 [trainer.py] => init_epoch: 20
2024-04-27 00:25:04,347 [trainer.py] => init_lr: 0.001
2024-04-27 00:25:04,347 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-27 00:25:04,347 [trainer.py] => init_lr_decay: 0.1
2024-04-27 00:25:04,347 [trainer.py] => init_weight_decay: 0.0005
2024-04-27 00:25:04,347 [trainer.py] => epochs: 20
2024-04-27 00:25:04,347 [trainer.py] => lrate: 0.001
2024-04-27 00:25:04,347 [trainer.py] => milestones: [80, 120, 150]
2024-04-27 00:25:04,347 [trainer.py] => lrate_decay: 0.1
2024-04-27 00:25:04,347 [trainer.py] => batch_size: 48
2024-04-27 00:25:04,347 [trainer.py] => weight_decay: 0.0002
2024-04-27 00:25:04,347 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-04-27 00:25:06,203 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-27 00:25:06,566 [trainer.py] => All params: 0
2024-04-27 00:25:06,566 [trainer.py] => Trainable params: 0
2024-04-27 00:25:08,111 [der.py] => Learning on 0-20
2024-04-27 00:25:08,112 [der.py] => All params: 85830185
2024-04-27 00:25:08,112 [der.py] => Trainable params: 85830185
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.978, Train_accy 9.59, Test_accy 16.95:   0%|          | 0/20 [01:12<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.978, Train_accy 9.59, Test_accy 16.95:   5%|▌         | 1/20 [01:12<22:53, 72.30s/it]Task 0, Epoch 2/20 => Loss 2.313, Train_accy 29.48:   5%|▌         | 1/20 [02:19<22:53, 72.30s/it]                Task 0, Epoch 2/20 => Loss 2.313, Train_accy 29.48:  10%|█         | 2/20 [02:19<20:47, 69.29s/it]Task 0, Epoch 3/20 => Loss 0.762, Train_accy 77.14:  10%|█         | 2/20 [03:26<20:47, 69.29s/it]Task 0, Epoch 3/20 => Loss 0.762, Train_accy 77.14:  15%|█▌        | 3/20 [03:26<19:22, 68.40s/it]Task 0, Epoch 4/20 => Loss 0.560, Train_accy 83.25:  15%|█▌        | 3/20 [04:34<19:22, 68.40s/it]Task 0, Epoch 4/20 => Loss 0.560, Train_accy 83.25:  20%|██        | 4/20 [04:34<18:07, 67.94s/it]Task 0, Epoch 5/20 => Loss 0.472, Train_accy 85.96:  20%|██        | 4/20 [05:41<18:07, 67.94s/it]Task 0, Epoch 5/20 => Loss 0.472, Train_accy 85.96:  25%|██▌       | 5/20 [05:41<16:55, 67.70s/it]Task 0, Epoch 6/20 => Loss 0.435, Train_accy 86.61, Test_accy 94.70:  25%|██▌       | 5/20 [06:54<16:55, 67.70s/it]Task 0, Epoch 6/20 => Loss 0.435, Train_accy 86.61, Test_accy 94.70:  30%|███       | 6/20 [06:54<16:12, 69.43s/it]Task 0, Epoch 7/20 => Loss 0.398, Train_accy 87.97:  30%|███       | 6/20 [08:01<16:12, 69.43s/it]                 Task 0, Epoch 7/20 => Loss 0.398, Train_accy 87.97:  35%|███▌      | 7/20 [08:01<14:53, 68.74s/it]Task 0, Epoch 8/20 => Loss 0.390, Train_accy 88.49:  35%|███▌      | 7/20 [09:08<14:53, 68.74s/it]Task 0, Epoch 8/20 => Loss 0.390, Train_accy 88.49:  40%|████      | 8/20 [09:08<13:39, 68.27s/it]Task 0, Epoch 9/20 => Loss 0.390, Train_accy 88.05:  40%|████      | 8/20 [10:16<13:39, 68.27s/it]Task 0, Epoch 9/20 => Loss 0.390, Train_accy 88.05:  45%|████▌     | 9/20 [10:16<12:27, 67.99s/it]Task 0, Epoch 10/20 => Loss 0.345, Train_accy 89.48:  45%|████▌     | 9/20 [11:23<12:27, 67.99s/it]Task 0, Epoch 10/20 => Loss 0.345, Train_accy 89.48:  50%|█████     | 10/20 [11:23<11:17, 67.75s/it]Task 0, Epoch 11/20 => Loss 0.329, Train_accy 90.17, Test_accy 95.90:  50%|█████     | 10/20 [12:36<11:17, 67.75s/it]Task 0, Epoch 11/20 => Loss 0.329, Train_accy 90.17, Test_accy 95.90:  55%|█████▌    | 11/20 [12:36<10:23, 69.30s/it]Task 0, Epoch 12/20 => Loss 0.331, Train_accy 90.10:  55%|█████▌    | 11/20 [13:43<10:23, 69.30s/it]                 Task 0, Epoch 12/20 => Loss 0.331, Train_accy 90.10:  60%|██████    | 12/20 [13:43<09:09, 68.67s/it]Task 0, Epoch 13/20 => Loss 0.305, Train_accy 90.56:  60%|██████    | 12/20 [14:50<09:09, 68.67s/it]Task 0, Epoch 13/20 => Loss 0.305, Train_accy 90.56:  65%|██████▌   | 13/20 [14:50<07:57, 68.21s/it]Task 0, Epoch 14/20 => Loss 0.311, Train_accy 90.69:  65%|██████▌   | 13/20 [15:57<07:57, 68.21s/it]Task 0, Epoch 14/20 => Loss 0.311, Train_accy 90.69:  70%|███████   | 14/20 [15:57<06:47, 67.86s/it]Task 0, Epoch 15/20 => Loss 0.289, Train_accy 91.07:  70%|███████   | 14/20 [17:04<06:47, 67.86s/it]Task 0, Epoch 15/20 => Loss 0.289, Train_accy 91.07:  75%|███████▌  | 15/20 [17:04<05:38, 67.71s/it]Task 0, Epoch 16/20 => Loss 0.316, Train_accy 90.31, Test_accy 95.85:  75%|███████▌  | 15/20 [18:18<05:38, 67.71s/it]Task 0, Epoch 16/20 => Loss 0.316, Train_accy 90.31, Test_accy 95.85:  80%|████████  | 16/20 [18:18<04:37, 69.40s/it]Task 0, Epoch 17/20 => Loss 0.296, Train_accy 90.93:  80%|████████  | 16/20 [19:25<04:37, 69.40s/it]                 Task 0, Epoch 17/20 => Loss 0.296, Train_accy 90.93:  85%|████████▌ | 17/20 [19:25<03:26, 68.86s/it]Task 0, Epoch 18/20 => Loss 0.291, Train_accy 91.45:  85%|████████▌ | 17/20 [20:33<03:26, 68.86s/it]Task 0, Epoch 18/20 => Loss 0.291, Train_accy 91.45:  90%|█████████ | 18/20 [20:33<02:16, 68.38s/it]Task 0, Epoch 19/20 => Loss 0.286, Train_accy 91.42:  90%|█████████ | 18/20 [21:40<02:16, 68.38s/it]Task 0, Epoch 19/20 => Loss 0.286, Train_accy 91.42:  95%|█████████▌| 19/20 [21:40<01:08, 68.12s/it]Task 0, Epoch 20/20 => Loss 0.287, Train_accy 90.93:  95%|█████████▌| 19/20 [22:47<01:08, 68.12s/it]Task 0, Epoch 20/20 => Loss 0.287, Train_accy 90.93: 100%|██████████| 20/20 [22:47<00:00, 67.86s/it]Task 0, Epoch 20/20 => Loss 0.287, Train_accy 90.93: 100%|██████████| 20/20 [22:47<00:00, 68.39s/it]
2024-04-27 00:47:56,456 [der.py] => Task 0, Epoch 20/20 => Loss 0.287, Train_accy 90.93
2024-04-27 00:47:56,458 [base.py] => Reducing exemplars...(100 per classes)
2024-04-27 00:47:56,459 [base.py] => Constructing exemplars...(100 per classes)
2024-04-27 00:48:50,294 [der.py] => Exemplar size: 2000
2024-04-27 00:48:50,294 [trainer.py] => CNN: {'total': 96.15, '00-19': 96.15, 'old': 0, 'new': 96.15}
2024-04-27 00:48:50,294 [trainer.py] => NME: {'total': 96.7, '00-19': 96.7, 'old': 0, 'new': 96.7}
2024-04-27 00:48:50,294 [trainer.py] => CNN top1 curve: [96.15]
2024-04-27 00:48:50,294 [trainer.py] => CNN top5 curve: [99.65]
2024-04-27 00:48:50,294 [trainer.py] => NME top1 curve: [96.7]
2024-04-27 00:48:50,294 [trainer.py] => NME top5 curve: [99.75]

Average Accuracy (CNN): 96.15
Average Accuracy (NME): 96.7
2024-04-27 00:48:50,294 [trainer.py] => Average Accuracy (CNN): 96.15
2024-04-27 00:48:50,294 [trainer.py] => Average Accuracy (NME): 96.7
2024-04-27 00:48:50,294 [trainer.py] => Train Time: 1368.32
2024-04-27 00:48:50,294 [trainer.py] => Test Time: 10.85 

2024-04-27 00:48:50,295 [trainer.py] => All params: 85830185
2024-04-27 00:48:50,295 [trainer.py] => Trainable params: 85830185
2024-04-27 00:48:51,854 [der.py] => Learning on 20-40
2024-04-27 00:48:51,856 [der.py] => All params: 171674941
2024-04-27 00:48:51,857 [der.py] => Trainable params: 85876285
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.690, Loss_clf 0.876, Loss_aux 0.814, Train_accy 76.81, Test_accy 92.30:   0%|          | 0/20 [02:08<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.690, Loss_clf 0.876, Loss_aux 0.814, Train_accy 76.81, Test_accy 92.30:   5%|▌         | 1/20 [02:08<40:40, 128.45s/it]Task 1, Epoch 2/20 => Loss 1.029, Loss_clf 0.497, Loss_aux 0.532, Train_accy 85.13:   5%|▌         | 1/20 [03:57<40:40, 128.45s/it]                 Task 1, Epoch 2/20 => Loss 1.029, Loss_clf 0.497, Loss_aux 0.532, Train_accy 85.13:  10%|█         | 2/20 [03:57<35:04, 116.90s/it]Task 1, Epoch 3/20 => Loss 0.935, Loss_clf 0.457, Loss_aux 0.478, Train_accy 86.28:  10%|█         | 2/20 [05:46<35:04, 116.90s/it]Task 1, Epoch 3/20 => Loss 0.935, Loss_clf 0.457, Loss_aux 0.478, Train_accy 86.28:  15%|█▌        | 3/20 [05:46<32:05, 113.29s/it]Task 1, Epoch 4/20 => Loss 0.876, Loss_clf 0.428, Loss_aux 0.448, Train_accy 86.90:  15%|█▌        | 3/20 [07:35<32:05, 113.29s/it]Task 1, Epoch 4/20 => Loss 0.876, Loss_clf 0.428, Loss_aux 0.448, Train_accy 86.90:  20%|██        | 4/20 [07:35<29:44, 111.55s/it]Task 1, Epoch 5/20 => Loss 0.811, Loss_clf 0.397, Loss_aux 0.415, Train_accy 88.20:  20%|██        | 4/20 [09:23<29:44, 111.55s/it]Task 1, Epoch 5/20 => Loss 0.811, Loss_clf 0.397, Loss_aux 0.415, Train_accy 88.20:  25%|██▌       | 5/20 [09:23<27:38, 110.54s/it]Task 1, Epoch 6/20 => Loss 0.777, Loss_clf 0.382, Loss_aux 0.396, Train_accy 88.69, Test_accy 92.35:  25%|██▌       | 5/20 [11:32<27:38, 110.54s/it]Task 1, Epoch 6/20 => Loss 0.777, Loss_clf 0.382, Loss_aux 0.396, Train_accy 88.69, Test_accy 92.35:  30%|███       | 6/20 [11:32<27:15, 116.81s/it]Task 1, Epoch 7/20 => Loss 0.725, Loss_clf 0.359, Loss_aux 0.366, Train_accy 89.29:  30%|███       | 6/20 [13:21<27:15, 116.81s/it]                 Task 1, Epoch 7/20 => Loss 0.725, Loss_clf 0.359, Loss_aux 0.366, Train_accy 89.29:  35%|███▌      | 7/20 [13:21<24:44, 114.17s/it]Task 1, Epoch 8/20 => Loss 0.675, Loss_clf 0.333, Loss_aux 0.341, Train_accy 90.20:  35%|███▌      | 7/20 [15:10<24:44, 114.17s/it]Task 1, Epoch 8/20 => Loss 0.675, Loss_clf 0.333, Loss_aux 0.341, Train_accy 90.20:  40%|████      | 8/20 [15:10<22:29, 112.49s/it]Task 1, Epoch 9/20 => Loss 0.685, Loss_clf 0.340, Loss_aux 0.346, Train_accy 89.86:  40%|████      | 8/20 [16:59<22:29, 112.49s/it]Task 1, Epoch 9/20 => Loss 0.685, Loss_clf 0.340, Loss_aux 0.346, Train_accy 89.86:  45%|████▌     | 9/20 [16:59<20:25, 111.39s/it]Task 1, Epoch 10/20 => Loss 0.665, Loss_clf 0.330, Loss_aux 0.335, Train_accy 90.13:  45%|████▌     | 9/20 [18:48<20:25, 111.39s/it]Task 1, Epoch 10/20 => Loss 0.665, Loss_clf 0.330, Loss_aux 0.335, Train_accy 90.13:  50%|█████     | 10/20 [18:48<18:26, 110.63s/it]Task 1, Epoch 11/20 => Loss 0.668, Loss_clf 0.329, Loss_aux 0.340, Train_accy 90.22, Test_accy 92.88:  50%|█████     | 10/20 [20:57<18:26, 110.63s/it]Task 1, Epoch 11/20 => Loss 0.668, Loss_clf 0.329, Loss_aux 0.340, Train_accy 90.22, Test_accy 92.88:  55%|█████▌    | 11/20 [20:57<17:25, 116.22s/it]Task 1, Epoch 12/20 => Loss 0.677, Loss_clf 0.338, Loss_aux 0.339, Train_accy 89.92:  55%|█████▌    | 11/20 [22:46<17:25, 116.22s/it]                 Task 1, Epoch 12/20 => Loss 0.677, Loss_clf 0.338, Loss_aux 0.339, Train_accy 89.92:  60%|██████    | 12/20 [22:46<15:11, 113.97s/it]Task 1, Epoch 13/20 => Loss 0.623, Loss_clf 0.310, Loss_aux 0.313, Train_accy 90.77:  60%|██████    | 12/20 [24:35<15:11, 113.97s/it]Task 1, Epoch 13/20 => Loss 0.623, Loss_clf 0.310, Loss_aux 0.313, Train_accy 90.77:  65%|██████▌   | 13/20 [24:35<13:07, 112.48s/it]Task 1, Epoch 14/20 => Loss 0.605, Loss_clf 0.304, Loss_aux 0.301, Train_accy 91.15:  65%|██████▌   | 13/20 [26:23<13:07, 112.48s/it]Task 1, Epoch 14/20 => Loss 0.605, Loss_clf 0.304, Loss_aux 0.301, Train_accy 91.15:  70%|███████   | 14/20 [26:23<11:08, 111.36s/it]Task 1, Epoch 15/20 => Loss 0.595, Loss_clf 0.297, Loss_aux 0.298, Train_accy 91.22:  70%|███████   | 14/20 [28:13<11:08, 111.36s/it]Task 1, Epoch 15/20 => Loss 0.595, Loss_clf 0.297, Loss_aux 0.298, Train_accy 91.22:  75%|███████▌  | 15/20 [28:13<09:13, 110.69s/it]Task 1, Epoch 16/20 => Loss 0.589, Loss_clf 0.298, Loss_aux 0.290, Train_accy 91.24, Test_accy 93.82:  75%|███████▌  | 15/20 [30:21<09:13, 110.69s/it]Task 1, Epoch 16/20 => Loss 0.589, Loss_clf 0.298, Loss_aux 0.290, Train_accy 91.24, Test_accy 93.82:  80%|████████  | 16/20 [30:21<07:44, 116.17s/it]Task 1, Epoch 17/20 => Loss 0.566, Loss_clf 0.286, Loss_aux 0.280, Train_accy 91.69:  80%|████████  | 16/20 [32:10<07:44, 116.17s/it]                 Task 1, Epoch 17/20 => Loss 0.566, Loss_clf 0.286, Loss_aux 0.280, Train_accy 91.69:  85%|████████▌ | 17/20 [32:10<05:41, 113.95s/it]Task 1, Epoch 18/20 => Loss 0.570, Loss_clf 0.290, Loss_aux 0.281, Train_accy 91.56:  85%|████████▌ | 17/20 [33:59<05:41, 113.95s/it]Task 1, Epoch 18/20 => Loss 0.570, Loss_clf 0.290, Loss_aux 0.281, Train_accy 91.56:  90%|█████████ | 18/20 [33:59<03:44, 112.31s/it]Task 1, Epoch 19/20 => Loss 0.576, Loss_clf 0.294, Loss_aux 0.282, Train_accy 91.26:  90%|█████████ | 18/20 [35:48<03:44, 112.31s/it]Task 1, Epoch 19/20 => Loss 0.576, Loss_clf 0.294, Loss_aux 0.282, Train_accy 91.26:  95%|█████████▌| 19/20 [35:48<01:51, 111.35s/it]Task 1, Epoch 20/20 => Loss 0.583, Loss_clf 0.296, Loss_aux 0.288, Train_accy 91.13:  95%|█████████▌| 19/20 [37:37<01:51, 111.35s/it]Task 1, Epoch 20/20 => Loss 0.583, Loss_clf 0.296, Loss_aux 0.288, Train_accy 91.13: 100%|██████████| 20/20 [37:37<00:00, 110.63s/it]Task 1, Epoch 20/20 => Loss 0.583, Loss_clf 0.296, Loss_aux 0.288, Train_accy 91.13: 100%|██████████| 20/20 [37:37<00:00, 112.87s/it]
2024-04-27 01:26:29,299 [der.py] => Task 1, Epoch 20/20 => Loss 0.583, Loss_clf 0.296, Loss_aux 0.288, Train_accy 91.13
2024-04-27 01:26:29,301 [base.py] => Reducing exemplars...(50 per classes)
2024-04-27 01:26:39,592 [base.py] => Constructing exemplars...(50 per classes)
2024-04-27 01:28:26,379 [der.py] => Exemplar size: 2000
2024-04-27 01:28:26,380 [trainer.py] => CNN: {'total': 93.42, '00-19': 91.0, '20-39': 95.85, 'old': 91.0, 'new': 95.85}
2024-04-27 01:28:26,380 [trainer.py] => NME: {'total': 93.88, '00-19': 93.25, '20-39': 94.5, 'old': 93.25, 'new': 94.5}
2024-04-27 01:28:26,380 [trainer.py] => CNN top1 curve: [96.15, 93.42]
2024-04-27 01:28:26,380 [trainer.py] => CNN top5 curve: [99.65, 99.28]
2024-04-27 01:28:26,380 [trainer.py] => NME top1 curve: [96.7, 93.88]
2024-04-27 01:28:26,380 [trainer.py] => NME top5 curve: [99.75, 99.4]

Average Accuracy (CNN): 94.78
Average Accuracy (NME): 95.29
2024-04-27 01:28:26,380 [trainer.py] => Average Accuracy (CNN): 94.78
2024-04-27 01:28:26,380 [trainer.py] => Average Accuracy (NME): 95.29
2024-04-27 01:28:26,380 [trainer.py] => Train Time: 3625.6800000000003
2024-04-27 01:28:26,380 [trainer.py] => Test Time: 50.59 

2024-04-27 01:28:26,381 [trainer.py] => All params: 171674941
2024-04-27 01:28:26,382 [trainer.py] => Trainable params: 85876285
2024-04-27 01:28:28,050 [der.py] => Learning on 40-60
2024-04-27 01:28:28,053 [der.py] => All params: 257550417
2024-04-27 01:28:28,055 [der.py] => Trainable params: 85953105
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.832, Loss_clf 0.994, Loss_aux 0.838, Train_accy 75.27, Test_accy 86.43:   0%|          | 0/20 [03:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.832, Loss_clf 0.994, Loss_aux 0.838, Train_accy 75.27, Test_accy 86.43:   5%|▌         | 1/20 [03:00<57:08, 180.47s/it]Task 2, Epoch 2/20 => Loss 1.028, Loss_clf 0.512, Loss_aux 0.517, Train_accy 84.58:   5%|▌         | 1/20 [05:17<57:08, 180.47s/it]                 Task 2, Epoch 2/20 => Loss 1.028, Loss_clf 0.512, Loss_aux 0.517, Train_accy 84.58:  10%|█         | 2/20 [05:17<46:26, 154.83s/it]Task 2, Epoch 3/20 => Loss 0.896, Loss_clf 0.449, Loss_aux 0.447, Train_accy 86.69:  10%|█         | 2/20 [07:34<46:26, 154.83s/it]Task 2, Epoch 3/20 => Loss 0.896, Loss_clf 0.449, Loss_aux 0.447, Train_accy 86.69:  15%|█▌        | 3/20 [07:34<41:33, 146.68s/it]Task 2, Epoch 4/20 => Loss 0.864, Loss_clf 0.430, Loss_aux 0.435, Train_accy 87.19:  15%|█▌        | 3/20 [09:51<41:33, 146.68s/it]Task 2, Epoch 4/20 => Loss 0.864, Loss_clf 0.430, Loss_aux 0.435, Train_accy 87.19:  20%|██        | 4/20 [09:51<38:07, 142.95s/it]Task 2, Epoch 5/20 => Loss 0.816, Loss_clf 0.407, Loss_aux 0.408, Train_accy 88.08:  20%|██        | 4/20 [12:08<38:07, 142.95s/it]Task 2, Epoch 5/20 => Loss 0.816, Loss_clf 0.407, Loss_aux 0.408, Train_accy 88.08:  25%|██▌       | 5/20 [12:08<35:11, 140.74s/it]Task 2, Epoch 6/20 => Loss 0.788, Loss_clf 0.398, Loss_aux 0.390, Train_accy 88.12, Test_accy 88.95:  25%|██▌       | 5/20 [15:09<35:11, 140.74s/it]Task 2, Epoch 6/20 => Loss 0.788, Loss_clf 0.398, Loss_aux 0.390, Train_accy 88.12, Test_accy 88.95:  30%|███       | 6/20 [15:09<36:00, 154.30s/it]Task 2, Epoch 7/20 => Loss 0.749, Loss_clf 0.379, Loss_aux 0.371, Train_accy 88.92:  30%|███       | 6/20 [17:26<36:00, 154.30s/it]                 Task 2, Epoch 7/20 => Loss 0.749, Loss_clf 0.379, Loss_aux 0.371, Train_accy 88.92:  35%|███▌      | 7/20 [17:26<32:12, 148.67s/it]Task 2, Epoch 8/20 => Loss 0.748, Loss_clf 0.380, Loss_aux 0.368, Train_accy 89.00:  35%|███▌      | 7/20 [19:43<32:12, 148.67s/it]Task 2, Epoch 8/20 => Loss 0.748, Loss_clf 0.380, Loss_aux 0.368, Train_accy 89.00:  40%|████      | 8/20 [19:43<28:59, 144.94s/it]Task 2, Epoch 9/20 => Loss 0.691, Loss_clf 0.356, Loss_aux 0.335, Train_accy 89.70:  40%|████      | 8/20 [22:00<28:59, 144.94s/it]Task 2, Epoch 9/20 => Loss 0.691, Loss_clf 0.356, Loss_aux 0.335, Train_accy 89.70:  45%|████▌     | 9/20 [22:00<26:07, 142.48s/it]Task 2, Epoch 10/20 => Loss 0.684, Loss_clf 0.346, Loss_aux 0.339, Train_accy 89.79:  45%|████▌     | 9/20 [24:17<26:07, 142.48s/it]Task 2, Epoch 10/20 => Loss 0.684, Loss_clf 0.346, Loss_aux 0.339, Train_accy 89.79:  50%|█████     | 10/20 [24:17<23:27, 140.78s/it]Task 2, Epoch 11/20 => Loss 0.643, Loss_clf 0.329, Loss_aux 0.314, Train_accy 90.31, Test_accy 88.90:  50%|█████     | 10/20 [27:17<23:27, 140.78s/it]Task 2, Epoch 11/20 => Loss 0.643, Loss_clf 0.329, Loss_aux 0.314, Train_accy 90.31, Test_accy 88.90:  55%|█████▌    | 11/20 [27:17<22:57, 153.02s/it]Task 2, Epoch 12/20 => Loss 0.670, Loss_clf 0.346, Loss_aux 0.324, Train_accy 90.08:  55%|█████▌    | 11/20 [29:34<22:57, 153.02s/it]                 Task 2, Epoch 12/20 => Loss 0.670, Loss_clf 0.346, Loss_aux 0.324, Train_accy 90.08:  60%|██████    | 12/20 [29:34<19:45, 148.19s/it]Task 2, Epoch 13/20 => Loss 0.677, Loss_clf 0.343, Loss_aux 0.334, Train_accy 89.94:  60%|██████    | 12/20 [31:51<19:45, 148.19s/it]Task 2, Epoch 13/20 => Loss 0.677, Loss_clf 0.343, Loss_aux 0.334, Train_accy 89.94:  65%|██████▌   | 13/20 [31:51<16:53, 144.77s/it]Task 2, Epoch 14/20 => Loss 0.624, Loss_clf 0.317, Loss_aux 0.307, Train_accy 90.91:  65%|██████▌   | 13/20 [34:08<16:53, 144.77s/it]Task 2, Epoch 14/20 => Loss 0.624, Loss_clf 0.317, Loss_aux 0.307, Train_accy 90.91:  70%|███████   | 14/20 [34:08<14:14, 142.39s/it]Task 2, Epoch 15/20 => Loss 0.608, Loss_clf 0.311, Loss_aux 0.296, Train_accy 90.95:  70%|███████   | 14/20 [36:25<14:14, 142.39s/it]Task 2, Epoch 15/20 => Loss 0.608, Loss_clf 0.311, Loss_aux 0.296, Train_accy 90.95:  75%|███████▌  | 15/20 [36:25<11:43, 140.75s/it]Task 2, Epoch 16/20 => Loss 0.586, Loss_clf 0.301, Loss_aux 0.285, Train_accy 91.32, Test_accy 90.13:  75%|███████▌  | 15/20 [39:26<11:43, 140.75s/it]Task 2, Epoch 16/20 => Loss 0.586, Loss_clf 0.301, Loss_aux 0.285, Train_accy 91.32, Test_accy 90.13:  80%|████████  | 16/20 [39:26<10:11, 152.79s/it]Task 2, Epoch 17/20 => Loss 0.574, Loss_clf 0.290, Loss_aux 0.284, Train_accy 91.57:  80%|████████  | 16/20 [41:43<10:11, 152.79s/it]                 Task 2, Epoch 17/20 => Loss 0.574, Loss_clf 0.290, Loss_aux 0.284, Train_accy 91.57:  85%|████████▌ | 17/20 [41:43<07:24, 148.05s/it]Task 2, Epoch 18/20 => Loss 0.563, Loss_clf 0.289, Loss_aux 0.274, Train_accy 91.46:  85%|████████▌ | 17/20 [44:00<07:24, 148.05s/it]Task 2, Epoch 18/20 => Loss 0.563, Loss_clf 0.289, Loss_aux 0.274, Train_accy 91.46:  90%|█████████ | 18/20 [44:00<04:49, 144.74s/it]Task 2, Epoch 19/20 => Loss 0.553, Loss_clf 0.288, Loss_aux 0.265, Train_accy 91.69:  90%|█████████ | 18/20 [46:17<04:49, 144.74s/it]Task 2, Epoch 19/20 => Loss 0.553, Loss_clf 0.288, Loss_aux 0.265, Train_accy 91.69:  95%|█████████▌| 19/20 [46:17<02:22, 142.49s/it]Task 2, Epoch 20/20 => Loss 0.561, Loss_clf 0.289, Loss_aux 0.271, Train_accy 91.52:  95%|█████████▌| 19/20 [48:34<02:22, 142.49s/it]Task 2, Epoch 20/20 => Loss 0.561, Loss_clf 0.289, Loss_aux 0.271, Train_accy 91.52: 100%|██████████| 20/20 [48:34<00:00, 140.86s/it]Task 2, Epoch 20/20 => Loss 0.561, Loss_clf 0.289, Loss_aux 0.271, Train_accy 91.52: 100%|██████████| 20/20 [48:34<00:00, 145.74s/it]
2024-04-27 02:17:03,121 [der.py] => Task 2, Epoch 20/20 => Loss 0.561, Loss_clf 0.289, Loss_aux 0.271, Train_accy 91.52
2024-04-27 02:17:03,123 [base.py] => Reducing exemplars...(33 per classes)
2024-04-27 02:17:22,754 [base.py] => Constructing exemplars...(33 per classes)
2024-04-27 02:20:21,617 [der.py] => Exemplar size: 1980
2024-04-27 02:20:21,617 [trainer.py] => CNN: {'total': 89.62, '00-19': 83.9, '20-39': 89.4, '40-59': 95.55, 'old': 86.65, 'new': 95.55}
2024-04-27 02:20:21,617 [trainer.py] => NME: {'total': 91.73, '00-19': 89.85, '20-39': 92.5, '40-59': 92.85, 'old': 91.18, 'new': 92.85}
2024-04-27 02:20:21,617 [trainer.py] => CNN top1 curve: [96.15, 93.42, 89.62]
2024-04-27 02:20:21,617 [trainer.py] => CNN top5 curve: [99.65, 99.28, 98.72]
2024-04-27 02:20:21,617 [trainer.py] => NME top1 curve: [96.7, 93.88, 91.73]
2024-04-27 02:20:21,617 [trainer.py] => NME top5 curve: [99.75, 99.4, 99.33]

Average Accuracy (CNN): 93.06
Average Accuracy (NME): 94.1
2024-04-27 02:20:21,618 [trainer.py] => Average Accuracy (CNN): 93.06
2024-04-27 02:20:21,618 [trainer.py] => Average Accuracy (NME): 94.1
2024-04-27 02:20:21,618 [trainer.py] => Train Time: 6540.620000000001
2024-04-27 02:20:21,618 [trainer.py] => Test Time: 139.09 

2024-04-27 02:20:21,619 [trainer.py] => All params: 257550417
2024-04-27 02:20:21,621 [trainer.py] => Trainable params: 85953105
2024-04-27 02:20:23,198 [der.py] => Learning on 60-80
2024-04-27 02:20:23,201 [der.py] => All params: 343456613
2024-04-27 02:20:23,203 [der.py] => Trainable params: 86060645
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.887, Loss_clf 1.098, Loss_aux 0.790, Train_accy 75.88, Test_accy 82.91:   0%|          | 0/20 [04:02<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.887, Loss_clf 1.098, Loss_aux 0.790, Train_accy 75.88, Test_accy 82.91:   5%|▌         | 1/20 [04:02<1:16:51, 242.72s/it]Task 3, Epoch 2/20 => Loss 1.014, Loss_clf 0.521, Loss_aux 0.494, Train_accy 84.21:   5%|▌         | 1/20 [06:47<1:16:51, 242.72s/it]                 Task 3, Epoch 2/20 => Loss 1.014, Loss_clf 0.521, Loss_aux 0.494, Train_accy 84.21:  10%|█         | 2/20 [06:47<59:05, 196.99s/it]  Task 3, Epoch 3/20 => Loss 0.927, Loss_clf 0.480, Loss_aux 0.448, Train_accy 85.65:  10%|█         | 2/20 [09:32<59:05, 196.99s/it]Task 3, Epoch 3/20 => Loss 0.927, Loss_clf 0.480, Loss_aux 0.448, Train_accy 85.65:  15%|█▌        | 3/20 [09:32<51:41, 182.42s/it]Task 3, Epoch 4/20 => Loss 0.857, Loss_clf 0.443, Loss_aux 0.413, Train_accy 86.79:  15%|█▌        | 3/20 [12:17<51:41, 182.42s/it]Task 3, Epoch 4/20 => Loss 0.857, Loss_clf 0.443, Loss_aux 0.413, Train_accy 86.79:  20%|██        | 4/20 [12:17<46:47, 175.44s/it]Task 3, Epoch 5/20 => Loss 0.809, Loss_clf 0.420, Loss_aux 0.389, Train_accy 87.75:  20%|██        | 4/20 [15:01<46:47, 175.44s/it]Task 3, Epoch 5/20 => Loss 0.809, Loss_clf 0.420, Loss_aux 0.389, Train_accy 87.75:  25%|██▌       | 5/20 [15:01<42:52, 171.48s/it]Task 3, Epoch 6/20 => Loss 0.739, Loss_clf 0.383, Loss_aux 0.356, Train_accy 88.87, Test_accy 85.15:  25%|██▌       | 5/20 [19:03<42:52, 171.48s/it]Task 3, Epoch 6/20 => Loss 0.739, Loss_clf 0.383, Loss_aux 0.356, Train_accy 88.87, Test_accy 85.15:  30%|███       | 6/20 [19:03<45:32, 195.16s/it]Task 3, Epoch 7/20 => Loss 0.718, Loss_clf 0.368, Loss_aux 0.350, Train_accy 89.14:  30%|███       | 6/20 [21:47<45:32, 195.16s/it]                 Task 3, Epoch 7/20 => Loss 0.718, Loss_clf 0.368, Loss_aux 0.350, Train_accy 89.14:  35%|███▌      | 7/20 [21:47<40:07, 185.22s/it]Task 3, Epoch 8/20 => Loss 0.689, Loss_clf 0.357, Loss_aux 0.332, Train_accy 89.73:  35%|███▌      | 7/20 [24:32<40:07, 185.22s/it]Task 3, Epoch 8/20 => Loss 0.689, Loss_clf 0.357, Loss_aux 0.332, Train_accy 89.73:  40%|████      | 8/20 [24:32<35:45, 178.81s/it]Task 3, Epoch 9/20 => Loss 0.685, Loss_clf 0.354, Loss_aux 0.331, Train_accy 89.86:  40%|████      | 8/20 [27:17<35:45, 178.81s/it]Task 3, Epoch 9/20 => Loss 0.685, Loss_clf 0.354, Loss_aux 0.331, Train_accy 89.86:  45%|████▌     | 9/20 [27:17<31:59, 174.46s/it]Task 3, Epoch 10/20 => Loss 0.625, Loss_clf 0.322, Loss_aux 0.302, Train_accy 90.29:  45%|████▌     | 9/20 [30:02<31:59, 174.46s/it]Task 3, Epoch 10/20 => Loss 0.625, Loss_clf 0.322, Loss_aux 0.302, Train_accy 90.29:  50%|█████     | 10/20 [30:02<28:35, 171.54s/it]Task 3, Epoch 11/20 => Loss 0.648, Loss_clf 0.335, Loss_aux 0.312, Train_accy 90.13, Test_accy 84.60:  50%|█████     | 10/20 [34:05<28:35, 171.54s/it]Task 3, Epoch 11/20 => Loss 0.648, Loss_clf 0.335, Loss_aux 0.312, Train_accy 90.13, Test_accy 84.60:  55%|█████▌    | 11/20 [34:05<29:00, 193.44s/it]Task 3, Epoch 12/20 => Loss 0.626, Loss_clf 0.325, Loss_aux 0.301, Train_accy 90.68:  55%|█████▌    | 11/20 [36:51<29:00, 193.44s/it]                 Task 3, Epoch 12/20 => Loss 0.626, Loss_clf 0.325, Loss_aux 0.301, Train_accy 90.68:  60%|██████    | 12/20 [36:51<24:38, 184.85s/it]Task 3, Epoch 13/20 => Loss 0.626, Loss_clf 0.324, Loss_aux 0.302, Train_accy 90.54:  60%|██████    | 12/20 [39:36<24:38, 184.85s/it]Task 3, Epoch 13/20 => Loss 0.626, Loss_clf 0.324, Loss_aux 0.302, Train_accy 90.54:  65%|██████▌   | 13/20 [39:36<20:53, 179.03s/it]Task 3, Epoch 14/20 => Loss 0.585, Loss_clf 0.303, Loss_aux 0.282, Train_accy 91.33:  65%|██████▌   | 13/20 [42:21<20:53, 179.03s/it]Task 3, Epoch 14/20 => Loss 0.585, Loss_clf 0.303, Loss_aux 0.282, Train_accy 91.33:  70%|███████   | 14/20 [42:21<17:29, 174.84s/it]Task 3, Epoch 15/20 => Loss 0.599, Loss_clf 0.309, Loss_aux 0.290, Train_accy 91.25:  70%|███████   | 14/20 [45:06<17:29, 174.84s/it]Task 3, Epoch 15/20 => Loss 0.599, Loss_clf 0.309, Loss_aux 0.290, Train_accy 91.25:  75%|███████▌  | 15/20 [45:06<14:19, 171.87s/it]Task 3, Epoch 16/20 => Loss 0.584, Loss_clf 0.303, Loss_aux 0.280, Train_accy 91.47, Test_accy 85.58:  75%|███████▌  | 15/20 [49:08<14:19, 171.87s/it]Task 3, Epoch 16/20 => Loss 0.584, Loss_clf 0.303, Loss_aux 0.280, Train_accy 91.47, Test_accy 85.58:  80%|████████  | 16/20 [49:08<12:51, 192.98s/it]Task 3, Epoch 17/20 => Loss 0.578, Loss_clf 0.300, Loss_aux 0.279, Train_accy 91.28:  80%|████████  | 16/20 [51:53<12:51, 192.98s/it]                 Task 3, Epoch 17/20 => Loss 0.578, Loss_clf 0.300, Loss_aux 0.279, Train_accy 91.28:  85%|████████▌ | 17/20 [51:53<09:13, 184.41s/it]Task 3, Epoch 18/20 => Loss 0.556, Loss_clf 0.291, Loss_aux 0.265, Train_accy 91.69:  85%|████████▌ | 17/20 [54:37<09:13, 184.41s/it]Task 3, Epoch 18/20 => Loss 0.556, Loss_clf 0.291, Loss_aux 0.265, Train_accy 91.69:  90%|█████████ | 18/20 [54:37<05:56, 178.42s/it]Task 3, Epoch 19/20 => Loss 0.568, Loss_clf 0.298, Loss_aux 0.270, Train_accy 91.69:  90%|█████████ | 18/20 [57:22<05:56, 178.42s/it]Task 3, Epoch 19/20 => Loss 0.568, Loss_clf 0.298, Loss_aux 0.270, Train_accy 91.69:  95%|█████████▌| 19/20 [57:22<02:54, 174.22s/it]Task 3, Epoch 20/20 => Loss 0.536, Loss_clf 0.282, Loss_aux 0.253, Train_accy 91.96:  95%|█████████▌| 19/20 [1:00:06<02:54, 174.22s/it]Task 3, Epoch 20/20 => Loss 0.536, Loss_clf 0.282, Loss_aux 0.253, Train_accy 91.96: 100%|██████████| 20/20 [1:00:06<00:00, 171.33s/it]Task 3, Epoch 20/20 => Loss 0.536, Loss_clf 0.282, Loss_aux 0.253, Train_accy 91.96: 100%|██████████| 20/20 [1:00:06<00:00, 180.35s/it]
2024-04-27 03:20:30,287 [der.py] => Task 3, Epoch 20/20 => Loss 0.536, Loss_clf 0.282, Loss_aux 0.253, Train_accy 91.96
2024-04-27 03:20:30,289 [base.py] => Reducing exemplars...(25 per classes)
2024-04-27 03:21:00,452 [base.py] => Constructing exemplars...(25 per classes)
2024-04-27 03:25:29,759 [der.py] => Exemplar size: 2000
2024-04-27 03:25:29,759 [trainer.py] => CNN: {'total': 84.02, '00-19': 79.25, '20-39': 86.5, '40-59': 76.1, '60-79': 94.25, 'old': 80.62, 'new': 94.25}
2024-04-27 03:25:29,759 [trainer.py] => NME: {'total': 88.48, '00-19': 86.25, '20-39': 90.85, '40-59': 87.05, '60-79': 89.75, 'old': 88.05, 'new': 89.75}
2024-04-27 03:25:29,759 [trainer.py] => CNN top1 curve: [96.15, 93.42, 89.62, 84.02]
2024-04-27 03:25:29,759 [trainer.py] => CNN top5 curve: [99.65, 99.28, 98.72, 97.86]
2024-04-27 03:25:29,759 [trainer.py] => NME top1 curve: [96.7, 93.88, 91.73, 88.48]
2024-04-27 03:25:29,759 [trainer.py] => NME top5 curve: [99.75, 99.4, 99.33, 98.98]

Average Accuracy (CNN): 90.8
Average Accuracy (NME): 92.7
2024-04-27 03:25:29,759 [trainer.py] => Average Accuracy (CNN): 90.8
2024-04-27 03:25:29,759 [trainer.py] => Average Accuracy (NME): 92.7
2024-04-27 03:25:29,759 [trainer.py] => Train Time: 10147.61
2024-04-27 03:25:29,759 [trainer.py] => Test Time: 294.40999999999997 

2024-04-27 03:25:29,762 [trainer.py] => All params: 343456613
2024-04-27 03:25:29,763 [trainer.py] => Trainable params: 86060645
2024-04-27 03:25:31,328 [der.py] => Learning on 80-100
2024-04-27 03:25:31,332 [der.py] => All params: 429393529
2024-04-27 03:25:31,334 [der.py] => Trainable params: 86198905
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.981, Loss_clf 1.140, Loss_aux 0.840, Train_accy 76.47, Test_accy 81.50:   0%|          | 0/20 [05:13<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.981, Loss_clf 1.140, Loss_aux 0.840, Train_accy 76.47, Test_accy 81.50:   5%|▌         | 1/20 [05:13<1:39:09, 313.14s/it]Task 4, Epoch 2/20 => Loss 1.008, Loss_clf 0.513, Loss_aux 0.495, Train_accy 85.60:   5%|▌         | 1/20 [08:26<1:39:09, 313.14s/it]                 Task 4, Epoch 2/20 => Loss 1.008, Loss_clf 0.513, Loss_aux 0.495, Train_accy 85.60:  10%|█         | 2/20 [08:26<1:12:48, 242.70s/it]Task 4, Epoch 3/20 => Loss 0.881, Loss_clf 0.456, Loss_aux 0.425, Train_accy 87.02:  10%|█         | 2/20 [11:39<1:12:48, 242.70s/it]Task 4, Epoch 3/20 => Loss 0.881, Loss_clf 0.456, Loss_aux 0.425, Train_accy 87.02:  15%|█▌        | 3/20 [11:39<1:02:22, 220.17s/it]Task 4, Epoch 4/20 => Loss 0.831, Loss_clf 0.428, Loss_aux 0.402, Train_accy 87.62:  15%|█▌        | 3/20 [14:53<1:02:22, 220.17s/it]Task 4, Epoch 4/20 => Loss 0.831, Loss_clf 0.428, Loss_aux 0.402, Train_accy 87.62:  20%|██        | 4/20 [14:53<55:53, 209.60s/it]  Task 4, Epoch 5/20 => Loss 0.785, Loss_clf 0.400, Loss_aux 0.384, Train_accy 88.57:  20%|██        | 4/20 [18:06<55:53, 209.60s/it]Task 4, Epoch 5/20 => Loss 0.785, Loss_clf 0.400, Loss_aux 0.384, Train_accy 88.57:  25%|██▌       | 5/20 [18:06<50:56, 203.76s/it]Task 4, Epoch 6/20 => Loss 0.725, Loss_clf 0.375, Loss_aux 0.350, Train_accy 89.31, Test_accy 80.43:  25%|██▌       | 5/20 [23:20<50:56, 203.76s/it]Task 4, Epoch 6/20 => Loss 0.725, Loss_clf 0.375, Loss_aux 0.350, Train_accy 89.31, Test_accy 80.43:  30%|███       | 6/20 [23:20<56:15, 241.12s/it]Task 4, Epoch 7/20 => Loss 0.671, Loss_clf 0.344, Loss_aux 0.327, Train_accy 90.25:  30%|███       | 6/20 [26:33<56:15, 241.12s/it]                 Task 4, Epoch 7/20 => Loss 0.671, Loss_clf 0.344, Loss_aux 0.327, Train_accy 90.25:  35%|███▌      | 7/20 [26:33<48:51, 225.53s/it]Task 4, Epoch 8/20 => Loss 0.666, Loss_clf 0.343, Loss_aux 0.324, Train_accy 90.72:  35%|███▌      | 7/20 [29:46<48:51, 225.53s/it]Task 4, Epoch 8/20 => Loss 0.666, Loss_clf 0.343, Loss_aux 0.324, Train_accy 90.72:  40%|████      | 8/20 [29:46<43:02, 215.23s/it]Task 4, Epoch 9/20 => Loss 0.656, Loss_clf 0.340, Loss_aux 0.316, Train_accy 90.64:  40%|████      | 8/20 [32:59<43:02, 215.23s/it]Task 4, Epoch 9/20 => Loss 0.656, Loss_clf 0.340, Loss_aux 0.316, Train_accy 90.64:  45%|████▌     | 9/20 [32:59<38:10, 208.23s/it]Task 4, Epoch 10/20 => Loss 0.663, Loss_clf 0.339, Loss_aux 0.323, Train_accy 90.33:  45%|████▌     | 9/20 [36:12<38:10, 208.23s/it]Task 4, Epoch 10/20 => Loss 0.663, Loss_clf 0.339, Loss_aux 0.323, Train_accy 90.33:  50%|█████     | 10/20 [36:12<33:54, 203.42s/it]Task 4, Epoch 11/20 => Loss 0.626, Loss_clf 0.323, Loss_aux 0.303, Train_accy 91.08, Test_accy 81.99:  50%|█████     | 10/20 [41:24<33:54, 203.42s/it]Task 4, Epoch 11/20 => Loss 0.626, Loss_clf 0.323, Loss_aux 0.303, Train_accy 91.08, Test_accy 81.99:  55%|█████▌    | 11/20 [41:24<35:30, 236.74s/it]Task 4, Epoch 12/20 => Loss 0.617, Loss_clf 0.318, Loss_aux 0.298, Train_accy 91.27:  55%|█████▌    | 11/20 [44:37<35:30, 236.74s/it]                 Task 4, Epoch 12/20 => Loss 0.617, Loss_clf 0.318, Loss_aux 0.298, Train_accy 91.27:  60%|██████    | 12/20 [44:37<29:47, 223.49s/it]Task 4, Epoch 13/20 => Loss 0.588, Loss_clf 0.305, Loss_aux 0.283, Train_accy 91.30:  60%|██████    | 12/20 [47:51<29:47, 223.49s/it]Task 4, Epoch 13/20 => Loss 0.588, Loss_clf 0.305, Loss_aux 0.283, Train_accy 91.30:  65%|██████▌   | 13/20 [47:51<25:00, 214.36s/it]Task 4, Epoch 14/20 => Loss 0.603, Loss_clf 0.317, Loss_aux 0.286, Train_accy 91.12:  65%|██████▌   | 13/20 [51:04<25:00, 214.36s/it]Task 4, Epoch 14/20 => Loss 0.603, Loss_clf 0.317, Loss_aux 0.286, Train_accy 91.12:  70%|███████   | 14/20 [51:04<20:48, 208.00s/it]Task 4, Epoch 15/20 => Loss 0.550, Loss_clf 0.287, Loss_aux 0.263, Train_accy 91.82:  70%|███████   | 14/20 [54:18<20:48, 208.00s/it]Task 4, Epoch 15/20 => Loss 0.550, Loss_clf 0.287, Loss_aux 0.263, Train_accy 91.82:  75%|███████▌  | 15/20 [54:18<16:58, 203.70s/it]Task 4, Epoch 16/20 => Loss 0.558, Loss_clf 0.290, Loss_aux 0.268, Train_accy 91.98, Test_accy 81.51:  75%|███████▌  | 15/20 [59:32<16:58, 203.70s/it]Task 4, Epoch 16/20 => Loss 0.558, Loss_clf 0.290, Loss_aux 0.268, Train_accy 91.98, Test_accy 81.51:  80%|████████  | 16/20 [59:32<15:47, 236.82s/it]Task 4, Epoch 17/20 => Loss 0.580, Loss_clf 0.308, Loss_aux 0.272, Train_accy 91.45:  80%|████████  | 16/20 [1:02:44<15:47, 236.82s/it]               Task 4, Epoch 17/20 => Loss 0.580, Loss_clf 0.308, Loss_aux 0.272, Train_accy 91.45:  85%|████████▌ | 17/20 [1:02:44<11:10, 223.57s/it]Task 4, Epoch 18/20 => Loss 0.561, Loss_clf 0.293, Loss_aux 0.268, Train_accy 91.81:  85%|████████▌ | 17/20 [1:05:57<11:10, 223.57s/it]Task 4, Epoch 18/20 => Loss 0.561, Loss_clf 0.293, Loss_aux 0.268, Train_accy 91.81:  90%|█████████ | 18/20 [1:05:57<07:08, 214.27s/it]Task 4, Epoch 19/20 => Loss 0.547, Loss_clf 0.290, Loss_aux 0.257, Train_accy 91.96:  90%|█████████ | 18/20 [1:09:10<07:08, 214.27s/it]Task 4, Epoch 19/20 => Loss 0.547, Loss_clf 0.290, Loss_aux 0.257, Train_accy 91.96:  95%|█████████▌| 19/20 [1:09:10<03:27, 207.82s/it]Task 4, Epoch 20/20 => Loss 0.541, Loss_clf 0.278, Loss_aux 0.263, Train_accy 92.14:  95%|█████████▌| 19/20 [1:12:23<03:27, 207.82s/it]Task 4, Epoch 20/20 => Loss 0.541, Loss_clf 0.278, Loss_aux 0.263, Train_accy 92.14: 100%|██████████| 20/20 [1:12:23<00:00, 203.39s/it]Task 4, Epoch 20/20 => Loss 0.541, Loss_clf 0.278, Loss_aux 0.263, Train_accy 92.14: 100%|██████████| 20/20 [1:12:23<00:00, 217.16s/it]
2024-04-27 04:37:54,750 [der.py] => Task 4, Epoch 20/20 => Loss 0.541, Loss_clf 0.278, Loss_aux 0.263, Train_accy 92.14
2024-04-27 04:37:54,752 [base.py] => Reducing exemplars...(20 per classes)
2024-04-27 04:38:35,599 [base.py] => Constructing exemplars...(20 per classes)
2024-04-27 04:44:54,476 [der.py] => Exemplar size: 2000
2024-04-27 04:44:54,476 [trainer.py] => CNN: {'total': 81.34, '00-19': 73.6, '20-39': 82.85, '40-59': 73.0, '60-79': 81.6, '80-99': 95.65, 'old': 77.76, 'new': 95.65}
2024-04-27 04:44:54,476 [trainer.py] => NME: {'total': 86.37, '00-19': 82.15, '20-39': 88.85, '40-59': 83.25, '60-79': 87.95, '80-99': 89.65, 'old': 85.55, 'new': 89.65}
2024-04-27 04:44:54,476 [trainer.py] => CNN top1 curve: [96.15, 93.42, 89.62, 84.02, 81.34]
2024-04-27 04:44:54,476 [trainer.py] => CNN top5 curve: [99.65, 99.28, 98.72, 97.86, 96.38]
2024-04-27 04:44:54,476 [trainer.py] => NME top1 curve: [96.7, 93.88, 91.73, 88.48, 86.37]
2024-04-27 04:44:54,476 [trainer.py] => NME top5 curve: [99.75, 99.4, 99.33, 98.98, 98.29]

Average Accuracy (CNN): 88.91
Average Accuracy (NME): 91.43
2024-04-27 04:44:54,476 [trainer.py] => Average Accuracy (CNN): 88.91
2024-04-27 04:44:54,477 [trainer.py] => Average Accuracy (NME): 91.43
2024-04-27 04:44:54,477 [trainer.py] => Train Time: 14490.93
2024-04-27 04:44:54,477 [trainer.py] => Test Time: 536.06 

Accuracy Matrix (CNN):
[[96.15 91.   83.9  79.25 73.6 ]
 [ 0.   95.85 89.4  86.5  82.85]
 [ 0.    0.   95.55 76.1  73.  ]
 [ 0.    0.    0.   94.25 81.6 ]
 [ 0.    0.    0.    0.   95.65]]
2024-04-27 04:44:54,478 [trainer.py] => Forgetting (CNN): 17.687500000000004
Accuracy Matrix (NME):
[[96.7  93.25 89.85 86.25 82.15]
 [ 0.   94.5  92.5  90.85 88.85]
 [ 0.    0.   92.85 87.05 83.25]
 [ 0.    0.    0.   89.75 87.95]
 [ 0.    0.    0.    0.   89.65]]
2024-04-27 04:44:54,478 [trainer.py] => Forgetting (NME): 7.899999999999999
2024-04-27 04:44:57,265 [trainer.py] => config: ./exps/foster_cifar_B0_Inc5.json
2024-04-27 04:44:57,265 [trainer.py] => prefix: cil
2024-04-27 04:44:57,265 [trainer.py] => dataset: cifar224
2024-04-27 04:44:57,265 [trainer.py] => memory_size: 2000
2024-04-27 04:44:57,265 [trainer.py] => memory_per_class: 20
2024-04-27 04:44:57,265 [trainer.py] => fixed_memory: True
2024-04-27 04:44:57,265 [trainer.py] => shuffle: True
2024-04-27 04:44:57,265 [trainer.py] => init_cls: 20
2024-04-27 04:44:57,265 [trainer.py] => increment: 20
2024-04-27 04:44:57,265 [trainer.py] => model_name: foster
2024-04-27 04:44:57,265 [trainer.py] => backbone_type: vit_base_patch16_224_in21k
2024-04-27 04:44:57,266 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-27 04:44:57,266 [trainer.py] => seed: 1993
2024-04-27 04:44:57,266 [trainer.py] => beta1: 0.96
2024-04-27 04:44:57,266 [trainer.py] => beta2: 0.97
2024-04-27 04:44:57,266 [trainer.py] => oofc: ft
2024-04-27 04:44:57,266 [trainer.py] => is_teacher_wa: False
2024-04-27 04:44:57,266 [trainer.py] => is_student_wa: False
2024-04-27 04:44:57,266 [trainer.py] => lambda_okd: 1
2024-04-27 04:44:57,266 [trainer.py] => wa_value: 1
2024-04-27 04:44:57,266 [trainer.py] => init_epochs: 1
2024-04-27 04:44:57,266 [trainer.py] => init_lr: 0.001
2024-04-27 04:44:57,266 [trainer.py] => init_weight_decay: 0.0005
2024-04-27 04:44:57,266 [trainer.py] => boosting_epochs: 1
2024-04-27 04:44:57,266 [trainer.py] => compression_epochs: 1
2024-04-27 04:44:57,266 [trainer.py] => lr: 0.001
2024-04-27 04:44:57,266 [trainer.py] => batch_size: 48
2024-04-27 04:44:57,266 [trainer.py] => weight_decay: 0.0005
2024-04-27 04:44:57,266 [trainer.py] => num_workers: 8
2024-04-27 04:44:57,266 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2024-04-27 04:44:59,062 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-27 04:44:59,457 [trainer.py] => All params: 0
2024-04-27 04:44:59,457 [trainer.py] => Trainable params: 0
2024-04-27 04:45:00,989 [foster.py] => Learning on 0-20
2024-04-27 04:45:00,990 [foster.py] => All params: 85829416
2024-04-27 04:45:00,990 [foster.py] => Trainable params: 85829416
  0%|          | 0/1 [00:00<?, ?it/s]Task 0, Epoch 1/1 => Loss 2.475, Train_accy 25.41, Test_accy 87.85:   0%|          | 0/1 [01:10<?, ?it/s]Task 0, Epoch 1/1 => Loss 2.475, Train_accy 25.41, Test_accy 87.85: 100%|██████████| 1/1 [01:10<00:00, 70.76s/it]Task 0, Epoch 1/1 => Loss 2.475, Train_accy 25.41, Test_accy 87.85: 100%|██████████| 1/1 [01:10<00:00, 70.76s/it]
2024-04-27 04:46:12,247 [foster.py] => Task 0, Epoch 1/1 => Loss 2.475, Train_accy 25.41, Test_accy 87.85
2024-04-27 04:46:12,248 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 04:46:58,016 [foster.py] => Exemplar size: 400
2024-04-27 04:46:58,016 [trainer.py] => CNN: {'total': 87.85, '00-19': 87.85, 'old': 0, 'new': 87.85}
2024-04-27 04:46:58,016 [trainer.py] => NME: {'total': 92.4, '00-19': 92.4, 'old': 0, 'new': 92.4}
2024-04-27 04:46:58,017 [trainer.py] => CNN top1 curve: [87.85]
2024-04-27 04:46:58,017 [trainer.py] => CNN top5 curve: [97.8]
2024-04-27 04:46:58,017 [trainer.py] => NME top1 curve: [92.4]
2024-04-27 04:46:58,017 [trainer.py] => NME top5 curve: [99.0]

Average Accuracy (CNN): 87.85
Average Accuracy (NME): 92.4
2024-04-27 04:46:58,017 [trainer.py] => Average Accuracy (CNN): 87.85
2024-04-27 04:46:58,017 [trainer.py] => Average Accuracy (NME): 92.4
2024-04-27 04:46:58,017 [trainer.py] => Train Time: 71.24
2024-04-27 04:46:58,017 [trainer.py] => Test Time: 10.63 

2024-04-27 04:46:58,017 [trainer.py] => All params: 85829416
2024-04-27 04:46:58,018 [trainer.py] => Trainable params: 85829416
2024-04-27 04:46:59,474 [foster.py] => Learning on 20-40
2024-04-27 04:46:59,475 [foster.py] => All params: 171704932
2024-04-27 04:46:59,476 [foster.py] => Trainable params: 85890896
2024-04-27 04:46:59,602 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095]
  0%|          | 0/1 [00:00<?, ?it/s]Task 1, Epoch 1/1 => Loss 4.442, Loss_clf 0.986, Loss_fe 1.193, Loss_kd 1.131, Train_accy 67.87, Test_accy 81.47:   0%|          | 0/1 [01:51<?, ?it/s]Task 1, Epoch 1/1 => Loss 4.442, Loss_clf 0.986, Loss_fe 1.193, Loss_kd 1.131, Train_accy 67.87, Test_accy 81.47: 100%|██████████| 1/1 [01:51<00:00, 111.91s/it]Task 1, Epoch 1/1 => Loss 4.442, Loss_clf 0.986, Loss_fe 1.193, Loss_kd 1.131, Train_accy 67.87, Test_accy 81.47: 100%|██████████| 1/1 [01:51<00:00, 111.92s/it]
2024-04-27 04:48:51,519 [foster.py] => Task 1, Epoch 1/1 => Loss 4.442, Loss_clf 0.986, Loss_fe 1.193, Loss_kd 1.131, Train_accy 67.87, Test_accy 81.47
2024-04-27 04:48:51,521 [foster.py] => do not weight align teacher!
2024-04-27 04:48:51,526 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762]
  0%|          | 0/1 [00:00<?, ?it/s]SNet: Task 1, Epoch 1/1 => Loss 2.560,  Train_accy 54.40, Test_accy 81.28:   0%|          | 0/1 [02:07<?, ?it/s]SNet: Task 1, Epoch 1/1 => Loss 2.560,  Train_accy 54.40, Test_accy 81.28: 100%|██████████| 1/1 [02:07<00:00, 127.16s/it]SNet: Task 1, Epoch 1/1 => Loss 2.560,  Train_accy 54.40, Test_accy 81.28: 100%|██████████| 1/1 [02:07<00:00, 127.16s/it]
2024-04-27 04:51:00,254 [foster.py] => SNet: Task 1, Epoch 1/1 => Loss 2.560,  Train_accy 54.40, Test_accy 81.28
2024-04-27 04:51:00,254 [foster.py] => do not weight align student!
2024-04-27 04:51:10,828 [foster.py] => darknet eval: 
2024-04-27 04:51:10,829 [foster.py] => CNN top1 curve: 81.28
2024-04-27 04:51:10,829 [foster.py] => CNN top5 curve: 97.45
2024-04-27 04:51:10,832 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 04:52:57,925 [foster.py] => Exemplar size: 800
2024-04-27 04:52:57,925 [trainer.py] => CNN: {'total': 81.47, '00-19': 74.5, '20-39': 88.45, 'old': 74.5, 'new': 88.45}
2024-04-27 04:52:57,925 [trainer.py] => NME: {'total': 88.95, '00-19': 88.55, '20-39': 89.35, 'old': 88.55, 'new': 89.35}
2024-04-27 04:52:57,925 [trainer.py] => CNN top1 curve: [87.85, 81.47]
2024-04-27 04:52:57,925 [trainer.py] => CNN top5 curve: [97.8, 97.28]
2024-04-27 04:52:57,925 [trainer.py] => NME top1 curve: [92.4, 88.95]
2024-04-27 04:52:57,925 [trainer.py] => NME top5 curve: [99.0, 98.35]

Average Accuracy (CNN): 84.66
Average Accuracy (NME): 90.68
2024-04-27 04:52:57,925 [trainer.py] => Average Accuracy (CNN): 84.66
2024-04-27 04:52:57,925 [trainer.py] => Average Accuracy (NME): 90.68
2024-04-27 04:52:57,925 [trainer.py] => Train Time: 322.51
2024-04-27 04:52:57,925 [trainer.py] => Test Time: 50.38 

2024-04-27 04:52:57,927 [trainer.py] => All params: 171704932
2024-04-27 04:52:57,927 [trainer.py] => Trainable params: 85890896
2024-04-27 04:52:59,432 [foster.py] => Learning on 40-60
2024-04-27 04:52:59,434 [foster.py] => All params: 171766432
2024-04-27 04:52:59,435 [foster.py] => Trainable params: 85937016
2024-04-27 04:52:59,576 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528]
  0%|          | 0/1 [00:00<?, ?it/s]Task 2, Epoch 1/1 => Loss 5.526, Loss_clf 1.055, Loss_fe 1.418, Loss_kd 2.035, Train_accy 64.35, Test_accy 80.63:   0%|          | 0/1 [02:05<?, ?it/s]Task 2, Epoch 1/1 => Loss 5.526, Loss_clf 1.055, Loss_fe 1.418, Loss_kd 2.035, Train_accy 64.35, Test_accy 80.63: 100%|██████████| 1/1 [02:05<00:00, 125.43s/it]Task 2, Epoch 1/1 => Loss 5.526, Loss_clf 1.055, Loss_fe 1.418, Loss_kd 2.035, Train_accy 64.35, Test_accy 80.63: 100%|██████████| 1/1 [02:05<00:00, 125.43s/it]
2024-04-27 04:55:05,005 [foster.py] => Task 2, Epoch 1/1 => Loss 5.526, Loss_clf 1.055, Loss_fe 1.418, Loss_kd 2.035, Train_accy 64.35, Test_accy 80.63
2024-04-27 04:55:05,006 [foster.py] => do not weight align teacher!
2024-04-27 04:55:05,011 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781]
  0%|          | 0/1 [00:00<?, ?it/s]SNet: Task 2, Epoch 1/1 => Loss 3.165,  Train_accy 39.77, Test_accy 75.65:   0%|          | 0/1 [02:16<?, ?it/s]SNet: Task 2, Epoch 1/1 => Loss 3.165,  Train_accy 39.77, Test_accy 75.65: 100%|██████████| 1/1 [02:16<00:00, 136.78s/it]SNet: Task 2, Epoch 1/1 => Loss 3.165,  Train_accy 39.77, Test_accy 75.65: 100%|██████████| 1/1 [02:16<00:00, 136.79s/it]
2024-04-27 04:57:23,352 [foster.py] => SNet: Task 2, Epoch 1/1 => Loss 3.165,  Train_accy 39.77, Test_accy 75.65
2024-04-27 04:57:23,353 [foster.py] => do not weight align student!
2024-04-27 04:57:38,974 [foster.py] => darknet eval: 
2024-04-27 04:57:38,975 [foster.py] => CNN top1 curve: 75.65
2024-04-27 04:57:38,975 [foster.py] => CNN top5 curve: 95.63
2024-04-27 04:57:38,977 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 04:59:53,311 [foster.py] => Exemplar size: 1200
2024-04-27 04:59:53,312 [trainer.py] => CNN: {'total': 80.63, '00-19': 78.35, '20-39': 79.15, '40-59': 84.4, 'old': 78.75, 'new': 84.4}
2024-04-27 04:59:53,312 [trainer.py] => NME: {'total': 86.5, '00-19': 85.6, '20-39': 84.85, '40-59': 89.05, 'old': 85.22, 'new': 89.05}
2024-04-27 04:59:53,312 [trainer.py] => CNN top1 curve: [87.85, 81.47, 80.63]
2024-04-27 04:59:53,312 [trainer.py] => CNN top5 curve: [97.8, 97.28, 96.93]
2024-04-27 04:59:53,312 [trainer.py] => NME top1 curve: [92.4, 88.95, 86.5]
2024-04-27 04:59:53,312 [trainer.py] => NME top5 curve: [99.0, 98.35, 97.6]

Average Accuracy (CNN): 83.32
Average Accuracy (NME): 89.28
2024-04-27 04:59:53,312 [trainer.py] => Average Accuracy (CNN): 83.32
2024-04-27 04:59:53,312 [trainer.py] => Average Accuracy (NME): 89.28
2024-04-27 04:59:53,312 [trainer.py] => Train Time: 601.95
2024-04-27 04:59:53,312 [trainer.py] => Test Time: 109.68 

2024-04-27 04:59:53,313 [trainer.py] => All params: 171766432
2024-04-27 04:59:53,314 [trainer.py] => Trainable params: 85937016
2024-04-27 04:59:54,837 [foster.py] => Learning on 60-80
2024-04-27 04:59:54,838 [foster.py] => All params: 171827932
2024-04-27 04:59:54,839 [foster.py] => Trainable params: 85983136
2024-04-27 04:59:54,978 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641]
  0%|          | 0/1 [00:00<?, ?it/s]Task 3, Epoch 1/1 => Loss 6.039, Loss_clf 1.186, Loss_fe 1.546, Loss_kd 2.480, Train_accy 57.59, Test_accy 76.44:   0%|          | 0/1 [02:18<?, ?it/s]Task 3, Epoch 1/1 => Loss 6.039, Loss_clf 1.186, Loss_fe 1.546, Loss_kd 2.480, Train_accy 57.59, Test_accy 76.44: 100%|██████████| 1/1 [02:18<00:00, 138.42s/it]Task 3, Epoch 1/1 => Loss 6.039, Loss_clf 1.186, Loss_fe 1.546, Loss_kd 2.480, Train_accy 57.59, Test_accy 76.44: 100%|██████████| 1/1 [02:18<00:00, 138.42s/it]
2024-04-27 05:02:13,399 [foster.py] => Task 3, Epoch 1/1 => Loss 6.039, Loss_clf 1.186, Loss_fe 1.546, Loss_kd 2.480, Train_accy 57.59, Test_accy 76.44
2024-04-27 05:02:13,400 [foster.py] => do not weight align teacher!
2024-04-27 05:02:13,405 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439]
  0%|          | 0/1 [00:00<?, ?it/s]SNet: Task 3, Epoch 1/1 => Loss 3.393,  Train_accy 30.02, Test_accy 71.05:   0%|          | 0/1 [02:25<?, ?it/s]SNet: Task 3, Epoch 1/1 => Loss 3.393,  Train_accy 30.02, Test_accy 71.05: 100%|██████████| 1/1 [02:25<00:00, 145.86s/it]SNet: Task 3, Epoch 1/1 => Loss 3.393,  Train_accy 30.02, Test_accy 71.05: 100%|██████████| 1/1 [02:25<00:00, 145.86s/it]
2024-04-27 05:04:40,832 [foster.py] => SNet: Task 3, Epoch 1/1 => Loss 3.393,  Train_accy 30.02, Test_accy 71.05
2024-04-27 05:04:40,832 [foster.py] => do not weight align student!
2024-04-27 05:05:01,518 [foster.py] => darknet eval: 
2024-04-27 05:05:01,519 [foster.py] => CNN top1 curve: 71.05
2024-04-27 05:05:01,519 [foster.py] => CNN top5 curve: 94.61
2024-04-27 05:05:01,521 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 05:07:46,671 [foster.py] => Exemplar size: 1600
2024-04-27 05:07:46,671 [trainer.py] => CNN: {'total': 76.44, '00-19': 82.2, '20-39': 83.2, '40-59': 69.8, '60-79': 70.55, 'old': 78.4, 'new': 70.55}
2024-04-27 05:07:46,672 [trainer.py] => NME: {'total': 83.34, '00-19': 84.15, '20-39': 85.15, '40-59': 80.9, '60-79': 83.15, 'old': 83.4, 'new': 83.15}
2024-04-27 05:07:46,672 [trainer.py] => CNN top1 curve: [87.85, 81.47, 80.63, 76.44]
2024-04-27 05:07:46,672 [trainer.py] => CNN top5 curve: [97.8, 97.28, 96.93, 95.8]
2024-04-27 05:07:46,672 [trainer.py] => NME top1 curve: [92.4, 88.95, 86.5, 83.34]
2024-04-27 05:07:46,672 [trainer.py] => NME top5 curve: [99.0, 98.35, 97.6, 97.45]

Average Accuracy (CNN): 81.6
Average Accuracy (NME): 87.8
2024-04-27 05:07:46,672 [trainer.py] => Average Accuracy (CNN): 81.6
2024-04-27 05:07:46,672 [trainer.py] => Average Accuracy (NME): 87.8
2024-04-27 05:07:46,672 [trainer.py] => Train Time: 908.54
2024-04-27 05:07:46,672 [trainer.py] => Test Time: 188.63 

2024-04-27 05:07:46,673 [trainer.py] => All params: 171827932
2024-04-27 05:07:46,674 [trainer.py] => Trainable params: 85983136
2024-04-27 05:07:48,320 [foster.py] => Learning on 80-100
2024-04-27 05:07:48,322 [foster.py] => All params: 171889432
2024-04-27 05:07:48,323 [foster.py] => Trainable params: 86029256
2024-04-27 05:07:48,567 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823]
  0%|          | 0/1 [00:00<?, ?it/s]Task 4, Epoch 1/1 => Loss 6.682, Loss_clf 1.315, Loss_fe 1.795, Loss_kd 2.858, Train_accy 50.97, Test_accy 73.54:   0%|          | 0/1 [02:31<?, ?it/s]Task 4, Epoch 1/1 => Loss 6.682, Loss_clf 1.315, Loss_fe 1.795, Loss_kd 2.858, Train_accy 50.97, Test_accy 73.54: 100%|██████████| 1/1 [02:31<00:00, 151.05s/it]Task 4, Epoch 1/1 => Loss 6.682, Loss_clf 1.315, Loss_fe 1.795, Loss_kd 2.858, Train_accy 50.97, Test_accy 73.54: 100%|██████████| 1/1 [02:31<00:00, 151.05s/it]
2024-04-27 05:10:19,617 [foster.py] => Task 4, Epoch 1/1 => Loss 6.682, Loss_clf 1.315, Loss_fe 1.795, Loss_kd 2.858, Train_accy 50.97, Test_accy 73.54
2024-04-27 05:10:19,618 [foster.py] => do not weight align teacher!
2024-04-27 05:10:19,625 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768]
  0%|          | 0/1 [00:00<?, ?it/s]SNet: Task 4, Epoch 1/1 => Loss 3.684,  Train_accy 21.92, Test_accy 67.70:   0%|          | 0/1 [02:34<?, ?it/s]SNet: Task 4, Epoch 1/1 => Loss 3.684,  Train_accy 21.92, Test_accy 67.70: 100%|██████████| 1/1 [02:34<00:00, 154.96s/it]SNet: Task 4, Epoch 1/1 => Loss 3.684,  Train_accy 21.92, Test_accy 67.70: 100%|██████████| 1/1 [02:34<00:00, 154.96s/it]
2024-04-27 05:12:56,158 [foster.py] => SNet: Task 4, Epoch 1/1 => Loss 3.684,  Train_accy 21.92, Test_accy 67.70
2024-04-27 05:12:56,159 [foster.py] => do not weight align student!
2024-04-27 05:13:21,816 [foster.py] => darknet eval: 
2024-04-27 05:13:21,816 [foster.py] => CNN top1 curve: 67.7
2024-04-27 05:13:21,816 [foster.py] => CNN top5 curve: 92.55
2024-04-27 05:13:21,819 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-27 05:16:33,044 [foster.py] => Exemplar size: 2000
2024-04-27 05:16:33,044 [trainer.py] => CNN: {'total': 73.54, '00-19': 80.6, '20-39': 84.35, '40-59': 74.55, '60-79': 65.65, '80-99': 62.55, 'old': 76.29, 'new': 62.55}
2024-04-27 05:16:33,045 [trainer.py] => NME: {'total': 81.07, '00-19': 82.4, '20-39': 83.75, '40-59': 79.0, '60-79': 78.45, '80-99': 81.75, 'old': 80.9, 'new': 81.75}
2024-04-27 05:16:33,045 [trainer.py] => CNN top1 curve: [87.85, 81.47, 80.63, 76.44, 73.54]
2024-04-27 05:16:33,045 [trainer.py] => CNN top5 curve: [97.8, 97.28, 96.93, 95.8, 95.18]
2024-04-27 05:16:33,045 [trainer.py] => NME top1 curve: [92.4, 88.95, 86.5, 83.34, 81.07]
2024-04-27 05:16:33,045 [trainer.py] => NME top5 curve: [99.0, 98.35, 97.6, 97.45, 96.18]

Average Accuracy (CNN): 79.99
Average Accuracy (NME): 86.45
2024-04-27 05:16:33,045 [trainer.py] => Average Accuracy (CNN): 79.99
2024-04-27 05:16:33,045 [trainer.py] => Average Accuracy (NME): 86.45
2024-04-27 05:16:33,045 [trainer.py] => Train Time: 1241.84
2024-04-27 05:16:33,045 [trainer.py] => Test Time: 287.34 

Accuracy Matrix (CNN):
[[87.85 74.5  78.35 82.2  80.6 ]
 [ 0.   88.45 79.15 83.2  84.35]
 [ 0.    0.   84.4  69.8  74.55]
 [ 0.    0.    0.   70.55 65.65]
 [ 0.    0.    0.    0.   62.55]]
2024-04-27 05:16:33,046 [trainer.py] => Forgetting (CNN): 6.525000000000002
Accuracy Matrix (NME):
[[92.4  88.55 85.6  84.15 82.4 ]
 [ 0.   89.35 84.85 85.15 83.75]
 [ 0.    0.   89.05 80.9  79.  ]
 [ 0.    0.    0.   83.15 78.45]
 [ 0.    0.    0.    0.   81.75]]
2024-04-27 05:16:33,046 [trainer.py] => Forgetting (NME): 7.587499999999999
2024-04-27 05:16:35,816 [trainer.py] => config: ./exps/l2p_cifar_B0_Inc5.json
2024-04-27 05:16:35,816 [trainer.py] => prefix:  
2024-04-27 05:16:35,816 [trainer.py] => dataset: cifar224
2024-04-27 05:16:35,816 [trainer.py] => memory_size: 0
2024-04-27 05:16:35,816 [trainer.py] => memory_per_class: 0
2024-04-27 05:16:35,816 [trainer.py] => fixed_memory: False
2024-04-27 05:16:35,816 [trainer.py] => shuffle: True
2024-04-27 05:16:35,816 [trainer.py] => init_cls: 20
2024-04-27 05:16:35,816 [trainer.py] => increment: 20
2024-04-27 05:16:35,816 [trainer.py] => model_name: l2p
2024-04-27 05:16:35,816 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_l2p
2024-04-27 05:16:35,816 [trainer.py] => get_original_backbone: True
2024-04-27 05:16:35,816 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-27 05:16:35,816 [trainer.py] => seed: 1993
2024-04-27 05:16:35,816 [trainer.py] => tuned_epoch: 20
2024-04-27 05:16:35,816 [trainer.py] => init_lr: 0.001875
2024-04-27 05:16:35,817 [trainer.py] => batch_size: 48
2024-04-27 05:16:35,817 [trainer.py] => weight_decay: 0
2024-04-27 05:16:35,817 [trainer.py] => min_lr: 1e-05
2024-04-27 05:16:35,817 [trainer.py] => optimizer: adam
2024-04-27 05:16:35,817 [trainer.py] => scheduler: constant
2024-04-27 05:16:35,817 [trainer.py] => reinit_optimizer: True
2024-04-27 05:16:35,817 [trainer.py] => global_pool: token
2024-04-27 05:16:35,817 [trainer.py] => head_type: prompt
2024-04-27 05:16:35,817 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-27 05:16:35,817 [trainer.py] => pretrained: True
2024-04-27 05:16:35,817 [trainer.py] => drop: 0.0
2024-04-27 05:16:35,817 [trainer.py] => drop_path: 0.0
2024-04-27 05:16:35,817 [trainer.py] => prompt_pool: True
2024-04-27 05:16:35,817 [trainer.py] => size: 10
2024-04-27 05:16:35,817 [trainer.py] => length: 5
2024-04-27 05:16:35,817 [trainer.py] => top_k: 5
2024-04-27 05:16:35,817 [trainer.py] => initializer: uniform
2024-04-27 05:16:35,817 [trainer.py] => prompt_key: True
2024-04-27 05:16:35,817 [trainer.py] => prompt_key_init: uniform
2024-04-27 05:16:35,817 [trainer.py] => use_prompt_mask: False
2024-04-27 05:16:35,817 [trainer.py] => shared_prompt_pool: False
2024-04-27 05:16:35,817 [trainer.py] => shared_prompt_key: False
2024-04-27 05:16:35,817 [trainer.py] => batchwise_prompt: True
2024-04-27 05:16:35,817 [trainer.py] => embedding_key: cls
2024-04-27 05:16:35,817 [trainer.py] => predefined_key: 
2024-04-27 05:16:35,817 [trainer.py] => pull_constraint: True
2024-04-27 05:16:35,817 [trainer.py] => pull_constraint_coeff: 0.1
Files already downloaded and verified
Files already downloaded and verified
2024-04-27 05:16:37,581 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-27 05:16:39,003 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-04-27 05:16:39,003 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-04-27 05:16:40,784 [l2p.py] => 85,940,836 model total parameters.
2024-04-27 05:16:40,785 [l2p.py] => 122,980 model training parameters.
2024-04-27 05:16:40,785 [l2p.py] => prompt.prompt: 38400
2024-04-27 05:16:40,785 [l2p.py] => prompt.prompt_key: 7680
2024-04-27 05:16:40,785 [l2p.py] => head.weight: 76800
2024-04-27 05:16:40,785 [l2p.py] => head.bias: 100
2024-04-27 05:16:40,786 [trainer.py] => All params: 171816392
2024-04-27 05:16:40,787 [trainer.py] => Trainable params: 122980
2024-04-27 05:16:40,787 [l2p.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.161, Train_accy 64.43:   0%|          | 0/20 [01:20<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.161, Train_accy 64.43:   5%|▌         | 1/20 [01:20<25:38, 80.96s/it]Task 0, Epoch 2/20 => Loss 0.514, Train_accy 79.35:   5%|▌         | 1/20 [02:41<25:38, 80.96s/it]Task 0, Epoch 2/20 => Loss 0.514, Train_accy 79.35:  10%|█         | 2/20 [02:41<24:15, 80.86s/it]Task 0, Epoch 3/20 => Loss 0.392, Train_accy 81.23:  10%|█         | 2/20 [04:02<24:15, 80.86s/it]Task 0, Epoch 3/20 => Loss 0.392, Train_accy 81.23:  15%|█▌        | 3/20 [04:02<22:54, 80.85s/it]Task 0, Epoch 4/20 => Loss 0.300, Train_accy 83.08:  15%|█▌        | 3/20 [05:23<22:54, 80.85s/it]Task 0, Epoch 4/20 => Loss 0.300, Train_accy 83.08:  20%|██        | 4/20 [05:23<21:34, 80.94s/it]Task 0, Epoch 5/20 => Loss 0.244, Train_accy 84.52, Test_accy 94.80:  20%|██        | 4/20 [06:55<21:34, 80.94s/it]Task 0, Epoch 5/20 => Loss 0.244, Train_accy 84.52, Test_accy 94.80:  25%|██▌       | 5/20 [06:55<21:13, 84.93s/it]Task 0, Epoch 6/20 => Loss 0.249, Train_accy 84.40:  25%|██▌       | 5/20 [08:16<21:13, 84.93s/it]                 Task 0, Epoch 6/20 => Loss 0.249, Train_accy 84.40:  30%|███       | 6/20 [08:16<19:30, 83.60s/it]Task 0, Epoch 7/20 => Loss 0.218, Train_accy 85.23:  30%|███       | 6/20 [09:37<19:30, 83.60s/it]Task 0, Epoch 7/20 => Loss 0.218, Train_accy 85.23:  35%|███▌      | 7/20 [09:37<17:56, 82.83s/it]Task 0, Epoch 8/20 => Loss 0.211, Train_accy 85.15:  35%|███▌      | 7/20 [10:58<17:56, 82.83s/it]Task 0, Epoch 8/20 => Loss 0.211, Train_accy 85.15:  40%|████      | 8/20 [10:58<16:27, 82.27s/it]Task 0, Epoch 9/20 => Loss 0.192, Train_accy 85.93:  40%|████      | 8/20 [12:20<16:27, 82.27s/it]Task 0, Epoch 9/20 => Loss 0.192, Train_accy 85.93:  45%|████▌     | 9/20 [12:20<15:00, 81.88s/it]Task 0, Epoch 10/20 => Loss 0.153, Train_accy 87.21, Test_accy 96.30:  45%|████▌     | 9/20 [13:52<15:00, 81.88s/it]Task 0, Epoch 10/20 => Loss 0.153, Train_accy 87.21, Test_accy 96.30:  50%|█████     | 10/20 [13:52<14:10, 85.03s/it]Task 0, Epoch 11/20 => Loss 0.190, Train_accy 86.35:  50%|█████     | 10/20 [15:13<14:10, 85.03s/it]                 Task 0, Epoch 11/20 => Loss 0.190, Train_accy 86.35:  55%|█████▌    | 11/20 [15:13<12:34, 83.84s/it]Task 0, Epoch 12/20 => Loss 0.158, Train_accy 87.00:  55%|█████▌    | 11/20 [16:34<12:34, 83.84s/it]Task 0, Epoch 12/20 => Loss 0.158, Train_accy 87.00:  60%|██████    | 12/20 [16:34<11:03, 82.94s/it]Task 0, Epoch 13/20 => Loss 0.124, Train_accy 87.77:  60%|██████    | 12/20 [17:55<11:03, 82.94s/it]Task 0, Epoch 13/20 => Loss 0.124, Train_accy 87.77:  65%|██████▌   | 13/20 [17:55<09:36, 82.35s/it]Task 0, Epoch 14/20 => Loss 0.150, Train_accy 86.96:  65%|██████▌   | 13/20 [19:15<09:36, 82.35s/it]Task 0, Epoch 14/20 => Loss 0.150, Train_accy 86.96:  70%|███████   | 14/20 [19:15<08:11, 81.87s/it]Task 0, Epoch 15/20 => Loss 0.127, Train_accy 87.96, Test_accy 96.35:  70%|███████   | 14/20 [20:47<08:11, 81.87s/it]Task 0, Epoch 15/20 => Loss 0.127, Train_accy 87.96, Test_accy 96.35:  75%|███████▌  | 15/20 [20:47<07:03, 84.77s/it]Task 0, Epoch 16/20 => Loss 0.135, Train_accy 87.31:  75%|███████▌  | 15/20 [22:07<07:03, 84.77s/it]                 Task 0, Epoch 16/20 => Loss 0.135, Train_accy 87.31:  80%|████████  | 16/20 [22:07<05:34, 83.51s/it]Task 0, Epoch 17/20 => Loss 0.116, Train_accy 87.63:  80%|████████  | 16/20 [23:28<05:34, 83.51s/it]Task 0, Epoch 17/20 => Loss 0.116, Train_accy 87.63:  85%|████████▌ | 17/20 [23:28<04:08, 82.68s/it]Task 0, Epoch 18/20 => Loss 0.128, Train_accy 87.64:  85%|████████▌ | 17/20 [24:49<04:08, 82.68s/it]Task 0, Epoch 18/20 => Loss 0.128, Train_accy 87.64:  90%|█████████ | 18/20 [24:49<02:44, 82.16s/it]Task 0, Epoch 19/20 => Loss 0.105, Train_accy 88.56:  90%|█████████ | 18/20 [26:10<02:44, 82.16s/it]Task 0, Epoch 19/20 => Loss 0.105, Train_accy 88.56:  95%|█████████▌| 19/20 [26:10<01:21, 81.78s/it]Task 0, Epoch 20/20 => Loss 0.110, Train_accy 88.45, Test_accy 96.55:  95%|█████████▌| 19/20 [27:42<01:21, 81.78s/it]Task 0, Epoch 20/20 => Loss 0.110, Train_accy 88.45, Test_accy 96.55: 100%|██████████| 20/20 [27:42<00:00, 84.82s/it]Task 0, Epoch 20/20 => Loss 0.110, Train_accy 88.45, Test_accy 96.55: 100%|██████████| 20/20 [27:42<00:00, 83.12s/it]
2024-04-27 05:44:23,857 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.110, Train_accy 88.45, Test_accy 96.55
2024-04-27 05:44:34,674 [trainer.py] => No NME accuracy.
2024-04-27 05:44:34,674 [trainer.py] => CNN: {'total': 96.55, '00-19': 96.55, 'old': 0, 'new': 96.55}
2024-04-27 05:44:34,675 [trainer.py] => CNN top1 curve: [96.55]
2024-04-27 05:44:34,675 [trainer.py] => CNN top5 curve: [99.5]

Average Accuracy (CNN): 96.55
2024-04-27 05:44:34,675 [trainer.py] => Average Accuracy (CNN): 96.55 

2024-04-27 05:44:34,675 [trainer.py] => Train Time: 3325.51
2024-04-27 05:44:34,675 [trainer.py] => Test Time: 10.82 

2024-04-27 05:44:34,678 [trainer.py] => All params: 171816392
2024-04-27 05:44:34,680 [trainer.py] => Trainable params: 122980
2024-04-27 05:44:34,680 [l2p.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.250, Train_accy 84.48:   0%|          | 0/20 [01:20<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.250, Train_accy 84.48:   5%|▌         | 1/20 [01:20<25:37, 80.94s/it]Task 1, Epoch 2/20 => Loss 0.090, Train_accy 88.35:   5%|▌         | 1/20 [02:42<25:37, 80.94s/it]Task 1, Epoch 2/20 => Loss 0.090, Train_accy 88.35:  10%|█         | 2/20 [02:42<24:19, 81.08s/it]Task 1, Epoch 3/20 => Loss 0.077, Train_accy 89.08:  10%|█         | 2/20 [04:03<24:19, 81.08s/it]Task 1, Epoch 3/20 => Loss 0.077, Train_accy 89.08:  15%|█▌        | 3/20 [04:03<22:58, 81.11s/it]Task 1, Epoch 4/20 => Loss 0.075, Train_accy 89.14:  15%|█▌        | 3/20 [05:24<22:58, 81.11s/it]Task 1, Epoch 4/20 => Loss 0.075, Train_accy 89.14:  20%|██        | 4/20 [05:24<21:36, 81.03s/it]Task 1, Epoch 5/20 => Loss 0.064, Train_accy 89.03, Test_accy 91.75:  20%|██        | 4/20 [07:06<21:36, 81.03s/it]Task 1, Epoch 5/20 => Loss 0.064, Train_accy 89.03, Test_accy 91.75:  25%|██▌       | 5/20 [07:06<22:10, 88.73s/it]Task 1, Epoch 6/20 => Loss 0.048, Train_accy 90.01:  25%|██▌       | 5/20 [08:27<22:10, 88.73s/it]                 Task 1, Epoch 6/20 => Loss 0.048, Train_accy 90.01:  30%|███       | 6/20 [08:27<20:05, 86.14s/it]Task 1, Epoch 7/20 => Loss 0.036, Train_accy 90.32:  30%|███       | 6/20 [09:48<20:05, 86.14s/it]Task 1, Epoch 7/20 => Loss 0.036, Train_accy 90.32:  35%|███▌      | 7/20 [09:48<18:18, 84.46s/it]Task 1, Epoch 8/20 => Loss 0.045, Train_accy 90.23:  35%|███▌      | 7/20 [11:09<18:18, 84.46s/it]Task 1, Epoch 8/20 => Loss 0.045, Train_accy 90.23:  40%|████      | 8/20 [11:09<16:41, 83.43s/it]Task 1, Epoch 9/20 => Loss 0.027, Train_accy 90.58:  40%|████      | 8/20 [12:30<16:41, 83.43s/it]Task 1, Epoch 9/20 => Loss 0.027, Train_accy 90.58:  45%|████▌     | 9/20 [12:30<15:09, 82.70s/it]Task 1, Epoch 10/20 => Loss 0.031, Train_accy 90.26, Test_accy 93.42:  45%|████▌     | 9/20 [14:13<15:09, 82.70s/it]Task 1, Epoch 10/20 => Loss 0.031, Train_accy 90.26, Test_accy 93.42:  50%|█████     | 10/20 [14:13<14:47, 88.72s/it]Task 1, Epoch 11/20 => Loss 0.035, Train_accy 90.52:  50%|█████     | 10/20 [15:34<14:47, 88.72s/it]                 Task 1, Epoch 11/20 => Loss 0.035, Train_accy 90.52:  55%|█████▌    | 11/20 [15:34<12:57, 86.38s/it]Task 1, Epoch 12/20 => Loss 0.040, Train_accy 90.26:  55%|█████▌    | 11/20 [16:55<12:57, 86.38s/it]Task 1, Epoch 12/20 => Loss 0.040, Train_accy 90.26:  60%|██████    | 12/20 [16:55<11:17, 84.74s/it]Task 1, Epoch 13/20 => Loss 0.031, Train_accy 90.41:  60%|██████    | 12/20 [18:16<11:17, 84.74s/it]Task 1, Epoch 13/20 => Loss 0.031, Train_accy 90.41:  65%|██████▌   | 13/20 [18:16<09:45, 83.59s/it]Task 1, Epoch 14/20 => Loss 0.018, Train_accy 90.83:  65%|██████▌   | 13/20 [19:36<09:45, 83.59s/it]Task 1, Epoch 14/20 => Loss 0.018, Train_accy 90.83:  70%|███████   | 14/20 [19:36<08:16, 82.72s/it]Task 1, Epoch 15/20 => Loss 0.035, Train_accy 90.61, Test_accy 93.60:  70%|███████   | 14/20 [21:18<08:16, 82.72s/it]Task 1, Epoch 15/20 => Loss 0.035, Train_accy 90.61, Test_accy 93.60:  75%|███████▌  | 15/20 [21:18<07:22, 88.51s/it]Task 1, Epoch 16/20 => Loss 0.014, Train_accy 90.70:  75%|███████▌  | 15/20 [22:39<07:22, 88.51s/it]                 Task 1, Epoch 16/20 => Loss 0.014, Train_accy 90.70:  80%|████████  | 16/20 [22:39<05:44, 86.20s/it]Task 1, Epoch 17/20 => Loss 0.025, Train_accy 90.40:  80%|████████  | 16/20 [24:00<05:44, 86.20s/it]Task 1, Epoch 17/20 => Loss 0.025, Train_accy 90.40:  85%|████████▌ | 17/20 [24:00<04:13, 84.53s/it]Task 1, Epoch 18/20 => Loss 0.014, Train_accy 90.63:  85%|████████▌ | 17/20 [25:20<04:13, 84.53s/it]Task 1, Epoch 18/20 => Loss 0.014, Train_accy 90.63:  90%|█████████ | 18/20 [25:20<02:46, 83.34s/it]Task 1, Epoch 19/20 => Loss 0.005, Train_accy 91.33:  90%|█████████ | 18/20 [26:41<02:46, 83.34s/it]Task 1, Epoch 19/20 => Loss 0.005, Train_accy 91.33:  95%|█████████▌| 19/20 [26:41<01:22, 82.54s/it]Task 1, Epoch 20/20 => Loss 0.007, Train_accy 91.36, Test_accy 93.52:  95%|█████████▌| 19/20 [28:23<01:22, 82.54s/it]Task 1, Epoch 20/20 => Loss 0.007, Train_accy 91.36, Test_accy 93.52: 100%|██████████| 20/20 [28:23<00:00, 88.23s/it]Task 1, Epoch 20/20 => Loss 0.007, Train_accy 91.36, Test_accy 93.52: 100%|██████████| 20/20 [28:23<00:00, 85.15s/it]
2024-04-27 06:12:57,784 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.007, Train_accy 91.36, Test_accy 93.52
2024-04-27 06:13:18,843 [trainer.py] => No NME accuracy.
2024-04-27 06:13:18,843 [trainer.py] => CNN: {'total': 93.52, '00-19': 91.85, '20-39': 95.2, 'old': 91.85, 'new': 95.2}
2024-04-27 06:13:18,843 [trainer.py] => CNN top1 curve: [96.55, 93.52]
2024-04-27 06:13:18,843 [trainer.py] => CNN top5 curve: [99.5, 99.35]

Average Accuracy (CNN): 95.04
2024-04-27 06:13:18,844 [trainer.py] => Average Accuracy (CNN): 95.04 

2024-04-27 06:13:18,844 [trainer.py] => Train Time: 6731.620000000001
2024-04-27 06:13:18,844 [trainer.py] => Test Time: 31.88 

2024-04-27 06:13:18,845 [trainer.py] => All params: 171816392
2024-04-27 06:13:18,845 [trainer.py] => Trainable params: 122980
2024-04-27 06:13:18,846 [l2p.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.254, Train_accy 84.59:   0%|          | 0/20 [01:20<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.254, Train_accy 84.59:   5%|▌         | 1/20 [01:20<25:38, 80.98s/it]Task 2, Epoch 2/20 => Loss 0.091, Train_accy 87.83:   5%|▌         | 1/20 [02:42<25:38, 80.98s/it]Task 2, Epoch 2/20 => Loss 0.091, Train_accy 87.83:  10%|█         | 2/20 [02:42<24:18, 81.00s/it]Task 2, Epoch 3/20 => Loss 0.064, Train_accy 89.20:  10%|█         | 2/20 [04:03<24:18, 81.00s/it]Task 2, Epoch 3/20 => Loss 0.064, Train_accy 89.20:  15%|█▌        | 3/20 [04:03<22:57, 81.04s/it]Task 2, Epoch 4/20 => Loss 0.054, Train_accy 89.42:  15%|█▌        | 3/20 [05:24<22:57, 81.04s/it]Task 2, Epoch 4/20 => Loss 0.054, Train_accy 89.42:  20%|██        | 4/20 [05:24<21:36, 81.04s/it]Task 2, Epoch 5/20 => Loss 0.050, Train_accy 89.51, Test_accy 90.47:  20%|██        | 4/20 [07:16<21:36, 81.04s/it]Task 2, Epoch 5/20 => Loss 0.050, Train_accy 89.51, Test_accy 90.47:  25%|██▌       | 5/20 [07:16<23:03, 92.25s/it]Task 2, Epoch 6/20 => Loss 0.044, Train_accy 90.00:  25%|██▌       | 5/20 [08:37<23:03, 92.25s/it]                 Task 2, Epoch 6/20 => Loss 0.044, Train_accy 90.00:  30%|███       | 6/20 [08:37<20:36, 88.35s/it]Task 2, Epoch 7/20 => Loss 0.041, Train_accy 89.84:  30%|███       | 6/20 [09:57<20:36, 88.35s/it]Task 2, Epoch 7/20 => Loss 0.041, Train_accy 89.84:  35%|███▌      | 7/20 [09:57<18:36, 85.91s/it]Task 2, Epoch 8/20 => Loss 0.037, Train_accy 90.08:  35%|███▌      | 7/20 [11:18<18:36, 85.91s/it]Task 2, Epoch 8/20 => Loss 0.037, Train_accy 90.08:  40%|████      | 8/20 [11:18<16:51, 84.30s/it]Task 2, Epoch 9/20 => Loss 0.044, Train_accy 89.75:  40%|████      | 8/20 [12:39<16:51, 84.30s/it]Task 2, Epoch 9/20 => Loss 0.044, Train_accy 89.75:  45%|████▌     | 9/20 [12:39<15:15, 83.23s/it]Task 2, Epoch 10/20 => Loss 0.023, Train_accy 90.41, Test_accy 90.98:  45%|████▌     | 9/20 [14:32<15:15, 83.23s/it]Task 2, Epoch 10/20 => Loss 0.023, Train_accy 90.41, Test_accy 90.98:  50%|█████     | 10/20 [14:32<15:22, 92.23s/it]Task 2, Epoch 11/20 => Loss 0.029, Train_accy 90.26:  50%|█████     | 10/20 [15:53<15:22, 92.23s/it]                 Task 2, Epoch 11/20 => Loss 0.029, Train_accy 90.26:  55%|█████▌    | 11/20 [15:53<13:19, 88.80s/it]Task 2, Epoch 12/20 => Loss 0.042, Train_accy 89.87:  55%|█████▌    | 11/20 [17:14<13:19, 88.80s/it]Task 2, Epoch 12/20 => Loss 0.042, Train_accy 89.87:  60%|██████    | 12/20 [17:14<11:31, 86.42s/it]Task 2, Epoch 13/20 => Loss 0.024, Train_accy 90.57:  60%|██████    | 12/20 [18:35<11:31, 86.42s/it]Task 2, Epoch 13/20 => Loss 0.024, Train_accy 90.57:  65%|██████▌   | 13/20 [18:35<09:53, 84.85s/it]Task 2, Epoch 14/20 => Loss 0.025, Train_accy 90.41:  65%|██████▌   | 13/20 [19:56<09:53, 84.85s/it]Task 2, Epoch 14/20 => Loss 0.025, Train_accy 90.41:  70%|███████   | 14/20 [19:56<08:21, 83.66s/it]Task 2, Epoch 15/20 => Loss 0.029, Train_accy 90.26, Test_accy 91.17:  70%|███████   | 14/20 [21:48<08:21, 83.66s/it]Task 2, Epoch 15/20 => Loss 0.029, Train_accy 90.26, Test_accy 91.17:  75%|███████▌  | 15/20 [21:48<07:41, 92.38s/it]Task 2, Epoch 16/20 => Loss 0.029, Train_accy 90.24:  75%|███████▌  | 15/20 [23:09<07:41, 92.38s/it]                 Task 2, Epoch 16/20 => Loss 0.029, Train_accy 90.24:  80%|████████  | 16/20 [23:09<05:55, 88.94s/it]Task 2, Epoch 17/20 => Loss 0.027, Train_accy 90.33:  80%|████████  | 16/20 [24:30<05:55, 88.94s/it]Task 2, Epoch 17/20 => Loss 0.027, Train_accy 90.33:  85%|████████▌ | 17/20 [24:30<04:19, 86.58s/it]Task 2, Epoch 18/20 => Loss 0.004, Train_accy 90.91:  85%|████████▌ | 17/20 [25:51<04:19, 86.58s/it]Task 2, Epoch 18/20 => Loss 0.004, Train_accy 90.91:  90%|█████████ | 18/20 [25:51<02:49, 84.89s/it]Task 2, Epoch 19/20 => Loss 0.019, Train_accy 90.64:  90%|█████████ | 18/20 [27:12<02:49, 84.89s/it]Task 2, Epoch 19/20 => Loss 0.019, Train_accy 90.64:  95%|█████████▌| 19/20 [27:12<01:23, 83.71s/it]Task 2, Epoch 20/20 => Loss 0.024, Train_accy 90.52, Test_accy 90.90:  95%|█████████▌| 19/20 [29:04<01:23, 83.71s/it]Task 2, Epoch 20/20 => Loss 0.024, Train_accy 90.52, Test_accy 90.90: 100%|██████████| 20/20 [29:04<00:00, 92.25s/it]Task 2, Epoch 20/20 => Loss 0.024, Train_accy 90.52, Test_accy 90.90: 100%|██████████| 20/20 [29:04<00:00, 87.24s/it]
2024-04-27 06:42:23,816 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.024, Train_accy 90.52, Test_accy 90.90
2024-04-27 06:42:55,088 [trainer.py] => No NME accuracy.
2024-04-27 06:42:55,088 [trainer.py] => CNN: {'total': 90.9, '00-19': 86.1, '20-39': 92.6, '40-59': 94.0, 'old': 89.35, 'new': 94.0}
2024-04-27 06:42:55,088 [trainer.py] => CNN top1 curve: [96.55, 93.52, 90.9]
2024-04-27 06:42:55,088 [trainer.py] => CNN top5 curve: [99.5, 99.35, 99.03]

Average Accuracy (CNN): 93.66
2024-04-27 06:42:55,088 [trainer.py] => Average Accuracy (CNN): 93.66 

2024-04-27 06:42:55,088 [trainer.py] => Train Time: 10221.380000000001
2024-04-27 06:42:55,089 [trainer.py] => Test Time: 63.15 

2024-04-27 06:42:55,091 [trainer.py] => All params: 171816392
2024-04-27 06:42:55,093 [trainer.py] => Trainable params: 122980
2024-04-27 06:42:55,093 [l2p.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.230, Train_accy 84.71:   0%|          | 0/20 [01:20<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.230, Train_accy 84.71:   5%|▌         | 1/20 [01:20<25:34, 80.76s/it]Task 3, Epoch 2/20 => Loss 0.096, Train_accy 87.45:   5%|▌         | 1/20 [02:41<25:34, 80.76s/it]Task 3, Epoch 2/20 => Loss 0.096, Train_accy 87.45:  10%|█         | 2/20 [02:41<24:15, 80.85s/it]Task 3, Epoch 3/20 => Loss 0.067, Train_accy 88.92:  10%|█         | 2/20 [04:02<24:15, 80.85s/it]Task 3, Epoch 3/20 => Loss 0.067, Train_accy 88.92:  15%|█▌        | 3/20 [04:02<22:55, 80.89s/it]Task 3, Epoch 4/20 => Loss 0.046, Train_accy 89.53:  15%|█▌        | 3/20 [05:23<22:55, 80.89s/it]Task 3, Epoch 4/20 => Loss 0.046, Train_accy 89.53:  20%|██        | 4/20 [05:23<21:34, 80.90s/it]Task 3, Epoch 5/20 => Loss 0.048, Train_accy 89.69, Test_accy 87.12:  20%|██        | 4/20 [07:25<21:34, 80.90s/it]Task 3, Epoch 5/20 => Loss 0.048, Train_accy 89.69, Test_accy 87.12:  25%|██▌       | 5/20 [07:25<23:56, 95.74s/it]Task 3, Epoch 6/20 => Loss 0.053, Train_accy 89.34:  25%|██▌       | 5/20 [08:46<23:56, 95.74s/it]                 Task 3, Epoch 6/20 => Loss 0.053, Train_accy 89.34:  30%|███       | 6/20 [08:46<21:09, 90.65s/it]Task 3, Epoch 7/20 => Loss 0.042, Train_accy 89.96:  30%|███       | 6/20 [10:07<21:09, 90.65s/it]Task 3, Epoch 7/20 => Loss 0.042, Train_accy 89.96:  35%|███▌      | 7/20 [10:07<18:56, 87.41s/it]Task 3, Epoch 8/20 => Loss 0.026, Train_accy 90.44:  35%|███▌      | 7/20 [11:28<18:56, 87.41s/it]Task 3, Epoch 8/20 => Loss 0.026, Train_accy 90.44:  40%|████      | 8/20 [11:28<17:06, 85.55s/it]Task 3, Epoch 9/20 => Loss 0.038, Train_accy 89.89:  40%|████      | 8/20 [12:49<17:06, 85.55s/it]Task 3, Epoch 9/20 => Loss 0.038, Train_accy 89.89:  45%|████▌     | 9/20 [12:49<15:25, 84.13s/it]Task 3, Epoch 10/20 => Loss 0.034, Train_accy 90.30, Test_accy 88.18:  45%|████▌     | 9/20 [14:52<15:25, 84.13s/it]Task 3, Epoch 10/20 => Loss 0.034, Train_accy 90.30, Test_accy 88.18:  50%|█████     | 10/20 [14:52<15:59, 95.99s/it]Task 3, Epoch 11/20 => Loss 0.028, Train_accy 90.49:  50%|█████     | 10/20 [16:13<15:59, 95.99s/it]                 Task 3, Epoch 11/20 => Loss 0.028, Train_accy 90.49:  55%|█████▌    | 11/20 [16:13<13:42, 91.38s/it]Task 3, Epoch 12/20 => Loss 0.017, Train_accy 90.82:  55%|█████▌    | 11/20 [17:34<13:42, 91.38s/it]Task 3, Epoch 12/20 => Loss 0.017, Train_accy 90.82:  60%|██████    | 12/20 [17:34<11:45, 88.22s/it]Task 3, Epoch 13/20 => Loss 0.013, Train_accy 90.86:  60%|██████    | 12/20 [18:55<11:45, 88.22s/it]Task 3, Epoch 13/20 => Loss 0.013, Train_accy 90.86:  65%|██████▌   | 13/20 [18:55<10:01, 86.00s/it]Task 3, Epoch 14/20 => Loss 0.023, Train_accy 90.50:  65%|██████▌   | 13/20 [20:15<10:01, 86.00s/it]Task 3, Epoch 14/20 => Loss 0.023, Train_accy 90.50:  70%|███████   | 14/20 [20:15<08:26, 84.46s/it]Task 3, Epoch 15/20 => Loss -0.000, Train_accy 91.16, Test_accy 88.04:  70%|███████   | 14/20 [22:18<08:26, 84.46s/it]Task 3, Epoch 15/20 => Loss -0.000, Train_accy 91.16, Test_accy 88.04:  75%|███████▌  | 15/20 [22:18<07:59, 95.98s/it]Task 3, Epoch 16/20 => Loss 0.026, Train_accy 90.46:  75%|███████▌  | 15/20 [23:39<07:59, 95.98s/it]                  Task 3, Epoch 16/20 => Loss 0.026, Train_accy 90.46:  80%|████████  | 16/20 [23:39<06:05, 91.46s/it]Task 3, Epoch 17/20 => Loss 0.006, Train_accy 91.17:  80%|████████  | 16/20 [25:00<06:05, 91.46s/it]Task 3, Epoch 17/20 => Loss 0.006, Train_accy 91.17:  85%|████████▌ | 17/20 [25:00<04:24, 88.27s/it]Task 3, Epoch 18/20 => Loss 0.003, Train_accy 91.11:  85%|████████▌ | 17/20 [26:21<04:24, 88.27s/it]Task 3, Epoch 18/20 => Loss 0.003, Train_accy 91.11:  90%|█████████ | 18/20 [26:21<02:52, 86.10s/it]Task 3, Epoch 19/20 => Loss 0.018, Train_accy 90.80:  90%|█████████ | 18/20 [27:42<02:52, 86.10s/it]Task 3, Epoch 19/20 => Loss 0.018, Train_accy 90.80:  95%|█████████▌| 19/20 [27:42<01:24, 84.55s/it]Task 3, Epoch 20/20 => Loss 0.013, Train_accy 90.87, Test_accy 86.66:  95%|█████████▌| 19/20 [29:44<01:24, 84.55s/it]Task 3, Epoch 20/20 => Loss 0.013, Train_accy 90.87, Test_accy 86.66: 100%|██████████| 20/20 [29:44<00:00, 95.92s/it]Task 3, Epoch 20/20 => Loss 0.013, Train_accy 90.87, Test_accy 86.66: 100%|██████████| 20/20 [29:44<00:00, 89.24s/it]
2024-04-27 07:12:39,951 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.013, Train_accy 90.87, Test_accy 86.66
2024-04-27 07:13:21,634 [trainer.py] => No NME accuracy.
2024-04-27 07:13:21,635 [trainer.py] => CNN: {'total': 86.66, '00-19': 81.55, '20-39': 91.15, '40-59': 82.65, '60-79': 91.3, 'old': 85.12, 'new': 91.3}
2024-04-27 07:13:21,635 [trainer.py] => CNN top1 curve: [96.55, 93.52, 90.9, 86.66]
2024-04-27 07:13:21,635 [trainer.py] => CNN top5 curve: [99.5, 99.35, 99.03, 98.85]

Average Accuracy (CNN): 91.91
2024-04-27 07:13:21,635 [trainer.py] => Average Accuracy (CNN): 91.91 

2024-04-27 07:13:21,635 [trainer.py] => Train Time: 13790.99
2024-04-27 07:13:21,635 [trainer.py] => Test Time: 104.83 

2024-04-27 07:13:21,637 [trainer.py] => All params: 171816392
2024-04-27 07:13:21,639 [trainer.py] => Trainable params: 122980
2024-04-27 07:13:21,639 [l2p.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.219, Train_accy 85.90:   0%|          | 0/20 [01:21<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.219, Train_accy 85.90:   5%|▌         | 1/20 [01:21<25:39, 81.04s/it]Task 4, Epoch 2/20 => Loss 0.061, Train_accy 89.76:   5%|▌         | 1/20 [02:42<25:39, 81.04s/it]Task 4, Epoch 2/20 => Loss 0.061, Train_accy 89.76:  10%|█         | 2/20 [02:42<24:18, 81.01s/it]Task 4, Epoch 3/20 => Loss 0.065, Train_accy 89.46:  10%|█         | 2/20 [04:02<24:18, 81.01s/it]Task 4, Epoch 3/20 => Loss 0.065, Train_accy 89.46:  15%|█▌        | 3/20 [04:02<22:55, 80.93s/it]Task 4, Epoch 4/20 => Loss 0.045, Train_accy 90.27:  15%|█▌        | 3/20 [05:23<22:55, 80.93s/it]Task 4, Epoch 4/20 => Loss 0.045, Train_accy 90.27:  20%|██        | 4/20 [05:23<21:35, 80.97s/it]Task 4, Epoch 5/20 => Loss 0.036, Train_accy 90.42, Test_accy 84.13:  20%|██        | 4/20 [07:36<21:35, 80.97s/it]Task 4, Epoch 5/20 => Loss 0.036, Train_accy 90.42, Test_accy 84.13:  25%|██▌       | 5/20 [07:36<24:55, 99.69s/it]Task 4, Epoch 6/20 => Loss 0.028, Train_accy 90.85:  25%|██▌       | 5/20 [08:57<24:55, 99.69s/it]                 Task 4, Epoch 6/20 => Loss 0.028, Train_accy 90.85:  30%|███       | 6/20 [08:57<21:46, 93.30s/it]Task 4, Epoch 7/20 => Loss 0.024, Train_accy 90.66:  30%|███       | 6/20 [10:18<21:46, 93.30s/it]Task 4, Epoch 7/20 => Loss 0.024, Train_accy 90.66:  35%|███▌      | 7/20 [10:18<19:20, 89.25s/it]Task 4, Epoch 8/20 => Loss 0.014, Train_accy 91.08:  35%|███▌      | 7/20 [11:39<19:20, 89.25s/it]Task 4, Epoch 8/20 => Loss 0.014, Train_accy 91.08:  40%|████      | 8/20 [11:39<17:19, 86.60s/it]Task 4, Epoch 9/20 => Loss 0.010, Train_accy 91.34:  40%|████      | 8/20 [13:00<17:19, 86.60s/it]Task 4, Epoch 9/20 => Loss 0.010, Train_accy 91.34:  45%|████▌     | 9/20 [13:00<15:32, 84.79s/it]Task 4, Epoch 10/20 => Loss 0.010, Train_accy 91.36, Test_accy 85.86:  45%|████▌     | 9/20 [15:12<15:32, 84.79s/it]Task 4, Epoch 10/20 => Loss 0.010, Train_accy 91.36, Test_accy 85.86:  50%|█████     | 10/20 [15:12<16:35, 99.55s/it]Task 4, Epoch 11/20 => Loss 0.008, Train_accy 91.10:  50%|█████     | 10/20 [16:33<16:35, 99.55s/it]                 Task 4, Epoch 11/20 => Loss 0.008, Train_accy 91.10:  55%|█████▌    | 11/20 [16:33<14:03, 93.76s/it]Task 4, Epoch 12/20 => Loss 0.001, Train_accy 91.23:  55%|█████▌    | 11/20 [17:54<14:03, 93.76s/it]Task 4, Epoch 12/20 => Loss 0.001, Train_accy 91.23:  60%|██████    | 12/20 [17:54<11:58, 89.75s/it]Task 4, Epoch 13/20 => Loss 0.000, Train_accy 91.53:  60%|██████    | 12/20 [19:14<11:58, 89.75s/it]Task 4, Epoch 13/20 => Loss 0.000, Train_accy 91.53:  65%|██████▌   | 13/20 [19:14<10:08, 86.96s/it]Task 4, Epoch 14/20 => Loss 0.004, Train_accy 91.62:  65%|██████▌   | 13/20 [20:35<10:08, 86.96s/it]Task 4, Epoch 14/20 => Loss 0.004, Train_accy 91.62:  70%|███████   | 14/20 [20:35<08:30, 85.08s/it]Task 4, Epoch 15/20 => Loss 0.003, Train_accy 91.38, Test_accy 86.04:  70%|███████   | 14/20 [22:47<08:30, 85.08s/it]Task 4, Epoch 15/20 => Loss 0.003, Train_accy 91.38, Test_accy 86.04:  75%|███████▌  | 15/20 [22:47<08:16, 99.35s/it]Task 4, Epoch 16/20 => Loss 0.014, Train_accy 91.13:  75%|███████▌  | 15/20 [24:08<08:16, 99.35s/it]                 Task 4, Epoch 16/20 => Loss 0.014, Train_accy 91.13:  80%|████████  | 16/20 [24:08<06:15, 93.79s/it]Task 4, Epoch 17/20 => Loss -0.003, Train_accy 91.65:  80%|████████  | 16/20 [25:29<06:15, 93.79s/it]Task 4, Epoch 17/20 => Loss -0.003, Train_accy 91.65:  85%|████████▌ | 17/20 [25:29<04:29, 89.89s/it]Task 4, Epoch 18/20 => Loss -0.008, Train_accy 91.86:  85%|████████▌ | 17/20 [26:50<04:29, 89.89s/it]Task 4, Epoch 18/20 => Loss -0.008, Train_accy 91.86:  90%|█████████ | 18/20 [26:50<02:54, 87.18s/it]Task 4, Epoch 19/20 => Loss -0.005, Train_accy 91.67:  90%|█████████ | 18/20 [28:11<02:54, 87.18s/it]Task 4, Epoch 19/20 => Loss -0.005, Train_accy 91.67:  95%|█████████▌| 19/20 [28:11<01:25, 85.28s/it]Task 4, Epoch 20/20 => Loss -0.017, Train_accy 92.28, Test_accy 86.07:  95%|█████████▌| 19/20 [30:24<01:25, 85.28s/it]Task 4, Epoch 20/20 => Loss -0.017, Train_accy 92.28, Test_accy 86.07: 100%|██████████| 20/20 [30:24<00:00, 99.57s/it]Task 4, Epoch 20/20 => Loss -0.017, Train_accy 92.28, Test_accy 86.07: 100%|██████████| 20/20 [30:24<00:00, 91.21s/it]
2024-04-27 07:43:45,825 [l2p.py] => Task 4, Epoch 20/20 => Loss -0.017, Train_accy 92.28, Test_accy 86.07
2024-04-27 07:44:37,858 [trainer.py] => No NME accuracy.
2024-04-27 07:44:37,859 [trainer.py] => CNN: {'total': 86.07, '00-19': 78.05, '20-39': 90.15, '40-59': 82.15, '60-79': 88.95, '80-99': 91.05, 'old': 84.82, 'new': 91.05}
2024-04-27 07:44:37,859 [trainer.py] => CNN top1 curve: [96.55, 93.52, 90.9, 86.66, 86.07]
2024-04-27 07:44:37,859 [trainer.py] => CNN top5 curve: [99.5, 99.35, 99.03, 98.85, 98.51]

Average Accuracy (CNN): 90.74
2024-04-27 07:44:37,859 [trainer.py] => Average Accuracy (CNN): 90.74 

2024-04-27 07:44:37,859 [trainer.py] => Train Time: 17439.26
2024-04-27 07:44:37,859 [trainer.py] => Test Time: 156.86 

Accuracy Matrix (CNN):
[[96.55 91.85 86.1  81.55 78.05]
 [ 0.   95.2  92.6  91.15 90.15]
 [ 0.    0.   94.   82.65 82.15]
 [ 0.    0.    0.   91.3  88.95]
 [ 0.    0.    0.    0.   91.05]]
2024-04-27 07:44:37,861 [trainer.py] => Forgetting (CNN): 9.437499999999996
2024-04-27 07:44:40,509 [trainer.py] => config: ./exps/dualprompt_cifar_B0_Inc5.json
2024-04-27 07:44:40,510 [trainer.py] => prefix:  
2024-04-27 07:44:40,510 [trainer.py] => dataset: cifar224
2024-04-27 07:44:40,510 [trainer.py] => memory_size: 0
2024-04-27 07:44:40,510 [trainer.py] => memory_per_class: 0
2024-04-27 07:44:40,510 [trainer.py] => fixed_memory: False
2024-04-27 07:44:40,510 [trainer.py] => shuffle: True
2024-04-27 07:44:40,510 [trainer.py] => init_cls: 20
2024-04-27 07:44:40,510 [trainer.py] => increment: 20
2024-04-27 07:44:40,510 [trainer.py] => model_name: dualprompt
2024-04-27 07:44:40,510 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_dualprompt
2024-04-27 07:44:40,510 [trainer.py] => get_original_backbone: True
2024-04-27 07:44:40,510 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-27 07:44:40,510 [trainer.py] => seed: 1993
2024-04-27 07:44:40,510 [trainer.py] => tuned_epoch: 20
2024-04-27 07:44:40,510 [trainer.py] => init_lr: 0.001
2024-04-27 07:44:40,510 [trainer.py] => batch_size: 48
2024-04-27 07:44:40,510 [trainer.py] => weight_decay: 0
2024-04-27 07:44:40,510 [trainer.py] => min_lr: 1e-05
2024-04-27 07:44:40,510 [trainer.py] => optimizer: adam
2024-04-27 07:44:40,511 [trainer.py] => scheduler: constant
2024-04-27 07:44:40,511 [trainer.py] => reinit_optimizer: True
2024-04-27 07:44:40,511 [trainer.py] => global_pool: token
2024-04-27 07:44:40,511 [trainer.py] => head_type: token
2024-04-27 07:44:40,511 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-27 07:44:40,511 [trainer.py] => pretrained: True
2024-04-27 07:44:40,511 [trainer.py] => drop: 0.0
2024-04-27 07:44:40,511 [trainer.py] => drop_path: 0.0
2024-04-27 07:44:40,511 [trainer.py] => use_g_prompt: True
2024-04-27 07:44:40,511 [trainer.py] => g_prompt_length: 5
2024-04-27 07:44:40,511 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-04-27 07:44:40,511 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-04-27 07:44:40,511 [trainer.py] => use_e_prompt: True
2024-04-27 07:44:40,511 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-04-27 07:44:40,511 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-04-27 07:44:40,511 [trainer.py] => prompt_pool: True
2024-04-27 07:44:40,511 [trainer.py] => size: 10
2024-04-27 07:44:40,511 [trainer.py] => length: 5
2024-04-27 07:44:40,511 [trainer.py] => top_k: 1
2024-04-27 07:44:40,511 [trainer.py] => initializer: uniform
2024-04-27 07:44:40,511 [trainer.py] => prompt_key: True
2024-04-27 07:44:40,511 [trainer.py] => prompt_key_init: uniform
2024-04-27 07:44:40,511 [trainer.py] => use_prompt_mask: True
2024-04-27 07:44:40,511 [trainer.py] => shared_prompt_pool: True
2024-04-27 07:44:40,512 [trainer.py] => shared_prompt_key: False
2024-04-27 07:44:40,512 [trainer.py] => batchwise_prompt: True
2024-04-27 07:44:40,512 [trainer.py] => embedding_key: cls
2024-04-27 07:44:40,512 [trainer.py] => predefined_key: 
2024-04-27 07:44:40,512 [trainer.py] => pull_constraint: True
2024-04-27 07:44:40,512 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-27 07:44:40,512 [trainer.py] => same_key_value: False
Files already downloaded and verified
Files already downloaded and verified
2024-04-27 07:44:42,308 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-04-27 07:44:45,494 [dualprompt.py] => 86,128,996 model total parameters.
2024-04-27 07:44:45,495 [dualprompt.py] => 330,340 model training parameters.
2024-04-27 07:44:45,495 [dualprompt.py] => g_prompt: 15360
2024-04-27 07:44:45,495 [dualprompt.py] => e_prompt.prompt: 230400
2024-04-27 07:44:45,495 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-04-27 07:44:45,495 [dualprompt.py] => head.weight: 76800
2024-04-27 07:44:45,495 [dualprompt.py] => head.bias: 100
2024-04-27 07:44:45,496 [trainer.py] => All params: 172004552
2024-04-27 07:44:45,497 [trainer.py] => Trainable params: 330340
2024-04-27 07:44:45,497 [dualprompt.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.913, Train_accy 73.61:   0%|          | 0/20 [01:13<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.913, Train_accy 73.61:   5%|▌         | 1/20 [01:13<23:19, 73.67s/it]Task 0, Epoch 2/20 => Loss 0.542, Train_accy 83.15:   5%|▌         | 1/20 [02:27<23:19, 73.67s/it]Task 0, Epoch 2/20 => Loss 0.542, Train_accy 83.15:  10%|█         | 2/20 [02:27<22:04, 73.58s/it]Task 0, Epoch 3/20 => Loss 0.482, Train_accy 84.83:  10%|█         | 2/20 [03:40<22:04, 73.58s/it]Task 0, Epoch 3/20 => Loss 0.482, Train_accy 84.83:  15%|█▌        | 3/20 [03:40<20:51, 73.60s/it]Task 0, Epoch 4/20 => Loss 0.421, Train_accy 86.02:  15%|█▌        | 3/20 [04:54<20:51, 73.60s/it]Task 0, Epoch 4/20 => Loss 0.421, Train_accy 86.02:  20%|██        | 4/20 [04:54<19:37, 73.59s/it]Task 0, Epoch 5/20 => Loss 0.410, Train_accy 86.22, Test_accy 96.15:  20%|██        | 4/20 [06:18<19:37, 73.59s/it]Task 0, Epoch 5/20 => Loss 0.410, Train_accy 86.22, Test_accy 96.15:  25%|██▌       | 5/20 [06:18<19:18, 77.24s/it]Task 0, Epoch 6/20 => Loss 0.381, Train_accy 86.81:  25%|██▌       | 5/20 [07:32<19:18, 77.24s/it]                 Task 0, Epoch 6/20 => Loss 0.381, Train_accy 86.81:  30%|███       | 6/20 [07:32<17:46, 76.15s/it]Task 0, Epoch 7/20 => Loss 0.379, Train_accy 87.07:  30%|███       | 6/20 [08:45<17:46, 76.15s/it]Task 0, Epoch 7/20 => Loss 0.379, Train_accy 87.07:  35%|███▌      | 7/20 [08:45<16:19, 75.31s/it]Task 0, Epoch 8/20 => Loss 0.362, Train_accy 87.50:  35%|███▌      | 7/20 [09:59<16:19, 75.31s/it]Task 0, Epoch 8/20 => Loss 0.362, Train_accy 87.50:  40%|████      | 8/20 [09:59<14:57, 74.78s/it]Task 0, Epoch 9/20 => Loss 0.359, Train_accy 87.38:  40%|████      | 8/20 [11:13<14:57, 74.78s/it]Task 0, Epoch 9/20 => Loss 0.359, Train_accy 87.38:  45%|████▌     | 9/20 [11:13<13:38, 74.44s/it]Task 0, Epoch 10/20 => Loss 0.359, Train_accy 87.27, Test_accy 95.95:  45%|████▌     | 9/20 [12:36<13:38, 74.44s/it]Task 0, Epoch 10/20 => Loss 0.359, Train_accy 87.27, Test_accy 95.95:  50%|█████     | 10/20 [12:36<12:53, 77.34s/it]Task 0, Epoch 11/20 => Loss 0.340, Train_accy 87.95:  50%|█████     | 10/20 [13:50<12:53, 77.34s/it]                 Task 0, Epoch 11/20 => Loss 0.340, Train_accy 87.95:  55%|█████▌    | 11/20 [13:50<11:25, 76.22s/it]Task 0, Epoch 12/20 => Loss 0.328, Train_accy 88.38:  55%|█████▌    | 11/20 [15:04<11:25, 76.22s/it]Task 0, Epoch 12/20 => Loss 0.328, Train_accy 88.38:  60%|██████    | 12/20 [15:04<10:03, 75.46s/it]Task 0, Epoch 13/20 => Loss 0.321, Train_accy 88.49:  60%|██████    | 12/20 [16:18<10:03, 75.46s/it]Task 0, Epoch 13/20 => Loss 0.321, Train_accy 88.49:  65%|██████▌   | 13/20 [16:18<08:44, 74.98s/it]Task 0, Epoch 14/20 => Loss 0.319, Train_accy 88.44:  65%|██████▌   | 13/20 [17:31<08:44, 74.98s/it]Task 0, Epoch 14/20 => Loss 0.319, Train_accy 88.44:  70%|███████   | 14/20 [17:31<07:27, 74.59s/it]Task 0, Epoch 15/20 => Loss 0.317, Train_accy 88.73, Test_accy 95.75:  70%|███████   | 14/20 [18:55<07:27, 74.59s/it]Task 0, Epoch 15/20 => Loss 0.317, Train_accy 88.73, Test_accy 95.75:  75%|███████▌  | 15/20 [18:55<06:26, 77.36s/it]Task 0, Epoch 16/20 => Loss 0.311, Train_accy 89.07:  75%|███████▌  | 15/20 [20:09<06:26, 77.36s/it]                 Task 0, Epoch 16/20 => Loss 0.311, Train_accy 89.07:  80%|████████  | 16/20 [20:09<05:04, 76.22s/it]Task 0, Epoch 17/20 => Loss 0.304, Train_accy 89.25:  80%|████████  | 16/20 [21:22<05:04, 76.22s/it]Task 0, Epoch 17/20 => Loss 0.304, Train_accy 89.25:  85%|████████▌ | 17/20 [21:22<03:46, 75.40s/it]Task 0, Epoch 18/20 => Loss 0.289, Train_accy 89.46:  85%|████████▌ | 17/20 [22:36<03:46, 75.40s/it]Task 0, Epoch 18/20 => Loss 0.289, Train_accy 89.46:  90%|█████████ | 18/20 [22:36<02:29, 74.79s/it]Task 0, Epoch 19/20 => Loss 0.314, Train_accy 88.93:  90%|█████████ | 18/20 [23:49<02:29, 74.79s/it]Task 0, Epoch 19/20 => Loss 0.314, Train_accy 88.93:  95%|█████████▌| 19/20 [23:49<01:14, 74.36s/it]Task 0, Epoch 20/20 => Loss 0.301, Train_accy 89.31, Test_accy 96.30:  95%|█████████▌| 19/20 [25:12<01:14, 74.36s/it]Task 0, Epoch 20/20 => Loss 0.301, Train_accy 89.31, Test_accy 96.30: 100%|██████████| 20/20 [25:12<00:00, 77.12s/it]Task 0, Epoch 20/20 => Loss 0.301, Train_accy 89.31, Test_accy 96.30: 100%|██████████| 20/20 [25:12<00:00, 75.65s/it]
2024-04-27 08:09:59,057 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.301, Train_accy 89.31, Test_accy 96.30
2024-04-27 08:10:09,130 [trainer.py] => No NME accuracy.
2024-04-27 08:10:09,130 [trainer.py] => CNN: {'total': 96.3, '00-19': 96.3, 'old': 0, 'new': 96.3}
2024-04-27 08:10:09,131 [trainer.py] => CNN top1 curve: [96.3]
2024-04-27 08:10:09,131 [trainer.py] => CNN top5 curve: [99.55]

Average Accuracy (CNN): 96.3
2024-04-27 08:10:09,131 [trainer.py] => Average Accuracy (CNN): 96.3 

2024-04-27 08:10:09,131 [trainer.py] => Train Time: 3026.51
2024-04-27 08:10:09,131 [trainer.py] => Test Time: 10.07 

2024-04-27 08:10:09,132 [trainer.py] => All params: 172004552
2024-04-27 08:10:09,133 [trainer.py] => Trainable params: 330340
2024-04-27 08:10:09,133 [dualprompt.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.573, Train_accy 83.27:   0%|          | 0/20 [01:13<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.573, Train_accy 83.27:   5%|▌         | 1/20 [01:13<23:12, 73.29s/it]Task 1, Epoch 2/20 => Loss 0.368, Train_accy 87.66:   5%|▌         | 1/20 [02:26<23:12, 73.29s/it]Task 1, Epoch 2/20 => Loss 0.368, Train_accy 87.66:  10%|█         | 2/20 [02:26<21:59, 73.30s/it]Task 1, Epoch 3/20 => Loss 0.318, Train_accy 89.05:  10%|█         | 2/20 [03:39<21:59, 73.30s/it]Task 1, Epoch 3/20 => Loss 0.318, Train_accy 89.05:  15%|█▌        | 3/20 [03:39<20:46, 73.33s/it]Task 1, Epoch 4/20 => Loss 0.294, Train_accy 89.57:  15%|█▌        | 3/20 [04:53<20:46, 73.33s/it]Task 1, Epoch 4/20 => Loss 0.294, Train_accy 89.57:  20%|██        | 4/20 [04:53<19:33, 73.33s/it]Task 1, Epoch 5/20 => Loss 0.274, Train_accy 90.01, Test_accy 92.15:  20%|██        | 4/20 [06:26<19:33, 73.33s/it]Task 1, Epoch 5/20 => Loss 0.274, Train_accy 90.01, Test_accy 92.15:  25%|██▌       | 5/20 [06:26<20:07, 80.51s/it]Task 1, Epoch 6/20 => Loss 0.267, Train_accy 90.06:  25%|██▌       | 5/20 [07:40<20:07, 80.51s/it]                 Task 1, Epoch 6/20 => Loss 0.267, Train_accy 90.06:  30%|███       | 6/20 [07:40<18:14, 78.19s/it]Task 1, Epoch 7/20 => Loss 0.261, Train_accy 90.31:  30%|███       | 6/20 [08:53<18:14, 78.19s/it]Task 1, Epoch 7/20 => Loss 0.261, Train_accy 90.31:  35%|███▌      | 7/20 [08:53<16:36, 76.66s/it]Task 1, Epoch 8/20 => Loss 0.245, Train_accy 90.56:  35%|███▌      | 7/20 [10:07<16:36, 76.66s/it]Task 1, Epoch 8/20 => Loss 0.245, Train_accy 90.56:  40%|████      | 8/20 [10:07<15:07, 75.66s/it]Task 1, Epoch 9/20 => Loss 0.235, Train_accy 91.11:  40%|████      | 8/20 [11:20<15:07, 75.66s/it]Task 1, Epoch 9/20 => Loss 0.235, Train_accy 91.11:  45%|████▌     | 9/20 [11:20<13:45, 75.02s/it]Task 1, Epoch 10/20 => Loss 0.239, Train_accy 90.63, Test_accy 92.65:  45%|████▌     | 9/20 [12:54<13:45, 75.02s/it]Task 1, Epoch 10/20 => Loss 0.239, Train_accy 90.63, Test_accy 92.65:  50%|█████     | 10/20 [12:54<13:27, 80.71s/it]Task 1, Epoch 11/20 => Loss 0.234, Train_accy 90.92:  50%|█████     | 10/20 [14:07<13:27, 80.71s/it]                 Task 1, Epoch 11/20 => Loss 0.234, Train_accy 90.92:  55%|█████▌    | 11/20 [14:07<11:46, 78.55s/it]Task 1, Epoch 12/20 => Loss 0.228, Train_accy 91.06:  55%|█████▌    | 11/20 [15:21<11:46, 78.55s/it]Task 1, Epoch 12/20 => Loss 0.228, Train_accy 91.06:  60%|██████    | 12/20 [15:21<10:16, 77.06s/it]Task 1, Epoch 13/20 => Loss 0.242, Train_accy 90.89:  60%|██████    | 12/20 [16:35<10:16, 77.06s/it]Task 1, Epoch 13/20 => Loss 0.242, Train_accy 90.89:  65%|██████▌   | 13/20 [16:35<08:52, 76.01s/it]Task 1, Epoch 14/20 => Loss 0.233, Train_accy 90.90:  65%|██████▌   | 13/20 [17:48<08:52, 76.01s/it]Task 1, Epoch 14/20 => Loss 0.233, Train_accy 90.90:  70%|███████   | 14/20 [17:48<07:31, 75.30s/it]Task 1, Epoch 15/20 => Loss 0.250, Train_accy 90.50, Test_accy 93.45:  70%|███████   | 14/20 [19:22<07:31, 75.30s/it]Task 1, Epoch 15/20 => Loss 0.250, Train_accy 90.50, Test_accy 93.45:  75%|███████▌  | 15/20 [19:22<06:44, 80.81s/it]Task 1, Epoch 16/20 => Loss 0.233, Train_accy 90.81:  75%|███████▌  | 15/20 [20:36<06:44, 80.81s/it]                 Task 1, Epoch 16/20 => Loss 0.233, Train_accy 90.81:  80%|████████  | 16/20 [20:36<05:14, 78.65s/it]Task 1, Epoch 17/20 => Loss 0.217, Train_accy 91.65:  80%|████████  | 16/20 [21:49<05:14, 78.65s/it]Task 1, Epoch 17/20 => Loss 0.217, Train_accy 91.65:  85%|████████▌ | 17/20 [21:49<03:51, 77.17s/it]Task 1, Epoch 18/20 => Loss 0.239, Train_accy 90.86:  85%|████████▌ | 17/20 [23:03<03:51, 77.17s/it]Task 1, Epoch 18/20 => Loss 0.239, Train_accy 90.86:  90%|█████████ | 18/20 [23:03<02:32, 76.20s/it]Task 1, Epoch 19/20 => Loss 0.241, Train_accy 90.83:  90%|█████████ | 18/20 [24:17<02:32, 76.20s/it]Task 1, Epoch 19/20 => Loss 0.241, Train_accy 90.83:  95%|█████████▌| 19/20 [24:17<01:15, 75.50s/it]Task 1, Epoch 20/20 => Loss 0.207, Train_accy 91.49, Test_accy 93.60:  95%|█████████▌| 19/20 [25:50<01:15, 75.50s/it]Task 1, Epoch 20/20 => Loss 0.207, Train_accy 91.49, Test_accy 93.60: 100%|██████████| 20/20 [25:50<00:00, 80.87s/it]Task 1, Epoch 20/20 => Loss 0.207, Train_accy 91.49, Test_accy 93.60: 100%|██████████| 20/20 [25:50<00:00, 77.55s/it]
2024-04-27 08:36:00,206 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.207, Train_accy 91.49, Test_accy 93.60
2024-04-27 08:36:20,029 [trainer.py] => No NME accuracy.
2024-04-27 08:36:20,029 [trainer.py] => CNN: {'total': 93.6, '00-19': 92.7, '20-39': 94.5, 'old': 92.7, 'new': 94.5}
2024-04-27 08:36:20,030 [trainer.py] => CNN top1 curve: [96.3, 93.6]
2024-04-27 08:36:20,030 [trainer.py] => CNN top5 curve: [99.55, 99.25]

Average Accuracy (CNN): 94.95
2024-04-27 08:36:20,030 [trainer.py] => Average Accuracy (CNN): 94.95 

2024-04-27 08:36:20,030 [trainer.py] => Train Time: 6128.48
2024-04-27 08:36:20,030 [trainer.py] => Test Time: 29.89 

2024-04-27 08:36:20,033 [trainer.py] => All params: 172004552
2024-04-27 08:36:20,036 [trainer.py] => Trainable params: 330340
2024-04-27 08:36:20,036 [dualprompt.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.583, Train_accy 83.23:   0%|          | 0/20 [01:13<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.583, Train_accy 83.23:   5%|▌         | 1/20 [01:13<23:14, 73.38s/it]Task 2, Epoch 2/20 => Loss 0.362, Train_accy 88.16:   5%|▌         | 1/20 [02:26<23:14, 73.38s/it]Task 2, Epoch 2/20 => Loss 0.362, Train_accy 88.16:  10%|█         | 2/20 [02:26<22:00, 73.37s/it]Task 2, Epoch 3/20 => Loss 0.314, Train_accy 89.25:  10%|█         | 2/20 [03:40<22:00, 73.37s/it]Task 2, Epoch 3/20 => Loss 0.314, Train_accy 89.25:  15%|█▌        | 3/20 [03:40<20:47, 73.36s/it]Task 2, Epoch 4/20 => Loss 0.308, Train_accy 89.08:  15%|█▌        | 3/20 [04:53<20:47, 73.36s/it]Task 2, Epoch 4/20 => Loss 0.308, Train_accy 89.08:  20%|██        | 4/20 [04:53<19:33, 73.37s/it]Task 2, Epoch 5/20 => Loss 0.284, Train_accy 89.86, Test_accy 90.02:  20%|██        | 4/20 [06:36<19:33, 73.37s/it]Task 2, Epoch 5/20 => Loss 0.284, Train_accy 89.86, Test_accy 90.02:  25%|██▌       | 5/20 [06:36<20:59, 83.99s/it]Task 2, Epoch 6/20 => Loss 0.280, Train_accy 89.42:  25%|██▌       | 5/20 [07:49<20:59, 83.99s/it]                 Task 2, Epoch 6/20 => Loss 0.280, Train_accy 89.42:  30%|███       | 6/20 [07:49<18:44, 80.35s/it]Task 2, Epoch 7/20 => Loss 0.251, Train_accy 90.49:  30%|███       | 6/20 [09:02<18:44, 80.35s/it]Task 2, Epoch 7/20 => Loss 0.251, Train_accy 90.49:  35%|███▌      | 7/20 [09:02<16:54, 78.07s/it]Task 2, Epoch 8/20 => Loss 0.274, Train_accy 89.71:  35%|███▌      | 7/20 [10:16<16:54, 78.07s/it]Task 2, Epoch 8/20 => Loss 0.274, Train_accy 89.71:  40%|████      | 8/20 [10:16<15:19, 76.60s/it]Task 2, Epoch 9/20 => Loss 0.245, Train_accy 90.64:  40%|████      | 8/20 [11:29<15:19, 76.60s/it]Task 2, Epoch 9/20 => Loss 0.245, Train_accy 90.64:  45%|████▌     | 9/20 [11:29<13:52, 75.64s/it]Task 2, Epoch 10/20 => Loss 0.237, Train_accy 90.84, Test_accy 90.82:  45%|████▌     | 9/20 [13:13<13:52, 75.64s/it]Task 2, Epoch 10/20 => Loss 0.237, Train_accy 90.84, Test_accy 90.82:  50%|█████     | 10/20 [13:13<14:01, 84.14s/it]Task 2, Epoch 11/20 => Loss 0.236, Train_accy 90.82:  50%|█████     | 10/20 [14:26<14:01, 84.14s/it]                 Task 2, Epoch 11/20 => Loss 0.236, Train_accy 90.82:  55%|█████▌    | 11/20 [14:26<12:08, 80.94s/it]Task 2, Epoch 12/20 => Loss 0.241, Train_accy 90.82:  55%|█████▌    | 11/20 [15:40<12:08, 80.94s/it]Task 2, Epoch 12/20 => Loss 0.241, Train_accy 90.82:  60%|██████    | 12/20 [15:40<10:29, 78.72s/it]Task 2, Epoch 13/20 => Loss 0.221, Train_accy 91.37:  60%|██████    | 12/20 [16:54<10:29, 78.72s/it]Task 2, Epoch 13/20 => Loss 0.221, Train_accy 91.37:  65%|██████▌   | 13/20 [16:54<09:00, 77.19s/it]Task 2, Epoch 14/20 => Loss 0.239, Train_accy 90.82:  65%|██████▌   | 13/20 [18:08<09:00, 77.19s/it]Task 2, Epoch 14/20 => Loss 0.239, Train_accy 90.82:  70%|███████   | 14/20 [18:08<07:37, 76.31s/it]Task 2, Epoch 15/20 => Loss 0.235, Train_accy 90.98, Test_accy 91.33:  70%|███████   | 14/20 [19:51<07:37, 76.31s/it]Task 2, Epoch 15/20 => Loss 0.235, Train_accy 90.98, Test_accy 91.33:  75%|███████▌  | 15/20 [19:51<07:02, 84.50s/it]Task 2, Epoch 16/20 => Loss 0.226, Train_accy 91.19:  75%|███████▌  | 15/20 [21:05<07:02, 84.50s/it]                 Task 2, Epoch 16/20 => Loss 0.226, Train_accy 91.19:  80%|████████  | 16/20 [21:05<05:24, 81.21s/it]Task 2, Epoch 17/20 => Loss 0.242, Train_accy 90.99:  80%|████████  | 16/20 [22:19<05:24, 81.21s/it]Task 2, Epoch 17/20 => Loss 0.242, Train_accy 90.99:  85%|████████▌ | 17/20 [22:19<03:56, 78.92s/it]Task 2, Epoch 18/20 => Loss 0.239, Train_accy 90.88:  85%|████████▌ | 17/20 [23:32<03:56, 78.92s/it]Task 2, Epoch 18/20 => Loss 0.239, Train_accy 90.88:  90%|█████████ | 18/20 [23:32<02:34, 77.33s/it]Task 2, Epoch 19/20 => Loss 0.230, Train_accy 91.20:  90%|█████████ | 18/20 [24:46<02:34, 77.33s/it]Task 2, Epoch 19/20 => Loss 0.230, Train_accy 91.20:  95%|█████████▌| 19/20 [24:46<01:16, 76.22s/it]Task 2, Epoch 20/20 => Loss 0.232, Train_accy 90.93, Test_accy 91.18:  95%|█████████▌| 19/20 [26:29<01:16, 76.22s/it]Task 2, Epoch 20/20 => Loss 0.232, Train_accy 90.93, Test_accy 91.18: 100%|██████████| 20/20 [26:29<00:00, 84.39s/it]Task 2, Epoch 20/20 => Loss 0.232, Train_accy 90.93, Test_accy 91.18: 100%|██████████| 20/20 [26:29<00:00, 79.49s/it]
2024-04-27 09:02:49,820 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.232, Train_accy 90.93, Test_accy 91.18
2024-04-27 09:03:19,301 [trainer.py] => No NME accuracy.
2024-04-27 09:03:19,301 [trainer.py] => CNN: {'total': 91.18, '00-19': 90.4, '20-39': 92.5, '40-59': 90.65, 'old': 91.45, 'new': 90.65}
2024-04-27 09:03:19,301 [trainer.py] => CNN top1 curve: [96.3, 93.6, 91.18]
2024-04-27 09:03:19,302 [trainer.py] => CNN top5 curve: [99.55, 99.25, 98.98]

Average Accuracy (CNN): 93.69
2024-04-27 09:03:19,302 [trainer.py] => Average Accuracy (CNN): 93.69 

2024-04-27 09:03:19,302 [trainer.py] => Train Time: 9307.939999999999
2024-04-27 09:03:19,302 [trainer.py] => Test Time: 59.370000000000005 

2024-04-27 09:03:19,304 [trainer.py] => All params: 172004552
2024-04-27 09:03:19,306 [trainer.py] => Trainable params: 330340
2024-04-27 09:03:19,306 [dualprompt.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.583, Train_accy 82.77:   0%|          | 0/20 [01:13<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.583, Train_accy 82.77:   5%|▌         | 1/20 [01:13<23:23, 73.86s/it]Task 3, Epoch 2/20 => Loss 0.341, Train_accy 88.49:   5%|▌         | 1/20 [02:27<23:23, 73.86s/it]Task 3, Epoch 2/20 => Loss 0.341, Train_accy 88.49:  10%|█         | 2/20 [02:27<22:08, 73.79s/it]Task 3, Epoch 3/20 => Loss 0.301, Train_accy 89.39:  10%|█         | 2/20 [03:41<22:08, 73.79s/it]Task 3, Epoch 3/20 => Loss 0.301, Train_accy 89.39:  15%|█▌        | 3/20 [03:41<20:53, 73.75s/it]Task 3, Epoch 4/20 => Loss 0.287, Train_accy 89.90:  15%|█▌        | 3/20 [04:54<20:53, 73.75s/it]Task 3, Epoch 4/20 => Loss 0.287, Train_accy 89.90:  20%|██        | 4/20 [04:54<19:39, 73.70s/it]Task 3, Epoch 5/20 => Loss 0.262, Train_accy 90.19, Test_accy 86.89:  20%|██        | 4/20 [06:47<19:39, 73.70s/it]Task 3, Epoch 5/20 => Loss 0.262, Train_accy 90.19, Test_accy 86.89:  25%|██▌       | 5/20 [06:47<21:57, 87.80s/it]Task 3, Epoch 6/20 => Loss 0.273, Train_accy 89.92:  25%|██▌       | 5/20 [08:01<21:57, 87.80s/it]                 Task 3, Epoch 6/20 => Loss 0.273, Train_accy 89.92:  30%|███       | 6/20 [08:01<19:21, 82.98s/it]Task 3, Epoch 7/20 => Loss 0.237, Train_accy 90.83:  30%|███       | 6/20 [09:14<19:21, 82.98s/it]Task 3, Epoch 7/20 => Loss 0.237, Train_accy 90.83:  35%|███▌      | 7/20 [09:14<17:18, 79.91s/it]Task 3, Epoch 8/20 => Loss 0.238, Train_accy 90.58:  35%|███▌      | 7/20 [10:28<17:18, 79.91s/it]Task 3, Epoch 8/20 => Loss 0.238, Train_accy 90.58:  40%|████      | 8/20 [10:28<15:35, 77.93s/it]Task 3, Epoch 9/20 => Loss 0.235, Train_accy 90.84:  40%|████      | 8/20 [11:42<15:35, 77.93s/it]Task 3, Epoch 9/20 => Loss 0.235, Train_accy 90.84:  45%|████▌     | 9/20 [11:42<14:02, 76.62s/it]Task 3, Epoch 10/20 => Loss 0.247, Train_accy 90.54, Test_accy 88.31:  45%|████▌     | 9/20 [13:35<14:02, 76.62s/it]Task 3, Epoch 10/20 => Loss 0.247, Train_accy 90.54, Test_accy 88.31:  50%|█████     | 10/20 [13:35<14:39, 87.94s/it]Task 3, Epoch 11/20 => Loss 0.227, Train_accy 91.06:  50%|█████     | 10/20 [14:49<14:39, 87.94s/it]                 Task 3, Epoch 11/20 => Loss 0.227, Train_accy 91.06:  55%|█████▌    | 11/20 [14:49<12:32, 83.60s/it]Task 3, Epoch 12/20 => Loss 0.238, Train_accy 90.94:  55%|█████▌    | 11/20 [16:03<12:32, 83.60s/it]Task 3, Epoch 12/20 => Loss 0.238, Train_accy 90.94:  60%|██████    | 12/20 [16:03<10:44, 80.61s/it]Task 3, Epoch 13/20 => Loss 0.226, Train_accy 91.51:  60%|██████    | 12/20 [17:16<10:44, 80.61s/it]Task 3, Epoch 13/20 => Loss 0.226, Train_accy 91.51:  65%|██████▌   | 13/20 [17:16<09:09, 78.53s/it]Task 3, Epoch 14/20 => Loss 0.224, Train_accy 90.83:  65%|██████▌   | 13/20 [18:30<09:09, 78.53s/it]Task 3, Epoch 14/20 => Loss 0.224, Train_accy 90.83:  70%|███████   | 14/20 [18:30<07:42, 77.07s/it]Task 3, Epoch 15/20 => Loss 0.236, Train_accy 90.98, Test_accy 88.76:  70%|███████   | 14/20 [20:23<07:42, 77.07s/it]Task 3, Epoch 15/20 => Loss 0.236, Train_accy 90.98, Test_accy 88.76:  75%|███████▌  | 15/20 [20:23<07:19, 87.89s/it]Task 3, Epoch 16/20 => Loss 0.220, Train_accy 91.46:  75%|███████▌  | 15/20 [21:37<07:19, 87.89s/it]                 Task 3, Epoch 16/20 => Loss 0.220, Train_accy 91.46:  80%|████████  | 16/20 [21:37<05:34, 83.64s/it]Task 3, Epoch 17/20 => Loss 0.233, Train_accy 91.14:  80%|████████  | 16/20 [22:50<05:34, 83.64s/it]Task 3, Epoch 17/20 => Loss 0.233, Train_accy 91.14:  85%|████████▌ | 17/20 [22:50<04:01, 80.61s/it]Task 3, Epoch 18/20 => Loss 0.220, Train_accy 91.33:  85%|████████▌ | 17/20 [24:04<04:01, 80.61s/it]Task 3, Epoch 18/20 => Loss 0.220, Train_accy 91.33:  90%|█████████ | 18/20 [24:04<02:37, 78.51s/it]Task 3, Epoch 19/20 => Loss 0.228, Train_accy 91.20:  90%|█████████ | 18/20 [25:18<02:37, 78.51s/it]Task 3, Epoch 19/20 => Loss 0.228, Train_accy 91.20:  95%|█████████▌| 19/20 [25:18<01:17, 77.09s/it]Task 3, Epoch 20/20 => Loss 0.213, Train_accy 91.43, Test_accy 88.36:  95%|█████████▌| 19/20 [27:11<01:17, 77.09s/it]Task 3, Epoch 20/20 => Loss 0.213, Train_accy 91.43, Test_accy 88.36: 100%|██████████| 20/20 [27:11<00:00, 87.85s/it]Task 3, Epoch 20/20 => Loss 0.213, Train_accy 91.43, Test_accy 88.36: 100%|██████████| 20/20 [27:11<00:00, 81.56s/it]
2024-04-27 09:30:30,631 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.213, Train_accy 91.43, Test_accy 88.36
2024-04-27 09:31:10,075 [trainer.py] => No NME accuracy.
2024-04-27 09:31:10,076 [trainer.py] => CNN: {'total': 88.36, '00-19': 89.15, '20-39': 91.95, '40-59': 87.1, '60-79': 85.25, 'old': 89.4, 'new': 85.25}
2024-04-27 09:31:10,076 [trainer.py] => CNN top1 curve: [96.3, 93.6, 91.18, 88.36]
2024-04-27 09:31:10,076 [trainer.py] => CNN top5 curve: [99.55, 99.25, 98.98, 98.66]

Average Accuracy (CNN): 92.36
2024-04-27 09:31:10,076 [trainer.py] => Average Accuracy (CNN): 92.36 

2024-04-27 09:31:10,076 [trainer.py] => Train Time: 12570.48
2024-04-27 09:31:10,076 [trainer.py] => Test Time: 98.81 

2024-04-27 09:31:10,079 [trainer.py] => All params: 172004552
2024-04-27 09:31:10,080 [trainer.py] => Trainable params: 330340
2024-04-27 09:31:10,081 [dualprompt.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.552, Train_accy 84.51:   0%|          | 0/20 [01:13<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.552, Train_accy 84.51:   5%|▌         | 1/20 [01:13<23:18, 73.61s/it]Task 4, Epoch 2/20 => Loss 0.334, Train_accy 89.43:   5%|▌         | 1/20 [02:27<23:18, 73.61s/it]Task 4, Epoch 2/20 => Loss 0.334, Train_accy 89.43:  10%|█         | 2/20 [02:27<22:04, 73.60s/it]Task 4, Epoch 3/20 => Loss 0.293, Train_accy 90.10:  10%|█         | 2/20 [03:40<22:04, 73.60s/it]Task 4, Epoch 3/20 => Loss 0.293, Train_accy 90.10:  15%|█▌        | 3/20 [03:40<20:51, 73.65s/it]Task 4, Epoch 4/20 => Loss 0.263, Train_accy 90.50:  15%|█▌        | 3/20 [04:55<20:51, 73.65s/it]Task 4, Epoch 4/20 => Loss 0.263, Train_accy 90.50:  20%|██        | 4/20 [04:55<19:42, 73.93s/it]Task 4, Epoch 5/20 => Loss 0.262, Train_accy 90.67, Test_accy 84.90:  20%|██        | 4/20 [06:58<19:42, 73.93s/it]Task 4, Epoch 5/20 => Loss 0.262, Train_accy 90.67, Test_accy 84.90:  25%|██▌       | 5/20 [06:58<22:53, 91.54s/it]Task 4, Epoch 6/20 => Loss 0.237, Train_accy 91.47:  25%|██▌       | 5/20 [08:11<22:53, 91.54s/it]                 Task 4, Epoch 6/20 => Loss 0.237, Train_accy 91.47:  30%|███       | 6/20 [08:11<19:56, 85.44s/it]Task 4, Epoch 7/20 => Loss 0.254, Train_accy 90.76:  30%|███       | 6/20 [09:25<19:56, 85.44s/it]Task 4, Epoch 7/20 => Loss 0.254, Train_accy 90.76:  35%|███▌      | 7/20 [09:25<17:40, 81.61s/it]Task 4, Epoch 8/20 => Loss 0.228, Train_accy 91.58:  35%|███▌      | 7/20 [10:39<17:40, 81.61s/it]Task 4, Epoch 8/20 => Loss 0.228, Train_accy 91.58:  40%|████      | 8/20 [10:39<15:49, 79.13s/it]Task 4, Epoch 9/20 => Loss 0.240, Train_accy 91.22:  40%|████      | 8/20 [11:53<15:49, 79.13s/it]Task 4, Epoch 9/20 => Loss 0.240, Train_accy 91.22:  45%|████▌     | 9/20 [11:53<14:13, 77.61s/it]Task 4, Epoch 10/20 => Loss 0.243, Train_accy 91.17, Test_accy 87.05:  45%|████▌     | 9/20 [13:56<14:13, 77.61s/it]Task 4, Epoch 10/20 => Loss 0.243, Train_accy 91.17, Test_accy 87.05:  50%|█████     | 10/20 [13:56<15:15, 91.59s/it]Task 4, Epoch 11/20 => Loss 0.226, Train_accy 91.64:  50%|█████     | 10/20 [15:09<15:15, 91.59s/it]                 Task 4, Epoch 11/20 => Loss 0.226, Train_accy 91.64:  55%|█████▌    | 11/20 [15:09<12:54, 86.08s/it]Task 4, Epoch 12/20 => Loss 0.214, Train_accy 91.85:  55%|█████▌    | 11/20 [16:23<12:54, 86.08s/it]Task 4, Epoch 12/20 => Loss 0.214, Train_accy 91.85:  60%|██████    | 12/20 [16:23<10:58, 82.28s/it]Task 4, Epoch 13/20 => Loss 0.220, Train_accy 91.54:  60%|██████    | 12/20 [17:37<10:58, 82.28s/it]Task 4, Epoch 13/20 => Loss 0.220, Train_accy 91.54:  65%|██████▌   | 13/20 [17:37<09:17, 79.66s/it]Task 4, Epoch 14/20 => Loss 0.215, Train_accy 91.71:  65%|██████▌   | 13/20 [18:50<09:17, 79.66s/it]Task 4, Epoch 14/20 => Loss 0.215, Train_accy 91.71:  70%|███████   | 14/20 [18:50<07:46, 77.83s/it]Task 4, Epoch 15/20 => Loss 0.221, Train_accy 91.71, Test_accy 87.13:  70%|███████   | 14/20 [20:53<07:46, 77.83s/it]Task 4, Epoch 15/20 => Loss 0.221, Train_accy 91.71, Test_accy 87.13:  75%|███████▌  | 15/20 [20:53<07:36, 91.35s/it]Task 4, Epoch 16/20 => Loss 0.234, Train_accy 91.37:  75%|███████▌  | 15/20 [22:07<07:36, 91.35s/it]                 Task 4, Epoch 16/20 => Loss 0.234, Train_accy 91.37:  80%|████████  | 16/20 [22:07<05:44, 86.02s/it]Task 4, Epoch 17/20 => Loss 0.222, Train_accy 91.51:  80%|████████  | 16/20 [23:20<05:44, 86.02s/it]Task 4, Epoch 17/20 => Loss 0.222, Train_accy 91.51:  85%|████████▌ | 17/20 [23:20<04:06, 82.29s/it]Task 4, Epoch 18/20 => Loss 0.206, Train_accy 92.05:  85%|████████▌ | 17/20 [24:34<04:06, 82.29s/it]Task 4, Epoch 18/20 => Loss 0.206, Train_accy 92.05:  90%|█████████ | 18/20 [24:34<02:39, 79.72s/it]Task 4, Epoch 19/20 => Loss 0.221, Train_accy 91.38:  90%|█████████ | 18/20 [25:48<02:39, 79.72s/it]Task 4, Epoch 19/20 => Loss 0.221, Train_accy 91.38:  95%|█████████▌| 19/20 [25:48<01:17, 77.88s/it]Task 4, Epoch 20/20 => Loss 0.212, Train_accy 91.70, Test_accy 87.44:  95%|█████████▌| 19/20 [27:50<01:17, 77.88s/it]Task 4, Epoch 20/20 => Loss 0.212, Train_accy 91.70, Test_accy 87.44: 100%|██████████| 20/20 [27:50<00:00, 91.37s/it]Task 4, Epoch 20/20 => Loss 0.212, Train_accy 91.70, Test_accy 87.44: 100%|██████████| 20/20 [27:50<00:00, 83.54s/it]
2024-04-27 09:59:01,016 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.212, Train_accy 91.70, Test_accy 87.44
2024-04-27 09:59:50,308 [trainer.py] => No NME accuracy.
2024-04-27 09:59:50,308 [trainer.py] => CNN: {'total': 87.44, '00-19': 87.65, '20-39': 91.7, '40-59': 86.35, '60-79': 84.15, '80-99': 87.35, 'old': 87.46, 'new': 87.35}
2024-04-27 09:59:50,308 [trainer.py] => CNN top1 curve: [96.3, 93.6, 91.18, 88.36, 87.44]
2024-04-27 09:59:50,309 [trainer.py] => CNN top5 curve: [99.55, 99.25, 98.98, 98.66, 98.39]

Average Accuracy (CNN): 91.38
2024-04-27 09:59:50,309 [trainer.py] => Average Accuracy (CNN): 91.38 

2024-04-27 09:59:50,309 [trainer.py] => Train Time: 15912.17
2024-04-27 09:59:50,309 [trainer.py] => Test Time: 148.1 

Accuracy Matrix (CNN):
[[96.3  92.7  90.4  89.15 87.65]
 [ 0.   94.5  92.5  91.95 91.7 ]
 [ 0.    0.   90.65 87.1  86.35]
 [ 0.    0.    0.   85.25 84.15]
 [ 0.    0.    0.    0.   87.35]]
2024-04-27 09:59:50,310 [trainer.py] => Forgetting (CNN): 4.212499999999999
2024-04-27 09:59:52,988 [trainer.py] => config: ./exps/coda_prompt_cifar_B0_Inc5.json
2024-04-27 09:59:52,988 [trainer.py] => prefix:  
2024-04-27 09:59:52,989 [trainer.py] => dataset: cifar224
2024-04-27 09:59:52,989 [trainer.py] => memory_size: 0
2024-04-27 09:59:52,989 [trainer.py] => memory_per_class: 0
2024-04-27 09:59:52,989 [trainer.py] => fixed_memory: False
2024-04-27 09:59:52,989 [trainer.py] => shuffle: False
2024-04-27 09:59:52,989 [trainer.py] => init_cls: 20
2024-04-27 09:59:52,989 [trainer.py] => increment: 20
2024-04-27 09:59:52,989 [trainer.py] => model_name: coda_prompt
2024-04-27 09:59:52,989 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-04-27 09:59:52,989 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-27 09:59:52,989 [trainer.py] => seed: 1993
2024-04-27 09:59:52,989 [trainer.py] => tuned_epoch: 20
2024-04-27 09:59:52,989 [trainer.py] => init_lr: 0.001
2024-04-27 09:59:52,989 [trainer.py] => batch_size: 48
2024-04-27 09:59:52,989 [trainer.py] => weight_decay: 0
2024-04-27 09:59:52,989 [trainer.py] => min_lr: 1e-05
2024-04-27 09:59:52,989 [trainer.py] => optimizer: adam
2024-04-27 09:59:52,989 [trainer.py] => scheduler: cosine
2024-04-27 09:59:52,989 [trainer.py] => reinit_optimizer: True
2024-04-27 09:59:52,989 [trainer.py] => pretrained: True
2024-04-27 09:59:52,989 [trainer.py] => drop: 0.0
2024-04-27 09:59:52,989 [trainer.py] => drop_path: 0.0
2024-04-27 09:59:52,989 [trainer.py] => prompt_param: [100, 8.0, 0.0]
Files already downloaded and verified
Files already downloaded and verified
2024-04-27 09:59:54,776 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-04-27 09:59:56,852 [coda_prompt.py] => 89,715,556 total parameters.
2024-04-27 09:59:56,852 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-04-27 09:59:56,852 [trainer.py] => All params: 89715556
2024-04-27 09:59:56,853 [trainer.py] => Trainable params: 89715556
2024-04-27 09:59:56,853 [coda_prompt.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.680, Train_accy 80.30:   0%|          | 0/20 [01:34<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.680, Train_accy 80.30:   5%|▌         | 1/20 [01:34<30:01, 94.81s/it]Task 0, Epoch 2/20 => Loss 0.368, Train_accy 88.72:   5%|▌         | 1/20 [03:09<30:01, 94.81s/it]Task 0, Epoch 2/20 => Loss 0.368, Train_accy 88.72:  10%|█         | 2/20 [03:09<28:24, 94.68s/it]Task 0, Epoch 3/20 => Loss 0.331, Train_accy 89.58:  10%|█         | 2/20 [04:43<28:24, 94.68s/it]Task 0, Epoch 3/20 => Loss 0.331, Train_accy 89.58:  15%|█▌        | 3/20 [04:43<26:48, 94.63s/it]Task 0, Epoch 4/20 => Loss 0.283, Train_accy 91.02:  15%|█▌        | 3/20 [06:18<26:48, 94.63s/it]Task 0, Epoch 4/20 => Loss 0.283, Train_accy 91.02:  20%|██        | 4/20 [06:18<25:14, 94.67s/it]Task 0, Epoch 5/20 => Loss 0.283, Train_accy 91.55, Test_accy 97.15:  20%|██        | 4/20 [08:03<25:14, 94.67s/it]Task 0, Epoch 5/20 => Loss 0.283, Train_accy 91.55, Test_accy 97.15:  25%|██▌       | 5/20 [08:03<24:35, 98.35s/it]Task 0, Epoch 6/20 => Loss 0.273, Train_accy 91.45:  25%|██▌       | 5/20 [09:38<24:35, 98.35s/it]                 Task 0, Epoch 6/20 => Loss 0.273, Train_accy 91.45:  30%|███       | 6/20 [09:38<22:39, 97.13s/it]Task 0, Epoch 7/20 => Loss 0.262, Train_accy 91.95:  30%|███       | 6/20 [11:13<22:39, 97.13s/it]Task 0, Epoch 7/20 => Loss 0.262, Train_accy 91.95:  35%|███▌      | 7/20 [11:13<20:53, 96.39s/it]Task 0, Epoch 8/20 => Loss 0.270, Train_accy 91.71:  35%|███▌      | 7/20 [12:48<20:53, 96.39s/it]Task 0, Epoch 8/20 => Loss 0.270, Train_accy 91.71:  40%|████      | 8/20 [12:48<19:10, 95.91s/it]Task 0, Epoch 9/20 => Loss 0.254, Train_accy 92.14:  40%|████      | 8/20 [14:22<19:10, 95.91s/it]Task 0, Epoch 9/20 => Loss 0.254, Train_accy 92.14:  45%|████▌     | 9/20 [14:22<17:30, 95.53s/it]Task 0, Epoch 10/20 => Loss 0.255, Train_accy 92.18, Test_accy 97.25:  45%|████▌     | 9/20 [16:07<17:30, 95.53s/it]Task 0, Epoch 10/20 => Loss 0.255, Train_accy 92.18, Test_accy 97.25:  50%|█████     | 10/20 [16:07<16:23, 98.37s/it]Task 0, Epoch 11/20 => Loss 0.230, Train_accy 92.60:  50%|█████     | 10/20 [17:42<16:23, 98.37s/it]                 Task 0, Epoch 11/20 => Loss 0.230, Train_accy 92.60:  55%|█████▌    | 11/20 [17:42<14:36, 97.35s/it]Task 0, Epoch 12/20 => Loss 0.239, Train_accy 92.62:  55%|█████▌    | 11/20 [19:17<14:36, 97.35s/it]Task 0, Epoch 12/20 => Loss 0.239, Train_accy 92.62:  60%|██████    | 12/20 [19:17<12:53, 96.67s/it]Task 0, Epoch 13/20 => Loss 0.227, Train_accy 92.69:  60%|██████    | 12/20 [20:52<12:53, 96.67s/it]Task 0, Epoch 13/20 => Loss 0.227, Train_accy 92.69:  65%|██████▌   | 13/20 [20:52<11:11, 95.98s/it]Task 0, Epoch 14/20 => Loss 0.232, Train_accy 92.74:  65%|██████▌   | 13/20 [22:26<11:11, 95.98s/it]Task 0, Epoch 14/20 => Loss 0.232, Train_accy 92.74:  70%|███████   | 14/20 [22:26<09:33, 95.66s/it]Task 0, Epoch 15/20 => Loss 0.237, Train_accy 92.81, Test_accy 97.05:  70%|███████   | 14/20 [24:11<09:33, 95.66s/it]Task 0, Epoch 15/20 => Loss 0.237, Train_accy 92.81, Test_accy 97.05:  75%|███████▌  | 15/20 [24:11<08:12, 98.47s/it]Task 0, Epoch 16/20 => Loss 0.219, Train_accy 92.87:  75%|███████▌  | 15/20 [25:46<08:12, 98.47s/it]                 Task 0, Epoch 16/20 => Loss 0.219, Train_accy 92.87:  80%|████████  | 16/20 [25:46<06:29, 97.37s/it]Task 0, Epoch 17/20 => Loss 0.220, Train_accy 92.96:  80%|████████  | 16/20 [27:21<06:29, 97.37s/it]Task 0, Epoch 17/20 => Loss 0.220, Train_accy 92.96:  85%|████████▌ | 17/20 [27:21<04:49, 96.59s/it]Task 0, Epoch 18/20 => Loss 0.198, Train_accy 93.67:  85%|████████▌ | 17/20 [28:56<04:49, 96.59s/it]Task 0, Epoch 18/20 => Loss 0.198, Train_accy 93.67:  90%|█████████ | 18/20 [28:56<03:12, 96.05s/it]Task 0, Epoch 19/20 => Loss 0.205, Train_accy 93.46:  90%|█████████ | 18/20 [30:31<03:12, 96.05s/it]Task 0, Epoch 19/20 => Loss 0.205, Train_accy 93.46:  95%|█████████▌| 19/20 [30:31<01:35, 95.67s/it]Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.64, Test_accy 97.50:  95%|█████████▌| 19/20 [32:16<01:35, 95.67s/it]Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.64, Test_accy 97.50: 100%|██████████| 20/20 [32:16<00:00, 98.44s/it]Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.64, Test_accy 97.50: 100%|██████████| 20/20 [32:16<00:00, 96.80s/it]
2024-04-27 10:32:13,404 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.203, Train_accy 93.64, Test_accy 97.50
2024-04-27 10:32:23,528 [trainer.py] => No NME accuracy.
2024-04-27 10:32:23,529 [trainer.py] => CNN: {'total': 97.5, '00-19': 97.5, 'old': 0, 'new': 97.5}
2024-04-27 10:32:23,529 [trainer.py] => CNN top1 curve: [97.5]
2024-04-27 10:32:23,529 [trainer.py] => CNN top5 curve: [99.85]

Average Accuracy (CNN): 97.5
2024-04-27 10:32:23,529 [trainer.py] => Average Accuracy (CNN): 97.5 

2024-04-27 10:32:23,529 [trainer.py] => Train Time: 3872.54
2024-04-27 10:32:23,530 [trainer.py] => Test Time: 10.12 

2024-04-27 10:32:23,531 [trainer.py] => All params: 89715556
2024-04-27 10:32:23,532 [trainer.py] => Trainable params: 89715556
2024-04-27 10:32:24,703 [coda_prompt.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.477, Train_accy 86.83:   0%|          | 0/20 [01:35<?, ?it/s]Task 1, Epoch 1/20 => Loss 0.477, Train_accy 86.83:   5%|▌         | 1/20 [01:35<30:05, 95.03s/it]Task 1, Epoch 2/20 => Loss 0.271, Train_accy 92.01:   5%|▌         | 1/20 [03:09<30:05, 95.03s/it]Task 1, Epoch 2/20 => Loss 0.271, Train_accy 92.01:  10%|█         | 2/20 [03:09<28:27, 94.85s/it]Task 1, Epoch 3/20 => Loss 0.260, Train_accy 92.32:  10%|█         | 2/20 [04:44<28:27, 94.85s/it]Task 1, Epoch 3/20 => Loss 0.260, Train_accy 92.32:  15%|█▌        | 3/20 [04:44<26:51, 94.80s/it]Task 1, Epoch 4/20 => Loss 0.229, Train_accy 93.14:  15%|█▌        | 3/20 [06:19<26:51, 94.80s/it]Task 1, Epoch 4/20 => Loss 0.229, Train_accy 93.14:  20%|██        | 4/20 [06:19<25:15, 94.74s/it]Task 1, Epoch 5/20 => Loss 0.229, Train_accy 93.13, Test_accy 93.22:  20%|██        | 4/20 [08:13<25:15, 94.74s/it]Task 1, Epoch 5/20 => Loss 0.229, Train_accy 93.13, Test_accy 93.22:  25%|██▌       | 5/20 [08:13<25:26, 101.80s/it]Task 1, Epoch 6/20 => Loss 0.215, Train_accy 93.74:  25%|██▌       | 5/20 [09:48<25:26, 101.80s/it]                 Task 1, Epoch 6/20 => Loss 0.215, Train_accy 93.74:  30%|███       | 6/20 [09:48<23:10, 99.35s/it] Task 1, Epoch 7/20 => Loss 0.210, Train_accy 93.48:  30%|███       | 6/20 [11:22<23:10, 99.35s/it]Task 1, Epoch 7/20 => Loss 0.210, Train_accy 93.48:  35%|███▌      | 7/20 [11:22<21:10, 97.71s/it]Task 1, Epoch 8/20 => Loss 0.212, Train_accy 93.69:  35%|███▌      | 7/20 [12:56<21:10, 97.71s/it]Task 1, Epoch 8/20 => Loss 0.212, Train_accy 93.69:  40%|████      | 8/20 [12:56<19:20, 96.67s/it]Task 1, Epoch 9/20 => Loss 0.224, Train_accy 93.28:  40%|████      | 8/20 [14:31<19:20, 96.67s/it]Task 1, Epoch 9/20 => Loss 0.224, Train_accy 93.28:  45%|████▌     | 9/20 [14:31<17:37, 96.14s/it]Task 1, Epoch 10/20 => Loss 0.211, Train_accy 93.53, Test_accy 94.42:  45%|████▌     | 9/20 [16:26<17:37, 96.14s/it]Task 1, Epoch 10/20 => Loss 0.211, Train_accy 93.53, Test_accy 94.42:  50%|█████     | 10/20 [16:26<16:59, 101.93s/it]Task 1, Epoch 11/20 => Loss 0.200, Train_accy 93.98:  50%|█████     | 10/20 [18:01<16:59, 101.93s/it]                 Task 1, Epoch 11/20 => Loss 0.200, Train_accy 93.98:  55%|█████▌    | 11/20 [18:01<14:58, 99.80s/it] Task 1, Epoch 12/20 => Loss 0.196, Train_accy 93.94:  55%|█████▌    | 11/20 [19:36<14:58, 99.80s/it]Task 1, Epoch 12/20 => Loss 0.196, Train_accy 93.94:  60%|██████    | 12/20 [19:36<13:06, 98.25s/it]Task 1, Epoch 13/20 => Loss 0.194, Train_accy 94.19:  60%|██████    | 12/20 [21:11<13:06, 98.25s/it]Task 1, Epoch 13/20 => Loss 0.194, Train_accy 94.19:  65%|██████▌   | 13/20 [21:11<11:20, 97.27s/it]Task 1, Epoch 14/20 => Loss 0.197, Train_accy 94.03:  65%|██████▌   | 13/20 [22:46<11:20, 97.27s/it]Task 1, Epoch 14/20 => Loss 0.197, Train_accy 94.03:  70%|███████   | 14/20 [22:46<09:39, 96.61s/it]Task 1, Epoch 15/20 => Loss 0.190, Train_accy 94.19, Test_accy 93.98:  70%|███████   | 14/20 [24:41<09:39, 96.61s/it]Task 1, Epoch 15/20 => Loss 0.190, Train_accy 94.19, Test_accy 93.98:  75%|███████▌  | 15/20 [24:41<08:30, 102.16s/it]Task 1, Epoch 16/20 => Loss 0.177, Train_accy 94.42:  75%|███████▌  | 15/20 [26:16<08:30, 102.16s/it]                 Task 1, Epoch 16/20 => Loss 0.177, Train_accy 94.42:  80%|████████  | 16/20 [26:16<06:40, 100.03s/it]Task 1, Epoch 17/20 => Loss 0.197, Train_accy 93.92:  80%|████████  | 16/20 [27:51<06:40, 100.03s/it]Task 1, Epoch 17/20 => Loss 0.197, Train_accy 93.92:  85%|████████▌ | 17/20 [27:51<04:55, 98.52s/it] Task 1, Epoch 18/20 => Loss 0.165, Train_accy 95.03:  85%|████████▌ | 17/20 [29:26<04:55, 98.52s/it]Task 1, Epoch 18/20 => Loss 0.165, Train_accy 95.03:  90%|█████████ | 18/20 [29:26<03:14, 97.43s/it]Task 1, Epoch 19/20 => Loss 0.179, Train_accy 94.40:  90%|█████████ | 18/20 [31:01<03:14, 97.43s/it]Task 1, Epoch 19/20 => Loss 0.179, Train_accy 94.40:  95%|█████████▌| 19/20 [31:01<01:36, 96.69s/it]Task 1, Epoch 20/20 => Loss 0.172, Train_accy 94.60, Test_accy 94.28:  95%|█████████▌| 19/20 [32:56<01:36, 96.69s/it]Task 1, Epoch 20/20 => Loss 0.172, Train_accy 94.60, Test_accy 94.28: 100%|██████████| 20/20 [32:56<00:00, 102.10s/it]Task 1, Epoch 20/20 => Loss 0.172, Train_accy 94.60, Test_accy 94.28: 100%|██████████| 20/20 [32:56<00:00, 98.81s/it] 
2024-04-27 11:05:20,882 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.172, Train_accy 94.60, Test_accy 94.28
2024-04-27 11:05:40,658 [trainer.py] => No NME accuracy.
2024-04-27 11:05:40,659 [trainer.py] => CNN: {'total': 94.28, '00-19': 93.5, '20-39': 95.05, 'old': 93.5, 'new': 95.05}
2024-04-27 11:05:40,659 [trainer.py] => CNN top1 curve: [97.5, 94.28]
2024-04-27 11:05:40,659 [trainer.py] => CNN top5 curve: [99.85, 99.5]

Average Accuracy (CNN): 95.89
2024-04-27 11:05:40,659 [trainer.py] => Average Accuracy (CNN): 95.89 

2024-04-27 11:05:40,659 [trainer.py] => Train Time: 7824.81
2024-04-27 11:05:40,659 [trainer.py] => Test Time: 29.89 

2024-04-27 11:05:40,660 [trainer.py] => All params: 89715556
2024-04-27 11:05:40,661 [trainer.py] => Trainable params: 89715556
2024-04-27 11:05:42,698 [coda_prompt.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.527, Train_accy 83.92:   0%|          | 0/20 [01:34<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.527, Train_accy 83.92:   5%|▌         | 1/20 [01:34<29:52, 94.35s/it]Task 2, Epoch 2/20 => Loss 0.298, Train_accy 90.26:   5%|▌         | 1/20 [03:09<29:52, 94.35s/it]Task 2, Epoch 2/20 => Loss 0.298, Train_accy 90.26:  10%|█         | 2/20 [03:09<28:26, 94.81s/it]Task 2, Epoch 3/20 => Loss 0.277, Train_accy 90.56:  10%|█         | 2/20 [04:44<28:26, 94.81s/it]Task 2, Epoch 3/20 => Loss 0.277, Train_accy 90.56:  15%|█▌        | 3/20 [04:44<26:57, 95.12s/it]Task 2, Epoch 4/20 => Loss 0.269, Train_accy 90.88:  15%|█▌        | 3/20 [06:20<26:57, 95.12s/it]Task 2, Epoch 4/20 => Loss 0.269, Train_accy 90.88:  20%|██        | 4/20 [06:20<25:22, 95.17s/it]Task 2, Epoch 5/20 => Loss 0.265, Train_accy 90.95, Test_accy 91.15:  20%|██        | 4/20 [08:25<25:22, 95.17s/it]Task 2, Epoch 5/20 => Loss 0.265, Train_accy 90.95, Test_accy 91.15:  25%|██▌       | 5/20 [08:25<26:28, 105.88s/it]Task 2, Epoch 6/20 => Loss 0.251, Train_accy 91.44:  25%|██▌       | 5/20 [10:00<26:28, 105.88s/it]                 Task 2, Epoch 6/20 => Loss 0.251, Train_accy 91.44:  30%|███       | 6/20 [10:00<23:51, 102.25s/it]Task 2, Epoch 7/20 => Loss 0.250, Train_accy 91.74:  30%|███       | 6/20 [11:35<23:51, 102.25s/it]Task 2, Epoch 7/20 => Loss 0.250, Train_accy 91.74:  35%|███▌      | 7/20 [11:35<21:38, 99.85s/it] Task 2, Epoch 8/20 => Loss 0.237, Train_accy 92.13:  35%|███▌      | 7/20 [13:10<21:38, 99.85s/it]Task 2, Epoch 8/20 => Loss 0.237, Train_accy 92.13:  40%|████      | 8/20 [13:10<19:39, 98.30s/it]Task 2, Epoch 9/20 => Loss 0.233, Train_accy 92.16:  40%|████      | 8/20 [14:44<19:39, 98.30s/it]Task 2, Epoch 9/20 => Loss 0.233, Train_accy 92.16:  45%|████▌     | 9/20 [14:44<17:49, 97.19s/it]Task 2, Epoch 10/20 => Loss 0.250, Train_accy 91.87, Test_accy 92.23:  45%|████▌     | 9/20 [16:49<17:49, 97.19s/it]Task 2, Epoch 10/20 => Loss 0.250, Train_accy 91.87, Test_accy 92.23:  50%|█████     | 10/20 [16:49<17:37, 105.71s/it]Task 2, Epoch 11/20 => Loss 0.228, Train_accy 92.21:  50%|█████     | 10/20 [18:24<17:37, 105.71s/it]                 Task 2, Epoch 11/20 => Loss 0.228, Train_accy 92.21:  55%|█████▌    | 11/20 [18:24<15:22, 102.52s/it]Task 2, Epoch 12/20 => Loss 0.230, Train_accy 92.14:  55%|█████▌    | 11/20 [20:00<15:22, 102.52s/it]Task 2, Epoch 12/20 => Loss 0.230, Train_accy 92.14:  60%|██████    | 12/20 [20:00<13:21, 100.24s/it]Task 2, Epoch 13/20 => Loss 0.226, Train_accy 92.63:  60%|██████    | 12/20 [21:35<13:21, 100.24s/it]Task 2, Epoch 13/20 => Loss 0.226, Train_accy 92.63:  65%|██████▌   | 13/20 [21:35<11:31, 98.75s/it] Task 2, Epoch 14/20 => Loss 0.210, Train_accy 93.01:  65%|██████▌   | 13/20 [23:10<11:31, 98.75s/it]Task 2, Epoch 14/20 => Loss 0.210, Train_accy 93.01:  70%|███████   | 14/20 [23:10<09:46, 97.67s/it]Task 2, Epoch 15/20 => Loss 0.217, Train_accy 92.75, Test_accy 92.10:  70%|███████   | 14/20 [25:15<09:46, 97.67s/it]Task 2, Epoch 15/20 => Loss 0.217, Train_accy 92.75, Test_accy 92.10:  75%|███████▌  | 15/20 [25:15<08:49, 105.87s/it]Task 2, Epoch 16/20 => Loss 0.205, Train_accy 93.27:  75%|███████▌  | 15/20 [26:50<08:49, 105.87s/it]                 Task 2, Epoch 16/20 => Loss 0.205, Train_accy 93.27:  80%|████████  | 16/20 [26:50<06:50, 102.67s/it]Task 2, Epoch 17/20 => Loss 0.209, Train_accy 93.10:  80%|████████  | 16/20 [28:25<06:50, 102.67s/it]Task 2, Epoch 17/20 => Loss 0.209, Train_accy 93.10:  85%|████████▌ | 17/20 [28:25<05:01, 100.38s/it]Task 2, Epoch 18/20 => Loss 0.201, Train_accy 93.13:  85%|████████▌ | 17/20 [30:00<05:01, 100.38s/it]Task 2, Epoch 18/20 => Loss 0.201, Train_accy 93.13:  90%|█████████ | 18/20 [30:00<03:17, 98.85s/it] Task 2, Epoch 19/20 => Loss 0.199, Train_accy 93.46:  90%|█████████ | 18/20 [31:35<03:17, 98.85s/it]Task 2, Epoch 19/20 => Loss 0.199, Train_accy 93.46:  95%|█████████▌| 19/20 [31:35<01:37, 97.66s/it]Task 2, Epoch 20/20 => Loss 0.198, Train_accy 93.31, Test_accy 92.02:  95%|█████████▌| 19/20 [33:40<01:37, 97.66s/it]Task 2, Epoch 20/20 => Loss 0.198, Train_accy 93.31, Test_accy 92.02: 100%|██████████| 20/20 [33:40<00:00, 105.84s/it]Task 2, Epoch 20/20 => Loss 0.198, Train_accy 93.31, Test_accy 92.02: 100%|██████████| 20/20 [33:40<00:00, 101.04s/it]
2024-04-27 11:39:23,528 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.198, Train_accy 93.31, Test_accy 92.02
2024-04-27 11:39:53,291 [trainer.py] => No NME accuracy.
2024-04-27 11:39:53,292 [trainer.py] => CNN: {'total': 92.02, '00-19': 91.95, '20-39': 93.15, '40-59': 90.95, 'old': 92.55, 'new': 90.95}
2024-04-27 11:39:53,292 [trainer.py] => CNN top1 curve: [97.5, 94.28, 92.02]
2024-04-27 11:39:53,292 [trainer.py] => CNN top5 curve: [99.85, 99.5, 99.42]

Average Accuracy (CNN): 94.6
2024-04-27 11:39:53,292 [trainer.py] => Average Accuracy (CNN): 94.6 

2024-04-27 11:39:53,292 [trainer.py] => Train Time: 11866.39
2024-04-27 11:39:53,292 [trainer.py] => Test Time: 59.650000000000006 

2024-04-27 11:39:53,294 [trainer.py] => All params: 89715556
2024-04-27 11:39:53,295 [trainer.py] => Trainable params: 89715556
2024-04-27 11:39:56,156 [coda_prompt.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.551, Train_accy 83.71:   0%|          | 0/20 [01:35<?, ?it/s]Task 3, Epoch 1/20 => Loss 0.551, Train_accy 83.71:   5%|▌         | 1/20 [01:35<30:07, 95.14s/it]Task 3, Epoch 2/20 => Loss 0.339, Train_accy 89.17:   5%|▌         | 1/20 [03:10<30:07, 95.14s/it]Task 3, Epoch 2/20 => Loss 0.339, Train_accy 89.17:  10%|█         | 2/20 [03:10<28:30, 95.00s/it]Task 3, Epoch 3/20 => Loss 0.312, Train_accy 90.16:  10%|█         | 2/20 [04:44<28:30, 95.00s/it]Task 3, Epoch 3/20 => Loss 0.312, Train_accy 90.16:  15%|█▌        | 3/20 [04:44<26:54, 94.97s/it]Task 3, Epoch 4/20 => Loss 0.286, Train_accy 91.15:  15%|█▌        | 3/20 [06:19<26:54, 94.97s/it]Task 3, Epoch 4/20 => Loss 0.286, Train_accy 91.15:  20%|██        | 4/20 [06:19<25:19, 94.97s/it]Task 3, Epoch 5/20 => Loss 0.266, Train_accy 91.75, Test_accy 89.79:  20%|██        | 4/20 [08:34<25:19, 94.97s/it]Task 3, Epoch 5/20 => Loss 0.266, Train_accy 91.75, Test_accy 89.79:  25%|██▌       | 5/20 [08:34<27:17, 109.14s/it]Task 3, Epoch 6/20 => Loss 0.268, Train_accy 91.60:  25%|██▌       | 5/20 [10:09<27:17, 109.14s/it]                 Task 3, Epoch 6/20 => Loss 0.268, Train_accy 91.60:  30%|███       | 6/20 [10:09<24:20, 104.29s/it]Task 3, Epoch 7/20 => Loss 0.264, Train_accy 91.63:  30%|███       | 6/20 [11:44<24:20, 104.29s/it]Task 3, Epoch 7/20 => Loss 0.264, Train_accy 91.63:  35%|███▌      | 7/20 [11:44<21:56, 101.25s/it]Task 3, Epoch 8/20 => Loss 0.246, Train_accy 92.22:  35%|███▌      | 7/20 [13:19<21:56, 101.25s/it]Task 3, Epoch 8/20 => Loss 0.246, Train_accy 92.22:  40%|████      | 8/20 [13:19<19:50, 99.24s/it] Task 3, Epoch 9/20 => Loss 0.262, Train_accy 91.59:  40%|████      | 8/20 [14:53<19:50, 99.24s/it]Task 3, Epoch 9/20 => Loss 0.262, Train_accy 91.59:  45%|████▌     | 9/20 [14:53<17:56, 97.90s/it]Task 3, Epoch 10/20 => Loss 0.232, Train_accy 92.77, Test_accy 90.59:  45%|████▌     | 9/20 [17:08<17:56, 97.90s/it]Task 3, Epoch 10/20 => Loss 0.232, Train_accy 92.77, Test_accy 90.59:  50%|█████     | 10/20 [17:08<18:11, 109.12s/it]Task 3, Epoch 11/20 => Loss 0.235, Train_accy 92.50:  50%|█████     | 10/20 [18:43<18:11, 109.12s/it]                 Task 3, Epoch 11/20 => Loss 0.235, Train_accy 92.50:  55%|█████▌    | 11/20 [18:43<15:43, 104.80s/it]Task 3, Epoch 12/20 => Loss 0.231, Train_accy 92.64:  55%|█████▌    | 11/20 [20:18<15:43, 104.80s/it]Task 3, Epoch 12/20 => Loss 0.231, Train_accy 92.64:  60%|██████    | 12/20 [20:18<13:34, 101.76s/it]Task 3, Epoch 13/20 => Loss 0.225, Train_accy 92.81:  60%|██████    | 12/20 [21:53<13:34, 101.76s/it]Task 3, Epoch 13/20 => Loss 0.225, Train_accy 92.81:  65%|██████▌   | 13/20 [21:53<11:38, 99.77s/it] Task 3, Epoch 14/20 => Loss 0.236, Train_accy 92.56:  65%|██████▌   | 13/20 [23:28<11:38, 99.77s/it]Task 3, Epoch 14/20 => Loss 0.236, Train_accy 92.56:  70%|███████   | 14/20 [23:28<09:49, 98.28s/it]Task 3, Epoch 15/20 => Loss 0.216, Train_accy 92.96, Test_accy 90.62:  70%|███████   | 14/20 [25:42<09:49, 98.28s/it]Task 3, Epoch 15/20 => Loss 0.216, Train_accy 92.96, Test_accy 90.62:  75%|███████▌  | 15/20 [25:42<09:05, 109.08s/it]Task 3, Epoch 16/20 => Loss 0.223, Train_accy 92.81:  75%|███████▌  | 15/20 [27:17<09:05, 109.08s/it]                 Task 3, Epoch 16/20 => Loss 0.223, Train_accy 92.81:  80%|████████  | 16/20 [27:17<06:59, 104.81s/it]Task 3, Epoch 17/20 => Loss 0.215, Train_accy 93.09:  80%|████████  | 16/20 [28:51<06:59, 104.81s/it]Task 3, Epoch 17/20 => Loss 0.215, Train_accy 93.09:  85%|████████▌ | 17/20 [28:51<05:05, 101.80s/it]Task 3, Epoch 18/20 => Loss 0.202, Train_accy 93.64:  85%|████████▌ | 17/20 [30:26<05:05, 101.80s/it]Task 3, Epoch 18/20 => Loss 0.202, Train_accy 93.64:  90%|█████████ | 18/20 [30:26<03:19, 99.75s/it] Task 3, Epoch 19/20 => Loss 0.220, Train_accy 92.86:  90%|█████████ | 18/20 [32:01<03:19, 99.75s/it]Task 3, Epoch 19/20 => Loss 0.220, Train_accy 92.86:  95%|█████████▌| 19/20 [32:01<01:38, 98.30s/it]Task 3, Epoch 20/20 => Loss 0.197, Train_accy 93.91, Test_accy 90.61:  95%|█████████▌| 19/20 [34:15<01:38, 98.30s/it]Task 3, Epoch 20/20 => Loss 0.197, Train_accy 93.91, Test_accy 90.61: 100%|██████████| 20/20 [34:15<00:00, 108.93s/it]Task 3, Epoch 20/20 => Loss 0.197, Train_accy 93.91, Test_accy 90.61: 100%|██████████| 20/20 [34:15<00:00, 102.77s/it]
2024-04-27 12:14:11,749 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.197, Train_accy 93.91, Test_accy 90.61
2024-04-27 12:14:51,034 [trainer.py] => No NME accuracy.
2024-04-27 12:14:51,034 [trainer.py] => CNN: {'total': 90.61, '00-19': 91.05, '20-39': 92.4, '40-59': 90.15, '60-79': 88.85, 'old': 91.2, 'new': 88.85}
2024-04-27 12:14:51,034 [trainer.py] => CNN top1 curve: [97.5, 94.28, 92.02, 90.61]
2024-04-27 12:14:51,034 [trainer.py] => CNN top5 curve: [99.85, 99.5, 99.42, 98.9]

Average Accuracy (CNN): 93.6
2024-04-27 12:14:51,034 [trainer.py] => Average Accuracy (CNN): 93.6 

2024-04-27 12:14:51,034 [trainer.py] => Train Time: 15977.339999999998
2024-04-27 12:14:51,034 [trainer.py] => Test Time: 98.93 

2024-04-27 12:14:51,035 [trainer.py] => All params: 89715556
2024-04-27 12:14:51,036 [trainer.py] => Trainable params: 89715556
2024-04-27 12:14:55,008 [coda_prompt.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.469, Train_accy 86.57:   0%|          | 0/20 [01:34<?, ?it/s]Task 4, Epoch 1/20 => Loss 0.469, Train_accy 86.57:   5%|▌         | 1/20 [01:34<30:02, 94.86s/it]Task 4, Epoch 2/20 => Loss 0.231, Train_accy 93.05:   5%|▌         | 1/20 [03:09<30:02, 94.86s/it]Task 4, Epoch 2/20 => Loss 0.231, Train_accy 93.05:  10%|█         | 2/20 [03:09<28:29, 94.99s/it]Task 4, Epoch 3/20 => Loss 0.217, Train_accy 93.50:  10%|█         | 2/20 [04:45<28:29, 94.99s/it]Task 4, Epoch 3/20 => Loss 0.217, Train_accy 93.50:  15%|█▌        | 3/20 [04:45<26:57, 95.13s/it]Task 4, Epoch 4/20 => Loss 0.220, Train_accy 93.36:  15%|█▌        | 3/20 [06:20<26:57, 95.13s/it]Task 4, Epoch 4/20 => Loss 0.220, Train_accy 93.36:  20%|██        | 4/20 [06:20<25:23, 95.24s/it]Task 4, Epoch 5/20 => Loss 0.201, Train_accy 93.89, Test_accy 88.67:  20%|██        | 4/20 [08:45<25:23, 95.24s/it]Task 4, Epoch 5/20 => Loss 0.201, Train_accy 93.89, Test_accy 88.67:  25%|██▌       | 5/20 [08:45<28:15, 113.03s/it]Task 4, Epoch 6/20 => Loss 0.192, Train_accy 94.10:  25%|██▌       | 5/20 [10:20<28:15, 113.03s/it]                 Task 4, Epoch 6/20 => Loss 0.192, Train_accy 94.10:  30%|███       | 6/20 [10:20<24:58, 107.01s/it]Task 4, Epoch 7/20 => Loss 0.192, Train_accy 93.86:  30%|███       | 6/20 [11:55<24:58, 107.01s/it]Task 4, Epoch 7/20 => Loss 0.192, Train_accy 93.86:  35%|███▌      | 7/20 [11:55<22:21, 103.20s/it]Task 4, Epoch 8/20 => Loss 0.197, Train_accy 93.97:  35%|███▌      | 7/20 [13:31<22:21, 103.20s/it]Task 4, Epoch 8/20 => Loss 0.197, Train_accy 93.97:  40%|████      | 8/20 [13:31<20:08, 100.68s/it]Task 4, Epoch 9/20 => Loss 0.185, Train_accy 94.31:  40%|████      | 8/20 [15:06<20:08, 100.68s/it]Task 4, Epoch 9/20 => Loss 0.185, Train_accy 94.31:  45%|████▌     | 9/20 [15:06<18:08, 98.98s/it] Task 4, Epoch 10/20 => Loss 0.189, Train_accy 93.95, Test_accy 89.30:  45%|████▌     | 9/20 [17:30<18:08, 98.98s/it]Task 4, Epoch 10/20 => Loss 0.189, Train_accy 93.95, Test_accy 89.30:  50%|█████     | 10/20 [17:30<18:49, 112.95s/it]Task 4, Epoch 11/20 => Loss 0.178, Train_accy 94.52:  50%|█████     | 10/20 [19:05<18:49, 112.95s/it]                 Task 4, Epoch 11/20 => Loss 0.178, Train_accy 94.52:  55%|█████▌    | 11/20 [19:05<16:07, 107.53s/it]Task 4, Epoch 12/20 => Loss 0.175, Train_accy 94.77:  55%|█████▌    | 11/20 [20:41<16:07, 107.53s/it]Task 4, Epoch 12/20 => Loss 0.175, Train_accy 94.77:  60%|██████    | 12/20 [20:41<13:50, 103.84s/it]Task 4, Epoch 13/20 => Loss 0.165, Train_accy 94.92:  60%|██████    | 12/20 [22:16<13:50, 103.84s/it]Task 4, Epoch 13/20 => Loss 0.165, Train_accy 94.92:  65%|██████▌   | 13/20 [22:16<11:48, 101.26s/it]Task 4, Epoch 14/20 => Loss 0.173, Train_accy 94.69:  65%|██████▌   | 13/20 [23:51<11:48, 101.26s/it]Task 4, Epoch 14/20 => Loss 0.173, Train_accy 94.69:  70%|███████   | 14/20 [23:51<09:56, 99.37s/it] Task 4, Epoch 15/20 => Loss 0.162, Train_accy 94.91, Test_accy 89.36:  70%|███████   | 14/20 [26:15<09:56, 99.37s/it]Task 4, Epoch 15/20 => Loss 0.162, Train_accy 94.91, Test_accy 89.36:  75%|███████▌  | 15/20 [26:15<09:23, 112.80s/it]Task 4, Epoch 16/20 => Loss 0.154, Train_accy 95.22:  75%|███████▌  | 15/20 [27:50<09:23, 112.80s/it]                 Task 4, Epoch 16/20 => Loss 0.154, Train_accy 95.22:  80%|████████  | 16/20 [27:50<07:09, 107.44s/it]Task 4, Epoch 17/20 => Loss 0.168, Train_accy 94.96:  80%|████████  | 16/20 [29:25<07:09, 107.44s/it]Task 4, Epoch 17/20 => Loss 0.168, Train_accy 94.96:  85%|████████▌ | 17/20 [29:25<05:11, 103.68s/it]Task 4, Epoch 18/20 => Loss 0.152, Train_accy 95.22:  85%|████████▌ | 17/20 [31:00<05:11, 103.68s/it]Task 4, Epoch 18/20 => Loss 0.152, Train_accy 95.22:  90%|█████████ | 18/20 [31:00<03:22, 101.05s/it]Task 4, Epoch 19/20 => Loss 0.167, Train_accy 94.95:  90%|█████████ | 18/20 [32:34<03:22, 101.05s/it]Task 4, Epoch 19/20 => Loss 0.167, Train_accy 94.95:  95%|█████████▌| 19/20 [32:34<01:39, 99.06s/it] Task 4, Epoch 20/20 => Loss 0.150, Train_accy 95.32, Test_accy 89.27:  95%|█████████▌| 19/20 [34:58<01:39, 99.06s/it]Task 4, Epoch 20/20 => Loss 0.150, Train_accy 95.32, Test_accy 89.27: 100%|██████████| 20/20 [34:58<00:00, 112.60s/it]Task 4, Epoch 20/20 => Loss 0.150, Train_accy 95.32, Test_accy 89.27: 100%|██████████| 20/20 [34:58<00:00, 104.95s/it]
2024-04-27 12:49:54,029 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.150, Train_accy 95.32, Test_accy 89.27
2024-04-27 12:50:43,174 [trainer.py] => No NME accuracy.
2024-04-27 12:50:43,175 [trainer.py] => CNN: {'total': 89.27, '00-19': 90.65, '20-39': 91.1, '40-59': 88.45, '60-79': 86.85, '80-99': 89.3, 'old': 89.26, 'new': 89.3}
2024-04-27 12:50:43,175 [trainer.py] => CNN top1 curve: [97.5, 94.28, 92.02, 90.61, 89.27]
2024-04-27 12:50:43,175 [trainer.py] => CNN top5 curve: [99.85, 99.5, 99.42, 98.9, 98.82]

Average Accuracy (CNN): 92.74
2024-04-27 12:50:43,175 [trainer.py] => Average Accuracy (CNN): 92.74 

2024-04-27 12:50:43,175 [trainer.py] => Train Time: 20175.27
2024-04-27 12:50:43,175 [trainer.py] => Test Time: 148.07 

Accuracy Matrix (CNN):
[[97.5  93.5  91.95 91.05 90.65]
 [ 0.   95.05 93.15 92.4  91.1 ]
 [ 0.    0.   90.95 90.15 88.45]
 [ 0.    0.    0.   88.85 86.85]
 [ 0.    0.    0.    0.   89.3 ]]
2024-04-27 12:50:43,176 [trainer.py] => Forgetting (CNN): 3.8249999999999993
2024-04-27 12:50:45,868 [trainer.py] => config: ./exps/simplecil_cifar_B0_Inc5.json
2024-04-27 12:50:45,890 [trainer.py] => prefix:  
2024-04-27 12:50:45,890 [trainer.py] => dataset: cifar224
2024-04-27 12:50:45,890 [trainer.py] => memory_size: 0
2024-04-27 12:50:45,890 [trainer.py] => memory_per_class: 0
2024-04-27 12:50:45,890 [trainer.py] => fixed_memory: False
2024-04-27 12:50:45,890 [trainer.py] => shuffle: True
2024-04-27 12:50:45,890 [trainer.py] => init_cls: 20
2024-04-27 12:50:45,890 [trainer.py] => increment: 20
2024-04-27 12:50:45,890 [trainer.py] => model_name: simplecil
2024-04-27 12:50:45,890 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-04-27 12:50:45,890 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-27 12:50:45,890 [trainer.py] => seed: 1993
2024-04-27 12:50:45,891 [trainer.py] => tuned_epoch: 20
2024-04-27 12:50:45,891 [trainer.py] => init_lr: 0.01
2024-04-27 12:50:45,891 [trainer.py] => batch_size: 48
2024-04-27 12:50:45,891 [trainer.py] => weight_decay: 0.05
2024-04-27 12:50:45,891 [trainer.py] => min_lr: 1e-08
2024-04-27 12:50:45,891 [trainer.py] => optimizer: sgd
2024-04-27 12:50:45,891 [trainer.py] => vpt_type: shallow
2024-04-27 12:50:45,891 [trainer.py] => prompt_token_num: 3
Files already downloaded and verified
Files already downloaded and verified
2024-04-27 12:50:47,854 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-27 12:50:50,330 [trainer.py] => All params: 85798656
2024-04-27 12:50:50,331 [trainer.py] => Trainable params: 85798656
2024-04-27 12:50:50,771 [simplecil.py] => Learning on 0-20
2024-04-27 12:51:21,330 [trainer.py] => No NME accuracy.
2024-04-27 12:51:21,331 [trainer.py] => CNN: {'total': 88.3, '00-19': 88.3, 'old': 0, 'new': 88.3}
2024-04-27 12:51:21,331 [trainer.py] => CNN top1 curve: [88.3]
2024-04-27 12:51:21,331 [trainer.py] => CNN top5 curve: [97.85]

Average Accuracy (CNN): 88.3
2024-04-27 12:51:21,331 [trainer.py] => Average Accuracy (CNN): 88.3 

2024-04-27 12:51:21,331 [trainer.py] => Train Time: 25.12
2024-04-27 12:51:21,331 [trainer.py] => Test Time: 5.39 

2024-04-27 12:51:21,332 [trainer.py] => All params: 85814017
2024-04-27 12:51:21,333 [trainer.py] => Trainable params: 85814017
2024-04-27 12:51:21,335 [simplecil.py] => Learning on 20-40
2024-04-27 12:51:56,603 [trainer.py] => No NME accuracy.
2024-04-27 12:51:56,604 [trainer.py] => CNN: {'total': 83.7, '00-19': 83.0, '20-39': 84.4, 'old': 83.0, 'new': 84.4}
2024-04-27 12:51:56,604 [trainer.py] => CNN top1 curve: [88.3, 83.7]
2024-04-27 12:51:56,604 [trainer.py] => CNN top5 curve: [97.85, 96.25]

Average Accuracy (CNN): 86.0
2024-04-27 12:51:56,605 [trainer.py] => Average Accuracy (CNN): 86.0 

2024-04-27 12:51:56,605 [trainer.py] => Train Time: 50.17
2024-04-27 12:51:56,605 [trainer.py] => Test Time: 15.559999999999999 

2024-04-27 12:51:56,607 [trainer.py] => All params: 85829377
2024-04-27 12:51:56,608 [trainer.py] => Trainable params: 85829377
2024-04-27 12:51:56,610 [simplecil.py] => Learning on 40-60
2024-04-27 12:52:36,870 [trainer.py] => No NME accuracy.
2024-04-27 12:52:36,870 [trainer.py] => CNN: {'total': 80.07, '00-19': 79.5, '20-39': 80.8, '40-59': 79.9, 'old': 80.15, 'new': 79.9}
2024-04-27 12:52:36,870 [trainer.py] => CNN top1 curve: [88.3, 83.7, 80.07]
2024-04-27 12:52:36,870 [trainer.py] => CNN top5 curve: [97.85, 96.25, 94.47]

Average Accuracy (CNN): 84.02
2024-04-27 12:52:36,870 [trainer.py] => Average Accuracy (CNN): 84.02 

2024-04-27 12:52:36,870 [trainer.py] => Train Time: 75.02000000000001
2024-04-27 12:52:36,870 [trainer.py] => Test Time: 30.909999999999997 

2024-04-27 12:52:36,871 [trainer.py] => All params: 85844737
2024-04-27 12:52:36,872 [trainer.py] => Trainable params: 85844737
2024-04-27 12:52:36,873 [simplecil.py] => Learning on 60-80
2024-04-27 12:53:22,210 [trainer.py] => No NME accuracy.
2024-04-27 12:53:22,210 [trainer.py] => CNN: {'total': 77.31, '00-19': 76.95, '20-39': 79.85, '40-59': 75.25, '60-79': 77.2, 'old': 77.35, 'new': 77.2}
2024-04-27 12:53:22,210 [trainer.py] => CNN top1 curve: [88.3, 83.7, 80.07, 77.31]
2024-04-27 12:53:22,210 [trainer.py] => CNN top5 curve: [97.85, 96.25, 94.47, 93.54]

Average Accuracy (CNN): 82.34
2024-04-27 12:53:22,210 [trainer.py] => Average Accuracy (CNN): 82.34 

2024-04-27 12:53:22,210 [trainer.py] => Train Time: 100.19000000000001
2024-04-27 12:53:22,211 [trainer.py] => Test Time: 50.92999999999999 

2024-04-27 12:53:22,212 [trainer.py] => All params: 85860097
2024-04-27 12:53:22,213 [trainer.py] => Trainable params: 85860097
2024-04-27 12:53:22,215 [simplecil.py] => Learning on 80-100
2024-04-27 12:54:11,708 [trainer.py] => No NME accuracy.
2024-04-27 12:54:11,708 [trainer.py] => CNN: {'total': 76.21, '00-19': 75.25, '20-39': 78.35, '40-59': 72.55, '60-79': 76.2, '80-99': 78.7, 'old': 75.59, 'new': 78.7}
2024-04-27 12:54:11,709 [trainer.py] => CNN top1 curve: [88.3, 83.7, 80.07, 77.31, 76.21]
2024-04-27 12:54:11,709 [trainer.py] => CNN top5 curve: [97.85, 96.25, 94.47, 93.54, 92.54]

Average Accuracy (CNN): 81.12
2024-04-27 12:54:11,709 [trainer.py] => Average Accuracy (CNN): 81.12 

2024-04-27 12:54:11,709 [trainer.py] => Train Time: 124.92000000000002
2024-04-27 12:54:11,709 [trainer.py] => Test Time: 75.61999999999999 

Accuracy Matrix (CNN):
[[88.3  83.   79.5  76.95 75.25]
 [ 0.   84.4  80.8  79.85 78.35]
 [ 0.    0.   79.9  75.25 72.55]
 [ 0.    0.    0.   77.2  76.2 ]
 [ 0.    0.    0.    0.   78.7 ]]
2024-04-27 12:54:11,710 [trainer.py] => Forgetting (CNN): 6.862500000000004
2024-04-27 12:54:14,314 [trainer.py] => config: ./exps/ease_cifar_B0_Inc5.json
2024-04-27 12:54:14,314 [trainer.py] => prefix:  
2024-04-27 12:54:14,314 [trainer.py] => dataset: cifar224
2024-04-27 12:54:14,314 [trainer.py] => memory_size: 0
2024-04-27 12:54:14,314 [trainer.py] => memory_per_class: 0
2024-04-27 12:54:14,314 [trainer.py] => fixed_memory: False
2024-04-27 12:54:14,314 [trainer.py] => shuffle: True
2024-04-27 12:54:14,314 [trainer.py] => init_cls: 20
2024-04-27 12:54:14,314 [trainer.py] => increment: 20
2024-04-27 12:54:14,314 [trainer.py] => model_name: ease
2024-04-27 12:54:14,314 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-04-27 12:54:14,314 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-27 12:54:14,314 [trainer.py] => seed: 1993
2024-04-27 12:54:14,314 [trainer.py] => init_epochs: 20
2024-04-27 12:54:14,314 [trainer.py] => init_lr: 0.025
2024-04-27 12:54:14,314 [trainer.py] => later_epochs: 20
2024-04-27 12:54:14,314 [trainer.py] => later_lr: 0.025
2024-04-27 12:54:14,314 [trainer.py] => batch_size: 48
2024-04-27 12:54:14,314 [trainer.py] => weight_decay: 0.0005
2024-04-27 12:54:14,314 [trainer.py] => min_lr: 0
2024-04-27 12:54:14,314 [trainer.py] => optimizer: sgd
2024-04-27 12:54:14,314 [trainer.py] => scheduler: cosine
2024-04-27 12:54:14,314 [trainer.py] => pretrained: True
2024-04-27 12:54:14,314 [trainer.py] => vpt_type: Deep
2024-04-27 12:54:14,314 [trainer.py] => prompt_token_num: 5
2024-04-27 12:54:14,314 [trainer.py] => ffn_num: 64
2024-04-27 12:54:14,315 [trainer.py] => use_diagonal: False
2024-04-27 12:54:14,315 [trainer.py] => recalc_sim: True
2024-04-27 12:54:14,315 [trainer.py] => alpha: 0.1
2024-04-27 12:54:14,315 [trainer.py] => use_init_ptm: False
2024-04-27 12:54:14,315 [trainer.py] => beta: 0
2024-04-27 12:54:14,315 [trainer.py] => use_old_data: False
2024-04-27 12:54:14,315 [trainer.py] => use_reweight: True
2024-04-27 12:54:14,315 [trainer.py] => moni_adam: False
2024-04-27 12:54:14,315 [trainer.py] => adapter_num: -1
Files already downloaded and verified
Files already downloaded and verified
2024-04-27 12:54:16,106 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
This is for the BaseNet initialization.
I'm using ViT with adapters.
_IncompatibleKeys(missing_keys=['cur_adapter.0.down_proj.weight', 'cur_adapter.0.down_proj.bias', 'cur_adapter.0.up_proj.weight', 'cur_adapter.0.up_proj.bias', 'cur_adapter.1.down_proj.weight', 'cur_adapter.1.down_proj.bias', 'cur_adapter.1.up_proj.weight', 'cur_adapter.1.up_proj.bias', 'cur_adapter.2.down_proj.weight', 'cur_adapter.2.down_proj.bias', 'cur_adapter.2.up_proj.weight', 'cur_adapter.2.up_proj.bias', 'cur_adapter.3.down_proj.weight', 'cur_adapter.3.down_proj.bias', 'cur_adapter.3.up_proj.weight', 'cur_adapter.3.up_proj.bias', 'cur_adapter.4.down_proj.weight', 'cur_adapter.4.down_proj.bias', 'cur_adapter.4.up_proj.weight', 'cur_adapter.4.up_proj.bias', 'cur_adapter.5.down_proj.weight', 'cur_adapter.5.down_proj.bias', 'cur_adapter.5.up_proj.weight', 'cur_adapter.5.up_proj.bias', 'cur_adapter.6.down_proj.weight', 'cur_adapter.6.down_proj.bias', 'cur_adapter.6.up_proj.weight', 'cur_adapter.6.up_proj.bias', 'cur_adapter.7.down_proj.weight', 'cur_adapter.7.down_proj.bias', 'cur_adapter.7.up_proj.weight', 'cur_adapter.7.up_proj.bias', 'cur_adapter.8.down_proj.weight', 'cur_adapter.8.down_proj.bias', 'cur_adapter.8.up_proj.weight', 'cur_adapter.8.up_proj.bias', 'cur_adapter.9.down_proj.weight', 'cur_adapter.9.down_proj.bias', 'cur_adapter.9.up_proj.weight', 'cur_adapter.9.up_proj.bias', 'cur_adapter.10.down_proj.weight', 'cur_adapter.10.down_proj.bias', 'cur_adapter.10.up_proj.weight', 'cur_adapter.10.up_proj.bias', 'cur_adapter.11.down_proj.weight', 'cur_adapter.11.down_proj.bias', 'cur_adapter.11.up_proj.weight', 'cur_adapter.11.up_proj.bias'], unexpected_keys=[])
After BaseNet initialization.
2024-04-27 12:54:19,245 [trainer.py] => All params: 86988288
2024-04-27 12:54:19,245 [trainer.py] => Trainable params: 1189632
2024-04-27 12:54:19,263 [ease.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.714, Train_accy 69.03:   0%|          | 0/20 [01:41<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.714, Train_accy 69.03:   5%|▌         | 1/20 [01:41<32:10, 101.61s/it]Task 0, Epoch 2/20 => Loss 0.501, Train_accy 86.92:   5%|▌         | 1/20 [03:23<32:10, 101.61s/it]Task 0, Epoch 2/20 => Loss 0.501, Train_accy 86.92:  10%|█         | 2/20 [03:23<30:29, 101.66s/it]Task 0, Epoch 3/20 => Loss 0.430, Train_accy 87.86:  10%|█         | 2/20 [05:04<30:29, 101.66s/it]Task 0, Epoch 3/20 => Loss 0.430, Train_accy 87.86:  15%|█▌        | 3/20 [05:04<28:48, 101.66s/it]Task 0, Epoch 4/20 => Loss 0.405, Train_accy 88.34:  15%|█▌        | 3/20 [06:46<28:48, 101.66s/it]Task 0, Epoch 4/20 => Loss 0.405, Train_accy 88.34:  20%|██        | 4/20 [06:46<27:06, 101.67s/it]Task 0, Epoch 5/20 => Loss 0.374, Train_accy 88.98:  20%|██        | 4/20 [08:28<27:06, 101.67s/it]Task 0, Epoch 5/20 => Loss 0.374, Train_accy 88.98:  25%|██▌       | 5/20 [08:28<25:24, 101.60s/it]Task 0, Epoch 6/20 => Loss 0.385, Train_accy 89.07:  25%|██▌       | 5/20 [10:09<25:24, 101.60s/it]Task 0, Epoch 6/20 => Loss 0.385, Train_accy 89.07:  30%|███       | 6/20 [10:09<23:42, 101.59s/it]Task 0, Epoch 7/20 => Loss 0.360, Train_accy 89.41:  30%|███       | 6/20 [11:51<23:42, 101.59s/it]Task 0, Epoch 7/20 => Loss 0.360, Train_accy 89.41:  35%|███▌      | 7/20 [11:51<22:00, 101.56s/it]Task 0, Epoch 8/20 => Loss 0.358, Train_accy 89.50:  35%|███▌      | 7/20 [13:32<22:00, 101.56s/it]Task 0, Epoch 8/20 => Loss 0.358, Train_accy 89.50:  40%|████      | 8/20 [13:32<20:18, 101.57s/it]Task 0, Epoch 9/20 => Loss 0.347, Train_accy 89.89:  40%|████      | 8/20 [15:14<20:18, 101.57s/it]Task 0, Epoch 9/20 => Loss 0.347, Train_accy 89.89:  45%|████▌     | 9/20 [15:14<18:38, 101.72s/it]Task 0, Epoch 10/20 => Loss 0.336, Train_accy 90.06:  45%|████▌     | 9/20 [16:56<18:38, 101.72s/it]Task 0, Epoch 10/20 => Loss 0.336, Train_accy 90.06:  50%|█████     | 10/20 [16:56<16:55, 101.58s/it]Task 0, Epoch 11/20 => Loss 0.340, Train_accy 90.04:  50%|█████     | 10/20 [18:37<16:55, 101.58s/it]Task 0, Epoch 11/20 => Loss 0.340, Train_accy 90.04:  55%|█████▌    | 11/20 [18:37<15:13, 101.45s/it]Task 0, Epoch 12/20 => Loss 0.331, Train_accy 90.30:  55%|█████▌    | 11/20 [20:18<15:13, 101.45s/it]Task 0, Epoch 12/20 => Loss 0.331, Train_accy 90.30:  60%|██████    | 12/20 [20:18<13:31, 101.48s/it]Task 0, Epoch 13/20 => Loss 0.324, Train_accy 90.63:  60%|██████    | 12/20 [22:00<13:31, 101.48s/it]Task 0, Epoch 13/20 => Loss 0.324, Train_accy 90.63:  65%|██████▌   | 13/20 [22:00<11:50, 101.45s/it]Task 0, Epoch 14/20 => Loss 0.321, Train_accy 90.34:  65%|██████▌   | 13/20 [23:41<11:50, 101.45s/it]Task 0, Epoch 14/20 => Loss 0.321, Train_accy 90.34:  70%|███████   | 14/20 [23:41<10:08, 101.43s/it]Task 0, Epoch 15/20 => Loss 0.326, Train_accy 90.35:  70%|███████   | 14/20 [25:23<10:08, 101.43s/it]Task 0, Epoch 15/20 => Loss 0.326, Train_accy 90.35:  75%|███████▌  | 15/20 [25:23<08:27, 101.44s/it]Task 0, Epoch 16/20 => Loss 0.322, Train_accy 90.41:  75%|███████▌  | 15/20 [27:04<08:27, 101.44s/it]Task 0, Epoch 16/20 => Loss 0.322, Train_accy 90.41:  80%|████████  | 16/20 [27:04<06:46, 101.52s/it]Task 0, Epoch 17/20 => Loss 0.313, Train_accy 90.74:  80%|████████  | 16/20 [28:45<06:46, 101.52s/it]Task 0, Epoch 17/20 => Loss 0.313, Train_accy 90.74:  85%|████████▌ | 17/20 [28:45<05:04, 101.44s/it]Task 0, Epoch 18/20 => Loss 0.328, Train_accy 90.27:  85%|████████▌ | 17/20 [30:27<05:04, 101.44s/it]Task 0, Epoch 18/20 => Loss 0.328, Train_accy 90.27:  90%|█████████ | 18/20 [30:27<03:22, 101.36s/it]Task 0, Epoch 19/20 => Loss 0.318, Train_accy 90.44:  90%|█████████ | 18/20 [31:53<03:22, 101.36s/it]Task 0, Epoch 19/20 => Loss 0.318, Train_accy 90.44:  95%|█████████▌| 19/20 [31:53<01:36, 96.89s/it] Task 0, Epoch 20/20 => Loss 0.313, Train_accy 90.75:  95%|█████████▌| 19/20 [32:55<01:36, 96.89s/it]Task 0, Epoch 20/20 => Loss 0.313, Train_accy 90.75: 100%|██████████| 20/20 [32:55<00:00, 86.35s/it]Task 0, Epoch 20/20 => Loss 0.313, Train_accy 90.75: 100%|██████████| 20/20 [32:55<00:00, 98.77s/it]
2024-04-27 13:27:14,943 [ease.py] => Task 0, Epoch 20/20 => Loss 0.313, Train_accy 90.75
2024-04-27 13:27:54,068 [ease.py] => Task correct: 100.0
2024-04-27 13:27:54,069 [ease.py] => Task acc: 97.65
2024-04-27 13:27:54,125 [trainer.py] => No NME accuracy.
2024-04-27 13:27:54,126 [trainer.py] => CNN: {'total': 97.65, '00-19': 97.65, 'old': 0, 'new': 97.65}
2024-04-27 13:27:54,126 [trainer.py] => CNN top1 curve: [97.65]
2024-04-27 13:27:54,126 [trainer.py] => CNN top5 curve: [99.8]

Average Accuracy (CNN): 97.65
2024-04-27 13:27:54,126 [trainer.py] => Average Accuracy (CNN): 97.65 

2024-04-27 13:27:54,126 [trainer.py] => Train Time: 3951.08
2024-04-27 13:27:54,126 [trainer.py] => Test Time: 6.91 

2024-04-27 13:27:54,127 [trainer.py] => All params: 87019010
2024-04-27 13:27:54,127 [trainer.py] => Trainable params: 1189632
2024-04-27 13:27:54,150 [ease.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.526, Train_accy 73.61:   0%|          | 0/20 [01:28<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.526, Train_accy 73.61:   5%|▌         | 1/20 [01:28<28:02, 88.55s/it]Task 1, Epoch 2/20 => Loss 0.409, Train_accy 88.59:   5%|▌         | 1/20 [03:09<28:02, 88.55s/it]Task 1, Epoch 2/20 => Loss 0.409, Train_accy 88.59:  10%|█         | 2/20 [03:09<28:49, 96.11s/it]Task 1, Epoch 3/20 => Loss 0.353, Train_accy 89.73:  10%|█         | 2/20 [04:51<28:49, 96.11s/it]Task 1, Epoch 3/20 => Loss 0.353, Train_accy 89.73:  15%|█▌        | 3/20 [04:51<27:54, 98.51s/it]Task 1, Epoch 4/20 => Loss 0.320, Train_accy 90.60:  15%|█▌        | 3/20 [06:32<27:54, 98.51s/it]Task 1, Epoch 4/20 => Loss 0.320, Train_accy 90.60:  20%|██        | 4/20 [06:32<26:34, 99.63s/it]Task 1, Epoch 5/20 => Loss 0.320, Train_accy 90.62:  20%|██        | 4/20 [08:13<26:34, 99.63s/it]Task 1, Epoch 5/20 => Loss 0.320, Train_accy 90.62:  25%|██▌       | 5/20 [08:13<25:02, 100.19s/it]Task 1, Epoch 6/20 => Loss 0.312, Train_accy 90.62:  25%|██▌       | 5/20 [09:55<25:02, 100.19s/it]Task 1, Epoch 6/20 => Loss 0.312, Train_accy 90.62:  30%|███       | 6/20 [09:55<23:28, 100.58s/it]Task 1, Epoch 7/20 => Loss 0.302, Train_accy 91.22:  30%|███       | 6/20 [11:36<23:28, 100.58s/it]Task 1, Epoch 7/20 => Loss 0.302, Train_accy 91.22:  35%|███▌      | 7/20 [11:36<21:51, 100.88s/it]Task 1, Epoch 8/20 => Loss 0.276, Train_accy 91.61:  35%|███▌      | 7/20 [13:18<21:51, 100.88s/it]Task 1, Epoch 8/20 => Loss 0.276, Train_accy 91.61:  40%|████      | 8/20 [13:18<20:12, 101.07s/it]Task 1, Epoch 9/20 => Loss 0.283, Train_accy 91.20:  40%|████      | 8/20 [14:59<20:12, 101.07s/it]Task 1, Epoch 9/20 => Loss 0.283, Train_accy 91.20:  45%|████▌     | 9/20 [14:59<18:32, 101.18s/it]Task 1, Epoch 10/20 => Loss 0.281, Train_accy 91.25:  45%|████▌     | 9/20 [16:41<18:32, 101.18s/it]Task 1, Epoch 10/20 => Loss 0.281, Train_accy 91.25:  50%|█████     | 10/20 [16:41<16:53, 101.30s/it]Task 1, Epoch 11/20 => Loss 0.291, Train_accy 91.21:  50%|█████     | 10/20 [18:23<16:53, 101.30s/it]Task 1, Epoch 11/20 => Loss 0.291, Train_accy 91.21:  55%|█████▌    | 11/20 [18:23<15:13, 101.48s/it]Task 1, Epoch 12/20 => Loss 0.274, Train_accy 91.37:  55%|█████▌    | 11/20 [20:04<15:13, 101.48s/it]Task 1, Epoch 12/20 => Loss 0.274, Train_accy 91.37:  60%|██████    | 12/20 [20:04<13:32, 101.60s/it]Task 1, Epoch 13/20 => Loss 0.274, Train_accy 91.94:  60%|██████    | 12/20 [21:46<13:32, 101.60s/it]Task 1, Epoch 13/20 => Loss 0.274, Train_accy 91.94:  65%|██████▌   | 13/20 [21:46<11:51, 101.58s/it]Task 1, Epoch 14/20 => Loss 0.258, Train_accy 92.37:  65%|██████▌   | 13/20 [23:28<11:51, 101.58s/it]Task 1, Epoch 14/20 => Loss 0.258, Train_accy 92.37:  70%|███████   | 14/20 [23:28<10:09, 101.58s/it]Task 1, Epoch 15/20 => Loss 0.267, Train_accy 91.87:  70%|███████   | 14/20 [25:09<10:09, 101.58s/it]Task 1, Epoch 15/20 => Loss 0.267, Train_accy 91.87:  75%|███████▌  | 15/20 [25:09<08:27, 101.57s/it]Task 1, Epoch 16/20 => Loss 0.255, Train_accy 92.08:  75%|███████▌  | 15/20 [26:50<08:27, 101.57s/it]Task 1, Epoch 16/20 => Loss 0.255, Train_accy 92.08:  80%|████████  | 16/20 [26:50<06:46, 101.50s/it]Task 1, Epoch 17/20 => Loss 0.248, Train_accy 92.24:  80%|████████  | 16/20 [28:32<06:46, 101.50s/it]Task 1, Epoch 17/20 => Loss 0.248, Train_accy 92.24:  85%|████████▌ | 17/20 [28:32<05:04, 101.56s/it]Task 1, Epoch 18/20 => Loss 0.249, Train_accy 92.26:  85%|████████▌ | 17/20 [30:14<05:04, 101.56s/it]Task 1, Epoch 18/20 => Loss 0.249, Train_accy 92.26:  90%|█████████ | 18/20 [30:14<03:23, 101.58s/it]Task 1, Epoch 19/20 => Loss 0.250, Train_accy 92.38:  90%|█████████ | 18/20 [31:55<03:23, 101.58s/it]Task 1, Epoch 19/20 => Loss 0.250, Train_accy 92.38:  95%|█████████▌| 19/20 [31:55<01:41, 101.61s/it]Task 1, Epoch 20/20 => Loss 0.255, Train_accy 92.05:  95%|█████████▌| 19/20 [33:37<01:41, 101.61s/it]Task 1, Epoch 20/20 => Loss 0.255, Train_accy 92.05: 100%|██████████| 20/20 [33:37<00:00, 101.60s/it]Task 1, Epoch 20/20 => Loss 0.255, Train_accy 92.05: 100%|██████████| 20/20 [33:37<00:00, 100.87s/it]
2024-04-27 14:01:31,749 [ease.py] => Task 1, Epoch 20/20 => Loss 0.255, Train_accy 92.05
2024-04-27 14:03:54,309 [ease.py] => Task correct: 96.2
2024-04-27 14:03:54,310 [ease.py] => Task acc: 98.05
2024-04-27 14:03:54,394 [trainer.py] => No NME accuracy.
2024-04-27 14:03:54,394 [trainer.py] => CNN: {'total': 94.88, '00-19': 93.0, '20-39': 96.75, 'old': 93.0, 'new': 96.75}
2024-04-27 14:03:54,394 [trainer.py] => CNN top1 curve: [97.65, 94.88]
2024-04-27 14:03:54,394 [trainer.py] => CNN top5 curve: [99.8, 99.68]

Average Accuracy (CNN): 96.26
2024-04-27 14:03:54,394 [trainer.py] => Average Accuracy (CNN): 96.26 

2024-04-27 14:03:54,394 [trainer.py] => Train Time: 7986.0599999999995
2024-04-27 14:03:54,394 [trainer.py] => Test Time: 47.739999999999995 

2024-04-27 14:03:54,395 [trainer.py] => All params: 87065090
2024-04-27 14:03:54,396 [trainer.py] => Trainable params: 1189632
2024-04-27 14:03:54,403 [ease.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.621, Train_accy 70.38:   0%|          | 0/20 [01:01<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.621, Train_accy 70.38:   5%|▌         | 1/20 [01:01<19:33, 61.77s/it]Task 2, Epoch 2/20 => Loss 0.458, Train_accy 87.62:   5%|▌         | 1/20 [02:03<19:33, 61.77s/it]Task 2, Epoch 2/20 => Loss 0.458, Train_accy 87.62:  10%|█         | 2/20 [02:03<18:36, 62.03s/it]Task 2, Epoch 3/20 => Loss 0.374, Train_accy 89.10:  10%|█         | 2/20 [03:06<18:36, 62.03s/it]Task 2, Epoch 3/20 => Loss 0.374, Train_accy 89.10:  15%|█▌        | 3/20 [03:06<17:34, 62.05s/it]Task 2, Epoch 4/20 => Loss 0.357, Train_accy 89.17:  15%|█▌        | 3/20 [04:07<17:34, 62.05s/it]Task 2, Epoch 4/20 => Loss 0.357, Train_accy 89.17:  20%|██        | 4/20 [04:07<16:31, 61.98s/it]Task 2, Epoch 5/20 => Loss 0.337, Train_accy 89.99:  20%|██        | 4/20 [05:26<16:31, 61.98s/it]Task 2, Epoch 5/20 => Loss 0.337, Train_accy 89.99:  25%|██▌       | 5/20 [05:26<16:59, 67.94s/it]Task 2, Epoch 6/20 => Loss 0.329, Train_accy 90.08:  25%|██▌       | 5/20 [07:03<16:59, 67.94s/it]Task 2, Epoch 6/20 => Loss 0.329, Train_accy 90.08:  30%|███       | 6/20 [07:03<18:10, 77.92s/it]Task 2, Epoch 7/20 => Loss 0.307, Train_accy 90.73:  30%|███       | 6/20 [08:45<18:10, 77.92s/it]Task 2, Epoch 7/20 => Loss 0.307, Train_accy 90.73:  35%|███▌      | 7/20 [08:45<18:33, 85.66s/it]Task 2, Epoch 8/20 => Loss 0.324, Train_accy 89.85:  35%|███▌      | 7/20 [10:27<18:33, 85.66s/it]Task 2, Epoch 8/20 => Loss 0.324, Train_accy 89.85:  40%|████      | 8/20 [10:27<18:09, 90.78s/it]Task 2, Epoch 9/20 => Loss 0.308, Train_accy 90.84:  40%|████      | 8/20 [12:08<18:09, 90.78s/it]Task 2, Epoch 9/20 => Loss 0.308, Train_accy 90.84:  45%|████▌     | 9/20 [12:08<17:16, 94.19s/it]Task 2, Epoch 10/20 => Loss 0.325, Train_accy 90.37:  45%|████▌     | 9/20 [13:50<17:16, 94.19s/it]Task 2, Epoch 10/20 => Loss 0.325, Train_accy 90.37:  50%|█████     | 10/20 [13:50<16:05, 96.55s/it]Task 2, Epoch 11/20 => Loss 0.310, Train_accy 90.61:  50%|█████     | 10/20 [15:32<16:05, 96.55s/it]Task 2, Epoch 11/20 => Loss 0.310, Train_accy 90.61:  55%|█████▌    | 11/20 [15:32<14:43, 98.12s/it]Task 2, Epoch 12/20 => Loss 0.307, Train_accy 90.58:  55%|█████▌    | 11/20 [17:13<14:43, 98.12s/it]Task 2, Epoch 12/20 => Loss 0.307, Train_accy 90.58:  60%|██████    | 12/20 [17:13<13:13, 99.22s/it]Task 2, Epoch 13/20 => Loss 0.306, Train_accy 90.83:  60%|██████    | 12/20 [18:55<13:13, 99.22s/it]Task 2, Epoch 13/20 => Loss 0.306, Train_accy 90.83:  65%|██████▌   | 13/20 [18:55<11:39, 99.99s/it]Task 2, Epoch 14/20 => Loss 0.303, Train_accy 90.70:  65%|██████▌   | 13/20 [20:37<11:39, 99.99s/it]Task 2, Epoch 14/20 => Loss 0.303, Train_accy 90.70:  70%|███████   | 14/20 [20:37<10:02, 100.47s/it]Task 2, Epoch 15/20 => Loss 0.288, Train_accy 91.22:  70%|███████   | 14/20 [22:18<10:02, 100.47s/it]Task 2, Epoch 15/20 => Loss 0.288, Train_accy 91.22:  75%|███████▌  | 15/20 [22:18<08:24, 100.81s/it]Task 2, Epoch 16/20 => Loss 0.291, Train_accy 91.17:  75%|███████▌  | 15/20 [24:00<08:24, 100.81s/it]Task 2, Epoch 16/20 => Loss 0.291, Train_accy 91.17:  80%|████████  | 16/20 [24:00<06:44, 101.06s/it]Task 2, Epoch 17/20 => Loss 0.280, Train_accy 91.41:  80%|████████  | 16/20 [25:42<06:44, 101.06s/it]Task 2, Epoch 17/20 => Loss 0.280, Train_accy 91.41:  85%|████████▌ | 17/20 [25:42<05:03, 101.23s/it]Task 2, Epoch 18/20 => Loss 0.284, Train_accy 91.56:  85%|████████▌ | 17/20 [27:23<05:03, 101.23s/it]Task 2, Epoch 18/20 => Loss 0.284, Train_accy 91.56:  90%|█████████ | 18/20 [27:23<03:22, 101.35s/it]Task 2, Epoch 19/20 => Loss 0.286, Train_accy 91.18:  90%|█████████ | 18/20 [29:05<03:22, 101.35s/it]Task 2, Epoch 19/20 => Loss 0.286, Train_accy 91.18:  95%|█████████▌| 19/20 [29:05<01:41, 101.43s/it]Task 2, Epoch 20/20 => Loss 0.283, Train_accy 91.26:  95%|█████████▌| 19/20 [30:47<01:41, 101.43s/it]Task 2, Epoch 20/20 => Loss 0.283, Train_accy 91.26: 100%|██████████| 20/20 [30:47<00:00, 101.47s/it]Task 2, Epoch 20/20 => Loss 0.283, Train_accy 91.26: 100%|██████████| 20/20 [30:47<00:00, 92.35s/it] 
2024-04-27 14:34:41,485 [ease.py] => Task 2, Epoch 20/20 => Loss 0.283, Train_accy 91.26
2024-04-27 14:38:47,207 [ease.py] => Task correct: 94.13333333333334
2024-04-27 14:38:47,208 [ease.py] => Task acc: 97.7
2024-04-27 14:38:47,270 [trainer.py] => No NME accuracy.
2024-04-27 14:38:47,270 [trainer.py] => CNN: {'total': 92.7, '00-19': 91.15, '20-39': 93.6, '40-59': 93.35, 'old': 92.38, 'new': 93.35}
2024-04-27 14:38:47,270 [trainer.py] => CNN top1 curve: [97.65, 94.88, 92.7]
2024-04-27 14:38:47,270 [trainer.py] => CNN top5 curve: [99.8, 99.68, 99.47]

Average Accuracy (CNN): 95.08
2024-04-27 14:38:47,270 [trainer.py] => Average Accuracy (CNN): 95.08 

2024-04-27 14:38:47,270 [trainer.py] => Train Time: 11680.09
2024-04-27 14:38:47,270 [trainer.py] => Test Time: 137.82 

2024-04-27 14:38:47,271 [trainer.py] => All params: 87141890
2024-04-27 14:38:47,272 [trainer.py] => Trainable params: 1189632
2024-04-27 14:38:47,279 [ease.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.590, Train_accy 71.76:   0%|          | 0/20 [01:41<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.590, Train_accy 71.76:   5%|▌         | 1/20 [01:41<32:10, 101.62s/it]Task 3, Epoch 2/20 => Loss 0.451, Train_accy 87.46:   5%|▌         | 1/20 [03:23<32:10, 101.62s/it]Task 3, Epoch 2/20 => Loss 0.451, Train_accy 87.46:  10%|█         | 2/20 [03:23<30:28, 101.57s/it]Task 3, Epoch 3/20 => Loss 0.404, Train_accy 88.25:  10%|█         | 2/20 [05:04<30:28, 101.57s/it]Task 3, Epoch 3/20 => Loss 0.404, Train_accy 88.25:  15%|█▌        | 3/20 [05:04<28:45, 101.52s/it]Task 3, Epoch 4/20 => Loss 0.364, Train_accy 89.00:  15%|█▌        | 3/20 [06:32<28:45, 101.52s/it]Task 3, Epoch 4/20 => Loss 0.364, Train_accy 89.00:  20%|██        | 4/20 [06:32<25:36, 96.00s/it] Task 3, Epoch 5/20 => Loss 0.351, Train_accy 89.68:  20%|██        | 4/20 [07:34<25:36, 96.00s/it]Task 3, Epoch 5/20 => Loss 0.351, Train_accy 89.68:  25%|██▌       | 5/20 [07:34<20:58, 83.89s/it]Task 3, Epoch 6/20 => Loss 0.338, Train_accy 89.76:  25%|██▌       | 5/20 [08:36<20:58, 83.89s/it]Task 3, Epoch 6/20 => Loss 0.338, Train_accy 89.76:  30%|███       | 6/20 [08:36<17:51, 76.51s/it]Task 3, Epoch 7/20 => Loss 0.327, Train_accy 90.13:  30%|███       | 6/20 [09:39<17:51, 76.51s/it]Task 3, Epoch 7/20 => Loss 0.327, Train_accy 90.13:  35%|███▌      | 7/20 [09:39<15:34, 71.86s/it]Task 3, Epoch 8/20 => Loss 0.318, Train_accy 90.30:  35%|███▌      | 7/20 [10:41<15:34, 71.86s/it]Task 3, Epoch 8/20 => Loss 0.318, Train_accy 90.30:  40%|████      | 8/20 [10:41<13:45, 68.75s/it]Task 3, Epoch 9/20 => Loss 0.299, Train_accy 90.73:  40%|████      | 8/20 [11:42<13:45, 68.75s/it]Task 3, Epoch 9/20 => Loss 0.299, Train_accy 90.73:  45%|████▌     | 9/20 [11:42<12:12, 66.59s/it]Task 3, Epoch 10/20 => Loss 0.309, Train_accy 90.70:  45%|████▌     | 9/20 [12:45<12:12, 66.59s/it]Task 3, Epoch 10/20 => Loss 0.309, Train_accy 90.70:  50%|█████     | 10/20 [12:45<10:51, 65.18s/it]Task 3, Epoch 11/20 => Loss 0.312, Train_accy 90.40:  50%|█████     | 10/20 [14:08<10:51, 65.18s/it]Task 3, Epoch 11/20 => Loss 0.312, Train_accy 90.40:  55%|█████▌    | 11/20 [14:08<10:36, 70.74s/it]Task 3, Epoch 12/20 => Loss 0.292, Train_accy 91.09:  55%|█████▌    | 11/20 [15:42<10:36, 70.74s/it]Task 3, Epoch 12/20 => Loss 0.292, Train_accy 91.09:  60%|██████    | 12/20 [15:42<10:22, 77.77s/it]Task 3, Epoch 13/20 => Loss 0.307, Train_accy 90.87:  60%|██████    | 12/20 [17:23<10:22, 77.77s/it]Task 3, Epoch 13/20 => Loss 0.307, Train_accy 90.87:  65%|██████▌   | 13/20 [17:23<09:54, 84.96s/it]Task 3, Epoch 14/20 => Loss 0.295, Train_accy 91.08:  65%|██████▌   | 13/20 [19:05<09:54, 84.96s/it]Task 3, Epoch 14/20 => Loss 0.295, Train_accy 91.08:  70%|███████   | 14/20 [19:05<09:00, 90.01s/it]Task 3, Epoch 15/20 => Loss 0.287, Train_accy 91.04:  70%|███████   | 14/20 [20:47<09:00, 90.01s/it]Task 3, Epoch 15/20 => Loss 0.287, Train_accy 91.04:  75%|███████▌  | 15/20 [20:47<07:47, 93.55s/it]Task 3, Epoch 16/20 => Loss 0.291, Train_accy 91.06:  75%|███████▌  | 15/20 [22:29<07:47, 93.55s/it]Task 3, Epoch 16/20 => Loss 0.291, Train_accy 91.06:  80%|████████  | 16/20 [22:29<06:24, 96.06s/it]Task 3, Epoch 17/20 => Loss 0.276, Train_accy 91.40:  80%|████████  | 16/20 [24:10<06:24, 96.06s/it]Task 3, Epoch 17/20 => Loss 0.276, Train_accy 91.40:  85%|████████▌ | 17/20 [24:10<04:53, 97.79s/it]Task 3, Epoch 18/20 => Loss 0.272, Train_accy 91.68:  85%|████████▌ | 17/20 [25:52<04:53, 97.79s/it]Task 3, Epoch 18/20 => Loss 0.272, Train_accy 91.68:  90%|█████████ | 18/20 [25:52<03:18, 99.01s/it]Task 3, Epoch 19/20 => Loss 0.292, Train_accy 91.12:  90%|█████████ | 18/20 [27:34<03:18, 99.01s/it]Task 3, Epoch 19/20 => Loss 0.292, Train_accy 91.12:  95%|█████████▌| 19/20 [27:34<01:39, 99.79s/it]Task 3, Epoch 20/20 => Loss 0.272, Train_accy 91.79:  95%|█████████▌| 19/20 [29:15<01:39, 99.79s/it]Task 3, Epoch 20/20 => Loss 0.272, Train_accy 91.79: 100%|██████████| 20/20 [29:15<00:00, 100.28s/it]Task 3, Epoch 20/20 => Loss 0.272, Train_accy 91.79: 100%|██████████| 20/20 [29:15<00:00, 87.79s/it] 
2024-04-27 15:08:03,054 [ease.py] => Task 3, Epoch 20/20 => Loss 0.272, Train_accy 91.79
2024-04-27 15:14:11,219 [ease.py] => Task correct: 92.0125
2024-04-27 15:14:11,219 [ease.py] => Task acc: 97.475
2024-04-27 15:14:11,292 [trainer.py] => No NME accuracy.
2024-04-27 15:14:11,292 [trainer.py] => CNN: {'total': 90.56, '00-19': 89.7, '20-39': 92.9, '40-59': 90.45, '60-79': 89.2, 'old': 91.02, 'new': 89.2}
2024-04-27 15:14:11,292 [trainer.py] => CNN top1 curve: [97.65, 94.88, 92.7, 90.56]
2024-04-27 15:14:11,292 [trainer.py] => CNN top5 curve: [99.8, 99.68, 99.47, 99.34]

Average Accuracy (CNN): 93.95
2024-04-27 15:14:11,292 [trainer.py] => Average Accuracy (CNN): 93.95 

2024-04-27 15:14:11,292 [trainer.py] => Train Time: 15191.5
2024-04-27 15:14:11,292 [trainer.py] => Test Time: 296.77 

2024-04-27 15:14:11,293 [trainer.py] => All params: 87249410
2024-04-27 15:14:11,294 [trainer.py] => Trainable params: 1189632
2024-04-27 15:14:11,303 [ease.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.610, Train_accy 72.47:   0%|          | 0/20 [01:41<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.610, Train_accy 72.47:   5%|▌         | 1/20 [01:41<32:11, 101.65s/it]Task 4, Epoch 2/20 => Loss 0.453, Train_accy 87.74:   5%|▌         | 1/20 [03:23<32:11, 101.65s/it]Task 4, Epoch 2/20 => Loss 0.453, Train_accy 87.74:  10%|█         | 2/20 [03:23<30:28, 101.59s/it]Task 4, Epoch 3/20 => Loss 0.398, Train_accy 88.61:  10%|█         | 2/20 [05:04<30:28, 101.59s/it]Task 4, Epoch 3/20 => Loss 0.398, Train_accy 88.61:  15%|█▌        | 3/20 [05:04<28:46, 101.53s/it]Task 4, Epoch 4/20 => Loss 0.362, Train_accy 89.56:  15%|█▌        | 3/20 [06:46<28:46, 101.53s/it]Task 4, Epoch 4/20 => Loss 0.362, Train_accy 89.56:  20%|██        | 4/20 [06:46<27:05, 101.57s/it]Task 4, Epoch 5/20 => Loss 0.343, Train_accy 90.24:  20%|██        | 4/20 [08:27<27:05, 101.57s/it]Task 4, Epoch 5/20 => Loss 0.343, Train_accy 90.24:  25%|██▌       | 5/20 [08:27<25:24, 101.60s/it]Task 4, Epoch 6/20 => Loss 0.331, Train_accy 90.39:  25%|██▌       | 5/20 [10:09<25:24, 101.60s/it]Task 4, Epoch 6/20 => Loss 0.331, Train_accy 90.39:  30%|███       | 6/20 [10:09<23:43, 101.65s/it]Task 4, Epoch 7/20 => Loss 0.328, Train_accy 90.56:  30%|███       | 6/20 [11:51<23:43, 101.65s/it]Task 4, Epoch 7/20 => Loss 0.328, Train_accy 90.56:  35%|███▌      | 7/20 [11:51<22:01, 101.68s/it]Task 4, Epoch 8/20 => Loss 0.316, Train_accy 90.64:  35%|███▌      | 7/20 [13:33<22:01, 101.68s/it]Task 4, Epoch 8/20 => Loss 0.316, Train_accy 90.64:  40%|████      | 8/20 [13:33<20:19, 101.66s/it]Task 4, Epoch 9/20 => Loss 0.315, Train_accy 90.67:  40%|████      | 8/20 [15:04<20:19, 101.66s/it]Task 4, Epoch 9/20 => Loss 0.315, Train_accy 90.67:  45%|████▌     | 9/20 [15:04<18:02, 98.45s/it] Task 4, Epoch 10/20 => Loss 0.318, Train_accy 90.67:  45%|████▌     | 9/20 [16:06<18:02, 98.45s/it]Task 4, Epoch 10/20 => Loss 0.318, Train_accy 90.67:  50%|█████     | 10/20 [16:06<14:32, 87.24s/it]Task 4, Epoch 11/20 => Loss 0.292, Train_accy 91.69:  50%|█████     | 10/20 [17:08<14:32, 87.24s/it]Task 4, Epoch 11/20 => Loss 0.292, Train_accy 91.69:  55%|█████▌    | 11/20 [17:08<11:56, 79.57s/it]Task 4, Epoch 12/20 => Loss 0.289, Train_accy 91.36:  55%|█████▌    | 11/20 [18:10<11:56, 79.57s/it]Task 4, Epoch 12/20 => Loss 0.289, Train_accy 91.36:  60%|██████    | 12/20 [18:10<09:53, 74.23s/it]Task 4, Epoch 13/20 => Loss 0.290, Train_accy 91.23:  60%|██████    | 12/20 [19:12<09:53, 74.23s/it]Task 4, Epoch 13/20 => Loss 0.290, Train_accy 91.23:  65%|██████▌   | 13/20 [19:12<08:13, 70.56s/it]Task 4, Epoch 14/20 => Loss 0.272, Train_accy 91.96:  65%|██████▌   | 13/20 [20:15<08:13, 70.56s/it]Task 4, Epoch 14/20 => Loss 0.272, Train_accy 91.96:  70%|███████   | 14/20 [20:15<06:48, 68.03s/it]Task 4, Epoch 15/20 => Loss 0.284, Train_accy 91.51:  70%|███████   | 14/20 [21:17<06:48, 68.03s/it]Task 4, Epoch 15/20 => Loss 0.284, Train_accy 91.51:  75%|███████▌  | 15/20 [21:17<05:31, 66.26s/it]Task 4, Epoch 16/20 => Loss 0.283, Train_accy 91.41:  75%|███████▌  | 15/20 [22:19<05:31, 66.26s/it]Task 4, Epoch 16/20 => Loss 0.283, Train_accy 91.41:  80%|████████  | 16/20 [22:19<04:20, 65.11s/it]Task 4, Epoch 17/20 => Loss 0.276, Train_accy 91.78:  80%|████████  | 16/20 [23:21<04:20, 65.11s/it]Task 4, Epoch 17/20 => Loss 0.276, Train_accy 91.78:  85%|████████▌ | 17/20 [23:21<03:12, 64.23s/it]Task 4, Epoch 18/20 => Loss 0.270, Train_accy 91.91:  85%|████████▌ | 17/20 [24:39<03:12, 64.23s/it]Task 4, Epoch 18/20 => Loss 0.270, Train_accy 91.91:  90%|█████████ | 18/20 [24:39<02:16, 68.24s/it]Task 4, Epoch 19/20 => Loss 0.272, Train_accy 91.75:  90%|█████████ | 18/20 [26:11<02:16, 68.24s/it]Task 4, Epoch 19/20 => Loss 0.272, Train_accy 91.75:  95%|█████████▌| 19/20 [26:11<01:15, 75.46s/it]Task 4, Epoch 20/20 => Loss 0.281, Train_accy 91.61:  95%|█████████▌| 19/20 [27:49<01:15, 75.46s/it]Task 4, Epoch 20/20 => Loss 0.281, Train_accy 91.61: 100%|██████████| 20/20 [27:49<00:00, 82.13s/it]Task 4, Epoch 20/20 => Loss 0.281, Train_accy 91.61: 100%|██████████| 20/20 [27:49<00:00, 83.47s/it]
2024-04-27 15:42:00,761 [ease.py] => Task 4, Epoch 20/20 => Loss 0.281, Train_accy 91.61
2024-04-27 15:50:29,395 [ease.py] => Task correct: 90.71
2024-04-27 15:50:29,396 [ease.py] => Task acc: 97.47
2024-04-27 15:50:29,492 [trainer.py] => No NME accuracy.
2024-04-27 15:50:29,493 [trainer.py] => CNN: {'total': 89.42, '00-19': 87.65, '20-39': 92.1, '40-59': 88.05, '60-79': 87.7, '80-99': 91.6, 'old': 88.88, 'new': 91.6}
2024-04-27 15:50:29,493 [trainer.py] => CNN top1 curve: [97.65, 94.88, 92.7, 90.56, 89.42]
2024-04-27 15:50:29,493 [trainer.py] => CNN top5 curve: [99.8, 99.68, 99.47, 99.34, 99.12]

Average Accuracy (CNN): 93.04
2024-04-27 15:50:29,493 [trainer.py] => Average Accuracy (CNN): 93.04 

2024-04-27 15:50:29,493 [trainer.py] => Train Time: 18530.239999999998
2024-04-27 15:50:29,493 [trainer.py] => Test Time: 543.92 

Accuracy Matrix (CNN):
[[97.65 93.   91.15 89.7  87.65]
 [ 0.   96.75 93.6  92.9  92.1 ]
 [ 0.    0.   93.35 90.45 88.05]
 [ 0.    0.    0.   89.2  87.7 ]
 [ 0.    0.    0.    0.   91.6 ]]
2024-04-27 15:50:29,494 [trainer.py] => Forgetting (CNN): 5.362500000000001

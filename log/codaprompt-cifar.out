nohup: 忽略输入
2024-09-03 15:31:50,419 [trainer.py] => config: ./exps/coda_prompt_cifar_B0_Inc5.json
2024-09-03 15:31:50,419 [trainer.py] => prefix:  
2024-09-03 15:31:50,419 [trainer.py] => dataset: cifar224
2024-09-03 15:31:50,419 [trainer.py] => memory_size: 0
2024-09-03 15:31:50,419 [trainer.py] => memory_per_class: 0
2024-09-03 15:31:50,419 [trainer.py] => fixed_memory: False
2024-09-03 15:31:50,419 [trainer.py] => shuffle: True
2024-09-03 15:31:50,420 [trainer.py] => init_cls: 20
2024-09-03 15:31:50,420 [trainer.py] => increment: 20
2024-09-03 15:31:50,420 [trainer.py] => model_name: coda_prompt
2024-09-03 15:31:50,420 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-03 15:31:50,420 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-03 15:31:50,420 [trainer.py] => seed: 1993
2024-09-03 15:31:50,420 [trainer.py] => tuned_epoch: 20
2024-09-03 15:31:50,420 [trainer.py] => init_lr: 0.001
2024-09-03 15:31:50,420 [trainer.py] => batch_size: 48
2024-09-03 15:31:50,420 [trainer.py] => weight_decay: 0
2024-09-03 15:31:50,420 [trainer.py] => min_lr: 1e-05
2024-09-03 15:31:50,420 [trainer.py] => optimizer: adam
2024-09-03 15:31:50,420 [trainer.py] => scheduler: cosine
2024-09-03 15:31:50,420 [trainer.py] => reinit_optimizer: True
2024-09-03 15:31:50,420 [trainer.py] => pretrained: True
2024-09-03 15:31:50,420 [trainer.py] => drop: 0.0
2024-09-03 15:31:50,420 [trainer.py] => drop_path: 0.0
2024-09-03 15:31:50,420 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-03 15:31:51,597 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-03 15:31:57,906 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-03 15:31:57,907 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-03 15:31:57,907 [trainer.py] => All params: 89715556
2024-09-03 15:31:57,907 [trainer.py] => Trainable params: 89715556
2024-09-03 15:31:57,908 [coda_prompt.py] => Learning on 0-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.708, Train_accy 80.14:   0%|          | 0/20 [01:47<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.708, Train_accy 80.14:   5%|▌         | 1/20 [01:47<34:11, 107.96s/it]
Task 0, Epoch 2/20 => Loss 0.376, Train_accy 88.28:   5%|▌         | 1/20 [03:34<34:11, 107.96s/it]
Task 0, Epoch 2/20 => Loss 0.376, Train_accy 88.28:  10%|█         | 2/20 [03:34<32:09, 107.20s/it]
Task 0, Epoch 3/20 => Loss 0.341, Train_accy 89.79:  10%|█         | 2/20 [05:21<32:09, 107.20s/it]
Task 0, Epoch 3/20 => Loss 0.341, Train_accy 89.79:  15%|█▌        | 3/20 [05:21<30:23, 107.27s/it]
Task 0, Epoch 4/20 => Loss 0.306, Train_accy 90.77:  15%|█▌        | 3/20 [07:09<30:23, 107.27s/it]
Task 0, Epoch 4/20 => Loss 0.306, Train_accy 90.77:  20%|██        | 4/20 [07:09<28:37, 107.37s/it]
Task 0, Epoch 5/20 => Loss 0.305, Train_accy 90.73, Test_accy 96.95:  20%|██        | 4/20 [09:08<28:37, 107.37s/it]
Task 0, Epoch 5/20 => Loss 0.305, Train_accy 90.73, Test_accy 96.95:  25%|██▌       | 5/20 [09:08<27:51, 111.44s/it]
Task 0, Epoch 6/20 => Loss 0.286, Train_accy 91.23:  25%|██▌       | 5/20 [10:55<27:51, 111.44s/it]                 
Task 0, Epoch 6/20 => Loss 0.286, Train_accy 91.23:  30%|███       | 6/20 [10:55<25:42, 110.17s/it]
Task 0, Epoch 7/20 => Loss 0.277, Train_accy 91.70:  30%|███       | 6/20 [12:43<25:42, 110.17s/it]
Task 0, Epoch 7/20 => Loss 0.277, Train_accy 91.70:  35%|███▌      | 7/20 [12:43<23:43, 109.47s/it]
Task 0, Epoch 8/20 => Loss 0.271, Train_accy 91.68:  35%|███▌      | 7/20 [14:31<23:43, 109.47s/it]
Task 0, Epoch 8/20 => Loss 0.271, Train_accy 91.68:  40%|████      | 8/20 [14:31<21:45, 108.83s/it]
Task 0, Epoch 9/20 => Loss 0.275, Train_accy 91.60:  40%|████      | 8/20 [16:18<21:45, 108.83s/it]
Task 0, Epoch 9/20 => Loss 0.275, Train_accy 91.60:  45%|████▌     | 9/20 [16:18<19:52, 108.38s/it]
Task 0, Epoch 10/20 => Loss 0.266, Train_accy 91.96, Test_accy 97.45:  45%|████▌     | 9/20 [18:17<19:52, 108.38s/it]
Task 0, Epoch 10/20 => Loss 0.266, Train_accy 91.96, Test_accy 97.45:  50%|█████     | 10/20 [18:17<18:35, 111.54s/it]
Task 0, Epoch 11/20 => Loss 0.256, Train_accy 92.24:  50%|█████     | 10/20 [20:05<18:35, 111.54s/it]                 
Task 0, Epoch 11/20 => Loss 0.256, Train_accy 92.24:  55%|█████▌    | 11/20 [20:05<16:33, 110.41s/it]
Task 0, Epoch 12/20 => Loss 0.241, Train_accy 92.58:  55%|█████▌    | 11/20 [21:52<16:33, 110.41s/it]
Task 0, Epoch 12/20 => Loss 0.241, Train_accy 92.58:  60%|██████    | 12/20 [21:52<14:35, 109.48s/it]
Task 0, Epoch 13/20 => Loss 0.241, Train_accy 92.60:  60%|██████    | 12/20 [23:39<14:35, 109.48s/it]
Task 0, Epoch 13/20 => Loss 0.241, Train_accy 92.60:  65%|██████▌   | 13/20 [23:39<12:41, 108.81s/it]
Task 0, Epoch 14/20 => Loss 0.240, Train_accy 93.05:  65%|██████▌   | 13/20 [25:27<12:41, 108.81s/it]
Task 0, Epoch 14/20 => Loss 0.240, Train_accy 93.05:  70%|███████   | 14/20 [25:27<10:50, 108.42s/it]
Task 0, Epoch 15/20 => Loss 0.246, Train_accy 92.48, Test_accy 97.90:  70%|███████   | 14/20 [27:25<10:50, 108.42s/it]
Task 0, Epoch 15/20 => Loss 0.246, Train_accy 92.48, Test_accy 97.90:  75%|███████▌  | 15/20 [27:25<09:17, 111.47s/it]
Task 0, Epoch 16/20 => Loss 0.242, Train_accy 92.74:  75%|███████▌  | 15/20 [29:13<09:17, 111.47s/it]                 
Task 0, Epoch 16/20 => Loss 0.242, Train_accy 92.74:  80%|████████  | 16/20 [29:13<07:21, 110.30s/it]
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 92.83:  80%|████████  | 16/20 [31:01<07:21, 110.30s/it]
Task 0, Epoch 17/20 => Loss 0.229, Train_accy 92.83:  85%|████████▌ | 17/20 [31:01<05:28, 109.57s/it]
Task 0, Epoch 18/20 => Loss 0.207, Train_accy 93.22:  85%|████████▌ | 17/20 [32:49<05:28, 109.57s/it]
Task 0, Epoch 18/20 => Loss 0.207, Train_accy 93.22:  90%|█████████ | 18/20 [32:49<03:38, 109.03s/it]
Task 0, Epoch 19/20 => Loss 0.219, Train_accy 93.21:  90%|█████████ | 18/20 [34:36<03:38, 109.03s/it]
Task 0, Epoch 19/20 => Loss 0.219, Train_accy 93.21:  95%|█████████▌| 19/20 [34:36<01:48, 108.65s/it]
Task 0, Epoch 20/20 => Loss 0.220, Train_accy 93.45, Test_accy 97.65:  95%|█████████▌| 19/20 [36:35<01:48, 108.65s/it]
Task 0, Epoch 20/20 => Loss 0.220, Train_accy 93.45, Test_accy 97.65: 100%|██████████| 20/20 [36:35<00:00, 111.68s/it]
Task 0, Epoch 20/20 => Loss 0.220, Train_accy 93.45, Test_accy 97.65: 100%|██████████| 20/20 [36:35<00:00, 109.78s/it]
2024-09-03 16:08:34,526 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.220, Train_accy 93.45, Test_accy 97.65
2024-09-03 16:08:45,855 [trainer.py] => No NME accuracy.
2024-09-03 16:08:45,856 [trainer.py] => CNN: {'total': 97.65, '00-19': 97.65, 'old': 0, 'new': 97.65}
2024-09-03 16:08:45,856 [trainer.py] => CNN top1 curve: [97.65]
2024-09-03 16:08:45,856 [trainer.py] => CNN top5 curve: [99.55]

Average Accuracy (CNN): 97.65
2024-09-03 16:08:45,857 [trainer.py] => Average Accuracy (CNN): 97.65 

2024-09-03 16:08:45,858 [trainer.py] => All params: 89715556
2024-09-03 16:08:45,859 [trainer.py] => Trainable params: 89715556
2024-09-03 16:08:47,016 [coda_prompt.py] => Learning on 20-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.476, Train_accy 85.86:   0%|          | 0/20 [01:47<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.476, Train_accy 85.86:   5%|▌         | 1/20 [01:47<34:10, 107.92s/it]
Task 1, Epoch 2/20 => Loss 0.249, Train_accy 92.13:   5%|▌         | 1/20 [03:35<34:10, 107.92s/it]
Task 1, Epoch 2/20 => Loss 0.249, Train_accy 92.13:  10%|█         | 2/20 [03:35<32:22, 107.92s/it]
Task 1, Epoch 3/20 => Loss 0.237, Train_accy 92.30:  10%|█         | 2/20 [05:23<32:22, 107.92s/it]
Task 1, Epoch 3/20 => Loss 0.237, Train_accy 92.30:  15%|█▌        | 3/20 [05:23<30:33, 107.83s/it]
Task 1, Epoch 4/20 => Loss 0.228, Train_accy 92.68:  15%|█▌        | 3/20 [07:11<30:33, 107.83s/it]
Task 1, Epoch 4/20 => Loss 0.228, Train_accy 92.68:  20%|██        | 4/20 [07:11<28:44, 107.77s/it]
Task 1, Epoch 5/20 => Loss 0.216, Train_accy 92.99, Test_accy 93.42:  20%|██        | 4/20 [09:21<28:44, 107.77s/it]
Task 1, Epoch 5/20 => Loss 0.216, Train_accy 92.99, Test_accy 93.42:  25%|██▌       | 5/20 [09:21<28:57, 115.84s/it]
Task 1, Epoch 6/20 => Loss 0.218, Train_accy 92.99:  25%|██▌       | 5/20 [11:09<28:57, 115.84s/it]                 
Task 1, Epoch 6/20 => Loss 0.218, Train_accy 92.99:  30%|███       | 6/20 [11:09<26:23, 113.10s/it]
Task 1, Epoch 7/20 => Loss 0.199, Train_accy 93.70:  30%|███       | 6/20 [12:57<26:23, 113.10s/it]
Task 1, Epoch 7/20 => Loss 0.199, Train_accy 93.70:  35%|███▌      | 7/20 [12:57<24:08, 111.40s/it]
Task 1, Epoch 8/20 => Loss 0.202, Train_accy 93.57:  35%|███▌      | 7/20 [14:45<24:08, 111.40s/it]
Task 1, Epoch 8/20 => Loss 0.202, Train_accy 93.57:  40%|████      | 8/20 [14:45<22:04, 110.34s/it]
Task 1, Epoch 9/20 => Loss 0.199, Train_accy 93.67:  40%|████      | 8/20 [16:33<22:04, 110.34s/it]
Task 1, Epoch 9/20 => Loss 0.199, Train_accy 93.67:  45%|████▌     | 9/20 [16:33<20:06, 109.66s/it]
Task 1, Epoch 10/20 => Loss 0.214, Train_accy 93.20, Test_accy 94.75:  45%|████▌     | 9/20 [18:43<20:06, 109.66s/it]
Task 1, Epoch 10/20 => Loss 0.214, Train_accy 93.20, Test_accy 94.75:  50%|█████     | 10/20 [18:43<19:19, 115.91s/it]
Task 1, Epoch 11/20 => Loss 0.193, Train_accy 93.86:  50%|█████     | 10/20 [20:31<19:19, 115.91s/it]                 
Task 1, Epoch 11/20 => Loss 0.193, Train_accy 93.86:  55%|█████▌    | 11/20 [20:31<17:00, 113.44s/it]
Task 1, Epoch 12/20 => Loss 0.188, Train_accy 94.08:  55%|█████▌    | 11/20 [22:19<17:00, 113.44s/it]
Task 1, Epoch 12/20 => Loss 0.188, Train_accy 94.08:  60%|██████    | 12/20 [22:19<14:55, 111.88s/it]
Task 1, Epoch 13/20 => Loss 0.183, Train_accy 94.24:  60%|██████    | 12/20 [24:07<14:55, 111.88s/it]
Task 1, Epoch 13/20 => Loss 0.183, Train_accy 94.24:  65%|██████▌   | 13/20 [24:07<12:55, 110.73s/it]
Task 1, Epoch 14/20 => Loss 0.185, Train_accy 94.19:  65%|██████▌   | 13/20 [25:55<12:55, 110.73s/it]
Task 1, Epoch 14/20 => Loss 0.185, Train_accy 94.19:  70%|███████   | 14/20 [25:55<10:59, 109.97s/it]
Task 1, Epoch 15/20 => Loss 0.167, Train_accy 94.60, Test_accy 94.50:  70%|███████   | 14/20 [28:06<10:59, 109.97s/it]
Task 1, Epoch 15/20 => Loss 0.167, Train_accy 94.60, Test_accy 94.50:  75%|███████▌  | 15/20 [28:06<09:40, 116.16s/it]
Task 1, Epoch 16/20 => Loss 0.180, Train_accy 94.26:  75%|███████▌  | 15/20 [29:53<09:40, 116.16s/it]                 
Task 1, Epoch 16/20 => Loss 0.180, Train_accy 94.26:  80%|████████  | 16/20 [29:53<07:34, 113.64s/it]
Task 1, Epoch 17/20 => Loss 0.171, Train_accy 94.54:  80%|████████  | 16/20 [31:41<07:34, 113.64s/it]
Task 1, Epoch 17/20 => Loss 0.171, Train_accy 94.54:  85%|████████▌ | 17/20 [31:41<05:35, 111.87s/it]
Task 1, Epoch 18/20 => Loss 0.171, Train_accy 94.53:  85%|████████▌ | 17/20 [33:29<05:35, 111.87s/it]
Task 1, Epoch 18/20 => Loss 0.171, Train_accy 94.53:  90%|█████████ | 18/20 [33:29<03:41, 110.63s/it]
Task 1, Epoch 19/20 => Loss 0.166, Train_accy 94.63:  90%|█████████ | 18/20 [35:17<03:41, 110.63s/it]
Task 1, Epoch 19/20 => Loss 0.166, Train_accy 94.63:  95%|█████████▌| 19/20 [35:17<01:49, 109.81s/it]
Task 1, Epoch 20/20 => Loss 0.177, Train_accy 94.42, Test_accy 94.55:  95%|█████████▌| 19/20 [37:27<01:49, 109.81s/it]
Task 1, Epoch 20/20 => Loss 0.177, Train_accy 94.42, Test_accy 94.55: 100%|██████████| 20/20 [37:27<00:00, 115.79s/it]
Task 1, Epoch 20/20 => Loss 0.177, Train_accy 94.42, Test_accy 94.55: 100%|██████████| 20/20 [37:27<00:00, 112.36s/it]
2024-09-03 16:46:14,157 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.177, Train_accy 94.42, Test_accy 94.55
2024-09-03 16:46:36,315 [trainer.py] => No NME accuracy.
2024-09-03 16:46:36,316 [trainer.py] => CNN: {'total': 94.55, '00-19': 94.75, '20-39': 94.35, 'old': 94.75, 'new': 94.35}
2024-09-03 16:46:36,316 [trainer.py] => CNN top1 curve: [97.65, 94.55]
2024-09-03 16:46:36,316 [trainer.py] => CNN top5 curve: [99.55, 99.35]

Average Accuracy (CNN): 96.1
2024-09-03 16:46:36,316 [trainer.py] => Average Accuracy (CNN): 96.1 

2024-09-03 16:46:36,318 [trainer.py] => All params: 89715556
2024-09-03 16:46:36,319 [trainer.py] => Trainable params: 89715556
2024-09-03 16:46:38,354 [coda_prompt.py] => Learning on 40-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.487, Train_accy 85.68:   0%|          | 0/20 [01:48<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.487, Train_accy 85.68:   5%|▌         | 1/20 [01:48<34:18, 108.32s/it]
Task 2, Epoch 2/20 => Loss 0.298, Train_accy 90.54:   5%|▌         | 1/20 [03:36<34:18, 108.32s/it]
Task 2, Epoch 2/20 => Loss 0.298, Train_accy 90.54:  10%|█         | 2/20 [03:36<32:31, 108.41s/it]
Task 2, Epoch 3/20 => Loss 0.259, Train_accy 91.56:  10%|█         | 2/20 [05:24<32:31, 108.41s/it]
Task 2, Epoch 3/20 => Loss 0.259, Train_accy 91.56:  15%|█▌        | 3/20 [05:24<30:40, 108.29s/it]
Task 2, Epoch 4/20 => Loss 0.249, Train_accy 92.10:  15%|█▌        | 3/20 [07:13<30:40, 108.29s/it]
Task 2, Epoch 4/20 => Loss 0.249, Train_accy 92.10:  20%|██        | 4/20 [07:13<28:51, 108.20s/it]
Task 2, Epoch 5/20 => Loss 0.246, Train_accy 92.09, Test_accy 91.43:  20%|██        | 4/20 [09:34<28:51, 108.20s/it]
Task 2, Epoch 5/20 => Loss 0.246, Train_accy 92.09, Test_accy 91.43:  25%|██▌       | 5/20 [09:34<30:02, 120.14s/it]
Task 2, Epoch 6/20 => Loss 0.226, Train_accy 92.78:  25%|██▌       | 5/20 [11:22<30:02, 120.14s/it]                 
Task 2, Epoch 6/20 => Loss 0.226, Train_accy 92.78:  30%|███       | 6/20 [11:22<27:04, 116.05s/it]
Task 2, Epoch 7/20 => Loss 0.230, Train_accy 92.93:  30%|███       | 6/20 [13:10<27:04, 116.05s/it]
Task 2, Epoch 7/20 => Loss 0.230, Train_accy 92.93:  35%|███▌      | 7/20 [13:10<24:35, 113.47s/it]
Task 2, Epoch 8/20 => Loss 0.218, Train_accy 92.80:  35%|███▌      | 7/20 [14:58<24:35, 113.47s/it]
Task 2, Epoch 8/20 => Loss 0.218, Train_accy 92.80:  40%|████      | 8/20 [14:58<22:21, 111.82s/it]
Task 2, Epoch 9/20 => Loss 0.228, Train_accy 92.88:  40%|████      | 8/20 [16:46<22:21, 111.82s/it]
Task 2, Epoch 9/20 => Loss 0.228, Train_accy 92.88:  45%|████▌     | 9/20 [16:46<20:16, 110.60s/it]
Task 2, Epoch 10/20 => Loss 0.209, Train_accy 93.49, Test_accy 92.10:  45%|████▌     | 9/20 [19:08<20:16, 110.60s/it]
Task 2, Epoch 10/20 => Loss 0.209, Train_accy 93.49, Test_accy 92.10:  50%|█████     | 10/20 [19:08<20:02, 120.28s/it]
Task 2, Epoch 11/20 => Loss 0.206, Train_accy 93.45:  50%|█████     | 10/20 [20:57<20:02, 120.28s/it]                 
Task 2, Epoch 11/20 => Loss 0.206, Train_accy 93.45:  55%|█████▌    | 11/20 [20:57<17:29, 116.66s/it]
Task 2, Epoch 12/20 => Loss 0.200, Train_accy 93.47:  55%|█████▌    | 11/20 [22:45<17:29, 116.66s/it]
Task 2, Epoch 12/20 => Loss 0.200, Train_accy 93.47:  60%|██████    | 12/20 [22:45<15:12, 114.04s/it]
Task 2, Epoch 13/20 => Loss 0.196, Train_accy 93.62:  60%|██████    | 12/20 [24:33<15:12, 114.04s/it]
Task 2, Epoch 13/20 => Loss 0.196, Train_accy 93.62:  65%|██████▌   | 13/20 [24:33<13:06, 112.33s/it]
Task 2, Epoch 14/20 => Loss 0.185, Train_accy 94.03:  65%|██████▌   | 13/20 [26:21<13:06, 112.33s/it]
Task 2, Epoch 14/20 => Loss 0.185, Train_accy 94.03:  70%|███████   | 14/20 [26:21<11:06, 111.13s/it]
Task 2, Epoch 15/20 => Loss 0.192, Train_accy 93.89, Test_accy 92.55:  70%|███████   | 14/20 [28:43<11:06, 111.13s/it]
Task 2, Epoch 15/20 => Loss 0.192, Train_accy 93.89, Test_accy 92.55:  75%|███████▌  | 15/20 [28:43<10:01, 120.30s/it]
Task 2, Epoch 16/20 => Loss 0.194, Train_accy 93.75:  75%|███████▌  | 15/20 [30:32<10:01, 120.30s/it]                 
Task 2, Epoch 16/20 => Loss 0.194, Train_accy 93.75:  80%|████████  | 16/20 [30:32<07:47, 116.77s/it]
Task 2, Epoch 17/20 => Loss 0.184, Train_accy 94.15:  80%|████████  | 16/20 [32:20<07:47, 116.77s/it]
Task 2, Epoch 17/20 => Loss 0.184, Train_accy 94.15:  85%|████████▌ | 17/20 [32:20<05:42, 114.31s/it]
Task 2, Epoch 18/20 => Loss 0.184, Train_accy 94.34:  85%|████████▌ | 17/20 [34:09<05:42, 114.31s/it]
Task 2, Epoch 18/20 => Loss 0.184, Train_accy 94.34:  90%|█████████ | 18/20 [34:09<03:45, 112.54s/it]
Task 2, Epoch 19/20 => Loss 0.185, Train_accy 94.16:  90%|█████████ | 18/20 [35:57<03:45, 112.54s/it]
Task 2, Epoch 19/20 => Loss 0.185, Train_accy 94.16:  95%|█████████▌| 19/20 [35:57<01:51, 111.22s/it]
Task 2, Epoch 20/20 => Loss 0.158, Train_accy 94.83, Test_accy 92.62:  95%|█████████▌| 19/20 [38:19<01:51, 111.22s/it]
Task 2, Epoch 20/20 => Loss 0.158, Train_accy 94.83, Test_accy 92.62: 100%|██████████| 20/20 [38:19<00:00, 120.38s/it]
Task 2, Epoch 20/20 => Loss 0.158, Train_accy 94.83, Test_accy 92.62: 100%|██████████| 20/20 [38:19<00:00, 114.95s/it]
2024-09-03 17:24:57,404 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.158, Train_accy 94.83, Test_accy 92.62
2024-09-03 17:25:30,638 [trainer.py] => No NME accuracy.
2024-09-03 17:25:30,638 [trainer.py] => CNN: {'total': 92.62, '00-19': 93.0, '20-39': 92.55, '40-59': 92.3, 'old': 92.78, 'new': 92.3}
2024-09-03 17:25:30,638 [trainer.py] => CNN top1 curve: [97.65, 94.55, 92.62]
2024-09-03 17:25:30,639 [trainer.py] => CNN top5 curve: [99.55, 99.35, 99.2]

Average Accuracy (CNN): 94.94
2024-09-03 17:25:30,639 [trainer.py] => Average Accuracy (CNN): 94.94 

2024-09-03 17:25:30,639 [trainer.py] => All params: 89715556
2024-09-03 17:25:30,640 [trainer.py] => Trainable params: 89715556
2024-09-03 17:25:33,272 [coda_prompt.py] => Learning on 60-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.477, Train_accy 85.64:   0%|          | 0/20 [01:48<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.477, Train_accy 85.64:   5%|▌         | 1/20 [01:48<34:15, 108.20s/it]
Task 3, Epoch 2/20 => Loss 0.291, Train_accy 90.76:   5%|▌         | 1/20 [03:36<34:15, 108.20s/it]
Task 3, Epoch 2/20 => Loss 0.291, Train_accy 90.76:  10%|█         | 2/20 [03:36<32:30, 108.34s/it]
Task 3, Epoch 3/20 => Loss 0.256, Train_accy 91.83:  10%|█         | 2/20 [05:25<32:30, 108.34s/it]
Task 3, Epoch 3/20 => Loss 0.256, Train_accy 91.83:  15%|█▌        | 3/20 [05:25<30:43, 108.43s/it]
Task 3, Epoch 4/20 => Loss 0.234, Train_accy 92.37:  15%|█▌        | 3/20 [07:13<30:43, 108.43s/it]
Task 3, Epoch 4/20 => Loss 0.234, Train_accy 92.37:  20%|██        | 4/20 [07:13<28:53, 108.37s/it]
Task 3, Epoch 5/20 => Loss 0.236, Train_accy 92.37, Test_accy 89.16:  20%|██        | 4/20 [09:46<28:53, 108.37s/it]
Task 3, Epoch 5/20 => Loss 0.236, Train_accy 92.37, Test_accy 89.16:  25%|██▌       | 5/20 [09:46<31:04, 124.32s/it]
Task 3, Epoch 6/20 => Loss 0.223, Train_accy 92.86:  25%|██▌       | 5/20 [11:34<31:04, 124.32s/it]                 
Task 3, Epoch 6/20 => Loss 0.223, Train_accy 92.86:  30%|███       | 6/20 [11:34<27:42, 118.76s/it]
Task 3, Epoch 7/20 => Loss 0.220, Train_accy 93.16:  30%|███       | 6/20 [13:22<27:42, 118.76s/it]
Task 3, Epoch 7/20 => Loss 0.220, Train_accy 93.16:  35%|███▌      | 7/20 [13:22<24:59, 115.36s/it]
Task 3, Epoch 8/20 => Loss 0.224, Train_accy 92.39:  35%|███▌      | 7/20 [15:11<24:59, 115.36s/it]
Task 3, Epoch 8/20 => Loss 0.224, Train_accy 92.39:  40%|████      | 8/20 [15:11<22:38, 113.22s/it]
Task 3, Epoch 9/20 => Loss 0.215, Train_accy 92.93:  40%|████      | 8/20 [16:59<22:38, 113.22s/it]
Task 3, Epoch 9/20 => Loss 0.215, Train_accy 92.93:  45%|████▌     | 9/20 [16:59<20:29, 111.81s/it]
Task 3, Epoch 10/20 => Loss 0.218, Train_accy 92.75, Test_accy 90.00:  45%|████▌     | 9/20 [19:33<20:29, 111.81s/it]
Task 3, Epoch 10/20 => Loss 0.218, Train_accy 92.75, Test_accy 90.00:  50%|█████     | 10/20 [19:33<20:46, 124.66s/it]
Task 3, Epoch 11/20 => Loss 0.199, Train_accy 93.59:  50%|█████     | 10/20 [21:21<20:46, 124.66s/it]                 
Task 3, Epoch 11/20 => Loss 0.199, Train_accy 93.59:  55%|█████▌    | 11/20 [21:21<17:57, 119.77s/it]
Task 3, Epoch 12/20 => Loss 0.203, Train_accy 93.65:  55%|█████▌    | 11/20 [23:10<17:57, 119.77s/it]
Task 3, Epoch 12/20 => Loss 0.203, Train_accy 93.65:  60%|██████    | 12/20 [23:10<15:30, 116.33s/it]
Task 3, Epoch 13/20 => Loss 0.189, Train_accy 93.87:  60%|██████    | 12/20 [24:58<15:30, 116.33s/it]
Task 3, Epoch 13/20 => Loss 0.189, Train_accy 93.87:  65%|██████▌   | 13/20 [24:58<13:17, 113.98s/it]
Task 3, Epoch 14/20 => Loss 0.192, Train_accy 93.90:  65%|██████▌   | 13/20 [26:47<13:17, 113.98s/it]
Task 3, Epoch 14/20 => Loss 0.192, Train_accy 93.90:  70%|███████   | 14/20 [26:47<11:13, 112.32s/it]
Task 3, Epoch 15/20 => Loss 0.195, Train_accy 93.76, Test_accy 90.30:  70%|███████   | 14/20 [29:20<11:13, 112.32s/it]
Task 3, Epoch 15/20 => Loss 0.195, Train_accy 93.76, Test_accy 90.30:  75%|███████▌  | 15/20 [29:20<10:22, 124.57s/it]
Task 3, Epoch 16/20 => Loss 0.187, Train_accy 93.90:  75%|███████▌  | 15/20 [31:08<10:22, 124.57s/it]                 
Task 3, Epoch 16/20 => Loss 0.187, Train_accy 93.90:  80%|████████  | 16/20 [31:08<07:59, 119.79s/it]
Task 3, Epoch 17/20 => Loss 0.188, Train_accy 93.96:  80%|████████  | 16/20 [32:57<07:59, 119.79s/it]
Task 3, Epoch 17/20 => Loss 0.188, Train_accy 93.96:  85%|████████▌ | 17/20 [32:57<05:49, 116.39s/it]
Task 3, Epoch 18/20 => Loss 0.184, Train_accy 93.84:  85%|████████▌ | 17/20 [34:45<05:49, 116.39s/it]
Task 3, Epoch 18/20 => Loss 0.184, Train_accy 93.84:  90%|█████████ | 18/20 [34:45<03:47, 113.97s/it]
Task 3, Epoch 19/20 => Loss 0.184, Train_accy 94.01:  90%|█████████ | 18/20 [36:34<03:47, 113.97s/it]
Task 3, Epoch 19/20 => Loss 0.184, Train_accy 94.01:  95%|█████████▌| 19/20 [36:34<01:52, 112.32s/it]
Task 3, Epoch 20/20 => Loss 0.172, Train_accy 94.34, Test_accy 90.10:  95%|█████████▌| 19/20 [39:06<01:52, 112.32s/it]
Task 3, Epoch 20/20 => Loss 0.172, Train_accy 94.34, Test_accy 90.10: 100%|██████████| 20/20 [39:06<00:00, 124.30s/it]
Task 3, Epoch 20/20 => Loss 0.172, Train_accy 94.34, Test_accy 90.10: 100%|██████████| 20/20 [39:06<00:00, 117.32s/it]
2024-09-03 18:04:39,816 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.172, Train_accy 94.34, Test_accy 90.10
2024-09-03 18:05:24,376 [trainer.py] => No NME accuracy.
2024-09-03 18:05:24,377 [trainer.py] => CNN: {'total': 90.1, '00-19': 92.0, '20-39': 91.9, '40-59': 86.35, '60-79': 90.15, 'old': 90.08, 'new': 90.15}
2024-09-03 18:05:24,377 [trainer.py] => CNN top1 curve: [97.65, 94.55, 92.62, 90.1]
2024-09-03 18:05:24,377 [trainer.py] => CNN top5 curve: [99.55, 99.35, 99.2, 99.12]

Average Accuracy (CNN): 93.73
2024-09-03 18:05:24,377 [trainer.py] => Average Accuracy (CNN): 93.73 

2024-09-03 18:05:24,378 [trainer.py] => All params: 89715556
2024-09-03 18:05:24,379 [trainer.py] => Trainable params: 89715556
2024-09-03 18:05:27,946 [coda_prompt.py] => Learning on 80-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.490, Train_accy 86.13:   0%|          | 0/20 [01:48<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.490, Train_accy 86.13:   5%|▌         | 1/20 [01:48<34:22, 108.56s/it]
Task 4, Epoch 2/20 => Loss 0.265, Train_accy 91.85:   5%|▌         | 1/20 [03:37<34:22, 108.56s/it]
Task 4, Epoch 2/20 => Loss 0.265, Train_accy 91.85:  10%|█         | 2/20 [03:37<32:34, 108.57s/it]
Task 4, Epoch 3/20 => Loss 0.252, Train_accy 92.56:  10%|█         | 2/20 [05:26<32:34, 108.57s/it]
Task 4, Epoch 3/20 => Loss 0.252, Train_accy 92.56:  15%|█▌        | 3/20 [05:26<30:48, 108.71s/it]
Task 4, Epoch 4/20 => Loss 0.240, Train_accy 92.96:  15%|█▌        | 3/20 [07:14<30:48, 108.71s/it]
Task 4, Epoch 4/20 => Loss 0.240, Train_accy 92.96:  20%|██        | 4/20 [07:14<29:00, 108.77s/it]
Task 4, Epoch 5/20 => Loss 0.213, Train_accy 93.43, Test_accy 88.25:  20%|██        | 4/20 [09:59<29:00, 108.77s/it]
Task 4, Epoch 5/20 => Loss 0.213, Train_accy 93.43, Test_accy 88.25:  25%|██▌       | 5/20 [09:59<32:11, 128.78s/it]
Task 4, Epoch 6/20 => Loss 0.221, Train_accy 93.05:  25%|██▌       | 5/20 [11:47<32:11, 128.78s/it]                 
Task 4, Epoch 6/20 => Loss 0.221, Train_accy 93.05:  30%|███       | 6/20 [11:47<28:27, 121.95s/it]
Task 4, Epoch 7/20 => Loss 0.213, Train_accy 93.35:  30%|███       | 6/20 [13:36<28:27, 121.95s/it]
Task 4, Epoch 7/20 => Loss 0.213, Train_accy 93.35:  35%|███▌      | 7/20 [13:36<25:28, 117.61s/it]
Task 4, Epoch 8/20 => Loss 0.211, Train_accy 93.31:  35%|███▌      | 7/20 [15:24<25:28, 117.61s/it]
Task 4, Epoch 8/20 => Loss 0.211, Train_accy 93.31:  40%|████      | 8/20 [15:24<22:56, 114.71s/it]
Task 4, Epoch 9/20 => Loss 0.203, Train_accy 93.84:  40%|████      | 8/20 [17:13<22:56, 114.71s/it]
Task 4, Epoch 9/20 => Loss 0.203, Train_accy 93.84:  45%|████▌     | 9/20 [17:13<20:42, 112.91s/it]
Task 4, Epoch 10/20 => Loss 0.198, Train_accy 93.97, Test_accy 89.15:  45%|████▌     | 9/20 [19:58<20:42, 112.91s/it]
Task 4, Epoch 10/20 => Loss 0.198, Train_accy 93.97, Test_accy 89.15:  50%|█████     | 10/20 [19:58<21:27, 128.71s/it]
Task 4, Epoch 11/20 => Loss 0.197, Train_accy 93.93:  50%|█████     | 10/20 [21:46<21:27, 128.71s/it]                 
Task 4, Epoch 11/20 => Loss 0.197, Train_accy 93.93:  55%|█████▌    | 11/20 [21:46<18:22, 122.51s/it]
Task 4, Epoch 12/20 => Loss 0.203, Train_accy 93.97:  55%|█████▌    | 11/20 [23:35<18:22, 122.51s/it]
Task 4, Epoch 12/20 => Loss 0.203, Train_accy 93.97:  60%|██████    | 12/20 [23:35<15:47, 118.40s/it]
Task 4, Epoch 13/20 => Loss 0.184, Train_accy 94.00:  60%|██████    | 12/20 [25:23<15:47, 118.40s/it]
Task 4, Epoch 13/20 => Loss 0.184, Train_accy 94.00:  65%|██████▌   | 13/20 [25:23<13:27, 115.33s/it]
Task 4, Epoch 14/20 => Loss 0.191, Train_accy 94.22:  65%|██████▌   | 13/20 [27:12<13:27, 115.33s/it]
Task 4, Epoch 14/20 => Loss 0.191, Train_accy 94.22:  70%|███████   | 14/20 [27:12<11:19, 113.33s/it]
Task 4, Epoch 15/20 => Loss 0.180, Train_accy 94.33, Test_accy 89.22:  70%|███████   | 14/20 [29:57<11:19, 113.33s/it]
Task 4, Epoch 15/20 => Loss 0.180, Train_accy 94.33, Test_accy 89.22:  75%|███████▌  | 15/20 [29:57<10:44, 128.90s/it]
Task 4, Epoch 16/20 => Loss 0.174, Train_accy 94.74:  75%|███████▌  | 15/20 [31:45<10:44, 128.90s/it]                 
Task 4, Epoch 16/20 => Loss 0.174, Train_accy 94.74:  80%|████████  | 16/20 [31:45<08:10, 122.63s/it]
Task 4, Epoch 17/20 => Loss 0.181, Train_accy 94.11:  80%|████████  | 16/20 [33:33<08:10, 122.63s/it]
Task 4, Epoch 17/20 => Loss 0.181, Train_accy 94.11:  85%|████████▌ | 17/20 [33:33<05:54, 118.33s/it]
Task 4, Epoch 18/20 => Loss 0.173, Train_accy 94.43:  85%|████████▌ | 17/20 [35:22<05:54, 118.33s/it]
Task 4, Epoch 18/20 => Loss 0.173, Train_accy 94.43:  90%|█████████ | 18/20 [35:22<03:50, 115.36s/it]
Task 4, Epoch 19/20 => Loss 0.172, Train_accy 94.60:  90%|█████████ | 18/20 [37:11<03:50, 115.36s/it]
Task 4, Epoch 19/20 => Loss 0.172, Train_accy 94.60:  95%|█████████▌| 19/20 [37:11<01:53, 113.41s/it]
Task 4, Epoch 20/20 => Loss 0.171, Train_accy 94.74, Test_accy 89.33:  95%|█████████▌| 19/20 [39:55<01:53, 113.41s/it]
Task 4, Epoch 20/20 => Loss 0.171, Train_accy 94.74, Test_accy 89.33: 100%|██████████| 20/20 [39:55<00:00, 128.80s/it]
Task 4, Epoch 20/20 => Loss 0.171, Train_accy 94.74, Test_accy 89.33: 100%|██████████| 20/20 [39:55<00:00, 119.79s/it]
2024-09-03 18:45:23,822 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.171, Train_accy 94.74, Test_accy 89.33
2024-09-03 18:46:20,080 [trainer.py] => No NME accuracy.
2024-09-03 18:46:20,081 [trainer.py] => CNN: {'total': 89.33, '00-19': 90.75, '20-39': 91.8, '40-59': 84.9, '60-79': 89.2, '80-99': 90.0, 'old': 89.16, 'new': 90.0}
2024-09-03 18:46:20,081 [trainer.py] => CNN top1 curve: [97.65, 94.55, 92.62, 90.1, 89.33]
2024-09-03 18:46:20,081 [trainer.py] => CNN top5 curve: [99.55, 99.35, 99.2, 99.12, 98.84]

Average Accuracy (CNN): 92.85
2024-09-03 18:46:20,081 [trainer.py] => Average Accuracy (CNN): 92.85 

Accuracy Matrix (CNN):
[[97.65 94.75 93.   92.   90.75]
 [ 0.   94.35 92.55 91.9  91.8 ]
 [ 0.    0.   92.3  86.35 84.9 ]
 [ 0.    0.    0.   90.15 89.2 ]
 [ 0.    0.    0.    0.   90.  ]]
2024-09-03 18:46:20,082 [trainer.py] => Forgetting (CNN): 4.449999999999999
2024-09-03 18:46:23,030 [trainer.py] => config: ./exps/coda_prompt_cifar_B0_Inc10.json
2024-09-03 18:46:23,030 [trainer.py] => prefix:  
2024-09-03 18:46:23,030 [trainer.py] => dataset: cifar224
2024-09-03 18:46:23,030 [trainer.py] => memory_size: 0
2024-09-03 18:46:23,030 [trainer.py] => memory_per_class: 0
2024-09-03 18:46:23,030 [trainer.py] => fixed_memory: False
2024-09-03 18:46:23,030 [trainer.py] => shuffle: True
2024-09-03 18:46:23,030 [trainer.py] => init_cls: 10
2024-09-03 18:46:23,030 [trainer.py] => increment: 10
2024-09-03 18:46:23,030 [trainer.py] => model_name: coda_prompt
2024-09-03 18:46:23,030 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-03 18:46:23,030 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-03 18:46:23,030 [trainer.py] => seed: 1993
2024-09-03 18:46:23,030 [trainer.py] => tuned_epoch: 20
2024-09-03 18:46:23,030 [trainer.py] => init_lr: 0.001
2024-09-03 18:46:23,030 [trainer.py] => batch_size: 48
2024-09-03 18:46:23,030 [trainer.py] => weight_decay: 0
2024-09-03 18:46:23,030 [trainer.py] => min_lr: 1e-05
2024-09-03 18:46:23,030 [trainer.py] => optimizer: adam
2024-09-03 18:46:23,030 [trainer.py] => scheduler: cosine
2024-09-03 18:46:23,030 [trainer.py] => reinit_optimizer: True
2024-09-03 18:46:23,030 [trainer.py] => pretrained: True
2024-09-03 18:46:23,030 [trainer.py] => drop: 0.0
2024-09-03 18:46:23,030 [trainer.py] => drop_path: 0.0
2024-09-03 18:46:23,030 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-03 18:46:24,131 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-03 18:46:26,451 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-03 18:46:26,451 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-03 18:46:26,452 [trainer.py] => All params: 89715556
2024-09-03 18:46:26,452 [trainer.py] => Trainable params: 89715556
2024-09-03 18:46:26,452 [coda_prompt.py] => Learning on 0-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.602, Train_accy 81.73:   0%|          | 0/20 [00:54<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.602, Train_accy 81.73:   5%|▌         | 1/20 [00:54<17:14, 54.44s/it]
Task 0, Epoch 2/20 => Loss 0.250, Train_accy 92.09:   5%|▌         | 1/20 [01:48<17:14, 54.44s/it]
Task 0, Epoch 2/20 => Loss 0.250, Train_accy 92.09:  10%|█         | 2/20 [01:48<16:14, 54.16s/it]
Task 0, Epoch 3/20 => Loss 0.220, Train_accy 92.95:  10%|█         | 2/20 [02:42<16:14, 54.16s/it]
Task 0, Epoch 3/20 => Loss 0.220, Train_accy 92.95:  15%|█▌        | 3/20 [02:42<15:22, 54.26s/it]
Task 0, Epoch 4/20 => Loss 0.193, Train_accy 93.85:  15%|█▌        | 3/20 [03:36<15:22, 54.26s/it]
Task 0, Epoch 4/20 => Loss 0.193, Train_accy 93.85:  20%|██        | 4/20 [03:36<14:26, 54.15s/it]
Task 0, Epoch 5/20 => Loss 0.184, Train_accy 93.83, Test_accy 98.20:  20%|██        | 4/20 [04:36<14:26, 54.15s/it]
Task 0, Epoch 5/20 => Loss 0.184, Train_accy 93.83, Test_accy 98.20:  25%|██▌       | 5/20 [04:36<14:04, 56.28s/it]
Task 0, Epoch 6/20 => Loss 0.176, Train_accy 94.29:  25%|██▌       | 5/20 [05:31<14:04, 56.28s/it]                 
Task 0, Epoch 6/20 => Loss 0.176, Train_accy 94.29:  30%|███       | 6/20 [05:31<12:58, 55.60s/it]
Task 0, Epoch 7/20 => Loss 0.176, Train_accy 94.55:  30%|███       | 6/20 [06:25<12:58, 55.60s/it]
Task 0, Epoch 7/20 => Loss 0.176, Train_accy 94.55:  35%|███▌      | 7/20 [06:25<11:56, 55.10s/it]
Task 0, Epoch 8/20 => Loss 0.156, Train_accy 94.67:  35%|███▌      | 7/20 [07:19<11:56, 55.10s/it]
Task 0, Epoch 8/20 => Loss 0.156, Train_accy 94.67:  40%|████      | 8/20 [07:19<10:57, 54.83s/it]
Task 0, Epoch 9/20 => Loss 0.147, Train_accy 95.17:  40%|████      | 8/20 [08:13<10:57, 54.83s/it]
Task 0, Epoch 9/20 => Loss 0.147, Train_accy 95.17:  45%|████▌     | 9/20 [08:13<10:01, 54.64s/it]
Task 0, Epoch 10/20 => Loss 0.158, Train_accy 94.85, Test_accy 98.50:  45%|████▌     | 9/20 [09:13<10:01, 54.64s/it]
Task 0, Epoch 10/20 => Loss 0.158, Train_accy 94.85, Test_accy 98.50:  50%|█████     | 10/20 [09:13<09:22, 56.24s/it]
Task 0, Epoch 11/20 => Loss 0.149, Train_accy 95.21:  50%|█████     | 10/20 [10:07<09:22, 56.24s/it]                 
Task 0, Epoch 11/20 => Loss 0.149, Train_accy 95.21:  55%|█████▌    | 11/20 [10:07<08:20, 55.63s/it]
Task 0, Epoch 12/20 => Loss 0.143, Train_accy 95.17:  55%|█████▌    | 11/20 [11:01<08:20, 55.63s/it]
Task 0, Epoch 12/20 => Loss 0.143, Train_accy 95.17:  60%|██████    | 12/20 [11:01<07:21, 55.17s/it]
Task 0, Epoch 13/20 => Loss 0.138, Train_accy 95.39:  60%|██████    | 12/20 [11:56<07:21, 55.17s/it]
Task 0, Epoch 13/20 => Loss 0.138, Train_accy 95.39:  65%|██████▌   | 13/20 [11:56<06:24, 54.87s/it]
Task 0, Epoch 14/20 => Loss 0.129, Train_accy 95.91:  65%|██████▌   | 13/20 [12:50<06:24, 54.87s/it]
Task 0, Epoch 14/20 => Loss 0.129, Train_accy 95.91:  70%|███████   | 14/20 [12:50<05:28, 54.69s/it]
Task 0, Epoch 15/20 => Loss 0.121, Train_accy 95.95, Test_accy 98.50:  70%|███████   | 14/20 [13:50<05:28, 54.69s/it]
Task 0, Epoch 15/20 => Loss 0.121, Train_accy 95.95, Test_accy 98.50:  75%|███████▌  | 15/20 [13:50<04:41, 56.31s/it]
Task 0, Epoch 16/20 => Loss 0.123, Train_accy 95.75:  75%|███████▌  | 15/20 [14:44<04:41, 56.31s/it]                 
Task 0, Epoch 16/20 => Loss 0.123, Train_accy 95.75:  80%|████████  | 16/20 [14:44<03:42, 55.65s/it]
Task 0, Epoch 17/20 => Loss 0.130, Train_accy 95.69:  80%|████████  | 16/20 [15:38<03:42, 55.65s/it]
Task 0, Epoch 17/20 => Loss 0.130, Train_accy 95.69:  85%|████████▌ | 17/20 [15:38<02:45, 55.26s/it]
Task 0, Epoch 18/20 => Loss 0.137, Train_accy 95.59:  85%|████████▌ | 17/20 [16:32<02:45, 55.26s/it]
Task 0, Epoch 18/20 => Loss 0.137, Train_accy 95.59:  90%|█████████ | 18/20 [16:32<01:49, 54.91s/it]
Task 0, Epoch 19/20 => Loss 0.121, Train_accy 95.95:  90%|█████████ | 18/20 [17:27<01:49, 54.91s/it]
Task 0, Epoch 19/20 => Loss 0.121, Train_accy 95.95:  95%|█████████▌| 19/20 [17:27<00:54, 54.72s/it]
Task 0, Epoch 20/20 => Loss 0.124, Train_accy 96.01, Test_accy 98.60:  95%|█████████▌| 19/20 [18:27<00:54, 54.72s/it]
Task 0, Epoch 20/20 => Loss 0.124, Train_accy 96.01, Test_accy 98.60: 100%|██████████| 20/20 [18:27<00:00, 56.30s/it]
Task 0, Epoch 20/20 => Loss 0.124, Train_accy 96.01, Test_accy 98.60: 100%|██████████| 20/20 [18:27<00:00, 55.36s/it]
2024-09-03 19:04:54,154 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.124, Train_accy 96.01, Test_accy 98.60
2024-09-03 19:04:59,990 [trainer.py] => No NME accuracy.
2024-09-03 19:04:59,990 [trainer.py] => CNN: {'total': 98.6, '00-09': 98.6, 'old': 0, 'new': 98.6}
2024-09-03 19:04:59,990 [trainer.py] => CNN top1 curve: [98.6]
2024-09-03 19:04:59,990 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 98.6
2024-09-03 19:04:59,991 [trainer.py] => Average Accuracy (CNN): 98.6 

2024-09-03 19:04:59,992 [trainer.py] => All params: 89715556
2024-09-03 19:04:59,993 [trainer.py] => Trainable params: 89715556
2024-09-03 19:05:00,298 [coda_prompt.py] => Learning on 10-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.524, Train_accy 83.07:   0%|          | 0/20 [00:54<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.524, Train_accy 83.07:   5%|▌         | 1/20 [00:54<17:09, 54.16s/it]
Task 1, Epoch 2/20 => Loss 0.279, Train_accy 90.46:   5%|▌         | 1/20 [01:48<17:09, 54.16s/it]
Task 1, Epoch 2/20 => Loss 0.279, Train_accy 90.46:  10%|█         | 2/20 [01:48<16:13, 54.11s/it]
Task 1, Epoch 3/20 => Loss 0.250, Train_accy 91.51:  10%|█         | 2/20 [02:42<16:13, 54.11s/it]
Task 1, Epoch 3/20 => Loss 0.250, Train_accy 91.51:  15%|█▌        | 3/20 [02:42<15:19, 54.08s/it]
Task 1, Epoch 4/20 => Loss 0.220, Train_accy 92.43:  15%|█▌        | 3/20 [03:36<15:19, 54.08s/it]
Task 1, Epoch 4/20 => Loss 0.220, Train_accy 92.43:  20%|██        | 4/20 [03:36<14:25, 54.09s/it]
Task 1, Epoch 5/20 => Loss 0.211, Train_accy 92.75, Test_accy 96.05:  20%|██        | 4/20 [04:41<14:25, 54.09s/it]
Task 1, Epoch 5/20 => Loss 0.211, Train_accy 92.75, Test_accy 96.05:  25%|██▌       | 5/20 [04:41<14:33, 58.24s/it]
Task 1, Epoch 6/20 => Loss 0.217, Train_accy 92.85:  25%|██▌       | 5/20 [05:36<14:33, 58.24s/it]                 
Task 1, Epoch 6/20 => Loss 0.217, Train_accy 92.85:  30%|███       | 6/20 [05:36<13:15, 56.82s/it]
Task 1, Epoch 7/20 => Loss 0.213, Train_accy 93.21:  30%|███       | 6/20 [06:30<13:15, 56.82s/it]
Task 1, Epoch 7/20 => Loss 0.213, Train_accy 93.21:  35%|███▌      | 7/20 [06:30<12:07, 55.94s/it]
Task 1, Epoch 8/20 => Loss 0.180, Train_accy 94.11:  35%|███▌      | 7/20 [07:24<12:07, 55.94s/it]
Task 1, Epoch 8/20 => Loss 0.180, Train_accy 94.11:  40%|████      | 8/20 [07:24<11:05, 55.44s/it]
Task 1, Epoch 9/20 => Loss 0.201, Train_accy 93.53:  40%|████      | 8/20 [08:18<11:05, 55.44s/it]
Task 1, Epoch 9/20 => Loss 0.201, Train_accy 93.53:  45%|████▌     | 9/20 [08:18<10:05, 55.01s/it]
Task 1, Epoch 10/20 => Loss 0.171, Train_accy 94.43, Test_accy 96.65:  45%|████▌     | 9/20 [09:24<10:05, 55.01s/it]
Task 1, Epoch 10/20 => Loss 0.171, Train_accy 94.43, Test_accy 96.65:  50%|█████     | 10/20 [09:24<09:42, 58.30s/it]
Task 1, Epoch 11/20 => Loss 0.182, Train_accy 93.81:  50%|█████     | 10/20 [10:18<09:42, 58.30s/it]                 
Task 1, Epoch 11/20 => Loss 0.182, Train_accy 93.81:  55%|█████▌    | 11/20 [10:18<08:33, 57.09s/it]
Task 1, Epoch 12/20 => Loss 0.172, Train_accy 93.91:  55%|█████▌    | 11/20 [11:12<08:33, 57.09s/it]
Task 1, Epoch 12/20 => Loss 0.172, Train_accy 93.91:  60%|██████    | 12/20 [11:12<07:29, 56.17s/it]
Task 1, Epoch 13/20 => Loss 0.183, Train_accy 93.77:  60%|██████    | 12/20 [12:06<07:29, 56.17s/it]
Task 1, Epoch 13/20 => Loss 0.183, Train_accy 93.77:  65%|██████▌   | 13/20 [12:06<06:29, 55.59s/it]
Task 1, Epoch 14/20 => Loss 0.173, Train_accy 94.07:  65%|██████▌   | 13/20 [13:01<06:29, 55.59s/it]
Task 1, Epoch 14/20 => Loss 0.173, Train_accy 94.07:  70%|███████   | 14/20 [13:01<05:30, 55.16s/it]
Task 1, Epoch 15/20 => Loss 0.174, Train_accy 93.81, Test_accy 96.20:  70%|███████   | 14/20 [14:06<05:30, 55.16s/it]
Task 1, Epoch 15/20 => Loss 0.174, Train_accy 93.81, Test_accy 96.20:  75%|███████▌  | 15/20 [14:06<04:51, 58.31s/it]
Task 1, Epoch 16/20 => Loss 0.181, Train_accy 94.01:  75%|███████▌  | 15/20 [15:01<04:51, 58.31s/it]                 
Task 1, Epoch 16/20 => Loss 0.181, Train_accy 94.01:  80%|████████  | 16/20 [15:01<03:48, 57.17s/it]
Task 1, Epoch 17/20 => Loss 0.175, Train_accy 93.87:  80%|████████  | 16/20 [15:55<03:48, 57.17s/it]
Task 1, Epoch 17/20 => Loss 0.175, Train_accy 93.87:  85%|████████▌ | 17/20 [15:55<02:48, 56.33s/it]
Task 1, Epoch 18/20 => Loss 0.168, Train_accy 94.29:  85%|████████▌ | 17/20 [16:49<02:48, 56.33s/it]
Task 1, Epoch 18/20 => Loss 0.168, Train_accy 94.29:  90%|█████████ | 18/20 [16:49<01:51, 55.61s/it]
Task 1, Epoch 19/20 => Loss 0.167, Train_accy 94.39:  90%|█████████ | 18/20 [17:43<01:51, 55.61s/it]
Task 1, Epoch 19/20 => Loss 0.167, Train_accy 94.39:  95%|█████████▌| 19/20 [17:43<00:55, 55.24s/it]
Task 1, Epoch 20/20 => Loss 0.164, Train_accy 94.63, Test_accy 96.15:  95%|█████████▌| 19/20 [18:49<00:55, 55.24s/it]
Task 1, Epoch 20/20 => Loss 0.164, Train_accy 94.63, Test_accy 96.15: 100%|██████████| 20/20 [18:49<00:00, 58.37s/it]
Task 1, Epoch 20/20 => Loss 0.164, Train_accy 94.63, Test_accy 96.15: 100%|██████████| 20/20 [18:49<00:00, 56.48s/it]
2024-09-03 19:23:49,912 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.164, Train_accy 94.63, Test_accy 96.15
2024-09-03 19:24:01,468 [trainer.py] => No NME accuracy.
2024-09-03 19:24:01,469 [trainer.py] => CNN: {'total': 96.15, '00-09': 97.6, '10-19': 94.7, 'old': 97.6, 'new': 94.7}
2024-09-03 19:24:01,469 [trainer.py] => CNN top1 curve: [98.6, 96.15]
2024-09-03 19:24:01,469 [trainer.py] => CNN top5 curve: [100.0, 99.7]

Average Accuracy (CNN): 97.38
2024-09-03 19:24:01,469 [trainer.py] => Average Accuracy (CNN): 97.38 

2024-09-03 19:24:01,470 [trainer.py] => All params: 89715556
2024-09-03 19:24:01,471 [trainer.py] => Trainable params: 89715556
2024-09-03 19:24:02,013 [coda_prompt.py] => Learning on 20-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.319, Train_accy 90.20:   0%|          | 0/20 [00:54<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.319, Train_accy 90.20:   5%|▌         | 1/20 [00:54<17:08, 54.11s/it]
Task 2, Epoch 2/20 => Loss 0.143, Train_accy 95.23:   5%|▌         | 1/20 [01:48<17:08, 54.11s/it]
Task 2, Epoch 2/20 => Loss 0.143, Train_accy 95.23:  10%|█         | 2/20 [01:48<16:14, 54.16s/it]
Task 2, Epoch 3/20 => Loss 0.121, Train_accy 95.97:  10%|█         | 2/20 [02:42<16:14, 54.16s/it]
Task 2, Epoch 3/20 => Loss 0.121, Train_accy 95.97:  15%|█▌        | 3/20 [02:42<15:21, 54.20s/it]
Task 2, Epoch 4/20 => Loss 0.118, Train_accy 96.13:  15%|█▌        | 3/20 [03:36<15:21, 54.20s/it]
Task 2, Epoch 4/20 => Loss 0.118, Train_accy 96.13:  20%|██        | 4/20 [03:36<14:25, 54.12s/it]
Task 2, Epoch 5/20 => Loss 0.093, Train_accy 97.00, Test_accy 93.90:  20%|██        | 4/20 [04:47<14:25, 54.12s/it]
Task 2, Epoch 5/20 => Loss 0.093, Train_accy 97.00, Test_accy 93.90:  25%|██▌       | 5/20 [04:47<15:04, 60.28s/it]
Task 2, Epoch 6/20 => Loss 0.107, Train_accy 96.53:  25%|██▌       | 5/20 [05:41<15:04, 60.28s/it]                 
Task 2, Epoch 6/20 => Loss 0.107, Train_accy 96.53:  30%|███       | 6/20 [05:41<13:34, 58.16s/it]
Task 2, Epoch 7/20 => Loss 0.101, Train_accy 96.83:  30%|███       | 6/20 [06:35<13:34, 58.16s/it]
Task 2, Epoch 7/20 => Loss 0.101, Train_accy 96.83:  35%|███▌      | 7/20 [06:35<12:18, 56.84s/it]
Task 2, Epoch 8/20 => Loss 0.108, Train_accy 96.47:  35%|███▌      | 7/20 [07:30<12:18, 56.84s/it]
Task 2, Epoch 8/20 => Loss 0.108, Train_accy 96.47:  40%|████      | 8/20 [07:30<11:12, 56.01s/it]
Task 2, Epoch 9/20 => Loss 0.102, Train_accy 96.55:  40%|████      | 8/20 [08:24<11:12, 56.01s/it]
Task 2, Epoch 9/20 => Loss 0.102, Train_accy 96.55:  45%|████▌     | 9/20 [08:24<10:09, 55.45s/it]
Task 2, Epoch 10/20 => Loss 0.098, Train_accy 96.71, Test_accy 95.10:  45%|████▌     | 9/20 [09:35<10:09, 55.45s/it]
Task 2, Epoch 10/20 => Loss 0.098, Train_accy 96.71, Test_accy 95.10:  50%|█████     | 10/20 [09:35<10:02, 60.25s/it]
Task 2, Epoch 11/20 => Loss 0.091, Train_accy 97.10:  50%|█████     | 10/20 [10:29<10:02, 60.25s/it]                 
Task 2, Epoch 11/20 => Loss 0.091, Train_accy 97.10:  55%|█████▌    | 11/20 [10:29<08:45, 58.44s/it]
Task 2, Epoch 12/20 => Loss 0.088, Train_accy 97.26:  55%|█████▌    | 11/20 [11:24<08:45, 58.44s/it]
Task 2, Epoch 12/20 => Loss 0.088, Train_accy 97.26:  60%|██████    | 12/20 [11:24<07:37, 57.21s/it]
Task 2, Epoch 13/20 => Loss 0.088, Train_accy 96.81:  60%|██████    | 12/20 [12:18<07:37, 57.21s/it]
Task 2, Epoch 13/20 => Loss 0.088, Train_accy 96.81:  65%|██████▌   | 13/20 [12:18<06:33, 56.24s/it]
Task 2, Epoch 14/20 => Loss 0.098, Train_accy 97.00:  65%|██████▌   | 13/20 [13:12<06:33, 56.24s/it]
Task 2, Epoch 14/20 => Loss 0.098, Train_accy 97.00:  70%|███████   | 14/20 [13:12<05:33, 55.67s/it]
Task 2, Epoch 15/20 => Loss 0.083, Train_accy 97.22, Test_accy 94.80:  70%|███████   | 14/20 [14:23<05:33, 55.67s/it]
Task 2, Epoch 15/20 => Loss 0.083, Train_accy 97.22, Test_accy 94.80:  75%|███████▌  | 15/20 [14:23<05:01, 60.38s/it]
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.08:  75%|███████▌  | 15/20 [15:17<05:01, 60.38s/it]                 
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.08:  80%|████████  | 16/20 [15:17<03:54, 58.52s/it]
Task 2, Epoch 17/20 => Loss 0.086, Train_accy 97.20:  80%|████████  | 16/20 [16:12<03:54, 58.52s/it]
Task 2, Epoch 17/20 => Loss 0.086, Train_accy 97.20:  85%|████████▌ | 17/20 [16:12<02:51, 57.29s/it]
Task 2, Epoch 18/20 => Loss 0.092, Train_accy 97.14:  85%|████████▌ | 17/20 [17:06<02:51, 57.29s/it]
Task 2, Epoch 18/20 => Loss 0.092, Train_accy 97.14:  90%|█████████ | 18/20 [17:06<01:52, 56.40s/it]
Task 2, Epoch 19/20 => Loss 0.103, Train_accy 96.59:  90%|█████████ | 18/20 [18:01<01:52, 56.40s/it]
Task 2, Epoch 19/20 => Loss 0.103, Train_accy 96.59:  95%|█████████▌| 19/20 [18:01<00:55, 55.77s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 97.28, Test_accy 95.03:  95%|█████████▌| 19/20 [19:12<00:55, 55.77s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 97.28, Test_accy 95.03: 100%|██████████| 20/20 [19:12<00:00, 60.45s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 97.28, Test_accy 95.03: 100%|██████████| 20/20 [19:12<00:00, 57.62s/it]
2024-09-03 19:43:14,470 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.087, Train_accy 97.28, Test_accy 95.03
2024-09-03 19:43:31,305 [trainer.py] => No NME accuracy.
2024-09-03 19:43:31,305 [trainer.py] => CNN: {'total': 95.03, '00-09': 96.4, '10-19': 93.3, '20-29': 95.4, 'old': 94.85, 'new': 95.4}
2024-09-03 19:43:31,305 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03]
2024-09-03 19:43:31,306 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6]

Average Accuracy (CNN): 96.59
2024-09-03 19:43:31,306 [trainer.py] => Average Accuracy (CNN): 96.59 

2024-09-03 19:43:31,307 [trainer.py] => All params: 89715556
2024-09-03 19:43:31,308 [trainer.py] => Trainable params: 89715556
2024-09-03 19:43:31,998 [coda_prompt.py] => Learning on 30-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.429, Train_accy 86.32:   0%|          | 0/20 [00:54<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.429, Train_accy 86.32:   5%|▌         | 1/20 [00:54<17:14, 54.44s/it]
Task 3, Epoch 2/20 => Loss 0.222, Train_accy 92.25:   5%|▌         | 1/20 [01:48<17:14, 54.44s/it]
Task 3, Epoch 2/20 => Loss 0.222, Train_accy 92.25:  10%|█         | 2/20 [01:48<16:18, 54.35s/it]
Task 3, Epoch 3/20 => Loss 0.191, Train_accy 93.37:  10%|█         | 2/20 [02:43<16:18, 54.35s/it]
Task 3, Epoch 3/20 => Loss 0.191, Train_accy 93.37:  15%|█▌        | 3/20 [02:43<15:23, 54.32s/it]
Task 3, Epoch 4/20 => Loss 0.167, Train_accy 94.09:  15%|█▌        | 3/20 [03:37<15:23, 54.32s/it]
Task 3, Epoch 4/20 => Loss 0.167, Train_accy 94.09:  20%|██        | 4/20 [03:37<14:28, 54.28s/it]
Task 3, Epoch 5/20 => Loss 0.185, Train_accy 93.73, Test_accy 91.85:  20%|██        | 4/20 [04:53<14:28, 54.28s/it]
Task 3, Epoch 5/20 => Loss 0.185, Train_accy 93.73, Test_accy 91.85:  25%|██▌       | 5/20 [04:53<15:35, 62.37s/it]
Task 3, Epoch 6/20 => Loss 0.170, Train_accy 93.77:  25%|██▌       | 5/20 [05:47<15:35, 62.37s/it]                 
Task 3, Epoch 6/20 => Loss 0.170, Train_accy 93.77:  30%|███       | 6/20 [05:47<13:52, 59.49s/it]
Task 3, Epoch 7/20 => Loss 0.162, Train_accy 94.21:  30%|███       | 6/20 [06:42<13:52, 59.49s/it]
Task 3, Epoch 7/20 => Loss 0.162, Train_accy 94.21:  35%|███▌      | 7/20 [06:42<12:32, 57.85s/it]
Task 3, Epoch 8/20 => Loss 0.162, Train_accy 94.47:  35%|███▌      | 7/20 [07:36<12:32, 57.85s/it]
Task 3, Epoch 8/20 => Loss 0.162, Train_accy 94.47:  40%|████      | 8/20 [07:36<11:20, 56.69s/it]
Task 3, Epoch 9/20 => Loss 0.146, Train_accy 95.35:  40%|████      | 8/20 [08:31<11:20, 56.69s/it]
Task 3, Epoch 9/20 => Loss 0.146, Train_accy 95.35:  45%|████▌     | 9/20 [08:31<10:16, 56.06s/it]
Task 3, Epoch 10/20 => Loss 0.137, Train_accy 95.49, Test_accy 93.00:  45%|████▌     | 9/20 [09:47<10:16, 56.06s/it]
Task 3, Epoch 10/20 => Loss 0.137, Train_accy 95.49, Test_accy 93.00:  50%|█████     | 10/20 [09:47<10:24, 62.42s/it]
Task 3, Epoch 11/20 => Loss 0.148, Train_accy 94.99:  50%|█████     | 10/20 [10:42<10:24, 62.42s/it]                 
Task 3, Epoch 11/20 => Loss 0.148, Train_accy 94.99:  55%|█████▌    | 11/20 [10:42<08:59, 59.94s/it]
Task 3, Epoch 12/20 => Loss 0.145, Train_accy 94.99:  55%|█████▌    | 11/20 [11:36<08:59, 59.94s/it]
Task 3, Epoch 12/20 => Loss 0.145, Train_accy 94.99:  60%|██████    | 12/20 [11:36<07:45, 58.21s/it]
Task 3, Epoch 13/20 => Loss 0.148, Train_accy 94.87:  60%|██████    | 12/20 [12:30<07:45, 58.21s/it]
Task 3, Epoch 13/20 => Loss 0.148, Train_accy 94.87:  65%|██████▌   | 13/20 [12:30<06:39, 57.08s/it]
Task 3, Epoch 14/20 => Loss 0.138, Train_accy 95.21:  65%|██████▌   | 13/20 [13:25<06:39, 57.08s/it]
Task 3, Epoch 14/20 => Loss 0.138, Train_accy 95.21:  70%|███████   | 14/20 [13:25<05:37, 56.23s/it]
Task 3, Epoch 15/20 => Loss 0.135, Train_accy 95.65, Test_accy 92.95:  70%|███████   | 14/20 [14:42<05:37, 56.23s/it]
Task 3, Epoch 15/20 => Loss 0.135, Train_accy 95.65, Test_accy 92.95:  75%|███████▌  | 15/20 [14:42<05:12, 62.44s/it]
Task 3, Epoch 16/20 => Loss 0.144, Train_accy 95.03:  75%|███████▌  | 15/20 [15:36<05:12, 62.44s/it]                 
Task 3, Epoch 16/20 => Loss 0.144, Train_accy 95.03:  80%|████████  | 16/20 [15:36<04:00, 60.03s/it]
Task 3, Epoch 17/20 => Loss 0.130, Train_accy 95.55:  80%|████████  | 16/20 [16:30<04:00, 60.03s/it]
Task 3, Epoch 17/20 => Loss 0.130, Train_accy 95.55:  85%|████████▌ | 17/20 [16:30<02:54, 58.29s/it]
Task 3, Epoch 18/20 => Loss 0.130, Train_accy 95.51:  85%|████████▌ | 17/20 [17:24<02:54, 58.29s/it]
Task 3, Epoch 18/20 => Loss 0.130, Train_accy 95.51:  90%|█████████ | 18/20 [17:24<01:54, 57.07s/it]
Task 3, Epoch 19/20 => Loss 0.137, Train_accy 95.37:  90%|█████████ | 18/20 [18:19<01:54, 57.07s/it]
Task 3, Epoch 19/20 => Loss 0.137, Train_accy 95.37:  95%|█████████▌| 19/20 [18:19<00:56, 56.25s/it]
Task 3, Epoch 20/20 => Loss 0.138, Train_accy 95.21, Test_accy 92.98:  95%|█████████▌| 19/20 [19:36<00:56, 56.25s/it]
Task 3, Epoch 20/20 => Loss 0.138, Train_accy 95.21, Test_accy 92.98: 100%|██████████| 20/20 [19:36<00:00, 62.49s/it]
Task 3, Epoch 20/20 => Loss 0.138, Train_accy 95.21, Test_accy 92.98: 100%|██████████| 20/20 [19:36<00:00, 58.81s/it]
2024-09-03 20:03:08,324 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.138, Train_accy 95.21, Test_accy 92.98
2024-09-03 20:03:30,771 [trainer.py] => No NME accuracy.
2024-09-03 20:03:30,772 [trainer.py] => CNN: {'total': 92.98, '00-09': 96.2, '10-19': 92.0, '20-29': 93.2, '30-39': 90.5, 'old': 93.8, 'new': 90.5}
2024-09-03 20:03:30,772 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98]
2024-09-03 20:03:30,772 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3]

Average Accuracy (CNN): 95.69
2024-09-03 20:03:30,773 [trainer.py] => Average Accuracy (CNN): 95.69 

2024-09-03 20:03:30,774 [trainer.py] => All params: 89715556
2024-09-03 20:03:30,775 [trainer.py] => Trainable params: 89715556
2024-09-03 20:03:31,736 [coda_prompt.py] => Learning on 40-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.362, Train_accy 89.06:   0%|          | 0/20 [00:54<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.362, Train_accy 89.06:   5%|▌         | 1/20 [00:54<17:14, 54.45s/it]
Task 4, Epoch 2/20 => Loss 0.138, Train_accy 95.83:   5%|▌         | 1/20 [01:48<17:14, 54.45s/it]
Task 4, Epoch 2/20 => Loss 0.138, Train_accy 95.83:  10%|█         | 2/20 [01:48<16:20, 54.45s/it]
Task 4, Epoch 3/20 => Loss 0.134, Train_accy 95.73:  10%|█         | 2/20 [02:43<16:20, 54.45s/it]
Task 4, Epoch 3/20 => Loss 0.134, Train_accy 95.73:  15%|█▌        | 3/20 [02:43<15:26, 54.51s/it]
Task 4, Epoch 4/20 => Loss 0.140, Train_accy 95.53:  15%|█▌        | 3/20 [03:37<15:26, 54.51s/it]
Task 4, Epoch 4/20 => Loss 0.140, Train_accy 95.53:  20%|██        | 4/20 [03:37<14:31, 54.46s/it]
Task 4, Epoch 5/20 => Loss 0.118, Train_accy 96.17, Test_accy 90.44:  20%|██        | 4/20 [05:00<14:31, 54.46s/it]
Task 4, Epoch 5/20 => Loss 0.118, Train_accy 96.17, Test_accy 90.44:  25%|██▌       | 5/20 [05:00<16:09, 64.62s/it]
Task 4, Epoch 6/20 => Loss 0.117, Train_accy 96.17:  25%|██▌       | 5/20 [05:54<16:09, 64.62s/it]                 
Task 4, Epoch 6/20 => Loss 0.117, Train_accy 96.17:  30%|███       | 6/20 [05:54<14:16, 61.18s/it]
Task 4, Epoch 7/20 => Loss 0.108, Train_accy 96.39:  30%|███       | 6/20 [06:49<14:16, 61.18s/it]
Task 4, Epoch 7/20 => Loss 0.108, Train_accy 96.39:  35%|███▌      | 7/20 [06:49<12:47, 59.06s/it]
Task 4, Epoch 8/20 => Loss 0.114, Train_accy 96.53:  35%|███▌      | 7/20 [07:43<12:47, 59.06s/it]
Task 4, Epoch 8/20 => Loss 0.114, Train_accy 96.53:  40%|████      | 8/20 [07:43<11:30, 57.52s/it]
Task 4, Epoch 9/20 => Loss 0.107, Train_accy 96.65:  40%|████      | 8/20 [08:38<11:30, 57.52s/it]
Task 4, Epoch 9/20 => Loss 0.107, Train_accy 96.65:  45%|████▌     | 9/20 [08:38<10:22, 56.59s/it]
Task 4, Epoch 10/20 => Loss 0.108, Train_accy 96.43, Test_accy 90.98:  45%|████▌     | 9/20 [10:01<10:22, 56.59s/it]
Task 4, Epoch 10/20 => Loss 0.108, Train_accy 96.43, Test_accy 90.98:  50%|█████     | 10/20 [10:01<10:46, 64.66s/it]
Task 4, Epoch 11/20 => Loss 0.108, Train_accy 96.35:  50%|█████     | 10/20 [10:55<10:46, 64.66s/it]                 
Task 4, Epoch 11/20 => Loss 0.108, Train_accy 96.35:  55%|█████▌    | 11/20 [10:55<09:13, 61.49s/it]
Task 4, Epoch 12/20 => Loss 0.098, Train_accy 96.81:  55%|█████▌    | 11/20 [11:49<09:13, 61.49s/it]
Task 4, Epoch 12/20 => Loss 0.098, Train_accy 96.81:  60%|██████    | 12/20 [11:49<07:54, 59.30s/it]
Task 4, Epoch 13/20 => Loss 0.097, Train_accy 97.02:  60%|██████    | 12/20 [12:44<07:54, 59.30s/it]
Task 4, Epoch 13/20 => Loss 0.097, Train_accy 97.02:  65%|██████▌   | 13/20 [12:44<06:44, 57.79s/it]
Task 4, Epoch 14/20 => Loss 0.104, Train_accy 96.69:  65%|██████▌   | 13/20 [13:38<06:44, 57.79s/it]
Task 4, Epoch 14/20 => Loss 0.104, Train_accy 96.69:  70%|███████   | 14/20 [13:38<05:39, 56.65s/it]
Task 4, Epoch 15/20 => Loss 0.099, Train_accy 96.59, Test_accy 91.26:  70%|███████   | 14/20 [15:00<05:39, 56.65s/it]
Task 4, Epoch 15/20 => Loss 0.099, Train_accy 96.59, Test_accy 91.26:  75%|███████▌  | 15/20 [15:00<05:21, 64.38s/it]
Task 4, Epoch 16/20 => Loss 0.107, Train_accy 96.49:  75%|███████▌  | 15/20 [15:54<05:21, 64.38s/it]                 
Task 4, Epoch 16/20 => Loss 0.107, Train_accy 96.49:  80%|████████  | 16/20 [15:54<04:05, 61.41s/it]
Task 4, Epoch 17/20 => Loss 0.103, Train_accy 96.73:  80%|████████  | 16/20 [16:49<04:05, 61.41s/it]
Task 4, Epoch 17/20 => Loss 0.103, Train_accy 96.73:  85%|████████▌ | 17/20 [16:49<02:57, 59.25s/it]
Task 4, Epoch 18/20 => Loss 0.083, Train_accy 97.28:  85%|████████▌ | 17/20 [17:43<02:57, 59.25s/it]
Task 4, Epoch 18/20 => Loss 0.083, Train_accy 97.28:  90%|█████████ | 18/20 [17:43<01:55, 57.72s/it]
Task 4, Epoch 19/20 => Loss 0.083, Train_accy 97.28:  90%|█████████ | 18/20 [18:37<01:55, 57.72s/it]
Task 4, Epoch 19/20 => Loss 0.083, Train_accy 97.28:  95%|█████████▌| 19/20 [18:37<00:56, 56.74s/it]
Task 4, Epoch 20/20 => Loss 0.086, Train_accy 97.12, Test_accy 91.32:  95%|█████████▌| 19/20 [20:00<00:56, 56.74s/it]
Task 4, Epoch 20/20 => Loss 0.086, Train_accy 97.12, Test_accy 91.32: 100%|██████████| 20/20 [20:00<00:00, 64.48s/it]
Task 4, Epoch 20/20 => Loss 0.086, Train_accy 97.12, Test_accy 91.32: 100%|██████████| 20/20 [20:00<00:00, 60.01s/it]
2024-09-03 20:23:32,051 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.086, Train_accy 97.12, Test_accy 91.32
2024-09-03 20:24:00,058 [trainer.py] => No NME accuracy.
2024-09-03 20:24:00,059 [trainer.py] => CNN: {'total': 91.32, '00-09': 95.8, '10-19': 90.1, '20-29': 92.3, '30-39': 89.0, '40-49': 89.4, 'old': 91.8, 'new': 89.4}
2024-09-03 20:24:00,059 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32]
2024-09-03 20:24:00,059 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24]

Average Accuracy (CNN): 94.82
2024-09-03 20:24:00,059 [trainer.py] => Average Accuracy (CNN): 94.82 

2024-09-03 20:24:00,061 [trainer.py] => All params: 89715556
2024-09-03 20:24:00,062 [trainer.py] => Trainable params: 89715556
2024-09-03 20:24:01,170 [coda_prompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.453, Train_accy 85.52:   0%|          | 0/20 [00:54<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.453, Train_accy 85.52:   5%|▌         | 1/20 [00:54<17:11, 54.30s/it]
Task 5, Epoch 2/20 => Loss 0.194, Train_accy 93.19:   5%|▌         | 1/20 [01:48<17:11, 54.30s/it]
Task 5, Epoch 2/20 => Loss 0.194, Train_accy 93.19:  10%|█         | 2/20 [01:48<16:15, 54.20s/it]
Task 5, Epoch 3/20 => Loss 0.173, Train_accy 93.87:  10%|█         | 2/20 [02:42<16:15, 54.20s/it]
Task 5, Epoch 3/20 => Loss 0.173, Train_accy 93.87:  15%|█▌        | 3/20 [02:42<15:23, 54.32s/it]
Task 5, Epoch 4/20 => Loss 0.168, Train_accy 94.41:  15%|█▌        | 3/20 [03:37<15:23, 54.32s/it]
Task 5, Epoch 4/20 => Loss 0.168, Train_accy 94.41:  20%|██        | 4/20 [03:37<14:31, 54.44s/it]
Task 5, Epoch 5/20 => Loss 0.161, Train_accy 94.29, Test_accy 90.03:  20%|██        | 4/20 [05:05<14:31, 54.44s/it]
Task 5, Epoch 5/20 => Loss 0.161, Train_accy 94.29, Test_accy 90.03:  25%|██▌       | 5/20 [05:05<16:37, 66.53s/it]
Task 5, Epoch 6/20 => Loss 0.159, Train_accy 94.63:  25%|██▌       | 5/20 [06:00<16:37, 66.53s/it]                 
Task 5, Epoch 6/20 => Loss 0.159, Train_accy 94.63:  30%|███       | 6/20 [06:00<14:35, 62.53s/it]
Task 5, Epoch 7/20 => Loss 0.126, Train_accy 95.63:  30%|███       | 6/20 [06:54<14:35, 62.53s/it]
Task 5, Epoch 7/20 => Loss 0.126, Train_accy 95.63:  35%|███▌      | 7/20 [06:54<12:58, 59.89s/it]
Task 5, Epoch 8/20 => Loss 0.148, Train_accy 95.25:  35%|███▌      | 7/20 [07:48<12:58, 59.89s/it]
Task 5, Epoch 8/20 => Loss 0.148, Train_accy 95.25:  40%|████      | 8/20 [07:48<11:36, 58.02s/it]
Task 5, Epoch 9/20 => Loss 0.139, Train_accy 95.21:  40%|████      | 8/20 [08:42<11:36, 58.02s/it]
Task 5, Epoch 9/20 => Loss 0.139, Train_accy 95.21:  45%|████▌     | 9/20 [08:42<10:23, 56.70s/it]
Task 5, Epoch 10/20 => Loss 0.137, Train_accy 95.35, Test_accy 90.12:  45%|████▌     | 9/20 [10:09<10:23, 56.70s/it]
Task 5, Epoch 10/20 => Loss 0.137, Train_accy 95.35, Test_accy 90.12:  50%|█████     | 10/20 [10:09<11:01, 66.20s/it]
Task 5, Epoch 11/20 => Loss 0.136, Train_accy 95.33:  50%|█████     | 10/20 [11:04<11:01, 66.20s/it]                 
Task 5, Epoch 11/20 => Loss 0.136, Train_accy 95.33:  55%|█████▌    | 11/20 [11:04<09:23, 62.58s/it]
Task 5, Epoch 12/20 => Loss 0.136, Train_accy 95.23:  55%|█████▌    | 11/20 [11:58<09:23, 62.58s/it]
Task 5, Epoch 12/20 => Loss 0.136, Train_accy 95.23:  60%|██████    | 12/20 [11:58<07:59, 60.00s/it]
Task 5, Epoch 13/20 => Loss 0.135, Train_accy 95.75:  60%|██████    | 12/20 [12:52<07:59, 60.00s/it]
Task 5, Epoch 13/20 => Loss 0.135, Train_accy 95.75:  65%|██████▌   | 13/20 [12:52<06:48, 58.33s/it]
Task 5, Epoch 14/20 => Loss 0.133, Train_accy 95.43:  65%|██████▌   | 13/20 [13:47<06:48, 58.33s/it]
Task 5, Epoch 14/20 => Loss 0.133, Train_accy 95.43:  70%|███████   | 14/20 [13:47<05:42, 57.13s/it]
Task 5, Epoch 15/20 => Loss 0.141, Train_accy 94.89, Test_accy 90.30:  70%|███████   | 14/20 [15:15<05:42, 57.13s/it]
Task 5, Epoch 15/20 => Loss 0.141, Train_accy 94.89, Test_accy 90.30:  75%|███████▌  | 15/20 [15:15<05:31, 66.39s/it]
Task 5, Epoch 16/20 => Loss 0.132, Train_accy 95.47:  75%|███████▌  | 15/20 [16:09<05:31, 66.39s/it]                 
Task 5, Epoch 16/20 => Loss 0.132, Train_accy 95.47:  80%|████████  | 16/20 [16:09<04:10, 62.73s/it]
Task 5, Epoch 17/20 => Loss 0.124, Train_accy 95.69:  80%|████████  | 16/20 [17:03<04:10, 62.73s/it]
Task 5, Epoch 17/20 => Loss 0.124, Train_accy 95.69:  85%|████████▌ | 17/20 [17:03<03:00, 60.29s/it]
Task 5, Epoch 18/20 => Loss 0.117, Train_accy 96.01:  85%|████████▌ | 17/20 [17:58<03:00, 60.29s/it]
Task 5, Epoch 18/20 => Loss 0.117, Train_accy 96.01:  90%|█████████ | 18/20 [17:58<01:57, 58.53s/it]
Task 5, Epoch 19/20 => Loss 0.117, Train_accy 95.77:  90%|█████████ | 18/20 [18:52<01:57, 58.53s/it]
Task 5, Epoch 19/20 => Loss 0.117, Train_accy 95.77:  95%|█████████▌| 19/20 [18:52<00:57, 57.28s/it]
Task 5, Epoch 20/20 => Loss 0.113, Train_accy 96.49, Test_accy 90.22:  95%|█████████▌| 19/20 [20:20<00:57, 57.28s/it]
Task 5, Epoch 20/20 => Loss 0.113, Train_accy 96.49, Test_accy 90.22: 100%|██████████| 20/20 [20:20<00:00, 66.52s/it]
Task 5, Epoch 20/20 => Loss 0.113, Train_accy 96.49, Test_accy 90.22: 100%|██████████| 20/20 [20:20<00:00, 61.04s/it]
2024-09-03 20:44:22,064 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.113, Train_accy 96.49, Test_accy 90.22
2024-09-03 20:44:55,853 [trainer.py] => No NME accuracy.
2024-09-03 20:44:55,854 [trainer.py] => CNN: {'total': 90.22, '00-09': 93.3, '10-19': 90.0, '20-29': 91.0, '30-39': 87.8, '40-49': 87.7, '50-59': 91.5, 'old': 89.96, 'new': 91.5}
2024-09-03 20:44:55,854 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22]
2024-09-03 20:44:55,854 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1]

Average Accuracy (CNN): 94.05
2024-09-03 20:44:55,854 [trainer.py] => Average Accuracy (CNN): 94.05 

2024-09-03 20:44:55,855 [trainer.py] => All params: 89715556
2024-09-03 20:44:55,857 [trainer.py] => Trainable params: 89715556
2024-09-03 20:44:57,251 [coda_prompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.321, Train_accy 89.80:   0%|          | 0/20 [00:54<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.321, Train_accy 89.80:   5%|▌         | 1/20 [00:54<17:11, 54.31s/it]
Task 6, Epoch 2/20 => Loss 0.132, Train_accy 95.59:   5%|▌         | 1/20 [01:48<17:11, 54.31s/it]
Task 6, Epoch 2/20 => Loss 0.132, Train_accy 95.59:  10%|█         | 2/20 [01:48<16:19, 54.42s/it]
Task 6, Epoch 3/20 => Loss 0.125, Train_accy 95.75:  10%|█         | 2/20 [02:43<16:19, 54.42s/it]
Task 6, Epoch 3/20 => Loss 0.125, Train_accy 95.75:  15%|█▌        | 3/20 [02:43<15:24, 54.38s/it]
Task 6, Epoch 4/20 => Loss 0.129, Train_accy 95.91:  15%|█▌        | 3/20 [03:37<15:24, 54.38s/it]
Task 6, Epoch 4/20 => Loss 0.129, Train_accy 95.91:  20%|██        | 4/20 [03:37<14:30, 54.39s/it]
Task 6, Epoch 5/20 => Loss 0.111, Train_accy 96.21, Test_accy 89.26:  20%|██        | 4/20 [05:10<14:30, 54.39s/it]
Task 6, Epoch 5/20 => Loss 0.111, Train_accy 96.21, Test_accy 89.26:  25%|██▌       | 5/20 [05:10<17:05, 68.39s/it]
Task 6, Epoch 6/20 => Loss 0.102, Train_accy 96.59:  25%|██▌       | 5/20 [06:05<17:05, 68.39s/it]                 
Task 6, Epoch 6/20 => Loss 0.102, Train_accy 96.59:  30%|███       | 6/20 [06:05<14:51, 63.65s/it]
Task 6, Epoch 7/20 => Loss 0.103, Train_accy 96.51:  30%|███       | 6/20 [06:59<14:51, 63.65s/it]
Task 6, Epoch 7/20 => Loss 0.103, Train_accy 96.51:  35%|███▌      | 7/20 [06:59<13:06, 60.52s/it]
Task 6, Epoch 8/20 => Loss 0.098, Train_accy 96.85:  35%|███▌      | 7/20 [07:53<13:06, 60.52s/it]
Task 6, Epoch 8/20 => Loss 0.098, Train_accy 96.85:  40%|████      | 8/20 [07:53<11:42, 58.58s/it]
Task 6, Epoch 9/20 => Loss 0.109, Train_accy 96.31:  40%|████      | 8/20 [08:48<11:42, 58.58s/it]
Task 6, Epoch 9/20 => Loss 0.109, Train_accy 96.31:  45%|████▌     | 9/20 [08:48<10:30, 57.28s/it]
Task 6, Epoch 10/20 => Loss 0.108, Train_accy 96.23, Test_accy 89.56:  45%|████▌     | 9/20 [10:21<10:30, 57.28s/it]
Task 6, Epoch 10/20 => Loss 0.108, Train_accy 96.23, Test_accy 89.56:  50%|█████     | 10/20 [10:21<11:24, 68.47s/it]
Task 6, Epoch 11/20 => Loss 0.097, Train_accy 96.77:  50%|█████     | 10/20 [11:15<11:24, 68.47s/it]                 
Task 6, Epoch 11/20 => Loss 0.097, Train_accy 96.77:  55%|█████▌    | 11/20 [11:15<09:36, 64.10s/it]
Task 6, Epoch 12/20 => Loss 0.088, Train_accy 97.30:  55%|█████▌    | 11/20 [12:10<09:36, 64.10s/it]
Task 6, Epoch 12/20 => Loss 0.088, Train_accy 97.30:  60%|██████    | 12/20 [12:10<08:09, 61.19s/it]
Task 6, Epoch 13/20 => Loss 0.095, Train_accy 96.73:  60%|██████    | 12/20 [13:04<08:09, 61.19s/it]
Task 6, Epoch 13/20 => Loss 0.095, Train_accy 96.73:  65%|██████▌   | 13/20 [13:04<06:53, 59.13s/it]
Task 6, Epoch 14/20 => Loss 0.095, Train_accy 96.77:  65%|██████▌   | 13/20 [13:59<06:53, 59.13s/it]
Task 6, Epoch 14/20 => Loss 0.095, Train_accy 96.77:  70%|███████   | 14/20 [13:59<05:46, 57.68s/it]
Task 6, Epoch 15/20 => Loss 0.100, Train_accy 96.75, Test_accy 89.36:  70%|███████   | 14/20 [15:32<05:46, 57.68s/it]
Task 6, Epoch 15/20 => Loss 0.100, Train_accy 96.75, Test_accy 89.36:  75%|███████▌  | 15/20 [15:32<05:42, 68.47s/it]
Task 6, Epoch 16/20 => Loss 0.094, Train_accy 97.00:  75%|███████▌  | 15/20 [16:27<05:42, 68.47s/it]                 
Task 6, Epoch 16/20 => Loss 0.094, Train_accy 97.00:  80%|████████  | 16/20 [16:27<04:17, 64.36s/it]
Task 6, Epoch 17/20 => Loss 0.085, Train_accy 97.16:  80%|████████  | 16/20 [17:21<04:17, 64.36s/it]
Task 6, Epoch 17/20 => Loss 0.085, Train_accy 97.16:  85%|████████▌ | 17/20 [17:21<03:04, 61.40s/it]
Task 6, Epoch 18/20 => Loss 0.099, Train_accy 96.98:  85%|████████▌ | 17/20 [18:16<03:04, 61.40s/it]
Task 6, Epoch 18/20 => Loss 0.099, Train_accy 96.98:  90%|█████████ | 18/20 [18:16<01:58, 59.30s/it]
Task 6, Epoch 19/20 => Loss 0.090, Train_accy 96.94:  90%|█████████ | 18/20 [19:10<01:58, 59.30s/it]
Task 6, Epoch 19/20 => Loss 0.090, Train_accy 96.94:  95%|█████████▌| 19/20 [19:10<00:57, 57.85s/it]
Task 6, Epoch 20/20 => Loss 0.095, Train_accy 97.02, Test_accy 89.47:  95%|█████████▌| 19/20 [20:44<00:57, 57.85s/it]
Task 6, Epoch 20/20 => Loss 0.095, Train_accy 97.02, Test_accy 89.47: 100%|██████████| 20/20 [20:44<00:00, 68.56s/it]
Task 6, Epoch 20/20 => Loss 0.095, Train_accy 97.02, Test_accy 89.47: 100%|██████████| 20/20 [20:44<00:00, 62.22s/it]
2024-09-03 21:05:41,606 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.095, Train_accy 97.02, Test_accy 89.47
2024-09-03 21:06:20,596 [trainer.py] => No NME accuracy.
2024-09-03 21:06:20,597 [trainer.py] => CNN: {'total': 89.47, '00-09': 92.9, '10-19': 87.4, '20-29': 89.8, '30-39': 87.7, '40-49': 87.0, '50-59': 87.7, '60-69': 93.8, 'old': 88.75, 'new': 93.8}
2024-09-03 21:06:20,597 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22, 89.47]
2024-09-03 21:06:20,597 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1, 98.97]

Average Accuracy (CNN): 93.4
2024-09-03 21:06:20,597 [trainer.py] => Average Accuracy (CNN): 93.4 

2024-09-03 21:06:20,598 [trainer.py] => All params: 89715556
2024-09-03 21:06:20,599 [trainer.py] => Trainable params: 89715556
2024-09-03 21:06:22,091 [coda_prompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.421, Train_accy 86.88:   0%|          | 0/20 [00:54<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.421, Train_accy 86.88:   5%|▌         | 1/20 [00:54<17:18, 54.66s/it]
Task 7, Epoch 2/20 => Loss 0.194, Train_accy 93.33:   5%|▌         | 1/20 [01:49<17:18, 54.66s/it]
Task 7, Epoch 2/20 => Loss 0.194, Train_accy 93.33:  10%|█         | 2/20 [01:49<16:22, 54.59s/it]
Task 7, Epoch 3/20 => Loss 0.192, Train_accy 93.47:  10%|█         | 2/20 [02:43<16:22, 54.59s/it]
Task 7, Epoch 3/20 => Loss 0.192, Train_accy 93.47:  15%|█▌        | 3/20 [02:43<15:26, 54.48s/it]
Task 7, Epoch 4/20 => Loss 0.176, Train_accy 93.97:  15%|█▌        | 3/20 [03:38<15:26, 54.48s/it]
Task 7, Epoch 4/20 => Loss 0.176, Train_accy 93.97:  20%|██        | 4/20 [03:38<14:32, 54.56s/it]
Task 7, Epoch 5/20 => Loss 0.149, Train_accy 94.89, Test_accy 87.04:  20%|██        | 4/20 [05:17<14:32, 54.56s/it]
Task 7, Epoch 5/20 => Loss 0.149, Train_accy 94.89, Test_accy 87.04:  25%|██▌       | 5/20 [05:17<17:39, 70.65s/it]
Task 7, Epoch 6/20 => Loss 0.143, Train_accy 95.17:  25%|██▌       | 5/20 [06:11<17:39, 70.65s/it]                 
Task 7, Epoch 6/20 => Loss 0.143, Train_accy 95.17:  30%|███       | 6/20 [06:11<15:12, 65.18s/it]
Task 7, Epoch 7/20 => Loss 0.139, Train_accy 95.23:  30%|███       | 6/20 [07:06<15:12, 65.18s/it]
Task 7, Epoch 7/20 => Loss 0.139, Train_accy 95.23:  35%|███▌      | 7/20 [07:06<13:21, 61.66s/it]
Task 7, Epoch 8/20 => Loss 0.148, Train_accy 94.97:  35%|███▌      | 7/20 [08:00<13:21, 61.66s/it]
Task 7, Epoch 8/20 => Loss 0.148, Train_accy 94.97:  40%|████      | 8/20 [08:00<11:52, 59.39s/it]
Task 7, Epoch 9/20 => Loss 0.135, Train_accy 95.41:  40%|████      | 8/20 [08:55<11:52, 59.39s/it]
Task 7, Epoch 9/20 => Loss 0.135, Train_accy 95.41:  45%|████▌     | 9/20 [08:55<10:35, 57.75s/it]
Task 7, Epoch 10/20 => Loss 0.124, Train_accy 95.65, Test_accy 87.82:  45%|████▌     | 9/20 [10:34<10:35, 57.75s/it]
Task 7, Epoch 10/20 => Loss 0.124, Train_accy 95.65, Test_accy 87.82:  50%|█████     | 10/20 [10:34<11:46, 70.62s/it]
Task 7, Epoch 11/20 => Loss 0.127, Train_accy 95.69:  50%|█████     | 10/20 [11:29<11:46, 70.62s/it]                 
Task 7, Epoch 11/20 => Loss 0.127, Train_accy 95.69:  55%|█████▌    | 11/20 [11:29<09:51, 65.72s/it]
Task 7, Epoch 12/20 => Loss 0.127, Train_accy 95.79:  55%|█████▌    | 11/20 [12:23<09:51, 65.72s/it]
Task 7, Epoch 12/20 => Loss 0.127, Train_accy 95.79:  60%|██████    | 12/20 [12:23<08:18, 62.32s/it]
Task 7, Epoch 13/20 => Loss 0.115, Train_accy 96.23:  60%|██████    | 12/20 [13:18<08:18, 62.32s/it]
Task 7, Epoch 13/20 => Loss 0.115, Train_accy 96.23:  65%|██████▌   | 13/20 [13:18<06:59, 59.93s/it]
Task 7, Epoch 14/20 => Loss 0.125, Train_accy 95.73:  65%|██████▌   | 13/20 [14:12<06:59, 59.93s/it]
Task 7, Epoch 14/20 => Loss 0.125, Train_accy 95.73:  70%|███████   | 14/20 [14:12<05:50, 58.34s/it]
Task 7, Epoch 15/20 => Loss 0.108, Train_accy 96.03, Test_accy 87.91:  70%|███████   | 14/20 [15:51<05:50, 58.34s/it]
Task 7, Epoch 15/20 => Loss 0.108, Train_accy 96.03, Test_accy 87.91:  75%|███████▌  | 15/20 [15:51<05:53, 70.61s/it]
Task 7, Epoch 16/20 => Loss 0.119, Train_accy 95.91:  75%|███████▌  | 15/20 [16:46<05:53, 70.61s/it]                 
Task 7, Epoch 16/20 => Loss 0.119, Train_accy 95.91:  80%|████████  | 16/20 [16:46<04:23, 65.83s/it]
Task 7, Epoch 17/20 => Loss 0.119, Train_accy 95.91:  80%|████████  | 16/20 [17:40<04:23, 65.83s/it]
Task 7, Epoch 17/20 => Loss 0.119, Train_accy 95.91:  85%|████████▌ | 17/20 [17:40<03:07, 62.41s/it]
Task 7, Epoch 18/20 => Loss 0.120, Train_accy 95.75:  85%|████████▌ | 17/20 [18:35<03:07, 62.41s/it]
Task 7, Epoch 18/20 => Loss 0.120, Train_accy 95.75:  90%|█████████ | 18/20 [18:35<02:00, 60.11s/it]
Task 7, Epoch 19/20 => Loss 0.109, Train_accy 96.11:  90%|█████████ | 18/20 [19:30<02:00, 60.11s/it]
Task 7, Epoch 19/20 => Loss 0.109, Train_accy 96.11:  95%|█████████▌| 19/20 [19:30<00:58, 58.46s/it]
Task 7, Epoch 20/20 => Loss 0.121, Train_accy 95.61, Test_accy 88.04:  95%|█████████▌| 19/20 [21:09<00:58, 58.46s/it]
Task 7, Epoch 20/20 => Loss 0.121, Train_accy 95.61, Test_accy 88.04: 100%|██████████| 20/20 [21:09<00:00, 70.75s/it]
Task 7, Epoch 20/20 => Loss 0.121, Train_accy 95.61, Test_accy 88.04: 100%|██████████| 20/20 [21:09<00:00, 63.49s/it]
2024-09-03 21:27:31,873 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.121, Train_accy 95.61, Test_accy 88.04
2024-09-03 21:28:16,639 [trainer.py] => No NME accuracy.
2024-09-03 21:28:16,639 [trainer.py] => CNN: {'total': 88.04, '00-09': 92.5, '10-19': 87.1, '20-29': 90.5, '30-39': 88.7, '40-49': 84.9, '50-59': 86.6, '60-69': 93.2, '70-79': 80.8, 'old': 89.07, 'new': 80.8}
2024-09-03 21:28:16,639 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22, 89.47, 88.04]
2024-09-03 21:28:16,640 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1, 98.97, 98.95]

Average Accuracy (CNN): 92.73
2024-09-03 21:28:16,640 [trainer.py] => Average Accuracy (CNN): 92.73 

2024-09-03 21:28:16,641 [trainer.py] => All params: 89715556
2024-09-03 21:28:16,642 [trainer.py] => Trainable params: 89715556
2024-09-03 21:28:18,343 [coda_prompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.426, Train_accy 86.70:   0%|          | 0/20 [00:54<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.426, Train_accy 86.70:   5%|▌         | 1/20 [00:54<17:22, 54.88s/it]
Task 8, Epoch 2/20 => Loss 0.187, Train_accy 94.05:   5%|▌         | 1/20 [01:49<17:22, 54.88s/it]
Task 8, Epoch 2/20 => Loss 0.187, Train_accy 94.05:  10%|█         | 2/20 [01:49<16:24, 54.70s/it]
Task 8, Epoch 3/20 => Loss 0.163, Train_accy 94.55:  10%|█         | 2/20 [02:43<16:24, 54.70s/it]
Task 8, Epoch 3/20 => Loss 0.163, Train_accy 94.55:  15%|█▌        | 3/20 [02:43<15:27, 54.55s/it]
Task 8, Epoch 4/20 => Loss 0.146, Train_accy 95.09:  15%|█▌        | 3/20 [03:38<15:27, 54.55s/it]
Task 8, Epoch 4/20 => Loss 0.146, Train_accy 95.09:  20%|██        | 4/20 [03:38<14:34, 54.67s/it]
Task 8, Epoch 5/20 => Loss 0.137, Train_accy 95.41, Test_accy 85.73:  20%|██        | 4/20 [05:23<14:34, 54.67s/it]
Task 8, Epoch 5/20 => Loss 0.137, Train_accy 95.41, Test_accy 85.73:  25%|██▌       | 5/20 [05:23<18:11, 72.76s/it]
Task 8, Epoch 6/20 => Loss 0.135, Train_accy 95.27:  25%|██▌       | 5/20 [06:18<18:11, 72.76s/it]                 
Task 8, Epoch 6/20 => Loss 0.135, Train_accy 95.27:  30%|███       | 6/20 [06:18<15:32, 66.57s/it]
Task 8, Epoch 7/20 => Loss 0.122, Train_accy 95.93:  30%|███       | 6/20 [07:12<15:32, 66.57s/it]
Task 8, Epoch 7/20 => Loss 0.122, Train_accy 95.93:  35%|███▌      | 7/20 [07:12<13:33, 62.60s/it]
Task 8, Epoch 8/20 => Loss 0.152, Train_accy 94.95:  35%|███▌      | 7/20 [08:07<13:33, 62.60s/it]
Task 8, Epoch 8/20 => Loss 0.152, Train_accy 94.95:  40%|████      | 8/20 [08:07<12:00, 60.07s/it]
Task 8, Epoch 9/20 => Loss 0.134, Train_accy 95.43:  40%|████      | 8/20 [09:01<12:00, 60.07s/it]
Task 8, Epoch 9/20 => Loss 0.134, Train_accy 95.43:  45%|████▌     | 9/20 [09:01<10:39, 58.15s/it]
Task 8, Epoch 10/20 => Loss 0.125, Train_accy 95.81, Test_accy 86.67:  45%|████▌     | 9/20 [10:46<10:39, 58.15s/it]
Task 8, Epoch 10/20 => Loss 0.125, Train_accy 95.81, Test_accy 86.67:  50%|█████     | 10/20 [10:46<12:05, 72.60s/it]
Task 8, Epoch 11/20 => Loss 0.115, Train_accy 96.27:  50%|█████     | 10/20 [11:40<12:05, 72.60s/it]                 
Task 8, Epoch 11/20 => Loss 0.115, Train_accy 96.27:  55%|█████▌    | 11/20 [11:40<10:03, 67.03s/it]
Task 8, Epoch 12/20 => Loss 0.136, Train_accy 95.37:  55%|█████▌    | 11/20 [12:35<10:03, 67.03s/it]
Task 8, Epoch 12/20 => Loss 0.136, Train_accy 95.37:  60%|██████    | 12/20 [12:35<08:26, 63.30s/it]
Task 8, Epoch 13/20 => Loss 0.120, Train_accy 95.93:  60%|██████    | 12/20 [13:29<08:26, 63.30s/it]
Task 8, Epoch 13/20 => Loss 0.120, Train_accy 95.93:  65%|██████▌   | 13/20 [13:29<07:04, 60.69s/it]
Task 8, Epoch 14/20 => Loss 0.124, Train_accy 95.55:  65%|██████▌   | 13/20 [14:24<07:04, 60.69s/it]
Task 8, Epoch 14/20 => Loss 0.124, Train_accy 95.55:  70%|███████   | 14/20 [14:24<05:53, 58.98s/it]
Task 8, Epoch 15/20 => Loss 0.116, Train_accy 96.13, Test_accy 86.66:  70%|███████   | 14/20 [16:10<05:53, 58.98s/it]
Task 8, Epoch 15/20 => Loss 0.116, Train_accy 96.13, Test_accy 86.66:  75%|███████▌  | 15/20 [16:10<06:05, 73.06s/it]
Task 8, Epoch 16/20 => Loss 0.112, Train_accy 96.39:  75%|███████▌  | 15/20 [17:05<06:05, 73.06s/it]                 
Task 8, Epoch 16/20 => Loss 0.112, Train_accy 96.39:  80%|████████  | 16/20 [17:05<04:30, 67.63s/it]
Task 8, Epoch 17/20 => Loss 0.106, Train_accy 96.71:  80%|████████  | 16/20 [18:00<04:30, 67.63s/it]
Task 8, Epoch 17/20 => Loss 0.106, Train_accy 96.71:  85%|████████▌ | 17/20 [18:00<03:11, 63.83s/it]
Task 8, Epoch 18/20 => Loss 0.108, Train_accy 96.39:  85%|████████▌ | 17/20 [18:55<03:11, 63.83s/it]
Task 8, Epoch 18/20 => Loss 0.108, Train_accy 96.39:  90%|█████████ | 18/20 [18:55<02:02, 61.16s/it]
Task 8, Epoch 19/20 => Loss 0.104, Train_accy 96.75:  90%|█████████ | 18/20 [19:50<02:02, 61.16s/it]
Task 8, Epoch 19/20 => Loss 0.104, Train_accy 96.75:  95%|█████████▌| 19/20 [19:50<00:59, 59.31s/it]
Task 8, Epoch 20/20 => Loss 0.113, Train_accy 96.47, Test_accy 86.56:  95%|█████████▌| 19/20 [21:36<00:59, 59.31s/it]
Task 8, Epoch 20/20 => Loss 0.113, Train_accy 96.47, Test_accy 86.56: 100%|██████████| 20/20 [21:36<00:00, 73.21s/it]
Task 8, Epoch 20/20 => Loss 0.113, Train_accy 96.47, Test_accy 86.56: 100%|██████████| 20/20 [21:36<00:00, 64.81s/it]
2024-09-03 21:49:54,533 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.113, Train_accy 96.47, Test_accy 86.56
2024-09-03 21:50:45,209 [trainer.py] => No NME accuracy.
2024-09-03 21:50:45,210 [trainer.py] => CNN: {'total': 86.56, '00-09': 92.6, '10-19': 85.9, '20-29': 90.0, '30-39': 87.6, '40-49': 84.9, '50-59': 85.6, '60-69': 92.3, '70-79': 79.8, '80-89': 80.3, 'old': 87.34, 'new': 80.3}
2024-09-03 21:50:45,210 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22, 89.47, 88.04, 86.56]
2024-09-03 21:50:45,210 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1, 98.97, 98.95, 98.67]

Average Accuracy (CNN): 92.04
2024-09-03 21:50:45,210 [trainer.py] => Average Accuracy (CNN): 92.04 

2024-09-03 21:50:45,211 [trainer.py] => All params: 89715556
2024-09-03 21:50:45,212 [trainer.py] => Trainable params: 89715556
2024-09-03 21:50:47,106 [coda_prompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.441, Train_accy 86.58:   0%|          | 0/20 [00:54<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.441, Train_accy 86.58:   5%|▌         | 1/20 [00:54<17:23, 54.94s/it]
Task 9, Epoch 2/20 => Loss 0.226, Train_accy 92.87:   5%|▌         | 1/20 [01:49<17:23, 54.94s/it]
Task 9, Epoch 2/20 => Loss 0.226, Train_accy 92.87:  10%|█         | 2/20 [01:49<16:29, 54.95s/it]
Task 9, Epoch 3/20 => Loss 0.196, Train_accy 93.31:  10%|█         | 2/20 [02:44<16:29, 54.95s/it]
Task 9, Epoch 3/20 => Loss 0.196, Train_accy 93.31:  15%|█▌        | 3/20 [02:44<15:34, 54.94s/it]
Task 9, Epoch 4/20 => Loss 0.165, Train_accy 94.41:  15%|█▌        | 3/20 [03:39<15:34, 54.94s/it]
Task 9, Epoch 4/20 => Loss 0.165, Train_accy 94.41:  20%|██        | 4/20 [03:39<14:39, 54.99s/it]
Task 9, Epoch 5/20 => Loss 0.174, Train_accy 94.41, Test_accy 86.13:  20%|██        | 4/20 [05:31<14:39, 54.99s/it]
Task 9, Epoch 5/20 => Loss 0.174, Train_accy 94.41, Test_accy 86.13:  25%|██▌       | 5/20 [05:31<18:48, 75.23s/it]
Task 9, Epoch 6/20 => Loss 0.158, Train_accy 94.59:  25%|██▌       | 5/20 [06:25<18:48, 75.23s/it]                 
Task 9, Epoch 6/20 => Loss 0.158, Train_accy 94.59:  30%|███       | 6/20 [06:25<15:56, 68.30s/it]
Task 9, Epoch 7/20 => Loss 0.167, Train_accy 94.19:  30%|███       | 6/20 [07:20<15:56, 68.30s/it]
Task 9, Epoch 7/20 => Loss 0.167, Train_accy 94.19:  35%|███▌      | 7/20 [07:20<13:50, 63.91s/it]
Task 9, Epoch 8/20 => Loss 0.150, Train_accy 95.07:  35%|███▌      | 7/20 [08:15<13:50, 63.91s/it]
Task 9, Epoch 8/20 => Loss 0.150, Train_accy 95.07:  40%|████      | 8/20 [08:15<12:12, 61.05s/it]
Task 9, Epoch 9/20 => Loss 0.137, Train_accy 95.25:  40%|████      | 8/20 [09:10<12:12, 61.05s/it]
Task 9, Epoch 9/20 => Loss 0.137, Train_accy 95.25:  45%|████▌     | 9/20 [09:10<10:50, 59.13s/it]
Task 9, Epoch 10/20 => Loss 0.134, Train_accy 95.45, Test_accy 86.32:  45%|████▌     | 9/20 [11:01<10:50, 59.13s/it]
Task 9, Epoch 10/20 => Loss 0.134, Train_accy 95.45, Test_accy 86.32:  50%|█████     | 10/20 [11:01<12:32, 75.26s/it]
Task 9, Epoch 11/20 => Loss 0.147, Train_accy 94.85:  50%|█████     | 10/20 [11:56<12:32, 75.26s/it]                 
Task 9, Epoch 11/20 => Loss 0.147, Train_accy 94.85:  55%|█████▌    | 11/20 [11:56<10:21, 69.04s/it]
Task 9, Epoch 12/20 => Loss 0.136, Train_accy 95.55:  55%|█████▌    | 11/20 [12:51<10:21, 69.04s/it]
Task 9, Epoch 12/20 => Loss 0.136, Train_accy 95.55:  60%|██████    | 12/20 [12:51<08:38, 64.79s/it]
Task 9, Epoch 13/20 => Loss 0.140, Train_accy 94.75:  60%|██████    | 12/20 [13:46<08:38, 64.79s/it]
Task 9, Epoch 13/20 => Loss 0.140, Train_accy 94.75:  65%|██████▌   | 13/20 [13:46<07:12, 61.81s/it]
Task 9, Epoch 14/20 => Loss 0.137, Train_accy 95.37:  65%|██████▌   | 13/20 [14:41<07:12, 61.81s/it]
Task 9, Epoch 14/20 => Loss 0.137, Train_accy 95.37:  70%|███████   | 14/20 [14:41<05:58, 59.74s/it]
Task 9, Epoch 15/20 => Loss 0.125, Train_accy 95.75, Test_accy 86.40:  70%|███████   | 14/20 [16:33<05:58, 59.74s/it]
Task 9, Epoch 15/20 => Loss 0.125, Train_accy 95.75, Test_accy 86.40:  75%|███████▌  | 15/20 [16:33<06:16, 75.28s/it]
Task 9, Epoch 16/20 => Loss 0.122, Train_accy 95.87:  75%|███████▌  | 15/20 [17:28<06:16, 75.28s/it]                 
Task 9, Epoch 16/20 => Loss 0.122, Train_accy 95.87:  80%|████████  | 16/20 [17:28<04:36, 69.17s/it]
Task 9, Epoch 17/20 => Loss 0.132, Train_accy 95.19:  80%|████████  | 16/20 [18:23<04:36, 69.17s/it]
Task 9, Epoch 17/20 => Loss 0.132, Train_accy 95.19:  85%|████████▌ | 17/20 [18:23<03:14, 64.92s/it]
Task 9, Epoch 18/20 => Loss 0.127, Train_accy 95.63:  85%|████████▌ | 17/20 [19:18<03:14, 64.92s/it]
Task 9, Epoch 18/20 => Loss 0.127, Train_accy 95.63:  90%|█████████ | 18/20 [19:18<02:03, 61.94s/it]
Task 9, Epoch 19/20 => Loss 0.130, Train_accy 95.65:  90%|█████████ | 18/20 [20:12<02:03, 61.94s/it]
Task 9, Epoch 19/20 => Loss 0.130, Train_accy 95.65:  95%|█████████▌| 19/20 [20:12<00:59, 59.78s/it]
Task 9, Epoch 20/20 => Loss 0.128, Train_accy 95.57, Test_accy 86.50:  95%|█████████▌| 19/20 [22:04<00:59, 59.78s/it]
Task 9, Epoch 20/20 => Loss 0.128, Train_accy 95.57, Test_accy 86.50: 100%|██████████| 20/20 [22:04<00:00, 75.21s/it]
Task 9, Epoch 20/20 => Loss 0.128, Train_accy 95.57, Test_accy 86.50: 100%|██████████| 20/20 [22:04<00:00, 66.20s/it]
2024-09-03 22:12:51,219 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.128, Train_accy 95.57, Test_accy 86.50
2024-09-03 22:13:47,661 [trainer.py] => No NME accuracy.
2024-09-03 22:13:47,662 [trainer.py] => CNN: {'total': 86.5, '00-09': 92.0, '10-19': 86.3, '20-29': 90.3, '30-39': 86.9, '40-49': 85.9, '50-59': 85.6, '60-69': 91.8, '70-79': 79.2, '80-89': 80.8, '90-99': 86.2, 'old': 86.53, 'new': 86.2}
2024-09-03 22:13:47,662 [trainer.py] => CNN top1 curve: [98.6, 96.15, 95.03, 92.98, 91.32, 90.22, 89.47, 88.04, 86.56, 86.5]
2024-09-03 22:13:47,662 [trainer.py] => CNN top5 curve: [100.0, 99.7, 99.6, 99.3, 99.24, 99.1, 98.97, 98.95, 98.67, 98.58]

Average Accuracy (CNN): 91.49
2024-09-03 22:13:47,662 [trainer.py] => Average Accuracy (CNN): 91.49 

Accuracy Matrix (CNN):
[[98.6 97.6 96.4 96.2 95.8 93.3 92.9 92.5 92.6 92. ]
 [ 0.  94.7 93.3 92.  90.1 90.  87.4 87.1 85.9 86.3]
 [ 0.   0.  95.4 93.2 92.3 91.  89.8 90.5 90.  90.3]
 [ 0.   0.   0.  90.5 89.  87.8 87.7 88.7 87.6 86.9]
 [ 0.   0.   0.   0.  89.4 87.7 87.  84.9 84.9 85.9]
 [ 0.   0.   0.   0.   0.  91.5 87.7 86.6 85.6 85.6]
 [ 0.   0.   0.   0.   0.   0.  93.8 93.2 92.3 91.8]
 [ 0.   0.   0.   0.   0.   0.   0.  80.8 79.8 79.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  80.3 80.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  86.2]]
2024-09-03 22:13:47,664 [trainer.py] => Forgetting (CNN): 4.077777777777778
2024-09-03 22:13:50,351 [trainer.py] => config: ./exps/coda_prompt_cifar_B0_Inc20.json
2024-09-03 22:13:50,351 [trainer.py] => prefix:  
2024-09-03 22:13:50,351 [trainer.py] => dataset: cifar224
2024-09-03 22:13:50,351 [trainer.py] => memory_size: 0
2024-09-03 22:13:50,351 [trainer.py] => memory_per_class: 0
2024-09-03 22:13:50,351 [trainer.py] => fixed_memory: False
2024-09-03 22:13:50,351 [trainer.py] => shuffle: True
2024-09-03 22:13:50,351 [trainer.py] => init_cls: 5
2024-09-03 22:13:50,351 [trainer.py] => increment: 5
2024-09-03 22:13:50,351 [trainer.py] => model_name: coda_prompt
2024-09-03 22:13:50,351 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-03 22:13:50,351 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-03 22:13:50,351 [trainer.py] => seed: 1993
2024-09-03 22:13:50,351 [trainer.py] => tuned_epoch: 20
2024-09-03 22:13:50,351 [trainer.py] => init_lr: 0.001
2024-09-03 22:13:50,351 [trainer.py] => batch_size: 48
2024-09-03 22:13:50,351 [trainer.py] => weight_decay: 0
2024-09-03 22:13:50,351 [trainer.py] => min_lr: 1e-05
2024-09-03 22:13:50,351 [trainer.py] => optimizer: adam
2024-09-03 22:13:50,351 [trainer.py] => scheduler: cosine
2024-09-03 22:13:50,351 [trainer.py] => reinit_optimizer: True
2024-09-03 22:13:50,351 [trainer.py] => pretrained: True
2024-09-03 22:13:50,351 [trainer.py] => drop: 0.0
2024-09-03 22:13:50,351 [trainer.py] => drop_path: 0.0
2024-09-03 22:13:50,351 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-03 22:13:51,454 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-03 22:13:53,515 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-03 22:13:53,515 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-03 22:13:53,516 [trainer.py] => All params: 89715556
2024-09-03 22:13:53,516 [trainer.py] => Trainable params: 89715556
2024-09-03 22:13:53,516 [coda_prompt.py] => Learning on 0-5

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.489, Train_accy 83.77:   0%|          | 0/20 [00:27<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.489, Train_accy 83.77:   5%|▌         | 1/20 [00:27<08:44, 27.62s/it]
Task 0, Epoch 2/20 => Loss 0.152, Train_accy 94.87:   5%|▌         | 1/20 [00:55<08:44, 27.62s/it]
Task 0, Epoch 2/20 => Loss 0.152, Train_accy 94.87:  10%|█         | 2/20 [00:55<08:15, 27.52s/it]
Task 0, Epoch 3/20 => Loss 0.145, Train_accy 95.47:  10%|█         | 2/20 [01:22<08:15, 27.52s/it]
Task 0, Epoch 3/20 => Loss 0.145, Train_accy 95.47:  15%|█▌        | 3/20 [01:22<07:47, 27.50s/it]
Task 0, Epoch 4/20 => Loss 0.121, Train_accy 95.99:  15%|█▌        | 3/20 [01:50<07:47, 27.50s/it]
Task 0, Epoch 4/20 => Loss 0.121, Train_accy 95.99:  20%|██        | 4/20 [01:50<07:19, 27.49s/it]
Task 0, Epoch 5/20 => Loss 0.103, Train_accy 96.63, Test_accy 99.60:  20%|██        | 4/20 [02:20<07:19, 27.49s/it]
Task 0, Epoch 5/20 => Loss 0.103, Train_accy 96.63, Test_accy 99.60:  25%|██▌       | 5/20 [02:20<07:09, 28.62s/it]
Task 0, Epoch 6/20 => Loss 0.108, Train_accy 96.43:  25%|██▌       | 5/20 [02:48<07:09, 28.62s/it]                 
Task 0, Epoch 6/20 => Loss 0.108, Train_accy 96.43:  30%|███       | 6/20 [02:48<06:34, 28.20s/it]
Task 0, Epoch 7/20 => Loss 0.089, Train_accy 96.92:  30%|███       | 6/20 [03:15<06:34, 28.20s/it]
Task 0, Epoch 7/20 => Loss 0.089, Train_accy 96.92:  35%|███▌      | 7/20 [03:15<06:03, 27.95s/it]
Task 0, Epoch 8/20 => Loss 0.091, Train_accy 96.47:  35%|███▌      | 7/20 [03:42<06:03, 27.95s/it]
Task 0, Epoch 8/20 => Loss 0.091, Train_accy 96.47:  40%|████      | 8/20 [03:42<05:33, 27.82s/it]
Task 0, Epoch 9/20 => Loss 0.097, Train_accy 96.71:  40%|████      | 8/20 [04:10<05:33, 27.82s/it]
Task 0, Epoch 9/20 => Loss 0.097, Train_accy 96.71:  45%|████▌     | 9/20 [04:10<05:05, 27.73s/it]
Task 0, Epoch 10/20 => Loss 0.079, Train_accy 97.80, Test_accy 99.80:  45%|████▌     | 9/20 [04:41<05:05, 27.73s/it]
Task 0, Epoch 10/20 => Loss 0.079, Train_accy 97.80, Test_accy 99.80:  50%|█████     | 10/20 [04:41<04:46, 28.63s/it]
Task 0, Epoch 11/20 => Loss 0.070, Train_accy 97.72:  50%|█████     | 10/20 [05:08<04:46, 28.63s/it]                 
Task 0, Epoch 11/20 => Loss 0.070, Train_accy 97.72:  55%|█████▌    | 11/20 [05:08<04:14, 28.26s/it]
Task 0, Epoch 12/20 => Loss 0.088, Train_accy 97.24:  55%|█████▌    | 11/20 [05:35<04:14, 28.26s/it]
Task 0, Epoch 12/20 => Loss 0.088, Train_accy 97.24:  60%|██████    | 12/20 [05:35<03:44, 28.00s/it]
Task 0, Epoch 13/20 => Loss 0.063, Train_accy 97.84:  60%|██████    | 12/20 [06:03<03:44, 28.00s/it]
Task 0, Epoch 13/20 => Loss 0.063, Train_accy 97.84:  65%|██████▌   | 13/20 [06:03<03:14, 27.85s/it]
Task 0, Epoch 14/20 => Loss 0.063, Train_accy 97.68:  65%|██████▌   | 13/20 [06:30<03:14, 27.85s/it]
Task 0, Epoch 14/20 => Loss 0.063, Train_accy 97.68:  70%|███████   | 14/20 [06:30<02:46, 27.74s/it]
Task 0, Epoch 15/20 => Loss 0.068, Train_accy 97.80, Test_accy 99.80:  70%|███████   | 14/20 [07:01<02:46, 27.74s/it]
Task 0, Epoch 15/20 => Loss 0.068, Train_accy 97.80, Test_accy 99.80:  75%|███████▌  | 15/20 [07:01<02:22, 28.59s/it]
Task 0, Epoch 16/20 => Loss 0.083, Train_accy 97.60:  75%|███████▌  | 15/20 [07:29<02:22, 28.59s/it]                 
Task 0, Epoch 16/20 => Loss 0.083, Train_accy 97.60:  80%|████████  | 16/20 [07:29<01:53, 28.26s/it]
Task 0, Epoch 17/20 => Loss 0.063, Train_accy 98.00:  80%|████████  | 16/20 [07:56<01:53, 28.26s/it]
Task 0, Epoch 17/20 => Loss 0.063, Train_accy 98.00:  85%|████████▌ | 17/20 [07:56<01:24, 28.03s/it]
Task 0, Epoch 18/20 => Loss 0.064, Train_accy 97.88:  85%|████████▌ | 17/20 [08:23<01:24, 28.03s/it]
Task 0, Epoch 18/20 => Loss 0.064, Train_accy 97.88:  90%|█████████ | 18/20 [08:23<00:55, 27.85s/it]
Task 0, Epoch 19/20 => Loss 0.063, Train_accy 98.12:  90%|█████████ | 18/20 [08:51<00:55, 27.85s/it]
Task 0, Epoch 19/20 => Loss 0.063, Train_accy 98.12:  95%|█████████▌| 19/20 [08:51<00:27, 27.74s/it]
Task 0, Epoch 20/20 => Loss 0.074, Train_accy 97.72, Test_accy 99.80:  95%|█████████▌| 19/20 [09:22<00:27, 27.74s/it]
Task 0, Epoch 20/20 => Loss 0.074, Train_accy 97.72, Test_accy 99.80: 100%|██████████| 20/20 [09:22<00:00, 28.61s/it]
Task 0, Epoch 20/20 => Loss 0.074, Train_accy 97.72, Test_accy 99.80: 100%|██████████| 20/20 [09:22<00:00, 28.11s/it]
2024-09-03 22:23:16,110 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.074, Train_accy 97.72, Test_accy 99.80
2024-09-03 22:23:19,269 [trainer.py] => No NME accuracy.
2024-09-03 22:23:19,270 [trainer.py] => CNN: {'total': 99.8, '00-04': 99.8, 'old': 0, 'new': 99.8}
2024-09-03 22:23:19,270 [trainer.py] => CNN top1 curve: [99.8]
2024-09-03 22:23:19,270 [trainer.py] => CNN top5 curve: [100.0]

Average Accuracy (CNN): 99.8
2024-09-03 22:23:19,270 [trainer.py] => Average Accuracy (CNN): 99.8 

2024-09-03 22:23:19,272 [trainer.py] => All params: 89715556
2024-09-03 22:23:19,273 [trainer.py] => Trainable params: 89715556
2024-09-03 22:23:19,368 [coda_prompt.py] => Learning on 5-10

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.425, Train_accy 84.33:   0%|          | 0/20 [00:27<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.425, Train_accy 84.33:   5%|▌         | 1/20 [00:27<08:43, 27.54s/it]
Task 1, Epoch 2/20 => Loss 0.179, Train_accy 93.63:   5%|▌         | 1/20 [00:55<08:43, 27.54s/it]
Task 1, Epoch 2/20 => Loss 0.179, Train_accy 93.63:  10%|█         | 2/20 [00:55<08:16, 27.58s/it]
Task 1, Epoch 3/20 => Loss 0.149, Train_accy 95.03:  10%|█         | 2/20 [01:22<08:16, 27.58s/it]
Task 1, Epoch 3/20 => Loss 0.149, Train_accy 95.03:  15%|█▌        | 3/20 [01:22<07:48, 27.56s/it]
Task 1, Epoch 4/20 => Loss 0.148, Train_accy 95.23:  15%|█▌        | 3/20 [01:50<07:48, 27.56s/it]
Task 1, Epoch 4/20 => Loss 0.148, Train_accy 95.23:  20%|██        | 4/20 [01:50<07:20, 27.56s/it]
Task 1, Epoch 5/20 => Loss 0.120, Train_accy 95.55, Test_accy 97.30:  20%|██        | 4/20 [02:23<07:20, 27.56s/it]
Task 1, Epoch 5/20 => Loss 0.120, Train_accy 95.55, Test_accy 97.30:  25%|██▌       | 5/20 [02:23<07:25, 29.67s/it]
Task 1, Epoch 6/20 => Loss 0.133, Train_accy 95.51:  25%|██▌       | 5/20 [02:51<07:25, 29.67s/it]                 
Task 1, Epoch 6/20 => Loss 0.133, Train_accy 95.51:  30%|███       | 6/20 [02:51<06:45, 28.96s/it]
Task 1, Epoch 7/20 => Loss 0.116, Train_accy 95.79:  30%|███       | 6/20 [03:18<06:45, 28.96s/it]
Task 1, Epoch 7/20 => Loss 0.116, Train_accy 95.79:  35%|███▌      | 7/20 [03:18<06:10, 28.49s/it]
Task 1, Epoch 8/20 => Loss 0.120, Train_accy 95.83:  35%|███▌      | 7/20 [03:46<06:10, 28.49s/it]
Task 1, Epoch 8/20 => Loss 0.120, Train_accy 95.83:  40%|████      | 8/20 [03:46<05:38, 28.18s/it]
Task 1, Epoch 9/20 => Loss 0.121, Train_accy 95.67:  40%|████      | 8/20 [04:13<05:38, 28.18s/it]
Task 1, Epoch 9/20 => Loss 0.121, Train_accy 95.67:  45%|████▌     | 9/20 [04:13<05:07, 27.98s/it]
Task 1, Epoch 10/20 => Loss 0.109, Train_accy 96.51, Test_accy 97.50:  45%|████▌     | 9/20 [04:47<05:07, 27.98s/it]
Task 1, Epoch 10/20 => Loss 0.109, Train_accy 96.51, Test_accy 97.50:  50%|█████     | 10/20 [04:47<04:56, 29.64s/it]
Task 1, Epoch 11/20 => Loss 0.112, Train_accy 96.07:  50%|█████     | 10/20 [05:14<04:56, 29.64s/it]                 
Task 1, Epoch 11/20 => Loss 0.112, Train_accy 96.07:  55%|█████▌    | 11/20 [05:14<04:20, 28.98s/it]
Task 1, Epoch 12/20 => Loss 0.107, Train_accy 96.11:  55%|█████▌    | 11/20 [05:42<04:20, 28.98s/it]
Task 1, Epoch 12/20 => Loss 0.107, Train_accy 96.11:  60%|██████    | 12/20 [05:42<03:48, 28.52s/it]
Task 1, Epoch 13/20 => Loss 0.097, Train_accy 96.51:  60%|██████    | 12/20 [06:09<03:48, 28.52s/it]
Task 1, Epoch 13/20 => Loss 0.097, Train_accy 96.51:  65%|██████▌   | 13/20 [06:09<03:17, 28.22s/it]
Task 1, Epoch 14/20 => Loss 0.090, Train_accy 96.96:  65%|██████▌   | 13/20 [06:37<03:17, 28.22s/it]
Task 1, Epoch 14/20 => Loss 0.090, Train_accy 96.96:  70%|███████   | 14/20 [06:37<02:47, 27.98s/it]
Task 1, Epoch 15/20 => Loss 0.103, Train_accy 96.07, Test_accy 97.70:  70%|███████   | 14/20 [07:10<02:47, 27.98s/it]
Task 1, Epoch 15/20 => Loss 0.103, Train_accy 96.07, Test_accy 97.70:  75%|███████▌  | 15/20 [07:10<02:28, 29.63s/it]
Task 1, Epoch 16/20 => Loss 0.113, Train_accy 95.91:  75%|███████▌  | 15/20 [07:38<02:28, 29.63s/it]                 
Task 1, Epoch 16/20 => Loss 0.113, Train_accy 95.91:  80%|████████  | 16/20 [07:38<01:55, 28.98s/it]
Task 1, Epoch 17/20 => Loss 0.090, Train_accy 96.88:  80%|████████  | 16/20 [08:05<01:55, 28.98s/it]
Task 1, Epoch 17/20 => Loss 0.090, Train_accy 96.88:  85%|████████▌ | 17/20 [08:05<01:25, 28.53s/it]
Task 1, Epoch 18/20 => Loss 0.098, Train_accy 96.51:  85%|████████▌ | 17/20 [08:32<01:25, 28.53s/it]
Task 1, Epoch 18/20 => Loss 0.098, Train_accy 96.51:  90%|█████████ | 18/20 [08:32<00:56, 28.20s/it]
Task 1, Epoch 19/20 => Loss 0.092, Train_accy 96.59:  90%|█████████ | 18/20 [09:00<00:56, 28.20s/it]
Task 1, Epoch 19/20 => Loss 0.092, Train_accy 96.59:  95%|█████████▌| 19/20 [09:00<00:27, 27.98s/it]
Task 1, Epoch 20/20 => Loss 0.087, Train_accy 97.00, Test_accy 98.00:  95%|█████████▌| 19/20 [09:33<00:27, 27.98s/it]
Task 1, Epoch 20/20 => Loss 0.087, Train_accy 97.00, Test_accy 98.00: 100%|██████████| 20/20 [09:33<00:00, 29.60s/it]
Task 1, Epoch 20/20 => Loss 0.087, Train_accy 97.00, Test_accy 98.00: 100%|██████████| 20/20 [09:33<00:00, 28.69s/it]
2024-09-03 22:32:53,203 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.087, Train_accy 97.00, Test_accy 98.00
2024-09-03 22:32:59,089 [trainer.py] => No NME accuracy.
2024-09-03 22:32:59,089 [trainer.py] => CNN: {'total': 98.0, '00-04': 99.2, '05-09': 96.8, 'old': 99.2, 'new': 96.8}
2024-09-03 22:32:59,089 [trainer.py] => CNN top1 curve: [99.8, 98.0]
2024-09-03 22:32:59,090 [trainer.py] => CNN top5 curve: [100.0, 99.8]

Average Accuracy (CNN): 98.9
2024-09-03 22:32:59,090 [trainer.py] => Average Accuracy (CNN): 98.9 

2024-09-03 22:32:59,091 [trainer.py] => All params: 89715556
2024-09-03 22:32:59,092 [trainer.py] => Trainable params: 89715556
2024-09-03 22:32:59,234 [coda_prompt.py] => Learning on 10-15

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.415, Train_accy 85.10:   0%|          | 0/20 [00:27<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.415, Train_accy 85.10:   5%|▌         | 1/20 [00:27<08:44, 27.58s/it]
Task 2, Epoch 2/20 => Loss 0.179, Train_accy 93.19:   5%|▌         | 1/20 [00:55<08:44, 27.58s/it]
Task 2, Epoch 2/20 => Loss 0.179, Train_accy 93.19:  10%|█         | 2/20 [00:55<08:16, 27.58s/it]
Task 2, Epoch 3/20 => Loss 0.142, Train_accy 95.03:  10%|█         | 2/20 [01:22<08:16, 27.58s/it]
Task 2, Epoch 3/20 => Loss 0.142, Train_accy 95.03:  15%|█▌        | 3/20 [01:22<07:48, 27.56s/it]
Task 2, Epoch 4/20 => Loss 0.122, Train_accy 95.47:  15%|█▌        | 3/20 [01:50<07:48, 27.56s/it]
Task 2, Epoch 4/20 => Loss 0.122, Train_accy 95.47:  20%|██        | 4/20 [01:50<07:20, 27.54s/it]
Task 2, Epoch 5/20 => Loss 0.128, Train_accy 95.31, Test_accy 96.07:  20%|██        | 4/20 [02:26<07:20, 27.54s/it]
Task 2, Epoch 5/20 => Loss 0.128, Train_accy 95.31, Test_accy 96.07:  25%|██▌       | 5/20 [02:26<07:40, 30.70s/it]
Task 2, Epoch 6/20 => Loss 0.130, Train_accy 95.39:  25%|██▌       | 5/20 [02:53<07:40, 30.70s/it]                 
Task 2, Epoch 6/20 => Loss 0.130, Train_accy 95.39:  30%|███       | 6/20 [02:53<06:54, 29.60s/it]
Task 2, Epoch 7/20 => Loss 0.147, Train_accy 94.55:  30%|███       | 6/20 [03:21<06:54, 29.60s/it]
Task 2, Epoch 7/20 => Loss 0.147, Train_accy 94.55:  35%|███▌      | 7/20 [03:21<06:16, 28.94s/it]
Task 2, Epoch 8/20 => Loss 0.119, Train_accy 95.19:  35%|███▌      | 7/20 [03:49<06:16, 28.94s/it]
Task 2, Epoch 8/20 => Loss 0.119, Train_accy 95.19:  40%|████      | 8/20 [03:49<05:41, 28.48s/it]
Task 2, Epoch 9/20 => Loss 0.125, Train_accy 95.35:  40%|████      | 8/20 [04:16<05:41, 28.48s/it]
Task 2, Epoch 9/20 => Loss 0.125, Train_accy 95.35:  45%|████▌     | 9/20 [04:16<05:09, 28.17s/it]
Task 2, Epoch 10/20 => Loss 0.130, Train_accy 95.11, Test_accy 96.27:  45%|████▌     | 9/20 [04:52<05:09, 28.17s/it]
Task 2, Epoch 10/20 => Loss 0.130, Train_accy 95.11, Test_accy 96.27:  50%|█████     | 10/20 [04:52<05:06, 30.65s/it]
Task 2, Epoch 11/20 => Loss 0.118, Train_accy 95.71:  50%|█████     | 10/20 [05:20<05:06, 30.65s/it]                 
Task 2, Epoch 11/20 => Loss 0.118, Train_accy 95.71:  55%|█████▌    | 11/20 [05:20<04:27, 29.69s/it]
Task 2, Epoch 12/20 => Loss 0.098, Train_accy 96.35:  55%|█████▌    | 11/20 [05:47<04:27, 29.69s/it]
Task 2, Epoch 12/20 => Loss 0.098, Train_accy 96.35:  60%|██████    | 12/20 [05:47<03:52, 29.04s/it]
Task 2, Epoch 13/20 => Loss 0.121, Train_accy 95.31:  60%|██████    | 12/20 [06:15<03:52, 29.04s/it]
Task 2, Epoch 13/20 => Loss 0.121, Train_accy 95.31:  65%|██████▌   | 13/20 [06:15<03:19, 28.56s/it]
Task 2, Epoch 14/20 => Loss 0.105, Train_accy 96.03:  65%|██████▌   | 13/20 [06:42<03:19, 28.56s/it]
Task 2, Epoch 14/20 => Loss 0.105, Train_accy 96.03:  70%|███████   | 14/20 [06:42<02:49, 28.22s/it]
Task 2, Epoch 15/20 => Loss 0.095, Train_accy 96.27, Test_accy 96.40:  70%|███████   | 14/20 [07:19<02:49, 28.22s/it]
Task 2, Epoch 15/20 => Loss 0.095, Train_accy 96.27, Test_accy 96.40:  75%|███████▌  | 15/20 [07:19<02:33, 30.66s/it]
Task 2, Epoch 16/20 => Loss 0.096, Train_accy 96.19:  75%|███████▌  | 15/20 [07:46<02:33, 30.66s/it]                 
Task 2, Epoch 16/20 => Loss 0.096, Train_accy 96.19:  80%|████████  | 16/20 [07:46<01:58, 29.73s/it]
Task 2, Epoch 17/20 => Loss 0.108, Train_accy 96.31:  80%|████████  | 16/20 [08:13<01:58, 29.73s/it]
Task 2, Epoch 17/20 => Loss 0.108, Train_accy 96.31:  85%|████████▌ | 17/20 [08:13<01:27, 29.00s/it]
Task 2, Epoch 18/20 => Loss 0.100, Train_accy 96.19:  85%|████████▌ | 17/20 [08:41<01:27, 29.00s/it]
Task 2, Epoch 18/20 => Loss 0.100, Train_accy 96.19:  90%|█████████ | 18/20 [08:41<00:57, 28.53s/it]
Task 2, Epoch 19/20 => Loss 0.102, Train_accy 96.19:  90%|█████████ | 18/20 [09:08<00:57, 28.53s/it]
Task 2, Epoch 19/20 => Loss 0.102, Train_accy 96.19:  95%|█████████▌| 19/20 [09:08<00:28, 28.20s/it]
Task 2, Epoch 20/20 => Loss 0.101, Train_accy 95.99, Test_accy 96.67:  95%|█████████▌| 19/20 [09:44<00:28, 28.20s/it]
Task 2, Epoch 20/20 => Loss 0.101, Train_accy 95.99, Test_accy 96.67: 100%|██████████| 20/20 [09:44<00:00, 30.49s/it]
Task 2, Epoch 20/20 => Loss 0.101, Train_accy 95.99, Test_accy 96.67: 100%|██████████| 20/20 [09:44<00:00, 29.23s/it]
2024-09-03 22:42:43,831 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.101, Train_accy 95.99, Test_accy 96.67
2024-09-03 22:42:52,531 [trainer.py] => No NME accuracy.
2024-09-03 22:42:52,531 [trainer.py] => CNN: {'total': 96.67, '00-04': 98.8, '05-09': 95.4, '10-14': 95.8, 'old': 97.1, 'new': 95.8}
2024-09-03 22:42:52,531 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67]
2024-09-03 22:42:52,532 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67]

Average Accuracy (CNN): 98.16
2024-09-03 22:42:52,532 [trainer.py] => Average Accuracy (CNN): 98.16 

2024-09-03 22:42:52,534 [trainer.py] => All params: 89715556
2024-09-03 22:42:52,535 [trainer.py] => Trainable params: 89715556
2024-09-03 22:42:52,721 [coda_prompt.py] => Learning on 15-20

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.435, Train_accy 84.05:   0%|          | 0/20 [00:27<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.435, Train_accy 84.05:   5%|▌         | 1/20 [00:27<08:41, 27.46s/it]
Task 3, Epoch 2/20 => Loss 0.180, Train_accy 93.59:   5%|▌         | 1/20 [00:54<08:41, 27.46s/it]
Task 3, Epoch 2/20 => Loss 0.180, Train_accy 93.59:  10%|█         | 2/20 [00:54<08:14, 27.49s/it]
Task 3, Epoch 3/20 => Loss 0.161, Train_accy 94.35:  10%|█         | 2/20 [01:22<08:14, 27.49s/it]
Task 3, Epoch 3/20 => Loss 0.161, Train_accy 94.35:  15%|█▌        | 3/20 [01:22<07:47, 27.49s/it]
Task 3, Epoch 4/20 => Loss 0.132, Train_accy 95.07:  15%|█▌        | 3/20 [01:49<07:47, 27.49s/it]
Task 3, Epoch 4/20 => Loss 0.132, Train_accy 95.07:  20%|██        | 4/20 [01:49<07:19, 27.47s/it]
Task 3, Epoch 5/20 => Loss 0.152, Train_accy 94.47, Test_accy 94.80:  20%|██        | 4/20 [02:28<07:19, 27.47s/it]
Task 3, Epoch 5/20 => Loss 0.152, Train_accy 94.47, Test_accy 94.80:  25%|██▌       | 5/20 [02:28<07:54, 31.62s/it]
Task 3, Epoch 6/20 => Loss 0.137, Train_accy 94.99:  25%|██▌       | 5/20 [02:56<07:54, 31.62s/it]                 
Task 3, Epoch 6/20 => Loss 0.137, Train_accy 94.99:  30%|███       | 6/20 [02:56<07:02, 30.19s/it]
Task 3, Epoch 7/20 => Loss 0.130, Train_accy 95.67:  30%|███       | 6/20 [03:23<07:02, 30.19s/it]
Task 3, Epoch 7/20 => Loss 0.130, Train_accy 95.67:  35%|███▌      | 7/20 [03:23<06:20, 29.25s/it]
Task 3, Epoch 8/20 => Loss 0.132, Train_accy 94.95:  35%|███▌      | 7/20 [03:51<06:20, 29.25s/it]
Task 3, Epoch 8/20 => Loss 0.132, Train_accy 94.95:  40%|████      | 8/20 [03:51<05:43, 28.66s/it]
Task 3, Epoch 9/20 => Loss 0.115, Train_accy 95.63:  40%|████      | 8/20 [04:18<05:43, 28.66s/it]
Task 3, Epoch 9/20 => Loss 0.115, Train_accy 95.63:  45%|████▌     | 9/20 [04:18<05:11, 28.28s/it]
Task 3, Epoch 10/20 => Loss 0.120, Train_accy 95.35, Test_accy 94.80:  45%|████▌     | 9/20 [04:57<05:11, 28.28s/it]
Task 3, Epoch 10/20 => Loss 0.120, Train_accy 95.35, Test_accy 94.80:  50%|█████     | 10/20 [04:57<05:15, 31.56s/it]
Task 3, Epoch 11/20 => Loss 0.133, Train_accy 94.91:  50%|█████     | 10/20 [05:24<05:15, 31.56s/it]                 
Task 3, Epoch 11/20 => Loss 0.133, Train_accy 94.91:  55%|█████▌    | 11/20 [05:24<04:32, 30.30s/it]
Task 3, Epoch 12/20 => Loss 0.124, Train_accy 95.47:  55%|█████▌    | 11/20 [05:52<04:32, 30.30s/it]
Task 3, Epoch 12/20 => Loss 0.124, Train_accy 95.47:  60%|██████    | 12/20 [05:52<03:55, 29.43s/it]
Task 3, Epoch 13/20 => Loss 0.111, Train_accy 95.67:  60%|██████    | 12/20 [06:19<03:55, 29.43s/it]
Task 3, Epoch 13/20 => Loss 0.111, Train_accy 95.67:  65%|██████▌   | 13/20 [06:19<03:21, 28.84s/it]
Task 3, Epoch 14/20 => Loss 0.110, Train_accy 95.95:  65%|██████▌   | 13/20 [06:47<03:21, 28.84s/it]
Task 3, Epoch 14/20 => Loss 0.110, Train_accy 95.95:  70%|███████   | 14/20 [06:47<02:50, 28.43s/it]
Task 3, Epoch 15/20 => Loss 0.107, Train_accy 96.15, Test_accy 95.20:  70%|███████   | 14/20 [07:26<02:50, 28.43s/it]
Task 3, Epoch 15/20 => Loss 0.107, Train_accy 96.15, Test_accy 95.20:  75%|███████▌  | 15/20 [07:26<02:37, 31.59s/it]
Task 3, Epoch 16/20 => Loss 0.117, Train_accy 95.99:  75%|███████▌  | 15/20 [07:53<02:37, 31.59s/it]                 
Task 3, Epoch 16/20 => Loss 0.117, Train_accy 95.99:  80%|████████  | 16/20 [07:53<02:01, 30.34s/it]
Task 3, Epoch 17/20 => Loss 0.106, Train_accy 96.23:  80%|████████  | 16/20 [08:20<02:01, 30.34s/it]
Task 3, Epoch 17/20 => Loss 0.106, Train_accy 96.23:  85%|████████▌ | 17/20 [08:20<01:28, 29.46s/it]
Task 3, Epoch 18/20 => Loss 0.109, Train_accy 95.87:  85%|████████▌ | 17/20 [08:48<01:28, 29.46s/it]
Task 3, Epoch 18/20 => Loss 0.109, Train_accy 95.87:  90%|█████████ | 18/20 [08:48<00:57, 28.85s/it]
Task 3, Epoch 19/20 => Loss 0.092, Train_accy 96.51:  90%|█████████ | 18/20 [09:15<00:57, 28.85s/it]
Task 3, Epoch 19/20 => Loss 0.092, Train_accy 96.51:  95%|█████████▌| 19/20 [09:15<00:28, 28.42s/it]
Task 3, Epoch 20/20 => Loss 0.104, Train_accy 96.19, Test_accy 95.00:  95%|█████████▌| 19/20 [09:54<00:28, 28.42s/it]
Task 3, Epoch 20/20 => Loss 0.104, Train_accy 96.19, Test_accy 95.00: 100%|██████████| 20/20 [09:54<00:00, 31.59s/it]
Task 3, Epoch 20/20 => Loss 0.104, Train_accy 96.19, Test_accy 95.00: 100%|██████████| 20/20 [09:54<00:00, 29.74s/it]
2024-09-03 22:52:47,553 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.104, Train_accy 96.19, Test_accy 95.00
2024-09-03 22:52:59,069 [trainer.py] => No NME accuracy.
2024-09-03 22:52:59,069 [trainer.py] => CNN: {'total': 95.0, '00-04': 98.6, '05-09': 94.4, '10-14': 94.6, '15-19': 92.4, 'old': 95.87, 'new': 92.4}
2024-09-03 22:52:59,069 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0]
2024-09-03 22:52:59,069 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3]

Average Accuracy (CNN): 97.37
2024-09-03 22:52:59,070 [trainer.py] => Average Accuracy (CNN): 97.37 

2024-09-03 22:52:59,071 [trainer.py] => All params: 89715556
2024-09-03 22:52:59,072 [trainer.py] => Trainable params: 89715556
2024-09-03 22:52:59,310 [coda_prompt.py] => Learning on 20-25

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.296, Train_accy 90.02:   0%|          | 0/20 [00:27<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.296, Train_accy 90.02:   5%|▌         | 1/20 [00:27<08:41, 27.43s/it]
Task 4, Epoch 2/20 => Loss 0.094, Train_accy 97.24:   5%|▌         | 1/20 [00:54<08:41, 27.43s/it]
Task 4, Epoch 2/20 => Loss 0.094, Train_accy 97.24:  10%|█         | 2/20 [00:54<08:13, 27.41s/it]
Task 4, Epoch 3/20 => Loss 0.084, Train_accy 97.24:  10%|█         | 2/20 [01:22<08:13, 27.41s/it]
Task 4, Epoch 3/20 => Loss 0.084, Train_accy 97.24:  15%|█▌        | 3/20 [01:22<07:44, 27.34s/it]
Task 4, Epoch 4/20 => Loss 0.071, Train_accy 97.28:  15%|█▌        | 3/20 [01:49<07:44, 27.34s/it]
Task 4, Epoch 4/20 => Loss 0.071, Train_accy 97.28:  20%|██        | 4/20 [01:49<07:16, 27.27s/it]
Task 4, Epoch 5/20 => Loss 0.070, Train_accy 97.20, Test_accy 94.00:  20%|██        | 4/20 [02:30<07:16, 27.27s/it]
Task 4, Epoch 5/20 => Loss 0.070, Train_accy 97.20, Test_accy 94.00:  25%|██▌       | 5/20 [02:30<08:07, 32.47s/it]
Task 4, Epoch 6/20 => Loss 0.083, Train_accy 97.20:  25%|██▌       | 5/20 [02:58<08:07, 32.47s/it]                 
Task 4, Epoch 6/20 => Loss 0.083, Train_accy 97.20:  30%|███       | 6/20 [02:58<07:10, 30.76s/it]
Task 4, Epoch 7/20 => Loss 0.056, Train_accy 97.88:  30%|███       | 6/20 [03:25<07:10, 30.76s/it]
Task 4, Epoch 7/20 => Loss 0.056, Train_accy 97.88:  35%|███▌      | 7/20 [03:25<06:25, 29.68s/it]
Task 4, Epoch 8/20 => Loss 0.066, Train_accy 97.48:  35%|███▌      | 7/20 [03:53<06:25, 29.68s/it]
Task 4, Epoch 8/20 => Loss 0.066, Train_accy 97.48:  40%|████      | 8/20 [03:53<05:47, 28.96s/it]
Task 4, Epoch 9/20 => Loss 0.071, Train_accy 97.16:  40%|████      | 8/20 [04:20<05:47, 28.96s/it]
Task 4, Epoch 9/20 => Loss 0.071, Train_accy 97.16:  45%|████▌     | 9/20 [04:20<05:13, 28.46s/it]
Task 4, Epoch 10/20 => Loss 0.054, Train_accy 98.28, Test_accy 95.04:  45%|████▌     | 9/20 [05:02<05:13, 28.46s/it]
Task 4, Epoch 10/20 => Loss 0.054, Train_accy 98.28, Test_accy 95.04:  50%|█████     | 10/20 [05:02<05:24, 32.49s/it]
Task 4, Epoch 11/20 => Loss 0.058, Train_accy 97.84:  50%|█████     | 10/20 [05:29<05:24, 32.49s/it]                 
Task 4, Epoch 11/20 => Loss 0.058, Train_accy 97.84:  55%|█████▌    | 11/20 [05:29<04:38, 30.94s/it]
Task 4, Epoch 12/20 => Loss 0.069, Train_accy 97.44:  55%|█████▌    | 11/20 [05:56<04:38, 30.94s/it]
Task 4, Epoch 12/20 => Loss 0.069, Train_accy 97.44:  60%|██████    | 12/20 [05:56<03:59, 29.88s/it]
Task 4, Epoch 13/20 => Loss 0.050, Train_accy 98.04:  60%|██████    | 12/20 [06:24<03:59, 29.88s/it]
Task 4, Epoch 13/20 => Loss 0.050, Train_accy 98.04:  65%|██████▌   | 13/20 [06:24<03:23, 29.13s/it]
Task 4, Epoch 14/20 => Loss 0.057, Train_accy 98.04:  65%|██████▌   | 13/20 [06:51<03:23, 29.13s/it]
Task 4, Epoch 14/20 => Loss 0.057, Train_accy 98.04:  70%|███████   | 14/20 [06:51<02:51, 28.62s/it]
Task 4, Epoch 15/20 => Loss 0.046, Train_accy 98.52, Test_accy 94.96:  70%|███████   | 14/20 [07:33<02:51, 28.62s/it]
Task 4, Epoch 15/20 => Loss 0.046, Train_accy 98.52, Test_accy 94.96:  75%|███████▌  | 15/20 [07:33<02:42, 32.57s/it]
Task 4, Epoch 16/20 => Loss 0.047, Train_accy 98.28:  75%|███████▌  | 15/20 [08:01<02:42, 32.57s/it]                 
Task 4, Epoch 16/20 => Loss 0.047, Train_accy 98.28:  80%|████████  | 16/20 [08:01<02:04, 31.03s/it]
Task 4, Epoch 17/20 => Loss 0.044, Train_accy 98.44:  80%|████████  | 16/20 [08:28<02:04, 31.03s/it]
Task 4, Epoch 17/20 => Loss 0.044, Train_accy 98.44:  85%|████████▌ | 17/20 [08:28<01:29, 29.94s/it]
Task 4, Epoch 18/20 => Loss 0.040, Train_accy 98.64:  85%|████████▌ | 17/20 [08:55<01:29, 29.94s/it]
Task 4, Epoch 18/20 => Loss 0.040, Train_accy 98.64:  90%|█████████ | 18/20 [08:55<00:58, 29.17s/it]
Task 4, Epoch 19/20 => Loss 0.043, Train_accy 98.48:  90%|█████████ | 18/20 [09:23<00:58, 29.17s/it]
Task 4, Epoch 19/20 => Loss 0.043, Train_accy 98.48:  95%|█████████▌| 19/20 [09:23<00:28, 28.65s/it]
Task 4, Epoch 20/20 => Loss 0.054, Train_accy 97.88, Test_accy 95.04:  95%|█████████▌| 19/20 [10:04<00:28, 28.65s/it]
Task 4, Epoch 20/20 => Loss 0.054, Train_accy 97.88, Test_accy 95.04: 100%|██████████| 20/20 [10:04<00:00, 32.54s/it]
Task 4, Epoch 20/20 => Loss 0.054, Train_accy 97.88, Test_accy 95.04: 100%|██████████| 20/20 [10:04<00:00, 30.24s/it]
2024-09-03 23:03:04,184 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.054, Train_accy 97.88, Test_accy 95.04
2024-09-03 23:03:18,403 [trainer.py] => No NME accuracy.
2024-09-03 23:03:18,403 [trainer.py] => CNN: {'total': 95.04, '00-04': 98.8, '05-09': 94.8, '10-14': 93.6, '15-19': 92.2, '20-24': 95.8, 'old': 94.85, 'new': 95.8}
2024-09-03 23:03:18,404 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04]
2024-09-03 23:03:18,404 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32]

Average Accuracy (CNN): 96.9
2024-09-03 23:03:18,404 [trainer.py] => Average Accuracy (CNN): 96.9 

2024-09-03 23:03:18,406 [trainer.py] => All params: 89715556
2024-09-03 23:03:18,407 [trainer.py] => Trainable params: 89715556
2024-09-03 23:03:18,698 [coda_prompt.py] => Learning on 25-30

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.248, Train_accy 90.95:   0%|          | 0/20 [00:27<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.248, Train_accy 90.95:   5%|▌         | 1/20 [00:27<08:40, 27.40s/it]
Task 5, Epoch 2/20 => Loss 0.074, Train_accy 97.28:   5%|▌         | 1/20 [00:54<08:40, 27.40s/it]
Task 5, Epoch 2/20 => Loss 0.074, Train_accy 97.28:  10%|█         | 2/20 [00:54<08:12, 27.39s/it]
Task 5, Epoch 3/20 => Loss 0.064, Train_accy 97.68:  10%|█         | 2/20 [01:22<08:12, 27.39s/it]
Task 5, Epoch 3/20 => Loss 0.064, Train_accy 97.68:  15%|█▌        | 3/20 [01:22<07:45, 27.40s/it]
Task 5, Epoch 4/20 => Loss 0.066, Train_accy 97.64:  15%|█▌        | 3/20 [01:49<07:45, 27.40s/it]
Task 5, Epoch 4/20 => Loss 0.066, Train_accy 97.64:  20%|██        | 4/20 [01:49<07:18, 27.39s/it]
Task 5, Epoch 5/20 => Loss 0.054, Train_accy 98.08, Test_accy 93.30:  20%|██        | 4/20 [02:34<07:18, 27.39s/it]
Task 5, Epoch 5/20 => Loss 0.054, Train_accy 98.08, Test_accy 93.30:  25%|██▌       | 5/20 [02:34<08:23, 33.57s/it]
Task 5, Epoch 6/20 => Loss 0.072, Train_accy 97.24:  25%|██▌       | 5/20 [03:01<08:23, 33.57s/it]                 
Task 5, Epoch 6/20 => Loss 0.072, Train_accy 97.24:  30%|███       | 6/20 [03:01<07:18, 31.32s/it]
Task 5, Epoch 7/20 => Loss 0.060, Train_accy 97.80:  30%|███       | 6/20 [03:28<07:18, 31.32s/it]
Task 5, Epoch 7/20 => Loss 0.060, Train_accy 97.80:  35%|███▌      | 7/20 [03:28<06:30, 30.00s/it]
Task 5, Epoch 8/20 => Loss 0.070, Train_accy 97.72:  35%|███▌      | 7/20 [03:55<06:30, 30.00s/it]
Task 5, Epoch 8/20 => Loss 0.070, Train_accy 97.72:  40%|████      | 8/20 [03:55<05:50, 29.19s/it]
Task 5, Epoch 9/20 => Loss 0.057, Train_accy 98.04:  40%|████      | 8/20 [04:23<05:50, 29.19s/it]
Task 5, Epoch 9/20 => Loss 0.057, Train_accy 98.04:  45%|████▌     | 9/20 [04:23<05:15, 28.65s/it]
Task 5, Epoch 10/20 => Loss 0.067, Train_accy 97.44, Test_accy 93.67:  45%|████▌     | 9/20 [05:07<05:15, 28.65s/it]
Task 5, Epoch 10/20 => Loss 0.067, Train_accy 97.44, Test_accy 93.67:  50%|█████     | 10/20 [05:07<05:35, 33.55s/it]
Task 5, Epoch 11/20 => Loss 0.043, Train_accy 98.68:  50%|█████     | 10/20 [05:35<05:35, 33.55s/it]                 
Task 5, Epoch 11/20 => Loss 0.043, Train_accy 98.68:  55%|█████▌    | 11/20 [05:35<04:45, 31.69s/it]
Task 5, Epoch 12/20 => Loss 0.055, Train_accy 98.08:  55%|█████▌    | 11/20 [06:02<04:45, 31.69s/it]
Task 5, Epoch 12/20 => Loss 0.055, Train_accy 98.08:  60%|██████    | 12/20 [06:02<04:03, 30.40s/it]
Task 5, Epoch 13/20 => Loss 0.043, Train_accy 98.60:  60%|██████    | 12/20 [06:30<04:03, 30.40s/it]
Task 5, Epoch 13/20 => Loss 0.043, Train_accy 98.60:  65%|██████▌   | 13/20 [06:30<03:26, 29.50s/it]
Task 5, Epoch 14/20 => Loss 0.053, Train_accy 98.32:  65%|██████▌   | 13/20 [06:57<03:26, 29.50s/it]
Task 5, Epoch 14/20 => Loss 0.053, Train_accy 98.32:  70%|███████   | 14/20 [06:57<02:53, 28.89s/it]
Task 5, Epoch 15/20 => Loss 0.055, Train_accy 98.00, Test_accy 93.53:  70%|███████   | 14/20 [07:42<02:53, 28.89s/it]
Task 5, Epoch 15/20 => Loss 0.055, Train_accy 98.00, Test_accy 93.53:  75%|███████▌  | 15/20 [07:42<02:48, 33.64s/it]
Task 5, Epoch 16/20 => Loss 0.048, Train_accy 98.32:  75%|███████▌  | 15/20 [08:09<02:48, 33.64s/it]                 
Task 5, Epoch 16/20 => Loss 0.048, Train_accy 98.32:  80%|████████  | 16/20 [08:09<02:07, 31.79s/it]
Task 5, Epoch 17/20 => Loss 0.046, Train_accy 98.48:  80%|████████  | 16/20 [08:37<02:07, 31.79s/it]
Task 5, Epoch 17/20 => Loss 0.046, Train_accy 98.48:  85%|████████▌ | 17/20 [08:37<01:31, 30.50s/it]
Task 5, Epoch 18/20 => Loss 0.051, Train_accy 97.96:  85%|████████▌ | 17/20 [09:04<01:31, 30.50s/it]
Task 5, Epoch 18/20 => Loss 0.051, Train_accy 97.96:  90%|█████████ | 18/20 [09:04<00:59, 29.58s/it]
Task 5, Epoch 19/20 => Loss 0.035, Train_accy 98.72:  90%|█████████ | 18/20 [09:32<00:59, 29.58s/it]
Task 5, Epoch 19/20 => Loss 0.035, Train_accy 98.72:  95%|█████████▌| 19/20 [09:32<00:28, 28.95s/it]
Task 5, Epoch 20/20 => Loss 0.045, Train_accy 98.36, Test_accy 93.43:  95%|█████████▌| 19/20 [10:16<00:28, 28.95s/it]
Task 5, Epoch 20/20 => Loss 0.045, Train_accy 98.36, Test_accy 93.43: 100%|██████████| 20/20 [10:16<00:00, 33.64s/it]
Task 5, Epoch 20/20 => Loss 0.045, Train_accy 98.36, Test_accy 93.43: 100%|██████████| 20/20 [10:16<00:00, 30.84s/it]
2024-09-03 23:13:35,470 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.045, Train_accy 98.36, Test_accy 93.43
2024-09-03 23:13:52,449 [trainer.py] => No NME accuracy.
2024-09-03 23:13:52,450 [trainer.py] => CNN: {'total': 93.43, '00-04': 97.0, '05-09': 91.4, '10-14': 93.4, '15-19': 91.4, '20-24': 94.8, '25-29': 92.6, 'old': 93.6, 'new': 92.6}
2024-09-03 23:13:52,450 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43]
2024-09-03 23:13:52,450 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1]

Average Accuracy (CNN): 96.32
2024-09-03 23:13:52,450 [trainer.py] => Average Accuracy (CNN): 96.32 

2024-09-03 23:13:52,452 [trainer.py] => All params: 89715556
2024-09-03 23:13:52,453 [trainer.py] => Trainable params: 89715556
2024-09-03 23:13:52,788 [coda_prompt.py] => Learning on 30-35

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.468, Train_accy 82.69:   0%|          | 0/20 [00:27<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.468, Train_accy 82.69:   5%|▌         | 1/20 [00:27<08:41, 27.44s/it]
Task 6, Epoch 2/20 => Loss 0.216, Train_accy 91.27:   5%|▌         | 1/20 [00:54<08:41, 27.44s/it]
Task 6, Epoch 2/20 => Loss 0.216, Train_accy 91.27:  10%|█         | 2/20 [00:54<08:13, 27.43s/it]
Task 6, Epoch 3/20 => Loss 0.203, Train_accy 91.87:  10%|█         | 2/20 [01:22<08:13, 27.43s/it]
Task 6, Epoch 3/20 => Loss 0.203, Train_accy 91.87:  15%|█▌        | 3/20 [01:22<07:46, 27.47s/it]
Task 6, Epoch 4/20 => Loss 0.175, Train_accy 93.31:  15%|█▌        | 3/20 [01:49<07:46, 27.47s/it]
Task 6, Epoch 4/20 => Loss 0.175, Train_accy 93.31:  20%|██        | 4/20 [01:49<07:19, 27.46s/it]
Task 6, Epoch 5/20 => Loss 0.173, Train_accy 92.83, Test_accy 89.43:  20%|██        | 4/20 [02:37<07:19, 27.46s/it]
Task 6, Epoch 5/20 => Loss 0.173, Train_accy 92.83, Test_accy 89.43:  25%|██▌       | 5/20 [02:37<08:38, 34.59s/it]
Task 6, Epoch 6/20 => Loss 0.166, Train_accy 92.99:  25%|██▌       | 5/20 [03:04<08:38, 34.59s/it]                 
Task 6, Epoch 6/20 => Loss 0.166, Train_accy 92.99:  30%|███       | 6/20 [03:04<07:30, 32.16s/it]
Task 6, Epoch 7/20 => Loss 0.162, Train_accy 93.71:  30%|███       | 6/20 [03:31<07:30, 32.16s/it]
Task 6, Epoch 7/20 => Loss 0.162, Train_accy 93.71:  35%|███▌      | 7/20 [03:31<06:38, 30.63s/it]
Task 6, Epoch 8/20 => Loss 0.159, Train_accy 93.99:  35%|███▌      | 7/20 [03:59<06:38, 30.63s/it]
Task 6, Epoch 8/20 => Loss 0.159, Train_accy 93.99:  40%|████      | 8/20 [03:59<05:55, 29.61s/it]
Task 6, Epoch 9/20 => Loss 0.137, Train_accy 94.19:  40%|████      | 8/20 [04:26<05:55, 29.61s/it]
Task 6, Epoch 9/20 => Loss 0.137, Train_accy 94.19:  45%|████▌     | 9/20 [04:26<05:18, 28.92s/it]
Task 6, Epoch 10/20 => Loss 0.151, Train_accy 94.27, Test_accy 90.71:  45%|████▌     | 9/20 [05:13<05:18, 28.92s/it]
Task 6, Epoch 10/20 => Loss 0.151, Train_accy 94.27, Test_accy 90.71:  50%|█████     | 10/20 [05:13<05:45, 34.55s/it]
Task 6, Epoch 11/20 => Loss 0.145, Train_accy 94.27:  50%|█████     | 10/20 [05:41<05:45, 34.55s/it]                 
Task 6, Epoch 11/20 => Loss 0.145, Train_accy 94.27:  55%|█████▌    | 11/20 [05:41<04:51, 32.36s/it]
Task 6, Epoch 12/20 => Loss 0.146, Train_accy 94.11:  55%|█████▌    | 11/20 [06:08<04:51, 32.36s/it]
Task 6, Epoch 12/20 => Loss 0.146, Train_accy 94.11:  60%|██████    | 12/20 [06:08<04:06, 30.87s/it]
Task 6, Epoch 13/20 => Loss 0.134, Train_accy 94.83:  60%|██████    | 12/20 [06:36<04:06, 30.87s/it]
Task 6, Epoch 13/20 => Loss 0.134, Train_accy 94.83:  65%|██████▌   | 13/20 [06:36<03:28, 29.85s/it]
Task 6, Epoch 14/20 => Loss 0.130, Train_accy 95.19:  65%|██████▌   | 13/20 [07:03<03:28, 29.85s/it]
Task 6, Epoch 14/20 => Loss 0.130, Train_accy 95.19:  70%|███████   | 14/20 [07:03<02:54, 29.13s/it]
Task 6, Epoch 15/20 => Loss 0.132, Train_accy 94.87, Test_accy 91.20:  70%|███████   | 14/20 [07:51<02:54, 29.13s/it]
Task 6, Epoch 15/20 => Loss 0.132, Train_accy 94.87, Test_accy 91.20:  75%|███████▌  | 15/20 [07:51<02:53, 34.61s/it]
Task 6, Epoch 16/20 => Loss 0.117, Train_accy 95.39:  75%|███████▌  | 15/20 [08:18<02:53, 34.61s/it]                 
Task 6, Epoch 16/20 => Loss 0.117, Train_accy 95.39:  80%|████████  | 16/20 [08:18<02:09, 32.49s/it]
Task 6, Epoch 17/20 => Loss 0.117, Train_accy 95.07:  80%|████████  | 16/20 [08:46<02:09, 32.49s/it]
Task 6, Epoch 17/20 => Loss 0.117, Train_accy 95.07:  85%|████████▌ | 17/20 [08:46<01:32, 30.99s/it]
Task 6, Epoch 18/20 => Loss 0.110, Train_accy 95.55:  85%|████████▌ | 17/20 [09:13<01:32, 30.99s/it]
Task 6, Epoch 18/20 => Loss 0.110, Train_accy 95.55:  90%|█████████ | 18/20 [09:13<00:59, 29.94s/it]
Task 6, Epoch 19/20 => Loss 0.111, Train_accy 95.43:  90%|█████████ | 18/20 [09:40<00:59, 29.94s/it]
Task 6, Epoch 19/20 => Loss 0.111, Train_accy 95.43:  95%|█████████▌| 19/20 [09:40<00:29, 29.14s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.03, Test_accy 91.14:  95%|█████████▌| 19/20 [10:28<00:29, 29.14s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.03, Test_accy 91.14: 100%|██████████| 20/20 [10:28<00:00, 34.61s/it]
Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.03, Test_accy 91.14: 100%|██████████| 20/20 [10:28<00:00, 31.42s/it]
2024-09-03 23:24:21,148 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.124, Train_accy 95.03, Test_accy 91.14
2024-09-03 23:24:41,040 [trainer.py] => No NME accuracy.
2024-09-03 23:24:41,040 [trainer.py] => CNN: {'total': 91.14, '00-04': 97.2, '05-09': 92.0, '10-14': 93.2, '15-19': 91.0, '20-24': 94.0, '25-29': 92.6, '30-34': 78.0, 'old': 93.33, 'new': 78.0}
2024-09-03 23:24:41,041 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14]
2024-09-03 23:24:41,041 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83]

Average Accuracy (CNN): 95.58
2024-09-03 23:24:41,041 [trainer.py] => Average Accuracy (CNN): 95.58 

2024-09-03 23:24:41,042 [trainer.py] => All params: 89715556
2024-09-03 23:24:41,043 [trainer.py] => Trainable params: 89715556
2024-09-03 23:24:41,424 [coda_prompt.py] => Learning on 35-40

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.319, Train_accy 89.02:   0%|          | 0/20 [00:27<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.319, Train_accy 89.02:   5%|▌         | 1/20 [00:27<08:42, 27.49s/it]
Task 7, Epoch 2/20 => Loss 0.094, Train_accy 96.96:   5%|▌         | 1/20 [00:54<08:42, 27.49s/it]
Task 7, Epoch 2/20 => Loss 0.094, Train_accy 96.96:  10%|█         | 2/20 [00:54<08:12, 27.38s/it]
Task 7, Epoch 3/20 => Loss 0.074, Train_accy 97.52:  10%|█         | 2/20 [01:22<08:12, 27.38s/it]
Task 7, Epoch 3/20 => Loss 0.074, Train_accy 97.52:  15%|█▌        | 3/20 [01:22<07:46, 27.43s/it]
Task 7, Epoch 4/20 => Loss 0.084, Train_accy 96.92:  15%|█▌        | 3/20 [01:49<07:46, 27.43s/it]
Task 7, Epoch 4/20 => Loss 0.084, Train_accy 96.92:  20%|██        | 4/20 [01:49<07:19, 27.47s/it]
Task 7, Epoch 5/20 => Loss 0.084, Train_accy 97.00, Test_accy 90.40:  20%|██        | 4/20 [02:39<07:19, 27.47s/it]
Task 7, Epoch 5/20 => Loss 0.084, Train_accy 97.00, Test_accy 90.40:  25%|██▌       | 5/20 [02:39<08:54, 35.65s/it]
Task 7, Epoch 6/20 => Loss 0.056, Train_accy 98.04:  25%|██▌       | 5/20 [03:07<08:54, 35.65s/it]                 
Task 7, Epoch 6/20 => Loss 0.056, Train_accy 98.04:  30%|███       | 6/20 [03:07<07:40, 32.87s/it]
Task 7, Epoch 7/20 => Loss 0.062, Train_accy 98.08:  30%|███       | 6/20 [03:34<07:40, 32.87s/it]
Task 7, Epoch 7/20 => Loss 0.062, Train_accy 98.08:  35%|███▌      | 7/20 [03:34<06:44, 31.12s/it]
Task 7, Epoch 8/20 => Loss 0.054, Train_accy 98.08:  35%|███▌      | 7/20 [04:02<06:44, 31.12s/it]
Task 7, Epoch 8/20 => Loss 0.054, Train_accy 98.08:  40%|████      | 8/20 [04:02<05:59, 29.95s/it]
Task 7, Epoch 9/20 => Loss 0.072, Train_accy 97.64:  40%|████      | 8/20 [04:29<05:59, 29.95s/it]
Task 7, Epoch 9/20 => Loss 0.072, Train_accy 97.64:  45%|████▌     | 9/20 [04:29<05:20, 29.16s/it]
Task 7, Epoch 10/20 => Loss 0.060, Train_accy 98.00, Test_accy 90.55:  45%|████▌     | 9/20 [05:19<05:20, 29.16s/it]
Task 7, Epoch 10/20 => Loss 0.060, Train_accy 98.00, Test_accy 90.55:  50%|█████     | 10/20 [05:19<05:55, 35.59s/it]
Task 7, Epoch 11/20 => Loss 0.057, Train_accy 98.00:  50%|█████     | 10/20 [05:47<05:55, 35.59s/it]                 
Task 7, Epoch 11/20 => Loss 0.057, Train_accy 98.00:  55%|█████▌    | 11/20 [05:47<04:57, 33.10s/it]
Task 7, Epoch 12/20 => Loss 0.059, Train_accy 97.80:  55%|█████▌    | 11/20 [06:14<04:57, 33.10s/it]
Task 7, Epoch 12/20 => Loss 0.059, Train_accy 97.80:  60%|██████    | 12/20 [06:14<04:11, 31.38s/it]
Task 7, Epoch 13/20 => Loss 0.066, Train_accy 97.88:  60%|██████    | 12/20 [06:42<04:11, 31.38s/it]
Task 7, Epoch 13/20 => Loss 0.066, Train_accy 97.88:  65%|██████▌   | 13/20 [06:42<03:31, 30.19s/it]
Task 7, Epoch 14/20 => Loss 0.053, Train_accy 98.08:  65%|██████▌   | 13/20 [07:09<03:31, 30.19s/it]
Task 7, Epoch 14/20 => Loss 0.053, Train_accy 98.08:  70%|███████   | 14/20 [07:09<02:56, 29.39s/it]
Task 7, Epoch 15/20 => Loss 0.056, Train_accy 98.12, Test_accy 90.58:  70%|███████   | 14/20 [07:59<02:56, 29.39s/it]
Task 7, Epoch 15/20 => Loss 0.056, Train_accy 98.12, Test_accy 90.58:  75%|███████▌  | 15/20 [07:59<02:58, 35.66s/it]
Task 7, Epoch 16/20 => Loss 0.056, Train_accy 98.04:  75%|███████▌  | 15/20 [08:27<02:58, 35.66s/it]                 
Task 7, Epoch 16/20 => Loss 0.056, Train_accy 98.04:  80%|████████  | 16/20 [08:27<02:12, 33.22s/it]
Task 7, Epoch 17/20 => Loss 0.060, Train_accy 97.88:  80%|████████  | 16/20 [08:54<02:12, 33.22s/it]
Task 7, Epoch 17/20 => Loss 0.060, Train_accy 97.88:  85%|████████▌ | 17/20 [08:54<01:34, 31.51s/it]
Task 7, Epoch 18/20 => Loss 0.062, Train_accy 97.84:  85%|████████▌ | 17/20 [09:22<01:34, 31.51s/it]
Task 7, Epoch 18/20 => Loss 0.062, Train_accy 97.84:  90%|█████████ | 18/20 [09:22<01:00, 30.33s/it]
Task 7, Epoch 19/20 => Loss 0.059, Train_accy 98.12:  90%|█████████ | 18/20 [09:50<01:00, 30.33s/it]
Task 7, Epoch 19/20 => Loss 0.059, Train_accy 98.12:  95%|█████████▌| 19/20 [09:50<00:29, 29.48s/it]
Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.32, Test_accy 90.50:  95%|█████████▌| 19/20 [10:40<00:29, 29.48s/it]
Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.32, Test_accy 90.50: 100%|██████████| 20/20 [10:40<00:00, 35.68s/it]
Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.32, Test_accy 90.50: 100%|██████████| 20/20 [10:40<00:00, 32.01s/it]
2024-09-03 23:35:21,632 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.053, Train_accy 98.32, Test_accy 90.50
2024-09-03 23:35:44,345 [trainer.py] => No NME accuracy.
2024-09-03 23:35:44,346 [trainer.py] => CNN: {'total': 90.5, '00-04': 96.8, '05-09': 91.8, '10-14': 91.8, '15-19': 89.8, '20-24': 93.6, '25-29': 90.4, '30-34': 77.2, '35-39': 92.6, 'old': 90.2, 'new': 92.6}
2024-09-03 23:35:44,346 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5]
2024-09-03 23:35:44,346 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65]

Average Accuracy (CNN): 94.95
2024-09-03 23:35:44,346 [trainer.py] => Average Accuracy (CNN): 94.95 

2024-09-03 23:35:44,347 [trainer.py] => All params: 89715556
2024-09-03 23:35:44,349 [trainer.py] => Trainable params: 89715556
2024-09-03 23:35:44,782 [coda_prompt.py] => Learning on 40-45

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.374, Train_accy 86.78:   0%|          | 0/20 [00:27<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.374, Train_accy 86.78:   5%|▌         | 1/20 [00:27<08:42, 27.47s/it]
Task 8, Epoch 2/20 => Loss 0.115, Train_accy 95.71:   5%|▌         | 1/20 [00:54<08:42, 27.47s/it]
Task 8, Epoch 2/20 => Loss 0.115, Train_accy 95.71:  10%|█         | 2/20 [00:54<08:14, 27.48s/it]
Task 8, Epoch 3/20 => Loss 0.107, Train_accy 96.71:  10%|█         | 2/20 [01:22<08:14, 27.48s/it]
Task 8, Epoch 3/20 => Loss 0.107, Train_accy 96.71:  15%|█▌        | 3/20 [01:22<07:47, 27.50s/it]
Task 8, Epoch 4/20 => Loss 0.092, Train_accy 97.08:  15%|█▌        | 3/20 [01:50<07:47, 27.50s/it]
Task 8, Epoch 4/20 => Loss 0.092, Train_accy 97.08:  20%|██        | 4/20 [01:50<07:20, 27.52s/it]
Task 8, Epoch 5/20 => Loss 0.093, Train_accy 96.55, Test_accy 88.82:  20%|██        | 4/20 [02:42<07:20, 27.52s/it]
Task 8, Epoch 5/20 => Loss 0.093, Train_accy 96.55, Test_accy 88.82:  25%|██▌       | 5/20 [02:42<09:09, 36.61s/it]
Task 8, Epoch 6/20 => Loss 0.072, Train_accy 97.76:  25%|██▌       | 5/20 [03:10<09:09, 36.61s/it]                 
Task 8, Epoch 6/20 => Loss 0.072, Train_accy 97.76:  30%|███       | 6/20 [03:10<07:48, 33.50s/it]
Task 8, Epoch 7/20 => Loss 0.078, Train_accy 97.20:  30%|███       | 6/20 [03:37<07:48, 33.50s/it]
Task 8, Epoch 7/20 => Loss 0.078, Train_accy 97.20:  35%|███▌      | 7/20 [03:37<06:49, 31.51s/it]
Task 8, Epoch 8/20 => Loss 0.082, Train_accy 97.28:  35%|███▌      | 7/20 [04:05<06:49, 31.51s/it]
Task 8, Epoch 8/20 => Loss 0.082, Train_accy 97.28:  40%|████      | 8/20 [04:05<06:02, 30.22s/it]
Task 8, Epoch 9/20 => Loss 0.086, Train_accy 97.40:  40%|████      | 8/20 [04:32<06:02, 30.22s/it]
Task 8, Epoch 9/20 => Loss 0.086, Train_accy 97.40:  45%|████▌     | 9/20 [04:32<05:22, 29.36s/it]
Task 8, Epoch 10/20 => Loss 0.079, Train_accy 97.52, Test_accy 88.78:  45%|████▌     | 9/20 [05:25<05:22, 29.36s/it]
Task 8, Epoch 10/20 => Loss 0.079, Train_accy 97.52, Test_accy 88.78:  50%|█████     | 10/20 [05:25<06:05, 36.59s/it]
Task 8, Epoch 11/20 => Loss 0.080, Train_accy 97.04:  50%|█████     | 10/20 [05:52<06:05, 36.59s/it]                 
Task 8, Epoch 11/20 => Loss 0.080, Train_accy 97.04:  55%|█████▌    | 11/20 [05:52<05:04, 33.78s/it]
Task 8, Epoch 12/20 => Loss 0.080, Train_accy 97.60:  55%|█████▌    | 11/20 [06:20<05:04, 33.78s/it]
Task 8, Epoch 12/20 => Loss 0.080, Train_accy 97.60:  60%|██████    | 12/20 [06:20<04:14, 31.85s/it]
Task 8, Epoch 13/20 => Loss 0.082, Train_accy 97.24:  60%|██████    | 12/20 [06:47<04:14, 31.85s/it]
Task 8, Epoch 13/20 => Loss 0.082, Train_accy 97.24:  65%|██████▌   | 13/20 [06:47<03:33, 30.52s/it]
Task 8, Epoch 14/20 => Loss 0.066, Train_accy 97.60:  65%|██████▌   | 13/20 [07:15<03:33, 30.52s/it]
Task 8, Epoch 14/20 => Loss 0.066, Train_accy 97.60:  70%|███████   | 14/20 [07:15<02:57, 29.63s/it]
Task 8, Epoch 15/20 => Loss 0.068, Train_accy 97.56, Test_accy 89.07:  70%|███████   | 14/20 [08:08<02:57, 29.63s/it]
Task 8, Epoch 15/20 => Loss 0.068, Train_accy 97.56, Test_accy 89.07:  75%|███████▌  | 15/20 [08:08<03:03, 36.66s/it]
Task 8, Epoch 16/20 => Loss 0.069, Train_accy 97.64:  75%|███████▌  | 15/20 [08:35<03:03, 36.66s/it]                 
Task 8, Epoch 16/20 => Loss 0.069, Train_accy 97.64:  80%|████████  | 16/20 [08:35<02:15, 33.90s/it]
Task 8, Epoch 17/20 => Loss 0.069, Train_accy 97.92:  80%|████████  | 16/20 [09:03<02:15, 33.90s/it]
Task 8, Epoch 17/20 => Loss 0.069, Train_accy 97.92:  85%|████████▌ | 17/20 [09:03<01:35, 31.98s/it]
Task 8, Epoch 18/20 => Loss 0.075, Train_accy 97.48:  85%|████████▌ | 17/20 [09:30<01:35, 31.98s/it]
Task 8, Epoch 18/20 => Loss 0.075, Train_accy 97.48:  90%|█████████ | 18/20 [09:30<01:01, 30.64s/it]
Task 8, Epoch 19/20 => Loss 0.063, Train_accy 98.04:  90%|█████████ | 18/20 [09:58<01:01, 30.64s/it]
Task 8, Epoch 19/20 => Loss 0.063, Train_accy 98.04:  95%|█████████▌| 19/20 [09:58<00:29, 29.70s/it]
Task 8, Epoch 20/20 => Loss 0.063, Train_accy 97.96, Test_accy 89.13:  95%|█████████▌| 19/20 [10:51<00:29, 29.70s/it]
Task 8, Epoch 20/20 => Loss 0.063, Train_accy 97.96, Test_accy 89.13: 100%|██████████| 20/20 [10:51<00:00, 36.68s/it]
Task 8, Epoch 20/20 => Loss 0.063, Train_accy 97.96, Test_accy 89.13: 100%|██████████| 20/20 [10:51<00:00, 32.56s/it]
2024-09-03 23:46:35,977 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.063, Train_accy 97.96, Test_accy 89.13
2024-09-03 23:47:01,390 [trainer.py] => No NME accuracy.
2024-09-03 23:47:01,391 [trainer.py] => CNN: {'total': 89.13, '00-04': 93.8, '05-09': 90.6, '10-14': 87.6, '15-19': 89.4, '20-24': 94.6, '25-29': 89.6, '30-34': 76.0, '35-39': 93.0, '40-44': 87.6, 'old': 89.32, 'new': 87.6}
2024-09-03 23:47:01,391 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13]
2024-09-03 23:47:01,391 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53]

Average Accuracy (CNN): 94.3
2024-09-03 23:47:01,391 [trainer.py] => Average Accuracy (CNN): 94.3 

2024-09-03 23:47:01,393 [trainer.py] => All params: 89715556
2024-09-03 23:47:01,394 [trainer.py] => Trainable params: 89715556
2024-09-03 23:47:01,870 [coda_prompt.py] => Learning on 45-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.349, Train_accy 89.38:   0%|          | 0/20 [00:27<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.349, Train_accy 89.38:   5%|▌         | 1/20 [00:27<08:41, 27.47s/it]
Task 9, Epoch 2/20 => Loss 0.054, Train_accy 98.08:   5%|▌         | 1/20 [00:54<08:41, 27.47s/it]
Task 9, Epoch 2/20 => Loss 0.054, Train_accy 98.08:  10%|█         | 2/20 [00:54<08:14, 27.45s/it]
Task 9, Epoch 3/20 => Loss 0.054, Train_accy 98.08:  10%|█         | 2/20 [01:22<08:14, 27.45s/it]
Task 9, Epoch 3/20 => Loss 0.054, Train_accy 98.08:  15%|█▌        | 3/20 [01:22<07:46, 27.43s/it]
Task 9, Epoch 4/20 => Loss 0.053, Train_accy 98.20:  15%|█▌        | 3/20 [01:49<07:46, 27.43s/it]
Task 9, Epoch 4/20 => Loss 0.053, Train_accy 98.20:  20%|██        | 4/20 [01:49<07:19, 27.44s/it]
Task 9, Epoch 5/20 => Loss 0.039, Train_accy 98.84, Test_accy 87.90:  20%|██        | 4/20 [02:45<07:19, 27.44s/it]
Task 9, Epoch 5/20 => Loss 0.039, Train_accy 98.84, Test_accy 87.90:  25%|██▌       | 5/20 [02:45<09:24, 37.60s/it]
Task 9, Epoch 6/20 => Loss 0.044, Train_accy 98.40:  25%|██▌       | 5/20 [03:12<09:24, 37.60s/it]                 
Task 9, Epoch 6/20 => Loss 0.044, Train_accy 98.40:  30%|███       | 6/20 [03:12<07:58, 34.19s/it]
Task 9, Epoch 7/20 => Loss 0.044, Train_accy 98.52:  30%|███       | 6/20 [03:40<07:58, 34.19s/it]
Task 9, Epoch 7/20 => Loss 0.044, Train_accy 98.52:  35%|███▌      | 7/20 [03:40<06:56, 32.01s/it]
Task 9, Epoch 8/20 => Loss 0.053, Train_accy 98.40:  35%|███▌      | 7/20 [04:07<06:56, 32.01s/it]
Task 9, Epoch 8/20 => Loss 0.053, Train_accy 98.40:  40%|████      | 8/20 [04:07<06:06, 30.57s/it]
Task 9, Epoch 9/20 => Loss 0.052, Train_accy 98.56:  40%|████      | 8/20 [04:35<06:06, 30.57s/it]
Task 9, Epoch 9/20 => Loss 0.052, Train_accy 98.56:  45%|████▌     | 9/20 [04:35<05:25, 29.60s/it]
Task 9, Epoch 10/20 => Loss 0.037, Train_accy 98.76, Test_accy 87.92:  45%|████▌     | 9/20 [05:31<05:25, 29.60s/it]
Task 9, Epoch 10/20 => Loss 0.037, Train_accy 98.76, Test_accy 87.92:  50%|█████     | 10/20 [05:31<06:16, 37.66s/it]
Task 9, Epoch 11/20 => Loss 0.032, Train_accy 98.76:  50%|█████     | 10/20 [05:58<06:16, 37.66s/it]                 
Task 9, Epoch 11/20 => Loss 0.032, Train_accy 98.76:  55%|█████▌    | 11/20 [05:58<05:10, 34.55s/it]
Task 9, Epoch 12/20 => Loss 0.040, Train_accy 98.56:  55%|█████▌    | 11/20 [06:26<05:10, 34.55s/it]
Task 9, Epoch 12/20 => Loss 0.040, Train_accy 98.56:  60%|██████    | 12/20 [06:26<04:19, 32.41s/it]
Task 9, Epoch 13/20 => Loss 0.037, Train_accy 98.36:  60%|██████    | 12/20 [06:53<04:19, 32.41s/it]
Task 9, Epoch 13/20 => Loss 0.037, Train_accy 98.36:  65%|██████▌   | 13/20 [06:53<03:36, 30.95s/it]
Task 9, Epoch 14/20 => Loss 0.041, Train_accy 98.24:  65%|██████▌   | 13/20 [07:21<03:36, 30.95s/it]
Task 9, Epoch 14/20 => Loss 0.041, Train_accy 98.24:  70%|███████   | 14/20 [07:21<02:59, 29.91s/it]
Task 9, Epoch 15/20 => Loss 0.037, Train_accy 98.84, Test_accy 88.00:  70%|███████   | 14/20 [08:17<02:59, 29.91s/it]
Task 9, Epoch 15/20 => Loss 0.037, Train_accy 98.84, Test_accy 88.00:  75%|███████▌  | 15/20 [08:17<03:08, 37.71s/it]
Task 9, Epoch 16/20 => Loss 0.044, Train_accy 98.68:  75%|███████▌  | 15/20 [08:44<03:08, 37.71s/it]                 
Task 9, Epoch 16/20 => Loss 0.044, Train_accy 98.68:  80%|████████  | 16/20 [08:44<02:18, 34.64s/it]
Task 9, Epoch 17/20 => Loss 0.030, Train_accy 98.88:  80%|████████  | 16/20 [09:12<02:18, 34.64s/it]
Task 9, Epoch 17/20 => Loss 0.030, Train_accy 98.88:  85%|████████▌ | 17/20 [09:12<01:37, 32.50s/it]
Task 9, Epoch 18/20 => Loss 0.046, Train_accy 98.36:  85%|████████▌ | 17/20 [09:39<01:37, 32.50s/it]
Task 9, Epoch 18/20 => Loss 0.046, Train_accy 98.36:  90%|█████████ | 18/20 [09:39<01:02, 31.00s/it]
Task 9, Epoch 19/20 => Loss 0.039, Train_accy 98.72:  90%|█████████ | 18/20 [10:07<01:02, 31.00s/it]
Task 9, Epoch 19/20 => Loss 0.039, Train_accy 98.72:  95%|█████████▌| 19/20 [10:07<00:29, 29.96s/it]
Task 9, Epoch 20/20 => Loss 0.033, Train_accy 98.76, Test_accy 88.08:  95%|█████████▌| 19/20 [11:02<00:29, 29.96s/it]
Task 9, Epoch 20/20 => Loss 0.033, Train_accy 98.76, Test_accy 88.08: 100%|██████████| 20/20 [11:02<00:00, 37.69s/it]
Task 9, Epoch 20/20 => Loss 0.033, Train_accy 98.76, Test_accy 88.08: 100%|██████████| 20/20 [11:02<00:00, 33.14s/it]
2024-09-03 23:58:04,705 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.033, Train_accy 98.76, Test_accy 88.08
2024-09-03 23:58:32,927 [trainer.py] => No NME accuracy.
2024-09-03 23:58:32,928 [trainer.py] => CNN: {'total': 88.08, '00-04': 94.2, '05-09': 91.2, '10-14': 87.0, '15-19': 89.0, '20-24': 93.8, '25-29': 88.6, '30-34': 76.4, '35-39': 89.2, '40-44': 86.4, '45-49': 85.0, 'old': 88.42, 'new': 85.0}
2024-09-03 23:58:32,928 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08]
2024-09-03 23:58:32,928 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42]

Average Accuracy (CNN): 93.68
2024-09-03 23:58:32,928 [trainer.py] => Average Accuracy (CNN): 93.68 

2024-09-03 23:58:32,930 [trainer.py] => All params: 89715556
2024-09-03 23:58:32,931 [trainer.py] => Trainable params: 89715556
2024-09-03 23:58:33,473 [coda_prompt.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.292, Train_accy 89.58:   0%|          | 0/20 [00:27<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.292, Train_accy 89.58:   5%|▌         | 1/20 [00:27<08:42, 27.50s/it]
Task 10, Epoch 2/20 => Loss 0.092, Train_accy 96.92:   5%|▌         | 1/20 [00:54<08:42, 27.50s/it]
Task 10, Epoch 2/20 => Loss 0.092, Train_accy 96.92:  10%|█         | 2/20 [00:54<08:14, 27.47s/it]
Task 10, Epoch 3/20 => Loss 0.075, Train_accy 97.24:  10%|█         | 2/20 [01:22<08:14, 27.47s/it]
Task 10, Epoch 3/20 => Loss 0.075, Train_accy 97.24:  15%|█▌        | 3/20 [01:22<07:46, 27.46s/it]
Task 10, Epoch 4/20 => Loss 0.063, Train_accy 97.68:  15%|█▌        | 3/20 [01:49<07:46, 27.46s/it]
Task 10, Epoch 4/20 => Loss 0.063, Train_accy 97.68:  20%|██        | 4/20 [01:49<07:19, 27.46s/it]
Task 10, Epoch 5/20 => Loss 0.079, Train_accy 97.48, Test_accy 86.76:  20%|██        | 4/20 [02:48<07:19, 27.46s/it]
Task 10, Epoch 5/20 => Loss 0.079, Train_accy 97.48, Test_accy 86.76:  25%|██▌       | 5/20 [02:48<09:39, 38.62s/it]
Task 10, Epoch 6/20 => Loss 0.059, Train_accy 97.88:  25%|██▌       | 5/20 [03:15<09:39, 38.62s/it]                 
Task 10, Epoch 6/20 => Loss 0.059, Train_accy 97.88:  30%|███       | 6/20 [03:15<08:07, 34.82s/it]
Task 10, Epoch 7/20 => Loss 0.057, Train_accy 98.00:  30%|███       | 6/20 [03:43<08:07, 34.82s/it]
Task 10, Epoch 7/20 => Loss 0.057, Train_accy 98.00:  35%|███▌      | 7/20 [03:43<07:01, 32.43s/it]
Task 10, Epoch 8/20 => Loss 0.073, Train_accy 97.64:  35%|███▌      | 7/20 [04:10<07:01, 32.43s/it]
Task 10, Epoch 8/20 => Loss 0.073, Train_accy 97.64:  40%|████      | 8/20 [04:10<06:10, 30.86s/it]
Task 10, Epoch 9/20 => Loss 0.062, Train_accy 98.00:  40%|████      | 8/20 [04:38<06:10, 30.86s/it]
Task 10, Epoch 9/20 => Loss 0.062, Train_accy 98.00:  45%|████▌     | 9/20 [04:38<05:27, 29.81s/it]
Task 10, Epoch 10/20 => Loss 0.069, Train_accy 97.52, Test_accy 87.04:  45%|████▌     | 9/20 [05:36<05:27, 29.81s/it]
Task 10, Epoch 10/20 => Loss 0.069, Train_accy 97.52, Test_accy 87.04:  50%|█████     | 10/20 [05:36<06:26, 38.62s/it]
Task 10, Epoch 11/20 => Loss 0.068, Train_accy 97.76:  50%|█████     | 10/20 [06:04<06:26, 38.62s/it]                 
Task 10, Epoch 11/20 => Loss 0.068, Train_accy 97.76:  55%|█████▌    | 11/20 [06:04<05:16, 35.22s/it]
Task 10, Epoch 12/20 => Loss 0.063, Train_accy 97.84:  55%|█████▌    | 11/20 [06:31<05:16, 35.22s/it]
Task 10, Epoch 12/20 => Loss 0.063, Train_accy 97.84:  60%|██████    | 12/20 [06:31<04:22, 32.86s/it]
Task 10, Epoch 13/20 => Loss 0.054, Train_accy 97.88:  60%|██████    | 12/20 [06:59<04:22, 32.86s/it]
Task 10, Epoch 13/20 => Loss 0.054, Train_accy 97.88:  65%|██████▌   | 13/20 [06:59<03:38, 31.24s/it]
Task 10, Epoch 14/20 => Loss 0.051, Train_accy 98.12:  65%|██████▌   | 13/20 [07:26<03:38, 31.24s/it]
Task 10, Epoch 14/20 => Loss 0.051, Train_accy 98.12:  70%|███████   | 14/20 [07:26<03:00, 30.10s/it]
Task 10, Epoch 15/20 => Loss 0.055, Train_accy 98.32, Test_accy 87.02:  70%|███████   | 14/20 [08:24<03:00, 30.10s/it]
Task 10, Epoch 15/20 => Loss 0.055, Train_accy 98.32, Test_accy 87.02:  75%|███████▌  | 15/20 [08:24<03:13, 38.62s/it]
Task 10, Epoch 16/20 => Loss 0.043, Train_accy 98.36:  75%|███████▌  | 15/20 [08:52<03:13, 38.62s/it]                 
Task 10, Epoch 16/20 => Loss 0.043, Train_accy 98.36:  80%|████████  | 16/20 [08:52<02:21, 35.26s/it]
Task 10, Epoch 17/20 => Loss 0.050, Train_accy 98.28:  80%|████████  | 16/20 [09:19<02:21, 35.26s/it]
Task 10, Epoch 17/20 => Loss 0.050, Train_accy 98.28:  85%|████████▌ | 17/20 [09:19<01:38, 32.92s/it]
Task 10, Epoch 18/20 => Loss 0.050, Train_accy 98.40:  85%|████████▌ | 17/20 [09:47<01:38, 32.92s/it]
Task 10, Epoch 18/20 => Loss 0.050, Train_accy 98.40:  90%|█████████ | 18/20 [09:47<01:02, 31.27s/it]
Task 10, Epoch 19/20 => Loss 0.049, Train_accy 98.28:  90%|█████████ | 18/20 [10:14<01:02, 31.27s/it]
Task 10, Epoch 19/20 => Loss 0.049, Train_accy 98.28:  95%|█████████▌| 19/20 [10:14<00:30, 30.15s/it]
Task 10, Epoch 20/20 => Loss 0.049, Train_accy 98.28, Test_accy 87.07:  95%|█████████▌| 19/20 [11:13<00:30, 30.15s/it]
Task 10, Epoch 20/20 => Loss 0.049, Train_accy 98.28, Test_accy 87.07: 100%|██████████| 20/20 [11:13<00:00, 38.69s/it]
Task 10, Epoch 20/20 => Loss 0.049, Train_accy 98.28, Test_accy 87.07: 100%|██████████| 20/20 [11:13<00:00, 33.67s/it]
2024-09-04 00:09:46,865 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.049, Train_accy 98.28, Test_accy 87.07
2024-09-04 00:10:17,895 [trainer.py] => No NME accuracy.
2024-09-04 00:10:17,896 [trainer.py] => CNN: {'total': 87.07, '00-04': 92.4, '05-09': 90.8, '10-14': 87.0, '15-19': 88.8, '20-24': 93.8, '25-29': 87.2, '30-34': 74.8, '35-39': 87.4, '40-44': 86.2, '45-49': 80.8, '50-54': 88.6, 'old': 86.92, 'new': 88.6}
2024-09-04 00:10:17,896 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07]
2024-09-04 00:10:17,896 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4]

Average Accuracy (CNN): 93.08
2024-09-04 00:10:17,896 [trainer.py] => Average Accuracy (CNN): 93.08 

2024-09-04 00:10:17,897 [trainer.py] => All params: 89715556
2024-09-04 00:10:17,898 [trainer.py] => Trainable params: 89715556
2024-09-04 00:10:18,476 [coda_prompt.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.631, Train_accy 77.28:   0%|          | 0/20 [00:27<?, ?it/s]
Task 11, Epoch 1/20 => Loss 0.631, Train_accy 77.28:   5%|▌         | 1/20 [00:27<08:43, 27.55s/it]
Task 11, Epoch 2/20 => Loss 0.228, Train_accy 90.67:   5%|▌         | 1/20 [00:55<08:43, 27.55s/it]
Task 11, Epoch 2/20 => Loss 0.228, Train_accy 90.67:  10%|█         | 2/20 [00:55<08:15, 27.54s/it]
Task 11, Epoch 3/20 => Loss 0.197, Train_accy 91.99:  10%|█         | 2/20 [01:22<08:15, 27.54s/it]
Task 11, Epoch 3/20 => Loss 0.197, Train_accy 91.99:  15%|█▌        | 3/20 [01:22<07:48, 27.55s/it]
Task 11, Epoch 4/20 => Loss 0.193, Train_accy 93.19:  15%|█▌        | 3/20 [01:50<07:48, 27.55s/it]
Task 11, Epoch 4/20 => Loss 0.193, Train_accy 93.19:  20%|██        | 4/20 [01:50<07:20, 27.56s/it]
Task 11, Epoch 5/20 => Loss 0.186, Train_accy 93.15, Test_accy 86.72:  20%|██        | 4/20 [02:51<07:20, 27.56s/it]
Task 11, Epoch 5/20 => Loss 0.186, Train_accy 93.15, Test_accy 86.72:  25%|██▌       | 5/20 [02:51<09:56, 39.75s/it]
Task 11, Epoch 6/20 => Loss 0.167, Train_accy 94.03:  25%|██▌       | 5/20 [03:19<09:56, 39.75s/it]                 
Task 11, Epoch 6/20 => Loss 0.167, Train_accy 94.03:  30%|███       | 6/20 [03:19<08:18, 35.59s/it]
Task 11, Epoch 7/20 => Loss 0.188, Train_accy 92.55:  30%|███       | 6/20 [03:46<08:18, 35.59s/it]
Task 11, Epoch 7/20 => Loss 0.188, Train_accy 92.55:  35%|███▌      | 7/20 [03:46<07:08, 32.95s/it]
Task 11, Epoch 8/20 => Loss 0.154, Train_accy 94.07:  35%|███▌      | 7/20 [04:14<07:08, 32.95s/it]
Task 11, Epoch 8/20 => Loss 0.154, Train_accy 94.07:  40%|████      | 8/20 [04:14<06:14, 31.21s/it]
Task 11, Epoch 9/20 => Loss 0.178, Train_accy 93.39:  40%|████      | 8/20 [04:41<06:14, 31.21s/it]
Task 11, Epoch 9/20 => Loss 0.178, Train_accy 93.39:  45%|████▌     | 9/20 [04:41<05:30, 30.04s/it]
Task 11, Epoch 10/20 => Loss 0.173, Train_accy 93.31, Test_accy 86.87:  45%|████▌     | 9/20 [05:42<05:30, 30.04s/it]
Task 11, Epoch 10/20 => Loss 0.173, Train_accy 93.31, Test_accy 86.87:  50%|█████     | 10/20 [05:42<06:36, 39.68s/it]
Task 11, Epoch 11/20 => Loss 0.154, Train_accy 94.03:  50%|█████     | 10/20 [06:10<06:36, 39.68s/it]                 
Task 11, Epoch 11/20 => Loss 0.154, Train_accy 94.03:  55%|█████▌    | 11/20 [06:10<05:23, 35.93s/it]
Task 11, Epoch 12/20 => Loss 0.162, Train_accy 93.55:  55%|█████▌    | 11/20 [06:37<05:23, 35.93s/it]
Task 11, Epoch 12/20 => Loss 0.162, Train_accy 93.55:  60%|██████    | 12/20 [06:37<04:26, 33.36s/it]
Task 11, Epoch 13/20 => Loss 0.159, Train_accy 93.79:  60%|██████    | 12/20 [07:05<04:26, 33.36s/it]
Task 11, Epoch 13/20 => Loss 0.159, Train_accy 93.79:  65%|██████▌   | 13/20 [07:05<03:41, 31.57s/it]
Task 11, Epoch 14/20 => Loss 0.150, Train_accy 94.71:  65%|██████▌   | 13/20 [07:32<03:41, 31.57s/it]
Task 11, Epoch 14/20 => Loss 0.150, Train_accy 94.71:  70%|███████   | 14/20 [07:32<03:01, 30.31s/it]
Task 11, Epoch 15/20 => Loss 0.157, Train_accy 93.87, Test_accy 86.98:  70%|███████   | 14/20 [08:33<03:01, 30.31s/it]
Task 11, Epoch 15/20 => Loss 0.157, Train_accy 93.87, Test_accy 86.98:  75%|███████▌  | 15/20 [08:33<03:18, 39.62s/it]
Task 11, Epoch 16/20 => Loss 0.137, Train_accy 94.87:  75%|███████▌  | 15/20 [09:01<03:18, 39.62s/it]                 
Task 11, Epoch 16/20 => Loss 0.137, Train_accy 94.87:  80%|████████  | 16/20 [09:01<02:23, 35.97s/it]
Task 11, Epoch 17/20 => Loss 0.142, Train_accy 94.59:  80%|████████  | 16/20 [09:28<02:23, 35.97s/it]
Task 11, Epoch 17/20 => Loss 0.142, Train_accy 94.59:  85%|████████▌ | 17/20 [09:28<01:40, 33.42s/it]
Task 11, Epoch 18/20 => Loss 0.152, Train_accy 94.03:  85%|████████▌ | 17/20 [09:56<01:40, 33.42s/it]
Task 11, Epoch 18/20 => Loss 0.152, Train_accy 94.03:  90%|█████████ | 18/20 [09:56<01:03, 31.66s/it]
Task 11, Epoch 19/20 => Loss 0.158, Train_accy 94.19:  90%|█████████ | 18/20 [10:23<01:03, 31.66s/it]
Task 11, Epoch 19/20 => Loss 0.158, Train_accy 94.19:  95%|█████████▌| 19/20 [10:23<00:30, 30.43s/it]
Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.27, Test_accy 86.93:  95%|█████████▌| 19/20 [11:25<00:30, 30.43s/it]
Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.27, Test_accy 86.93: 100%|██████████| 20/20 [11:25<00:00, 39.72s/it]
Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.27, Test_accy 86.93: 100%|██████████| 20/20 [11:25<00:00, 34.26s/it]
2024-09-04 00:21:43,776 [coda_prompt.py] => Task 11, Epoch 20/20 => Loss 0.131, Train_accy 95.27, Test_accy 86.93
2024-09-04 00:22:17,544 [trainer.py] => No NME accuracy.
2024-09-04 00:22:17,544 [trainer.py] => CNN: {'total': 86.93, '00-04': 93.4, '05-09': 91.0, '10-14': 87.8, '15-19': 88.4, '20-24': 92.0, '25-29': 89.6, '30-34': 75.4, '35-39': 87.2, '40-44': 84.6, '45-49': 80.2, '50-54': 86.4, '55-59': 87.2, 'old': 86.91, 'new': 87.2}
2024-09-04 00:22:17,544 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93]
2024-09-04 00:22:17,544 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15]

Average Accuracy (CNN): 92.57
2024-09-04 00:22:17,545 [trainer.py] => Average Accuracy (CNN): 92.57 

2024-09-04 00:22:17,545 [trainer.py] => All params: 89715556
2024-09-04 00:22:17,546 [trainer.py] => Trainable params: 89715556
2024-09-04 00:22:18,173 [coda_prompt.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.231, Train_accy 92.03:   0%|          | 0/20 [00:27<?, ?it/s]
Task 12, Epoch 1/20 => Loss 0.231, Train_accy 92.03:   5%|▌         | 1/20 [00:27<08:42, 27.52s/it]
Task 12, Epoch 2/20 => Loss 0.094, Train_accy 96.92:   5%|▌         | 1/20 [00:55<08:42, 27.52s/it]
Task 12, Epoch 2/20 => Loss 0.094, Train_accy 96.92:  10%|█         | 2/20 [00:55<08:15, 27.54s/it]
Task 12, Epoch 3/20 => Loss 0.067, Train_accy 97.88:  10%|█         | 2/20 [01:22<08:15, 27.54s/it]
Task 12, Epoch 3/20 => Loss 0.067, Train_accy 97.88:  15%|█▌        | 3/20 [01:22<07:48, 27.55s/it]
Task 12, Epoch 4/20 => Loss 0.067, Train_accy 97.76:  15%|█▌        | 3/20 [01:50<07:48, 27.55s/it]
Task 12, Epoch 4/20 => Loss 0.067, Train_accy 97.76:  20%|██        | 4/20 [01:50<07:20, 27.56s/it]
Task 12, Epoch 5/20 => Loss 0.052, Train_accy 98.00, Test_accy 85.82:  20%|██        | 4/20 [02:54<07:20, 27.56s/it]
Task 12, Epoch 5/20 => Loss 0.052, Train_accy 98.00, Test_accy 85.82:  25%|██▌       | 5/20 [02:54<10:10, 40.72s/it]
Task 12, Epoch 6/20 => Loss 0.067, Train_accy 97.56:  25%|██▌       | 5/20 [03:21<10:10, 40.72s/it]                 
Task 12, Epoch 6/20 => Loss 0.067, Train_accy 97.56:  30%|███       | 6/20 [03:21<08:27, 36.23s/it]
Task 12, Epoch 7/20 => Loss 0.070, Train_accy 97.64:  30%|███       | 6/20 [03:49<08:27, 36.23s/it]
Task 12, Epoch 7/20 => Loss 0.070, Train_accy 97.64:  35%|███▌      | 7/20 [03:49<07:13, 33.36s/it]
Task 12, Epoch 8/20 => Loss 0.048, Train_accy 98.20:  35%|███▌      | 7/20 [04:16<07:13, 33.36s/it]
Task 12, Epoch 8/20 => Loss 0.048, Train_accy 98.20:  40%|████      | 8/20 [04:16<06:18, 31.50s/it]
Task 12, Epoch 9/20 => Loss 0.058, Train_accy 97.92:  40%|████      | 8/20 [04:44<06:18, 31.50s/it]
Task 12, Epoch 9/20 => Loss 0.058, Train_accy 97.92:  45%|████▌     | 9/20 [04:44<05:32, 30.25s/it]
Task 12, Epoch 10/20 => Loss 0.070, Train_accy 97.76, Test_accy 85.80:  45%|████▌     | 9/20 [05:48<05:32, 30.25s/it]
Task 12, Epoch 10/20 => Loss 0.070, Train_accy 97.76, Test_accy 85.80:  50%|█████     | 10/20 [05:48<06:47, 40.73s/it]
Task 12, Epoch 11/20 => Loss 0.053, Train_accy 98.08:  50%|█████     | 10/20 [06:15<06:47, 40.73s/it]                 
Task 12, Epoch 11/20 => Loss 0.053, Train_accy 98.08:  55%|█████▌    | 11/20 [06:15<05:29, 36.66s/it]
Task 12, Epoch 12/20 => Loss 0.047, Train_accy 98.28:  55%|█████▌    | 11/20 [06:43<05:29, 36.66s/it]
Task 12, Epoch 12/20 => Loss 0.047, Train_accy 98.28:  60%|██████    | 12/20 [06:43<04:30, 33.86s/it]
Task 12, Epoch 13/20 => Loss 0.050, Train_accy 98.28:  60%|██████    | 12/20 [07:10<04:30, 33.86s/it]
Task 12, Epoch 13/20 => Loss 0.050, Train_accy 98.28:  65%|██████▌   | 13/20 [07:10<03:43, 31.94s/it]
Task 12, Epoch 14/20 => Loss 0.055, Train_accy 98.16:  65%|██████▌   | 13/20 [07:38<03:43, 31.94s/it]
Task 12, Epoch 14/20 => Loss 0.055, Train_accy 98.16:  70%|███████   | 14/20 [07:38<03:03, 30.63s/it]
Task 12, Epoch 15/20 => Loss 0.047, Train_accy 98.44, Test_accy 85.43:  70%|███████   | 14/20 [08:42<03:03, 30.63s/it]
Task 12, Epoch 15/20 => Loss 0.047, Train_accy 98.44, Test_accy 85.43:  75%|███████▌  | 15/20 [08:42<03:23, 40.73s/it]
Task 12, Epoch 16/20 => Loss 0.052, Train_accy 98.28:  75%|███████▌  | 15/20 [09:10<03:23, 40.73s/it]                 
Task 12, Epoch 16/20 => Loss 0.052, Train_accy 98.28:  80%|████████  | 16/20 [09:10<02:26, 36.75s/it]
Task 12, Epoch 17/20 => Loss 0.065, Train_accy 97.76:  80%|████████  | 16/20 [09:37<02:26, 36.75s/it]
Task 12, Epoch 17/20 => Loss 0.065, Train_accy 97.76:  85%|████████▌ | 17/20 [09:37<01:41, 33.96s/it]
Task 12, Epoch 18/20 => Loss 0.052, Train_accy 98.48:  85%|████████▌ | 17/20 [10:05<01:41, 33.96s/it]
Task 12, Epoch 18/20 => Loss 0.052, Train_accy 98.48:  90%|█████████ | 18/20 [10:05<01:04, 32.02s/it]
Task 12, Epoch 19/20 => Loss 0.051, Train_accy 98.08:  90%|█████████ | 18/20 [10:32<01:04, 32.02s/it]
Task 12, Epoch 19/20 => Loss 0.051, Train_accy 98.08:  95%|█████████▌| 19/20 [10:32<00:30, 30.66s/it]
Task 12, Epoch 20/20 => Loss 0.045, Train_accy 98.40, Test_accy 85.60:  95%|█████████▌| 19/20 [11:36<00:30, 30.66s/it]
Task 12, Epoch 20/20 => Loss 0.045, Train_accy 98.40, Test_accy 85.60: 100%|██████████| 20/20 [11:36<00:00, 40.66s/it]
Task 12, Epoch 20/20 => Loss 0.045, Train_accy 98.40, Test_accy 85.60: 100%|██████████| 20/20 [11:36<00:00, 34.83s/it]
2024-09-04 00:33:54,730 [coda_prompt.py] => Task 12, Epoch 20/20 => Loss 0.045, Train_accy 98.40, Test_accy 85.60
2024-09-04 00:34:31,317 [trainer.py] => No NME accuracy.
2024-09-04 00:34:31,317 [trainer.py] => CNN: {'total': 85.6, '00-04': 93.2, '05-09': 91.0, '10-14': 86.8, '15-19': 82.2, '20-24': 92.8, '25-29': 86.6, '30-34': 74.8, '35-39': 87.2, '40-44': 84.8, '45-49': 80.4, '50-54': 87.2, '55-59': 72.6, '60-64': 93.2, 'old': 84.97, 'new': 93.2}
2024-09-04 00:34:31,317 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6]
2024-09-04 00:34:31,317 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02]

Average Accuracy (CNN): 92.03
2024-09-04 00:34:31,318 [trainer.py] => Average Accuracy (CNN): 92.03 

2024-09-04 00:34:31,319 [trainer.py] => All params: 89715556
2024-09-04 00:34:31,320 [trainer.py] => Trainable params: 89715556
2024-09-04 00:34:31,996 [coda_prompt.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.295, Train_accy 89.34:   0%|          | 0/20 [00:27<?, ?it/s]
Task 13, Epoch 1/20 => Loss 0.295, Train_accy 89.34:   5%|▌         | 1/20 [00:27<08:42, 27.51s/it]
Task 13, Epoch 2/20 => Loss 0.067, Train_accy 97.92:   5%|▌         | 1/20 [00:54<08:42, 27.51s/it]
Task 13, Epoch 2/20 => Loss 0.067, Train_accy 97.92:  10%|█         | 2/20 [00:54<08:14, 27.50s/it]
Task 13, Epoch 3/20 => Loss 0.057, Train_accy 98.12:  10%|█         | 2/20 [01:22<08:14, 27.50s/it]
Task 13, Epoch 3/20 => Loss 0.057, Train_accy 98.12:  15%|█▌        | 3/20 [01:22<07:47, 27.49s/it]
Task 13, Epoch 4/20 => Loss 0.054, Train_accy 98.04:  15%|█▌        | 3/20 [01:49<07:47, 27.49s/it]
Task 13, Epoch 4/20 => Loss 0.054, Train_accy 98.04:  20%|██        | 4/20 [01:49<07:19, 27.50s/it]
Task 13, Epoch 5/20 => Loss 0.045, Train_accy 98.44, Test_accy 85.30:  20%|██        | 4/20 [02:56<07:19, 27.50s/it]
Task 13, Epoch 5/20 => Loss 0.045, Train_accy 98.44, Test_accy 85.30:  25%|██▌       | 5/20 [02:56<10:24, 41.66s/it]
Task 13, Epoch 6/20 => Loss 0.040, Train_accy 98.64:  25%|██▌       | 5/20 [03:24<10:24, 41.66s/it]                 
Task 13, Epoch 6/20 => Loss 0.040, Train_accy 98.64:  30%|███       | 6/20 [03:24<08:36, 36.88s/it]
Task 13, Epoch 7/20 => Loss 0.058, Train_accy 98.12:  30%|███       | 6/20 [03:51<08:36, 36.88s/it]
Task 13, Epoch 7/20 => Loss 0.058, Train_accy 98.12:  35%|███▌      | 7/20 [03:51<07:19, 33.82s/it]
Task 13, Epoch 8/20 => Loss 0.056, Train_accy 98.16:  35%|███▌      | 7/20 [04:19<07:19, 33.82s/it]
Task 13, Epoch 8/20 => Loss 0.056, Train_accy 98.16:  40%|████      | 8/20 [04:19<06:21, 31.83s/it]
Task 13, Epoch 9/20 => Loss 0.035, Train_accy 98.60:  40%|████      | 8/20 [04:46<06:21, 31.83s/it]
Task 13, Epoch 9/20 => Loss 0.035, Train_accy 98.60:  45%|████▌     | 9/20 [04:46<05:35, 30.49s/it]
Task 13, Epoch 10/20 => Loss 0.043, Train_accy 98.72, Test_accy 85.37:  45%|████▌     | 9/20 [05:54<05:35, 30.49s/it]
Task 13, Epoch 10/20 => Loss 0.043, Train_accy 98.72, Test_accy 85.37:  50%|█████     | 10/20 [05:54<06:57, 41.77s/it]
Task 13, Epoch 11/20 => Loss 0.036, Train_accy 98.80:  50%|█████     | 10/20 [06:21<06:57, 41.77s/it]                 
Task 13, Epoch 11/20 => Loss 0.036, Train_accy 98.80:  55%|█████▌    | 11/20 [06:21<05:36, 37.42s/it]
Task 13, Epoch 12/20 => Loss 0.039, Train_accy 98.56:  55%|█████▌    | 11/20 [06:49<05:36, 37.42s/it]
Task 13, Epoch 12/20 => Loss 0.039, Train_accy 98.56:  60%|██████    | 12/20 [06:49<04:35, 34.44s/it]
Task 13, Epoch 13/20 => Loss 0.043, Train_accy 98.52:  60%|██████    | 12/20 [07:16<04:35, 34.44s/it]
Task 13, Epoch 13/20 => Loss 0.043, Train_accy 98.52:  65%|██████▌   | 13/20 [07:16<03:46, 32.36s/it]
Task 13, Epoch 14/20 => Loss 0.039, Train_accy 98.56:  65%|██████▌   | 13/20 [07:44<03:46, 32.36s/it]
Task 13, Epoch 14/20 => Loss 0.039, Train_accy 98.56:  70%|███████   | 14/20 [07:44<03:05, 30.93s/it]
Task 13, Epoch 15/20 => Loss 0.049, Train_accy 98.48, Test_accy 85.30:  70%|███████   | 14/20 [08:51<03:05, 30.93s/it]
Task 13, Epoch 15/20 => Loss 0.049, Train_accy 98.48, Test_accy 85.30:  75%|███████▌  | 15/20 [08:51<03:28, 41.79s/it]
Task 13, Epoch 16/20 => Loss 0.031, Train_accy 98.92:  75%|███████▌  | 15/20 [09:18<03:28, 41.79s/it]                 
Task 13, Epoch 16/20 => Loss 0.031, Train_accy 98.92:  80%|████████  | 16/20 [09:18<02:30, 37.51s/it]
Task 13, Epoch 17/20 => Loss 0.042, Train_accy 98.68:  80%|████████  | 16/20 [09:46<02:30, 37.51s/it]
Task 13, Epoch 17/20 => Loss 0.042, Train_accy 98.68:  85%|████████▌ | 17/20 [09:46<01:43, 34.45s/it]
Task 13, Epoch 18/20 => Loss 0.042, Train_accy 98.60:  85%|████████▌ | 17/20 [10:13<01:43, 34.45s/it]
Task 13, Epoch 18/20 => Loss 0.042, Train_accy 98.60:  90%|█████████ | 18/20 [10:13<01:04, 32.36s/it]
Task 13, Epoch 19/20 => Loss 0.038, Train_accy 98.76:  90%|█████████ | 18/20 [10:41<01:04, 32.36s/it]
Task 13, Epoch 19/20 => Loss 0.038, Train_accy 98.76:  95%|█████████▌| 19/20 [10:41<00:30, 30.92s/it]
Task 13, Epoch 20/20 => Loss 0.043, Train_accy 98.36, Test_accy 85.40:  95%|█████████▌| 19/20 [11:48<00:30, 30.92s/it]
Task 13, Epoch 20/20 => Loss 0.043, Train_accy 98.36, Test_accy 85.40: 100%|██████████| 20/20 [11:48<00:00, 41.67s/it]
Task 13, Epoch 20/20 => Loss 0.043, Train_accy 98.36, Test_accy 85.40: 100%|██████████| 20/20 [11:48<00:00, 35.40s/it]
2024-09-04 00:46:20,071 [coda_prompt.py] => Task 13, Epoch 20/20 => Loss 0.043, Train_accy 98.36, Test_accy 85.40
2024-09-04 00:46:59,304 [trainer.py] => No NME accuracy.
2024-09-04 00:46:59,305 [trainer.py] => CNN: {'total': 85.4, '00-04': 92.4, '05-09': 90.2, '10-14': 83.4, '15-19': 82.6, '20-24': 92.8, '25-29': 86.8, '30-34': 73.6, '35-39': 87.2, '40-44': 84.6, '45-49': 80.0, '50-54': 85.8, '55-59': 71.2, '60-64': 91.8, '65-69': 93.2, 'old': 84.8, 'new': 93.2}
2024-09-04 00:46:59,305 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4]
2024-09-04 00:46:59,305 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94]

Average Accuracy (CNN): 91.56
2024-09-04 00:46:59,305 [trainer.py] => Average Accuracy (CNN): 91.56 

2024-09-04 00:46:59,306 [trainer.py] => All params: 89715556
2024-09-04 00:46:59,307 [trainer.py] => Trainable params: 89715556
2024-09-04 00:47:00,027 [coda_prompt.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.332, Train_accy 88.14:   0%|          | 0/20 [00:27<?, ?it/s]
Task 14, Epoch 1/20 => Loss 0.332, Train_accy 88.14:   5%|▌         | 1/20 [00:27<08:42, 27.52s/it]
Task 14, Epoch 2/20 => Loss 0.099, Train_accy 96.75:   5%|▌         | 1/20 [00:55<08:42, 27.52s/it]
Task 14, Epoch 2/20 => Loss 0.099, Train_accy 96.75:  10%|█         | 2/20 [00:55<08:15, 27.52s/it]
Task 14, Epoch 3/20 => Loss 0.085, Train_accy 97.16:  10%|█         | 2/20 [01:22<08:15, 27.52s/it]
Task 14, Epoch 3/20 => Loss 0.085, Train_accy 97.16:  15%|█▌        | 3/20 [01:22<07:47, 27.53s/it]
Task 14, Epoch 4/20 => Loss 0.084, Train_accy 97.28:  15%|█▌        | 3/20 [01:50<07:47, 27.53s/it]
Task 14, Epoch 4/20 => Loss 0.084, Train_accy 97.28:  20%|██        | 4/20 [01:50<07:20, 27.53s/it]
Task 14, Epoch 5/20 => Loss 0.078, Train_accy 97.16, Test_accy 83.15:  20%|██        | 4/20 [02:59<07:20, 27.53s/it]
Task 14, Epoch 5/20 => Loss 0.078, Train_accy 97.16, Test_accy 83.15:  25%|██▌       | 5/20 [02:59<10:40, 42.69s/it]
Task 14, Epoch 6/20 => Loss 0.077, Train_accy 97.44:  25%|██▌       | 5/20 [03:27<10:40, 42.69s/it]                 
Task 14, Epoch 6/20 => Loss 0.077, Train_accy 97.44:  30%|███       | 6/20 [03:27<08:45, 37.53s/it]
Task 14, Epoch 7/20 => Loss 0.065, Train_accy 97.80:  30%|███       | 6/20 [03:54<08:45, 37.53s/it]
Task 14, Epoch 7/20 => Loss 0.065, Train_accy 97.80:  35%|███▌      | 7/20 [03:54<07:25, 34.26s/it]
Task 14, Epoch 8/20 => Loss 0.061, Train_accy 97.72:  35%|███▌      | 7/20 [04:22<07:25, 34.26s/it]
Task 14, Epoch 8/20 => Loss 0.061, Train_accy 97.72:  40%|████      | 8/20 [04:22<06:25, 32.13s/it]
Task 14, Epoch 9/20 => Loss 0.063, Train_accy 97.92:  40%|████      | 8/20 [04:49<06:25, 32.13s/it]
Task 14, Epoch 9/20 => Loss 0.063, Train_accy 97.92:  45%|████▌     | 9/20 [04:49<05:37, 30.69s/it]
Task 14, Epoch 10/20 => Loss 0.087, Train_accy 97.32, Test_accy 83.69:  45%|████▌     | 9/20 [05:59<05:37, 30.69s/it]
Task 14, Epoch 10/20 => Loss 0.087, Train_accy 97.32, Test_accy 83.69:  50%|█████     | 10/20 [05:59<07:07, 42.72s/it]
Task 14, Epoch 11/20 => Loss 0.064, Train_accy 98.04:  50%|█████     | 10/20 [06:26<07:07, 42.72s/it]                 
Task 14, Epoch 11/20 => Loss 0.064, Train_accy 98.04:  55%|█████▌    | 11/20 [06:26<05:42, 38.07s/it]
Task 14, Epoch 12/20 => Loss 0.058, Train_accy 97.88:  55%|█████▌    | 11/20 [06:54<05:42, 38.07s/it]
Task 14, Epoch 12/20 => Loss 0.058, Train_accy 97.88:  60%|██████    | 12/20 [06:54<04:38, 34.87s/it]
Task 14, Epoch 13/20 => Loss 0.062, Train_accy 97.88:  60%|██████    | 12/20 [07:22<04:38, 34.87s/it]
Task 14, Epoch 13/20 => Loss 0.062, Train_accy 97.88:  65%|██████▌   | 13/20 [07:22<03:48, 32.63s/it]
Task 14, Epoch 14/20 => Loss 0.062, Train_accy 97.96:  65%|██████▌   | 13/20 [07:49<03:48, 32.63s/it]
Task 14, Epoch 14/20 => Loss 0.062, Train_accy 97.96:  70%|███████   | 14/20 [07:49<03:06, 31.01s/it]
Task 14, Epoch 15/20 => Loss 0.062, Train_accy 97.56, Test_accy 84.05:  70%|███████   | 14/20 [08:59<03:06, 31.01s/it]
Task 14, Epoch 15/20 => Loss 0.062, Train_accy 97.56, Test_accy 84.05:  75%|███████▌  | 15/20 [08:59<03:33, 42.70s/it]
Task 14, Epoch 16/20 => Loss 0.061, Train_accy 97.76:  75%|███████▌  | 15/20 [09:26<03:33, 42.70s/it]                 
Task 14, Epoch 16/20 => Loss 0.061, Train_accy 97.76:  80%|████████  | 16/20 [09:26<02:32, 38.14s/it]
Task 14, Epoch 17/20 => Loss 0.060, Train_accy 97.88:  80%|████████  | 16/20 [09:54<02:32, 38.14s/it]
Task 14, Epoch 17/20 => Loss 0.060, Train_accy 97.88:  85%|████████▌ | 17/20 [09:54<01:44, 34.95s/it]
Task 14, Epoch 18/20 => Loss 0.061, Train_accy 97.96:  85%|████████▌ | 17/20 [10:21<01:44, 34.95s/it]
Task 14, Epoch 18/20 => Loss 0.061, Train_accy 97.96:  90%|█████████ | 18/20 [10:21<01:05, 32.73s/it]
Task 14, Epoch 19/20 => Loss 0.046, Train_accy 98.52:  90%|█████████ | 18/20 [10:49<01:05, 32.73s/it]
Task 14, Epoch 19/20 => Loss 0.046, Train_accy 98.52:  95%|█████████▌| 19/20 [10:49<00:31, 31.17s/it]
Task 14, Epoch 20/20 => Loss 0.062, Train_accy 98.00, Test_accy 84.09:  95%|█████████▌| 19/20 [11:58<00:31, 31.17s/it]
Task 14, Epoch 20/20 => Loss 0.062, Train_accy 98.00, Test_accy 84.09: 100%|██████████| 20/20 [11:58<00:00, 42.74s/it]
Task 14, Epoch 20/20 => Loss 0.062, Train_accy 98.00, Test_accy 84.09: 100%|██████████| 20/20 [11:58<00:00, 35.95s/it]
2024-09-04 00:58:59,021 [coda_prompt.py] => Task 14, Epoch 20/20 => Loss 0.062, Train_accy 98.00, Test_accy 84.09
2024-09-04 00:59:41,175 [trainer.py] => No NME accuracy.
2024-09-04 00:59:41,176 [trainer.py] => CNN: {'total': 84.09, '00-04': 92.4, '05-09': 90.2, '10-14': 84.6, '15-19': 82.6, '20-24': 93.4, '25-29': 86.0, '30-34': 74.6, '35-39': 86.6, '40-44': 85.2, '45-49': 79.8, '50-54': 87.4, '55-59': 67.0, '60-64': 87.6, '65-69': 92.6, '70-74': 71.4, 'old': 85.0, 'new': 71.4}
2024-09-04 00:59:41,176 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09]
2024-09-04 00:59:41,176 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83]

Average Accuracy (CNN): 91.06
2024-09-04 00:59:41,176 [trainer.py] => Average Accuracy (CNN): 91.06 

2024-09-04 00:59:41,177 [trainer.py] => All params: 89715556
2024-09-04 00:59:41,178 [trainer.py] => Trainable params: 89715556
2024-09-04 00:59:41,959 [coda_prompt.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.310, Train_accy 89.42:   0%|          | 0/20 [00:27<?, ?it/s]
Task 15, Epoch 1/20 => Loss 0.310, Train_accy 89.42:   5%|▌         | 1/20 [00:27<08:43, 27.57s/it]
Task 15, Epoch 2/20 => Loss 0.085, Train_accy 97.28:   5%|▌         | 1/20 [00:55<08:43, 27.57s/it]
Task 15, Epoch 2/20 => Loss 0.085, Train_accy 97.28:  10%|█         | 2/20 [00:55<08:16, 27.57s/it]
Task 15, Epoch 3/20 => Loss 0.096, Train_accy 96.83:  10%|█         | 2/20 [01:22<08:16, 27.57s/it]
Task 15, Epoch 3/20 => Loss 0.096, Train_accy 96.83:  15%|█▌        | 3/20 [01:22<07:49, 27.59s/it]
Task 15, Epoch 4/20 => Loss 0.090, Train_accy 96.92:  15%|█▌        | 3/20 [01:50<07:49, 27.59s/it]
Task 15, Epoch 4/20 => Loss 0.090, Train_accy 96.92:  20%|██        | 4/20 [01:50<07:21, 27.59s/it]
Task 15, Epoch 5/20 => Loss 0.066, Train_accy 97.60, Test_accy 82.84:  20%|██        | 4/20 [03:02<07:21, 27.59s/it]
Task 15, Epoch 5/20 => Loss 0.066, Train_accy 97.60, Test_accy 82.84:  25%|██▌       | 5/20 [03:02<10:56, 43.79s/it]
Task 15, Epoch 6/20 => Loss 0.063, Train_accy 97.92:  25%|██▌       | 5/20 [03:30<10:56, 43.79s/it]                 
Task 15, Epoch 6/20 => Loss 0.063, Train_accy 97.92:  30%|███       | 6/20 [03:30<08:55, 38.27s/it]
Task 15, Epoch 7/20 => Loss 0.062, Train_accy 97.72:  30%|███       | 6/20 [03:58<08:55, 38.27s/it]
Task 15, Epoch 7/20 => Loss 0.062, Train_accy 97.72:  35%|███▌      | 7/20 [03:58<07:32, 34.80s/it]
Task 15, Epoch 8/20 => Loss 0.076, Train_accy 97.52:  35%|███▌      | 7/20 [04:25<07:32, 34.80s/it]
Task 15, Epoch 8/20 => Loss 0.076, Train_accy 97.52:  40%|████      | 8/20 [04:25<06:29, 32.49s/it]
Task 15, Epoch 9/20 => Loss 0.062, Train_accy 97.80:  40%|████      | 8/20 [04:53<06:29, 32.49s/it]
Task 15, Epoch 9/20 => Loss 0.062, Train_accy 97.80:  45%|████▌     | 9/20 [04:53<05:40, 30.96s/it]
Task 15, Epoch 10/20 => Loss 0.057, Train_accy 98.28, Test_accy 82.85:  45%|████▌     | 9/20 [06:05<05:40, 30.96s/it]
Task 15, Epoch 10/20 => Loss 0.057, Train_accy 98.28, Test_accy 82.85:  50%|█████     | 10/20 [06:05<07:17, 43.78s/it]
Task 15, Epoch 11/20 => Loss 0.060, Train_accy 98.16:  50%|█████     | 10/20 [06:33<07:17, 43.78s/it]                 
Task 15, Epoch 11/20 => Loss 0.060, Train_accy 98.16:  55%|█████▌    | 11/20 [06:33<05:49, 38.81s/it]
Task 15, Epoch 12/20 => Loss 0.053, Train_accy 98.08:  55%|█████▌    | 11/20 [07:00<05:49, 38.81s/it]
Task 15, Epoch 12/20 => Loss 0.053, Train_accy 98.08:  60%|██████    | 12/20 [07:00<04:43, 35.40s/it]
Task 15, Epoch 13/20 => Loss 0.058, Train_accy 98.08:  60%|██████    | 12/20 [07:28<04:43, 35.40s/it]
Task 15, Epoch 13/20 => Loss 0.058, Train_accy 98.08:  65%|██████▌   | 13/20 [07:28<03:51, 33.03s/it]
Task 15, Epoch 14/20 => Loss 0.052, Train_accy 98.16:  65%|██████▌   | 13/20 [07:56<03:51, 33.03s/it]
Task 15, Epoch 14/20 => Loss 0.052, Train_accy 98.16:  70%|███████   | 14/20 [07:56<03:08, 31.40s/it]
Task 15, Epoch 15/20 => Loss 0.063, Train_accy 97.84, Test_accy 82.65:  70%|███████   | 14/20 [09:08<03:08, 31.40s/it]
Task 15, Epoch 15/20 => Loss 0.063, Train_accy 97.84, Test_accy 82.65:  75%|███████▌  | 15/20 [09:08<03:39, 43.82s/it]
Task 15, Epoch 16/20 => Loss 0.064, Train_accy 97.84:  75%|███████▌  | 15/20 [09:36<03:39, 43.82s/it]                 
Task 15, Epoch 16/20 => Loss 0.064, Train_accy 97.84:  80%|████████  | 16/20 [09:36<02:35, 38.95s/it]
Task 15, Epoch 17/20 => Loss 0.053, Train_accy 98.24:  80%|████████  | 16/20 [10:03<02:35, 38.95s/it]
Task 15, Epoch 17/20 => Loss 0.053, Train_accy 98.24:  85%|████████▌ | 17/20 [10:03<01:46, 35.51s/it]
Task 15, Epoch 18/20 => Loss 0.044, Train_accy 98.52:  85%|████████▌ | 17/20 [10:31<01:46, 35.51s/it]
Task 15, Epoch 18/20 => Loss 0.044, Train_accy 98.52:  90%|█████████ | 18/20 [10:31<01:06, 33.11s/it]
Task 15, Epoch 19/20 => Loss 0.070, Train_accy 97.64:  90%|█████████ | 18/20 [10:58<01:06, 33.11s/it]
Task 15, Epoch 19/20 => Loss 0.070, Train_accy 97.64:  95%|█████████▌| 19/20 [10:58<00:31, 31.44s/it]
Task 15, Epoch 20/20 => Loss 0.058, Train_accy 97.84, Test_accy 82.78:  95%|█████████▌| 19/20 [12:11<00:31, 31.44s/it]
Task 15, Epoch 20/20 => Loss 0.058, Train_accy 97.84, Test_accy 82.78: 100%|██████████| 20/20 [12:11<00:00, 43.84s/it]
Task 15, Epoch 20/20 => Loss 0.058, Train_accy 97.84, Test_accy 82.78: 100%|██████████| 20/20 [12:11<00:00, 36.58s/it]
2024-09-04 01:11:53,629 [coda_prompt.py] => Task 15, Epoch 20/20 => Loss 0.058, Train_accy 97.84, Test_accy 82.78
2024-09-04 01:12:38,517 [trainer.py] => No NME accuracy.
2024-09-04 01:12:38,517 [trainer.py] => CNN: {'total': 82.78, '00-04': 90.6, '05-09': 89.6, '10-14': 83.8, '15-19': 82.6, '20-24': 92.8, '25-29': 86.4, '30-34': 74.2, '35-39': 86.2, '40-44': 84.6, '45-49': 72.4, '50-54': 83.6, '55-59': 65.8, '60-64': 87.2, '65-69': 92.8, '70-74': 69.8, '75-79': 82.0, 'old': 82.83, 'new': 82.0}
2024-09-04 01:12:38,517 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78]
2024-09-04 01:12:38,517 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64]

Average Accuracy (CNN): 90.54
2024-09-04 01:12:38,518 [trainer.py] => Average Accuracy (CNN): 90.54 

2024-09-04 01:12:38,519 [trainer.py] => All params: 89715556
2024-09-04 01:12:38,520 [trainer.py] => Trainable params: 89715556
2024-09-04 01:12:39,352 [coda_prompt.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 16, Epoch 1/20 => Loss 0.334, Train_accy 88.90:   0%|          | 0/20 [00:27<?, ?it/s]
Task 16, Epoch 1/20 => Loss 0.334, Train_accy 88.90:   5%|▌         | 1/20 [00:27<08:45, 27.65s/it]
Task 16, Epoch 2/20 => Loss 0.054, Train_accy 98.48:   5%|▌         | 1/20 [00:55<08:45, 27.65s/it]
Task 16, Epoch 2/20 => Loss 0.054, Train_accy 98.48:  10%|█         | 2/20 [00:55<08:17, 27.62s/it]
Task 16, Epoch 3/20 => Loss 0.065, Train_accy 97.84:  10%|█         | 2/20 [01:22<08:17, 27.62s/it]
Task 16, Epoch 3/20 => Loss 0.065, Train_accy 97.84:  15%|█▌        | 3/20 [01:22<07:49, 27.61s/it]
Task 16, Epoch 4/20 => Loss 0.055, Train_accy 98.24:  15%|█▌        | 3/20 [01:50<07:49, 27.61s/it]
Task 16, Epoch 4/20 => Loss 0.055, Train_accy 98.24:  20%|██        | 4/20 [01:50<07:21, 27.61s/it]
Task 16, Epoch 5/20 => Loss 0.050, Train_accy 98.32, Test_accy 81.92:  20%|██        | 4/20 [03:05<07:21, 27.61s/it]
Task 16, Epoch 5/20 => Loss 0.050, Train_accy 98.32, Test_accy 81.92:  25%|██▌       | 5/20 [03:05<11:12, 44.80s/it]
Task 16, Epoch 6/20 => Loss 0.048, Train_accy 98.32:  25%|██▌       | 5/20 [03:33<11:12, 44.80s/it]                 
Task 16, Epoch 6/20 => Loss 0.048, Train_accy 98.32:  30%|███       | 6/20 [03:33<09:05, 38.96s/it]
Task 16, Epoch 7/20 => Loss 0.048, Train_accy 98.48:  30%|███       | 6/20 [04:00<09:05, 38.96s/it]
Task 16, Epoch 7/20 => Loss 0.048, Train_accy 98.48:  35%|███▌      | 7/20 [04:00<07:38, 35.24s/it]
Task 16, Epoch 8/20 => Loss 0.043, Train_accy 98.56:  35%|███▌      | 7/20 [04:28<07:38, 35.24s/it]
Task 16, Epoch 8/20 => Loss 0.043, Train_accy 98.56:  40%|████      | 8/20 [04:28<06:33, 32.80s/it]
Task 16, Epoch 9/20 => Loss 0.043, Train_accy 98.72:  40%|████      | 8/20 [04:56<06:33, 32.80s/it]
Task 16, Epoch 9/20 => Loss 0.043, Train_accy 98.72:  45%|████▌     | 9/20 [04:56<05:42, 31.17s/it]
Task 16, Epoch 10/20 => Loss 0.045, Train_accy 98.44, Test_accy 82.12:  45%|████▌     | 9/20 [06:11<05:42, 31.17s/it]
Task 16, Epoch 10/20 => Loss 0.045, Train_accy 98.44, Test_accy 82.12:  50%|█████     | 10/20 [06:11<07:27, 44.77s/it]
Task 16, Epoch 11/20 => Loss 0.038, Train_accy 99.00:  50%|█████     | 10/20 [06:38<07:27, 44.77s/it]                 
Task 16, Epoch 11/20 => Loss 0.038, Train_accy 99.00:  55%|█████▌    | 11/20 [06:38<05:55, 39.50s/it]
Task 16, Epoch 12/20 => Loss 0.045, Train_accy 98.68:  55%|█████▌    | 11/20 [07:06<05:55, 39.50s/it]
Task 16, Epoch 12/20 => Loss 0.045, Train_accy 98.68:  60%|██████    | 12/20 [07:06<04:46, 35.87s/it]
Task 16, Epoch 13/20 => Loss 0.045, Train_accy 98.28:  60%|██████    | 12/20 [07:34<04:46, 35.87s/it]
Task 16, Epoch 13/20 => Loss 0.045, Train_accy 98.28:  65%|██████▌   | 13/20 [07:34<03:53, 33.37s/it]
Task 16, Epoch 14/20 => Loss 0.048, Train_accy 98.36:  65%|██████▌   | 13/20 [08:01<03:53, 33.37s/it]
Task 16, Epoch 14/20 => Loss 0.048, Train_accy 98.36:  70%|███████   | 14/20 [08:01<03:09, 31.63s/it]
Task 16, Epoch 15/20 => Loss 0.038, Train_accy 98.60, Test_accy 82.27:  70%|███████   | 14/20 [09:16<03:09, 31.63s/it]
Task 16, Epoch 15/20 => Loss 0.038, Train_accy 98.60, Test_accy 82.27:  75%|███████▌  | 15/20 [09:16<03:43, 44.77s/it]
Task 16, Epoch 16/20 => Loss 0.041, Train_accy 98.76:  75%|███████▌  | 15/20 [09:44<03:43, 44.77s/it]                 
Task 16, Epoch 16/20 => Loss 0.041, Train_accy 98.76:  80%|████████  | 16/20 [09:44<02:38, 39.58s/it]
Task 16, Epoch 17/20 => Loss 0.035, Train_accy 98.72:  80%|████████  | 16/20 [10:11<02:38, 39.58s/it]
Task 16, Epoch 17/20 => Loss 0.035, Train_accy 98.72:  85%|████████▌ | 17/20 [10:11<01:47, 35.96s/it]
Task 16, Epoch 18/20 => Loss 0.031, Train_accy 98.84:  85%|████████▌ | 17/20 [10:39<01:47, 35.96s/it]
Task 16, Epoch 18/20 => Loss 0.031, Train_accy 98.84:  90%|█████████ | 18/20 [10:39<01:06, 33.44s/it]
Task 16, Epoch 19/20 => Loss 0.037, Train_accy 98.68:  90%|█████████ | 18/20 [11:07<01:06, 33.44s/it]
Task 16, Epoch 19/20 => Loss 0.037, Train_accy 98.68:  95%|█████████▌| 19/20 [11:07<00:31, 31.68s/it]
Task 16, Epoch 20/20 => Loss 0.033, Train_accy 98.80, Test_accy 82.41:  95%|█████████▌| 19/20 [12:22<00:31, 31.68s/it]
Task 16, Epoch 20/20 => Loss 0.033, Train_accy 98.80, Test_accy 82.41: 100%|██████████| 20/20 [12:22<00:00, 44.69s/it]
Task 16, Epoch 20/20 => Loss 0.033, Train_accy 98.80, Test_accy 82.41: 100%|██████████| 20/20 [12:22<00:00, 37.11s/it]
2024-09-04 01:25:01,517 [coda_prompt.py] => Task 16, Epoch 20/20 => Loss 0.033, Train_accy 98.80, Test_accy 82.41
2024-09-04 01:25:49,138 [trainer.py] => No NME accuracy.
2024-09-04 01:25:49,139 [trainer.py] => CNN: {'total': 82.41, '00-04': 90.8, '05-09': 89.4, '10-14': 84.6, '15-19': 82.8, '20-24': 93.4, '25-29': 85.4, '30-34': 73.2, '35-39': 86.2, '40-44': 84.6, '45-49': 71.0, '50-54': 82.2, '55-59': 65.2, '60-64': 86.2, '65-69': 92.8, '70-74': 71.0, '75-79': 81.6, '80-84': 80.6, 'old': 82.52, 'new': 80.6}
2024-09-04 01:25:49,139 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78, 82.41]
2024-09-04 01:25:49,139 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64, 97.71]

Average Accuracy (CNN): 90.06
2024-09-04 01:25:49,139 [trainer.py] => Average Accuracy (CNN): 90.06 

2024-09-04 01:25:49,141 [trainer.py] => All params: 89715556
2024-09-04 01:25:49,142 [trainer.py] => Trainable params: 89715556
2024-09-04 01:25:50,010 [coda_prompt.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.435, Train_accy 83.57:   0%|          | 0/20 [00:27<?, ?it/s]
Task 17, Epoch 1/20 => Loss 0.435, Train_accy 83.57:   5%|▌         | 1/20 [00:27<08:44, 27.58s/it]
Task 17, Epoch 2/20 => Loss 0.189, Train_accy 92.95:   5%|▌         | 1/20 [00:55<08:44, 27.58s/it]
Task 17, Epoch 2/20 => Loss 0.189, Train_accy 92.95:  10%|█         | 2/20 [00:55<08:16, 27.56s/it]
Task 17, Epoch 3/20 => Loss 0.181, Train_accy 93.43:  10%|█         | 2/20 [01:22<08:16, 27.56s/it]
Task 17, Epoch 3/20 => Loss 0.181, Train_accy 93.43:  15%|█▌        | 3/20 [01:22<07:48, 27.58s/it]
Task 17, Epoch 4/20 => Loss 0.153, Train_accy 94.31:  15%|█▌        | 3/20 [01:50<07:48, 27.58s/it]
Task 17, Epoch 4/20 => Loss 0.153, Train_accy 94.31:  20%|██        | 4/20 [01:50<07:21, 27.60s/it]
Task 17, Epoch 5/20 => Loss 0.148, Train_accy 94.47, Test_accy 82.26:  20%|██        | 4/20 [03:08<07:21, 27.60s/it]
Task 17, Epoch 5/20 => Loss 0.148, Train_accy 94.47, Test_accy 82.26:  25%|██▌       | 5/20 [03:08<11:27, 45.85s/it]
Task 17, Epoch 6/20 => Loss 0.155, Train_accy 93.91:  25%|██▌       | 5/20 [03:36<11:27, 45.85s/it]                 
Task 17, Epoch 6/20 => Loss 0.155, Train_accy 93.91:  30%|███       | 6/20 [03:36<09:14, 39.64s/it]
Task 17, Epoch 7/20 => Loss 0.137, Train_accy 94.71:  30%|███       | 6/20 [04:03<09:14, 39.64s/it]
Task 17, Epoch 7/20 => Loss 0.137, Train_accy 94.71:  35%|███▌      | 7/20 [04:03<07:44, 35.71s/it]
Task 17, Epoch 8/20 => Loss 0.147, Train_accy 94.71:  35%|███▌      | 7/20 [04:31<07:44, 35.71s/it]
Task 17, Epoch 8/20 => Loss 0.147, Train_accy 94.71:  40%|████      | 8/20 [04:31<06:37, 33.12s/it]
Task 17, Epoch 9/20 => Loss 0.123, Train_accy 95.63:  40%|████      | 8/20 [04:58<06:37, 33.12s/it]
Task 17, Epoch 9/20 => Loss 0.123, Train_accy 95.63:  45%|████▌     | 9/20 [04:58<05:45, 31.40s/it]
Task 17, Epoch 10/20 => Loss 0.139, Train_accy 95.07, Test_accy 82.31:  45%|████▌     | 9/20 [06:17<05:45, 31.40s/it]
Task 17, Epoch 10/20 => Loss 0.139, Train_accy 95.07, Test_accy 82.31:  50%|█████     | 10/20 [06:17<07:38, 45.81s/it]
Task 17, Epoch 11/20 => Loss 0.143, Train_accy 95.07:  50%|█████     | 10/20 [06:44<07:38, 45.81s/it]                 
Task 17, Epoch 11/20 => Loss 0.143, Train_accy 95.07:  55%|█████▌    | 11/20 [06:44<06:02, 40.25s/it]
Task 17, Epoch 12/20 => Loss 0.119, Train_accy 95.35:  55%|█████▌    | 11/20 [07:12<06:02, 40.25s/it]
Task 17, Epoch 12/20 => Loss 0.119, Train_accy 95.35:  60%|██████    | 12/20 [07:12<04:51, 36.40s/it]
Task 17, Epoch 13/20 => Loss 0.128, Train_accy 95.11:  60%|██████    | 12/20 [07:39<04:51, 36.40s/it]
Task 17, Epoch 13/20 => Loss 0.128, Train_accy 95.11:  65%|██████▌   | 13/20 [07:39<03:56, 33.74s/it]
Task 17, Epoch 14/20 => Loss 0.115, Train_accy 95.47:  65%|██████▌   | 13/20 [08:07<03:56, 33.74s/it]
Task 17, Epoch 14/20 => Loss 0.115, Train_accy 95.47:  70%|███████   | 14/20 [08:07<03:11, 31.88s/it]
Task 17, Epoch 15/20 => Loss 0.108, Train_accy 95.83, Test_accy 82.24:  70%|███████   | 14/20 [09:25<03:11, 31.88s/it]
Task 17, Epoch 15/20 => Loss 0.108, Train_accy 95.83, Test_accy 82.24:  75%|███████▌  | 15/20 [09:25<03:48, 45.77s/it]
Task 17, Epoch 16/20 => Loss 0.125, Train_accy 95.31:  75%|███████▌  | 15/20 [09:53<03:48, 45.77s/it]                 
Task 17, Epoch 16/20 => Loss 0.125, Train_accy 95.31:  80%|████████  | 16/20 [09:53<02:41, 40.29s/it]
Task 17, Epoch 17/20 => Loss 0.120, Train_accy 95.59:  80%|████████  | 16/20 [10:20<02:41, 40.29s/it]
Task 17, Epoch 17/20 => Loss 0.120, Train_accy 95.59:  85%|████████▌ | 17/20 [10:20<01:49, 36.46s/it]
Task 17, Epoch 18/20 => Loss 0.117, Train_accy 95.71:  85%|████████▌ | 17/20 [10:48<01:49, 36.46s/it]
Task 17, Epoch 18/20 => Loss 0.117, Train_accy 95.71:  90%|█████████ | 18/20 [10:48<01:07, 33.79s/it]
Task 17, Epoch 19/20 => Loss 0.114, Train_accy 95.75:  90%|█████████ | 18/20 [11:15<01:07, 33.79s/it]
Task 17, Epoch 19/20 => Loss 0.114, Train_accy 95.75:  95%|█████████▌| 19/20 [11:15<00:31, 31.92s/it]
Task 17, Epoch 20/20 => Loss 0.097, Train_accy 96.35, Test_accy 82.43:  95%|█████████▌| 19/20 [12:33<00:31, 31.92s/it]
Task 17, Epoch 20/20 => Loss 0.097, Train_accy 96.35, Test_accy 82.43: 100%|██████████| 20/20 [12:33<00:00, 45.73s/it]
Task 17, Epoch 20/20 => Loss 0.097, Train_accy 96.35, Test_accy 82.43: 100%|██████████| 20/20 [12:33<00:00, 37.68s/it]
2024-09-04 01:38:23,671 [coda_prompt.py] => Task 17, Epoch 20/20 => Loss 0.097, Train_accy 96.35, Test_accy 82.43
2024-09-04 01:39:14,122 [trainer.py] => No NME accuracy.
2024-09-04 01:39:14,123 [trainer.py] => CNN: {'total': 82.43, '00-04': 91.0, '05-09': 89.4, '10-14': 83.2, '15-19': 82.4, '20-24': 93.8, '25-29': 85.2, '30-34': 73.4, '35-39': 86.6, '40-44': 85.6, '45-49': 71.2, '50-54': 82.4, '55-59': 65.2, '60-64': 86.0, '65-69': 92.6, '70-74': 69.2, '75-79': 79.4, '80-84': 80.6, '85-89': 86.6, 'old': 82.19, 'new': 86.6}
2024-09-04 01:39:14,123 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78, 82.41, 82.43]
2024-09-04 01:39:14,123 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64, 97.71, 97.51]

Average Accuracy (CNN): 89.64
2024-09-04 01:39:14,123 [trainer.py] => Average Accuracy (CNN): 89.64 

2024-09-04 01:39:14,124 [trainer.py] => All params: 89715556
2024-09-04 01:39:14,125 [trainer.py] => Trainable params: 89715556
2024-09-04 01:39:15,037 [coda_prompt.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.275, Train_accy 90.02:   0%|          | 0/20 [00:27<?, ?it/s]
Task 18, Epoch 1/20 => Loss 0.275, Train_accy 90.02:   5%|▌         | 1/20 [00:27<08:43, 27.56s/it]
Task 18, Epoch 2/20 => Loss 0.087, Train_accy 96.75:   5%|▌         | 1/20 [00:55<08:43, 27.56s/it]
Task 18, Epoch 2/20 => Loss 0.087, Train_accy 96.75:  10%|█         | 2/20 [00:55<08:16, 27.60s/it]
Task 18, Epoch 3/20 => Loss 0.080, Train_accy 97.00:  10%|█         | 2/20 [01:22<08:16, 27.60s/it]
Task 18, Epoch 3/20 => Loss 0.080, Train_accy 97.00:  15%|█▌        | 3/20 [01:22<07:49, 27.62s/it]
Task 18, Epoch 4/20 => Loss 0.072, Train_accy 97.52:  15%|█▌        | 3/20 [01:50<07:49, 27.62s/it]
Task 18, Epoch 4/20 => Loss 0.072, Train_accy 97.52:  20%|██        | 4/20 [01:50<07:22, 27.63s/it]
Task 18, Epoch 5/20 => Loss 0.083, Train_accy 97.08, Test_accy 82.41:  20%|██        | 4/20 [03:11<07:22, 27.63s/it]
Task 18, Epoch 5/20 => Loss 0.083, Train_accy 97.08, Test_accy 82.41:  25%|██▌       | 5/20 [03:11<11:43, 46.88s/it]
Task 18, Epoch 6/20 => Loss 0.065, Train_accy 98.00:  25%|██▌       | 5/20 [03:39<11:43, 46.88s/it]                 
Task 18, Epoch 6/20 => Loss 0.065, Train_accy 98.00:  30%|███       | 6/20 [03:39<09:24, 40.32s/it]
Task 18, Epoch 7/20 => Loss 0.071, Train_accy 97.40:  30%|███       | 6/20 [04:06<09:24, 40.32s/it]
Task 18, Epoch 7/20 => Loss 0.071, Train_accy 97.40:  35%|███▌      | 7/20 [04:06<07:50, 36.16s/it]
Task 18, Epoch 8/20 => Loss 0.060, Train_accy 97.80:  35%|███▌      | 7/20 [04:34<07:50, 36.16s/it]
Task 18, Epoch 8/20 => Loss 0.060, Train_accy 97.80:  40%|████      | 8/20 [04:34<06:41, 33.45s/it]
Task 18, Epoch 9/20 => Loss 0.050, Train_accy 98.24:  40%|████      | 8/20 [05:01<06:41, 33.45s/it]
Task 18, Epoch 9/20 => Loss 0.050, Train_accy 98.24:  45%|████▌     | 9/20 [05:01<05:47, 31.62s/it]
Task 18, Epoch 10/20 => Loss 0.062, Train_accy 97.96, Test_accy 82.46:  45%|████▌     | 9/20 [06:22<05:47, 31.62s/it]
Task 18, Epoch 10/20 => Loss 0.062, Train_accy 97.96, Test_accy 82.46:  50%|█████     | 10/20 [06:22<07:48, 46.86s/it]
Task 18, Epoch 11/20 => Loss 0.065, Train_accy 97.60:  50%|█████     | 10/20 [06:50<07:48, 46.86s/it]                 
Task 18, Epoch 11/20 => Loss 0.065, Train_accy 97.60:  55%|█████▌    | 11/20 [06:50<06:08, 40.96s/it]
Task 18, Epoch 12/20 => Loss 0.059, Train_accy 97.80:  55%|█████▌    | 11/20 [07:18<06:08, 40.96s/it]
Task 18, Epoch 12/20 => Loss 0.059, Train_accy 97.80:  60%|██████    | 12/20 [07:18<04:55, 36.89s/it]
Task 18, Epoch 13/20 => Loss 0.065, Train_accy 97.84:  60%|██████    | 12/20 [07:45<04:55, 36.89s/it]
Task 18, Epoch 13/20 => Loss 0.065, Train_accy 97.84:  65%|██████▌   | 13/20 [07:45<03:58, 34.10s/it]
Task 18, Epoch 14/20 => Loss 0.064, Train_accy 97.76:  65%|██████▌   | 13/20 [08:13<03:58, 34.10s/it]
Task 18, Epoch 14/20 => Loss 0.064, Train_accy 97.76:  70%|███████   | 14/20 [08:13<03:12, 32.17s/it]
Task 18, Epoch 15/20 => Loss 0.050, Train_accy 98.32, Test_accy 82.64:  70%|███████   | 14/20 [09:34<03:12, 32.17s/it]
Task 18, Epoch 15/20 => Loss 0.050, Train_accy 98.32, Test_accy 82.64:  75%|███████▌  | 15/20 [09:34<03:54, 46.84s/it]
Task 18, Epoch 16/20 => Loss 0.064, Train_accy 97.64:  75%|███████▌  | 15/20 [10:01<03:54, 46.84s/it]                 
Task 18, Epoch 16/20 => Loss 0.064, Train_accy 97.64:  80%|████████  | 16/20 [10:01<02:44, 41.06s/it]
Task 18, Epoch 17/20 => Loss 0.063, Train_accy 97.44:  80%|████████  | 16/20 [10:29<02:44, 41.06s/it]
Task 18, Epoch 17/20 => Loss 0.063, Train_accy 97.44:  85%|████████▌ | 17/20 [10:29<01:51, 37.01s/it]
Task 18, Epoch 18/20 => Loss 0.058, Train_accy 97.84:  85%|████████▌ | 17/20 [10:57<01:51, 37.01s/it]
Task 18, Epoch 18/20 => Loss 0.058, Train_accy 97.84:  90%|█████████ | 18/20 [10:57<01:08, 34.18s/it]
Task 18, Epoch 19/20 => Loss 0.052, Train_accy 98.32:  90%|█████████ | 18/20 [11:24<01:08, 34.18s/it]
Task 18, Epoch 19/20 => Loss 0.052, Train_accy 98.32:  95%|█████████▌| 19/20 [11:24<00:32, 32.22s/it]
Task 18, Epoch 20/20 => Loss 0.043, Train_accy 98.72, Test_accy 82.62:  95%|█████████▌| 19/20 [12:45<00:32, 32.22s/it]
Task 18, Epoch 20/20 => Loss 0.043, Train_accy 98.72, Test_accy 82.62: 100%|██████████| 20/20 [12:45<00:00, 46.82s/it]
Task 18, Epoch 20/20 => Loss 0.043, Train_accy 98.72, Test_accy 82.62: 100%|██████████| 20/20 [12:45<00:00, 38.28s/it]
2024-09-04 01:52:00,702 [coda_prompt.py] => Task 18, Epoch 20/20 => Loss 0.043, Train_accy 98.72, Test_accy 82.62
2024-09-04 01:52:53,950 [trainer.py] => No NME accuracy.
2024-09-04 01:52:53,951 [trainer.py] => CNN: {'total': 82.62, '00-04': 89.6, '05-09': 89.6, '10-14': 83.6, '15-19': 82.2, '20-24': 93.8, '25-29': 84.8, '30-34': 73.4, '35-39': 86.2, '40-44': 85.2, '45-49': 72.2, '50-54': 81.2, '55-59': 66.0, '60-64': 85.2, '65-69': 92.0, '70-74': 69.6, '75-79': 81.0, '80-84': 80.2, '85-89': 86.2, '90-94': 87.8, 'old': 82.33, 'new': 87.8}
2024-09-04 01:52:53,951 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78, 82.41, 82.43, 82.62]
2024-09-04 01:52:53,951 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64, 97.71, 97.51, 97.49]

Average Accuracy (CNN): 89.27
2024-09-04 01:52:53,951 [trainer.py] => Average Accuracy (CNN): 89.27 

2024-09-04 01:52:53,952 [trainer.py] => All params: 89715556
2024-09-04 01:52:53,953 [trainer.py] => Trainable params: 89715556
2024-09-04 01:52:54,918 [coda_prompt.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.363, Train_accy 86.98:   0%|          | 0/20 [00:27<?, ?it/s]
Task 19, Epoch 1/20 => Loss 0.363, Train_accy 86.98:   5%|▌         | 1/20 [00:27<08:44, 27.60s/it]
Task 19, Epoch 2/20 => Loss 0.140, Train_accy 95.19:   5%|▌         | 1/20 [00:55<08:44, 27.60s/it]
Task 19, Epoch 2/20 => Loss 0.140, Train_accy 95.19:  10%|█         | 2/20 [00:55<08:16, 27.59s/it]
Task 19, Epoch 3/20 => Loss 0.135, Train_accy 95.67:  10%|█         | 2/20 [01:22<08:16, 27.59s/it]
Task 19, Epoch 3/20 => Loss 0.135, Train_accy 95.67:  15%|█▌        | 3/20 [01:22<07:49, 27.59s/it]
Task 19, Epoch 4/20 => Loss 0.107, Train_accy 96.19:  15%|█▌        | 3/20 [01:50<07:49, 27.59s/it]
Task 19, Epoch 4/20 => Loss 0.107, Train_accy 96.19:  20%|██        | 4/20 [01:50<07:21, 27.62s/it]
Task 19, Epoch 5/20 => Loss 0.129, Train_accy 95.27, Test_accy 81.81:  20%|██        | 4/20 [03:14<07:21, 27.62s/it]
Task 19, Epoch 5/20 => Loss 0.129, Train_accy 95.27, Test_accy 81.81:  25%|██▌       | 5/20 [03:14<11:57, 47.83s/it]
Task 19, Epoch 6/20 => Loss 0.104, Train_accy 96.07:  25%|██▌       | 5/20 [03:41<11:57, 47.83s/it]                 
Task 19, Epoch 6/20 => Loss 0.104, Train_accy 96.07:  30%|███       | 6/20 [03:41<09:33, 40.96s/it]
Task 19, Epoch 7/20 => Loss 0.096, Train_accy 96.79:  30%|███       | 6/20 [04:09<09:33, 40.96s/it]
Task 19, Epoch 7/20 => Loss 0.096, Train_accy 96.79:  35%|███▌      | 7/20 [04:09<07:55, 36.58s/it]
Task 19, Epoch 8/20 => Loss 0.096, Train_accy 96.59:  35%|███▌      | 7/20 [04:36<07:55, 36.58s/it]
Task 19, Epoch 8/20 => Loss 0.096, Train_accy 96.59:  40%|████      | 8/20 [04:36<06:44, 33.71s/it]
Task 19, Epoch 9/20 => Loss 0.101, Train_accy 96.35:  40%|████      | 8/20 [05:04<06:44, 33.71s/it]
Task 19, Epoch 9/20 => Loss 0.101, Train_accy 96.35:  45%|████▌     | 9/20 [05:04<05:49, 31.81s/it]
Task 19, Epoch 10/20 => Loss 0.093, Train_accy 96.63, Test_accy 81.99:  45%|████▌     | 9/20 [06:28<05:49, 31.81s/it]
Task 19, Epoch 10/20 => Loss 0.093, Train_accy 96.63, Test_accy 81.99:  50%|█████     | 10/20 [06:28<07:57, 47.78s/it]
Task 19, Epoch 11/20 => Loss 0.091, Train_accy 96.92:  50%|█████     | 10/20 [06:55<07:57, 47.78s/it]                 
Task 19, Epoch 11/20 => Loss 0.091, Train_accy 96.92:  55%|█████▌    | 11/20 [06:55<06:14, 41.60s/it]
Task 19, Epoch 12/20 => Loss 0.091, Train_accy 96.83:  55%|█████▌    | 11/20 [07:23<06:14, 41.60s/it]
Task 19, Epoch 12/20 => Loss 0.091, Train_accy 96.83:  60%|██████    | 12/20 [07:23<04:58, 37.34s/it]
Task 19, Epoch 13/20 => Loss 0.098, Train_accy 96.51:  60%|██████    | 12/20 [07:50<04:58, 37.34s/it]
Task 19, Epoch 13/20 => Loss 0.098, Train_accy 96.51:  65%|██████▌   | 13/20 [07:50<04:00, 34.38s/it]
Task 19, Epoch 14/20 => Loss 0.095, Train_accy 96.75:  65%|██████▌   | 13/20 [08:18<04:00, 34.38s/it]
Task 19, Epoch 14/20 => Loss 0.095, Train_accy 96.75:  70%|███████   | 14/20 [08:18<03:13, 32.32s/it]
Task 19, Epoch 15/20 => Loss 0.089, Train_accy 96.75, Test_accy 82.01:  70%|███████   | 14/20 [09:41<03:13, 32.32s/it]
Task 19, Epoch 15/20 => Loss 0.089, Train_accy 96.75, Test_accy 82.01:  75%|███████▌  | 15/20 [09:41<03:58, 47.78s/it]
Task 19, Epoch 16/20 => Loss 0.084, Train_accy 97.16:  75%|███████▌  | 15/20 [10:09<03:58, 47.78s/it]                 
Task 19, Epoch 16/20 => Loss 0.084, Train_accy 97.16:  80%|████████  | 16/20 [10:09<02:46, 41.72s/it]
Task 19, Epoch 17/20 => Loss 0.084, Train_accy 96.71:  80%|████████  | 16/20 [10:37<02:46, 41.72s/it]
Task 19, Epoch 17/20 => Loss 0.084, Train_accy 96.71:  85%|████████▌ | 17/20 [10:37<01:52, 37.48s/it]
Task 19, Epoch 18/20 => Loss 0.073, Train_accy 97.52:  85%|████████▌ | 17/20 [11:04<01:52, 37.48s/it]
Task 19, Epoch 18/20 => Loss 0.073, Train_accy 97.52:  90%|█████████ | 18/20 [11:04<01:09, 34.53s/it]
Task 19, Epoch 19/20 => Loss 0.075, Train_accy 97.36:  90%|█████████ | 18/20 [11:32<01:09, 34.53s/it]
Task 19, Epoch 19/20 => Loss 0.075, Train_accy 97.36:  95%|█████████▌| 19/20 [11:32<00:32, 32.49s/it]
Task 19, Epoch 20/20 => Loss 0.080, Train_accy 97.28, Test_accy 81.94:  95%|█████████▌| 19/20 [12:56<00:32, 32.49s/it]
Task 19, Epoch 20/20 => Loss 0.080, Train_accy 97.28, Test_accy 81.94: 100%|██████████| 20/20 [12:56<00:00, 47.93s/it]
Task 19, Epoch 20/20 => Loss 0.080, Train_accy 97.28, Test_accy 81.94: 100%|██████████| 20/20 [12:56<00:00, 38.83s/it]
2024-09-04 02:05:51,498 [coda_prompt.py] => Task 19, Epoch 20/20 => Loss 0.080, Train_accy 97.28, Test_accy 81.94
2024-09-04 02:06:47,655 [trainer.py] => No NME accuracy.
2024-09-04 02:06:47,655 [trainer.py] => CNN: {'total': 81.94, '00-04': 88.8, '05-09': 90.2, '10-14': 81.6, '15-19': 83.0, '20-24': 93.0, '25-29': 83.2, '30-34': 74.4, '35-39': 86.8, '40-44': 85.0, '45-49': 69.8, '50-54': 82.8, '55-59': 64.2, '60-64': 85.8, '65-69': 90.4, '70-74': 70.4, '75-79': 79.0, '80-84': 79.2, '85-89': 85.8, '90-94': 86.8, '95-99': 78.6, 'old': 82.12, 'new': 78.6}
2024-09-04 02:06:47,655 [trainer.py] => CNN top1 curve: [99.8, 98.0, 96.67, 95.0, 95.04, 93.43, 91.14, 90.5, 89.13, 88.08, 87.07, 86.93, 85.6, 85.4, 84.09, 82.78, 82.41, 82.43, 82.62, 81.94]
2024-09-04 02:06:47,656 [trainer.py] => CNN top5 curve: [100.0, 99.8, 99.67, 99.3, 99.32, 99.1, 98.83, 98.65, 98.53, 98.42, 98.4, 98.15, 98.02, 97.94, 97.83, 97.64, 97.71, 97.51, 97.49, 97.43]

Average Accuracy (CNN): 88.9
2024-09-04 02:06:47,656 [trainer.py] => Average Accuracy (CNN): 88.9 

Accuracy Matrix (CNN):
[[99.8 99.2 98.8 98.6 98.8 97.  97.2 96.8 93.8 94.2 92.4 93.4 93.2 92.4
  92.4 90.6 90.8 91.  89.6 88.8]
 [ 0.  96.8 95.4 94.4 94.8 91.4 92.  91.8 90.6 91.2 90.8 91.  91.  90.2
  90.2 89.6 89.4 89.4 89.6 90.2]
 [ 0.   0.  95.8 94.6 93.6 93.4 93.2 91.8 87.6 87.  87.  87.8 86.8 83.4
  84.6 83.8 84.6 83.2 83.6 81.6]
 [ 0.   0.   0.  92.4 92.2 91.4 91.  89.8 89.4 89.  88.8 88.4 82.2 82.6
  82.6 82.6 82.8 82.4 82.2 83. ]
 [ 0.   0.   0.   0.  95.8 94.8 94.  93.6 94.6 93.8 93.8 92.  92.8 92.8
  93.4 92.8 93.4 93.8 93.8 93. ]
 [ 0.   0.   0.   0.   0.  92.6 92.6 90.4 89.6 88.6 87.2 89.6 86.6 86.8
  86.  86.4 85.4 85.2 84.8 83.2]
 [ 0.   0.   0.   0.   0.   0.  78.  77.2 76.  76.4 74.8 75.4 74.8 73.6
  74.6 74.2 73.2 73.4 73.4 74.4]
 [ 0.   0.   0.   0.   0.   0.   0.  92.6 93.  89.2 87.4 87.2 87.2 87.2
  86.6 86.2 86.2 86.6 86.2 86.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.  87.6 86.4 86.2 84.6 84.8 84.6
  85.2 84.6 84.6 85.6 85.2 85. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.  85.  80.8 80.2 80.4 80.
  79.8 72.4 71.  71.2 72.2 69.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  88.6 86.4 87.2 85.8
  87.4 83.6 82.2 82.4 81.2 82.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  87.2 72.6 71.2
  67.  65.8 65.2 65.2 66.  64.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  93.2 91.8
  87.6 87.2 86.2 86.  85.2 85.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  93.2
  92.6 92.8 92.8 92.6 92.  90.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  71.4 69.8 71.  69.2 69.6 70.4]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.  82.  81.6 79.4 81.  79. ]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.  80.6 80.6 80.2 79.2]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.  86.6 86.2 85.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.  87.8 86.8]
 [ 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
   0.   0.   0.   0.   0.  78.6]]
2024-09-04 02:06:47,661 [trainer.py] => Forgetting (CNN): 6.694736842105262
2024-09-04 02:06:50,338 [trainer.py] => config: ./exps/coda_prompt_cifar_B50_Inc5.json
2024-09-04 02:06:50,338 [trainer.py] => prefix:  
2024-09-04 02:06:50,338 [trainer.py] => dataset: cifar224
2024-09-04 02:06:50,338 [trainer.py] => memory_size: 0
2024-09-04 02:06:50,338 [trainer.py] => memory_per_class: 0
2024-09-04 02:06:50,338 [trainer.py] => fixed_memory: False
2024-09-04 02:06:50,338 [trainer.py] => shuffle: True
2024-09-04 02:06:50,338 [trainer.py] => init_cls: 50
2024-09-04 02:06:50,338 [trainer.py] => increment: 10
2024-09-04 02:06:50,338 [trainer.py] => model_name: coda_prompt
2024-09-04 02:06:50,338 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-04 02:06:50,338 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 02:06:50,338 [trainer.py] => seed: 1993
2024-09-04 02:06:50,338 [trainer.py] => tuned_epoch: 20
2024-09-04 02:06:50,338 [trainer.py] => init_lr: 0.001
2024-09-04 02:06:50,338 [trainer.py] => batch_size: 48
2024-09-04 02:06:50,338 [trainer.py] => weight_decay: 0
2024-09-04 02:06:50,338 [trainer.py] => min_lr: 1e-05
2024-09-04 02:06:50,338 [trainer.py] => optimizer: adam
2024-09-04 02:06:50,339 [trainer.py] => scheduler: cosine
2024-09-04 02:06:50,339 [trainer.py] => reinit_optimizer: True
2024-09-04 02:06:50,339 [trainer.py] => pretrained: True
2024-09-04 02:06:50,339 [trainer.py] => drop: 0.0
2024-09-04 02:06:50,339 [trainer.py] => drop_path: 0.0
2024-09-04 02:06:50,339 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-04 02:06:51,433 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-04 02:06:53,555 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-04 02:06:53,555 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-04 02:06:53,555 [trainer.py] => All params: 89715556
2024-09-04 02:06:53,556 [trainer.py] => Trainable params: 89715556
2024-09-04 02:06:53,556 [coda_prompt.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.846, Train_accy 77.39:   0%|          | 0/20 [04:30<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.846, Train_accy 77.39:   5%|▌         | 1/20 [04:30<1:25:45, 270.81s/it]
Task 0, Epoch 2/20 => Loss 0.533, Train_accy 84.88:   5%|▌         | 1/20 [09:01<1:25:45, 270.81s/it]
Task 0, Epoch 2/20 => Loss 0.533, Train_accy 84.88:  10%|█         | 2/20 [09:01<1:21:13, 270.76s/it]
Task 0, Epoch 3/20 => Loss 0.497, Train_accy 85.64:  10%|█         | 2/20 [13:32<1:21:13, 270.76s/it]
Task 0, Epoch 3/20 => Loss 0.497, Train_accy 85.64:  15%|█▌        | 3/20 [13:32<1:16:42, 270.71s/it]
Task 0, Epoch 4/20 => Loss 0.477, Train_accy 86.16:  15%|█▌        | 3/20 [18:02<1:16:42, 270.71s/it]
Task 0, Epoch 4/20 => Loss 0.477, Train_accy 86.16:  20%|██        | 4/20 [18:02<1:12:12, 270.75s/it]
Task 0, Epoch 5/20 => Loss 0.456, Train_accy 86.88, Test_accy 94.96:  20%|██        | 4/20 [23:02<1:12:12, 270.75s/it]
Task 0, Epoch 5/20 => Loss 0.456, Train_accy 86.88, Test_accy 94.96:  25%|██▌       | 5/20 [23:02<1:10:14, 281.00s/it]
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 87.11:  25%|██▌       | 5/20 [27:32<1:10:14, 281.00s/it]                 
Task 0, Epoch 6/20 => Loss 0.453, Train_accy 87.11:  30%|███       | 6/20 [27:32<1:04:44, 277.49s/it]
Task 0, Epoch 7/20 => Loss 0.431, Train_accy 87.69:  30%|███       | 6/20 [32:03<1:04:44, 277.49s/it]
Task 0, Epoch 7/20 => Loss 0.431, Train_accy 87.69:  35%|███▌      | 7/20 [32:03<59:39, 275.35s/it]  
Task 0, Epoch 8/20 => Loss 0.436, Train_accy 87.52:  35%|███▌      | 7/20 [36:34<59:39, 275.35s/it]
Task 0, Epoch 8/20 => Loss 0.436, Train_accy 87.52:  40%|████      | 8/20 [36:34<54:45, 273.82s/it]
Task 0, Epoch 9/20 => Loss 0.409, Train_accy 88.22:  40%|████      | 8/20 [41:04<54:45, 273.82s/it]
Task 0, Epoch 9/20 => Loss 0.409, Train_accy 88.22:  45%|████▌     | 9/20 [41:04<50:00, 272.79s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 88.06, Test_accy 94.60:  45%|████▌     | 9/20 [46:03<50:00, 272.79s/it]
Task 0, Epoch 10/20 => Loss 0.413, Train_accy 88.06, Test_accy 94.60:  50%|█████     | 10/20 [46:03<46:49, 280.92s/it]
Task 0, Epoch 11/20 => Loss 0.403, Train_accy 88.41:  50%|█████     | 10/20 [50:34<46:49, 280.92s/it]                 
Task 0, Epoch 11/20 => Loss 0.403, Train_accy 88.41:  55%|█████▌    | 11/20 [50:34<41:40, 277.82s/it]
Task 0, Epoch 12/20 => Loss 0.379, Train_accy 88.85:  55%|█████▌    | 11/20 [55:05<41:40, 277.82s/it]
Task 0, Epoch 12/20 => Loss 0.379, Train_accy 88.85:  60%|██████    | 12/20 [55:05<36:45, 275.65s/it]
Task 0, Epoch 13/20 => Loss 0.380, Train_accy 88.95:  60%|██████    | 12/20 [59:36<36:45, 275.65s/it]
Task 0, Epoch 13/20 => Loss 0.380, Train_accy 88.95:  65%|██████▌   | 13/20 [59:36<31:58, 274.13s/it]
Task 0, Epoch 14/20 => Loss 0.372, Train_accy 88.98:  65%|██████▌   | 13/20 [1:04:06<31:58, 274.13s/it]
Task 0, Epoch 14/20 => Loss 0.372, Train_accy 88.98:  70%|███████   | 14/20 [1:04:06<27:18, 273.11s/it]
Task 0, Epoch 15/20 => Loss 0.357, Train_accy 89.52, Test_accy 94.82:  70%|███████   | 14/20 [1:09:05<27:18, 273.11s/it]
Task 0, Epoch 15/20 => Loss 0.357, Train_accy 89.52, Test_accy 94.82:  75%|███████▌  | 15/20 [1:09:05<23:24, 280.83s/it]
Task 0, Epoch 16/20 => Loss 0.349, Train_accy 89.86:  75%|███████▌  | 15/20 [1:13:36<23:24, 280.83s/it]                 
Task 0, Epoch 16/20 => Loss 0.349, Train_accy 89.86:  80%|████████  | 16/20 [1:13:36<18:31, 277.77s/it]
Task 0, Epoch 17/20 => Loss 0.344, Train_accy 89.90:  80%|████████  | 16/20 [1:18:06<18:31, 277.77s/it]
Task 0, Epoch 17/20 => Loss 0.344, Train_accy 89.90:  85%|████████▌ | 17/20 [1:18:06<13:46, 275.65s/it]
Task 0, Epoch 18/20 => Loss 0.333, Train_accy 90.06:  85%|████████▌ | 17/20 [1:22:37<13:46, 275.65s/it]
Task 0, Epoch 18/20 => Loss 0.333, Train_accy 90.06:  90%|█████████ | 18/20 [1:22:37<09:08, 274.16s/it]
Task 0, Epoch 19/20 => Loss 0.336, Train_accy 90.01:  90%|█████████ | 18/20 [1:27:08<09:08, 274.16s/it]
Task 0, Epoch 19/20 => Loss 0.336, Train_accy 90.01:  95%|█████████▌| 19/20 [1:27:08<04:33, 273.10s/it]
Task 0, Epoch 20/20 => Loss 0.311, Train_accy 90.83, Test_accy 94.72:  95%|█████████▌| 19/20 [1:32:06<04:33, 273.10s/it]
Task 0, Epoch 20/20 => Loss 0.311, Train_accy 90.83, Test_accy 94.72: 100%|██████████| 20/20 [1:32:06<00:00, 280.79s/it]
Task 0, Epoch 20/20 => Loss 0.311, Train_accy 90.83, Test_accy 94.72: 100%|██████████| 20/20 [1:32:06<00:00, 276.35s/it]
2024-09-04 03:39:01,052 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.311, Train_accy 90.83, Test_accy 94.72
2024-09-04 03:39:29,164 [trainer.py] => No NME accuracy.
2024-09-04 03:39:29,164 [trainer.py] => CNN: {'total': 94.72, '00-49': 94.72, 'old': 0, 'new': 94.72}
2024-09-04 03:39:29,164 [trainer.py] => CNN top1 curve: [94.72]
2024-09-04 03:39:29,165 [trainer.py] => CNN top5 curve: [99.36]

Average Accuracy (CNN): 94.72
2024-09-04 03:39:29,165 [trainer.py] => Average Accuracy (CNN): 94.72 

2024-09-04 03:39:29,166 [trainer.py] => All params: 89715556
2024-09-04 03:39:29,167 [trainer.py] => Trainable params: 89715556
2024-09-04 03:39:29,928 [coda_prompt.py] => Learning on 50-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.447, Train_accy 86.04:   0%|          | 0/20 [00:54<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.447, Train_accy 86.04:   5%|▌         | 1/20 [00:54<17:15, 54.47s/it]
Task 1, Epoch 2/20 => Loss 0.197, Train_accy 93.55:   5%|▌         | 1/20 [01:48<17:15, 54.47s/it]
Task 1, Epoch 2/20 => Loss 0.197, Train_accy 93.55:  10%|█         | 2/20 [01:48<16:20, 54.48s/it]
Task 1, Epoch 3/20 => Loss 0.162, Train_accy 94.45:  10%|█         | 2/20 [02:43<16:20, 54.48s/it]
Task 1, Epoch 3/20 => Loss 0.162, Train_accy 94.45:  15%|█▌        | 3/20 [02:43<15:26, 54.48s/it]
Task 1, Epoch 4/20 => Loss 0.148, Train_accy 95.01:  15%|█▌        | 3/20 [03:37<15:26, 54.48s/it]
Task 1, Epoch 4/20 => Loss 0.148, Train_accy 95.01:  20%|██        | 4/20 [03:37<14:31, 54.46s/it]
Task 1, Epoch 5/20 => Loss 0.144, Train_accy 95.11, Test_accy 89.48:  20%|██        | 4/20 [05:05<14:31, 54.46s/it]
Task 1, Epoch 5/20 => Loss 0.144, Train_accy 95.11, Test_accy 89.48:  25%|██▌       | 5/20 [05:05<16:38, 66.59s/it]
Task 1, Epoch 6/20 => Loss 0.139, Train_accy 94.89:  25%|██▌       | 5/20 [06:00<16:38, 66.59s/it]                 
Task 1, Epoch 6/20 => Loss 0.139, Train_accy 94.89:  30%|███       | 6/20 [06:00<14:34, 62.47s/it]
Task 1, Epoch 7/20 => Loss 0.140, Train_accy 95.43:  30%|███       | 6/20 [06:54<14:34, 62.47s/it]
Task 1, Epoch 7/20 => Loss 0.140, Train_accy 95.43:  35%|███▌      | 7/20 [06:54<12:57, 59.78s/it]
Task 1, Epoch 8/20 => Loss 0.133, Train_accy 95.57:  35%|███▌      | 7/20 [07:49<12:57, 59.78s/it]
Task 1, Epoch 8/20 => Loss 0.133, Train_accy 95.57:  40%|████      | 8/20 [07:49<11:36, 58.07s/it]
Task 1, Epoch 9/20 => Loss 0.144, Train_accy 94.99:  40%|████      | 8/20 [08:43<11:36, 58.07s/it]
Task 1, Epoch 9/20 => Loss 0.144, Train_accy 94.99:  45%|████▌     | 9/20 [08:43<10:26, 56.93s/it]
Task 1, Epoch 10/20 => Loss 0.133, Train_accy 95.67, Test_accy 90.90:  45%|████▌     | 9/20 [10:11<10:26, 56.93s/it]
Task 1, Epoch 10/20 => Loss 0.133, Train_accy 95.67, Test_accy 90.90:  50%|█████     | 10/20 [10:11<11:05, 66.52s/it]
Task 1, Epoch 11/20 => Loss 0.126, Train_accy 95.49:  50%|█████     | 10/20 [11:05<11:05, 66.52s/it]                 
Task 1, Epoch 11/20 => Loss 0.126, Train_accy 95.49:  55%|█████▌    | 11/20 [11:05<09:25, 62.82s/it]
Task 1, Epoch 12/20 => Loss 0.122, Train_accy 95.91:  55%|█████▌    | 11/20 [12:00<09:25, 62.82s/it]
Task 1, Epoch 12/20 => Loss 0.122, Train_accy 95.91:  60%|██████    | 12/20 [12:00<08:02, 60.33s/it]
Task 1, Epoch 13/20 => Loss 0.130, Train_accy 95.51:  60%|██████    | 12/20 [12:55<08:02, 60.33s/it]
Task 1, Epoch 13/20 => Loss 0.130, Train_accy 95.51:  65%|██████▌   | 13/20 [12:55<06:50, 58.59s/it]
Task 1, Epoch 14/20 => Loss 0.112, Train_accy 96.29:  65%|██████▌   | 13/20 [13:49<06:50, 58.59s/it]
Task 1, Epoch 14/20 => Loss 0.112, Train_accy 96.29:  70%|███████   | 14/20 [13:49<05:44, 57.37s/it]
Task 1, Epoch 15/20 => Loss 0.115, Train_accy 95.97, Test_accy 91.33:  70%|███████   | 14/20 [15:18<05:44, 57.37s/it]
Task 1, Epoch 15/20 => Loss 0.115, Train_accy 95.97, Test_accy 91.33:  75%|███████▌  | 15/20 [15:18<05:33, 66.70s/it]
Task 1, Epoch 16/20 => Loss 0.120, Train_accy 95.63:  75%|███████▌  | 15/20 [16:12<05:33, 66.70s/it]                 
Task 1, Epoch 16/20 => Loss 0.120, Train_accy 95.63:  80%|████████  | 16/20 [16:12<04:12, 63.05s/it]
Task 1, Epoch 17/20 => Loss 0.105, Train_accy 96.47:  80%|████████  | 16/20 [17:07<04:12, 63.05s/it]
Task 1, Epoch 17/20 => Loss 0.105, Train_accy 96.47:  85%|████████▌ | 17/20 [17:07<03:01, 60.51s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 95.91:  85%|████████▌ | 17/20 [18:01<03:01, 60.51s/it]
Task 1, Epoch 18/20 => Loss 0.119, Train_accy 95.91:  90%|█████████ | 18/20 [18:01<01:57, 58.72s/it]
Task 1, Epoch 19/20 => Loss 0.111, Train_accy 96.21:  90%|█████████ | 18/20 [18:56<01:57, 58.72s/it]
Task 1, Epoch 19/20 => Loss 0.111, Train_accy 96.21:  95%|█████████▌| 19/20 [18:56<00:57, 57.47s/it]
Task 1, Epoch 20/20 => Loss 0.111, Train_accy 96.49, Test_accy 91.25:  95%|█████████▌| 19/20 [20:24<00:57, 57.47s/it]
Task 1, Epoch 20/20 => Loss 0.111, Train_accy 96.49, Test_accy 91.25: 100%|██████████| 20/20 [20:24<00:00, 66.74s/it]
Task 1, Epoch 20/20 => Loss 0.111, Train_accy 96.49, Test_accy 91.25: 100%|██████████| 20/20 [20:24<00:00, 61.23s/it]
2024-09-04 03:59:54,635 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.111, Train_accy 96.49, Test_accy 91.25
2024-09-04 04:00:28,498 [trainer.py] => No NME accuracy.
2024-09-04 04:00:28,498 [trainer.py] => CNN: {'total': 91.25, '00-49': 94.36, '50-59': 75.7, 'old': 94.36, 'new': 75.7}
2024-09-04 04:00:28,498 [trainer.py] => CNN top1 curve: [94.72, 91.25]
2024-09-04 04:00:28,498 [trainer.py] => CNN top5 curve: [99.36, 99.0]

Average Accuracy (CNN): 92.98
2024-09-04 04:00:28,498 [trainer.py] => Average Accuracy (CNN): 92.98 

2024-09-04 04:00:28,499 [trainer.py] => All params: 89715556
2024-09-04 04:00:28,500 [trainer.py] => Trainable params: 89715556
2024-09-04 04:00:29,820 [coda_prompt.py] => Learning on 60-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.303, Train_accy 90.56:   0%|          | 0/20 [00:54<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.303, Train_accy 90.56:   5%|▌         | 1/20 [00:54<17:19, 54.70s/it]
Task 2, Epoch 2/20 => Loss 0.130, Train_accy 95.59:   5%|▌         | 1/20 [01:49<17:19, 54.70s/it]
Task 2, Epoch 2/20 => Loss 0.130, Train_accy 95.59:  10%|█         | 2/20 [01:49<16:26, 54.78s/it]
Task 2, Epoch 3/20 => Loss 0.131, Train_accy 96.05:  10%|█         | 2/20 [02:44<16:26, 54.78s/it]
Task 2, Epoch 3/20 => Loss 0.131, Train_accy 96.05:  15%|█▌        | 3/20 [02:44<15:31, 54.82s/it]
Task 2, Epoch 4/20 => Loss 0.116, Train_accy 96.17:  15%|█▌        | 3/20 [03:39<15:31, 54.82s/it]
Task 2, Epoch 4/20 => Loss 0.116, Train_accy 96.17:  20%|██        | 4/20 [03:39<14:36, 54.81s/it]
Task 2, Epoch 5/20 => Loss 0.099, Train_accy 96.75, Test_accy 87.04:  20%|██        | 4/20 [05:13<14:36, 54.81s/it]
Task 2, Epoch 5/20 => Loss 0.099, Train_accy 96.75, Test_accy 87.04:  25%|██▌       | 5/20 [05:13<17:14, 68.99s/it]
Task 2, Epoch 6/20 => Loss 0.106, Train_accy 96.35:  25%|██▌       | 5/20 [06:07<17:14, 68.99s/it]                 
Task 2, Epoch 6/20 => Loss 0.106, Train_accy 96.35:  30%|███       | 6/20 [06:07<14:53, 63.82s/it]
Task 2, Epoch 7/20 => Loss 0.098, Train_accy 96.61:  30%|███       | 6/20 [07:01<14:53, 63.82s/it]
Task 2, Epoch 7/20 => Loss 0.098, Train_accy 96.61:  35%|███▌      | 7/20 [07:01<13:08, 60.68s/it]
Task 2, Epoch 8/20 => Loss 0.097, Train_accy 96.81:  35%|███▌      | 7/20 [07:55<13:08, 60.68s/it]
Task 2, Epoch 8/20 => Loss 0.097, Train_accy 96.81:  40%|████      | 8/20 [07:55<11:44, 58.74s/it]
Task 2, Epoch 9/20 => Loss 0.096, Train_accy 96.96:  40%|████      | 8/20 [08:50<11:44, 58.74s/it]
Task 2, Epoch 9/20 => Loss 0.096, Train_accy 96.96:  45%|████▌     | 9/20 [08:50<10:31, 57.44s/it]
Task 2, Epoch 10/20 => Loss 0.085, Train_accy 97.30, Test_accy 88.33:  45%|████▌     | 9/20 [10:24<10:31, 57.44s/it]
Task 2, Epoch 10/20 => Loss 0.085, Train_accy 97.30, Test_accy 88.33:  50%|█████     | 10/20 [10:24<11:26, 68.69s/it]
Task 2, Epoch 11/20 => Loss 0.101, Train_accy 96.85:  50%|█████     | 10/20 [11:19<11:26, 68.69s/it]                 
Task 2, Epoch 11/20 => Loss 0.101, Train_accy 96.85:  55%|█████▌    | 11/20 [11:19<09:39, 64.40s/it]
Task 2, Epoch 12/20 => Loss 0.096, Train_accy 97.08:  55%|█████▌    | 11/20 [12:13<09:39, 64.40s/it]
Task 2, Epoch 12/20 => Loss 0.096, Train_accy 97.08:  60%|██████    | 12/20 [12:13<08:11, 61.45s/it]
Task 2, Epoch 13/20 => Loss 0.098, Train_accy 96.83:  60%|██████    | 12/20 [13:08<08:11, 61.45s/it]
Task 2, Epoch 13/20 => Loss 0.098, Train_accy 96.83:  65%|██████▌   | 13/20 [13:08<06:55, 59.41s/it]
Task 2, Epoch 14/20 => Loss 0.087, Train_accy 97.02:  65%|██████▌   | 13/20 [14:03<06:55, 59.41s/it]
Task 2, Epoch 14/20 => Loss 0.087, Train_accy 97.02:  70%|███████   | 14/20 [14:03<05:48, 58.00s/it]
Task 2, Epoch 15/20 => Loss 0.088, Train_accy 97.16, Test_accy 88.77:  70%|███████   | 14/20 [15:37<05:48, 58.00s/it]
Task 2, Epoch 15/20 => Loss 0.088, Train_accy 97.16, Test_accy 88.77:  75%|███████▌  | 15/20 [15:37<05:44, 68.88s/it]
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.36:  75%|███████▌  | 15/20 [16:32<05:44, 68.88s/it]                 
Task 2, Epoch 16/20 => Loss 0.090, Train_accy 97.36:  80%|████████  | 16/20 [16:32<04:18, 64.62s/it]
Task 2, Epoch 17/20 => Loss 0.088, Train_accy 96.92:  80%|████████  | 16/20 [17:26<04:18, 64.62s/it]
Task 2, Epoch 17/20 => Loss 0.088, Train_accy 96.92:  85%|████████▌ | 17/20 [17:26<03:04, 61.63s/it]
Task 2, Epoch 18/20 => Loss 0.090, Train_accy 97.02:  85%|████████▌ | 17/20 [18:21<03:04, 61.63s/it]
Task 2, Epoch 18/20 => Loss 0.090, Train_accy 97.02:  90%|█████████ | 18/20 [18:21<01:59, 59.52s/it]
Task 2, Epoch 19/20 => Loss 0.097, Train_accy 97.20:  90%|█████████ | 18/20 [19:16<01:59, 59.52s/it]
Task 2, Epoch 19/20 => Loss 0.097, Train_accy 97.20:  95%|█████████▌| 19/20 [19:16<00:58, 58.07s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 96.90, Test_accy 89.01:  95%|█████████▌| 19/20 [20:50<00:58, 58.07s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 96.90, Test_accy 89.01: 100%|██████████| 20/20 [20:50<00:00, 68.86s/it]
Task 2, Epoch 20/20 => Loss 0.087, Train_accy 96.90, Test_accy 89.01: 100%|██████████| 20/20 [20:50<00:00, 62.50s/it]
2024-09-04 04:21:19,887 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.087, Train_accy 96.90, Test_accy 89.01
2024-09-04 04:21:59,389 [trainer.py] => No NME accuracy.
2024-09-04 04:21:59,390 [trainer.py] => CNN: {'total': 89.01, '00-49': 94.26, '50-59': 74.1, '60-69': 77.7, 'old': 90.9, 'new': 77.7}
2024-09-04 04:21:59,390 [trainer.py] => CNN top1 curve: [94.72, 91.25, 89.01]
2024-09-04 04:21:59,390 [trainer.py] => CNN top5 curve: [99.36, 99.0, 98.8]

Average Accuracy (CNN): 91.66
2024-09-04 04:21:59,390 [trainer.py] => Average Accuracy (CNN): 91.66 

2024-09-04 04:21:59,391 [trainer.py] => All params: 89715556
2024-09-04 04:21:59,393 [trainer.py] => Trainable params: 89715556
2024-09-04 04:22:01,168 [coda_prompt.py] => Learning on 70-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.414, Train_accy 86.82:   0%|          | 0/20 [00:54<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.414, Train_accy 86.82:   5%|▌         | 1/20 [00:54<17:20, 54.78s/it]
Task 3, Epoch 2/20 => Loss 0.198, Train_accy 93.19:   5%|▌         | 1/20 [01:49<17:20, 54.78s/it]
Task 3, Epoch 2/20 => Loss 0.198, Train_accy 93.19:  10%|█         | 2/20 [01:49<16:26, 54.81s/it]
Task 3, Epoch 3/20 => Loss 0.170, Train_accy 93.85:  10%|█         | 2/20 [02:44<16:26, 54.81s/it]
Task 3, Epoch 3/20 => Loss 0.170, Train_accy 93.85:  15%|█▌        | 3/20 [02:44<15:31, 54.80s/it]
Task 3, Epoch 4/20 => Loss 0.161, Train_accy 94.61:  15%|█▌        | 3/20 [03:39<15:31, 54.80s/it]
Task 3, Epoch 4/20 => Loss 0.161, Train_accy 94.61:  20%|██        | 4/20 [03:39<14:36, 54.79s/it]
Task 3, Epoch 5/20 => Loss 0.163, Train_accy 94.27, Test_accy 83.14:  20%|██        | 4/20 [05:18<14:36, 54.79s/it]
Task 3, Epoch 5/20 => Loss 0.163, Train_accy 94.27, Test_accy 83.14:  25%|██▌       | 5/20 [05:18<17:44, 70.97s/it]
Task 3, Epoch 6/20 => Loss 0.152, Train_accy 94.49:  25%|██▌       | 5/20 [06:13<17:44, 70.97s/it]                 
Task 3, Epoch 6/20 => Loss 0.152, Train_accy 94.49:  30%|███       | 6/20 [06:13<15:17, 65.52s/it]
Task 3, Epoch 7/20 => Loss 0.136, Train_accy 95.03:  30%|███       | 6/20 [07:08<15:17, 65.52s/it]
Task 3, Epoch 7/20 => Loss 0.136, Train_accy 95.03:  35%|███▌      | 7/20 [07:08<13:26, 62.00s/it]
Task 3, Epoch 8/20 => Loss 0.126, Train_accy 95.71:  35%|███▌      | 7/20 [08:03<13:26, 62.00s/it]
Task 3, Epoch 8/20 => Loss 0.126, Train_accy 95.71:  40%|████      | 8/20 [08:03<11:56, 59.71s/it]
Task 3, Epoch 9/20 => Loss 0.131, Train_accy 95.79:  40%|████      | 8/20 [08:58<11:56, 59.71s/it]
Task 3, Epoch 9/20 => Loss 0.131, Train_accy 95.79:  45%|████▌     | 9/20 [08:58<10:39, 58.16s/it]
Task 3, Epoch 10/20 => Loss 0.125, Train_accy 95.53, Test_accy 84.42:  45%|████▌     | 9/20 [10:37<10:39, 58.16s/it]
Task 3, Epoch 10/20 => Loss 0.125, Train_accy 95.53, Test_accy 84.42:  50%|█████     | 10/20 [10:37<11:49, 70.97s/it]
Task 3, Epoch 11/20 => Loss 0.130, Train_accy 95.37:  50%|█████     | 10/20 [11:32<11:49, 70.97s/it]                 
Task 3, Epoch 11/20 => Loss 0.130, Train_accy 95.37:  55%|█████▌    | 11/20 [11:32<09:54, 66.03s/it]
Task 3, Epoch 12/20 => Loss 0.112, Train_accy 96.29:  55%|█████▌    | 11/20 [12:27<09:54, 66.03s/it]
Task 3, Epoch 12/20 => Loss 0.112, Train_accy 96.29:  60%|██████    | 12/20 [12:27<08:20, 62.59s/it]
Task 3, Epoch 13/20 => Loss 0.117, Train_accy 96.17:  60%|██████    | 12/20 [13:21<08:20, 62.59s/it]
Task 3, Epoch 13/20 => Loss 0.117, Train_accy 96.17:  65%|██████▌   | 13/20 [13:21<07:01, 60.20s/it]
Task 3, Epoch 14/20 => Loss 0.114, Train_accy 95.99:  65%|██████▌   | 13/20 [14:16<07:01, 60.20s/it]
Task 3, Epoch 14/20 => Loss 0.114, Train_accy 95.99:  70%|███████   | 14/20 [14:16<05:51, 58.58s/it]
Task 3, Epoch 15/20 => Loss 0.118, Train_accy 95.85, Test_accy 84.55:  70%|███████   | 14/20 [15:56<05:51, 58.58s/it]
Task 3, Epoch 15/20 => Loss 0.118, Train_accy 95.85, Test_accy 84.55:  75%|███████▌  | 15/20 [15:56<05:54, 70.96s/it]
Task 3, Epoch 16/20 => Loss 0.105, Train_accy 96.41:  75%|███████▌  | 15/20 [16:51<05:54, 70.96s/it]                 
Task 3, Epoch 16/20 => Loss 0.105, Train_accy 96.41:  80%|████████  | 16/20 [16:51<04:24, 66.06s/it]
Task 3, Epoch 17/20 => Loss 0.110, Train_accy 96.35:  80%|████████  | 16/20 [17:45<04:24, 66.06s/it]
Task 3, Epoch 17/20 => Loss 0.110, Train_accy 96.35:  85%|████████▌ | 17/20 [17:45<03:07, 62.64s/it]
Task 3, Epoch 18/20 => Loss 0.097, Train_accy 96.47:  85%|████████▌ | 17/20 [18:40<03:07, 62.64s/it]
Task 3, Epoch 18/20 => Loss 0.097, Train_accy 96.47:  90%|█████████ | 18/20 [18:40<02:00, 60.25s/it]
Task 3, Epoch 19/20 => Loss 0.101, Train_accy 96.43:  90%|█████████ | 18/20 [19:35<02:00, 60.25s/it]
Task 3, Epoch 19/20 => Loss 0.101, Train_accy 96.43:  95%|█████████▌| 19/20 [19:35<00:58, 58.57s/it]
Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.65, Test_accy 84.46:  95%|█████████▌| 19/20 [21:14<00:58, 58.57s/it]
Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.65, Test_accy 84.46: 100%|██████████| 20/20 [21:14<00:00, 70.85s/it]
Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.65, Test_accy 84.46: 100%|██████████| 20/20 [21:14<00:00, 63.73s/it]
2024-09-04 04:43:15,874 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.098, Train_accy 96.65, Test_accy 84.46
2024-09-04 04:44:00,775 [trainer.py] => No NME accuracy.
2024-09-04 04:44:00,776 [trainer.py] => CNN: {'total': 84.46, '00-49': 94.12, '50-59': 72.0, '60-69': 75.3, '70-79': 57.8, 'old': 88.27, 'new': 57.8}
2024-09-04 04:44:00,776 [trainer.py] => CNN top1 curve: [94.72, 91.25, 89.01, 84.46]
2024-09-04 04:44:00,776 [trainer.py] => CNN top5 curve: [99.36, 99.0, 98.8, 98.42]

Average Accuracy (CNN): 89.86
2024-09-04 04:44:00,776 [trainer.py] => Average Accuracy (CNN): 89.86 

2024-09-04 04:44:00,777 [trainer.py] => All params: 89715556
2024-09-04 04:44:00,778 [trainer.py] => Trainable params: 89715556
2024-09-04 04:44:03,032 [coda_prompt.py] => Learning on 80-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.408, Train_accy 86.52:   0%|          | 0/20 [00:54<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.408, Train_accy 86.52:   5%|▌         | 1/20 [00:54<17:19, 54.69s/it]
Task 4, Epoch 2/20 => Loss 0.158, Train_accy 94.63:   5%|▌         | 1/20 [01:49<17:19, 54.69s/it]
Task 4, Epoch 2/20 => Loss 0.158, Train_accy 94.63:  10%|█         | 2/20 [01:49<16:24, 54.68s/it]
Task 4, Epoch 3/20 => Loss 0.156, Train_accy 94.83:  10%|█         | 2/20 [02:44<16:24, 54.68s/it]
Task 4, Epoch 3/20 => Loss 0.156, Train_accy 94.83:  15%|█▌        | 3/20 [02:44<15:29, 54.70s/it]
Task 4, Epoch 4/20 => Loss 0.135, Train_accy 95.55:  15%|█▌        | 3/20 [03:38<15:29, 54.70s/it]
Task 4, Epoch 4/20 => Loss 0.135, Train_accy 95.55:  20%|██        | 4/20 [03:38<14:35, 54.73s/it]
Task 4, Epoch 5/20 => Loss 0.146, Train_accy 95.01, Test_accy 78.21:  20%|██        | 4/20 [05:24<14:35, 54.73s/it]
Task 4, Epoch 5/20 => Loss 0.146, Train_accy 95.01, Test_accy 78.21:  25%|██▌       | 5/20 [05:24<18:14, 72.99s/it]
Task 4, Epoch 6/20 => Loss 0.139, Train_accy 95.27:  25%|██▌       | 5/20 [06:19<18:14, 72.99s/it]                 
Task 4, Epoch 6/20 => Loss 0.139, Train_accy 95.27:  30%|███       | 6/20 [06:19<15:35, 66.85s/it]
Task 4, Epoch 7/20 => Loss 0.132, Train_accy 95.35:  30%|███       | 6/20 [07:13<15:35, 66.85s/it]
Task 4, Epoch 7/20 => Loss 0.132, Train_accy 95.35:  35%|███▌      | 7/20 [07:13<13:37, 62.91s/it]
Task 4, Epoch 8/20 => Loss 0.110, Train_accy 96.23:  35%|███▌      | 7/20 [08:08<13:37, 62.91s/it]
Task 4, Epoch 8/20 => Loss 0.110, Train_accy 96.23:  40%|████      | 8/20 [08:08<12:04, 60.34s/it]
Task 4, Epoch 9/20 => Loss 0.124, Train_accy 95.91:  40%|████      | 8/20 [09:03<12:04, 60.34s/it]
Task 4, Epoch 9/20 => Loss 0.124, Train_accy 95.91:  45%|████▌     | 9/20 [09:03<10:44, 58.61s/it]
Task 4, Epoch 10/20 => Loss 0.124, Train_accy 95.55, Test_accy 79.86:  45%|████▌     | 9/20 [10:48<10:44, 58.61s/it]
Task 4, Epoch 10/20 => Loss 0.124, Train_accy 95.55, Test_accy 79.86:  50%|█████     | 10/20 [10:48<12:10, 73.03s/it]
Task 4, Epoch 11/20 => Loss 0.121, Train_accy 95.99:  50%|█████     | 10/20 [11:43<12:10, 73.03s/it]                 
Task 4, Epoch 11/20 => Loss 0.121, Train_accy 95.99:  55%|█████▌    | 11/20 [11:43<10:07, 67.46s/it]
Task 4, Epoch 12/20 => Loss 0.117, Train_accy 96.31:  55%|█████▌    | 11/20 [12:38<10:07, 67.46s/it]
Task 4, Epoch 12/20 => Loss 0.117, Train_accy 96.31:  60%|██████    | 12/20 [12:38<08:29, 63.63s/it]
Task 4, Epoch 13/20 => Loss 0.114, Train_accy 96.15:  60%|██████    | 12/20 [13:33<08:29, 63.63s/it]
Task 4, Epoch 13/20 => Loss 0.114, Train_accy 96.15:  65%|██████▌   | 13/20 [13:33<07:06, 60.99s/it]
Task 4, Epoch 14/20 => Loss 0.112, Train_accy 96.35:  65%|██████▌   | 13/20 [14:28<07:06, 60.99s/it]
Task 4, Epoch 14/20 => Loss 0.112, Train_accy 96.35:  70%|███████   | 14/20 [14:28<05:54, 59.12s/it]
Task 4, Epoch 15/20 => Loss 0.117, Train_accy 96.15, Test_accy 80.39:  70%|███████   | 14/20 [16:13<05:54, 59.12s/it]
Task 4, Epoch 15/20 => Loss 0.117, Train_accy 96.15, Test_accy 80.39:  75%|███████▌  | 15/20 [16:13<06:05, 73.05s/it]
Task 4, Epoch 16/20 => Loss 0.110, Train_accy 96.59:  75%|███████▌  | 15/20 [17:08<06:05, 73.05s/it]                 
Task 4, Epoch 16/20 => Loss 0.110, Train_accy 96.59:  80%|████████  | 16/20 [17:08<04:30, 67.61s/it]
Task 4, Epoch 17/20 => Loss 0.119, Train_accy 95.95:  80%|████████  | 16/20 [18:03<04:30, 67.61s/it]
Task 4, Epoch 17/20 => Loss 0.119, Train_accy 95.95:  85%|████████▌ | 17/20 [18:03<03:11, 63.75s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 97.04:  85%|████████▌ | 17/20 [18:58<03:11, 63.75s/it]
Task 4, Epoch 18/20 => Loss 0.096, Train_accy 97.04:  90%|█████████ | 18/20 [18:58<02:02, 61.07s/it]
Task 4, Epoch 19/20 => Loss 0.095, Train_accy 96.73:  90%|█████████ | 18/20 [19:53<02:02, 61.07s/it]
Task 4, Epoch 19/20 => Loss 0.095, Train_accy 96.73:  95%|█████████▌| 19/20 [19:53<00:59, 59.19s/it]
Task 4, Epoch 20/20 => Loss 0.101, Train_accy 96.55, Test_accy 80.44:  95%|█████████▌| 19/20 [21:38<00:59, 59.19s/it]
Task 4, Epoch 20/20 => Loss 0.101, Train_accy 96.55, Test_accy 80.44: 100%|██████████| 20/20 [21:38<00:00, 73.05s/it]
Task 4, Epoch 20/20 => Loss 0.101, Train_accy 96.55, Test_accy 80.44: 100%|██████████| 20/20 [21:38<00:00, 64.92s/it]
2024-09-04 05:05:41,487 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.101, Train_accy 96.55, Test_accy 80.44
2024-09-04 05:06:32,004 [trainer.py] => No NME accuracy.
2024-09-04 05:06:32,004 [trainer.py] => CNN: {'total': 80.44, '00-49': 94.12, '50-59': 70.4, '60-69': 75.5, '70-79': 55.7, '80-89': 51.8, 'old': 84.02, 'new': 51.8}
2024-09-04 05:06:32,004 [trainer.py] => CNN top1 curve: [94.72, 91.25, 89.01, 84.46, 80.44]
2024-09-04 05:06:32,004 [trainer.py] => CNN top5 curve: [99.36, 99.0, 98.8, 98.42, 97.99]

Average Accuracy (CNN): 87.98
2024-09-04 05:06:32,005 [trainer.py] => Average Accuracy (CNN): 87.98 

2024-09-04 05:06:32,006 [trainer.py] => All params: 89715556
2024-09-04 05:06:32,007 [trainer.py] => Trainable params: 89715556
2024-09-04 05:06:34,770 [coda_prompt.py] => Learning on 90-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.416, Train_accy 87.38:   0%|          | 0/20 [00:54<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.416, Train_accy 87.38:   5%|▌         | 1/20 [00:54<17:21, 54.84s/it]
Task 5, Epoch 2/20 => Loss 0.202, Train_accy 93.49:   5%|▌         | 1/20 [01:49<17:21, 54.84s/it]
Task 5, Epoch 2/20 => Loss 0.202, Train_accy 93.49:  10%|█         | 2/20 [01:49<16:27, 54.84s/it]
Task 5, Epoch 3/20 => Loss 0.196, Train_accy 93.41:  10%|█         | 2/20 [02:44<16:27, 54.84s/it]
Task 5, Epoch 3/20 => Loss 0.196, Train_accy 93.41:  15%|█▌        | 3/20 [02:44<15:31, 54.81s/it]
Task 5, Epoch 4/20 => Loss 0.180, Train_accy 93.95:  15%|█▌        | 3/20 [03:39<15:31, 54.81s/it]
Task 5, Epoch 4/20 => Loss 0.180, Train_accy 93.95:  20%|██        | 4/20 [03:39<14:36, 54.79s/it]
Task 5, Epoch 5/20 => Loss 0.163, Train_accy 94.43, Test_accy 77.18:  20%|██        | 4/20 [05:29<14:36, 54.79s/it]
Task 5, Epoch 5/20 => Loss 0.163, Train_accy 94.43, Test_accy 77.18:  25%|██▌       | 5/20 [05:29<18:43, 74.91s/it]
Task 5, Epoch 6/20 => Loss 0.152, Train_accy 94.85:  25%|██▌       | 5/20 [06:23<18:43, 74.91s/it]                 
Task 5, Epoch 6/20 => Loss 0.152, Train_accy 94.85:  30%|███       | 6/20 [06:23<15:47, 67.66s/it]
Task 5, Epoch 7/20 => Loss 0.141, Train_accy 95.19:  30%|███       | 6/20 [07:17<15:47, 67.66s/it]
Task 5, Epoch 7/20 => Loss 0.141, Train_accy 95.19:  35%|███▌      | 7/20 [07:17<13:43, 63.35s/it]
Task 5, Epoch 8/20 => Loss 0.155, Train_accy 95.11:  35%|███▌      | 7/20 [08:12<13:43, 63.35s/it]
Task 5, Epoch 8/20 => Loss 0.155, Train_accy 95.11:  40%|████      | 8/20 [08:12<12:07, 60.66s/it]
Task 5, Epoch 9/20 => Loss 0.142, Train_accy 95.41:  40%|████      | 8/20 [09:07<12:07, 60.66s/it]
Task 5, Epoch 9/20 => Loss 0.142, Train_accy 95.41:  45%|████▌     | 9/20 [09:07<10:47, 58.86s/it]
Task 5, Epoch 10/20 => Loss 0.127, Train_accy 95.71, Test_accy 78.14:  45%|████▌     | 9/20 [10:58<10:47, 58.86s/it]
Task 5, Epoch 10/20 => Loss 0.127, Train_accy 95.71, Test_accy 78.14:  50%|█████     | 10/20 [10:58<12:29, 74.94s/it]
Task 5, Epoch 11/20 => Loss 0.140, Train_accy 95.15:  50%|█████     | 10/20 [11:53<12:29, 74.94s/it]                 
Task 5, Epoch 11/20 => Loss 0.140, Train_accy 95.15:  55%|█████▌    | 11/20 [11:53<10:19, 68.79s/it]
Task 5, Epoch 12/20 => Loss 0.125, Train_accy 95.99:  55%|█████▌    | 11/20 [12:48<10:19, 68.79s/it]
Task 5, Epoch 12/20 => Loss 0.125, Train_accy 95.99:  60%|██████    | 12/20 [12:48<08:36, 64.56s/it]
Task 5, Epoch 13/20 => Loss 0.120, Train_accy 95.91:  60%|██████    | 12/20 [13:43<08:36, 64.56s/it]
Task 5, Epoch 13/20 => Loss 0.120, Train_accy 95.91:  65%|██████▌   | 13/20 [13:43<07:11, 61.68s/it]
Task 5, Epoch 14/20 => Loss 0.130, Train_accy 95.57:  65%|██████▌   | 13/20 [14:38<07:11, 61.68s/it]
Task 5, Epoch 14/20 => Loss 0.130, Train_accy 95.57:  70%|███████   | 14/20 [14:38<05:57, 59.65s/it]
Task 5, Epoch 15/20 => Loss 0.133, Train_accy 95.51, Test_accy 78.50:  70%|███████   | 14/20 [16:29<05:57, 59.65s/it]
Task 5, Epoch 15/20 => Loss 0.133, Train_accy 95.51, Test_accy 78.50:  75%|███████▌  | 15/20 [16:29<06:15, 75.14s/it]
Task 5, Epoch 16/20 => Loss 0.105, Train_accy 96.47:  75%|███████▌  | 15/20 [17:24<06:15, 75.14s/it]                 
Task 5, Epoch 16/20 => Loss 0.105, Train_accy 96.47:  80%|████████  | 16/20 [17:24<04:36, 69.01s/it]
Task 5, Epoch 17/20 => Loss 0.117, Train_accy 95.91:  80%|████████  | 16/20 [18:18<04:36, 69.01s/it]
Task 5, Epoch 17/20 => Loss 0.117, Train_accy 95.91:  85%|████████▌ | 17/20 [18:18<03:14, 64.73s/it]
Task 5, Epoch 18/20 => Loss 0.119, Train_accy 95.93:  85%|████████▌ | 17/20 [19:13<03:14, 64.73s/it]
Task 5, Epoch 18/20 => Loss 0.119, Train_accy 95.93:  90%|█████████ | 18/20 [19:13<02:03, 61.74s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 95.89:  90%|█████████ | 18/20 [20:08<02:03, 61.74s/it]
Task 5, Epoch 19/20 => Loss 0.120, Train_accy 95.89:  95%|█████████▌| 19/20 [20:08<00:59, 59.65s/it]
Task 5, Epoch 20/20 => Loss 0.118, Train_accy 96.15, Test_accy 78.39:  95%|█████████▌| 19/20 [21:59<00:59, 59.65s/it]
Task 5, Epoch 20/20 => Loss 0.118, Train_accy 96.15, Test_accy 78.39: 100%|██████████| 20/20 [21:59<00:00, 75.02s/it]
Task 5, Epoch 20/20 => Loss 0.118, Train_accy 96.15, Test_accy 78.39: 100%|██████████| 20/20 [21:59<00:00, 65.97s/it]
2024-09-04 05:28:34,175 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.118, Train_accy 96.15, Test_accy 78.39
2024-09-04 05:29:30,187 [trainer.py] => No NME accuracy.
2024-09-04 05:29:30,187 [trainer.py] => CNN: {'total': 78.39, '00-49': 94.14, '50-59': 71.5, '60-69': 76.8, '70-79': 57.0, '80-89': 52.1, '90-99': 55.8, 'old': 80.9, 'new': 55.8}
2024-09-04 05:29:30,187 [trainer.py] => CNN top1 curve: [94.72, 91.25, 89.01, 84.46, 80.44, 78.39]
2024-09-04 05:29:30,188 [trainer.py] => CNN top5 curve: [99.36, 99.0, 98.8, 98.42, 97.99, 97.63]

Average Accuracy (CNN): 86.38
2024-09-04 05:29:30,188 [trainer.py] => Average Accuracy (CNN): 86.38 

Accuracy Matrix (CNN):
[[94.72 94.36 94.26 94.12 94.12 94.14]
 [ 0.   75.7  74.1  72.   70.4  71.5 ]
 [ 0.    0.   77.7  75.3  75.5  76.8 ]
 [ 0.    0.    0.   57.8  55.7  57.  ]
 [ 0.    0.    0.    0.   51.8  52.1 ]
 [ 0.    0.    0.    0.    0.   55.8 ]]
2024-09-04 05:29:30,189 [trainer.py] => Forgetting (CNN): 1.2960000000000007
2024-09-04 05:29:32,903 [trainer.py] => config: ./exps/coda_prompt_cifar_B50_Inc10.json
2024-09-04 05:29:32,903 [trainer.py] => prefix:  
2024-09-04 05:29:32,903 [trainer.py] => dataset: cifar224
2024-09-04 05:29:32,903 [trainer.py] => memory_size: 0
2024-09-04 05:29:32,903 [trainer.py] => memory_per_class: 0
2024-09-04 05:29:32,903 [trainer.py] => fixed_memory: False
2024-09-04 05:29:32,903 [trainer.py] => shuffle: True
2024-09-04 05:29:32,903 [trainer.py] => init_cls: 50
2024-09-04 05:29:32,903 [trainer.py] => increment: 5
2024-09-04 05:29:32,903 [trainer.py] => model_name: coda_prompt
2024-09-04 05:29:32,903 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_coda_prompt
2024-09-04 05:29:32,903 [trainer.py] => device: [device(type='cuda', index=1)]
2024-09-04 05:29:32,903 [trainer.py] => seed: 1993
2024-09-04 05:29:32,903 [trainer.py] => tuned_epoch: 20
2024-09-04 05:29:32,903 [trainer.py] => init_lr: 0.001
2024-09-04 05:29:32,903 [trainer.py] => batch_size: 48
2024-09-04 05:29:32,903 [trainer.py] => weight_decay: 0
2024-09-04 05:29:32,903 [trainer.py] => min_lr: 1e-05
2024-09-04 05:29:32,903 [trainer.py] => optimizer: adam
2024-09-04 05:29:32,903 [trainer.py] => scheduler: cosine
2024-09-04 05:29:32,903 [trainer.py] => reinit_optimizer: True
2024-09-04 05:29:32,903 [trainer.py] => pretrained: True
2024-09-04 05:29:32,903 [trainer.py] => drop: 0.0
2024-09-04 05:29:32,903 [trainer.py] => drop_path: 0.0
2024-09-04 05:29:32,903 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-09-04 05:29:34,004 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2024-09-04 05:29:36,014 [coda_prompt.py] => 89,715,556 total parameters.
2024-09-04 05:29:36,014 [coda_prompt.py] => 3,916,900 fc and prompt training parameters.
2024-09-04 05:29:36,014 [trainer.py] => All params: 89715556
2024-09-04 05:29:36,015 [trainer.py] => Trainable params: 89715556
2024-09-04 05:29:36,015 [coda_prompt.py] => Learning on 0-50

  0%|          | 0/20 [00:00<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.865, Train_accy 76.79:   0%|          | 0/20 [04:30<?, ?it/s]
Task 0, Epoch 1/20 => Loss 0.865, Train_accy 76.79:   5%|▌         | 1/20 [04:30<1:25:34, 270.22s/it]
Task 0, Epoch 2/20 => Loss 0.550, Train_accy 84.09:   5%|▌         | 1/20 [09:01<1:25:34, 270.22s/it]
Task 0, Epoch 2/20 => Loss 0.550, Train_accy 84.09:  10%|█         | 2/20 [09:01<1:21:10, 270.56s/it]
Task 0, Epoch 3/20 => Loss 0.508, Train_accy 85.48:  10%|█         | 2/20 [13:31<1:21:10, 270.56s/it]
Task 0, Epoch 3/20 => Loss 0.508, Train_accy 85.48:  15%|█▌        | 3/20 [13:31<1:16:40, 270.65s/it]
Task 0, Epoch 4/20 => Loss 0.480, Train_accy 86.37:  15%|█▌        | 3/20 [18:02<1:16:40, 270.65s/it]
Task 0, Epoch 4/20 => Loss 0.480, Train_accy 86.37:  20%|██        | 4/20 [18:02<1:12:10, 270.67s/it]
Task 0, Epoch 5/20 => Loss 0.454, Train_accy 86.94, Test_accy 94.80:  20%|██        | 4/20 [23:01<1:12:10, 270.67s/it]
Task 0, Epoch 5/20 => Loss 0.454, Train_accy 86.94, Test_accy 94.80:  25%|██▌       | 5/20 [23:01<1:10:15, 281.03s/it]
Task 0, Epoch 6/20 => Loss 0.447, Train_accy 87.20:  25%|██▌       | 5/20 [27:33<1:10:15, 281.03s/it]                 
Task 0, Epoch 6/20 => Loss 0.447, Train_accy 87.20:  30%|███       | 6/20 [27:33<1:04:47, 277.68s/it]
Task 0, Epoch 7/20 => Loss 0.424, Train_accy 87.57:  30%|███       | 6/20 [32:04<1:04:47, 277.68s/it]
Task 0, Epoch 7/20 => Loss 0.424, Train_accy 87.57:  35%|███▌      | 7/20 [32:04<59:44, 275.74s/it]  
Task 0, Epoch 8/20 => Loss 0.422, Train_accy 87.83:  35%|███▌      | 7/20 [36:35<59:44, 275.74s/it]
Task 0, Epoch 8/20 => Loss 0.422, Train_accy 87.83:  40%|████      | 8/20 [36:35<54:50, 274.25s/it]
Task 0, Epoch 9/20 => Loss 0.417, Train_accy 87.79:  40%|████      | 8/20 [41:06<54:50, 274.25s/it]
Task 0, Epoch 9/20 => Loss 0.417, Train_accy 87.79:  45%|████▌     | 9/20 [41:06<50:05, 273.27s/it]
Task 0, Epoch 10/20 => Loss 0.407, Train_accy 88.08, Test_accy 94.66:  45%|████▌     | 9/20 [46:06<50:05, 273.27s/it]
Task 0, Epoch 10/20 => Loss 0.407, Train_accy 88.08, Test_accy 94.66:  50%|█████     | 10/20 [46:06<46:53, 281.34s/it]
Task 0, Epoch 11/20 => Loss 0.402, Train_accy 88.33:  50%|█████     | 10/20 [50:38<46:53, 281.34s/it]                 
Task 0, Epoch 11/20 => Loss 0.402, Train_accy 88.33:  55%|█████▌    | 11/20 [50:38<41:45, 278.41s/it]
Task 0, Epoch 12/20 => Loss 0.380, Train_accy 88.88:  55%|█████▌    | 11/20 [55:09<41:45, 278.41s/it]
Task 0, Epoch 12/20 => Loss 0.380, Train_accy 88.88:  60%|██████    | 12/20 [55:09<36:49, 276.21s/it]
Task 0, Epoch 13/20 => Loss 0.381, Train_accy 89.03:  60%|██████    | 12/20 [59:40<36:49, 276.21s/it]
Task 0, Epoch 13/20 => Loss 0.381, Train_accy 89.03:  65%|██████▌   | 13/20 [59:40<32:02, 274.64s/it]
Task 0, Epoch 14/20 => Loss 0.373, Train_accy 89.00:  65%|██████▌   | 13/20 [1:04:11<32:02, 274.64s/it]
Task 0, Epoch 14/20 => Loss 0.373, Train_accy 89.00:  70%|███████   | 14/20 [1:04:11<27:20, 273.44s/it]
Task 0, Epoch 15/20 => Loss 0.363, Train_accy 89.49, Test_accy 94.86:  70%|███████   | 14/20 [1:09:10<27:20, 273.44s/it]
Task 0, Epoch 15/20 => Loss 0.363, Train_accy 89.49, Test_accy 94.86:  75%|███████▌  | 15/20 [1:09:10<23:26, 281.29s/it]
Task 0, Epoch 16/20 => Loss 0.368, Train_accy 89.08:  75%|███████▌  | 15/20 [1:13:41<23:26, 281.29s/it]                 
Task 0, Epoch 16/20 => Loss 0.368, Train_accy 89.08:  80%|████████  | 16/20 [1:13:41<18:33, 278.27s/it]
Task 0, Epoch 17/20 => Loss 0.352, Train_accy 89.66:  80%|████████  | 16/20 [1:18:13<18:33, 278.27s/it]
Task 0, Epoch 17/20 => Loss 0.352, Train_accy 89.66:  85%|████████▌ | 17/20 [1:18:13<13:49, 276.41s/it]
Task 0, Epoch 18/20 => Loss 0.340, Train_accy 89.93:  85%|████████▌ | 17/20 [1:22:45<13:49, 276.41s/it]
Task 0, Epoch 18/20 => Loss 0.340, Train_accy 89.93:  90%|█████████ | 18/20 [1:22:45<09:09, 274.97s/it]
Task 0, Epoch 19/20 => Loss 0.336, Train_accy 89.92:  90%|█████████ | 18/20 [1:27:17<09:09, 274.97s/it]
Task 0, Epoch 19/20 => Loss 0.336, Train_accy 89.92:  95%|█████████▌| 19/20 [1:27:17<04:33, 273.95s/it]
Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.36, Test_accy 94.82:  95%|█████████▌| 19/20 [1:32:16<04:33, 273.95s/it]
Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.36, Test_accy 94.82: 100%|██████████| 20/20 [1:32:16<00:00, 281.67s/it]
Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.36, Test_accy 94.82: 100%|██████████| 20/20 [1:32:16<00:00, 276.83s/it]
2024-09-04 07:01:53,216 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.325, Train_accy 90.36, Test_accy 94.82
2024-09-04 07:02:21,508 [trainer.py] => No NME accuracy.
2024-09-04 07:02:21,509 [trainer.py] => CNN: {'total': 94.82, '00-49': 94.82, 'old': 0, 'new': 94.82}
2024-09-04 07:02:21,509 [trainer.py] => CNN top1 curve: [94.82]
2024-09-04 07:02:21,509 [trainer.py] => CNN top5 curve: [99.42]

Average Accuracy (CNN): 94.82
2024-09-04 07:02:21,509 [trainer.py] => Average Accuracy (CNN): 94.82 

2024-09-04 07:02:21,510 [trainer.py] => All params: 89715556
2024-09-04 07:02:21,510 [trainer.py] => Trainable params: 89715556
2024-09-04 07:02:21,774 [coda_prompt.py] => Learning on 50-55

  0%|          | 0/20 [00:00<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.292, Train_accy 90.71:   0%|          | 0/20 [00:27<?, ?it/s]
Task 1, Epoch 1/20 => Loss 0.292, Train_accy 90.71:   5%|▌         | 1/20 [00:27<08:42, 27.48s/it]
Task 1, Epoch 2/20 => Loss 0.079, Train_accy 97.28:   5%|▌         | 1/20 [00:54<08:42, 27.48s/it]
Task 1, Epoch 2/20 => Loss 0.079, Train_accy 97.28:  10%|█         | 2/20 [00:54<08:14, 27.47s/it]
Task 1, Epoch 3/20 => Loss 0.077, Train_accy 97.40:  10%|█         | 2/20 [01:22<08:14, 27.47s/it]
Task 1, Epoch 3/20 => Loss 0.077, Train_accy 97.40:  15%|█▌        | 3/20 [01:22<07:46, 27.47s/it]
Task 1, Epoch 4/20 => Loss 0.066, Train_accy 97.84:  15%|█▌        | 3/20 [01:49<07:46, 27.47s/it]
Task 1, Epoch 4/20 => Loss 0.066, Train_accy 97.84:  20%|██        | 4/20 [01:49<07:19, 27.47s/it]
Task 1, Epoch 5/20 => Loss 0.058, Train_accy 98.28, Test_accy 88.55:  20%|██        | 4/20 [02:48<07:19, 27.47s/it]
Task 1, Epoch 5/20 => Loss 0.058, Train_accy 98.28, Test_accy 88.55:  25%|██▌       | 5/20 [02:48<09:40, 38.68s/it]
Task 1, Epoch 6/20 => Loss 0.055, Train_accy 98.24:  25%|██▌       | 5/20 [03:15<09:40, 38.68s/it]                 
Task 1, Epoch 6/20 => Loss 0.055, Train_accy 98.24:  30%|███       | 6/20 [03:15<08:07, 34.84s/it]
Task 1, Epoch 7/20 => Loss 0.056, Train_accy 98.00:  30%|███       | 6/20 [03:43<08:07, 34.84s/it]
Task 1, Epoch 7/20 => Loss 0.056, Train_accy 98.00:  35%|███▌      | 7/20 [03:43<07:01, 32.42s/it]
Task 1, Epoch 8/20 => Loss 0.058, Train_accy 98.16:  35%|███▌      | 7/20 [04:10<07:01, 32.42s/it]
Task 1, Epoch 8/20 => Loss 0.058, Train_accy 98.16:  40%|████      | 8/20 [04:10<06:10, 30.85s/it]
Task 1, Epoch 9/20 => Loss 0.057, Train_accy 98.12:  40%|████      | 8/20 [04:38<06:10, 30.85s/it]
Task 1, Epoch 9/20 => Loss 0.057, Train_accy 98.12:  45%|████▌     | 9/20 [04:38<05:27, 29.80s/it]
Task 1, Epoch 10/20 => Loss 0.052, Train_accy 98.24, Test_accy 89.16:  45%|████▌     | 9/20 [05:36<05:27, 29.80s/it]
Task 1, Epoch 10/20 => Loss 0.052, Train_accy 98.24, Test_accy 89.16:  50%|█████     | 10/20 [05:36<06:26, 38.64s/it]
Task 1, Epoch 11/20 => Loss 0.054, Train_accy 98.12:  50%|█████     | 10/20 [06:04<06:26, 38.64s/it]                 
Task 1, Epoch 11/20 => Loss 0.054, Train_accy 98.12:  55%|█████▌    | 11/20 [06:04<05:16, 35.22s/it]
Task 1, Epoch 12/20 => Loss 0.060, Train_accy 97.96:  55%|█████▌    | 11/20 [06:31<05:16, 35.22s/it]
Task 1, Epoch 12/20 => Loss 0.060, Train_accy 97.96:  60%|██████    | 12/20 [06:31<04:22, 32.85s/it]
Task 1, Epoch 13/20 => Loss 0.045, Train_accy 98.44:  60%|██████    | 12/20 [06:58<04:22, 32.85s/it]
Task 1, Epoch 13/20 => Loss 0.045, Train_accy 98.44:  65%|██████▌   | 13/20 [06:58<03:38, 31.20s/it]
Task 1, Epoch 14/20 => Loss 0.050, Train_accy 98.28:  65%|██████▌   | 13/20 [07:26<03:38, 31.20s/it]
Task 1, Epoch 14/20 => Loss 0.050, Train_accy 98.28:  70%|███████   | 14/20 [07:26<03:00, 30.06s/it]
Task 1, Epoch 15/20 => Loss 0.045, Train_accy 98.48, Test_accy 89.40:  70%|███████   | 14/20 [08:24<03:00, 30.06s/it]
Task 1, Epoch 15/20 => Loss 0.045, Train_accy 98.48, Test_accy 89.40:  75%|███████▌  | 15/20 [08:24<03:13, 38.61s/it]
Task 1, Epoch 16/20 => Loss 0.045, Train_accy 98.40:  75%|███████▌  | 15/20 [08:52<03:13, 38.61s/it]                 
Task 1, Epoch 16/20 => Loss 0.045, Train_accy 98.40:  80%|████████  | 16/20 [08:52<02:20, 35.25s/it]
Task 1, Epoch 17/20 => Loss 0.045, Train_accy 98.32:  80%|████████  | 16/20 [09:19<02:20, 35.25s/it]
Task 1, Epoch 17/20 => Loss 0.045, Train_accy 98.32:  85%|████████▌ | 17/20 [09:19<01:38, 32.89s/it]
Task 1, Epoch 18/20 => Loss 0.052, Train_accy 98.32:  85%|████████▌ | 17/20 [09:47<01:38, 32.89s/it]
Task 1, Epoch 18/20 => Loss 0.052, Train_accy 98.32:  90%|█████████ | 18/20 [09:47<01:02, 31.28s/it]
Task 1, Epoch 19/20 => Loss 0.050, Train_accy 98.28:  90%|█████████ | 18/20 [10:14<01:02, 31.28s/it]
Task 1, Epoch 19/20 => Loss 0.050, Train_accy 98.28:  95%|█████████▌| 19/20 [10:14<00:30, 30.11s/it]
Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.28, Test_accy 89.71:  95%|█████████▌| 19/20 [11:13<00:30, 30.11s/it]
Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.28, Test_accy 89.71: 100%|██████████| 20/20 [11:13<00:00, 38.61s/it]
Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.28, Test_accy 89.71: 100%|██████████| 20/20 [11:13<00:00, 33.65s/it]
2024-09-04 07:13:34,856 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.045, Train_accy 98.28, Test_accy 89.71
2024-09-04 07:14:05,898 [trainer.py] => No NME accuracy.
2024-09-04 07:14:05,899 [trainer.py] => CNN: {'total': 89.71, '00-49': 94.42, '50-54': 42.6, 'old': 94.42, 'new': 42.6}
2024-09-04 07:14:05,899 [trainer.py] => CNN top1 curve: [94.82, 89.71]
2024-09-04 07:14:05,899 [trainer.py] => CNN top5 curve: [99.42, 99.11]

Average Accuracy (CNN): 92.26
2024-09-04 07:14:05,899 [trainer.py] => Average Accuracy (CNN): 92.26 

2024-09-04 07:14:05,900 [trainer.py] => All params: 89715556
2024-09-04 07:14:05,901 [trainer.py] => Trainable params: 89715556
2024-09-04 07:14:06,317 [coda_prompt.py] => Learning on 55-60

  0%|          | 0/20 [00:00<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.544, Train_accy 80.49:   0%|          | 0/20 [00:27<?, ?it/s]
Task 2, Epoch 1/20 => Loss 0.544, Train_accy 80.49:   5%|▌         | 1/20 [00:27<08:42, 27.48s/it]
Task 2, Epoch 2/20 => Loss 0.222, Train_accy 91.55:   5%|▌         | 1/20 [00:55<08:42, 27.48s/it]
Task 2, Epoch 2/20 => Loss 0.222, Train_accy 91.55:  10%|█         | 2/20 [00:55<08:15, 27.51s/it]
Task 2, Epoch 3/20 => Loss 0.206, Train_accy 91.55:  10%|█         | 2/20 [01:22<08:15, 27.51s/it]
Task 2, Epoch 3/20 => Loss 0.206, Train_accy 91.55:  15%|█▌        | 3/20 [01:22<07:47, 27.51s/it]
Task 2, Epoch 4/20 => Loss 0.179, Train_accy 93.35:  15%|█▌        | 3/20 [01:50<07:47, 27.51s/it]
Task 2, Epoch 4/20 => Loss 0.179, Train_accy 93.35:  20%|██        | 4/20 [01:50<07:20, 27.50s/it]
Task 2, Epoch 5/20 => Loss 0.164, Train_accy 93.27, Test_accy 85.50:  20%|██        | 4/20 [02:51<07:20, 27.50s/it]
Task 2, Epoch 5/20 => Loss 0.164, Train_accy 93.27, Test_accy 85.50:  25%|██▌       | 5/20 [02:51<09:56, 39.76s/it]
Task 2, Epoch 6/20 => Loss 0.163, Train_accy 93.43:  25%|██▌       | 5/20 [03:19<09:56, 39.76s/it]                 
Task 2, Epoch 6/20 => Loss 0.163, Train_accy 93.43:  30%|███       | 6/20 [03:19<08:18, 35.59s/it]
Task 2, Epoch 7/20 => Loss 0.137, Train_accy 94.39:  30%|███       | 6/20 [03:46<08:18, 35.59s/it]
Task 2, Epoch 7/20 => Loss 0.137, Train_accy 94.39:  35%|███▌      | 7/20 [03:46<07:08, 32.93s/it]
Task 2, Epoch 8/20 => Loss 0.151, Train_accy 94.31:  35%|███▌      | 7/20 [04:13<07:08, 32.93s/it]
Task 2, Epoch 8/20 => Loss 0.151, Train_accy 94.31:  40%|████      | 8/20 [04:13<06:14, 31.19s/it]
Task 2, Epoch 9/20 => Loss 0.140, Train_accy 94.27:  40%|████      | 8/20 [04:41<06:14, 31.19s/it]
Task 2, Epoch 9/20 => Loss 0.140, Train_accy 94.27:  45%|████▌     | 9/20 [04:41<05:30, 30.06s/it]
Task 2, Epoch 10/20 => Loss 0.155, Train_accy 94.23, Test_accy 86.00:  45%|████▌     | 9/20 [05:42<05:30, 30.06s/it]
Task 2, Epoch 10/20 => Loss 0.155, Train_accy 94.23, Test_accy 86.00:  50%|█████     | 10/20 [05:42<06:37, 39.73s/it]
Task 2, Epoch 11/20 => Loss 0.146, Train_accy 93.95:  50%|█████     | 10/20 [06:10<06:37, 39.73s/it]                 
Task 2, Epoch 11/20 => Loss 0.146, Train_accy 93.95:  55%|█████▌    | 11/20 [06:10<05:23, 35.98s/it]
Task 2, Epoch 12/20 => Loss 0.139, Train_accy 94.91:  55%|█████▌    | 11/20 [06:37<05:23, 35.98s/it]
Task 2, Epoch 12/20 => Loss 0.139, Train_accy 94.91:  60%|██████    | 12/20 [06:37<04:27, 33.40s/it]
Task 2, Epoch 13/20 => Loss 0.136, Train_accy 94.63:  60%|██████    | 12/20 [07:05<04:27, 33.40s/it]
Task 2, Epoch 13/20 => Loss 0.136, Train_accy 94.63:  65%|██████▌   | 13/20 [07:05<03:41, 31.61s/it]
Task 2, Epoch 14/20 => Loss 0.134, Train_accy 94.95:  65%|██████▌   | 13/20 [07:32<03:41, 31.61s/it]
Task 2, Epoch 14/20 => Loss 0.134, Train_accy 94.95:  70%|███████   | 14/20 [07:32<03:02, 30.39s/it]
Task 2, Epoch 15/20 => Loss 0.142, Train_accy 93.91, Test_accy 86.10:  70%|███████   | 14/20 [08:34<03:02, 30.39s/it]
Task 2, Epoch 15/20 => Loss 0.142, Train_accy 93.91, Test_accy 86.10:  75%|███████▌  | 15/20 [08:34<03:18, 39.75s/it]
Task 2, Epoch 16/20 => Loss 0.114, Train_accy 95.47:  75%|███████▌  | 15/20 [09:01<03:18, 39.75s/it]                 
Task 2, Epoch 16/20 => Loss 0.114, Train_accy 95.47:  80%|████████  | 16/20 [09:01<02:24, 36.06s/it]
Task 2, Epoch 17/20 => Loss 0.145, Train_accy 94.43:  80%|████████  | 16/20 [09:29<02:24, 36.06s/it]
Task 2, Epoch 17/20 => Loss 0.145, Train_accy 94.43:  85%|████████▌ | 17/20 [09:29<01:40, 33.48s/it]
Task 2, Epoch 18/20 => Loss 0.117, Train_accy 95.75:  85%|████████▌ | 17/20 [09:56<01:40, 33.48s/it]
Task 2, Epoch 18/20 => Loss 0.117, Train_accy 95.75:  90%|█████████ | 18/20 [09:56<01:03, 31.69s/it]
Task 2, Epoch 19/20 => Loss 0.130, Train_accy 94.75:  90%|█████████ | 18/20 [10:24<01:03, 31.69s/it]
Task 2, Epoch 19/20 => Loss 0.130, Train_accy 94.75:  95%|█████████▌| 19/20 [10:24<00:30, 30.44s/it]
Task 2, Epoch 20/20 => Loss 0.130, Train_accy 95.11, Test_accy 86.13:  95%|█████████▌| 19/20 [11:25<00:30, 30.44s/it]
Task 2, Epoch 20/20 => Loss 0.130, Train_accy 95.11, Test_accy 86.13: 100%|██████████| 20/20 [11:25<00:00, 39.72s/it]
Task 2, Epoch 20/20 => Loss 0.130, Train_accy 95.11, Test_accy 86.13: 100%|██████████| 20/20 [11:25<00:00, 34.29s/it]
2024-09-04 07:25:32,045 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.130, Train_accy 95.11, Test_accy 86.13
2024-09-04 07:26:05,874 [trainer.py] => No NME accuracy.
2024-09-04 07:26:05,875 [trainer.py] => CNN: {'total': 86.13, '00-49': 93.9, '50-54': 41.0, '55-59': 53.6, 'old': 89.09, 'new': 53.6}
2024-09-04 07:26:05,875 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13]
2024-09-04 07:26:05,875 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08]

Average Accuracy (CNN): 90.22
2024-09-04 07:26:05,875 [trainer.py] => Average Accuracy (CNN): 90.22 

2024-09-04 07:26:05,876 [trainer.py] => All params: 89715556
2024-09-04 07:26:05,877 [trainer.py] => Trainable params: 89715556
2024-09-04 07:26:06,443 [coda_prompt.py] => Learning on 60-65

  0%|          | 0/20 [00:00<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.240, Train_accy 91.43:   0%|          | 0/20 [00:27<?, ?it/s]
Task 3, Epoch 1/20 => Loss 0.240, Train_accy 91.43:   5%|▌         | 1/20 [00:27<08:42, 27.50s/it]
Task 3, Epoch 2/20 => Loss 0.082, Train_accy 97.36:   5%|▌         | 1/20 [00:55<08:42, 27.50s/it]
Task 3, Epoch 2/20 => Loss 0.082, Train_accy 97.36:  10%|█         | 2/20 [00:55<08:15, 27.51s/it]
Task 3, Epoch 3/20 => Loss 0.066, Train_accy 97.80:  10%|█         | 2/20 [01:22<08:15, 27.51s/it]
Task 3, Epoch 3/20 => Loss 0.066, Train_accy 97.80:  15%|█▌        | 3/20 [01:22<07:47, 27.51s/it]
Task 3, Epoch 4/20 => Loss 0.070, Train_accy 97.52:  15%|█▌        | 3/20 [01:49<07:47, 27.51s/it]
Task 3, Epoch 4/20 => Loss 0.070, Train_accy 97.52:  20%|██        | 4/20 [01:49<07:19, 27.49s/it]
Task 3, Epoch 5/20 => Loss 0.054, Train_accy 98.08, Test_accy 81.45:  20%|██        | 4/20 [02:54<07:19, 27.49s/it]
Task 3, Epoch 5/20 => Loss 0.054, Train_accy 98.08, Test_accy 81.45:  25%|██▌       | 5/20 [02:54<10:10, 40.69s/it]
Task 3, Epoch 6/20 => Loss 0.059, Train_accy 97.92:  25%|██▌       | 5/20 [03:21<10:10, 40.69s/it]                 
Task 3, Epoch 6/20 => Loss 0.059, Train_accy 97.92:  30%|███       | 6/20 [03:21<08:26, 36.21s/it]
Task 3, Epoch 7/20 => Loss 0.048, Train_accy 98.24:  30%|███       | 6/20 [03:49<08:26, 36.21s/it]
Task 3, Epoch 7/20 => Loss 0.048, Train_accy 98.24:  35%|███▌      | 7/20 [03:49<07:13, 33.36s/it]
Task 3, Epoch 8/20 => Loss 0.044, Train_accy 98.56:  35%|███▌      | 7/20 [04:16<07:13, 33.36s/it]
Task 3, Epoch 8/20 => Loss 0.044, Train_accy 98.56:  40%|████      | 8/20 [04:16<06:17, 31.50s/it]
Task 3, Epoch 9/20 => Loss 0.051, Train_accy 98.28:  40%|████      | 8/20 [04:44<06:17, 31.50s/it]
Task 3, Epoch 9/20 => Loss 0.051, Train_accy 98.28:  45%|████▌     | 9/20 [04:44<05:32, 30.25s/it]
Task 3, Epoch 10/20 => Loss 0.058, Train_accy 98.00, Test_accy 82.54:  45%|████▌     | 9/20 [05:48<05:32, 30.25s/it]
Task 3, Epoch 10/20 => Loss 0.058, Train_accy 98.00, Test_accy 82.54:  50%|█████     | 10/20 [05:48<06:47, 40.78s/it]
Task 3, Epoch 11/20 => Loss 0.061, Train_accy 98.24:  50%|█████     | 10/20 [06:15<06:47, 40.78s/it]                 
Task 3, Epoch 11/20 => Loss 0.061, Train_accy 98.24:  55%|█████▌    | 11/20 [06:15<05:30, 36.70s/it]
Task 3, Epoch 12/20 => Loss 0.052, Train_accy 98.36:  55%|█████▌    | 11/20 [06:43<05:30, 36.70s/it]
Task 3, Epoch 12/20 => Loss 0.052, Train_accy 98.36:  60%|██████    | 12/20 [06:43<04:31, 33.90s/it]
Task 3, Epoch 13/20 => Loss 0.042, Train_accy 98.56:  60%|██████    | 12/20 [07:10<04:31, 33.90s/it]
Task 3, Epoch 13/20 => Loss 0.042, Train_accy 98.56:  65%|██████▌   | 13/20 [07:10<03:43, 31.97s/it]
Task 3, Epoch 14/20 => Loss 0.054, Train_accy 98.00:  65%|██████▌   | 13/20 [07:38<03:43, 31.97s/it]
Task 3, Epoch 14/20 => Loss 0.054, Train_accy 98.00:  70%|███████   | 14/20 [07:38<03:03, 30.61s/it]
Task 3, Epoch 15/20 => Loss 0.032, Train_accy 98.72, Test_accy 83.23:  70%|███████   | 14/20 [08:42<03:03, 30.61s/it]
Task 3, Epoch 15/20 => Loss 0.032, Train_accy 98.72, Test_accy 83.23:  75%|███████▌  | 15/20 [08:42<03:23, 40.71s/it]
Task 3, Epoch 16/20 => Loss 0.052, Train_accy 97.96:  75%|███████▌  | 15/20 [09:09<03:23, 40.71s/it]                 
Task 3, Epoch 16/20 => Loss 0.052, Train_accy 97.96:  80%|████████  | 16/20 [09:09<02:26, 36.73s/it]
Task 3, Epoch 17/20 => Loss 0.047, Train_accy 98.52:  80%|████████  | 16/20 [09:37<02:26, 36.73s/it]
Task 3, Epoch 17/20 => Loss 0.047, Train_accy 98.52:  85%|████████▌ | 17/20 [09:37<01:41, 33.94s/it]
Task 3, Epoch 18/20 => Loss 0.035, Train_accy 98.80:  85%|████████▌ | 17/20 [10:04<01:41, 33.94s/it]
Task 3, Epoch 18/20 => Loss 0.035, Train_accy 98.80:  90%|█████████ | 18/20 [10:04<01:03, 31.98s/it]
Task 3, Epoch 19/20 => Loss 0.049, Train_accy 98.24:  90%|█████████ | 18/20 [10:32<01:03, 31.98s/it]
Task 3, Epoch 19/20 => Loss 0.049, Train_accy 98.24:  95%|█████████▌| 19/20 [10:32<00:30, 30.65s/it]
Task 3, Epoch 20/20 => Loss 0.048, Train_accy 98.44, Test_accy 83.26:  95%|█████████▌| 19/20 [11:36<00:30, 30.65s/it]
Task 3, Epoch 20/20 => Loss 0.048, Train_accy 98.44, Test_accy 83.26: 100%|██████████| 20/20 [11:36<00:00, 40.61s/it]
Task 3, Epoch 20/20 => Loss 0.048, Train_accy 98.44, Test_accy 83.26: 100%|██████████| 20/20 [11:36<00:00, 34.81s/it]
2024-09-04 07:37:42,701 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.048, Train_accy 98.44, Test_accy 83.26
2024-09-04 07:38:19,158 [trainer.py] => No NME accuracy.
2024-09-04 07:38:19,158 [trainer.py] => CNN: {'total': 83.26, '00-49': 94.04, '50-54': 40.2, '55-59': 45.8, '60-64': 56.0, 'old': 85.53, 'new': 56.0}
2024-09-04 07:38:19,158 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26]
2024-09-04 07:38:19,158 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72]

Average Accuracy (CNN): 88.48
2024-09-04 07:38:19,159 [trainer.py] => Average Accuracy (CNN): 88.48 

2024-09-04 07:38:19,160 [trainer.py] => All params: 89715556
2024-09-04 07:38:19,161 [trainer.py] => Trainable params: 89715556
2024-09-04 07:38:19,887 [coda_prompt.py] => Learning on 65-70

  0%|          | 0/20 [00:00<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.308, Train_accy 89.58:   0%|          | 0/20 [00:27<?, ?it/s]
Task 4, Epoch 1/20 => Loss 0.308, Train_accy 89.58:   5%|▌         | 1/20 [00:27<08:41, 27.43s/it]
Task 4, Epoch 2/20 => Loss 0.049, Train_accy 98.32:   5%|▌         | 1/20 [00:54<08:41, 27.43s/it]
Task 4, Epoch 2/20 => Loss 0.049, Train_accy 98.32:  10%|█         | 2/20 [00:54<08:13, 27.44s/it]
Task 4, Epoch 3/20 => Loss 0.066, Train_accy 98.20:  10%|█         | 2/20 [01:22<08:13, 27.44s/it]
Task 4, Epoch 3/20 => Loss 0.066, Train_accy 98.20:  15%|█▌        | 3/20 [01:22<07:46, 27.43s/it]
Task 4, Epoch 4/20 => Loss 0.045, Train_accy 98.44:  15%|█▌        | 3/20 [01:49<07:46, 27.43s/it]
Task 4, Epoch 4/20 => Loss 0.045, Train_accy 98.44:  20%|██        | 4/20 [01:49<07:18, 27.41s/it]
Task 4, Epoch 5/20 => Loss 0.062, Train_accy 97.84, Test_accy 79.31:  20%|██        | 4/20 [02:56<07:18, 27.41s/it]
Task 4, Epoch 5/20 => Loss 0.062, Train_accy 97.84, Test_accy 79.31:  25%|██▌       | 5/20 [02:56<10:24, 41.61s/it]
Task 4, Epoch 6/20 => Loss 0.052, Train_accy 98.36:  25%|██▌       | 5/20 [03:23<10:24, 41.61s/it]                 
Task 4, Epoch 6/20 => Loss 0.052, Train_accy 98.36:  30%|███       | 6/20 [03:23<08:35, 36.81s/it]
Task 4, Epoch 7/20 => Loss 0.053, Train_accy 98.24:  30%|███       | 6/20 [03:51<08:35, 36.81s/it]
Task 4, Epoch 7/20 => Loss 0.053, Train_accy 98.24:  35%|███▌      | 7/20 [03:51<07:19, 33.78s/it]
Task 4, Epoch 8/20 => Loss 0.034, Train_accy 99.00:  35%|███▌      | 7/20 [04:18<07:19, 33.78s/it]
Task 4, Epoch 8/20 => Loss 0.034, Train_accy 99.00:  40%|████      | 8/20 [04:18<06:21, 31.78s/it]
Task 4, Epoch 9/20 => Loss 0.050, Train_accy 98.52:  40%|████      | 8/20 [04:46<06:21, 31.78s/it]
Task 4, Epoch 9/20 => Loss 0.050, Train_accy 98.52:  45%|████▌     | 9/20 [04:46<05:34, 30.44s/it]
Task 4, Epoch 10/20 => Loss 0.052, Train_accy 98.28, Test_accy 79.93:  45%|████▌     | 9/20 [05:53<05:34, 30.44s/it]
Task 4, Epoch 10/20 => Loss 0.052, Train_accy 98.28, Test_accy 79.93:  50%|█████     | 10/20 [05:53<06:56, 41.68s/it]
Task 4, Epoch 11/20 => Loss 0.033, Train_accy 98.88:  50%|█████     | 10/20 [06:20<06:56, 41.68s/it]                 
Task 4, Epoch 11/20 => Loss 0.033, Train_accy 98.88:  55%|█████▌    | 11/20 [06:20<05:36, 37.35s/it]
Task 4, Epoch 12/20 => Loss 0.045, Train_accy 98.36:  55%|█████▌    | 11/20 [06:48<05:36, 37.35s/it]
Task 4, Epoch 12/20 => Loss 0.045, Train_accy 98.36:  60%|██████    | 12/20 [06:48<04:34, 34.37s/it]
Task 4, Epoch 13/20 => Loss 0.034, Train_accy 98.72:  60%|██████    | 12/20 [07:15<04:34, 34.37s/it]
Task 4, Epoch 13/20 => Loss 0.034, Train_accy 98.72:  65%|██████▌   | 13/20 [07:15<03:46, 32.29s/it]
Task 4, Epoch 14/20 => Loss 0.037, Train_accy 98.80:  65%|██████▌   | 13/20 [07:43<03:46, 32.29s/it]
Task 4, Epoch 14/20 => Loss 0.037, Train_accy 98.80:  70%|███████   | 14/20 [07:43<03:05, 30.85s/it]
Task 4, Epoch 15/20 => Loss 0.044, Train_accy 98.56, Test_accy 80.26:  70%|███████   | 14/20 [08:50<03:05, 30.85s/it]
Task 4, Epoch 15/20 => Loss 0.044, Train_accy 98.56, Test_accy 80.26:  75%|███████▌  | 15/20 [08:50<03:28, 41.69s/it]
Task 4, Epoch 16/20 => Loss 0.032, Train_accy 98.92:  75%|███████▌  | 15/20 [09:17<03:28, 41.69s/it]                 
Task 4, Epoch 16/20 => Loss 0.032, Train_accy 98.92:  80%|████████  | 16/20 [09:17<02:29, 37.41s/it]
Task 4, Epoch 17/20 => Loss 0.030, Train_accy 98.80:  80%|████████  | 16/20 [09:45<02:29, 37.41s/it]
Task 4, Epoch 17/20 => Loss 0.030, Train_accy 98.80:  85%|████████▌ | 17/20 [09:45<01:43, 34.42s/it]
Task 4, Epoch 18/20 => Loss 0.042, Train_accy 98.40:  85%|████████▌ | 17/20 [10:12<01:43, 34.42s/it]
Task 4, Epoch 18/20 => Loss 0.042, Train_accy 98.40:  90%|█████████ | 18/20 [10:12<01:04, 32.34s/it]
Task 4, Epoch 19/20 => Loss 0.032, Train_accy 99.04:  90%|█████████ | 18/20 [10:40<01:04, 32.34s/it]
Task 4, Epoch 19/20 => Loss 0.032, Train_accy 99.04:  95%|█████████▌| 19/20 [10:40<00:30, 30.87s/it]
Task 4, Epoch 20/20 => Loss 0.040, Train_accy 98.64, Test_accy 80.39:  95%|█████████▌| 19/20 [11:47<00:30, 30.87s/it]
Task 4, Epoch 20/20 => Loss 0.040, Train_accy 98.64, Test_accy 80.39: 100%|██████████| 20/20 [11:47<00:00, 41.72s/it]
Task 4, Epoch 20/20 => Loss 0.040, Train_accy 98.64, Test_accy 80.39: 100%|██████████| 20/20 [11:47<00:00, 35.36s/it]
2024-09-04 07:50:07,077 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.040, Train_accy 98.64, Test_accy 80.39
2024-09-04 07:50:46,480 [trainer.py] => No NME accuracy.
2024-09-04 07:50:46,480 [trainer.py] => CNN: {'total': 80.39, '00-49': 94.08, '50-54': 42.0, '55-59': 45.8, '60-64': 55.2, '65-69': 41.6, 'old': 83.37, 'new': 41.6}
2024-09-04 07:50:46,480 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39]
2024-09-04 07:50:46,480 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51]

Average Accuracy (CNN): 86.86
2024-09-04 07:50:46,481 [trainer.py] => Average Accuracy (CNN): 86.86 

2024-09-04 07:50:46,482 [trainer.py] => All params: 89715556
2024-09-04 07:50:46,483 [trainer.py] => Trainable params: 89715556
2024-09-04 07:50:47,367 [coda_prompt.py] => Learning on 70-75

  0%|          | 0/20 [00:00<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.331, Train_accy 88.46:   0%|          | 0/20 [00:27<?, ?it/s]
Task 5, Epoch 1/20 => Loss 0.331, Train_accy 88.46:   5%|▌         | 1/20 [00:27<08:43, 27.53s/it]
Task 5, Epoch 2/20 => Loss 0.096, Train_accy 96.79:   5%|▌         | 1/20 [00:55<08:43, 27.53s/it]
Task 5, Epoch 2/20 => Loss 0.096, Train_accy 96.79:  10%|█         | 2/20 [00:55<08:15, 27.53s/it]
Task 5, Epoch 3/20 => Loss 0.086, Train_accy 96.92:  10%|█         | 2/20 [01:22<08:15, 27.53s/it]
Task 5, Epoch 3/20 => Loss 0.086, Train_accy 96.92:  15%|█▌        | 3/20 [01:22<07:48, 27.54s/it]
Task 5, Epoch 4/20 => Loss 0.073, Train_accy 97.40:  15%|█▌        | 3/20 [01:50<07:48, 27.54s/it]
Task 5, Epoch 4/20 => Loss 0.073, Train_accy 97.40:  20%|██        | 4/20 [01:50<07:20, 27.53s/it]
Task 5, Epoch 5/20 => Loss 0.064, Train_accy 98.00, Test_accy 75.81:  20%|██        | 4/20 [03:00<07:20, 27.53s/it]
Task 5, Epoch 5/20 => Loss 0.064, Train_accy 98.00, Test_accy 75.81:  25%|██▌       | 5/20 [03:00<10:42, 42.81s/it]
Task 5, Epoch 6/20 => Loss 0.058, Train_accy 98.16:  25%|██▌       | 5/20 [03:27<10:42, 42.81s/it]                 
Task 5, Epoch 6/20 => Loss 0.058, Train_accy 98.16:  30%|███       | 6/20 [03:27<08:46, 37.62s/it]
Task 5, Epoch 7/20 => Loss 0.059, Train_accy 98.04:  30%|███       | 6/20 [03:55<08:46, 37.62s/it]
Task 5, Epoch 7/20 => Loss 0.059, Train_accy 98.04:  35%|███▌      | 7/20 [03:55<07:26, 34.33s/it]
Task 5, Epoch 8/20 => Loss 0.066, Train_accy 97.60:  35%|███▌      | 7/20 [04:22<07:26, 34.33s/it]
Task 5, Epoch 8/20 => Loss 0.066, Train_accy 97.60:  40%|████      | 8/20 [04:22<06:25, 32.16s/it]
Task 5, Epoch 9/20 => Loss 0.050, Train_accy 98.20:  40%|████      | 8/20 [04:50<06:25, 32.16s/it]
Task 5, Epoch 9/20 => Loss 0.050, Train_accy 98.20:  45%|████▌     | 9/20 [04:50<05:37, 30.69s/it]
Task 5, Epoch 10/20 => Loss 0.068, Train_accy 97.88, Test_accy 76.72:  45%|████▌     | 9/20 [05:59<05:37, 30.69s/it]
Task 5, Epoch 10/20 => Loss 0.068, Train_accy 97.88, Test_accy 76.72:  50%|█████     | 10/20 [05:59<07:07, 42.75s/it]
Task 5, Epoch 11/20 => Loss 0.051, Train_accy 98.20:  50%|█████     | 10/20 [06:27<07:07, 42.75s/it]                 
Task 5, Epoch 11/20 => Loss 0.051, Train_accy 98.20:  55%|█████▌    | 11/20 [06:27<05:42, 38.09s/it]
Task 5, Epoch 12/20 => Loss 0.060, Train_accy 97.92:  55%|█████▌    | 11/20 [06:54<05:42, 38.09s/it]
Task 5, Epoch 12/20 => Loss 0.060, Train_accy 97.92:  60%|██████    | 12/20 [06:54<04:38, 34.86s/it]
Task 5, Epoch 13/20 => Loss 0.067, Train_accy 97.76:  60%|██████    | 12/20 [07:22<04:38, 34.86s/it]
Task 5, Epoch 13/20 => Loss 0.067, Train_accy 97.76:  65%|██████▌   | 13/20 [07:22<03:48, 32.63s/it]
Task 5, Epoch 14/20 => Loss 0.051, Train_accy 98.20:  65%|██████▌   | 13/20 [07:49<03:48, 32.63s/it]
Task 5, Epoch 14/20 => Loss 0.051, Train_accy 98.20:  70%|███████   | 14/20 [07:49<03:06, 31.09s/it]
Task 5, Epoch 15/20 => Loss 0.047, Train_accy 98.36, Test_accy 76.85:  70%|███████   | 14/20 [08:59<03:06, 31.09s/it]
Task 5, Epoch 15/20 => Loss 0.047, Train_accy 98.36, Test_accy 76.85:  75%|███████▌  | 15/20 [08:59<03:33, 42.73s/it]
Task 5, Epoch 16/20 => Loss 0.047, Train_accy 98.44:  75%|███████▌  | 15/20 [09:27<03:33, 42.73s/it]                 
Task 5, Epoch 16/20 => Loss 0.047, Train_accy 98.44:  80%|████████  | 16/20 [09:27<02:32, 38.15s/it]
Task 5, Epoch 17/20 => Loss 0.058, Train_accy 98.20:  80%|████████  | 16/20 [09:54<02:32, 38.15s/it]
Task 5, Epoch 17/20 => Loss 0.058, Train_accy 98.20:  85%|████████▌ | 17/20 [09:54<01:44, 34.94s/it]
Task 5, Epoch 18/20 => Loss 0.056, Train_accy 98.08:  85%|████████▌ | 17/20 [10:22<01:44, 34.94s/it]
Task 5, Epoch 18/20 => Loss 0.056, Train_accy 98.08:  90%|█████████ | 18/20 [10:22<01:05, 32.72s/it]
Task 5, Epoch 19/20 => Loss 0.044, Train_accy 98.44:  90%|█████████ | 18/20 [10:49<01:05, 32.72s/it]
Task 5, Epoch 19/20 => Loss 0.044, Train_accy 98.44:  95%|█████████▌| 19/20 [10:49<00:31, 31.16s/it]
Task 5, Epoch 20/20 => Loss 0.048, Train_accy 98.12, Test_accy 76.84:  95%|█████████▌| 19/20 [11:59<00:31, 31.16s/it]
Task 5, Epoch 20/20 => Loss 0.048, Train_accy 98.12, Test_accy 76.84: 100%|██████████| 20/20 [11:59<00:00, 42.70s/it]
Task 5, Epoch 20/20 => Loss 0.048, Train_accy 98.12, Test_accy 76.84: 100%|██████████| 20/20 [11:59<00:00, 35.96s/it]
2024-09-04 08:02:46,643 [coda_prompt.py] => Task 5, Epoch 20/20 => Loss 0.048, Train_accy 98.12, Test_accy 76.84
2024-09-04 08:03:28,768 [trainer.py] => No NME accuracy.
2024-09-04 08:03:28,769 [trainer.py] => CNN: {'total': 76.84, '00-49': 93.96, '50-54': 42.8, '55-59': 43.0, '60-64': 52.6, '65-69': 39.4, '70-74': 35.2, 'old': 79.81, 'new': 35.2}
2024-09-04 08:03:28,769 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84]
2024-09-04 08:03:28,769 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72]

Average Accuracy (CNN): 85.19
2024-09-04 08:03:28,769 [trainer.py] => Average Accuracy (CNN): 85.19 

2024-09-04 08:03:28,771 [trainer.py] => All params: 89715556
2024-09-04 08:03:28,772 [trainer.py] => Trainable params: 89715556
2024-09-04 08:03:29,818 [coda_prompt.py] => Learning on 75-80

  0%|          | 0/20 [00:00<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.326, Train_accy 88.98:   0%|          | 0/20 [00:27<?, ?it/s]
Task 6, Epoch 1/20 => Loss 0.326, Train_accy 88.98:   5%|▌         | 1/20 [00:27<08:43, 27.55s/it]
Task 6, Epoch 2/20 => Loss 0.088, Train_accy 96.59:   5%|▌         | 1/20 [00:55<08:43, 27.55s/it]
Task 6, Epoch 2/20 => Loss 0.088, Train_accy 96.59:  10%|█         | 2/20 [00:55<08:15, 27.55s/it]
Task 6, Epoch 3/20 => Loss 0.069, Train_accy 97.88:  10%|█         | 2/20 [01:22<08:15, 27.55s/it]
Task 6, Epoch 3/20 => Loss 0.069, Train_accy 97.88:  15%|█▌        | 3/20 [01:22<07:48, 27.56s/it]
Task 6, Epoch 4/20 => Loss 0.069, Train_accy 97.64:  15%|█▌        | 3/20 [01:50<07:48, 27.56s/it]
Task 6, Epoch 4/20 => Loss 0.069, Train_accy 97.64:  20%|██        | 4/20 [01:50<07:21, 27.60s/it]
Task 6, Epoch 5/20 => Loss 0.073, Train_accy 97.68, Test_accy 73.35:  20%|██        | 4/20 [03:02<07:21, 27.60s/it]
Task 6, Epoch 5/20 => Loss 0.073, Train_accy 97.68, Test_accy 73.35:  25%|██▌       | 5/20 [03:02<10:56, 43.78s/it]
Task 6, Epoch 6/20 => Loss 0.058, Train_accy 98.00:  25%|██▌       | 5/20 [03:30<10:56, 43.78s/it]                 
Task 6, Epoch 6/20 => Loss 0.058, Train_accy 98.00:  30%|███       | 6/20 [03:30<08:55, 38.26s/it]
Task 6, Epoch 7/20 => Loss 0.072, Train_accy 97.68:  30%|███       | 6/20 [03:57<08:55, 38.26s/it]
Task 6, Epoch 7/20 => Loss 0.072, Train_accy 97.68:  35%|███▌      | 7/20 [03:57<07:31, 34.74s/it]
Task 6, Epoch 8/20 => Loss 0.053, Train_accy 98.20:  35%|███▌      | 7/20 [04:25<07:31, 34.74s/it]
Task 6, Epoch 8/20 => Loss 0.053, Train_accy 98.20:  40%|████      | 8/20 [04:25<06:29, 32.44s/it]
Task 6, Epoch 9/20 => Loss 0.072, Train_accy 97.80:  40%|████      | 8/20 [04:52<06:29, 32.44s/it]
Task 6, Epoch 9/20 => Loss 0.072, Train_accy 97.80:  45%|████▌     | 9/20 [04:52<05:39, 30.90s/it]
Task 6, Epoch 10/20 => Loss 0.053, Train_accy 98.28, Test_accy 73.99:  45%|████▌     | 9/20 [06:05<05:39, 30.90s/it]
Task 6, Epoch 10/20 => Loss 0.053, Train_accy 98.28, Test_accy 73.99:  50%|█████     | 10/20 [06:05<07:17, 43.73s/it]
Task 6, Epoch 11/20 => Loss 0.056, Train_accy 98.24:  50%|█████     | 10/20 [06:32<07:17, 43.73s/it]                 
Task 6, Epoch 11/20 => Loss 0.056, Train_accy 98.24:  55%|█████▌    | 11/20 [06:32<05:48, 38.76s/it]
Task 6, Epoch 12/20 => Loss 0.060, Train_accy 98.16:  55%|█████▌    | 11/20 [07:00<05:48, 38.76s/it]
Task 6, Epoch 12/20 => Loss 0.060, Train_accy 98.16:  60%|██████    | 12/20 [07:00<04:42, 35.35s/it]
Task 6, Epoch 13/20 => Loss 0.049, Train_accy 98.36:  60%|██████    | 12/20 [07:27<04:42, 35.35s/it]
Task 6, Epoch 13/20 => Loss 0.049, Train_accy 98.36:  65%|██████▌   | 13/20 [07:27<03:50, 32.98s/it]
Task 6, Epoch 14/20 => Loss 0.062, Train_accy 98.04:  65%|██████▌   | 13/20 [07:55<03:50, 32.98s/it]
Task 6, Epoch 14/20 => Loss 0.062, Train_accy 98.04:  70%|███████   | 14/20 [07:55<03:07, 31.33s/it]
Task 6, Epoch 15/20 => Loss 0.056, Train_accy 98.28, Test_accy 74.15:  70%|███████   | 14/20 [09:07<03:07, 31.33s/it]
Task 6, Epoch 15/20 => Loss 0.056, Train_accy 98.28, Test_accy 74.15:  75%|███████▌  | 15/20 [09:07<03:38, 43.73s/it]
Task 6, Epoch 16/20 => Loss 0.056, Train_accy 98.12:  75%|███████▌  | 15/20 [09:35<03:38, 43.73s/it]                 
Task 6, Epoch 16/20 => Loss 0.056, Train_accy 98.12:  80%|████████  | 16/20 [09:35<02:35, 38.83s/it]
Task 6, Epoch 17/20 => Loss 0.043, Train_accy 98.60:  80%|████████  | 16/20 [10:02<02:35, 38.83s/it]
Task 6, Epoch 17/20 => Loss 0.043, Train_accy 98.60:  85%|████████▌ | 17/20 [10:02<01:46, 35.42s/it]
Task 6, Epoch 18/20 => Loss 0.046, Train_accy 98.32:  85%|████████▌ | 17/20 [10:30<01:46, 35.42s/it]
Task 6, Epoch 18/20 => Loss 0.046, Train_accy 98.32:  90%|█████████ | 18/20 [10:30<01:06, 33.03s/it]
Task 6, Epoch 19/20 => Loss 0.064, Train_accy 97.72:  90%|█████████ | 18/20 [10:57<01:06, 33.03s/it]
Task 6, Epoch 19/20 => Loss 0.064, Train_accy 97.72:  95%|█████████▌| 19/20 [10:57<00:31, 31.37s/it]
Task 6, Epoch 20/20 => Loss 0.047, Train_accy 98.44, Test_accy 74.08:  95%|█████████▌| 19/20 [12:10<00:31, 31.37s/it]
Task 6, Epoch 20/20 => Loss 0.047, Train_accy 98.44, Test_accy 74.08: 100%|██████████| 20/20 [12:10<00:00, 43.66s/it]
Task 6, Epoch 20/20 => Loss 0.047, Train_accy 98.44, Test_accy 74.08: 100%|██████████| 20/20 [12:10<00:00, 36.50s/it]
2024-09-04 08:15:39,915 [coda_prompt.py] => Task 6, Epoch 20/20 => Loss 0.047, Train_accy 98.44, Test_accy 74.08
2024-09-04 08:16:24,859 [trainer.py] => No NME accuracy.
2024-09-04 08:16:24,860 [trainer.py] => CNN: {'total': 74.08, '00-49': 94.16, '50-54': 42.4, '55-59': 44.2, '60-64': 52.4, '65-69': 42.8, '70-74': 36.6, '75-79': 25.2, 'old': 77.33, 'new': 25.2}
2024-09-04 08:16:24,860 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08]
2024-09-04 08:16:24,860 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39]

Average Accuracy (CNN): 83.6
2024-09-04 08:16:24,860 [trainer.py] => Average Accuracy (CNN): 83.6 

2024-09-04 08:16:24,861 [trainer.py] => All params: 89715556
2024-09-04 08:16:24,862 [trainer.py] => Trainable params: 89715556
2024-09-04 08:16:26,068 [coda_prompt.py] => Learning on 80-85

  0%|          | 0/20 [00:00<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.321, Train_accy 89.86:   0%|          | 0/20 [00:27<?, ?it/s]
Task 7, Epoch 1/20 => Loss 0.321, Train_accy 89.86:   5%|▌         | 1/20 [00:27<08:42, 27.51s/it]
Task 7, Epoch 2/20 => Loss 0.055, Train_accy 98.36:   5%|▌         | 1/20 [00:55<08:42, 27.51s/it]
Task 7, Epoch 2/20 => Loss 0.055, Train_accy 98.36:  10%|█         | 2/20 [00:55<08:15, 27.52s/it]
Task 7, Epoch 3/20 => Loss 0.057, Train_accy 98.24:  10%|█         | 2/20 [01:22<08:15, 27.52s/it]
Task 7, Epoch 3/20 => Loss 0.057, Train_accy 98.24:  15%|█▌        | 3/20 [01:22<07:48, 27.54s/it]
Task 7, Epoch 4/20 => Loss 0.044, Train_accy 98.76:  15%|█▌        | 3/20 [01:50<07:48, 27.54s/it]
Task 7, Epoch 4/20 => Loss 0.044, Train_accy 98.76:  20%|██        | 4/20 [01:50<07:20, 27.52s/it]
Task 7, Epoch 5/20 => Loss 0.049, Train_accy 98.32, Test_accy 70.12:  20%|██        | 4/20 [03:05<07:20, 27.52s/it]
Task 7, Epoch 5/20 => Loss 0.049, Train_accy 98.32, Test_accy 70.12:  25%|██▌       | 5/20 [03:05<11:11, 44.74s/it]
Task 7, Epoch 6/20 => Loss 0.042, Train_accy 98.72:  25%|██▌       | 5/20 [03:32<11:11, 44.74s/it]                 
Task 7, Epoch 6/20 => Loss 0.042, Train_accy 98.72:  30%|███       | 6/20 [03:32<09:04, 38.88s/it]
Task 7, Epoch 7/20 => Loss 0.038, Train_accy 98.80:  30%|███       | 6/20 [04:00<09:04, 38.88s/it]
Task 7, Epoch 7/20 => Loss 0.038, Train_accy 98.80:  35%|███▌      | 7/20 [04:00<07:37, 35.16s/it]
Task 7, Epoch 8/20 => Loss 0.037, Train_accy 98.88:  35%|███▌      | 7/20 [04:27<07:37, 35.16s/it]
Task 7, Epoch 8/20 => Loss 0.037, Train_accy 98.88:  40%|████      | 8/20 [04:27<06:33, 32.75s/it]
Task 7, Epoch 9/20 => Loss 0.047, Train_accy 98.48:  40%|████      | 8/20 [04:55<06:33, 32.75s/it]
Task 7, Epoch 9/20 => Loss 0.047, Train_accy 98.48:  45%|████▌     | 9/20 [04:55<05:42, 31.13s/it]
Task 7, Epoch 10/20 => Loss 0.039, Train_accy 98.52, Test_accy 70.24:  45%|████▌     | 9/20 [06:10<05:42, 31.13s/it]
Task 7, Epoch 10/20 => Loss 0.039, Train_accy 98.52, Test_accy 70.24:  50%|█████     | 10/20 [06:10<07:27, 44.76s/it]
Task 7, Epoch 11/20 => Loss 0.045, Train_accy 98.52:  50%|█████     | 10/20 [06:38<07:27, 44.76s/it]                 
Task 7, Epoch 11/20 => Loss 0.045, Train_accy 98.52:  55%|█████▌    | 11/20 [06:38<05:55, 39.48s/it]
Task 7, Epoch 12/20 => Loss 0.038, Train_accy 98.84:  55%|█████▌    | 11/20 [07:05<05:55, 39.48s/it]
Task 7, Epoch 12/20 => Loss 0.038, Train_accy 98.84:  60%|██████    | 12/20 [07:05<04:46, 35.84s/it]
Task 7, Epoch 13/20 => Loss 0.032, Train_accy 98.80:  60%|██████    | 12/20 [07:33<04:46, 35.84s/it]
Task 7, Epoch 13/20 => Loss 0.032, Train_accy 98.80:  65%|██████▌   | 13/20 [07:33<03:53, 33.33s/it]
Task 7, Epoch 14/20 => Loss 0.039, Train_accy 98.60:  65%|██████▌   | 13/20 [08:00<03:53, 33.33s/it]
Task 7, Epoch 14/20 => Loss 0.039, Train_accy 98.60:  70%|███████   | 14/20 [08:00<03:09, 31.58s/it]
Task 7, Epoch 15/20 => Loss 0.044, Train_accy 98.48, Test_accy 70.29:  70%|███████   | 14/20 [09:16<03:09, 31.58s/it]
Task 7, Epoch 15/20 => Loss 0.044, Train_accy 98.48, Test_accy 70.29:  75%|███████▌  | 15/20 [09:16<03:44, 44.83s/it]
Task 7, Epoch 16/20 => Loss 0.031, Train_accy 98.84:  75%|███████▌  | 15/20 [09:44<03:44, 44.83s/it]                 
Task 7, Epoch 16/20 => Loss 0.031, Train_accy 98.84:  80%|████████  | 16/20 [09:44<02:38, 39.64s/it]
Task 7, Epoch 17/20 => Loss 0.034, Train_accy 98.60:  80%|████████  | 16/20 [10:11<02:38, 39.64s/it]
Task 7, Epoch 17/20 => Loss 0.034, Train_accy 98.60:  85%|████████▌ | 17/20 [10:11<01:48, 36.02s/it]
Task 7, Epoch 18/20 => Loss 0.043, Train_accy 98.72:  85%|████████▌ | 17/20 [10:39<01:48, 36.02s/it]
Task 7, Epoch 18/20 => Loss 0.043, Train_accy 98.72:  90%|█████████ | 18/20 [10:39<01:06, 33.46s/it]
Task 7, Epoch 19/20 => Loss 0.028, Train_accy 99.04:  90%|█████████ | 18/20 [11:06<01:06, 33.46s/it]
Task 7, Epoch 19/20 => Loss 0.028, Train_accy 99.04:  95%|█████████▌| 19/20 [11:06<00:31, 31.68s/it]
Task 7, Epoch 20/20 => Loss 0.046, Train_accy 98.36, Test_accy 70.31:  95%|█████████▌| 19/20 [12:22<00:31, 31.68s/it]
Task 7, Epoch 20/20 => Loss 0.046, Train_accy 98.36, Test_accy 70.31: 100%|██████████| 20/20 [12:22<00:00, 44.81s/it]
Task 7, Epoch 20/20 => Loss 0.046, Train_accy 98.36, Test_accy 70.31: 100%|██████████| 20/20 [12:22<00:00, 37.11s/it]
2024-09-04 08:28:48,199 [coda_prompt.py] => Task 7, Epoch 20/20 => Loss 0.046, Train_accy 98.36, Test_accy 70.31
2024-09-04 08:29:35,910 [trainer.py] => No NME accuracy.
2024-09-04 08:29:35,911 [trainer.py] => CNN: {'total': 70.31, '00-49': 94.3, '50-54': 42.4, '55-59': 43.0, '60-64': 51.6, '65-69': 38.2, '70-74': 34.2, '75-79': 24.8, '80-84': 18.0, 'old': 73.58, 'new': 18.0}
2024-09-04 08:29:35,911 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08, 70.31]
2024-09-04 08:29:35,911 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39, 95.8]

Average Accuracy (CNN): 81.94
2024-09-04 08:29:35,912 [trainer.py] => Average Accuracy (CNN): 81.94 

2024-09-04 08:29:35,913 [trainer.py] => All params: 89715556
2024-09-04 08:29:35,915 [trainer.py] => Trainable params: 89715556
2024-09-04 08:29:37,265 [coda_prompt.py] => Learning on 85-90

  0%|          | 0/20 [00:00<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.423, Train_accy 84.70:   0%|          | 0/20 [00:27<?, ?it/s]
Task 8, Epoch 1/20 => Loss 0.423, Train_accy 84.70:   5%|▌         | 1/20 [00:27<08:42, 27.52s/it]
Task 8, Epoch 2/20 => Loss 0.174, Train_accy 93.39:   5%|▌         | 1/20 [00:55<08:42, 27.52s/it]
Task 8, Epoch 2/20 => Loss 0.174, Train_accy 93.39:  10%|█         | 2/20 [00:55<08:15, 27.52s/it]
Task 8, Epoch 3/20 => Loss 0.160, Train_accy 93.83:  10%|█         | 2/20 [01:22<08:15, 27.52s/it]
Task 8, Epoch 3/20 => Loss 0.160, Train_accy 93.83:  15%|█▌        | 3/20 [01:22<07:47, 27.52s/it]
Task 8, Epoch 4/20 => Loss 0.153, Train_accy 93.95:  15%|█▌        | 3/20 [01:50<07:47, 27.52s/it]
Task 8, Epoch 4/20 => Loss 0.153, Train_accy 93.95:  20%|██        | 4/20 [01:50<07:20, 27.55s/it]
Task 8, Epoch 5/20 => Loss 0.135, Train_accy 94.91, Test_accy 68.54:  20%|██        | 4/20 [03:08<07:20, 27.55s/it]
Task 8, Epoch 5/20 => Loss 0.135, Train_accy 94.91, Test_accy 68.54:  25%|██▌       | 5/20 [03:08<11:25, 45.73s/it]
Task 8, Epoch 6/20 => Loss 0.114, Train_accy 95.43:  25%|██▌       | 5/20 [03:35<11:25, 45.73s/it]                 
Task 8, Epoch 6/20 => Loss 0.114, Train_accy 95.43:  30%|███       | 6/20 [03:35<09:13, 39.56s/it]
Task 8, Epoch 7/20 => Loss 0.146, Train_accy 94.31:  30%|███       | 6/20 [04:03<09:13, 39.56s/it]
Task 8, Epoch 7/20 => Loss 0.146, Train_accy 94.31:  35%|███▌      | 7/20 [04:03<07:43, 35.65s/it]
Task 8, Epoch 8/20 => Loss 0.124, Train_accy 95.31:  35%|███▌      | 7/20 [04:30<07:43, 35.65s/it]
Task 8, Epoch 8/20 => Loss 0.124, Train_accy 95.31:  40%|████      | 8/20 [04:30<06:36, 33.08s/it]
Task 8, Epoch 9/20 => Loss 0.132, Train_accy 95.19:  40%|████      | 8/20 [04:58<06:36, 33.08s/it]
Task 8, Epoch 9/20 => Loss 0.132, Train_accy 95.19:  45%|████▌     | 9/20 [04:58<05:44, 31.36s/it]
Task 8, Epoch 10/20 => Loss 0.113, Train_accy 95.83, Test_accy 68.34:  45%|████▌     | 9/20 [06:16<05:44, 31.36s/it]
Task 8, Epoch 10/20 => Loss 0.113, Train_accy 95.83, Test_accy 68.34:  50%|█████     | 10/20 [06:16<07:38, 45.83s/it]
Task 8, Epoch 11/20 => Loss 0.116, Train_accy 95.59:  50%|█████     | 10/20 [06:44<07:38, 45.83s/it]                 
Task 8, Epoch 11/20 => Loss 0.116, Train_accy 95.59:  55%|█████▌    | 11/20 [06:44<06:02, 40.26s/it]
Task 8, Epoch 12/20 => Loss 0.131, Train_accy 95.07:  55%|█████▌    | 11/20 [07:11<06:02, 40.26s/it]
Task 8, Epoch 12/20 => Loss 0.131, Train_accy 95.07:  60%|██████    | 12/20 [07:11<04:51, 36.39s/it]
Task 8, Epoch 13/20 => Loss 0.117, Train_accy 95.71:  60%|██████    | 12/20 [07:39<04:51, 36.39s/it]
Task 8, Epoch 13/20 => Loss 0.117, Train_accy 95.71:  65%|██████▌   | 13/20 [07:39<03:55, 33.71s/it]
Task 8, Epoch 14/20 => Loss 0.126, Train_accy 95.63:  65%|██████▌   | 13/20 [08:06<03:55, 33.71s/it]
Task 8, Epoch 14/20 => Loss 0.126, Train_accy 95.63:  70%|███████   | 14/20 [08:06<03:11, 31.84s/it]
Task 8, Epoch 15/20 => Loss 0.100, Train_accy 96.75, Test_accy 68.72:  70%|███████   | 14/20 [09:24<03:11, 31.84s/it]
Task 8, Epoch 15/20 => Loss 0.100, Train_accy 96.75, Test_accy 68.72:  75%|███████▌  | 15/20 [09:24<03:48, 45.73s/it]
Task 8, Epoch 16/20 => Loss 0.109, Train_accy 95.91:  75%|███████▌  | 15/20 [09:52<03:48, 45.73s/it]                 
Task 8, Epoch 16/20 => Loss 0.109, Train_accy 95.91:  80%|████████  | 16/20 [09:52<02:41, 40.25s/it]
Task 8, Epoch 17/20 => Loss 0.097, Train_accy 96.35:  80%|████████  | 16/20 [10:19<02:41, 40.25s/it]
Task 8, Epoch 17/20 => Loss 0.097, Train_accy 96.35:  85%|████████▌ | 17/20 [10:19<01:49, 36.44s/it]
Task 8, Epoch 18/20 => Loss 0.116, Train_accy 95.75:  85%|████████▌ | 17/20 [10:47<01:49, 36.44s/it]
Task 8, Epoch 18/20 => Loss 0.116, Train_accy 95.75:  90%|█████████ | 18/20 [10:47<01:07, 33.78s/it]
Task 8, Epoch 19/20 => Loss 0.100, Train_accy 96.27:  90%|█████████ | 18/20 [11:15<01:07, 33.78s/it]
Task 8, Epoch 19/20 => Loss 0.100, Train_accy 96.27:  95%|█████████▌| 19/20 [11:15<00:31, 31.93s/it]
Task 8, Epoch 20/20 => Loss 0.103, Train_accy 96.23, Test_accy 68.86:  95%|█████████▌| 19/20 [12:33<00:31, 31.93s/it]
Task 8, Epoch 20/20 => Loss 0.103, Train_accy 96.23, Test_accy 68.86: 100%|██████████| 20/20 [12:33<00:00, 45.80s/it]
Task 8, Epoch 20/20 => Loss 0.103, Train_accy 96.23, Test_accy 68.86: 100%|██████████| 20/20 [12:33<00:00, 37.66s/it]
2024-09-04 08:42:10,584 [coda_prompt.py] => Task 8, Epoch 20/20 => Loss 0.103, Train_accy 96.23, Test_accy 68.86
2024-09-04 08:43:01,139 [trainer.py] => No NME accuracy.
2024-09-04 08:43:01,139 [trainer.py] => CNN: {'total': 68.86, '00-49': 94.3, '50-54': 44.0, '55-59': 44.8, '60-64': 54.0, '65-69': 41.8, '70-74': 35.2, '75-79': 26.4, '80-84': 18.8, '85-89': 31.4, 'old': 71.06, 'new': 31.4}
2024-09-04 08:43:01,139 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08, 70.31, 68.86]
2024-09-04 08:43:01,139 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39, 95.8, 95.46]

Average Accuracy (CNN): 80.49
2024-09-04 08:43:01,139 [trainer.py] => Average Accuracy (CNN): 80.49 

2024-09-04 08:43:01,140 [trainer.py] => All params: 89715556
2024-09-04 08:43:01,140 [trainer.py] => Trainable params: 89715556
2024-09-04 08:43:02,645 [coda_prompt.py] => Learning on 90-95

  0%|          | 0/20 [00:00<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.263, Train_accy 90.87:   0%|          | 0/20 [00:27<?, ?it/s]
Task 9, Epoch 1/20 => Loss 0.263, Train_accy 90.87:   5%|▌         | 1/20 [00:27<08:43, 27.57s/it]
Task 9, Epoch 2/20 => Loss 0.086, Train_accy 96.59:   5%|▌         | 1/20 [00:55<08:43, 27.57s/it]
Task 9, Epoch 2/20 => Loss 0.086, Train_accy 96.59:  10%|█         | 2/20 [00:55<08:16, 27.56s/it]
Task 9, Epoch 3/20 => Loss 0.081, Train_accy 97.04:  10%|█         | 2/20 [01:22<08:16, 27.56s/it]
Task 9, Epoch 3/20 => Loss 0.081, Train_accy 97.04:  15%|█▌        | 3/20 [01:22<07:48, 27.55s/it]
Task 9, Epoch 4/20 => Loss 0.081, Train_accy 97.40:  15%|█▌        | 3/20 [01:50<07:48, 27.55s/it]
Task 9, Epoch 4/20 => Loss 0.081, Train_accy 97.40:  20%|██        | 4/20 [01:50<07:20, 27.55s/it]
Task 9, Epoch 5/20 => Loss 0.058, Train_accy 98.12, Test_accy 65.93:  20%|██        | 4/20 [03:11<07:20, 27.55s/it]
Task 9, Epoch 5/20 => Loss 0.058, Train_accy 98.12, Test_accy 65.93:  25%|██▌       | 5/20 [03:11<11:41, 46.78s/it]
Task 9, Epoch 6/20 => Loss 0.060, Train_accy 98.16:  25%|██▌       | 5/20 [03:38<11:41, 46.78s/it]                 
Task 9, Epoch 6/20 => Loss 0.060, Train_accy 98.16:  30%|███       | 6/20 [03:38<09:23, 40.24s/it]
Task 9, Epoch 7/20 => Loss 0.057, Train_accy 98.00:  30%|███       | 6/20 [04:06<09:23, 40.24s/it]
Task 9, Epoch 7/20 => Loss 0.057, Train_accy 98.00:  35%|███▌      | 7/20 [04:06<07:49, 36.09s/it]
Task 9, Epoch 8/20 => Loss 0.064, Train_accy 97.48:  35%|███▌      | 7/20 [04:33<07:49, 36.09s/it]
Task 9, Epoch 8/20 => Loss 0.064, Train_accy 97.48:  40%|████      | 8/20 [04:33<06:40, 33.36s/it]
Task 9, Epoch 9/20 => Loss 0.071, Train_accy 97.48:  40%|████      | 8/20 [05:01<06:40, 33.36s/it]
Task 9, Epoch 9/20 => Loss 0.071, Train_accy 97.48:  45%|████▌     | 9/20 [05:01<05:46, 31.54s/it]
Task 9, Epoch 10/20 => Loss 0.052, Train_accy 98.20, Test_accy 66.58:  45%|████▌     | 9/20 [06:21<05:46, 31.54s/it]
Task 9, Epoch 10/20 => Loss 0.052, Train_accy 98.20, Test_accy 66.58:  50%|█████     | 10/20 [06:21<07:47, 46.73s/it]
Task 9, Epoch 11/20 => Loss 0.059, Train_accy 97.76:  50%|█████     | 10/20 [06:49<07:47, 46.73s/it]                 
Task 9, Epoch 11/20 => Loss 0.059, Train_accy 97.76:  55%|█████▌    | 11/20 [06:49<06:07, 40.86s/it]
Task 9, Epoch 12/20 => Loss 0.064, Train_accy 97.72:  55%|█████▌    | 11/20 [07:17<06:07, 40.86s/it]
Task 9, Epoch 12/20 => Loss 0.064, Train_accy 97.72:  60%|██████    | 12/20 [07:17<04:54, 36.81s/it]
Task 9, Epoch 13/20 => Loss 0.055, Train_accy 98.04:  60%|██████    | 12/20 [07:44<04:54, 36.81s/it]
Task 9, Epoch 13/20 => Loss 0.055, Train_accy 98.04:  65%|██████▌   | 13/20 [07:44<03:57, 34.00s/it]
Task 9, Epoch 14/20 => Loss 0.040, Train_accy 98.76:  65%|██████▌   | 13/20 [08:12<03:57, 34.00s/it]
Task 9, Epoch 14/20 => Loss 0.040, Train_accy 98.76:  70%|███████   | 14/20 [08:12<03:12, 32.06s/it]
Task 9, Epoch 15/20 => Loss 0.042, Train_accy 98.40, Test_accy 66.54:  70%|███████   | 14/20 [09:33<03:12, 32.06s/it]
Task 9, Epoch 15/20 => Loss 0.042, Train_accy 98.40, Test_accy 66.54:  75%|███████▌  | 15/20 [09:33<03:54, 46.81s/it]
Task 9, Epoch 16/20 => Loss 0.047, Train_accy 98.40:  75%|███████▌  | 15/20 [10:00<03:54, 46.81s/it]                 
Task 9, Epoch 16/20 => Loss 0.047, Train_accy 98.40:  80%|████████  | 16/20 [10:00<02:44, 41.04s/it]
Task 9, Epoch 17/20 => Loss 0.052, Train_accy 98.28:  80%|████████  | 16/20 [10:28<02:44, 41.04s/it]
Task 9, Epoch 17/20 => Loss 0.052, Train_accy 98.28:  85%|████████▌ | 17/20 [10:28<01:51, 37.01s/it]
Task 9, Epoch 18/20 => Loss 0.046, Train_accy 98.44:  85%|████████▌ | 17/20 [10:56<01:51, 37.01s/it]
Task 9, Epoch 18/20 => Loss 0.046, Train_accy 98.44:  90%|█████████ | 18/20 [10:56<01:08, 34.19s/it]
Task 9, Epoch 19/20 => Loss 0.060, Train_accy 97.92:  90%|█████████ | 18/20 [11:23<01:08, 34.19s/it]
Task 9, Epoch 19/20 => Loss 0.060, Train_accy 97.92:  95%|█████████▌| 19/20 [11:23<00:32, 32.20s/it]
Task 9, Epoch 20/20 => Loss 0.057, Train_accy 98.08, Test_accy 66.69:  95%|█████████▌| 19/20 [12:44<00:32, 32.20s/it]
Task 9, Epoch 20/20 => Loss 0.057, Train_accy 98.08, Test_accy 66.69: 100%|██████████| 20/20 [12:44<00:00, 46.80s/it]
Task 9, Epoch 20/20 => Loss 0.057, Train_accy 98.08, Test_accy 66.69: 100%|██████████| 20/20 [12:44<00:00, 38.22s/it]
2024-09-04 08:55:47,141 [coda_prompt.py] => Task 9, Epoch 20/20 => Loss 0.057, Train_accy 98.08, Test_accy 66.69
2024-09-04 08:56:40,750 [trainer.py] => No NME accuracy.
2024-09-04 08:56:40,751 [trainer.py] => CNN: {'total': 66.69, '00-49': 94.22, '50-54': 41.6, '55-59': 42.2, '60-64': 53.2, '65-69': 39.8, '70-74': 35.0, '75-79': 24.8, '80-84': 17.4, '85-89': 30.0, '90-94': 41.0, 'old': 68.12, 'new': 41.0}
2024-09-04 08:56:40,751 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08, 70.31, 68.86, 66.69]
2024-09-04 08:56:40,751 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39, 95.8, 95.46, 95.01]

Average Accuracy (CNN): 79.11
2024-09-04 08:56:40,751 [trainer.py] => Average Accuracy (CNN): 79.11 

2024-09-04 08:56:40,752 [trainer.py] => All params: 89715556
2024-09-04 08:56:40,753 [trainer.py] => Trainable params: 89715556
2024-09-04 08:56:42,421 [coda_prompt.py] => Learning on 95-100

  0%|          | 0/20 [00:00<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.394, Train_accy 86.50:   0%|          | 0/20 [00:27<?, ?it/s]
Task 10, Epoch 1/20 => Loss 0.394, Train_accy 86.50:   5%|▌         | 1/20 [00:27<08:44, 27.59s/it]
Task 10, Epoch 2/20 => Loss 0.135, Train_accy 95.39:   5%|▌         | 1/20 [00:55<08:44, 27.59s/it]
Task 10, Epoch 2/20 => Loss 0.135, Train_accy 95.39:  10%|█         | 2/20 [00:55<08:17, 27.62s/it]
Task 10, Epoch 3/20 => Loss 0.130, Train_accy 95.35:  10%|█         | 2/20 [01:22<08:17, 27.62s/it]
Task 10, Epoch 3/20 => Loss 0.130, Train_accy 95.35:  15%|█▌        | 3/20 [01:22<07:49, 27.63s/it]
Task 10, Epoch 4/20 => Loss 0.110, Train_accy 96.63:  15%|█▌        | 3/20 [01:50<07:49, 27.63s/it]
Task 10, Epoch 4/20 => Loss 0.110, Train_accy 96.63:  20%|██        | 4/20 [01:50<07:21, 27.62s/it]
Task 10, Epoch 5/20 => Loss 0.092, Train_accy 96.88, Test_accy 64.52:  20%|██        | 4/20 [03:14<07:21, 27.62s/it]
Task 10, Epoch 5/20 => Loss 0.092, Train_accy 96.88, Test_accy 64.52:  25%|██▌       | 5/20 [03:14<11:58, 47.87s/it]
Task 10, Epoch 6/20 => Loss 0.104, Train_accy 96.51:  25%|██▌       | 5/20 [03:41<11:58, 47.87s/it]                 
Task 10, Epoch 6/20 => Loss 0.104, Train_accy 96.51:  30%|███       | 6/20 [03:41<09:33, 40.99s/it]
Task 10, Epoch 7/20 => Loss 0.101, Train_accy 96.23:  30%|███       | 6/20 [04:09<09:33, 40.99s/it]
Task 10, Epoch 7/20 => Loss 0.101, Train_accy 96.23:  35%|███▌      | 7/20 [04:09<07:55, 36.61s/it]
Task 10, Epoch 8/20 => Loss 0.090, Train_accy 96.39:  35%|███▌      | 7/20 [04:37<07:55, 36.61s/it]
Task 10, Epoch 8/20 => Loss 0.090, Train_accy 96.39:  40%|████      | 8/20 [04:37<06:44, 33.74s/it]
Task 10, Epoch 9/20 => Loss 0.094, Train_accy 96.55:  40%|████      | 8/20 [05:04<06:44, 33.74s/it]
Task 10, Epoch 9/20 => Loss 0.094, Train_accy 96.55:  45%|████▌     | 9/20 [05:04<05:50, 31.82s/it]
Task 10, Epoch 10/20 => Loss 0.096, Train_accy 96.51, Test_accy 64.82:  45%|████▌     | 9/20 [06:28<05:50, 31.82s/it]
Task 10, Epoch 10/20 => Loss 0.096, Train_accy 96.51, Test_accy 64.82:  50%|█████     | 10/20 [06:28<07:58, 47.85s/it]
Task 10, Epoch 11/20 => Loss 0.086, Train_accy 97.24:  50%|█████     | 10/20 [06:55<07:58, 47.85s/it]                 
Task 10, Epoch 11/20 => Loss 0.086, Train_accy 97.24:  55%|█████▌    | 11/20 [06:55<06:14, 41.64s/it]
Task 10, Epoch 12/20 => Loss 0.081, Train_accy 97.24:  55%|█████▌    | 11/20 [07:23<06:14, 41.64s/it]
Task 10, Epoch 12/20 => Loss 0.081, Train_accy 97.24:  60%|██████    | 12/20 [07:23<04:58, 37.36s/it]
Task 10, Epoch 13/20 => Loss 0.087, Train_accy 96.75:  60%|██████    | 12/20 [07:51<04:58, 37.36s/it]
Task 10, Epoch 13/20 => Loss 0.087, Train_accy 96.75:  65%|██████▌   | 13/20 [07:51<04:00, 34.39s/it]
Task 10, Epoch 14/20 => Loss 0.074, Train_accy 97.36:  65%|██████▌   | 13/20 [08:18<04:00, 34.39s/it]
Task 10, Epoch 14/20 => Loss 0.074, Train_accy 97.36:  70%|███████   | 14/20 [08:18<03:14, 32.34s/it]
Task 10, Epoch 15/20 => Loss 0.078, Train_accy 97.32, Test_accy 64.65:  70%|███████   | 14/20 [09:42<03:14, 32.34s/it]
Task 10, Epoch 15/20 => Loss 0.078, Train_accy 97.32, Test_accy 64.65:  75%|███████▌  | 15/20 [09:42<03:58, 47.77s/it]
Task 10, Epoch 16/20 => Loss 0.070, Train_accy 97.60:  75%|███████▌  | 15/20 [10:09<03:58, 47.77s/it]                 
Task 10, Epoch 16/20 => Loss 0.070, Train_accy 97.60:  80%|████████  | 16/20 [10:09<02:46, 41.69s/it]
Task 10, Epoch 17/20 => Loss 0.079, Train_accy 96.92:  80%|████████  | 16/20 [10:37<02:46, 41.69s/it]
Task 10, Epoch 17/20 => Loss 0.079, Train_accy 96.92:  85%|████████▌ | 17/20 [10:37<01:52, 37.44s/it]
Task 10, Epoch 18/20 => Loss 0.068, Train_accy 97.72:  85%|████████▌ | 17/20 [11:04<01:52, 37.44s/it]
Task 10, Epoch 18/20 => Loss 0.068, Train_accy 97.72:  90%|█████████ | 18/20 [11:04<01:08, 34.47s/it]
Task 10, Epoch 19/20 => Loss 0.072, Train_accy 97.60:  90%|█████████ | 18/20 [11:32<01:08, 34.47s/it]
Task 10, Epoch 19/20 => Loss 0.072, Train_accy 97.60:  95%|█████████▌| 19/20 [11:32<00:32, 32.40s/it]
Task 10, Epoch 20/20 => Loss 0.072, Train_accy 97.64, Test_accy 64.79:  95%|█████████▌| 19/20 [12:56<00:32, 32.40s/it]
Task 10, Epoch 20/20 => Loss 0.072, Train_accy 97.64, Test_accy 64.79: 100%|██████████| 20/20 [12:56<00:00, 47.76s/it]
Task 10, Epoch 20/20 => Loss 0.072, Train_accy 97.64, Test_accy 64.79: 100%|██████████| 20/20 [12:56<00:00, 38.80s/it]
2024-09-04 09:09:38,533 [coda_prompt.py] => Task 10, Epoch 20/20 => Loss 0.072, Train_accy 97.64, Test_accy 64.79
2024-09-04 09:10:34,612 [trainer.py] => No NME accuracy.
2024-09-04 09:10:34,613 [trainer.py] => CNN: {'total': 64.79, '00-49': 94.22, '50-54': 41.0, '55-59': 42.0, '60-64': 54.0, '65-69': 39.2, '70-74': 35.2, '75-79': 24.2, '80-84': 17.4, '85-89': 27.8, '90-94': 40.6, '95-99': 32.2, 'old': 66.51, 'new': 32.2}
2024-09-04 09:10:34,613 [trainer.py] => CNN top1 curve: [94.82, 89.71, 86.13, 83.26, 80.39, 76.84, 74.08, 70.31, 68.86, 66.69, 64.79]
2024-09-04 09:10:34,613 [trainer.py] => CNN top5 curve: [99.42, 99.11, 98.08, 97.72, 97.51, 96.72, 96.39, 95.8, 95.46, 95.01, 94.1]

Average Accuracy (CNN): 77.81
2024-09-04 09:10:34,613 [trainer.py] => Average Accuracy (CNN): 77.81 

Accuracy Matrix (CNN):
[[94.82 94.42 93.9  94.04 94.08 93.96 94.16 94.3  94.3  94.22 94.22]
 [ 0.   42.6  41.   40.2  42.   42.8  42.4  42.4  44.   41.6  41.  ]
 [ 0.    0.   53.6  45.8  45.8  43.   44.2  43.   44.8  42.2  42.  ]
 [ 0.    0.    0.   56.   55.2  52.6  52.4  51.6  54.   53.2  54.  ]
 [ 0.    0.    0.    0.   41.6  39.4  42.8  38.2  41.8  39.8  39.2 ]
 [ 0.    0.    0.    0.    0.   35.2  36.6  34.2  35.2  35.   35.2 ]
 [ 0.    0.    0.    0.    0.    0.   25.2  24.8  26.4  24.8  24.2 ]
 [ 0.    0.    0.    0.    0.    0.    0.   18.   18.8  17.4  17.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   31.4  30.   27.8 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   41.   40.6 ]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   32.2 ]]
2024-09-04 09:10:34,616 [trainer.py] => Forgetting (CNN): 2.9799999999999986

